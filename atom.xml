<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>01ä¸æ˜¯åŒ…å­è„¸</title>
  
  <subtitle>å°01çš„ç¨‹åºçŒ¿æˆé•¿ä¹‹è·¯</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-11-26T05:32:56.169Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Linyi Li</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“</title>
    <link href="http://yoursite.com/2019/11/26/JS%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6%20copy/"/>
    <id>http://yoursite.com/2019/11/26/JSäº‹ä»¶æœºåˆ¶ copy/</id>
    <published>2019-11-26T05:29:24.000Z</published>
    <updated>2019-11-26T05:32:56.169Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“"><a href="#å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“" class="headerlink" title="å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“"></a>å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“</h1><p>å¾ªç¯çš„å¼‚æ­¥æ“ä½œä¸»è¦æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>å¦‚ä½•ç¡®ä¿å¾ªç¯çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åæ‰§è¡ŒæŸä¸ªå…¶ä»–æ“ä½œ</li><li>å¾ªç¯ä¸­çš„ä¸‹ä¸€æ­¥æ“ä½œä¾èµ–äºå‰ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚ä½•è§£å†³</li></ul><h2 id="ä¸éœ€ç­‰å¾…ç»“æœ"><a href="#ä¸éœ€ç­‰å¾…ç»“æœ" class="headerlink" title="ä¸éœ€ç­‰å¾…ç»“æœ"></a>ä¸éœ€ç­‰å¾…ç»“æœ</h2><p>è¦å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªåŒ¿åå‡½æ•°å®šä¹‰ä¸ºå¼‚æ­¥çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">processArray</span>(<span class="params">array</span>)</span>&#123;</span><br><span class="line">  array.forEach(<span class="keyword">async</span> (item)=&gt;&#123;</span><br><span class="line">    <span class="keyword">await</span> delayedLog(item)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Done!'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·çš„è¯ forEach æ–¹æ³•å°±ç›¸å½“äºå¼‚æ­¥çš„äº†ï¼Œä¸ä¼šç­‰å¾…éå†å®Œæ‰€æœ‰çš„ item å°†ä¼šè¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Done!</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä¸éœ€è¦ç­‰å¾…è¿™ä¸ªå¾ªç¯å®Œæˆï¼Œè¿™æ ·å°±å·²ç»å¯ä»¥äº†ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ç­‰å¾…è¿™ä¸ªå¾ªç¯å®Œæˆæ‰è¿›è¡Œä¹‹åçš„æ“ä½œã€‚</p><h2 id="å¦‚ä½•ç¡®ä¿å¾ªç¯çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åæ‰§è¡ŒæŸä¸ªå…¶ä»–æ“ä½œ"><a href="#å¦‚ä½•ç¡®ä¿å¾ªç¯çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åæ‰§è¡ŒæŸä¸ªå…¶ä»–æ“ä½œ" class="headerlink" title="å¦‚ä½•ç¡®ä¿å¾ªç¯çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åæ‰§è¡ŒæŸä¸ªå…¶ä»–æ“ä½œ"></a>å¦‚ä½•ç¡®ä¿å¾ªç¯çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åæ‰§è¡ŒæŸä¸ªå…¶ä»–æ“ä½œ</h2><h3 id="æ–¹æ³•ä¸€ï¼šè®¾ç½®ä¸€ä¸ªflagï¼Œåœ¨æ¯ä¸ªå¼‚æ­¥æ“ä½œä¸­å¯¹flagè¿›è¡Œæ£€æµ‹"><a href="#æ–¹æ³•ä¸€ï¼šè®¾ç½®ä¸€ä¸ªflagï¼Œåœ¨æ¯ä¸ªå¼‚æ­¥æ“ä½œä¸­å¯¹flagè¿›è¡Œæ£€æµ‹" class="headerlink" title="æ–¹æ³•ä¸€ï¼šè®¾ç½®ä¸€ä¸ªflagï¼Œåœ¨æ¯ä¸ªå¼‚æ­¥æ“ä½œä¸­å¯¹flagè¿›è¡Œæ£€æµ‹"></a>æ–¹æ³•ä¸€ï¼šè®¾ç½®ä¸€ä¸ªflagï¼Œåœ¨æ¯ä¸ªå¼‚æ­¥æ“ä½œä¸­å¯¹flagè¿›è¡Œæ£€æµ‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">  flag++;</span><br><span class="line">  Database.save_method().exec().then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(flag === len) &#123;</span><br><span class="line">            <span class="comment">// your code</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒï¼šå°†æ‰€æœ‰çš„å¾ªç¯æ”¾åœ¨ä¸€ä¸ªpromiseä¸­ï¼Œä½¿ç”¨thenå¤„ç†"><a href="#æ–¹æ³•äºŒï¼šå°†æ‰€æœ‰çš„å¾ªç¯æ”¾åœ¨ä¸€ä¸ªpromiseä¸­ï¼Œä½¿ç”¨thenå¤„ç†" class="headerlink" title="æ–¹æ³•äºŒï¼šå°†æ‰€æœ‰çš„å¾ªç¯æ”¾åœ¨ä¸€ä¸ªpromiseä¸­ï¼Œä½¿ç”¨thenå¤„ç†"></a>æ–¹æ³•äºŒï¼šå°†æ‰€æœ‰çš„å¾ªç¯æ”¾åœ¨ä¸€ä¸ªpromiseä¸­ï¼Œä½¿ç”¨thenå¤„ç†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>)</span>&#123;</span><br><span class="line">      resolve()</span><br><span class="line"> &#125;).then(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">           Database.save_method().exec()</span><br><span class="line">     &#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// your code</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•ä¸‰ï¼šä¸²è¡Œéå†"><a href="#æ–¹æ³•ä¸‰ï¼šä¸²è¡Œéå†" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šä¸²è¡Œéå†"></a>æ–¹æ³•ä¸‰ï¼šä¸²è¡Œéå†</h3><p>è¦ç­‰å¾…æ‰€æœ‰çš„ç»“æœè¿”å›ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å›åˆ°è€å¼çš„ for å¾ªç¯å†™æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">processArray</span>(<span class="params">array</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> item <span class="keyword">of</span> array)&#123;</span><br><span class="line">    <span class="keyword">await</span> delayedLog(item)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Done!'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åçš„ç»“æœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">Done!</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•å››ï¼šå¹¶è¡Œéå†"><a href="#æ–¹æ³•å››ï¼šå¹¶è¡Œéå†" class="headerlink" title="æ–¹æ³•å››ï¼šå¹¶è¡Œéå†"></a>æ–¹æ³•å››ï¼šå¹¶è¡Œéå†</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g7c606vfgvj30tg081mxe.jpg" alt="img"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">processArray</span>(<span class="params">array</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//map array to promise</span></span><br><span class="line">  <span class="keyword">const</span> promises=array.map(delayedLog)</span><br><span class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.all(promises)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Done!'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆæ³¨æ„ï¼šå¯¹äºç‰¹åˆ«å¤§çš„æ•°ç»„ä¸å»ºè®®ä½¿ç”¨è¿™ç§å†™æ³•ï¼Œå¤ªå¤šçš„å¹¶è¡Œä»»åŠ¡ä¼šåŠ é‡ CPU å’Œå†…å­˜çš„è´Ÿè·ï¼‰</p><h2 id="å¾ªç¯ä¸­çš„ä¸‹ä¸€æ­¥æ“ä½œä¾èµ–äºå‰ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚ä½•è§£å†³"><a href="#å¾ªç¯ä¸­çš„ä¸‹ä¸€æ­¥æ“ä½œä¾èµ–äºå‰ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚ä½•è§£å†³" class="headerlink" title="å¾ªç¯ä¸­çš„ä¸‹ä¸€æ­¥æ“ä½œä¾èµ–äºå‰ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚ä½•è§£å†³"></a>å¾ªç¯ä¸­çš„ä¸‹ä¸€æ­¥æ“ä½œä¾èµ–äºå‰ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚ä½•è§£å†³</h2><h3 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨é€’å½’ï¼Œåœ¨å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åè°ƒç”¨ä¸‹ä¸€æ¬¡å¼‚æ­¥æ“ä½œ"><a href="#æ–¹æ³•ä¸€ï¼šä½¿ç”¨é€’å½’ï¼Œåœ¨å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åè°ƒç”¨ä¸‹ä¸€æ¬¡å¼‚æ­¥æ“ä½œ" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä½¿ç”¨é€’å½’ï¼Œåœ¨å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åè°ƒç”¨ä¸‹ä¸€æ¬¡å¼‚æ­¥æ“ä½œ"></a>æ–¹æ³•ä¸€ï¼šä½¿ç”¨é€’å½’ï¼Œåœ¨å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åè°ƒç”¨ä¸‹ä¸€æ¬¡å¼‚æ­¥æ“ä½œ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loop</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">  i++;</span><br><span class="line">  Database.save_method().exec().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      loop(i)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒï¼šä½¿ç”¨asyncå’Œawaitï¼ˆä¸²è¡Œéå†ï¼‰"><a href="#æ–¹æ³•äºŒï¼šä½¿ç”¨asyncå’Œawaitï¼ˆä¸²è¡Œéå†ï¼‰" class="headerlink" title="æ–¹æ³•äºŒï¼šä½¿ç”¨asyncå’Œawaitï¼ˆä¸²è¡Œéå†ï¼‰"></a>æ–¹æ³•äºŒï¼šä½¿ç”¨asyncå’Œawaitï¼ˆä¸²è¡Œéå†ï¼‰</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">loop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">         <span class="keyword">await</span> Database.save_method().exec();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¦‚ä½•ä¼˜é›…åœ°å†™jså¼‚æ­¥å¾ªç¯"><a href="#å¦‚ä½•ä¼˜é›…åœ°å†™jså¼‚æ­¥å¾ªç¯" class="headerlink" title="å¦‚ä½•ä¼˜é›…åœ°å†™jså¼‚æ­¥å¾ªç¯"></a>å¦‚ä½•ä¼˜é›…åœ°å†™jså¼‚æ­¥å¾ªç¯</h1><h2 id="å¾ªç¯çš„æ–¹å¼"><a href="#å¾ªç¯çš„æ–¹å¼" class="headerlink" title="å¾ªç¯çš„æ–¹å¼"></a>å¾ªç¯çš„æ–¹å¼</h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸ªæ•°ç»„ï¼ŒåŒ…å« 5 ä¸ªæ•°å­—ï¼š<code>let times = [100, 150, 200, 250, 300]</code>ï¼›<br>è¿˜æœ‰ä¸€ä¸ªå¼‚æ­¥çš„ç¡è§‰æ–¹æ³•ï¼š<code>sleep(time, cb)</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="built_in">Promise</span> <span class="keyword">from</span> <span class="string">'bluebird'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“æ²¡æœ‰ cb æ—¶ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">time, cb</span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">        setTimeout(cb, time);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">            setTimeout(resolve, time);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç°åœ¨è¦å»å¾ªç¯ç¡è¿™å‡ ä¸ªæ•°å­—ï¼Œé—®ä½ æœ‰å“ªäº›ç¡æ³•ï¼ŸğŸ¤”</p><p>ä¸ºäº†æ–¹ä¾¿äº¤æµï¼Œæˆ‘å°±ç»™è¿™å‡ ä¸ªç¡æ³•èµ·ä¸ªåå­—ï¼š</p><ol><li>All inï¼šä½ å¦‚æœèµ¶æ—¶é—´åˆä¸æ‹…å¿ƒæ¶ˆè€—è¿‡åº¦ï¼Œä½ å¯ä»¥ä¸€æ¬¡æ€§éƒ½ç¡äº†ï¼›</li><li>One by oneï¼šä½ æƒ³ç»†æ°´é•¿æµï¼Œä½ å¯ä»¥ä¸€ä¸ªä¸€ä¸ªç¡ï¼›</li><li>With concurrencyï¼šä½ å®³ç¾åœ°ä½ä¸‹å¤´ï¼Œè¯´ä¸€æ¬¡èƒ½ä¸èƒ½ç¡ä¸¤ä¸ªã€‚</li></ol><blockquote><p>ä½œä¸ºä¸€æ®µæœ‰èŠ‚æ“çš„ä»£ç ï¼Œè‚¯å®šè¦å‘Šè¯‰å…¶ä»–äººä½ ç¡å®Œäº†ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»æœ‰å…¨éƒ¨å®Œæˆçš„å›è°ƒï¼Œå¦åˆ™æˆ‘ä»¬æ¥ä¸‹æ¥çš„äº¤æµä¼šæ¯«æ— æ„ä¹‰ã€‚</p></blockquote><p>æœ¬æ–‡ç›®çš„æ˜¯å’Œå¤§å®¶æ¢è®¨å¦‚ä½•å†™å‡ºä¼˜é›…çš„å¼‚æ­¥å¾ªç¯ä»£ç ï¼Œå¹¶ä¸æ˜¯å»å®ç°è¿™äº›å¾ªç¯æ§åˆ¶çš„é€»è¾‘ï¼›è€Œä¿æŒä»£ç ä¼˜é›…ï¼Œä¸ªäººä»¥ä¸ºæœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨è¾ƒæ–°çš„è¯­è¨€ç‰¹æ€§ï¼Œå…¶æ¬¡æ˜¯ä½¿ç”¨ä¼˜ç§€çš„å¼€æºé¡¹ç›®ï¼Œæœ€åæ‰æ˜¯è‡ªå·±æ’¸ã€‚ä¸‹é¢ä¼šä½¿ç”¨ <a href="https://link.juejin.im/?target=https%3A%2F%2Fgithub.com%2Fcaolan%2Fasync" target="_blank" rel="noopener">Async</a>ã€<a href="https://link.juejin.im/?target=https%3A%2F%2Fgithub.com%2Fpetkaantonov%2Fbluebird" target="_blank" rel="noopener">Promise(bluebird)</a> å’Œ ES7 ä¸­çš„ <code>async/await</code> å¯¹æ¯”ä¸‹å®ç°è¿™å‡ ç§å¾ªç¯çš„åŒºåˆ«ã€‚</p><h3 id="All-in"><a href="#All-in" class="headerlink" title="All in"></a>All in</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g7c606vfgvj30tg081mxe.jpg" alt="All in"></p><p>è¿™ç§æ–¹å¼æ•ˆç‡æ˜¯æœ€é«˜çš„ï¼Œè€—æ—¶å–å†³äºå¾ªç¯ä¸­æœ€æ…¢çš„é‚£ä¸ªå¼‚æ­¥æ–¹æ³•ã€‚å¯¹èµ„æºçš„æ¶ˆè€—ä¹Ÿæ˜¯æœ€å¤§çš„ï¼Œå¦‚æœå¤§é‡å¾ªç¯è¯·æ±‚åç«¯æœåŠ¡ï¼Œå¾ˆæœ‰å¯èƒ½é€ æˆç¬æ—¶æ‹¥å µçš„æƒ…å†µã€‚</p><p>å¦‚æœè‡ªå·±å®ç°ï¼Œè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„åœºæ™¯ï¼ŒåŠ ä¸€ä¸ªå®Œæˆè®¡æ•°å™¨ï¼Œæ¯ä¸ªå¼‚æ­¥æ–¹æ³•å®Œå°±ç»™è¿™ä¸ªå®Œæˆè®¡æ•°å™¨åŠ  1ï¼Œç„¶åæ£€æŸ¥å®Œæˆæ•°æ˜¯ä¸æ˜¯ç­‰äºæ•°ç»„é•¿åº¦ï¼Œä¸€æ—¦ç›¸ç­‰å°±è¡¨ç¤ºæ‰€æœ‰çš„å¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œé€šçŸ¥å…¨éƒ¨å®Œæˆçš„å›è°ƒã€‚</p><h4 id="ä½¿ç”¨-async-eachï¼š"><a href="#ä½¿ç”¨-async-eachï¼š" class="headerlink" title="ä½¿ç”¨ async.eachï¼š"></a>ä½¿ç”¨ async.eachï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; each &#125; <span class="keyword">from</span> <span class="string">'async'</span>;  </span><br><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);  </span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'async all in'</span>);  </span><br><span class="line">each(times, sleep, (err) =&gt; &#123;  </span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'async all in'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// async all in: 304.627ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨-Promise-allï¼š"><a href="#ä½¿ç”¨-Promise-allï¼š" class="headerlink" title="ä½¿ç”¨ Promise.allï¼š"></a>ä½¿ç”¨ Promise.allï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="built_in">Promise</span> <span class="keyword">from</span> <span class="string">'bluebird'</span>;  </span><br><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);  </span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'promise all in'</span>);  </span><br><span class="line"><span class="built_in">Promise</span>.all(times.map(<span class="function"><span class="params">time</span> =&gt;</span> sleep(time))).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;  </span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'promise all in'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// promise all in: 305.509ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨ES7-async-awaitï¼š"><a href="#ä½¿ç”¨ES7-async-awaitï¼š" class="headerlink" title="ä½¿ç”¨ES7 async/awaitï¼š"></a>ä½¿ç”¨ES7 async/awaitï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);</span><br><span class="line">    <span class="built_in">console</span>.time(<span class="string">'es7 all in'</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">let</span> i <span class="keyword">of</span> times.map(<span class="function"><span class="params">time</span> =&gt;</span> sleep(time))) &#123;&#125;</span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'es7 all in'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;());</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// es7 all in: 305.986ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h3 id="One-by-one"><a href="#One-by-one" class="headerlink" title="One by one"></a>One by one</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g7c65nlncwj30tg04374g.jpg" alt="One by one"></p><p>è¿™ç§æ–¹å¼æ•ˆç‡æœ€ä½ï¼Œæœ‰ç‚¹ç±»ä¼¼äºåŒæ­¥è¯­è¨€ä¸­çš„å¾ªç¯ï¼Œä¸€ä¸ªæ¥ç€ä¸€ä¸ªæ‰§è¡Œï¼Œè€—æ—¶è‡ªç„¶ä¹Ÿå°±æ˜¯æ‰€æœ‰å¼‚æ­¥æ–¹æ³•è€—æ—¶çš„æ€»å’Œã€‚å¯¹èµ„æºçš„æ¶ˆè€—æœ€å°ã€‚</p><p>è¿™ä¸ªå®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼ŒæŠŠæ•°ç»„çœ‹åšä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡ä»é˜Ÿåˆ—<code>shift</code>å‡ºä¸€ä¸ªä»£å…¥å¼‚æ­¥æ–¹æ³•æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæˆå°±å¼€å§‹é€’å½’è°ƒç”¨è¿™ä¸ªè¿‡ç¨‹ï¼Œå½“é˜Ÿåˆ—é•¿åº¦ä¸ºç©ºå°±è¡¨ç¤ºæ‰€æœ‰çš„å¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œç»“æŸé€’å½’ï¼Œé€šçŸ¥å…¨éƒ¨å®Œæˆçš„å›è°ƒã€‚</p><h4 id="ä½¿ç”¨-async-eachSeriesï¼š"><a href="#ä½¿ç”¨-async-eachSeriesï¼š" class="headerlink" title="ä½¿ç”¨ async.eachSeriesï¼š"></a>ä½¿ç”¨ async.eachSeriesï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; eachSeries &#125; <span class="keyword">from</span> <span class="string">'async'</span>;  </span><br><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);  </span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'async one by one'</span>);  </span><br><span class="line">eachSeries(times, sleep, (err) =&gt; &#123;  </span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'async one by one'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// async one by one: 1020.078ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨-Promise-reduceï¼š"><a href="#ä½¿ç”¨-Promise-reduceï¼š" class="headerlink" title="ä½¿ç”¨ Promise.reduceï¼š"></a>ä½¿ç”¨ Promise.reduceï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="built_in">Promise</span> <span class="keyword">from</span> <span class="string">'bluebird'</span>;  </span><br><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);  </span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'promise one by one'</span>);  </span><br><span class="line"><span class="built_in">Promise</span>.reduce(times, (last, curr) =&gt; &#123;  </span><br><span class="line">    <span class="keyword">return</span> sleep(curr);</span><br><span class="line">&#125;, <span class="number">0</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'promise one by one'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// promise one by one: 1023.014ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨ES7-async-awaitï¼š-1"><a href="#ä½¿ç”¨ES7-async-awaitï¼š-1" class="headerlink" title="ä½¿ç”¨ES7 async/awaitï¼š"></a>ä½¿ç”¨ES7 async/awaitï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);</span><br><span class="line">    <span class="built_in">console</span>.time(<span class="string">'es7 one by one'</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> time <span class="keyword">of</span> times) &#123;</span><br><span class="line">        <span class="keyword">await</span> sleep(time);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'es7 one by one'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;());</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// es7 one by one: 1025.513ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h3 id="With-concurrency"><a href="#With-concurrency" class="headerlink" title="With concurrency"></a>With concurrency</h3><p>è¿™ç§æ–¹å¼ç¨å¾®å¤æ‚äº›ï¼Œä½†ä¹Ÿæ˜¯æœ€çµæ´»çš„æ–¹å¼ï¼Œå¯ä»¥éšå¿ƒæ§åˆ¶å¹¶å‘æ•°ã€‚æ•ˆç‡å’Œè€—æ—¶å–å†³äºé­”æ³•æ•°å­— <code>concurrency</code>ï¼Œå½“ <code>concurrency</code> å¤§äºæˆ–ç­‰äºæ•°ç»„é•¿åº¦æ—¶ï¼Œå®ƒå°±ç­‰åŒäº <strong>All in</strong> æ–¹å¼ï¼›å½“ <code>concurrency</code> ä¸º 1 æ—¶ï¼Œå®ƒå°±ç­‰åŒäº <strong>One by one</strong> æ–¹å¼ã€‚æ‰€ä»¥è€—æ—¶å’Œå¯¹èµ„æºçš„æ¶ˆè€—éƒ½ä¼šä»‹äºä»¥ä¸Šä¸¤ç§æ–¹å¼ä¹‹é—´ã€‚</p><p><strong>With concurrency</strong> æœ¬èº«åœ¨å®ç°ä¸Šä¹Ÿä¼šæœ‰ä¸åŒçš„æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯é¢„åˆ†ç»„å’Œä»»åŠ¡æ± ã€‚</p><h4 id="é¢„åˆ†ç»„"><a href="#é¢„åˆ†ç»„" class="headerlink" title="é¢„åˆ†ç»„"></a>é¢„åˆ†ç»„</h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g7c66v9wx3j30tg05074j.jpg" alt="Pre Group"></p><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æå‰å°†æ•°ç»„å†…å®¹æŒ‰ <code>concurrency</code> åˆ†å¥½ç»„ï¼Œç»„å†…æ˜¯ä»¥ <strong>All in</strong> æ–¹å¼æ‰§è¡Œï¼Œç»„ä¹‹é—´åˆ™æ˜¯ä»¥ <strong>One by one</strong> çš„æ–¹å¼æ‰§è¡Œã€‚</p><p>å°±ä»¥ä¸Šæ–‡çš„ä¾‹å­ï¼Œå‡å¦‚ <code>concurrency</code> ä¸º 2ï¼Œ<code>times</code> é¢„å…ˆåˆ†ç»„æˆï¼š<code>[[100, 150], [200, 250], [300]]</code>ï¼Œè¿™æ ·è€—æ—¶ä¼šæ˜¯ 700ï¼ˆ150 + 250 + 300ï¼‰ã€‚</p><p>è¿™ä¸ªå®ç°æ–¹å¼å¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶å¹¶å‘æ•°ï¼Œä¼˜ç‚¹å°±æ˜¯ç®€å•ï¼Œç¼ºç‚¹æ˜¯å¹¶ä¸èƒ½è¾¾åˆ°æ•ˆç‡æœ€å¤§åŒ–ã€‚</p><h4 id="ä»»åŠ¡æ± "><a href="#ä»»åŠ¡æ± " class="headerlink" title="ä»»åŠ¡æ± "></a>ä»»åŠ¡æ± </h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g7c67an02oj30tg066q38.jpg" alt="Task Pool"></p><p>ä»»åŠ¡æ± çš„æ–¹å¼å°±æ˜¯è®¾ç½®ä¸€ä¸ªå®¹é‡ä¸º <code>concurrency</code> çš„æ± å­ï¼Œæ¯”å¦‚å®¹é‡ä¸º 2ï¼Œåˆå§‹åŒ–æ”¾å…¥ä¸¤ä¸ªä»»åŠ¡ï¼Œæ¯å½“æœ‰ä»»åŠ¡å®Œæˆï¼Œå°±ç»§ç»­å¾€æ± å­æ·»åŠ æ–°çš„ä»»åŠ¡ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆã€‚ä¸Šæ–‡çš„ä¾‹å­æ‰§è¡Œè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ol><li><code>time = 0; pool = [100, 150]</code>ï¼šæ”¾å…¥ <code>100</code> å’Œ <code>150</code></li><li><code>time = 100; pool = [150, 200]</code>ï¼š<code>100</code> ç»“æŸï¼Œæ”¾å…¥ <code>200</code></li><li><code>time = 150; pool = [200, 250]</code>ï¼š<code>150</code> ç»“æŸï¼Œæ”¾å…¥ <code>250</code></li><li><code>time = 300; pool = [250, 300]</code>ï¼š<code>200</code> ç»“æŸï¼Œæ”¾å…¥ <code>300</code></li><li><code>time = 400; pool = [300]</code>ï¼š<code>250</code> ç»“æŸï¼Œæ²¡æœ‰æ›´å¤šä»»åŠ¡</li><li><code>time = 600; pool = []</code>ï¼š<code>300</code> ç»“æŸï¼Œå¾ªç¯å®Œæ¯•</li></ol><p>å¾—å‡ºæ¥çš„è€—æ—¶æ˜¯ 600ï¼Œæ¯”é¢„åˆ†ç»„çš„æ–¹å¼æ•ˆç‡æ›´é«˜ï¼Œè€Œä¸”åŒæ ·èƒ½æœ‰æ•ˆæ§åˆ¶å¹¶å‘ä¸ªæ•°ã€‚async å’Œ bluebird ä¹Ÿæœ‰ç›¸å…³çš„æ–¹æ³•ä¾›ç›´æ¥ä½¿ç”¨ã€‚</p><h4 id="ä½¿ç”¨-async-eachLimitï¼š"><a href="#ä½¿ç”¨-async-eachLimitï¼š" class="headerlink" title="ä½¿ç”¨ async.eachLimitï¼š"></a>ä½¿ç”¨ async.eachLimitï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; eachLimit &#125; <span class="keyword">from</span> <span class="string">'async'</span>;  </span><br><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);  </span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'async with concurrency'</span>);  </span><br><span class="line">eachLimit(times, <span class="number">2</span>, sleep, (err) =&gt; &#123;  </span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'async with concurrency'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// async with concurrency: 611.498ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨-Promise-mapï¼ˆbluebird-ç‰¹æœ‰-apiï¼‰ï¼š"><a href="#ä½¿ç”¨-Promise-mapï¼ˆbluebird-ç‰¹æœ‰-apiï¼‰ï¼š" class="headerlink" title="ä½¿ç”¨ Promise.mapï¼ˆbluebird ç‰¹æœ‰ apiï¼‰ï¼š"></a>ä½¿ç”¨ Promise.mapï¼ˆbluebird ç‰¹æœ‰ apiï¼‰ï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="built_in">Promise</span> <span class="keyword">from</span> <span class="string">'bluebird'</span>;  </span><br><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);  </span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'promise one by one'</span>);  </span><br><span class="line"><span class="built_in">Promise</span>.map(times, (time) =&gt; &#123;  </span><br><span class="line">    <span class="keyword">return</span> sleep(time);</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    concurrency: <span class="number">2</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'promise one by one'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// promise with concurrency: 616.601ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨ES7-async-awaitï¼š-2"><a href="#ä½¿ç”¨ES7-async-awaitï¼š-2" class="headerlink" title="ä½¿ç”¨ES7 async/awaitï¼š"></a>ä½¿ç”¨ES7 async/awaitï¼š</h4><blockquote><p><code>pool</code> æ–¹æ³•æ¥è‡ª<a href="https://link.juejin.im/?target=https%3A%2F%2Fgithub.com%2Fdavetemplin%2Fasync-parallel%2Fblob%2Fmaster%2Findex.ts%23L153" target="_blank" rel="noopener">davetemplin/async-parallel</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sleep <span class="keyword">from</span> <span class="string">'./sleep'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> times = [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">250</span>, <span class="number">300</span>];</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep start'</span>);</span><br><span class="line">    <span class="built_in">console</span>.time(<span class="string">'es7 with concurrency'</span>);</span><br><span class="line">    <span class="keyword">await</span> pool(<span class="number">2</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">await</span> sleep(times.shift());</span><br><span class="line">        <span class="keyword">return</span> times.length &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">'es7 with concurrency'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sleep complete'</span>);</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">pool</span>(<span class="params">size, task</span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> active = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> done = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> errors = [];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        next();</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (active &lt; size &amp;&amp; !done) &#123;</span><br><span class="line">                active += <span class="number">1</span>;</span><br><span class="line">                task()</span><br><span class="line">                    .then(<span class="function"><span class="params">more</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (--active === <span class="number">0</span> &amp;&amp; (done || !more))</span><br><span class="line">                            errors.length === <span class="number">0</span> ? resolve() : reject(errors);</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (more)</span><br><span class="line">                            next();</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            done = <span class="literal">true</span>;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">                        errors.push(err);</span><br><span class="line">                        done = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">if</span> (--active === <span class="number">0</span>)</span><br><span class="line">                            reject(errors);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// sleep start</span></span><br><span class="line"><span class="comment">// es7 with concurrency: 612.197ms</span></span><br><span class="line"><span class="comment">// sleep complete</span></span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¥½äº†ï¼Œåˆ°è¿™åº”è¯¥å¯ä»¥ç»™è¿™ä¸‰ç§å¾ªç¯æ–¹å¼æ‰“ä¸‹åˆ†äº†ï¼š</p><table><thead><tr><th><strong>å¾ªç¯æ–¹å¼</strong></th><th>æ•ˆç‡</th><th>æ¶ˆè€—</th><th>çµæ´»åº¦</th><th>å¤æ‚åº¦</th></tr></thead><tbody><tr><td><strong>All in</strong></td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>ä½</td></tr><tr><td><strong>One by one</strong></td><td>ä½</td><td>ä½</td><td>ä½</td><td>ä½</td></tr><tr><td><strong>With concurrency</strong></td><td>ä¸­</td><td>ä¸­</td><td>é«˜</td><td>é«˜</td></tr></tbody></table><p>ä¹ä¸€çœ‹ <strong>With concurrency</strong> æ˜¯å®Œèƒœï¼Œå…¶å®å¹¶æ²¡æœ‰ã€‚<strong>All in</strong> å’Œ <strong>One by one</strong> è™½ç„¶çµæ´»åº¦ä½ï¼Œä½†æ˜¯åº”ç”¨çš„åœºæ™¯è¿˜æ˜¯éå¸¸å¹¿æ³›çš„ã€‚è¦æ±‚æ•ˆç‡ä¼˜å…ˆå°±ä½¿ç”¨ <strong>All in</strong>ï¼›å¦‚æœæœ‰ä¸‹ä¸€æ¬¡å¾ªç¯ä¾èµ–ä¸Šä¸€æ¬¡å¾ªç¯ç»“æœçš„åœºæ™¯ï¼Œå°±å¿…é¡»ä½¿ç”¨ <strong>One by One</strong>ã€‚</p><p>å†è¯´ä¸‹ä¸Šé¢ asyncã€bluebirdã€ES7 å¯¹è¿™ä¸‰ç§å¾ªç¯æ–¹å¼çš„å®ç°ã€‚éœ€æ±‚ä¸€ç›´åœ¨å˜ï¼Œasync éœ€è¦ä¿®æ”¹çš„ä»£ç éå¸¸å°‘ï¼Œç”šè‡³åªè¦æ”¹ä¸‹æ–¹æ³•åå°±å¯ä»¥ï¼Œæ–¹æ³•å®šä¹‰ç®€å•ä¼˜é›…ï¼Œè¿™å¯èƒ½ä¹Ÿæ˜¯ async æ˜“ä¸Šæ‰‹çš„åŸå› ï¼›bluebird åœ¨ <code>Promise</code> æ ‡å‡†åŸºç¡€ä¸Šæ·»åŠ çš„æ–¹æ³•éå¸¸å®ç”¨ï¼Œå¦‚ï¼šmapã€joinâ€¦ï¼Œä»¥è‡³äºæˆ‘å‡ ä¹æ˜¯æ²¡æœ‰ä½¿ç”¨è¿‡åŸç”Ÿ <code>Promise</code> ğŸ˜‚ï¼›ES7 æ–°å¢çš„ <code>async/await</code> è¯­æ³•ç‰¹æ€§ç¡®å®å‡è½»äº†ç¼–å†™å¼‚æ­¥ä»£ç çš„ç—›è‹¦ï¼ŒåŒæ—¶è¿˜å¢å¼ºäº†ä»£ç çš„å¯è¯»æ€§ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“&quot;&gt;&lt;a href=&quot;#å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“&quot; class=&quot;headerlink&quot; title=&quot;å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“&quot;&gt;&lt;/a&gt;å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“&lt;/h1&gt;&lt;p&gt;å¾ªç¯çš„å¼‚æ­¥æ“ä½œä¸»è¦æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚
      
    
    </summary>
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>ä¼ªç±»å’Œä¼ªå…ƒç´ </title>
    <link href="http://yoursite.com/2019/11/16/%E4%BC%AA%E7%B1%BB%E5%92%8C%E4%BC%AA%E5%85%83%E7%B4%A0/"/>
    <id>http://yoursite.com/2019/11/16/ä¼ªç±»å’Œä¼ªå…ƒç´ /</id>
    <published>2019-11-16T11:40:32.000Z</published>
    <updated>2019-11-16T11:49:57.412Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¼ªç±»å’Œä¼ªå…ƒç´ "><a href="#ä¼ªç±»å’Œä¼ªå…ƒç´ " class="headerlink" title="ä¼ªç±»å’Œä¼ªå…ƒç´ "></a>ä¼ªç±»å’Œä¼ªå…ƒç´ </h1><p><code>css</code>å¼•å…¥ä¼ªç±»å’Œä¼ªå…ƒç´ æ¦‚å¿µæ˜¯ä¸ºäº†æ ¼å¼åŒ–æ–‡æ¡£æ ‘ä»¥å¤–çš„ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ªç±»å’Œä¼ªå…ƒç´ æ˜¯ç”¨æ¥ä¿®é¥°ä¸åœ¨æ–‡æ¡£æ ‘ä¸­çš„éƒ¨åˆ†ã€‚</p><ul><li>ä¼ªç±»ç”¨äºå½“å·²æœ‰å…ƒç´ å¤„äºçš„æŸä¸ªçŠ¶æ€æ—¶ï¼Œä¸ºå…¶æ·»åŠ å¯¹åº”çš„æ ·å¼ï¼Œè¿™ä¸ªçŠ¶æ€æ˜¯æ ¹æ®ç”¨æˆ·è¡Œä¸ºè€ŒåŠ¨æ€å˜åŒ–çš„ã€‚æ¯”å¦‚è¯´ï¼Œå½“ç”¨æˆ·æ‚¬åœåœ¨æŒ‡å®šçš„å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>:hover</code>æ¥æè¿°è¿™ä¸ªå…ƒç´ çš„çŠ¶æ€ã€‚è™½ç„¶å®ƒå’Œæ™®é€šçš„<code>css</code>ç±»ç›¸ä¼¼ï¼Œå¯ä»¥ä¸ºå·²æœ‰çš„å…ƒç´ æ·»åŠ æ ·å¼ï¼Œä½†æ˜¯å®ƒåªæœ‰å¤„äº<code>dom</code>æ ‘æ— æ³•æè¿°çš„çŠ¶æ€ä¸‹æ‰èƒ½ä¸ºå…ƒç´ æ·»åŠ æ ·å¼ï¼Œæ‰€ä»¥å°†å…¶ç§°ä¸ºä¼ªç±»ã€‚</li><li>ä¼ªå…ƒç´ ç”¨äºåˆ›å»ºä¸€äº›ä¸åœ¨æ–‡æ¡£æ ‘ä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸ºå…¶æ·»åŠ æ ·å¼ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>:before</code>æ¥åœ¨ä¸€ä¸ªå…ƒç´ å‰å¢åŠ ä¸€äº›æ–‡æœ¬ï¼Œå¹¶ä¸ºè¿™äº›æ–‡æœ¬æ·»åŠ æ ·å¼ã€‚è™½ç„¶ç”¨æˆ·å¯ä»¥çœ‹åˆ°è¿™äº›æ–‡æœ¬ï¼Œä½†æ˜¯è¿™äº›æ–‡æœ¬å®é™…ä¸Šä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚</li></ul><p>ä¼ªç±»çš„æ•ˆæœå¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ªå®é™…çš„ç±»æ¥è¾¾åˆ°ï¼Œè€Œä¼ªå…ƒç´ çš„æ•ˆæœåˆ™éœ€è¦é€šè¿‡æ·»åŠ ä¸€ä¸ªå®é™…çš„å…ƒç´ æ‰èƒ½è¾¾åˆ°ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä»–ä»¬ä¸€ä¸ªç§°ä¸ºä¼ªç±»ï¼Œä¸€ä¸ªç§°ä¸ºä¼ªå…ƒç´ çš„åŸå› ã€‚</p><p>ä¼ªç±»å’Œä¼ªå…ƒç´ çš„æ ¹æœ¬åŒºåˆ«åœ¨äºï¼šå®ƒä»¬æ˜¯å¦åˆ›é€ äº†<strong>æ–°</strong>çš„å…ƒç´ ,,   è¿™ä¸ªæ–°åˆ›é€ çš„å…ƒç´ å°±å«  â€œä¼ªæ— ç´ â€ ã€‚</p><p>##ä¼ªç±»</p><p>ä¼ªç±»å‰é¢æ˜¯ä¸€ä¸ªå†’å·ï¼Œ<code>E:first-child</code>ä¼šå¯¹ç°æœ‰çš„å…ƒç´ è¿›è¡Œç­›é€‰</p><ul><li><p><code>:link</code>:é€‰æ‹©æœªè®¿é—®çš„é“¾æ¥</p></li><li><p><code>:visited</code>:é€‰æ‹©å·²è®¿é—®çš„é“¾æ¥</p></li><li><p><code>:hover</code>:é€‰æ‹©é¼ æ ‡æŒ‡é’ˆæµ®åŠ¨åœ¨å…¶ä¸Šçš„å…ƒç´ </p></li><li><p><code>:active</code>:é€‰æ‹©æ´»åŠ¨çš„é“¾æ¥</p></li><li><p><code>:focus</code>:é€‰æ‹©è·å–ç„¦ç‚¹çš„è¾“å…¥å­—æ®µ</p></li><li><p><code>:not()</code>:ä¸€ä¸ªå¦å®šä¼ªç±»ï¼Œç”¨äºåŒ¹é…ä¸ç¬¦åˆå‚æ•°é€‰æ‹©å™¨çš„å…ƒç´ ã€‚</p></li><li><p><code>:first-child</code>:åŒ¹é…å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ã€‚</p></li><li><p><code>:last-child</code>:åŒ¹é…å…ƒç´ çš„æœ€åä¸€ä¸ªå­å…ƒç´ ã€‚</p></li><li><p><code>:first-of-type</code>:åŒ¹é…å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ªç‰¹å®šç±»å‹çš„å­å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚</p></li><li><p><code>:last-of-type</code>:åŒ¹é…å±äºå…¶çˆ¶å…ƒç´ çš„æœ€åä¸€ä¸ªç‰¹å®šç±»å‹çš„å­å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚</p></li><li><p><code>:nth-child</code>:<code>:nth-child</code>æ ¹æ®å…ƒç´ çš„ä½ç½®åŒ¹é…ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ï¼Œå®ƒæ¥å—ä¸€ä¸ª an+b å½¢å¼çš„å‚æ•°ï¼Œan+b åŒ¹é…åˆ°çš„å…ƒç´ </p></li><li><p><code>:nth-last-child</code>:<code>:nth-last-child</code> ä¸<code>:nth-child</code>ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯ä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°çš„ã€‚</p></li><li><p><code>:nth-of-type</code>:<code>:nth-of-type</code> ä¸ <code>nth-child</code>ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯åªåŒ¹é…ç‰¹å®šç±»å‹çš„å…ƒç´ ã€‚</p></li><li><p><code>:nth-last-type</code>:<code>:nth-last-of-type</code> ä¸ <code>nth-of-type</code>ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯ä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°çš„ã€‚</p></li><li><p><code>:only-child</code> :å½“å…ƒç´ æ˜¯å…¶çˆ¶å…ƒç´ ä¸­å”¯ä¸€ä¸€ä¸ªç‰¹å®šç±»å‹çš„å­å…ƒç´ æ—¶ï¼Œ<code>:only-child</code>åŒ¹é…è¯¥å…ƒç´ ã€‚</p></li><li><p><code>:target</code> :å½“URLå¸¦æœ‰é”šåç§°ï¼ŒæŒ‡å‘æ–‡æ¡£å†…æŸä¸ªå…·ä½“çš„å…ƒç´ æ—¶ï¼Œ<code>:target</code>åŒ¹é…è¯¥å…ƒç´ ã€‚</p></li><li><p><code>:checked</code>:<code>:checked</code>åŒ¹é…è¢«é€‰ä¸­çš„ input å…ƒç´ ï¼Œè¿™ä¸ª input å…ƒç´ åŒ…æ‹¬ radio å’Œ checkboxã€‚</p></li><li><p><code>:default</code>: åŒ¹é…é»˜è®¤é€‰ä¸­çš„å…ƒç´ </p></li><li><p><code>:disabled</code>: åŒ¹é…ç¦ç”¨çš„è¡¨å•å…ƒç´ ã€‚</p></li><li><p><code>:empty</code> :åŒ¹é…æ²¡æœ‰å­å…ƒç´ çš„å…ƒç´ </p></li><li><p><code>:enabled</code>: åŒ¹é…æ²¡æœ‰è®¾ç½® disabled å±æ€§çš„è¡¨å•å…ƒç´ ã€‚</p></li><li><p><code>:in-range</code>: åŒ¹é…åœ¨æŒ‡å®šåŒºåŸŸå†…å…ƒç´ ã€‚</p></li><li><p><code>:out-of-range</code>: ä¸<code>:in-range</code>ç›¸åï¼Œå®ƒåŒ¹é…ä¸åœ¨æŒ‡å®šåŒºåŸŸå†…çš„å…ƒç´ ã€‚</p></li><li><p><code>:indeterminate</code>:indeterminate çš„è‹±æ–‡æ„æ€æ˜¯â€œ ä¸ç¡®å®šçš„â€ã€‚å½“æŸç»„ä¸­çš„å•é€‰æ¡†æˆ–å¤é€‰æ¡†è¿˜æ²¡æœ‰é€‰å–çŠ¶æ€æ—¶ï¼Œ:indeterminate åŒ¹é…è¯¥ç»„ä¸­æ‰€æœ‰çš„å•é€‰æ¡†æˆ–å¤é€‰æ¡†ã€‚</p></li><li><p><code>:valid</code> :åŒ¹é…æ¡ä»¶éªŒè¯æ­£ç¡®çš„è¡¨å•å…ƒç´ ã€‚</p></li><li><p><code>:invalid</code>: ä¸<code>:valid</code> ç›¸åï¼ŒåŒ¹é…æ¡ä»¶éªŒè¯é”™è¯¯çš„è¡¨å•å…ƒç´ ã€‚</p></li><li><p><code>:optional</code>:åŒ¹é…æ˜¯å…·æœ‰ optional å±æ€§çš„è¡¨å•å…ƒç´ ã€‚å½“è¡¨å•å…ƒç´ æ²¡æœ‰è®¾ç½®ä¸º required æ—¶ï¼Œå³ä¸º optional å±æ€§ã€‚</p></li><li><p><code>:required</code>: ä¸<code>:optional</code>ç›¸ååŒ¹é…è®¾ç½®äº† required å±æ€§çš„è¡¨å•å…ƒç´ ã€‚</p></li><li><p><code>:read-only</code>: åŒ¹é…è®¾ç½®äº†åªè¯»å±æ€§çš„å…ƒç´ ï¼Œè¡¨å•å…ƒç´ å¯ä»¥é€šè¿‡è®¾ç½®â€œreadonlyâ€ å±æ€§æ¥å®šä¹‰å…ƒç´ åªè¯»ã€‚</p></li><li><p><code>:read-write</code>: åŒ¹é…å¤„äºç¼–è¾‘çŠ¶æ€çš„å…ƒç´ ã€‚inputï¼Œtextarea å’Œè®¾ç½®äº† contenteditable çš„ HTML å…ƒç´ è·å–ç„¦ç‚¹æ—¶å³å¤„äºç¼–è¾‘çŠ¶æ€ã€‚</p></li><li><p><code>:scope</code>: åŒ¹é…å¤„äº style ä½œç”¨åŸŸä¸‹çš„å…ƒç´ ã€‚å½“ style æ²¡æœ‰è®¾ç½® scope å±æ€§æ—¶ï¼Œstyle å†…çš„æ ·å¼ä¼šå¯¹æ•´ä¸ª html èµ·ä½œç”¨ã€‚</p></li><li><p><code>:dir</code>:åŒ¹é…æŒ‡å®šé˜…è¯»æ–¹å‘çš„å…ƒç´ ï¼Œå½“ HTML å…ƒç´ ä¸­è®¾ç½®äº† dir å±æ€§æ—¶è¯¥ä¼ªç±»æ‰èƒ½ç”Ÿæ•ˆã€‚ç°æ—¶æ”¯æŒçš„é˜…è¯»æ–¹å‘æœ‰ä¸¤ç§ï¼šltrï¼ˆä»å·¦å¾€å³ï¼‰å’Œ rtlï¼ˆä»å³å¾€å·¦ï¼‰ã€‚ç›®å‰ï¼Œåªæœ‰ç«ç‹æµè§ˆå™¨æ”¯æŒ:dir ä¼ªç±»ï¼Œå¹¶åœ¨ç«ç‹æµè§ˆå™¨ä¸­ä½¿ç”¨æ—¶éœ€è¦æ·»åŠ å‰ç¼€ ( -moz-dir() )ã€‚</p></li><li><p><code>:lang</code>:åŒ¹é…è®¾ç½®äº†ç‰¹å®šè¯­è¨€çš„å…ƒç´ ï¼Œè®¾ç½®ç‰¹å®šè¯­è¨€å¯ä»¥é€šè¿‡ä¸ºäº† HTML å…ƒç´ è®¾ç½® lang=â€â€ å±æ€§ï¼Œè®¾ç½® meta å…ƒç´ çš„ charset=â€â€ å±æ€§ï¼Œæˆ–è€…æ˜¯åœ¨ http å¤´éƒ¨ä¸Šè®¾ç½®è¯­è¨€å±æ€§ã€‚</p><p>å®é™…ä¸Šï¼Œlang=â€â€ å±æ€§ä¸åªå¯ä»¥åœ¨ html æ ‡ç­¾ä¸Šè®¾ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶ä»–çš„å…ƒç´ ä¸Šè®¾ç½®ã€‚</p></li></ul><ul><li><code>:root</code>:åŒ¹é…æ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚ä¸€èˆ¬çš„ html æ–‡ä»¶çš„æ ¹å…ƒç´ æ˜¯ html å…ƒç´ ï¼Œè€Œ SVG æˆ– XML æ–‡ä»¶çš„æ ¹å…ƒç´ åˆ™å¯èƒ½æ˜¯å…¶ä»–å…ƒç´ ã€‚</li><li><code>:fullscreen</code>: åŒ¹é…å¤„äºå…¨å±æ¨¡å¼ä¸‹çš„å…ƒç´ ã€‚å…¨å±æ¨¡å¼ä¸æ˜¯é€šè¿‡æŒ‰ F11 æ¥æ‰“å¼€çš„å…¨å±æ¨¡å¼ï¼Œè€Œæ˜¯é€šè¿‡ Javascript çš„ Fullscreen API æ¥æ‰“å¼€çš„ï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„ Fullscreen APIã€‚ç›®å‰ï¼Œ:fullscreen éœ€è¦æ·»åŠ å‰ç¼€æ‰èƒ½ä½¿ç”¨ã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g79wl6d5ouj30gi0exq4h.jpg" alt="img"></p><p>##ä¼ªå…ƒç´ </p><p>ä¼ªå…ƒç´ å‰é¢æ˜¯ä¸¤ä¸ªå†’å·ï¼Œ<code>E::first-line</code>ä¼šåˆ›é€ å‡ºä¸å­˜åœ¨çš„æ–°å…ƒç´ ï¼Œç”±äºcsså¯¹å•å†’å·çš„ä¼ªå…ƒç´ ä¹Ÿæ”¯æŒï¼Œæ‰€ä»¥è¿™æ ·å¾ˆå®¹æ˜“è®©æ–°å­¦è€…æ··æ·†ã€‚ä½†å®é™…ä¸Šç°åœ¨css3å·²ç»æ˜ç¡®è§„å®šäº†ä¼ªç±»å•å†’å·ï¼Œä¼ªå…ƒç´ åŒå†’å·çš„è§„åˆ™ã€‚</p><ul><li><p><code>::before/:before</code>åœ¨è¢«é€‰å…ƒç´ å‰æ’å…¥å†…å®¹ã€‚éœ€è¦ä½¿ç”¨ content å±æ€§æ¥æŒ‡å®šè¦æ’å…¥çš„å†…å®¹ã€‚è¢«æ’å…¥çš„å†…å®¹å®é™…ä¸Šä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚</p></li><li><p><code>::after/:after</code> åœ¨è¢«å…ƒç´ åæ’å…¥å†…å®¹ï¼Œå…¶ç”¨æ³•å’Œç‰¹æ€§ä¸<code>:before</code>ç›¸ä¼¼ã€‚</p><p>å¯¹äºä¼ªå…ƒç´  <code>:before</code> å’Œ <code>:after</code> è€Œè¨€ï¼Œå±æ€§ <code>content</code> æ˜¯å¿…é¡»è®¾ç½®çš„ï¼Œæˆ‘ä»¬çŸ¥é“å±æ€§çš„å€¼å¯ä»¥ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æœ‰å…¶å®ƒå½¢å¼ï¼Œæ¯”å¦‚æŒ‡å‘ä¸€å¼ å›¾ç‰‡çš„ <code>URL:</code></p><p><code>content: url(&#39;img/icon.png&#39;)</code></p></li><li><p><code>::first-letter/:first-letter</code> åŒ¹é…å…ƒç´ ä¸­æ–‡æœ¬çš„é¦–å­—æ¯ã€‚è¢«ä¿®é¥°çš„é¦–å­—æ¯ä¸åœ¨æ–‡æ¡£æ ‘ä¸­</p></li><li><p><code>::first-line/:first-line</code> åŒ¹é…å…ƒç´ ä¸­ç¬¬ä¸€è¡Œçš„æ–‡æœ¬ã€‚è¿™ä¸ªä¼ªå…ƒç´ åªèƒ½ç”¨åœ¨å—å…ƒç´ ä¸­ï¼Œä¸èƒ½ç”¨åœ¨å†…è”å…ƒç´ ä¸­ã€‚</p></li><li><p><code>::selection</code> åŒ¹é…ç”¨æˆ·è¢«ç”¨æˆ·é€‰ä¸­æˆ–è€…å¤„äºé«˜äº®çŠ¶æ€çš„éƒ¨åˆ†ã€‚åœ¨ç«ç‹æµè§ˆå™¨ä½¿ç”¨æ—¶éœ€è¦æ·»åŠ <code>-moz</code>å‰ç¼€ã€‚è¯¥ä¼ªå…ƒç´ åªæ”¯æŒåŒå†’å·çš„å½¢å¼ã€‚</p></li><li><p><code>::placeholder</code> åŒ¹é…å ä½ç¬¦çš„æ–‡æœ¬ï¼Œåªæœ‰å…ƒç´ è®¾ç½®äº†<code>placeholder</code>å±æ€§æ—¶ï¼Œè¯¥ä¼ªå…ƒç´ æ‰èƒ½ç”Ÿæ•ˆã€‚</p><p>ä¼ªå…ƒç´ ä¸æ˜¯<code>CSS</code>çš„æ ‡å‡†ï¼Œå®ƒçš„å®ç°å¯èƒ½åœ¨å°†æ¥ä¼šæœ‰æ‰€æ”¹å˜ï¼Œæ‰€ä»¥è¦å†³å®šä½¿ç”¨æ—¶å¿…é¡»è°¨æ…ã€‚åœ¨ä¸€äº›æµè§ˆå™¨ä¸­ï¼ˆ<code>IE10</code>å’Œ<code>Firefox18</code>åŠå…¶ä»¥ä¸‹ç‰ˆæœ¬ï¼‰ä¼šä½¿ç”¨å•å†’å·çš„å½¢å¼ã€‚</p></li></ul><ul><li><code>::backdrop</code> ç”¨äºæ”¹å˜å…¨å±æ¨¡å¼ä¸‹çš„èƒŒæ™¯é¢œè‰²ï¼Œå…¨å±æ¨¡å¼çš„é»˜è®¤é¢œè‰²ä¸ºé»‘è‰²ã€‚è¯¥ä¼ªå…ƒç´ åªæ”¯æŒåŒå†’å·çš„å½¢å¼</li></ul><p>æ³¨æ„ï¼š</p><ul><li>é…åˆä¼ªç±»ä½¿ç”¨<ul><li>ä¼ªå…ƒç´  <code>:before</code> è¿˜å¯ä»¥é…åˆä¼ªç±»ä½¿ç”¨ï¼Œè¿™é‡Œä¸¾ç»å¸¸ä¸ <code>:before</code> é…åˆä½¿ç”¨çš„ä¼ªç±» <code>:hover</code> ä¸ºä¾‹ï¼š</li></ul></li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.before</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">:before</span>&#123;<span class="attribute">content</span>:<span class="string">'you before'</span>; <span class="attribute">color</span>:red;&#125;</span><br><span class="line">&lt;div class="before"&gt; me&lt;/div&gt;</span><br></pre></td></tr></table></figure><ul><li>é…åˆå–å€¼å‡½æ•° <code>attr()</code> ä½¿ç”¨</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">::before</span>&#123;<span class="attribute">content</span>: <span class="built_in">attr</span>(title)&#125;</span><br><span class="line">&lt;a href="https://blog.ihoey.com" title="æ¢¦é­‡å°æ ˆ"&gt;&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">æ•ˆæœ</span><br><span class="line">&lt;a href="https://blog.ihoey.com" title="æ¢¦é­‡å°æ ˆ"&gt;æ¢¦é­‡å°æ ˆ&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g79wlwrg6aj30dn05w3yy.jpg" alt="img"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ä¼ªç±»å’Œä¼ªå…ƒç´ &quot;&gt;&lt;a href=&quot;#ä¼ªç±»å’Œä¼ªå…ƒç´ &quot; class=&quot;headerlink&quot; title=&quot;ä¼ªç±»å’Œä¼ªå…ƒç´ &quot;&gt;&lt;/a&gt;ä¼ªç±»å’Œä¼ªå…ƒç´ &lt;/h1&gt;&lt;p&gt;&lt;code&gt;css&lt;/code&gt;å¼•å…¥ä¼ªç±»å’Œä¼ªå…ƒç´ æ¦‚å¿µæ˜¯ä¸ºäº†æ ¼å¼åŒ–æ–‡æ¡£æ ‘ä»¥å¤–çš„ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ªç±»å’Œä¼ªå…ƒç´ æ˜¯ç”¨
      
    
    </summary>
    
      <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
      <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
      <category term="ä¼ªå…ƒç´ " scheme="http://yoursite.com/tags/%E4%BC%AA%E5%85%83%E7%B4%A0/"/>
    
      <category term="ä¼ªç±»" scheme="http://yoursite.com/tags/%E4%BC%AA%E7%B1%BB/"/>
    
  </entry>
  
  <entry>
    <title>sass&amp;lesså¯¹æ¯”</title>
    <link href="http://yoursite.com/2019/11/11/sass&amp;less%E5%AF%B9%E6%AF%94/"/>
    <id>http://yoursite.com/2019/11/11/sass&amp;lesså¯¹æ¯”/</id>
    <published>2019-11-11T06:09:00.000Z</published>
    <updated>2019-11-10T15:36:08.788Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sass-amp-less"><a href="#sass-amp-less" class="headerlink" title="sass&amp;less"></a>sass&amp;less</h1><p>##ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ CSS é¢„å¤„ç†å™¨ï¼Ÿ</p><p>ä½œä¸ºå‰ç«¯å¼€å‘äººå‘˜ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼ŒJs ä¸­å¯ä»¥è‡ªå®šä¹‰å˜é‡ï¼Œè€Œ CSS ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è®°è¯­è¨€ï¼Œä¸æ˜¯ç¼–ç¨‹è¯­è¨€ï¼Œå› æ­¤ä¸å¯ä»¥è‡ªå®šä¹‰å˜é‡ï¼Œä¸å¯ä»¥å¼•ç”¨ç­‰ç­‰ã€‚</p><p><strong>CSS æœ‰å…·ä½“ä»¥ä¸‹å‡ ä¸ªç¼ºç‚¹ï¼š</strong></p><p>è¯­æ³•ä¸å¤Ÿå¼ºå¤§ï¼Œæ¯”å¦‚æ— æ³•åµŒå¥—ä¹¦å†™ï¼Œå¯¼è‡´æ¨¡å—åŒ–å¼€å‘ä¸­éœ€è¦ä¹¦å†™å¾ˆå¤šé‡å¤çš„é€‰æ‹©å™¨ï¼›</p><p>æ²¡æœ‰å˜é‡å’Œåˆç†çš„æ ·å¼å¤ç”¨æœºåˆ¶ï¼Œä½¿å¾—é€»è¾‘ä¸Šç›¸å…³çš„å±æ€§å€¼å¿…é¡»ä»¥å­—é¢é‡çš„å½¢å¼é‡å¤è¾“å‡ºï¼Œå¯¼è‡´éš¾ä»¥ç»´æŠ¤ã€‚</p><p>è¿™å°±å¯¼è‡´äº†æˆ‘ä»¬åœ¨å·¥ä½œä¸­æ— ç«¯å¢åŠ äº†è®¸å¤šå·¥ä½œé‡ã€‚è€Œä½¿ç”¨ CSS é¢„å¤„ç†å™¨ï¼Œæä¾› CSS ç¼ºå¤±çš„æ ·å¼å±‚å¤ç”¨æœºåˆ¶ã€å‡å°‘å†—ä½™ä»£ç ï¼Œæé«˜æ ·å¼ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚å¤§å¤§æé«˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚</p><p>ä½†æ˜¯ï¼ŒCSS é¢„å¤„ç†å™¨ä¹Ÿä¸æ˜¯ä¸‡é‡‘æ²¹ï¼ŒCSS çš„å¥½å¤„åœ¨äºç®€ä¾¿ã€éšæ—¶éšåœ°è¢«ä½¿ç”¨å’Œè°ƒè¯•ã€‚é¢„ç¼–è¯‘ CSS æ­¥éª¤çš„åŠ å…¥ï¼Œè®©æˆ‘ä»¬å¼€å‘å·¥ä½œæµä¸­å¤šäº†ä¸€ä¸ªç¯èŠ‚ï¼Œè°ƒè¯•ä¹Ÿå˜å¾—æ›´éº»çƒ¦äº†ã€‚æ›´å¤§çš„é—®é¢˜åœ¨äºï¼Œé¢„ç¼–è¯‘å¾ˆå®¹æ˜“é€ æˆåä»£é€‰æ‹©å™¨çš„æ»¥ç”¨ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­è¡¡é‡é¢„ç¼–è¯‘æ–¹æ¡ˆæ—¶ï¼Œè¿˜æ˜¯å¾—æƒ³æƒ³ï¼Œæ¯”èµ·å¸¦æ¥çš„é¢å¤–ç»´æŠ¤å¼€é”€ï¼ŒCSS é¢„å¤„ç†å™¨æœ‰æ²¡æœ‰è§£å†³æ›´å¤§çš„éº»çƒ¦ã€‚</p><h2 id="ä¸»è¦åŒºåˆ«ï¼š"><a href="#ä¸»è¦åŒºåˆ«ï¼š" class="headerlink" title="ä¸»è¦åŒºåˆ«ï¼š"></a>ä¸»è¦åŒºåˆ«ï¼š</h2><p>é¦–å…ˆ sass å’Œ less éƒ½æ˜¯ css çš„é¢„ç¼–è¯‘å¤„ç†è¯­è¨€ï¼Œä»–ä»¬å¼•å…¥äº† mixinsï¼Œå‚æ•°ï¼ŒåµŒå¥—è§„åˆ™ï¼Œè¿ç®—ï¼Œé¢œè‰²ï¼Œåå­—ç©ºé—´ï¼Œä½œç”¨åŸŸï¼ŒJavaScript èµ‹å€¼ç­‰ åŠ å¿«äº† css å¼€å‘æ•ˆç‡,å½“ç„¶è¿™ä¸¤è€…éƒ½å¯ä»¥é…åˆ gulp å’Œ grunt ç­‰å‰ç«¯æ„å»ºå·¥å…·ä½¿ç”¨</p><p>sass å’Œ less<strong>ä¸»è¦åŒºåˆ«:åœ¨äºå®ç°æ–¹å¼ less æ˜¯åŸºäº JavaScript çš„åœ¨å®¢æˆ·ç«¯å¤„ç† æ‰€ä»¥å®‰è£…çš„æ—¶å€™ç”¨ npmï¼Œsass æ˜¯åŸºäº ruby æ‰€ä»¥åœ¨æœåŠ¡å™¨å¤„ç†ã€‚</strong></p><h2 id="SASS-ä»‹ç»"><a href="#SASS-ä»‹ç»" class="headerlink" title="SASS ä»‹ç»"></a>SASS ä»‹ç»</h2><p>Sass æ˜¯ Ruby å¼€å‘è€…ä¸ºå‰ç«¯å¼€å‘æä¾›çš„å¤„ç† CSS çš„å·¥å…·ã€‚å®ƒä¸º CSS æä¾›æ›´åŠ¨æ€çš„è®¾å®šæ–¹å¼ï¼Œå…è®¸ç¼–è¯‘ã€å˜é‡ã€å‡½æ•°â€¦â€¦æ€»ä¹‹ï¼Œä½¿ CSS æ›´åŠ¨æ€ï¼Œä¹Ÿæ›´åƒä¸€é—¨çœŸæ­£çš„å¯ç¼–ç¨‹è¯­è¨€ã€‚</p><ol><li>Sass æ˜¯åŸºäº Ruby å¼€å‘çš„ï¼Œæ‰€ä»¥å¼€å‘ç¯å¢ƒé¦–å…ˆéœ€è¦å®‰è£… Rubyã€‚</li><li>æµè§ˆå™¨ä¸­æ— æ³•ç¼–è¯‘ Sassï¼Œæ‰€ä»¥è¦å…ˆç¼–è¯‘å¥½ css æ–‡ä»¶ï¼Œå†äº¤ç»™æµè§ˆå™¨ã€‚Sass<strong>ä¸èƒ½</strong>åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ç›´æ¥è¿è¡Œã€‚</li></ol><p>##Less ä»‹ç»</p><p>Less æ˜¯æ™šäº›äº§ç”Ÿçš„è¯­è¨€ï¼ŒåŸºäº JS è¿›è¡Œå¼€å‘ï¼Œåœ¨ Node ä¸­è¿›è¡Œç¼–è¯‘ã€‚æ‰€ä»¥ä½¿ç”¨æ—¶ä¸éœ€è¦å®‰è£…å…¶ä»–è¯­è¨€ï¼Œä¸è¿‡è¦è®°å¾—<strong>å…ˆå¯¼å…¥ less æ–‡ä»¶ï¼Œç„¶åå¯¼å…¥ less.js</strong>ã€‚æä¾› CDN åœ°å€åœ¨è¿™é‡Œï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/less.js/3.0.4/less.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/less.js/3.0.4/less.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶ Less ä¹Ÿæä¾›æœåŠ¡å™¨ç«¯çš„ç¼–è¯‘åŠŸèƒ½ã€‚</p><h2 id="Stylus-ä»‹ç»"><a href="#Stylus-ä»‹ç»" class="headerlink" title="Stylus ä»‹ç»"></a>Stylus ä»‹ç»</h2><p><a href="https://link.juejin.im?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttp%3A%2F%2Flearnboost.github.io%2Fstylus%2F" target="_blank" rel="noopener">Stylus</a>ç›¸å¯¹å‰ä¸¤è€…è¾ƒæ–°ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ä»‹ç»çš„åŠŸèƒ½ã€‚</p><p>1.æ¥è‡ª NodeJS ç¤¾åŒºï¼Œæ‰€ä»¥å’Œ NodeJS èµ°å¾—å¾ˆè¿‘ï¼Œä¸ JavaScript è”ç³»éå¸¸ç´§å¯†ã€‚è¿˜æœ‰ä¸“é—¨ JavaScript APIï¼š<a href="https://link.juejin.im?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttp%3A%2F%2Flearnboost.github.io%2Fstylus%2Fdocs%2Fjs.html" target="_blank" rel="noopener">learnboost.github.io/stylus/docsâ€¦</a></p><p>2.æ”¯æŒ Ruby ä¹‹ç±»ç­‰ç­‰æ¡†æ¶</p><p>3.æ›´å¤šæ›´å¼ºå¤§çš„æ”¯æŒå’ŒåŠŸèƒ½</p><p>ä»¥ stylus çš„è§’åº¦æ¥è¯´,stylus æ›´åŠ æ³¨é‡å¯¹ javascript( <a href="https://link.juejin.im?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttp%3A%2F%2Flearnboost.github.io%2Fstylus%2Fdocs%2Fjs.html" target="_blank" rel="noopener">learnboost.github.io/stylus/docsâ€¦</a> ) çš„åˆ©ç”¨ã€‚ å½“ç”¨æˆ·è§‰å¾—å†™ stylus å‡½æ•°é‡åˆ°äº†è¿‡äºå¤æ‚æˆ–è€…æ— æ³•æµ‹è¯•ï¼Œstylus è¯­æ³•ä¸æ”¯æŒç­‰éœ€æ±‚æ—¶ï¼Œ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ js æ¥å®ç°è¿™ä¸ªå‡½æ•°å¹¶ä¸”åœ¨ stylus ä¸­è°ƒç”¨ã€‚</p><p>å…¶æ¬¡ä»ç¼–è¯‘å™¨æºç ä¸Šæ¥çœ‹ï¼šstylus åº”è¯¥æ¯” less.js æ›´æœ‰æ¡ç†ï¼Œ æ„Ÿè§‰å¦‚æœæœªæ¥ç¤¾åŒºæ·»åŠ åŠŸèƒ½çš„è¯ï¼Œstylus çš„æºç æ·»åŠ èµ·åŠŸèƒ½æ¥ä¼šæ›´ç®€å•ï¼ŒåŒæ ·ï¼Œç›®å‰ stylus çš„åŠŸèƒ½ä¹Ÿæ›´å¤æ‚ã€‚</p><p>stylus å’Œ sass å¦ä¸€ä¸ªåŒºåˆ«åœ¨äº sass æœ¬èº«ä¼šå»ºè®®ï¼Œä»¥ä¸‹åˆ’çº¿(_) æ‰“å¤´çš„æ–‡ä»¶åœ¨é™æ€èµ„æºæ‰“åŒ…çš„æ—¶å€™ä¸ä¼šè¢«ç¼–è¯‘æˆ .css æ–‡ä»¶ã€åªæ˜¯ä½œä¸ºä¸€ç§ import å­˜åœ¨ã€‘ã€‚è€Œ stylus æ²¡æœ‰è¿™æ–¹é¢çš„è§„èŒƒã€‚</p><p>åŒæ—¶å†™è¿‡ stylus å’Œ sassï¼Œ å°±è¯­æ³•ç®€æ´æ¥çœ‹ï¼Œ stylus åœ¨è¿™æ–¹é¢å äº†å¾ˆå¤§çš„ä¾¿å®œã€‚</p><h2 id="ä¸‰è€…å¯¹æ¯”"><a href="#ä¸‰è€…å¯¹æ¯”" class="headerlink" title="ä¸‰è€…å¯¹æ¯”"></a><a href="https://cloud.tencent.com/developer/article/1092653" target="_blank" rel="noopener">ä¸‰è€…å¯¹æ¯”</a></h2><ul><li><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3></li></ul><p>Sass: $var<br>Less: @var<br>ä¸¤ç§è¯­è¨€éƒ½ä¼šæœ‰ä½œç”¨åŸŸçš„é—®é¢˜ã€‚ä¸€ä¸ªå˜é‡åªèƒ½åœ¨å®ƒè¢«å®šä¹‰çš„ä»£ç å—ä¸­ä½¿ç”¨ã€‚é‡å¤å®šä¹‰çš„å˜é‡ä¼šæŠ¥é”™ã€‚</p><p>Stylus å¯¹å˜é‡åæ²¡æœ‰ä»»ä½•é™å®šï¼Œä½ å¯ä»¥æ˜¯ $ å¼€å§‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»»æ„çš„å­—ç¬¦ï¼Œè€Œä¸”ä¸å˜é‡å€¼ä¹‹é—´å¯ä»¥ç”¨å†’å·ã€ç©ºæ ¼éš”å¼€ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ Stylus (0.22.4) å°†ä¼šç¼–è¯‘ @ å¼€å§‹çš„å˜é‡ï¼Œä½†å…¶å¯¹åº”çš„å€¼å¹¶ä¸ä¼šèµ‹äºˆè¯¥å˜é‡ï¼Œæ¢å¥è¯è¯´ï¼Œåœ¨ Stylus çš„å˜é‡åä¸è¦ç”¨ @ å¼€å¤´ã€‚</p><ul><li><h3 id="è¿ç®—èµ‹å€¼ï¼š"><a href="#è¿ç®—èµ‹å€¼ï¼š" class="headerlink" title="è¿ç®—èµ‹å€¼ï¼š"></a>è¿ç®—èµ‹å€¼ï¼š</h3></li></ul><p>åªè¦ä¿æŒå•ä½ç»Ÿä¸€æˆ–å¯ç›¸äº’è½¬æ¢ï¼Œå°±å¯ä»¥è¿›è¡Œè¿ç®—ï¼ŒåŒ…æ‹¬é¢œè‰²åœ¨å†…ï¼š<br>Sass:</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: e + -resize;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç¼–è¯‘ä¸º</span></span><br><span class="line"><span class="comment">// p &#123;</span></span><br><span class="line"><span class="comment">//   cursor: e-resize;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: (<span class="number">14px</span>/<span class="number">2</span>);</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50px</span> + <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="variable">$var</span> * <span class="number">10%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Less:</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@base:</span> <span class="number">5%</span>;</span><br><span class="line"><span class="variable">@filler:</span> <span class="variable">@base</span> * <span class="number">2</span>;</span><br><span class="line"><span class="variable">@other:</span> <span class="variable">@base</span> + <span class="variable">@filler</span>;</span><br><span class="line"></span><br><span class="line"><span class="attribute">color</span>: <span class="number">#888</span> / <span class="number">4</span>;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="variable">@base-color</span> + <span class="number">#111</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100%</span> / <span class="number">2</span> + <span class="variable">@filler</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">@var:</span> <span class="number">1px</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="attribute">width</span>: (<span class="variable">@var</span> + <span class="number">5</span>) * <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="attribute">border</span>: (<span class="variable">@width</span> * <span class="number">2</span>) solid black;</span><br></pre></td></tr></table></figure><ul><li><h3 id="åµŒå¥—"><a href="#åµŒå¥—" class="headerlink" title="åµŒå¥—"></a>åµŒå¥—</h3></li></ul><p>Sass å’Œ Less å‡å…è®¸å…ƒç´ åµŒå¥—ã€‚å¦‚æœçˆ¶å­é€‰æ‹©å™¨å‡ç”¨é€—å·åˆ†å¼€ï¼Œé‚£ä¹ˆç¼–è¯‘æ—¶ä¼šæŒ‰ç»“åˆå¾‹æ‹†å¼€ç¼–è¯‘ã€‚<br>Sass å’Œ Less æŒ‡ä»£ä¸Šå±‚å…ƒç´ å‡ä½¿ç”¨<code>&amp;</code>ç¬¦å·ã€‚</p><ul><li><h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3></li></ul><p>Sass ä¸­ï¼Œå†™å¥½çš„é€‰æ‹©å™¨è¿›è¡Œé›†æˆï¼Œéœ€è¦<code>@extend</code>å…³é”®å­—ã€‚ï¼ˆsytlus ä¸ sass ç›¸åŒï¼‰<br>Less ä¸­ï¼Œç›´æ¥å†™å…¥å³å¯ï¼š<code>.be-extend-class;</code></p><ul><li><h3 id="Mixin"><a href="#Mixin" class="headerlink" title="Mixin"></a>Mixin</h3></li></ul><p>Sass ä¸­ï¼Œéœ€è¦è¿›è¡Œ Mixin æ“ä½œçš„é€‰æ‹©å™¨éœ€è¦<code>@mixin</code>å…³é”®å­—ï¼Œé€‰æ‹©å™¨åå¯ä»¥ä¼ å…¥å˜é‡å’Œé»˜è®¤å€¼ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">mixin</span> left(<span class="variable">$value</span>: 10px) padding: <span class="variable">$value</span>;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¶ä½¿ç”¨<code>@include</code>å…³é”®å­—ï¼Œå¹¶å¯ä»¥æ›´æ–°å˜é‡ï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">include</span> left @<span class="keyword">include</span> left(<span class="number">20px</span>);</span><br></pre></td></tr></table></figure><p>Less ä¸­ Mixin å’Œç»§æ‰¿æ„Ÿè§‰æ›´ç›¸ä¼¼ï¼Œé€‰æ‹©å™¨åœ¨ä¹¦å†™æ—¶å°±ç•™å¥½äº†å˜é‡ï¼Œç›´æ¥ç»§æ‰¿æˆ–æ›´æ–°å˜é‡å³å¯ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.be-extend-class</span>(<span class="variable">@width</span>: <span class="number">10px</span>) &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="variable">@width</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="selector-class">.be-extend-class</span>;</span><br><span class="line"><span class="selector-class">.be-extend-class</span>(<span class="number">20px</span>);</span><br></pre></td></tr></table></figure><p>sassï¼šåœ¨ sass å®šä¹‰ Mixins å’Œ lessã€stylus æœ‰æ‰€ä¸åŒï¼Œåœ¨å£°æ˜ Mixins æ—¶éœ€è¦ä½¿ç”¨â€œ@mixinâ€,ç„¶ååé¢ç´§è·Ÿ Mixins çš„åï¼Œä»–ä¹Ÿå¯ä»¥å®šä¹‰å‚æ•°ï¼ŒåŒæ—¶å¯ä»¥ç»™è¿™ä¸ªå‚æ•°è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œä½†å‚æ•°åæ˜¯ä½¿ç”¨â€œ$â€ç¬¦å·å¼€å§‹ï¼Œè€Œä¸”å’Œå‚æ•°å€¼ä¹‹é—´éœ€è¦ä½¿ç”¨å†’å·ï¼ˆï¼šï¼‰åˆ†å¼€ã€‚å¦å¤–åœ¨ sass ä¸­è°ƒç”¨ Mixins éœ€è¦ä½¿ç”¨â€œ@includeâ€ï¼Œç„¶ååœ¨å…¶åç´§è·Ÿä½ è¦è°ƒç”¨çš„ Mixins åã€‚</p><p>lessï¼šless ä¸­å£°æ˜ Mixins å’Œ CSS å®šä¹‰æ ·å¼éå¸¸ç±»ä¼¼ï¼Œå¯ä»¥å°† Mixins çœ‹æˆæ˜¯ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œå½“ç„¶ Mixins ä¹Ÿå¯ä»¥è®¾ç½®å‚æ•°ï¼Œå¹¶ç»™å‚æ•°è®¾ç½®é»˜è®¤å€¼ã€‚ä¸è¿‡è®¾ç½®å‚æ•°çš„å˜é‡åæ˜¯ä½¿ç”¨â€œ@â€å¼€å§‹ï¼ŒåŒæ ·å‚æ•°å’Œé»˜è®¤å‚æ•°å€¼ä¹‹é—´éœ€è¦ä½¿ç”¨å†’å·ï¼ˆï¼šï¼‰åˆ†å¼€ã€‚</p><p>stylusï¼šstylus å’Œå‰ä¸¤è€…ä¹Ÿç•¥æœ‰ä¸åŒï¼Œä»–å¯ä»¥ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ï¼Œå°±æ˜¯ç›´æ¥å®šä¹‰ Mixins åï¼Œç„¶ååœ¨å®šä¹‰å‚æ•°å’Œé»˜è®¤å€¼ä¹‹é—´ç”¨ç­‰å·ï¼ˆ=ï¼‰æ¥è¿æ¥ã€‚</p><ul><li><h3 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h3></li></ul><p>ä¸¤ç§è¯­è¨€ç›¸åŒï¼šå¤šè¡Œæ³¨é‡Šæ ¼å¼å¯ä¿ç•™ï¼Œå•è¡Œæ³¨é‡Šæ ¼å¼ä¼šåœ¨ç¼–è¯‘æ—¶è¢«åˆ é™¤ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ä¼šè¢«ä¿ç•™çš„æ³¨é‡Šæ ¼å¼ */</span></span><br><span class="line"><span class="comment">// ä¸ä¿å­˜çš„æ³¨é‡Šæ ¼å¼</span></span><br></pre></td></tr></table></figure><ul><li><h3 id="é¢œè‰²è¿ç®—ï¼š"><a href="#é¢œè‰²è¿ç®—ï¼š" class="headerlink" title="é¢œè‰²è¿ç®—ï¼š"></a>é¢œè‰²è¿ç®—ï¼š</h3></li></ul><p>CSS é¢„å¤„ç†å™¨æä¾›ä¸€ç³»åˆ—<strong>é¢œè‰²å‡½æ•°</strong>å¸®åŠ©ç”Ÿæˆä¸»é¢˜ç³»åˆ—é¢œè‰²ï¼š<br>Sassï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lighten(<span class="selector-id">#cc3</span>, 10%) <span class="comment">// #d6d65c</span></span><br><span class="line">darken(<span class="selector-id">#cc3</span>, 10%) <span class="comment">// #a3a329</span></span><br><span class="line">grayscale(<span class="selector-id">#cc3</span>) <span class="comment">// #808080 ç°åº¦</span></span><br><span class="line">complement(<span class="selector-id">#cc3</span>) <span class="comment">// #33c</span></span><br></pre></td></tr></table></figure><p>Lessï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">lighten</span>(<span class="variable">@color</span>, <span class="number">10%</span>);     <span class="comment">// return a color which is 10% *lighter* than @color</span></span><br><span class="line"><span class="selector-tag">darken</span>(<span class="variable">@color</span>, <span class="number">10%</span>);      <span class="comment">// return a color which is 10% *darker* than @color</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">saturate</span>(<span class="variable">@color</span>, <span class="number">10%</span>);    <span class="comment">// return a color 10% *more* saturated than @color</span></span><br><span class="line"><span class="selector-tag">desaturate</span>(<span class="variable">@color</span>, <span class="number">10%</span>);  <span class="comment">// return a color 10% *less* saturated than @color</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">fadein</span>(<span class="variable">@color</span>, <span class="number">10%</span>);      <span class="comment">// return a color 10% *less* transparent than @color</span></span><br><span class="line"><span class="selector-tag">fadeout</span>(<span class="variable">@color</span>, <span class="number">10%</span>);     <span class="comment">// return a color 10% *more* transparent than @color</span></span><br><span class="line"><span class="selector-tag">fade</span>(<span class="variable">@color</span>, <span class="number">50%</span>);        <span class="comment">// return @color with 50% transparency</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">spin</span>(<span class="variable">@color</span>, <span class="number">10</span>);         <span class="comment">// return a color with a 10 degree larger in hue than @color</span></span><br><span class="line"><span class="selector-tag">spin</span>(<span class="variable">@color</span>, -<span class="number">10</span>);        <span class="comment">// return a color with a 10 degree smaller hue than @color</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">mix</span>(<span class="variable">@color1</span>, <span class="variable">@color2</span>);    <span class="comment">// return a mix of @color1 and @color2</span></span><br></pre></td></tr></table></figure><p>stylusï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lighten(color, 10%); /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šå˜äº®10% */</span><br><span class="line">darken(color, 10%);  /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šå˜æš—10% */</span><br><span class="line">saturate(color, 10%);   /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šé¥±å’Œåº¦å¢åŠ 10% */</span><br><span class="line">desaturate(color, 10%); /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šé¥±å’Œåº¦é™ä½10% */</span><br></pre></td></tr></table></figure><ul><li><h3 id="æ’å…¥æ–‡ä»¶"><a href="#æ’å…¥æ–‡ä»¶" class="headerlink" title="æ’å…¥æ–‡ä»¶"></a>æ’å…¥æ–‡ä»¶</h3></li></ul><p>ä¸¤ç§è¯­è¨€ç›¸åŒï¼Œä½¿ç”¨@import å…³é”®å­—å¼•å…¥ã€‚æ³¨æ„åç¼€åï¼Œå¯ä»¥ç›´æ¥å¯¼å…¥ css æ–‡ä»¶ã€‚åç¼€åä¸º css çš„æ–‡ä»¶ä¸ä¼šè¢«é¢„å¤„ç†å™¨å¤„ç†ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">import</span> <span class="string">"path/filename.scss"</span>;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">import</span> <span class="string">"lib.less"</span>;</span><br><span class="line">@<span class="keyword">import</span> <span class="string">"lib.css"</span>;</span><br></pre></td></tr></table></figure><ul><li><h3 id="é«˜çº§è¯­æ³•ï¼š"><a href="#é«˜çº§è¯­æ³•ï¼š" class="headerlink" title="==é«˜çº§è¯­æ³•ï¼š=="></a>==é«˜çº§è¯­æ³•ï¼š==</h3></li></ul><h4 id="SASS"><a href="#SASS" class="headerlink" title="SASS"></a>SASS</h4><p>åœ¨ Sass ä¸­ï¼Œéœ€è¦ç”¨ Sass è‡ªå·±çš„ä¸€å¥—è¯­è¨€ç¼–ç¨‹ï¼š</p><ol><li>æ¡ä»¶ if-else</li></ol><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">if</span> lightness(<span class="variable">$color</span>) &gt; 30% &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#000</span>;</span><br><span class="line">&#125; @<span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>å¾ªç¯</li></ol><p>for:</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">for</span> <span class="variable">$i</span> from 1 to 10 &#123;</span><br><span class="line">  <span class="selector-class">.border-</span>#&#123;<span class="variable">$i</span>&#125; &#123;</span><br><span class="line">    <span class="attribute">border</span>: #&#123;<span class="variable">$i</span>&#125;px solid blue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>while:</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$i</span>: <span class="number">6</span>;</span><br><span class="line">@<span class="keyword">while</span> <span class="variable">$i</span> &gt; 0 &#123;</span><br><span class="line">  <span class="selector-class">.item-</span>#&#123;<span class="variable">$i</span>&#125; &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">2em</span> * <span class="variable">$i</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$i</span>: <span class="variable">$i</span> - <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>each:</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">each</span> <span class="variable">$member</span> in a, b, c, d &#123;</span><br><span class="line">  .#&#123;<span class="variable">$member</span>&#125; &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: url(<span class="string">"/image/#&#123;$member&#125;.jpg"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>è‡ªå®šä¹‰å‡½æ•°</li></ol><p>éœ€è¦<code>@function</code>ã€<code>@return</code>å…³é”®å­—ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@function double(<span class="variable">$n</span>) &#123;</span><br><span class="line">  @return <span class="variable">$n</span> * 2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#sidebar</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: double(<span class="number">5px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Less"><a href="#Less" class="headerlink" title="Less"></a>Less</h4><p>Less æ˜¯ä½¿ç”¨ JS ä½œä¸ºç¼–è¯‘ç¯å¢ƒçš„ï¼Œæ‰€ä»¥å®ƒæ”¯æŒ JS è¯­æ³•ã€‚</p><ol><li>å­—ç¬¦ä¸²æ’å€¼</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@base-url:</span> <span class="string">"http://assets.fnord.com"</span>;</span><br><span class="line"><span class="attribute">background-image</span>: url(<span class="string">"@&#123;base-url&#125;/images/bg.png"</span>);</span><br></pre></td></tr></table></figure><ol start="2"><li>ç”¨åå¼•å·ä½¿ç”¨ JS è¯­æ³•ï¼š</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@var:</span> <span class="built_in">` "hello" .toUpperCase() + "!" `</span>;</span><br></pre></td></tr></table></figure><ol start="3"><li>ç›´æ¥è®¿é—® JS ç¯å¢ƒ</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@height:</span> <span class="built_in">`document.body.clientHeight`</span>;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;sass-amp-less&quot;&gt;&lt;a href=&quot;#sass-amp-less&quot; class=&quot;headerlink&quot; title=&quot;sass&amp;amp;less&quot;&gt;&lt;/a&gt;sass&amp;amp;less&lt;/h1&gt;&lt;p&gt;##ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ CSS é¢„å¤„ç†å™¨ï¼Ÿ&lt;/p&gt;
&lt;p&gt;
      
    
    </summary>
    
      <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
      <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
      <category term="SASS" scheme="http://yoursite.com/tags/SASS/"/>
    
      <category term="LESS" scheme="http://yoursite.com/tags/LESS/"/>
    
  </entry>
  
  <entry>
    <title>oh-my-zsh git å‘½ä»¤ç¼©å†™</title>
    <link href="http://yoursite.com/2019/11/05/oh-my-zsh%20git%20%E5%91%BD%E4%BB%A4%E7%BC%A9%E5%86%99/"/>
    <id>http://yoursite.com/2019/11/05/oh-my-zsh git å‘½ä»¤ç¼©å†™/</id>
    <published>2019-11-05T13:08:23.000Z</published>
    <updated>2019-11-10T14:37:39.026Z</updated>
    
    <content type="html"><![CDATA[<p>#oh-my-zsh git å‘½ä»¤ç¼©å†™</p><p>å–œæ¬¢ç”¨ git å‘½ä»¤è¡Œï¼Œå¹³æ—¶èƒ½å°‘æ‰“å‡ ä¸ªå­—è¿˜æ˜¯ä¼šèŠ‚çœä¸å°‘æ—¶é—´çš„ã€‚</p><h2 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">alias ga=<span class="string">'git add'</span></span><br><span class="line">alias gb=<span class="string">'git branch'</span></span><br><span class="line">alias gba=<span class="string">'git branch -a'</span></span><br><span class="line">alias gbd=<span class="string">'git branch -d'</span></span><br><span class="line">alias gcam=<span class="string">'git commit -a -m'</span></span><br><span class="line">alias gcb=<span class="string">'git checkout -b'</span></span><br><span class="line">alias gco=<span class="string">'git checkout'</span></span><br><span class="line">alias gcp=<span class="string">'git cherry-pick'</span></span><br><span class="line">alias gd=<span class="string">'git diff'</span></span><br><span class="line">alias gfo=<span class="string">'git fetch origin'</span></span><br><span class="line">alias ggpush=<span class="string">'git push origin $(git_current_branch)'</span></span><br><span class="line">alias ggsup=<span class="string">'git branch --set-upstream-to=origin/$(git_current_branch)'</span></span><br><span class="line">alias glgp=<span class="string">'git log --stat -p'</span></span><br><span class="line">alias gm=<span class="string">'git merge'</span></span><br><span class="line">alias gp=<span class="string">'git push'</span></span><br><span class="line">alias gst=<span class="string">'git status'</span></span><br><span class="line">alias gsta=<span class="string">'git stash save'</span></span><br><span class="line">alias gstp=<span class="string">'git stash pop'</span></span><br></pre></td></tr></table></figure><h2 id="å…¨éƒ¨"><a href="#å…¨éƒ¨" class="headerlink" title="å…¨éƒ¨"></a>å…¨éƒ¨</h2><p>å‚è€ƒï¼š<a href="https://github.com/robbyrussell/oh-my-zsh/blob/master/plugins/git/git.plugin.zsh" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/blob/master/plugins/git/git.plugin.zsh</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line">alias g=<span class="string">'git'</span></span><br><span class="line"></span><br><span class="line">alias ga=<span class="string">'git add'</span></span><br><span class="line">alias gaa=<span class="string">'git add --all'</span></span><br><span class="line">alias gapa=<span class="string">'git add --patch'</span></span><br><span class="line">alias gau=<span class="string">'git add --update'</span></span><br><span class="line"></span><br><span class="line">alias gb=<span class="string">'git branch'</span></span><br><span class="line">alias gba=<span class="string">'git branch -a'</span></span><br><span class="line">alias gbd=<span class="string">'git branch -d'</span></span><br><span class="line">alias gbda=<span class="string">'git branch --no-color --merged | command grep -vE "^(\*|\s*(master|develop|dev)\s*$)" | command xargs -n 1 git branch -d'</span></span><br><span class="line">alias gbl=<span class="string">'git blame -b -w'</span></span><br><span class="line">alias gbnm=<span class="string">'git branch --no-merged'</span></span><br><span class="line">alias gbr=<span class="string">'git branch --remote'</span></span><br><span class="line">alias gbs=<span class="string">'git bisect'</span></span><br><span class="line">alias gbsb=<span class="string">'git bisect bad'</span></span><br><span class="line">alias gbsg=<span class="string">'git bisect good'</span></span><br><span class="line">alias gbsr=<span class="string">'git bisect reset'</span></span><br><span class="line">alias gbss=<span class="string">'git bisect start'</span></span><br><span class="line"></span><br><span class="line">alias gc=<span class="string">'git commit -v'</span></span><br><span class="line">alias gc!=<span class="string">'git commit -v --amend'</span></span><br><span class="line">alias gcn!=<span class="string">'git commit -v --no-edit --amend'</span></span><br><span class="line">alias gca=<span class="string">'git commit -v -a'</span></span><br><span class="line">alias gca!=<span class="string">'git commit -v -a --amend'</span></span><br><span class="line">alias gcan!=<span class="string">'git commit -v -a --no-edit --amend'</span></span><br><span class="line">alias gcans!=<span class="string">'git commit -v -a -s --no-edit --amend'</span></span><br><span class="line">alias gcam=<span class="string">'git commit -a -m'</span></span><br><span class="line">alias gcsm=<span class="string">'git commit -s -m'</span></span><br><span class="line">alias gcb=<span class="string">'git checkout -b'</span></span><br><span class="line">alias gcf=<span class="string">'git config --list'</span></span><br><span class="line">alias gcl=<span class="string">'git clone --recursive'</span></span><br><span class="line">alias gclean=<span class="string">'git clean -fd'</span></span><br><span class="line">alias gpristine=<span class="string">'git reset --hard &amp;&amp; git clean -dfx'</span></span><br><span class="line">alias gcm=<span class="string">'git checkout master'</span></span><br><span class="line">alias gcd=<span class="string">'git checkout develop'</span></span><br><span class="line">alias gcmsg=<span class="string">'git commit -m'</span></span><br><span class="line">alias gco=<span class="string">'git checkout'</span></span><br><span class="line">alias gcount=<span class="string">'git shortlog -sn'</span></span><br><span class="line">compdef _git gcount</span><br><span class="line">alias gcp=<span class="string">'git cherry-pick'</span></span><br><span class="line">alias gcpa=<span class="string">'git cherry-pick --abort'</span></span><br><span class="line">alias gcpc=<span class="string">'git cherry-pick --continue'</span></span><br><span class="line">alias gcs=<span class="string">'git commit -S'</span></span><br><span class="line"></span><br><span class="line">alias gd=<span class="string">'git diff'</span></span><br><span class="line">alias gdca=<span class="string">'git diff --cached'</span></span><br><span class="line">alias gdct=<span class="string">'git describe --tags `git rev-list --tags --max-count=1`'</span></span><br><span class="line">alias gdt=<span class="string">'git diff-tree --no-commit-id --name-only -r'</span></span><br><span class="line">alias gdw=<span class="string">'git diff --word-diff'</span></span><br><span class="line"></span><br><span class="line">gdv() &#123; git diff -w <span class="string">"$@"</span> | view - &#125;</span><br><span class="line">compdef _git gdv=git-diff</span><br><span class="line"></span><br><span class="line">alias gf=<span class="string">'git fetch'</span></span><br><span class="line">alias gfa=<span class="string">'git fetch --all --prune'</span></span><br><span class="line">alias gfo=<span class="string">'git fetch origin'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gfg</span>(<span class="params"></span>) </span>&#123; git ls-files | grep $@ &#125;</span><br><span class="line">compdef _grep gfg</span><br><span class="line"></span><br><span class="line">alias gg=<span class="string">'git gui citool'</span></span><br><span class="line">alias gga=<span class="string">'git gui citool --amend'</span></span><br><span class="line"></span><br><span class="line">ggf() &#123;</span><br><span class="line">  [[ <span class="string">"$#"</span> != <span class="number">1</span> ]] &amp;&amp; local b=<span class="string">"$(git_current_branch)"</span></span><br><span class="line">  git push --force origin <span class="string">"$&#123;b:=$1&#125;"</span></span><br><span class="line">&#125;</span><br><span class="line">compdef _git ggf=git-checkout</span><br><span class="line"></span><br><span class="line">ggl() &#123;</span><br><span class="line">  <span class="keyword">if</span> [[ <span class="string">"$#"</span> != <span class="number">0</span> ]] &amp;&amp; [[ <span class="string">"$#"</span> != <span class="number">1</span> ]]; then</span><br><span class="line">    git pull origin <span class="string">"$&#123;*&#125;"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    [[ <span class="string">"$#"</span> == <span class="number">0</span> ]] &amp;&amp; local b=<span class="string">"$(git_current_branch)"</span></span><br><span class="line">    git pull origin <span class="string">"$&#123;b:=$1&#125;"</span></span><br><span class="line">  fi</span><br><span class="line">&#125;</span><br><span class="line">compdef _git ggl=git-checkout</span><br><span class="line"></span><br><span class="line">ggp() &#123;</span><br><span class="line">  <span class="keyword">if</span> [[ <span class="string">"$#"</span> != <span class="number">0</span> ]] &amp;&amp; [[ <span class="string">"$#"</span> != <span class="number">1</span> ]]; then</span><br><span class="line">    git push origin <span class="string">"$&#123;*&#125;"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    [[ <span class="string">"$#"</span> == <span class="number">0</span> ]] &amp;&amp; local b=<span class="string">"$(git_current_branch)"</span></span><br><span class="line">    git push origin <span class="string">"$&#123;b:=$1&#125;"</span></span><br><span class="line">  fi</span><br><span class="line">&#125;</span><br><span class="line">compdef _git ggp=git-checkout</span><br><span class="line"></span><br><span class="line">ggpnp() &#123;</span><br><span class="line">  <span class="keyword">if</span> [[ <span class="string">"$#"</span> == <span class="number">0</span> ]]; then</span><br><span class="line">    ggl &amp;&amp; ggp</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    ggl <span class="string">"$&#123;*&#125;"</span> &amp;&amp; ggp <span class="string">"$&#123;*&#125;"</span></span><br><span class="line">  fi</span><br><span class="line">&#125;</span><br><span class="line">compdef _git ggpnp=git-checkout</span><br><span class="line"></span><br><span class="line">ggu() &#123;</span><br><span class="line">  [[ <span class="string">"$#"</span> != <span class="number">1</span> ]] &amp;&amp; local b=<span class="string">"$(git_current_branch)"</span></span><br><span class="line">  git pull --rebase origin <span class="string">"$&#123;b:=$1&#125;"</span></span><br><span class="line">&#125;</span><br><span class="line">compdef _git ggu=git-checkout</span><br><span class="line"></span><br><span class="line">alias ggpur=<span class="string">'ggu'</span></span><br><span class="line">compdef _git ggpur=git-checkout</span><br><span class="line"></span><br><span class="line">alias ggpull=<span class="string">'git pull origin $(git_current_branch)'</span></span><br><span class="line">compdef _git ggpull=git-checkout</span><br><span class="line"></span><br><span class="line">alias ggpush=<span class="string">'git push origin $(git_current_branch)'</span></span><br><span class="line">compdef _git ggpush=git-checkout</span><br><span class="line"></span><br><span class="line">alias ggsup=<span class="string">'git branch --set-upstream-to=origin/$(git_current_branch)'</span></span><br><span class="line">alias gpsup=<span class="string">'git push --set-upstream origin $(git_current_branch)'</span></span><br><span class="line"></span><br><span class="line">alias ghh=<span class="string">'git help'</span></span><br><span class="line"></span><br><span class="line">alias gignore=<span class="string">'git update-index --assume-unchanged'</span></span><br><span class="line">alias gignored=<span class="string">'git ls-files -v | grep "^[[:lower:]]"'</span></span><br><span class="line">alias git-svn-dcommit-push=<span class="string">'git svn dcommit &amp;&amp; git push github master:svntrunk'</span></span><br><span class="line">compdef _git git-svn-dcommit-push=git</span><br><span class="line"></span><br><span class="line">alias gk=<span class="string">'\gitk --all --branches'</span></span><br><span class="line">compdef _git gk=<span class="string">'gitk'</span></span><br><span class="line">alias gke=<span class="string">'\gitk --all $(git log -g --pretty=%h)'</span></span><br><span class="line">compdef _git gke=<span class="string">'gitk'</span></span><br><span class="line"></span><br><span class="line">alias gl=<span class="string">'git pull'</span></span><br><span class="line">alias glg=<span class="string">'git log --stat'</span></span><br><span class="line">alias glgp=<span class="string">'git log --stat -p'</span></span><br><span class="line">alias glgg=<span class="string">'git log --graph'</span></span><br><span class="line">alias glgga=<span class="string">'git log --graph --decorate --all'</span></span><br><span class="line">alias glgm=<span class="string">'git log --graph --max-count=10'</span></span><br><span class="line">alias glo=<span class="string">'git log --oneline --decorate'</span></span><br><span class="line">alias glol=<span class="string">"git log --graph --pretty='%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit"</span></span><br><span class="line">alias glola=<span class="string">"git log --graph --pretty='%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit --all"</span></span><br><span class="line">alias glog=<span class="string">'git log --oneline --decorate --graph'</span></span><br><span class="line">alias gloga=<span class="string">'git log --oneline --decorate --graph --all'</span></span><br><span class="line">alias glp=<span class="string">"_git_log_prettily"</span></span><br><span class="line">compdef _git glp=git-log</span><br><span class="line"></span><br><span class="line">alias gm=<span class="string">'git merge'</span></span><br><span class="line">alias gmom=<span class="string">'git merge origin/master'</span></span><br><span class="line">alias gmt=<span class="string">'git mergetool --no-prompt'</span></span><br><span class="line">alias gmtvim=<span class="string">'git mergetool --no-prompt --tool=vimdiff'</span></span><br><span class="line">alias gmum=<span class="string">'git merge upstream/master'</span></span><br><span class="line"></span><br><span class="line">alias gp=<span class="string">'git push'</span></span><br><span class="line">alias gpd=<span class="string">'git push --dry-run'</span></span><br><span class="line">alias gpoat=<span class="string">'git push origin --all &amp;&amp; git push origin --tags'</span></span><br><span class="line">compdef _git gpoat=git-push</span><br><span class="line">alias gpu=<span class="string">'git push upstream'</span></span><br><span class="line">alias gpv=<span class="string">'git push -v'</span></span><br><span class="line"></span><br><span class="line">alias gr=<span class="string">'git remote'</span></span><br><span class="line">alias gra=<span class="string">'git remote add'</span></span><br><span class="line">alias grb=<span class="string">'git rebase'</span></span><br><span class="line">alias grba=<span class="string">'git rebase --abort'</span></span><br><span class="line">alias grbc=<span class="string">'git rebase --continue'</span></span><br><span class="line">alias grbi=<span class="string">'git rebase -i'</span></span><br><span class="line">alias grbm=<span class="string">'git rebase master'</span></span><br><span class="line">alias grbs=<span class="string">'git rebase --skip'</span></span><br><span class="line">alias grh=<span class="string">'git reset HEAD'</span></span><br><span class="line">alias grhh=<span class="string">'git reset HEAD --hard'</span></span><br><span class="line">alias grmv=<span class="string">'git remote rename'</span></span><br><span class="line">alias grrm=<span class="string">'git remote remove'</span></span><br><span class="line">alias grset=<span class="string">'git remote set-url'</span></span><br><span class="line">alias grt=<span class="string">'cd $(git rev-parse --show-toplevel || echo ".")'</span></span><br><span class="line">alias gru=<span class="string">'git reset --'</span></span><br><span class="line">alias grup=<span class="string">'git remote update'</span></span><br><span class="line">alias grv=<span class="string">'git remote -v'</span></span><br><span class="line"></span><br><span class="line">alias gsb=<span class="string">'git status -sb'</span></span><br><span class="line">alias gsd=<span class="string">'git svn dcommit'</span></span><br><span class="line">alias gsi=<span class="string">'git submodule init'</span></span><br><span class="line">alias gsps=<span class="string">'git show --pretty=short --show-signature'</span></span><br><span class="line">alias gsr=<span class="string">'git svn rebase'</span></span><br><span class="line">alias gss=<span class="string">'git status -s'</span></span><br><span class="line">alias gst=<span class="string">'git status'</span></span><br><span class="line">alias gsta=<span class="string">'git stash save'</span></span><br><span class="line">alias gstaa=<span class="string">'git stash apply'</span></span><br><span class="line">alias gstc=<span class="string">'git stash clear'</span></span><br><span class="line">alias gstd=<span class="string">'git stash drop'</span></span><br><span class="line">alias gstl=<span class="string">'git stash list'</span></span><br><span class="line">alias gstp=<span class="string">'git stash pop'</span></span><br><span class="line">alias gsts=<span class="string">'git stash show --text'</span></span><br><span class="line">alias gsu=<span class="string">'git submodule update'</span></span><br><span class="line"></span><br><span class="line">alias gts=<span class="string">'git tag -s'</span></span><br><span class="line">alias gtv=<span class="string">'git tag | sort -V'</span></span><br><span class="line"></span><br><span class="line">alias gunignore=<span class="string">'git update-index --no-assume-unchanged'</span></span><br><span class="line">alias gunwip=<span class="string">'git log -n 1 | grep -q -c "\-\-wip\-\-" &amp;&amp; git reset HEAD~1'</span></span><br><span class="line">alias gup=<span class="string">'git pull --rebase'</span></span><br><span class="line">alias gupv=<span class="string">'git pull --rebase -v'</span></span><br><span class="line">alias glum=<span class="string">'git pull upstream master'</span></span><br><span class="line"></span><br><span class="line">alias gwch=<span class="string">'git whatchanged -p --abbrev-commit --pretty=medium'</span></span><br><span class="line">alias gwip=<span class="string">'git add -A; git rm $(git ls-files --deleted) 2&gt; /dev/null; git commit --no-verify -m "--wip-- [skip ci]"'</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;#oh-my-zsh git å‘½ä»¤ç¼©å†™&lt;/p&gt;
&lt;p&gt;å–œæ¬¢ç”¨ git å‘½ä»¤è¡Œï¼Œå¹³æ—¶èƒ½å°‘æ‰“å‡ ä¸ªå­—è¿˜æ˜¯ä¼šèŠ‚çœä¸å°‘æ—¶é—´çš„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å¸¸ç”¨&quot;&gt;&lt;a href=&quot;#å¸¸ç”¨&quot; class=&quot;headerlink&quot; title=&quot;å¸¸ç”¨&quot;&gt;&lt;/a&gt;å¸¸ç”¨&lt;/h2&gt;&lt;figure
      
    
    </summary>
    
      <category term="git" scheme="http://yoursite.com/categories/git/"/>
    
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Object.prototype.toStringæ–¹æ³•çš„åŸç†</title>
    <link href="http://yoursite.com/2019/10/28/Object.prototype.toString%E6%96%B9%E6%B3%95%E7%9A%84%E5%8E%9F%E7%90%86/"/>
    <id>http://yoursite.com/2019/10/28/Object.prototype.toStringæ–¹æ³•çš„åŸç†/</id>
    <published>2019-10-28T04:33:37.000Z</published>
    <updated>2019-11-10T14:37:39.020Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Object-prototype-toString-æ–¹æ³•çš„åŸç†"><a href="#Object-prototype-toString-æ–¹æ³•çš„åŸç†" class="headerlink" title="Object.prototype.toString æ–¹æ³•çš„åŸç†"></a>Object.prototype.toString æ–¹æ³•çš„åŸç†</h1><h2 id="ECMAScript-3"><a href="#ECMAScript-3" class="headerlink" title="ECMAScript 3"></a>ECMAScript 3</h2><h3 id="Object-prototype-toString-æ–¹æ³•çš„è§„èŒƒ"><a href="#Object-prototype-toString-æ–¹æ³•çš„è§„èŒƒ" class="headerlink" title="Object.prototype.toString æ–¹æ³•çš„è§„èŒƒ"></a>Object.prototype.toString æ–¹æ³•çš„è§„èŒƒ</h3><p>åœ¨<strong>toString</strong>æ–¹æ³•è¢«è°ƒç”¨æ—¶,ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œæ­¥éª¤:</p><ol><li>è·å– this å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼.</li><li>è®¡ç®—å‡ºä¸‰ä¸ªå­—ç¬¦ä¸²<strong>â€œ[object â€œ,</strong>ç¬¬ä¸€æ­¥çš„æ“ä½œç»“æœ Result(1), ä»¥åŠ <strong>â€œ]â€</strong>è¿æ¥åçš„æ–°å­—ç¬¦ä¸².</li><li>è¿”å›ç¬¬äºŒæ­¥çš„æ“ä½œç»“æœ Result(2).</li></ol><h3 id="Class"><a href="#Class" class="headerlink" title="[[Class]]"></a>[[Class]]</h3><p>[[Class]]æ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§,æ‰€æœ‰çš„å¯¹è±¡(åŸç”Ÿå¯¹è±¡å’Œå®¿ä¸»å¯¹è±¡)éƒ½æ‹¥æœ‰è¯¥å±æ€§.åœ¨è§„èŒƒä¸­,[[Class]]æ˜¯è¿™ä¹ˆå®šä¹‰çš„</p><table><thead><tr><th>å†…éƒ¨å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>[[Class]]</td><td>ä¸€ä¸ªå­—ç¬¦ä¸²å€¼,è¡¨æ˜äº†è¯¥å¯¹è±¡çš„ç±»å‹.</td></tr></tbody></table><p>ç„¶åç»™äº†ä¸€æ®µè§£é‡Š:</p><blockquote><p>æ‰€æœ‰å†…ç½®å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼æ˜¯ç”±æœ¬è§„èŒƒå®šä¹‰çš„.æ‰€æœ‰å®¿ä¸»å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»æ„å€¼,ç”šè‡³å¯ä»¥æ˜¯å†…ç½®å¯¹è±¡ä½¿ç”¨è¿‡çš„[[Class]]å±æ€§çš„å€¼.[[Class]]å±æ€§çš„å€¼å¯ä»¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªåŸç”Ÿå¯¹è±¡å±äºå“ªç§å†…ç½®ç±»å‹.éœ€è¦æ³¨æ„çš„æ˜¯,é™¤äº†é€šè¿‡<strong>Object.prototype.toString</strong>æ–¹æ³•ä¹‹å¤–,æœ¬è§„èŒƒæ²¡æœ‰æä¾›ä»»ä½•å…¶ä»–æ–¹å¼æ¥è®©ç¨‹åºè®¿é—®è¯¥å±æ€§çš„å€¼</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´,æŠŠ Object.prototype.toString æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²,å»æ‰å‰é¢å›ºå®šçš„<strong>â€œ[object â€œ</strong>å’Œåé¢å›ºå®šçš„<strong>â€œ]â€,</strong>å°±æ˜¯å†…éƒ¨å±æ€§[[class]]çš„å€¼,ä¹Ÿå°±è¾¾åˆ°äº†åˆ¤æ–­å¯¹è±¡ç±»å‹çš„ç›®çš„ã€‚</p><h3 id="Class-çš„å€¼"><a href="#Class-çš„å€¼" class="headerlink" title="[[Class]]çš„å€¼"></a>[[Class]]çš„å€¼</h3><p>åœ¨ ES3 ä¸­,è§„èŒƒæ–‡æ¡£å¹¶æ²¡æœ‰æ€»ç»“å‡º[[class]]å†…éƒ¨å±æ€§ä¸€å…±æœ‰å‡ ç§,ä¸è¿‡æˆ‘ä»¬å¯ä»¥è‡ªå·±ç»Ÿè®¡ä¸€ä¸‹,åŸç”Ÿå¯¹è±¡çš„[[class]]å†…éƒ¨å±æ€§çš„å€¼ä¸€å…±æœ‰ 10 ç§.åˆ†åˆ«æ˜¯:<code>&quot;Array&quot;</code>, <code>&quot;Boolean&quot;</code>, <code>&quot;Date&quot;</code>, <code>&quot;Error&quot;</code>, <code>&quot;Function&quot;</code>, <code>&quot;Math&quot;</code>, <code>&quot;Number&quot;</code>, <code>&quot;Object&quot;</code>, <code>&quot;RegExp&quot;</code>, <code>&quot;String&quot;.</code></p><h2 id="ECMAScript-5"><a href="#ECMAScript-5" class="headerlink" title="ECMAScript 5"></a>ECMAScript 5</h2><h3 id="Object-prototype-toString-æ–¹æ³•çš„è§„èŒƒ-1"><a href="#Object-prototype-toString-æ–¹æ³•çš„è§„èŒƒ-1" class="headerlink" title="Object.prototype.toString æ–¹æ³•çš„è§„èŒƒ"></a>Object.prototype.toString æ–¹æ³•çš„è§„èŒƒ</h3><p>åœ¨<strong>toString</strong>æ–¹æ³•è¢«è°ƒç”¨æ—¶,ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œæ­¥éª¤:</p><ol><li>å¦‚æœ<strong>this</strong>çš„å€¼ä¸º<strong>undefined</strong>,åˆ™è¿”å›<code>&quot;[object Undefined]&quot;</code>.</li><li>å¦‚æœ<strong>this</strong>çš„å€¼ä¸º<strong>null</strong>,åˆ™è¿”å›<code>&quot;[object Null]&quot;</code>.</li><li>è®©<em>O</em>æˆä¸ºè°ƒç”¨ ToObject(<strong>this)</strong>çš„ç»“æœ.</li><li>è®©<em>class</em>æˆä¸º<em>O</em>çš„å†…éƒ¨å±æ€§[[Class]]çš„å€¼.</li><li>è¿”å›ä¸‰ä¸ªå­—ç¬¦ä¸²<strong>â€œ[object â€œ,</strong> <em>class</em>, ä»¥åŠ <strong>â€œ]â€</strong>è¿æ¥åçš„æ–°å­—ç¬¦ä¸².</li></ol><p>å¯ä»¥çœ‹å‡º,ES5 æ¯” ES3 å¤šäº† 1,2,3 æ­¥.ç¬¬ 1,2 æ­¥å±äºæ–°è§„åˆ™,æ¯”è¾ƒç‰¹æ®Š,å› ä¸ºâ€<code>Undefined&quot;</code>å’Œâ€<code>Null&quot;</code>å¹¶ä¸å±äº[[class]]å±æ€§çš„å€¼,éœ€è¦æ³¨æ„çš„æ˜¯,è¿™é‡Œå’Œä¸¥æ ¼æ¨¡å¼æ— å…³(å¤§éƒ¨åˆ†å‡½æ•°åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹,this çš„å€¼æ‰ä¼šä¿æŒ undefined æˆ– null,éä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šè‡ªåŠ¨æˆä¸ºå…¨å±€å¯¹è±¡).ç¬¬ 3 æ­¥å¹¶ä¸ç®—æ˜¯æ–°è§„åˆ™,å› ä¸ºåœ¨ ES3 çš„å¼•æ“ä¸­,ä¹Ÿéƒ½ä¼šåœ¨è¿™ä¸€æ­¥å°†ä¸‰ç§åŸå§‹å€¼ç±»å‹è½¬æ¢æˆå¯¹åº”çš„åŒ…è£…å¯¹è±¡,åªæ˜¯è§„èŒƒä¸­æ²¡å†™å‡ºæ¥.</p><h3 id="Class-1"><a href="#Class-1" class="headerlink" title="[[Class]]"></a>[[Class]]</h3><p>ES5 ä¸­,[[Class]]å±æ€§çš„è§£é‡Šæ›´åŠ è¯¦ç»†:</p><blockquote><p>æ‰€æœ‰å†…ç½®å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼æ˜¯ç”±æœ¬è§„èŒƒå®šä¹‰çš„.æ‰€æœ‰å®¿ä¸»å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼å¯ä»¥æ˜¯é™¤äº†â€Argumentsâ€, â€œArrayâ€, â€œBooleanâ€, â€œDateâ€, â€œErrorâ€, â€œFunctionâ€, â€œJSONâ€, â€œMathâ€, â€œNumberâ€, â€œObjectâ€, â€œRegExpâ€, â€œStringâ€ä¹‹å¤–çš„çš„ä»»ä½•å­—ç¬¦ä¸².[[Class]]å†…éƒ¨å±æ€§æ˜¯å¼•æ“å†…éƒ¨ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å±äºå“ªç§ç±»å‹çš„å€¼çš„.éœ€è¦æ³¨æ„çš„æ˜¯,é™¤äº†é€šè¿‡<strong>Object.prototype.toString</strong>æ–¹æ³•ä¹‹å¤–,æœ¬è§„èŒƒæ²¡æœ‰æä¾›ä»»ä½•å…¶ä»–æ–¹å¼æ¥è®©ç¨‹åºè®¿é—®è¯¥å±æ€§çš„å€¼</p></blockquote><h3 id="å¯¹æ¯”-ES3"><a href="#å¯¹æ¯”-ES3" class="headerlink" title="å¯¹æ¯” ES3"></a>å¯¹æ¯” ES3</h3><ul><li>ç¬¬ä¸€ä¸ªå·®åˆ«å°±æ˜¯[[class]]å†…éƒ¨å±æ€§çš„å€¼å¤šäº†ä¸¤ç§,æˆäº† 12 ç§<ul><li>ä¸€ç§æ˜¯ arguments å¯¹è±¡çš„[[class]]æˆäº†â€Argumentsâ€,è€Œä¸æ˜¯ä»¥å‰çš„â€Objectâ€</li><li>å¤šä¸ªäº†å…¨å±€å¯¹è±¡ JSON,å®ƒçš„[[class]]å€¼ä¸ºâ€JSONâ€.</li></ul></li><li>ç¬¬äºŒä¸ªå·®åˆ«å°±æ˜¯,å®¿ä¸»å¯¹è±¡çš„[[class]]å†…éƒ¨å±æ€§çš„å€¼,ä¸èƒ½å’Œè¿™ 12 ç§å€¼å†²çªï¼ˆä¸è¿‡åœ¨æ”¯æŒ ES3 çš„æµè§ˆå™¨ä¸­,è²Œä¼¼ä¹Ÿæ²¡æœ‰å‘ç°å“ªäº›å®¿ä¸»å¯¹è±¡æ•…æ„ä½¿ç”¨é‚£ 10 ä¸ªå€¼ï¼‰</li></ul><h2 id="ECMAScript-6"><a href="#ECMAScript-6" class="headerlink" title="ECMAScript 6"></a>ECMAScript 6</h2><p><strong>[[class]]å†…éƒ¨å±æ€§æ²¡æœ‰äº†</strong>,å–è€Œä»£ä¹‹çš„æ˜¯å¦å¤–ä¸€ä¸ªå†…éƒ¨å±æ€§[[NativeBrand]].[[NativeBrand]]å±æ€§æ˜¯è¿™ä¹ˆå®šä¹‰çš„:</p><table><thead><tr><th>å†…éƒ¨å±æ€§</th><th>å±æ€§å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>[[NativeBrand]]</td><td>æšä¸¾ NativeBrand çš„ä¸€ä¸ªæˆå‘˜.</td><td>è¯¥å±æ€§çš„å€¼å¯¹åº”ä¸€ä¸ªæ ‡å¿—å€¼(tag value),å¯ä»¥ç”¨æ¥åŒºåˆ†åŸç”Ÿå¯¹è±¡çš„ç±»å‹.</td></tr></tbody></table><h3 id="NativeBrand-å±æ€§ï¼ˆinternal-slotï¼‰"><a href="#NativeBrand-å±æ€§ï¼ˆinternal-slotï¼‰" class="headerlink" title="[[NativeBrand]]å±æ€§ï¼ˆinternal slotï¼‰"></a>[[NativeBrand]]å±æ€§ï¼ˆ<code>internal slot</code>ï¼‰</h3><p>[[NativeBrand]]å†…éƒ¨å±æ€§ç”¨æ¥è¯†åˆ«æŸä¸ªåŸç”Ÿå¯¹è±¡æ˜¯å¦ä¸ºç¬¦åˆæœ¬è§„èŒƒçš„æŸä¸€ç§ç‰¹å®šç±»å‹çš„å¯¹è±¡.[[NativeBrand]]å†…éƒ¨å±æ€§çš„å€¼ä¸ºä¸‹é¢è¿™äº›æšä¸¾ç±»å‹çš„å€¼ä¸­çš„ä¸€ä¸ª:NativeFunction, NativeArray, StringWrapper, BooleanWrapper, NumberWrapper, NativeMath, NativeDate, NativeRegExp, NativeError, NativeJSON, NativeArguments, NativePrivateName.[[NativeBrand]]å†…éƒ¨å±æ€§ä»…ç”¨æ¥åŒºåˆ†åŒºåˆ†ç‰¹å®šç±»å‹çš„ ECMAScript åŸç”Ÿå¯¹è±¡.åªæœ‰åœ¨è¡¨ 10 ä¸­æ˜ç¡®æŒ‡å‡ºçš„å¯¹è±¡ç±»å‹æ‰æœ‰[[NativeBrand]]å†…éƒ¨å±æ€§.</p><table><thead><tr><th>å±æ€§å€¼</th><th>å¯¹åº”ç±»å‹</th></tr></thead><tbody><tr><td>NativeFunction</td><td>Function objects</td></tr><tr><td>NativeArray</td><td>Array objects</td></tr><tr><td>StringWrapper</td><td>String objects</td></tr><tr><td>BooleanWrapper</td><td>Boolean objects</td></tr><tr><td>NumberWrapper</td><td>Number objects</td></tr><tr><td>NativeMath</td><td>The Math object</td></tr><tr><td>NativeDate</td><td>Date objects</td></tr><tr><td>NativeRegExp</td><td>RegExp objects</td></tr><tr><td>NativeError</td><td>Error objects</td></tr><tr><td>NativeJSON</td><td>The JSON object</td></tr><tr><td>NativeArguments</td><td>Arguments objects</td></tr><tr><td>NativePrivateName</td><td>Private Name objects</td></tr></tbody></table><p>å¯è§,å’Œ[[class]]ä¸åŒçš„æ˜¯,å¹¶ä¸æ˜¯æ¯ä¸ªå¯¹è±¡éƒ½æ‹¥æœ‰[[NativeBrand]].</p><h3 id="Object-prototype-toString-æ–¹æ³•çš„è§„èŒƒ-2"><a href="#Object-prototype-toString-æ–¹æ³•çš„è§„èŒƒ-2" class="headerlink" title="Object.prototype.toString æ–¹æ³•çš„è§„èŒƒ:"></a>Object.prototype.toString æ–¹æ³•çš„è§„èŒƒ:</h3><p>åœ¨<strong>toString</strong>æ–¹æ³•è¢«è°ƒç”¨æ—¶,ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œæ­¥éª¤:</p><ol><li>å¦‚æœ<strong>this</strong>çš„å€¼ä¸º<strong>undefined</strong>,åˆ™è¿”å›<code>&quot;[object Undefined]&quot;</code>.</li><li>å¦‚æœ<strong>this</strong>çš„å€¼ä¸º<strong>null</strong>,åˆ™è¿”å›<code>&quot;[object Null]&quot;</code>.</li><li>è®©<em>O</em>æˆä¸ºè°ƒç”¨ ToObject(<strong>this)</strong>çš„ç»“æœ.</li><li>å¦‚æœ<em>O</em>æœ‰[[NativeBrand]]å†…éƒ¨å±æ€§,è®©<em>tag</em>æˆä¸ºè¡¨ 29 ä¸­å¯¹åº”çš„å€¼.</li><li>å¦åˆ™<ol><li>è®©<em>hasTag</em>æˆä¸ºè°ƒç”¨<em>O</em>çš„[[HasProperty]]å†…éƒ¨æ–¹æ³•åçš„ç»“æœ,å‚æ•°ä¸º@@toStringTag.</li><li>å¦‚æœ<em>hasTag</em>ä¸º<strong>false</strong>,åˆ™è®©<em>tag</em>ä¸º<code>&quot;Object&quot;</code>.</li><li>å¦åˆ™,<ol><li>è®©<em>tag</em>æˆä¸ºè°ƒç”¨<em>O</em>çš„[[Get]]å†…éƒ¨æ–¹æ³•åçš„ç»“æœ,å‚æ•°ä¸º@@toStringTag.</li><li>å¦‚æœ<em>tag</em>æ˜¯ä¸€ä¸ª abrupt completion,åˆ™è®©<em>tag</em>æˆä¸º NormalCompletion(<code>&quot;???&quot;</code>).</li><li>è®©<em>tag<em>æˆä¸º</em>tag</em>.[[value]].</li><li>å¦‚æœ Type(<em>tag</em>)ä¸æ˜¯å­—ç¬¦ä¸²,åˆ™è®©<em>tag æˆä¸º</em><code>&quot;???&quot;</code>.</li><li>å¦‚æœ<em>tag</em>çš„å€¼ä¸º<code>&quot;Arguments&quot;</code>, <code>&quot;Array&quot;</code>, <code>&quot;Boolean&quot;</code>, <code>&quot;Date&quot;</code>, <code>&quot;Error&quot;</code>, <code>&quot;Function&quot;</code>, <code>&quot;JSON&quot;</code>, <code>&quot;Math&quot;</code>, <code>&quot;Number&quot;</code>, <code>&quot;Object&quot;</code>, <code>&quot;RegExp&quot;</code>,<code>æˆ–è€…&quot;String&quot;ä¸­çš„ä»»ä¸€ä¸ª,åˆ™è®©</code><em>tag</em>æˆä¸ºå­—ç¬¦ä¸²<code>&quot;~&quot;å’Œ</code><em>tag</em>å½“å‰çš„å€¼è¿æ¥åçš„ç»“æœ.</li></ol></li></ol></li><li>è¿”å›ä¸‰ä¸ªå­—ç¬¦ä¸²â€[object â€œ, tag, and â€œ]â€è¿æ¥åçš„æ–°å­—ç¬¦ä¸².</li></ol><h3 id="ES6-é‡Œçš„æ–°ç±»å‹-Map-Set"><a href="#ES6-é‡Œçš„æ–°ç±»å‹-Map-Set" class="headerlink" title="ES6 é‡Œçš„æ–°ç±»å‹ Map,Set"></a>ES6 é‡Œçš„æ–°ç±»å‹ Map,Set</h3><p>ES6 é‡Œçš„æ–°ç±»å‹ Map,Set ç­‰,éƒ½æ²¡æœ‰åœ¨è¡¨ 29 ä¸­.å®ƒä»¬åœ¨æ‰§è¡Œ toString æ–¹æ³•çš„æ—¶å€™è¿”å›çš„æ˜¯ä»€ä¹ˆ?</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">Map</span>())); <span class="comment">//"[object Map]"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">Set</span>())); <span class="comment">//"[object Set]"</span></span><br></pre></td></tr></table></figure><p>Map.prototype.@@toStringTag</p><p>@@toStringTag å±æ€§çš„åˆå§‹å€¼ä¸ºå­—ç¬¦ä¸²<strong>â€œMapâ€</strong>.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Object-prototype-toString-æ–¹æ³•çš„åŸç†&quot;&gt;&lt;a href=&quot;#Object-prototype-toString-æ–¹æ³•çš„åŸç†&quot; class=&quot;headerlink&quot; title=&quot;Object.prototype.toString æ–¹æ³•çš„åŸ
      
    
    </summary>
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>å‡½æ•°å¼ç¼–ç¨‹</title>
    <link href="http://yoursite.com/2019/10/21/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    <id>http://yoursite.com/2019/10/21/å‡½æ•°å¼ç¼–ç¨‹/</id>
    <published>2019-10-21T03:15:12.000Z</published>
    <updated>2019-11-10T14:37:39.029Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h1><h2 id="ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹"><a href="#ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹"></a>ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹</h2><h3 id="å®šä¹‰ï¼š"><a href="#å®šä¹‰ï¼š" class="headerlink" title="å®šä¹‰ï¼š"></a>å®šä¹‰ï¼š</h3><p>å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œä¸»è¦æ˜¯åˆ©ç”¨å‡½æ•°æŠŠè¿ç®—è¿‡ç¨‹å°è£…èµ·æ¥ï¼Œé€šè¿‡ç»„åˆå„ç§å‡½æ•°æ¥è®¡ç®—ç»“æœã€‚å‡½æ•°å¼ç¼–ç¨‹æ„å‘³ç€ä½ å¯ä»¥åœ¨æ›´çŸ­çš„æ—¶é—´å†…ç¼–å†™å…·æœ‰æ›´å°‘é”™è¯¯çš„ä»£ç ã€‚</p><p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦æŠŠå­—ç¬¦ä¸² <code>functional programming is great</code> å˜æˆæ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> string = <span class="string">"functional programming is great"</span>;</span><br><span class="line"><span class="keyword">var</span> result = string</span><br><span class="line">  .split(<span class="string">" "</span>)</span><br><span class="line">  .map(<span class="function"><span class="params">v</span> =&gt;</span> v.slice(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + v.slice(<span class="number">1</span>))</span><br><span class="line">  .join(<span class="string">" "</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­å…ˆç”¨ split æŠŠå­—ç¬¦ä¸²è½¬æ¢æ•°ç»„ï¼Œç„¶åå†é€šè¿‡ map æŠŠå„å…ƒç´ çš„é¦–å­—æ¯è½¬æ¢æˆå¤§å†™ï¼Œæœ€åé€šè¿‡ join æŠŠæ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚ æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ <code>join(map(split(str)))</code>,ä½“ç°äº†å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ï¼š <strong>é€šè¿‡å‡½æ•°å¯¹æ•°æ®è¿›è¡Œè½¬æ¢</strong>ã€‚</p><h3 id="ç‰¹ç‚¹ï¼š"><a href="#ç‰¹ç‚¹ï¼š" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h3><p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼Œå‡½æ•°å¼ç¼–ç¨‹æœ‰ä¸¤ä¸ªåŸºæœ¬ç‰¹ç‚¹ï¼š</p><ul><li>é€šè¿‡å‡½æ•°æ¥å¯¹æ•°æ®è¿›è¡Œè½¬æ¢</li><li>é€šè¿‡ä¸²è”å¤šä¸ªå‡½æ•°æ¥æ±‚ç»“æœ</li></ul><h2 id="å¯¹æ¯”å£°æ˜å¼ä¸å‘½ä»¤å¼"><a href="#å¯¹æ¯”å£°æ˜å¼ä¸å‘½ä»¤å¼" class="headerlink" title="å¯¹æ¯”å£°æ˜å¼ä¸å‘½ä»¤å¼"></a>å¯¹æ¯”å£°æ˜å¼ä¸å‘½ä»¤å¼</h2><ul><li>å‘½ä»¤å¼ï¼šæˆ‘ä»¬é€šè¿‡ç¼–å†™ä¸€æ¡åˆä¸€æ¡æŒ‡ä»¤å»è®©è®¡ç®—æœºæ‰§è¡Œä¸€äº›åŠ¨ä½œï¼Œè¿™å…¶ä¸­ä¸€èˆ¬éƒ½ä¼šæ¶‰åŠåˆ°å¾ˆå¤šç¹æ‚çš„ç»†èŠ‚ã€‚å‘½ä»¤å¼ä»£ç ä¸­é¢‘ç¹ä½¿ç”¨è¯­å¥,æ¥å®ŒæˆæŸä¸ªè¡Œä¸ºã€‚æ¯”å¦‚ forã€ifã€switchã€throw ç­‰è¿™äº›è¯­å¥ã€‚</li><li>å£°æ˜å¼ï¼šæˆ‘ä»¬é€šè¿‡å†™è¡¨è¾¾å¼çš„æ–¹å¼æ¥å£°æ˜æˆ‘ä»¬æƒ³å¹²ä»€ä¹ˆï¼Œè€Œä¸æ˜¯é€šè¿‡ä¸€æ­¥ä¸€æ­¥çš„æŒ‡ç¤ºã€‚è¡¨è¾¾å¼é€šå¸¸æ˜¯æŸäº›å‡½æ•°è°ƒç”¨çš„å¤åˆã€ä¸€äº›å€¼å’Œæ“ä½œç¬¦ï¼Œç”¨æ¥è®¡ç®—å‡ºç»“æœå€¼ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‘½ä»¤å¼</span></span><br><span class="line"><span class="keyword">var</span> CEOs = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; companies.length; i++) &#123;</span><br><span class="line">  CEOs.push(companies[i].CEO);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å£°æ˜å¼</span></span><br><span class="line"><span class="keyword">var</span> CEOs = companies.map(<span class="function"><span class="params">c</span> =&gt;</span> c.CEO);</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å£°æ˜å¼çš„å†™æ³•æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ— éœ€å…³å¿ƒå¦‚ä½•è¿›è¡Œè®¡æ•°å™¨è¿­ä»£ï¼Œè¿”å›çš„æ•°ç»„å¦‚ä½•æ”¶é›†ï¼Œå®ƒæŒ‡æ˜çš„æ˜¯åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ€ä¹ˆåšã€‚<strong>å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªæ˜æ˜¾çš„å¥½å¤„å°±æ˜¯è¿™ç§å£°æ˜å¼çš„ä»£ç </strong>ï¼Œå¯¹äºæ— å‰¯ä½œç”¨çš„çº¯å‡½æ•°ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸è€ƒè™‘å‡½æ•°å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä¸“æ³¨äºç¼–å†™ä¸šåŠ¡ä»£ç ã€‚</p><h2 id="å¸¸è§ç‰¹æ€§"><a href="#å¸¸è§ç‰¹æ€§" class="headerlink" title="å¸¸è§ç‰¹æ€§"></a>å¸¸è§ç‰¹æ€§</h2><h3 id="æ— å‰¯ä½œç”¨"><a href="#æ— å‰¯ä½œç”¨" class="headerlink" title="æ— å‰¯ä½œç”¨"></a>æ— å‰¯ä½œç”¨</h3><p>æŒ‡è°ƒç”¨å‡½æ•°æ—¶ä¸ä¼šä¿®æ”¹å¤–éƒ¨çŠ¶æ€ï¼Œå³ä¸€ä¸ªå‡½æ•°è°ƒç”¨ n æ¬¡åä¾ç„¶è¿”å›åŒæ ·çš„ç»“æœã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// å«æœ‰å‰¯ä½œç”¨ï¼Œå®ƒä¿®æ”¹äº†å¤–éƒ¨å˜é‡ a</span></span><br><span class="line"><span class="comment">// å¤šæ¬¡è°ƒç”¨ç»“æœä¸ä¸€æ ·</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  a++;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— å‰¯ä½œç”¨ï¼Œæ²¡æœ‰ä¿®æ”¹å¤–éƒ¨çŠ¶æ€</span></span><br><span class="line"><span class="comment">// å¤šæ¬¡è°ƒç”¨ç»“æœä¸€æ ·</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é€æ˜å¼•ç”¨"><a href="#é€æ˜å¼•ç”¨" class="headerlink" title="é€æ˜å¼•ç”¨"></a>é€æ˜å¼•ç”¨</h3><p>æŒ‡ä¸€ä¸ªå‡½æ•°åªä¼šç”¨åˆ°ä¼ é€’ç»™å®ƒçš„å˜é‡ä»¥åŠè‡ªå·±å†…éƒ¨åˆ›å»ºçš„å˜é‡ï¼Œä¸ä¼šä½¿ç”¨åˆ°å…¶ä»–å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„å˜é‡å¹¶ä¸å±äºå®ƒçš„ä½œç”¨åŸŸ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„å˜é‡æ˜¯æ˜¾å¼ä¼ é€’è¿›å»çš„</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸å¯å˜å˜é‡"><a href="#ä¸å¯å˜å˜é‡" class="headerlink" title="ä¸å¯å˜å˜é‡"></a>ä¸å¯å˜å˜é‡</h3><p>æŒ‡çš„æ˜¯ä¸€ä¸ªå˜é‡ä¸€æ—¦åˆ›å»ºåï¼Œå°±ä¸èƒ½å†è¿›è¡Œä¿®æ”¹ï¼Œä»»ä½•ä¿®æ”¹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å˜é‡ã€‚ä½¿ç”¨ä¸å¯å˜å˜é‡æœ€å¤§çš„å¥½å¤„æ˜¯çº¿ç¨‹å®‰å…¨ã€‚å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®åŒä¸€ä¸ªä¸å¯å˜å˜é‡ï¼Œè®©å¹¶è¡Œå˜å¾—æ›´å®¹æ˜“å®ç°ã€‚ ç”±äº JavaScript åŸç”Ÿä¸æ”¯æŒä¸å¯å˜å˜é‡ï¼Œéœ€è¦é€šè¿‡ç¬¬ä¸‰æ–¹åº“æ¥å®ç°ã€‚ (å¦‚ Immutable.jsï¼ŒMori ç­‰ç­‰)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = Immutable(&#123; <span class="attr">a</span>: <span class="number">1</span> &#125;);</span><br><span class="line"><span class="keyword">var</span> obj2 = obj.set(<span class="string">"a"</span>, <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// Immutable(&#123; a: 1 &#125;)</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2); <span class="comment">// Immutable(&#123; a: 2 &#125;)</span></span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘"><a href="#å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘" class="headerlink" title="å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘"></a>å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘</h3><p>æˆ‘ä»¬å¸¸è¯´å‡½æ•°æ˜¯ JavaScript çš„â€ç¬¬ä¸€ç­‰å…¬æ°‘â€ï¼ŒæŒ‡çš„æ˜¯å‡½æ•°ä¸å…¶ä»–æ•°æ®ç±»å‹ä¸€æ ·ï¼Œå¤„äºå¹³ç­‰åœ°ä½ï¼Œå¯ä»¥èµ‹å€¼ç»™å…¶ä»–å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…ä½œä¸ºåˆ«çš„å‡½æ•°çš„è¿”å›å€¼ã€‚ä¸‹æ–‡å°†è¦ä»‹ç»çš„é—­åŒ…ã€é«˜é˜¶å‡½æ•°ã€å‡½æ•°æŸ¯é‡ŒåŒ–å’Œå‡½æ•°ç»„åˆéƒ½æ˜¯å›´ç»•è¿™ä¸€ç‰¹æ€§çš„åº”ç”¨</p><h2 id="å¸¸è§çš„å‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹"><a href="#å¸¸è§çš„å‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹" class="headerlink" title="å¸¸è§çš„å‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹"></a>å¸¸è§çš„å‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹</h2><h3 id="1-é—­åŒ…ï¼ˆClosureï¼‰"><a href="#1-é—­åŒ…ï¼ˆClosureï¼‰" class="headerlink" title="1.é—­åŒ…ï¼ˆClosureï¼‰"></a>1.é—­åŒ…ï¼ˆClosureï¼‰</h3><p>å¦‚æœä¸€ä¸ªå‡½æ•°å¼•ç”¨äº†è‡ªç”±å˜é‡ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚ä½•è°“è‡ªç”±å˜é‡ï¼Ÿè‡ªç”±å˜é‡æ˜¯æŒ‡ä¸å±äºè¯¥å‡½æ•°ä½œç”¨åŸŸçš„å˜é‡(æ‰€æœ‰å…¨å±€å˜é‡éƒ½æ˜¯è‡ªç”±å˜é‡ï¼Œä¸¥æ ¼æ¥è¯´å¼•ç”¨äº†å…¨å±€å˜é‡çš„å‡½æ•°éƒ½æ˜¯é—­åŒ…ï¼Œä½†è¿™ç§é—­åŒ…å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬è¯´çš„é—­åŒ…æ˜¯æŒ‡å‡½æ•°å†…éƒ¨çš„å‡½æ•°)ã€‚</p><p>é—­åŒ…çš„å½¢æˆæ¡ä»¶ï¼š</p><ul><li>å­˜åœ¨å†…ã€å¤–ä¸¤å±‚å‡½æ•°</li><li>å†…å±‚å‡½æ•°å¯¹å¤–å±‚å‡½æ•°çš„å±€éƒ¨å˜é‡è¿›è¡Œäº†å¼•ç”¨</li></ul><p>é—­åŒ…çš„ç”¨é€”:<br><strong>å¯ä»¥å®šä¹‰ä¸€äº›ä½œç”¨åŸŸå±€é™çš„æŒä¹…åŒ–å˜é‡ï¼Œè¿™äº›å˜é‡å¯ä»¥ç”¨æ¥åšç¼“å­˜æˆ–è€…è®¡ç®—çš„ä¸­é—´é‡ç­‰</strong>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®€å•çš„ç¼“å­˜å·¥å…·</span></span><br><span class="line"><span class="comment">// åŒ¿åå‡½æ•°åˆ›é€ äº†ä¸€ä¸ªé—­åŒ…</span></span><br><span class="line"><span class="keyword">const</span> cache = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> store = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="keyword">get</span>(key) &#123;</span><br><span class="line">      <span class="keyword">return</span> store[key];</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>(key, val) &#123;</span><br><span class="line">      store[key] = val;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log(cache); <span class="comment">//&#123;get: Æ’, set: Æ’&#125;</span></span><br><span class="line">cache.set(<span class="string">"a"</span>, <span class="number">1</span>);</span><br><span class="line">cache.get(<span class="string">"a"</span>); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¾‹å­æ˜¯ä¸€ä¸ªç®€å•çš„ç¼“å­˜å·¥å…·çš„å®ç°ï¼ŒåŒ¿åå‡½æ•°åˆ›é€ äº†ä¸€ä¸ªé—­åŒ…ï¼Œä½¿å¾— store å¯¹è±¡ ï¼Œä¸€ç›´å¯ä»¥è¢«å¼•ç”¨ï¼Œä¸ä¼šè¢«å›æ”¶ã€‚</p><p>é—­åŒ…çš„å¼Šç«¯:<strong>æŒä¹…åŒ–å˜é‡ä¸ä¼šè¢«æ­£å¸¸é‡Šæ”¾ï¼ŒæŒç»­å ç”¨å†…å­˜ç©ºé—´ï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æµªè´¹</strong>ï¼Œæ‰€ä»¥ä¸€èˆ¬éœ€è¦ä¸€äº›é¢å¤–æ‰‹åŠ¨çš„æ¸…ç†æœºåˆ¶ã€‚</p><h3 id="2-é«˜é˜¶å‡½æ•°"><a href="#2-é«˜é˜¶å‡½æ•°" class="headerlink" title="2.é«˜é˜¶å‡½æ•°"></a>2.é«˜é˜¶å‡½æ•°</h3><p>å‡½æ•°å¼ç¼–ç¨‹å€¾å‘äºå¤ç”¨ä¸€ç»„é€šç”¨çš„å‡½æ•°åŠŸèƒ½æ¥å¤„ç†æ•°æ®ï¼Œå®ƒé€šè¿‡ä½¿ç”¨é«˜é˜¶å‡½æ•°æ¥å®ç°ã€‚<strong>é«˜é˜¶å‡½æ•°æŒ‡çš„æ˜¯ä¸€ä¸ªå‡½æ•°ä»¥å‡½æ•°ä¸ºå‚æ•°ï¼Œæˆ–ä»¥å‡½æ•°ä¸ºè¿”å›å€¼ï¼Œæˆ–è€…æ—¢ä»¥å‡½æ•°ä¸ºå‚æ•°åˆä»¥å‡½æ•°ä¸ºè¿”å›å€¼</strong>ã€‚</p><p>é«˜é˜¶å‡½æ•°ç»å¸¸ç”¨äºï¼š</p><ul><li>æŠ½è±¡æˆ–éš”ç¦»è¡Œä¸ºã€ä½œç”¨ï¼Œå¼‚æ­¥æ§åˆ¶æµç¨‹ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œpromisesï¼Œmonads ç­‰</li><li>åˆ›å»ºå¯ä»¥æ³›ç”¨äºå„ç§æ•°æ®ç±»å‹çš„åŠŸèƒ½</li><li>éƒ¨åˆ†åº”ç”¨äºå‡½æ•°å‚æ•°ï¼ˆåå‡½æ•°åº”ç”¨ï¼‰æˆ–åˆ›å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–çš„å‡½æ•°ï¼Œç”¨äºå¤ç”¨æˆ–å‡½æ•°å¤åˆã€‚</li><li>æ¥å—ä¸€ä¸ªå‡½æ•°åˆ—è¡¨å¹¶è¿”å›ä¸€äº›ç”±è¿™ä¸ªåˆ—è¡¨ä¸­çš„å‡½æ•°ç»„æˆçš„å¤åˆå‡½æ•°ã€‚</li></ul><p>JavaScript è¯­è¨€æ˜¯åŸç”Ÿæ”¯æŒé«˜é˜¶å‡½æ•°çš„, ä¾‹å¦‚ Array.prototype.mapï¼ŒArray.prototype.filter å’Œ Array.prototype.reduce æ˜¯ JavaScript ä¸­å†…ç½®çš„ä¸€äº›é«˜é˜¶å‡½æ•°ï¼Œä½¿ç”¨é«˜é˜¶å‡½æ•°ä¼šè®©æˆ‘ä»¬çš„ä»£ç æ›´æ¸…æ™°ç®€æ´ã€‚</p><h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><p>map() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ä¸€ä¸ªæä¾›çš„å‡½æ•°åè¿”å›çš„ç»“æœã€‚map ä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«åç§°å’Œç§ç±»å±æ€§çš„å¯¹è±¡æ•°ç»„ï¼Œæˆ‘ä»¬æƒ³è¦è¿™ä¸ªæ•°ç»„ä¸­æ‰€æœ‰åç§°å±æ€§æ”¾åœ¨ä¸€ä¸ªæ–°æ•°ç»„ä¸­ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ä½¿ç”¨é«˜é˜¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> animals = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Fluffykins"</span>, <span class="attr">species</span>: <span class="string">"rabbit"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Caro"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Hamilton"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Harold"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Ursula"</span>, <span class="attr">species</span>: <span class="string">"cat"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Jimmy"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> names = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; animals.length; i++) &#123;</span><br><span class="line">  names.push(animals[i].name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(names); <span class="comment">//["Fluffykins", "Caro", "Hamilton", "Harold", "Ursula", "Jimmy"]</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨é«˜é˜¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> animals = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Fluffykins"</span>, <span class="attr">species</span>: <span class="string">"rabbit"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Caro"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Hamilton"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Harold"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Ursula"</span>, <span class="attr">species</span>: <span class="string">"cat"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Jimmy"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> names = animals.map(<span class="function"><span class="params">x</span> =&gt;</span> x.name);</span><br><span class="line"><span class="built_in">console</span>.log(names); <span class="comment">//["Fluffykins", "Caro", "Hamilton", "Harold", "Ursula", "Jimmy"]</span></span><br></pre></td></tr></table></figure><h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>filter() æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰é€šè¿‡å›è°ƒå‡½æ•°æµ‹è¯•çš„å…ƒç´ ã€‚filter ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ callback å‡½æ•°ï¼Œ callback å‡½æ•°è¿”å› true è¡¨ç¤ºè¯¥å…ƒç´ é€šè¿‡æµ‹è¯•ï¼Œä¿ç•™è¯¥å…ƒç´ ï¼Œfalse åˆ™ä¸ä¿ç•™ã€‚filter ä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼Œå®ƒè¿”å›è¿‡æ»¤åçš„æ–°æ•°ç»„ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«åç§°å’Œç§ç±»å±æ€§çš„å¯¹è±¡æ•°ç»„ã€‚ æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªåªåŒ…å«ç‹—ï¼ˆspecies: â€œdogâ€ï¼‰çš„æ•°ç»„ã€‚å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ä½¿ç”¨é«˜é˜¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> animals = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Fluffykins"</span>, <span class="attr">species</span>: <span class="string">"rabbit"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Caro"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Hamilton"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Harold"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Ursula"</span>, <span class="attr">species</span>: <span class="string">"cat"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Jimmy"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> dogs = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; animals.length; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (animals[i].species === <span class="string">"dog"</span>) dogs.push(animals[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(dogs);</span><br><span class="line"><span class="comment">// ä½¿ç”¨é«˜é˜¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> animals = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Fluffykins"</span>, <span class="attr">species</span>: <span class="string">"rabbit"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Caro"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Hamilton"</span>, <span class="attr">species</span>: <span class="string">"dog"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Harold"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Ursula"</span>, <span class="attr">species</span>: <span class="string">"cat"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Jimmy"</span>, <span class="attr">species</span>: <span class="string">"fish"</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> dogs = animals.filter(<span class="function"><span class="params">x</span> =&gt;</span> x.species === <span class="string">"dog"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dogs); <span class="comment">// &#123;name: "Caro", species: "dog"&#125;</span></span><br><span class="line"><span class="comment">// &#123; name: "Hamilton", species: "dog" &#125;</span></span><br></pre></td></tr></table></figure><h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><p>reduce æ–¹æ³•å¯¹è°ƒç”¨æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œæœ€åç”Ÿæˆä¸€ä¸ªå•ä¸€çš„å€¼å¹¶è¿”å›ã€‚ reduce æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š1ï¼‰reducer å‡½æ•°ï¼ˆå›è°ƒï¼‰ï¼Œ2ï¼‰ä¸€ä¸ªå¯é€‰çš„ initialValueã€‚</p><p>å‡è®¾æˆ‘ä»¬è¦å¯¹ä¸€ä¸ªæ•°ç»„çš„æ±‚å’Œï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ä½¿ç”¨é«˜é˜¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">5</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">  sum = sum + arr[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(sum); <span class="comment">//25</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨é«˜é˜¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">5</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">const</span> sum = arr.reduce(</span><br><span class="line">  (accumulator, currentValue) =&gt; accumulator + currentValue,</span><br><span class="line">  <span class="number">0</span></span><br><span class="line">);</span><br><span class="line"><span class="built_in">console</span>.log(sum); <span class="comment">//25</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹å›¾ï¼Œå½¢è±¡ç”ŸåŠ¨å±•ç¤ºä¸‰è€…çš„åŒºåˆ«ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6ixh3e6euj30ml0bnwf2.jpg" alt="img"></p><h3 id="3-å‡½æ•°æŸ¯é‡ŒåŒ–"><a href="#3-å‡½æ•°æŸ¯é‡ŒåŒ–" class="headerlink" title="3.å‡½æ•°æŸ¯é‡ŒåŒ–"></a>3.å‡½æ•°æŸ¯é‡ŒåŒ–</h3><p>æŸ¯é‡ŒåŒ–åˆç§°éƒ¨åˆ†æ±‚å€¼ï¼ŒæŸ¯é‡ŒåŒ–å‡½æ•°ä¼šæ¥æ”¶ä¸€äº›å‚æ•°ï¼Œç„¶åä¸ä¼šç«‹å³æ±‚å€¼ï¼Œè€Œæ˜¯ç»§ç»­è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå°†ä¼ å…¥çš„å‚æ•°é€šè¿‡é—­åŒ…çš„å½¢å¼ä¿å­˜ï¼Œç­‰åˆ°è¢«çœŸæ­£æ±‚å€¼çš„æ—¶å€™ï¼Œå†ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ±‚å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ™®é€šå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br><span class="line"><span class="comment">// å‡½æ•°æŸ¯é‡ŒåŒ–</span></span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> increment = add(<span class="number">1</span>);</span><br><span class="line">increment(<span class="number">2</span>); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª add å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚è°ƒç”¨ add ä¹‹åï¼Œè¿”å›çš„å‡½æ•°å°±é€šè¿‡é—­åŒ…çš„æ–¹å¼è®°ä½äº† add çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•æ¥å®ç°ä¸€ä¸ªç®€æ˜“çš„æŸ¯é‡ŒåŒ–å‡½æ•°å‘¢ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curryIt</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// å‚æ•°fnå‡½æ•°çš„å‚æ•°ä¸ªæ•°</span></span><br><span class="line">  <span class="keyword">var</span> n = fn.length;</span><br><span class="line">  <span class="keyword">var</span> args = [];</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    args.push(arg);</span><br><span class="line">    <span class="keyword">if</span> (args.length &lt; n) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">arguments</span>.callee; <span class="comment">// è¿”å›è¿™ä¸ªå‡½æ•°çš„å¼•ç”¨</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [a, b, c];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> c = curryIt(add);</span><br><span class="line"><span class="keyword">var</span> c1 = c(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> c2 = c1(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> c3 = c2(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(c3); <span class="comment">//[1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒæŸ¯é‡ŒåŒ–æ˜¯ä¸€ç§â€œé¢„åŠ è½½â€å‡½æ•°çš„æ–¹æ³•ï¼Œé€šè¿‡ä¼ é€’è¾ƒå°‘çš„å‚æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªå·²ç»è®°ä½äº†è¿™äº›å‚æ•°çš„æ–°å‡½æ•°ï¼ŒæŸç§æ„ä¹‰ä¸Šè®²ï¼Œè¿™æ˜¯ä¸€ç§å¯¹å‚æ•°çš„â€œç¼“å­˜â€ï¼Œæ˜¯ä¸€ç§éå¸¸é«˜æ•ˆçš„ç¼–å†™å‡½æ•°çš„æ–¹æ³•ï¼</p><h3 id="4-å‡½æ•°ç»„åˆ-Composition"><a href="#4-å‡½æ•°ç»„åˆ-Composition" class="headerlink" title="4.å‡½æ•°ç»„åˆ (Composition)"></a>4.å‡½æ•°ç»„åˆ (Composition)</h3><p>å‰é¢æåˆ°è¿‡ï¼Œå‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯é€šè¿‡ä¸²è”å‡½æ•°æ¥æ±‚å€¼ã€‚ç„¶è€Œï¼Œéšç€ä¸²è”å‡½æ•°æ•°é‡çš„å¢å¤šï¼Œä»£ç çš„å¯è¯»æ€§å°±ä¼šä¸æ–­ä¸‹é™ã€‚å‡½æ•°ç»„åˆå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚<br>å‡è®¾æœ‰ä¸€ä¸ª compose å‡½æ•°ï¼Œå®ƒå¯ä»¥æ¥å—å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚å½“æˆ‘ä»¬ä¸ºè¿™ä¸ªæ–°å‡½æ•°ä¼ é€’å‚æ•°æ—¶ï¼Œè¯¥å‚æ•°å°±ä¼šã€Œæµã€è¿‡å…¶ä¸­çš„å‡½æ•°ï¼Œæœ€åè¿”å›ç»“æœã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸¤ä¸ªå‡½æ•°çš„ç»„åˆ</span></span><br><span class="line"><span class="keyword">var</span> compose = <span class="function"><span class="keyword">function</span>(<span class="params">f, g</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> f(g(x));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–è€…</span></span><br><span class="line"><span class="keyword">var</span> compose = <span class="function">(<span class="params">f, g</span>) =&gt;</span> <span class="function"><span class="params">x</span> =&gt;</span> f(g(x));</span><br><span class="line"><span class="keyword">var</span> add1 = <span class="function"><span class="params">x</span> =&gt;</span> x + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> mul5 = <span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">5</span>;</span><br><span class="line">compose(</span><br><span class="line">  mul5,</span><br><span class="line">  add1</span><br><span class="line">)(<span class="number">2</span>); <span class="comment">// =&gt;15</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‡½æ•°å¼ç¼–ç¨‹&quot;&gt;&lt;a href=&quot;#å‡½æ•°å¼ç¼–ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;å‡½æ•°å¼ç¼–ç¨‹&quot;&gt;&lt;/a&gt;å‡½æ•°å¼ç¼–ç¨‹&lt;/h1&gt;&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹&quot; class=&quot;headerlink&quot; titl
      
    
    </summary>
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>IP</title>
    <link href="http://yoursite.com/2019/10/13/IP/"/>
    <id>http://yoursite.com/2019/10/13/IP/</id>
    <published>2019-10-13T07:41:22.000Z</published>
    <updated>2019-11-10T14:37:39.018Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h1><p>IPï¼ˆIPv4ã€IPv6ï¼‰ç›¸å½“äº OSI å‚è€ƒæ¨¡å‹ä¸­çš„ç¬¬ 3 å±‚â€”â€”ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚çš„ä¸»è¦ä½œç”¨æ˜¯â€œ<strong>å®ç°ç»ˆç«¯èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡</strong>â€ã€‚è¿™ç§ç»ˆç«¯èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡ä¹Ÿå«â€œç‚¹å¯¹ç‚¹é€šä¿¡â€ã€‚</p><p>ç½‘ç»œçš„ä¸‹ä¸€å±‚â€”â€”æ•°æ®é“¾è·¯å±‚çš„ä¸»è¦ä½œç”¨æ˜¯åœ¨äº’è¿åŒä¸€ç§æ•°æ®é“¾è·¯çš„èŠ‚ç‚¹ä¹‹é—´è¿›è¡ŒåŒ…ä¼ é€’ã€‚è€Œä¸€æ—¦è·¨è¶Šå¤šç§æ•°æ®é“¾è·¯ï¼Œå°±éœ€è¦å€ŸåŠ©ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚å¯ä»¥è·¨è¶Šä¸åŒçš„æ•°æ®é“¾è·¯ï¼Œå³ä½¿æ˜¯åœ¨ä¸åŒçš„æ•°æ®é“¾è·¯ä¸Šä¹Ÿèƒ½å®ç°ä¸¤ç«¯èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®åŒ…ä¼ è¾“ã€‚</p><p><strong>IP å¤§è‡´åˆ†ä¸ºä¸‰å¤§ä½œç”¨æ¨¡å—ï¼Œå®ƒä»¬æ˜¯ IP å¯»å€ã€è·¯ç”±ï¼ˆæœ€ç»ˆèŠ‚ç‚¹ä¸ºæ­¢çš„è½¬å‘ï¼‰ä»¥åŠ IP åˆ†åŒ…ä¸ç»„åŒ…ã€‚</strong></p><h2 id="TCP-IP-åŸºç¡€"><a href="#TCP-IP-åŸºç¡€" class="headerlink" title="TCP/IP åŸºç¡€"></a>TCP/IP åŸºç¡€</h2><p>äº’è”ç½‘è¿›è¡Œé€šä¿¡æ—¶ï¼Œéœ€è¦ç›¸åº”çš„ç½‘ç»œåè®®ï¼ŒTCP/IP åŸæœ¬å°±æ˜¯ä¸ºä½¿ç”¨äº’è”ç½‘è€Œå¼€å‘åˆ¶å®šçš„åè®®æ—ã€‚å› æ­¤ï¼Œäº’è”ç½‘çš„åè®®å°±æ˜¯ TCP/IPï¼ŒTCP/IP å°±æ˜¯äº’è”ç½‘çš„åè®®ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6zhns2grvj30lc0eojse.jpg" alt="img"></p><p>æ¯ä¸ªåˆ†å±‚ä¸­ï¼Œéƒ½ä¼šå¯¹æ‰€å‘é€çš„æ•°æ®é™„åŠ ä¸€ä¸ªé¦–éƒ¨ï¼Œåœ¨è¿™ä¸ªé¦–éƒ¨ä¸­åŒ…å«äº†è¯¥å±‚å¿…è¦çš„ä¿¡æ¯ï¼Œå¦‚å‘é€çš„ç›®æ ‡åœ°å€ä»¥åŠåè®®ç›¸å…³ä¿¡æ¯ã€‚é€šå¸¸ï¼Œä¸ºåè®®æä¾›çš„ä¿¡æ¯ä¸ºåŒ…é¦–éƒ¨ï¼Œæ‰€è¦å‘é€çš„å†…å®¹ä¸ºæ•°æ®ã€‚åœ¨ä¸‹ä¸€å±‚çš„è§’åº¦çœ‹ï¼Œä»ä¸Šä¸€å±‚æ”¶åˆ°çš„åŒ…å…¨éƒ¨éƒ½è¢«è®¤ä¸ºæ˜¯æœ¬å±‚çš„æ•°æ®ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6zhmr7ldbj30fk0dz751.jpg" alt="img"></p><p>ç½‘ç»œä¸­ä¼ è¾“çš„æ•°æ®åŒ…ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€éƒ¨åˆ†æ˜¯åè®®æ‰€è¦ç”¨åˆ°çš„é¦–éƒ¨ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ä¸Šä¸€å±‚ä¼ è¿‡æ¥çš„æ•°æ®ã€‚é¦–éƒ¨çš„ç»“æ„ç”±åè®®çš„å…·ä½“è§„èŒƒè¯¦ç»†å®šä¹‰ã€‚åœ¨æ•°æ®åŒ…çš„é¦–éƒ¨ï¼Œæ˜ç¡®æ ‡æ˜äº†åè®®åº”è¯¥å¦‚ä½•è¯»å–æ•°æ®ã€‚åè¿‡æ¥è¯´ï¼Œçœ‹åˆ°é¦–éƒ¨ï¼Œä¹Ÿå°±èƒ½å¤Ÿäº†è§£è¯¥åè®®å¿…è¦çš„ä¿¡æ¯ä»¥åŠæ‰€è¦å¤„ç†çš„æ•°æ®ã€‚<strong>åŒ…é¦–éƒ¨å°±åƒåè®®çš„è„¸ã€‚</strong></p><h3 id="æ•°æ®å¤„ç†æµç¨‹"><a href="#æ•°æ®å¤„ç†æµç¨‹" class="headerlink" title="æ•°æ®å¤„ç†æµç¨‹"></a>æ•°æ®å¤„ç†æµç¨‹</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6zhpvepe5j30lg0lkdis.jpg" alt="img"></p><ol><li>åº”ç”¨ç¨‹åºå¤„ç†<br>é¦–å…ˆåº”ç”¨ç¨‹åºä¼šè¿›è¡Œç¼–ç å¤„ç†ï¼Œè¿™äº›ç¼–ç ç›¸å½“äº OSI çš„è¡¨ç¤ºå±‚åŠŸèƒ½ï¼›<br>ç¼–ç è½¬åŒ–åï¼Œé‚®ä»¶ä¸ä¸€å®šé©¬ä¸Šè¢«å‘é€å‡ºå»ï¼Œè¿™ç§ä½•æ—¶å»ºç«‹é€šä¿¡è¿æ¥ä½•æ—¶å‘é€æ•°æ®çš„ç®¡ç†åŠŸèƒ½ï¼Œç›¸å½“äº OSI çš„ä¼šè¯å±‚åŠŸèƒ½ã€‚</li><li>TCP æ¨¡å—çš„å¤„ç†<br>TCP æ ¹æ®åº”ç”¨çš„æŒ‡ç¤ºï¼Œè´Ÿè´£å»ºç«‹è¿æ¥ã€å‘é€æ•°æ®ä»¥åŠæ–­å¼€è¿æ¥ã€‚TCP æä¾›å°†åº”ç”¨å±‚å‘æ¥çš„æ•°æ®é¡ºåˆ©å‘é€è‡³å¯¹ç«¯çš„å¯é ä¼ è¾“ã€‚ä¸ºäº†å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œéœ€è¦åœ¨åº”ç”¨å±‚æ•°æ®çš„å‰ç«¯é™„åŠ ä¸€ä¸ª TCP é¦–éƒ¨ã€‚</li><li>IP æ¨¡å—çš„å¤„ç†<br>IP å°† TCP ä¼ è¿‡æ¥çš„ TCP é¦–éƒ¨å’Œ TCP æ•°æ®åˆèµ·æ¥å½“åšè‡ªå·±çš„æ•°æ®ï¼Œå¹¶åœ¨ TCP é¦–éƒ¨çš„å‰ç«¯åŠ ä¸Šè‡ªå·±çš„ IP é¦–éƒ¨ã€‚IP åŒ…ç”Ÿæˆåï¼Œå‚è€ƒè·¯ç”±æ§åˆ¶è¡¨å†³å®šæ¥å—æ­¤ IP åŒ…çš„è·¯ç”±æˆ–ä¸»æœºã€‚</li><li>ç½‘ç»œæ¥å£ï¼ˆä»¥å¤ªç½‘é©±åŠ¨ï¼‰çš„å¤„ç†<br>ä» IP ä¼ è¿‡æ¥çš„ IP åŒ…å¯¹äºä»¥å¤ªç½‘æ¥è¯´å°±æ˜¯æ•°æ®ã€‚ç»™è¿™äº›æ•°æ®é™„åŠ ä¸Šä»¥å¤ªç½‘é¦–éƒ¨å¹¶è¿›è¡Œå‘é€å¤„ç†ï¼Œç”Ÿæˆçš„ä»¥å¤ªç½‘æ•°æ®åŒ…å°†é€šè¿‡ç‰©ç†å±‚ä¼ è¾“ç»™æ¥æ”¶ç«¯ã€‚</li><li>ç½‘ç»œæ¥å£ï¼ˆä»¥å¤ªç½‘é©±åŠ¨ï¼‰çš„å¤„ç†<br>ä¸»æœºæ”¶åˆ°ä»¥å¤ªç½‘åŒ…åï¼Œé¦–å…ˆä»ä»¥å¤ªç½‘åŒ…é¦–éƒ¨æ‰¾åˆ° MAC åœ°å€åˆ¤æ–­æ˜¯å¦ä¸ºå‘é€ç»™è‡ªå·±çš„åŒ…ï¼Œè‹¥ä¸æ˜¯åˆ™ä¸¢å¼ƒæ•°æ®ã€‚<br>å¦‚æœæ˜¯å‘é€ç»™è‡ªå·±çš„åŒ…ï¼Œåˆ™ä»ä»¥å¤ªç½‘åŒ…é¦–éƒ¨ä¸­çš„ç±»å‹ç¡®å®šæ•°æ®ç±»å‹ï¼Œå†ä¼ ç»™ç›¸åº”çš„æ¨¡å—ï¼Œå¦‚ IPã€ARP ç­‰ã€‚è¿™é‡Œçš„ä¾‹å­åˆ™æ˜¯ IP ã€‚</li><li>IP æ¨¡å—çš„å¤„ç†<br>IP æ¨¡å—æ¥æ”¶åˆ° æ•°æ®åä¹Ÿåšç±»ä¼¼çš„å¤„ç†ã€‚ä»åŒ…é¦–éƒ¨ä¸­åˆ¤æ–­æ­¤ IP åœ°å€æ˜¯å¦ä¸è‡ªå·±çš„ IP åœ°å€åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ™æ ¹æ®é¦–éƒ¨çš„åè®®ç±»å‹å°†æ•°æ®å‘é€ç»™å¯¹åº”çš„æ¨¡å—ï¼Œå¦‚ TCPã€UDPã€‚è¿™é‡Œçš„ä¾‹å­åˆ™æ˜¯ TCPã€‚<br>å¦å¤–å—ï¼Œå¯¹äºæœ‰è·¯ç”±å™¨çš„æƒ…å†µï¼Œæ¥æ”¶ç«¯åœ°å€å¾€å¾€ä¸æ˜¯è‡ªå·±çš„åœ°å€ï¼Œæ­¤æ—¶ï¼Œéœ€è¦å€ŸåŠ©è·¯ç”±æ§åˆ¶è¡¨ï¼Œåœ¨è°ƒæŸ¥åº”è¯¥é€å¾€çš„ä¸»æœºæˆ–è·¯ç”±å™¨ä¹‹åå†è¿›è¡Œè½¬å‘æ•°æ®ã€‚</li><li>TCP æ¨¡å—çš„å¤„ç†<br>åœ¨ TCP æ¨¡å—ä¸­ï¼Œé¦–å…ˆä¼šè®¡ç®—ä¸€ä¸‹æ ¡éªŒå’Œï¼Œåˆ¤æ–­æ•°æ®æ˜¯å¦è¢«ç ´åã€‚ç„¶åæ£€æŸ¥æ˜¯å¦åœ¨æŒ‰ç…§åºå·æ¥æ”¶æ•°æ®ã€‚æœ€åæ£€æŸ¥ç«¯å£å·ï¼Œç¡®å®šå…·ä½“çš„åº”ç”¨ç¨‹åºã€‚æ•°æ®è¢«å®Œæ•´åœ°æ¥æ”¶ä»¥åï¼Œä¼šä¼ ç»™ç”±ç«¯å£å·è¯†åˆ«çš„åº”ç”¨ç¨‹åºã€‚</li><li>åº”ç”¨ç¨‹åºçš„å¤„ç†<br>æ¥æ”¶ç«¯åº”ç”¨ç¨‹åºä¼šç›´æ¥æ¥æ”¶å‘é€ç«¯å‘é€çš„æ•°æ®ã€‚é€šè¿‡è§£ææ•°æ®ï¼Œå±•ç¤ºç›¸åº”çš„å†…å®¹ã€‚</li></ol><h2 id="IP-æœåŠ¡çš„ä¸»è¦ç‰¹ç‚¹"><a href="#IP-æœåŠ¡çš„ä¸»è¦ç‰¹ç‚¹" class="headerlink" title="IP æœåŠ¡çš„ä¸»è¦ç‰¹ç‚¹"></a>IP æœåŠ¡çš„ä¸»è¦ç‰¹ç‚¹</h2><p>IP åè®®ä¸ºä¸Šå±‚åè®®æä¾›æ— çŠ¶æ€ã€æ— è¿æ¥ã€ä¸å¯é çš„æœåŠ¡ã€‚</p><ul><li><h6 id="æ— çŠ¶æ€"><a href="#æ— çŠ¶æ€" class="headerlink" title="æ— çŠ¶æ€"></a>æ— çŠ¶æ€</h6></li></ul><p>æ— çŠ¶æ€æ˜¯æŒ‡ IP é€šä¿¡åŒæ–¹ä¸åŒæ­¥ä¼ è¾“æ•°æ®çš„çŠ¶æ€ä¿¡æ¯ï¼Œæ‰€æœ‰ IP æ•°æ®æŠ¥çš„å‘é€ã€ä¼ è¾“ã€æ¥å—éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹ã€æ²¡æœ‰ä¸Šä¸‹æ–‡å…³ç³»çš„ã€‚è¿™ç§æœåŠ¡ä¼˜ç‚¹åœ¨äºç®€å•ã€é«˜æ•ˆã€‚æœ€å¤§çš„ç¼ºç‚¹æ˜¯æ— æ³•å¤„ç†ä¹±åºå’Œé‡å¤çš„ IP æ•°æ®æŠ¥ï¼Œç¡®ä¿ IP æ•°æ®æŠ¥å®Œæ•´çš„å·¥ä½œåªèƒ½äº¤ç»™ä¸Šå±‚åè®®æ¥å®Œæˆã€‚</p><ul><li><h6 id="æ— è¿æ¥"><a href="#æ— è¿æ¥" class="headerlink" title="æ— è¿æ¥"></a>æ— è¿æ¥</h6></li></ul><p>æ— è¿æ¥æ˜¯æŒ‡ IP é€šä¿¡åŒæ–¹éƒ½ä¸é•¿ä¹…åœ°ç»´æŒå¯¹æ–¹çš„ä»»ä½•ä¿¡æ¯ã€‚ä¸Šå±‚åè®®æ¯æ¬¡å‘é€æ•°æ®çš„æ—¶å€™ï¼Œéƒ½éœ€è¦æ˜ç¡®æŒ‡å‡ºå¯¹æ–¹çš„ IP åœ°å€ã€‚</p><ul><li><h6 id="ä¸å¯é "><a href="#ä¸å¯é " class="headerlink" title="ä¸å¯é "></a>ä¸å¯é </h6></li></ul><p>ä¸å¯é æ˜¯æŒ‡ IP åè®®ä¸èƒ½ä¿è¯ IP æ•°æ®æŠ¥å‡†ç¡®åˆ°è¾¾æ¥æ”¶ç«¯ï¼Œå®ƒæŒ‡æ‰¿è¯ºå°½æœ€å¤§åŠªåŠ›äº¤ä»˜ã€‚IP æ¨¡å—ä¸€æ—¦æ£€æµ‹åˆ°æ•°æ®æŠ¥å‘é€å¤±è´¥ï¼Œå°±é€šçŸ¥ä¸Šå±‚åè®®ï¼Œè€Œä¸ä¼šè¯•å›¾é‡ä¼ ã€‚</p><h2 id="IP-åœ°å€"><a href="#IP-åœ°å€" class="headerlink" title="IP åœ°å€"></a>IP åœ°å€</h2><h3 id="IP-åœ°å€æ¦‚è¿°"><a href="#IP-åœ°å€æ¦‚è¿°" class="headerlink" title="IP åœ°å€æ¦‚è¿°"></a>IP åœ°å€æ¦‚è¿°</h3><ul><li>åœ¨è®¡ç®—æœºé€šä¿¡ä¸­ï¼Œä¸ºäº†è¯†åˆ«é€šä¿¡å¯¹ç«¯ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªç±»ä¼¼äºåœ°å€çš„è¯†åˆ«ç è¿›è¡Œæ ‡è¯†ã€‚åœ¨æ•°æ®é“¾è·¯ä¸­çš„ MAC åœ°å€æ­£æ˜¯ç”¨æ¥æ ‡è¯†åŒä¸€ä¸ªé“¾è·¯ä¸­ä¸åŒè®¡ç®—æœºçš„ä¸€ç§è¯†åˆ«ç ã€‚</li><li>ä½œä¸ºç½‘ç»œå±‚çš„ IP ,ä¹Ÿæœ‰è¿™ç§åœ°å€ä¿¡æ¯ï¼Œä¸€èˆ¬å«åš IP åœ°å€ã€‚IP åœ°å€ç”¨äºåœ¨â€œ<strong>è¿æ¥åˆ°ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºä¸­è¯†åˆ«å‡ºè¿›è¡Œé€šä¿¡çš„ç›®æ ‡åœ°å€</strong>â€ã€‚å› æ­¤ï¼Œåœ¨ TCP/IP é€šä¿¡ä¸­æ‰€æœ‰ä¸»æœºæˆ–è·¯ç”±å™¨å¿…é¡»è®¾å®šè‡ªå·±çš„ IP åœ°å€ã€‚</li><li>ä¸è®ºä¸€å°ä¸»æœºä¸å“ªç§æ•°æ®é“¾è·¯è¿æ¥ï¼Œå…¶ IP åœ°å€çš„å½¢å¼éƒ½ä¿æŒä¸å˜ã€‚</li><li>IP åœ°å€ï¼ˆIPv4 åœ°å€ï¼‰ç”± 32 ä½æ­£æ•´æ•°æ¥è¡¨ç¤ºã€‚IP åœ°å€åœ¨è®¡ç®—æœºå†…éƒ¨ä»¥äºŒè¿›åˆ¶æ–¹å¼è¢«å¤„ç†ã€‚ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬å¹¶ä¸ä¹ æƒ¯äºé‡‡ç”¨äºŒè¿›åˆ¶æ–¹å¼ï¼Œæˆ‘ä»¬å°† 32 ä½çš„ IP åœ°å€ä»¥æ¯ 8 ä½ä¸ºä¸€ç»„ï¼Œåˆ†æˆ 4 ç»„ï¼Œæ¯ç»„ä»¥ â€œ.â€ éš”å¼€ï¼Œå†å°†æ¯ç»„æ•°è½¬æ¢æˆåè¿›åˆ¶æ•°ã€‚å¦‚ä¸‹ï¼š</li></ul><table><thead><tr><th>2^8</th><th>2^8</th><th>2^8</th><th>2^8</th><th></th></tr></thead><tbody><tr><td>10101100</td><td>00010100</td><td>00000001</td><td>00000001</td><td>ï¼ˆ2 è¿›åˆ¶ï¼‰</td></tr><tr><td>172.</td><td>20.</td><td>1.</td><td>1</td><td>ï¼ˆ10 è¿›åˆ¶ï¼‰</td></tr></tbody></table><h3 id="IP-åœ°å€ç”±ç½‘ç»œå’Œä¸»æœºä¸¤éƒ¨åˆ†æ ‡è¯†ç»„æˆ"><a href="#IP-åœ°å€ç”±ç½‘ç»œå’Œä¸»æœºä¸¤éƒ¨åˆ†æ ‡è¯†ç»„æˆ" class="headerlink" title="IP åœ°å€ç”±ç½‘ç»œå’Œä¸»æœºä¸¤éƒ¨åˆ†æ ‡è¯†ç»„æˆ"></a>IP åœ°å€ç”±ç½‘ç»œå’Œä¸»æœºä¸¤éƒ¨åˆ†æ ‡è¯†ç»„æˆ</h3><ul><li>å¦‚ä¸‹å›¾ï¼Œç½‘ç»œæ ‡è¯†åœ¨æ•°æ®é“¾è·¯çš„æ¯ä¸ªæ®µé…ç½®ä¸åŒçš„å€¼ã€‚ç½‘ç»œæ ‡è¯†å¿…é¡»ä¿è¯ç›¸äº’è¿æ¥çš„æ¯ä¸ªæ®µçš„åœ°å€ä¸ç›¸é‡å¤ã€‚è€Œç›¸åŒæ®µå†…ç›¸è¿çš„ä¸»æœºå¿…é¡»æœ‰ç›¸åŒçš„ç½‘ç»œåœ°å€ã€‚IP åœ°å€çš„â€œä¸»æœºæ ‡è¯†â€åˆ™ä¸å…è®¸åœ¨åŒä¸€ä¸ªç½‘æ®µå†…é‡å¤å‡ºç°ã€‚ç”±æ­¤ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œåœ¨ç›¸äº’è¿æ¥çš„æ•´ä¸ªç½‘ç»œä¸­ä¿è¯æ¯å°ä¸»æœºçš„ IP åœ°å€éƒ½ä¸ä¼šç›¸äº’é‡å ã€‚å³ <strong>IP åœ°å€å…·æœ‰äº†å”¯ä¸€æ€§</strong>ã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70l2qlpa6j30k80hiwhe.jpg" alt="img"></p><ul><li>å¦‚ä¸‹å›¾ï¼ŒIP åŒ…è¢«è½¬å‘åˆ°é€”ä¸­æŸä¸ªè·¯ç”±å™¨æ—¶ï¼Œæ­£æ˜¯<strong>åˆ©ç”¨ç›®æ ‡ IP åœ°å€çš„ç½‘ç»œæ ‡è¯†è¿›è¡Œè·¯ç”±</strong>ã€‚å› ä¸ºå³ä½¿ä¸çœ‹ä¸»æœºæ ‡è¯†ï¼Œåªè¦ä¸€è§åˆ°ç½‘ç»œæ ‡è¯†å°±èƒ½åˆ¤æ–­å‡ºæ˜¯å¦ä¸ºè¯¥ç½‘æ®µå†…çš„ä¸»æœºã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70l4my99cj30k40auabx.jpg" alt="img"></p><h3 id="IP-åœ°å€çš„åˆ†ç±»"><a href="#IP-åœ°å€çš„åˆ†ç±»" class="headerlink" title="IP åœ°å€çš„åˆ†ç±»"></a>IP åœ°å€çš„åˆ†ç±»</h3><p><strong>IP åœ°å€åˆ†ä¸ºå››ä¸ªçº§åˆ«ï¼Œåˆ†åˆ«ä¸º A ç±»ã€B ç±»ã€C ç±»ã€D ç±»ã€‚å®ƒæ ¹æ® IP åœ°å€ä¸­ä»ç¬¬ 1 ä½åˆ°ç¬¬ 4 ä½çš„æ¯”ç‰¹åˆ—å¯¹å…¶ç½‘ç»œæ ‡è¯†å’Œä¸»æœºæ ‡è¯†è¿›è¡ŒåŒºåˆ†ã€‚</strong></p><ul><li><strong>A ç±» IP åœ°å€æ˜¯é¦–ä½ä»¥ â€œ0â€ å¼€å¤´çš„åœ°å€ã€‚</strong>ä»ç¬¬ 1 ä½åˆ°ç¬¬ 8 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ0.0.0.0~127.0.0.0 æ˜¯ A ç±»çš„ç½‘ç»œåœ°å€ã€‚A ç±»åœ°å€çš„å 24 ä½ç›¸å½“äºä¸»æœºæ ‡è¯†ã€‚å› æ­¤ï¼Œä¸€ä¸ªç½‘æ®µå†…å¯å®¹çº³çš„ä¸»æœºåœ°å€ä¸Šé™ä¸º 16,777,214 ä¸ªã€‚</li><li><strong>B ç±» IP åœ°å€æ˜¯å‰ä¸¤ä½ â€œ10â€ çš„åœ°å€ã€‚</strong>ä»ç¬¬ 1 ä½åˆ°ç¬¬ 16 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ128.0.0.0~191.255.0.0 æ˜¯ B ç±»çš„ç½‘ç»œåœ°å€ã€‚B ç±»åœ°å€çš„å 16 ä½ç›¸å½“äºä¸»æœºæ ‡è¯†ã€‚å› æ­¤ï¼Œä¸€ä¸ªç½‘æ®µå†…å¯å®¹çº³çš„ä¸»æœºåœ°å€ä¸Šé™ä¸º 65,534 ä¸ªã€‚</li><li><strong>C ç±» IP åœ°å€æ˜¯å‰ä¸‰ä½ä¸º â€œ110â€ çš„åœ°å€ã€‚</strong>ä»ç¬¬ 1 ä½åˆ°ç¬¬ 24 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ192.0.0.0~223.255.255.0 æ˜¯ C ç±»çš„ç½‘ç»œåœ°å€ã€‚C ç±»åœ°å€çš„å 8 ä½ç›¸å½“äºä¸»æœºæ ‡è¯†ã€‚å› æ­¤ï¼Œä¸€ä¸ªç½‘æ®µå†…å¯å®¹çº³çš„ä¸»æœºåœ°å€ä¸Šé™ä¸º 254 ä¸ªã€‚</li><li><strong>D ç±» IP åœ°å€æ˜¯å‰å››ä½ä¸º â€œ1110â€ çš„åœ°å€ã€‚</strong>ä»ç¬¬ 1 ä½åˆ°ç¬¬ 32 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ224.0.0.0~239.255.255.255 æ˜¯ D ç±»çš„ç½‘ç»œåœ°å€ã€‚D ç±»åœ°å€æ²¡æœ‰ä¸»æœºæ ‡è¯†ï¼Œå¸¸ç”¨äºå¤šæ’­ã€‚</li><li>åœ¨åˆ†é… IP åœ°å€æ—¶å…³äºä¸»æœºæ ‡è¯†æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ã€‚å³è¦ç”¨æ¯”ç‰¹ä½è¡¨ç¤ºä¸»æœºåœ°å€æ—¶ï¼Œä¸å¯ä»¥å…¨éƒ¨ä¸º 0 æˆ–å…¨éƒ¨ä¸º 1ã€‚å› ä¸ºå…¨éƒ¨ä¸º 0 åªæœ‰åœ¨è¡¨ç¤ºå¯¹åº”çš„ç½‘ç»œåœ°å€æˆ– IP åœ°å€ä¸å¯ä»¥è·çŸ¥çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ã€‚è€Œå…¨éƒ¨ä¸º 1 çš„ä¸»æœºé€šå¸¸ä½œä¸ºå¹¿æ’­åœ°å€ã€‚å› æ­¤ï¼Œåœ¨åˆ†é…è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥å»æ‰è¿™ä¸¤ç§æƒ…å†µã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ C ç±»åœ°å€æ¯ä¸ªç½‘æ®µæœ€å¤šåªèƒ½æœ‰ 254ï¼ˆ 28 - 2 = 254ï¼‰ä¸ªä¸»æœºåœ°å€çš„åŸå› ã€‚</li></ul><h3 id="å¹¿æ’­åœ°å€"><a href="#å¹¿æ’­åœ°å€" class="headerlink" title="å¹¿æ’­åœ°å€"></a>å¹¿æ’­åœ°å€</h3><ul><li>å¹¿æ’­åœ°å€ç”¨äºåœ¨åŒä¸€ä¸ªé“¾è·¯ä¸­ç›¸äº’è¿æ¥çš„ä¸»æœºä¹‹é—´å‘é€æ•°æ®åŒ…ã€‚å°† IP åœ°å€ä¸­çš„ä¸»æœºåœ°å€éƒ¨åˆ†å…¨éƒ¨è®¾ç½®ä¸º 1ï¼Œå°±æˆäº†å¹¿æ’­åœ°å€ã€‚</li><li>å¹¿æ’­åˆ†ä¸ºæœ¬åœ°å¹¿æ’­å’Œç›´æ¥å¹¿æ’­ä¸¤ç§ã€‚åœ¨æœ¬ç½‘ç»œå†…çš„å¹¿æ’­å«åšæœ¬åœ°å¹¿æ’­ï¼›åœ¨ä¸åŒç½‘ç»œä¹‹é—´çš„å¹¿æ’­å«åšç›´æ¥å¹¿æ’­ã€‚</li></ul><h3 id="IP-å¤šæ’­"><a href="#IP-å¤šæ’­" class="headerlink" title="IP å¤šæ’­"></a>IP å¤šæ’­</h3><ul><li><p>å¤šæ’­ç”¨äºå°†åŒ…å‘é€ç»™ç‰¹å®šç»„å†…çš„æ‰€æœ‰ä¸»æœºã€‚ç”±äºå…¶ç›´æ¥ä½¿ç”¨ IP åœ°å€ï¼Œå› æ­¤ä¹Ÿä¸å­˜åœ¨å¯é ä¼ è¾“ã€‚</p></li><li><p>ç›¸æ¯”äºå¹¿æ’­ï¼Œå¤šæ’­æ—¢å¯ä»¥ç©¿é€è·¯ç”±å™¨ï¼Œåˆå¯ä»¥å®ç°åªç»™é‚£äº›å¿…è¦çš„ç»„å‘é€æ•°æ®åŒ…ã€‚è¯·çœ‹ä¸‹å›¾ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70l8g7veoj30f70jjn02.jpg" alt="img"></p></li><li><p>å¤šæ’­ä½¿ç”¨ D ç±»åœ°å€ã€‚å› æ­¤ï¼Œå¦‚æœä»é¦–ä½å¼€å§‹åˆ°ç¬¬ 4 ä½æ˜¯ â€œ1110â€ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯å¤šæ’­åœ°å€ã€‚è€Œå‰©ä¸‹çš„ 28 ä½å¯ä»¥æˆä¸ºå¤šæ’­çš„ç»„ç¼–å·ã€‚</p></li><li><p>æ­¤å¤–ï¼Œ å¯¹äºå¤šæ’­ï¼Œæ‰€æœ‰çš„ä¸»æœºï¼ˆè·¯ç”±å™¨ä»¥å¤–çš„ä¸»æœºå’Œç»ˆç«¯ä¸»æœºï¼‰å¿…é¡»å±äº 224.0.0.1 çš„ç»„ï¼Œæ‰€æœ‰çš„è·¯ç”±å™¨å¿…é¡»å±äº 224.0.0.2 çš„ç»„ã€‚</p></li></ul><h3 id="å­ç½‘æ©ç "><a href="#å­ç½‘æ©ç " class="headerlink" title="å­ç½‘æ©ç "></a>å­ç½‘æ©ç </h3><ul><li>ç°åœ¨ä¸€ä¸ª IP åœ°å€çš„ç½‘ç»œæ ‡è¯†å’Œä¸»æœºæ ‡è¯†å·²ä¸å†å—é™äºè¯¥åœ°å€çš„ç±»åˆ«ï¼Œè€Œæ˜¯ç”±ä¸€ä¸ªå«åšâ€œå­ç½‘æ©ç â€çš„è¯†åˆ«ç é€šè¿‡å­ç½‘ç½‘ç»œåœ°å€ç»†åˆ†å‡ºæ¯” A ç±»ã€B ç±»ã€C ç±»æ›´å°ç²’åº¦çš„ç½‘ç»œã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šå°±æ˜¯å°†åŸæ¥ A ç±»ã€B ç±»ã€C ç±»ç­‰åˆ†ç±»ä¸­çš„ä¸»æœºåœ°å€éƒ¨åˆ†ç”¨ä½œå­ç½‘åœ°å€ï¼Œå¯ä»¥å°†åŸç½‘ç»œåˆ†ä¸ºå¤šä¸ªç‰©ç†ç½‘ç»œçš„ä¸€ç§æœºåˆ¶ã€‚</li><li>å­ç½‘æ©ç ç”¨äºŒè¿›åˆ¶æ–¹å¼è¡¨ç¤ºçš„è¯ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª 32 ä½çš„æ•°å­—ã€‚å®ƒå¯¹åº” IP åœ°å€ç½‘ç»œæ ‡è¯†éƒ¨åˆ†çš„ä½å…¨éƒ¨ä¸º â€œ1â€ï¼Œå¯¹åº” IP åœ°å€ä¸»æœºæ ‡è¯†çš„éƒ¨åˆ†åˆ™å…¨éƒ¨ä¸º â€œ0â€ã€‚ç”±æ­¤ï¼Œä¸€ä¸ª IP åœ°å€å¯ä»¥ä¸å†å—é™äºè‡ªå·±çš„ç±»åˆ«ï¼Œè€Œæ˜¯å¯ä»¥ç”¨è¿™æ ·çš„å­ç½‘æ©ç è‡ªç”±åœ°å®šä½è‡ªå·±çš„ç½‘ç»œæ ‡è¯†é•¿åº¦ã€‚å½“ç„¶ï¼Œå­ç½‘æ©ç å¿…é¡»æ˜¯ IP åœ°å€çš„é¦–ä½å¼€å§‹è¿ç»­çš„ â€œ1â€ã€‚</li><li>å¯¹äºå­ç½‘æ©ç ï¼Œç›®å‰æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯ï¼Œå°† IP åœ°å€ä¸å­ç½‘æ©ç çš„åœ°å€åˆ†åˆ«ç”¨ä¸¤è¡Œæ¥è¡¨ç¤ºã€‚ä»¥ 172.20.100.52 çš„å‰ 26 ä½æ˜¯ç½‘ç»œåœ°å€çš„æƒ…å†µä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</li></ul><table><thead><tr><th>IP åœ°å€</th><th>172.</th><th>20.</th><th>100.</th><th>52</th></tr></thead><tbody><tr><td>å­ç½‘æ©ç </td><td>255.</td><td>255.</td><td>255.</td><td>192</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>ç½‘ç»œåœ°å€</td><td>172.</td><td>20.</td><td>100.</td><td>0</td></tr><tr><td>å­ç½‘æ©ç </td><td>255.</td><td>255.</td><td>255.</td><td>192</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>å¹¿æ’­åœ°å€</td><td>172.</td><td>20.</td><td>100.</td><td>63</td></tr><tr><td>å­ç½‘æ©ç </td><td>255.</td><td>255.</td><td>255.</td><td>192</td></tr></tbody></table><ul><li>ç¬¬äºŒç§è¡¨ç¤ºæ–¹å¼æ˜¯ï¼Œåœ¨æ¯ä¸ª IP åœ°å€åé¢è¿½åŠ ç½‘ç»œåœ°å€çš„ä½æ•°ç”¨ â€œ/ â€ éš”å¼€ï¼Œå¦‚ä¸‹ï¼š</li></ul><table><thead><tr><th>IP åœ°å€</th><th>172.</th><th>20.</th><th>100.</th><th>52</th><th>/ 26</th></tr></thead><tbody><tr><td>ç½‘ç»œåœ°å€</td><td>172.</td><td>20.</td><td>100.</td><td>0</td><td>/ 26</td></tr><tr><td>å¹¿æ’­åœ°å€</td><td>172.</td><td>20.</td><td>100.</td><td>63</td><td>/ 26</td></tr></tbody></table><ul><li>å¦å¤–ï¼Œåœ¨ç¬¬äºŒç§æ–¹å¼ä¸‹è®°è¿°ç½‘ç»œåœ°å€æ—¶å¯ä»¥çœç•¥åé¢çš„ â€œ0â€ ã€‚ä¾‹å¦‚ï¼š172.20.0.0/26 è·Ÿ 172.20/26 å…¶å®æ˜¯ä¸€ä¸ªæ„æ€ã€‚</li></ul><h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h2><ul><li>å‘é€æ•°æ®åŒ…æ—¶æ‰€ä½¿ç”¨çš„åœ°å€æ˜¯ç½‘ç»œå±‚çš„åœ°å€ï¼Œå³ IP åœ°å€ã€‚ç„¶è€Œä»…ä»…æœ‰ IP åœ°å€è¿˜ä¸è¶³ä»¥å®ç°å°†æ•°æ®åŒ…å‘é€åˆ°å¯¹ç«¯ç›®æ ‡åœ°å€ï¼Œåœ¨æ•°æ®å‘é€è¿‡ç¨‹ä¸­è¿˜éœ€è¦ç±»ä¼¼äºâ€œæŒ‡æ˜è·¯ç”±å™¨æˆ–ä¸»æœºâ€çš„ä¿¡æ¯ï¼Œä»¥ä¾¿çœŸæ­£å‘å¾€ç›®æ ‡åœ°å€ã€‚ä¿å­˜è¿™ç§ä¿¡æ¯çš„å°±æ˜¯è·¯ç”±æ§åˆ¶è¡¨ã€‚</li><li>è¯¥è·¯ç”±æ§åˆ¶è¡¨çš„å½¢æˆæ–¹å¼æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯ç®¡ç†å‘˜æ‰‹åŠ¨è®¾ç½®ï¼Œå¦ä¸€ç§æ˜¯è·¯ç”±å™¨ä¸å…¶ä»–è·¯ç”±å™¨ç›¸äº’äº¤æ¢ä¿¡æ¯æ—¶è‡ªåŠ¨åˆ·æ–°ã€‚å‰è€…ä¹Ÿå«åšé™æ€è·¯ç”±æ§åˆ¶ï¼Œè€Œåè€…å«åšåŠ¨æ€è·¯ç”±æ§åˆ¶ã€‚</li><li>IP åè®®å§‹ç»ˆè®¤ä¸ºè·¯ç”±è¡¨æ˜¯æ­£ç¡®çš„ã€‚ç„¶åï¼ŒIP æœ¬èº«å¹¶æ²¡æœ‰å®šä¹‰åˆ¶ä½œè·¯ç”±æ§åˆ¶è¡¨çš„åè®®ã€‚å³ IP æ²¡æœ‰åˆ¶ä½œè·¯ç”±æ§åˆ¶è¡¨çš„æœºåˆ¶ã€‚è¯¥è¡¨ç¤ºç”±ä¸€ä¸ªå«åšâ€œè·¯ç”±åè®®â€çš„åè®®åˆ¶ä½œè€Œæˆã€‚</li></ul><h3 id="IP-åœ°å€ä¸è·¯ç”±æ§åˆ¶"><a href="#IP-åœ°å€ä¸è·¯ç”±æ§åˆ¶" class="headerlink" title="IP åœ°å€ä¸è·¯ç”±æ§åˆ¶"></a>IP åœ°å€ä¸è·¯ç”±æ§åˆ¶</h3><ul><li>IP åœ°å€çš„ç½‘ç»œåœ°å€éƒ¨åˆ†ç”¨äºè¿›è¡Œè·¯ç”±æ§åˆ¶ã€‚</li><li>è·¯ç”±æ§åˆ¶è¡¨ä¸­è®°å½•ç€ç½‘ç»œåœ°å€ä¸ä¸‹ä¸€æ­¥åº”è¯¥å‘é€è‡³è·¯ç”±å™¨çš„åœ°å€ã€‚</li><li>åœ¨å‘é€ IP åŒ…æ—¶ï¼Œé¦–å…ˆè¦ç¡®å®š IP åŒ…é¦–éƒ¨ä¸­çš„ç›®æ ‡åœ°å€ï¼Œå†ä»è·¯ç”±æ§åˆ¶è¡¨ä¸­æ‰¾åˆ°ä¸è¯¥åœ°å€å…·æœ‰ç›¸åŒç½‘ç»œåœ°å€çš„è®°å½•ï¼Œæ ¹æ®è¯¥è®°å½•å°† IP åŒ…è½¬å‘ç»™ç›¸åº”çš„ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚å¦‚æœè·¯ç”±æ§åˆ¶è¡¨ä¸­å­˜åœ¨å¤šæ¡ç›¸åŒç½‘ç»œåœ°å€çš„è®°å½•ï¼Œå°±é€‰æ‹©ä¸€ä¸ªæœ€ä¸ºå»åˆçš„ç½‘ç»œåœ°å€ã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70ldgjh6gj30ka0gen0n.jpg" alt="img"></p><h3 id="è·¯ç”±åŒ¹é…"><a href="#è·¯ç”±åŒ¹é…" class="headerlink" title="è·¯ç”±åŒ¹é…"></a>è·¯ç”±åŒ¹é…</h3><p>è·¯ç”±åŒ¹é…é¡ºåºï¼š<br>1ï¼‰ ç›´æ¥åŒ¹é…ï¼ŒæŸ¥æ‰¾è·¯ç”±è¡¨ä¸­æ˜¯å¦ç”±ä¸ç›®æ ‡ IP åœ°å€å®Œå…¨åŒ¹é…çš„ä¸»æœº IP åœ°å€ï¼Œæ‰¾åˆ°åˆ™åŒ¹é…æˆåŠŸï¼Œæ²¡æœ‰çš„è¯è½¬ 2ï¼›<br>2ï¼‰æŸ¥æ‰¾æ˜¯å¦æœ‰ä¸ç›®æ ‡ IP åœ°å€å…·æœ‰ç›¸åŒç½‘ç»œ ID çš„ IP åœ°å€ï¼Œæ‰¾åˆ°åˆ™åŒ¹é…æˆåŠŸï¼Œæ²¡æœ‰çš„è¯è½¬ 3ï¼›<br>3ï¼‰æŸ¥çœ‹æ˜¯å¦æœ‰é»˜è®¤ç½‘å…³ï¼Œæœ‰åˆ™è½¬å‘ç»™å®ƒï¼Œæ²¡æœ‰çš„è¯ï¼Œè·¯ç”±æŸ¥æ‰¾å¤±è´¥ï¼Œç”± ICMP è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="è·¯ç”±æ›´æ–°"><a href="#è·¯ç”±æ›´æ–°" class="headerlink" title="è·¯ç”±æ›´æ–°"></a>è·¯ç”±æ›´æ–°</h3><p>é€šè¿‡ route å‘½ä»¤æˆ–å…¶ä»–å·¥å…·å¯ä»¥æ‰‹å·¥ä¿®æ”¹è·¯ç”±è¡¨ï¼Œæ˜¯é™æ€è·¯ç”±æ›´æ–°æ–¹å¼ã€‚å¯¹äºå¤§å‹è·¯ç”±å™¨ï¼Œå®ƒä»¬é€šå¸¸é€šè¿‡ BGPã€RIPã€OSPF ç­‰åè®®è¿›è¡ŒåŠ¨æ€è·¯ç”±æ›´æ–°ã€‚</p><h2 id="IP-åˆ†åŒ…ä¸ç»„åŒ…"><a href="#IP-åˆ†åŒ…ä¸ç»„åŒ…" class="headerlink" title="IP åˆ†åŒ…ä¸ç»„åŒ…"></a>IP åˆ†åŒ…ä¸ç»„åŒ…</h2><ul><li>æ¯ç§æ•°æ®é“¾è·¯çš„æœ€å¤§ä¼ è¾“å•å…ƒï¼ˆMTUï¼‰éƒ½ä¸å°½ç›¸åŒï¼Œå› ä¸ºæ¯ä¸ªä¸åŒç±»å‹çš„æ•°æ®é“¾è·¯çš„ä½¿ç”¨ç›®çš„ä¸åŒã€‚ä½¿ç”¨ç›®çš„ä¸åŒï¼Œå¯æ‰¿è½½çš„ MTU ä¹Ÿå°±ä¸åŒã€‚</li><li>ä»»ä½•ä¸€å°ä¸»æœºéƒ½æœ‰å¿…è¦å¯¹ IP åˆ†ç‰‡è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚åˆ†ç‰‡å¾€å¾€åœ¨ç½‘ç»œä¸Šé‡åˆ°æ¯”è¾ƒå¤§çš„æŠ¥æ–‡æ— æ³•ä¸€ä¸‹å­å‘é€å‡ºå»æ—¶æ‰ä¼šè¿›è¡Œå¤„ç†ã€‚</li><li>ç»è¿‡åˆ†ç‰‡ä¹‹åçš„ IP æ•°æ®æŠ¥åœ¨è¢«é‡ç»„çš„æ—¶å€™ï¼Œåªèƒ½ç”±ç›®æ ‡ä¸»æœºè¿›è¡Œã€‚è·¯ç”±å™¨è™½ç„¶åšåˆ†ç‰‡ä½†ä¸ä¼šè¿›è¡Œé‡ç»„ã€‚</li></ul><h3 id="è·¯å¾„-MTU-å‘ç°"><a href="#è·¯å¾„-MTU-å‘ç°" class="headerlink" title="è·¯å¾„ MTU å‘ç°"></a>è·¯å¾„ MTU å‘ç°</h3><ul><li>åˆ†ç‰‡æœºåˆ¶ä¹Ÿæœ‰å®ƒçš„ä¸è¶³ã€‚å¦‚è·¯ç”±å™¨çš„å¤„ç†è´Ÿè·åŠ é‡ä¹‹ç±»ã€‚å› æ­¤ï¼Œåªè¦å…è®¸ï¼Œæ˜¯ä¸å¸Œæœ›ç”±è·¯ç”±å™¨è¿›è¡Œ IP æ•°æ®åŒ…çš„åˆ†ç‰‡å¤„ç†çš„ã€‚</li><li>ä¸ºäº†åº”å¯¹åˆ†ç‰‡æœºåˆ¶çš„ä¸è¶³ï¼Œâ€œè·¯å¾„ MTU å‘ç°â€ æŠ€æœ¯åº”è¿è€Œç”Ÿã€‚è·¯å¾„ MTU æŒ‡çš„æ˜¯ï¼Œä»å‘é€ç«¯ä¸»æœºåˆ°æ¥æ”¶ç«¯ä¸»æœºä¹‹é—´ä¸éœ€è¦åˆ†ç‰‡æ˜¯æœ€å¤§ MTU çš„å¤§å°ã€‚å³è·¯å¾„ä¸­å­˜åœ¨çš„æ‰€æœ‰æ•°æ®é“¾è·¯ä¸­æœ€å°çš„ MTU ã€‚</li><li>è¿›è¡Œè·¯å¾„ MTU å‘ç°ï¼Œå°±å¯ä»¥é¿å…åœ¨ä¸­é€”çš„è·¯ç”±å™¨ä¸Šè¿›è¡Œåˆ†ç‰‡å¤„ç†ï¼Œä¹Ÿå¯ä»¥åœ¨ TCP ä¸­å‘é€æ›´å¤§çš„åŒ…ã€‚</li></ul><h2 id="IPv4"><a href="#IPv4" class="headerlink" title="IPv4"></a>IPv4</h2><h3 id="IPv4-å¤´éƒ¨"><a href="#IPv4-å¤´éƒ¨" class="headerlink" title="IPv4 å¤´éƒ¨"></a>IPv4 å¤´éƒ¨</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70lsqccjaj30eh064dge.jpg" alt="img"></p><ul><li><h6 id="å¤´éƒ¨é•¿åº¦"><a href="#å¤´éƒ¨é•¿åº¦" class="headerlink" title="å¤´éƒ¨é•¿åº¦"></a>å¤´éƒ¨é•¿åº¦</h6></li></ul><p>æ ‡è¯†è¯¥ IP å¤´éƒ¨æœ‰å¤šå°‘ä¸ª 32 ä½ bit å­—ï¼ˆ4 å­—èŠ‚ï¼‰ï¼Œç”±äº 4 ä½æœ€å¤§æè¿° 15ï¼Œæ‰€ä»¥ IP å¤´éƒ¨æœ€å¤§é•¿åº¦ä¸º 60 å­—èŠ‚ã€‚</p><ul><li><h6 id="8-ä¸ºæœåŠ¡ä½"><a href="#8-ä¸ºæœåŠ¡ä½" class="headerlink" title="8 ä¸ºæœåŠ¡ä½"></a>8 ä¸ºæœåŠ¡ä½</h6></li></ul><p>åŒ…æ‹¬ 3 ä½ä¼˜å…ˆæƒä½ï¼Œ4 ä¸º TOS å­—æ®µå’Œ 1 ä½ä¿ç•™å­—æ®µã€‚<br>4 ä¸º TOS å­—æ®µåˆ†åˆ«è¡¨ç¤ºï¼šæœ€å°å»¶æ—¶ï¼Œæœ€å¤§ååé‡ã€æœ€é«˜å¯é æ€§å’Œæœ€å°è´¹ç”¨ã€‚å…¶ä¸­æœ€å¤šèƒ½é€‰æ‹©ä¸€ä½ç½® 1ï¼Œåº”ç”¨ç¨‹åºæ ¹æ®å®é™…éœ€è¦æ¥è®¾ç½®æœåŠ¡ç±»å‹ã€‚</p><ul><li><h6 id="16-ä½æ ‡è¯†"><a href="#16-ä½æ ‡è¯†" class="headerlink" title="16 ä½æ ‡è¯†"></a>16 ä½æ ‡è¯†</h6></li></ul><p>å”¯ä¸€æ ‡è¯†ä¸»æœºå‘é€çš„æ¯ä¸€ä¸ªæ•°æ®æŠ¥ã€‚å…¶åˆå§‹å€¼ç”±ç³»ç»Ÿéšæœºç”Ÿæˆï¼›æ¯å‘ä¸€ä¸ªæ•°æ®æŠ¥å°±åŠ  1ã€‚æ¯ä¸ªåˆ†ç‰‡ä¸­å…·æœ‰ç›¸åŒçš„æ ‡è¯†å€¼ã€‚</p><ul><li><h6 id="åˆ†ç‰‡åç§»"><a href="#åˆ†ç‰‡åç§»" class="headerlink" title="åˆ†ç‰‡åç§»"></a>åˆ†ç‰‡åç§»</h6></li></ul><p>æœ‰ 3 ä½ç”¨äºæ ‡è¯†åç§»ï¼Œç¬¬ä¸€ä½ä¿ç•™ï¼Œç¬¬äºŒä½ DF å­—æ®µï¼ˆç¦æ­¢åˆ†ç‰‡æ ‡è¯†ï¼‰ï¼Œç¬¬ä¸‰ä½ MF å­—æ®µï¼ˆæ›´å¤šåˆ†ç‰‡æ ‡è¯†ï¼Œæœ€åä¸€ä¸ªåˆ†ç‰‡ä¸º 0ï¼Œå…¶ä»–åˆ†ç‰‡ç½® 1ï¼‰ã€‚13 ä½åç§»æ˜¯å‹‡æ•¢å°†å®é™…å€¼å·¦ç§»ä¸‰ä½å¾—åˆ°çš„ï¼Œå› æ­¤è¦æ±‚æ•°æ®éƒ¨åˆ†çš„é•¿åº¦æ˜¯ 8 çš„å€æ•°ã€‚</p><ul><li><h6 id="8-ä½åè®®"><a href="#8-ä½åè®®" class="headerlink" title="8 ä½åè®®"></a>8 ä½åè®®</h6></li></ul><p>æ ‡è¯†ä¸Šå±‚åè®®ï¼Œ1 æ˜¯ ICMPï¼Œ6 æ˜¯ TCPï¼Œ17 æ˜¯ UDPã€‚</p><ul><li><h6 id="16-ä½å¤´éƒ¨æ ¡éªŒå’Œ"><a href="#16-ä½å¤´éƒ¨æ ¡éªŒå’Œ" class="headerlink" title="16 ä½å¤´éƒ¨æ ¡éªŒå’Œ"></a>16 ä½å¤´éƒ¨æ ¡éªŒå’Œ</h6></li></ul><p>IP æ¨¡å—æ¥å—æ•°æ®åï¼Œé¦–å…ˆå¯¹æ•°æ®æŠ¥å¤´éƒ¨åš CRC æ ¡éªŒï¼Œç¡®ä¿ IP å¤´éƒ¨åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ— æŸååï¼Œå†åˆ†æå…¶å¤´éƒ¨å…·ä½“ä¿¡æ¯ã€‚</p><h2 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h2><p>IPv6ï¼ˆIP version 6ï¼‰æ˜¯ä¸ºäº†æ ¹æœ¬è§£å†³ IPv4 åœ°å€è€—å°½çš„é—®é¢˜è€Œè¢«æ ‡å‡†åŒ–çš„ç½‘é™…åè®®ã€‚IPv4 çš„åœ°å€é•¿åº¦ä¸º 4 ä¸ª 8 ä½å­—èŠ‚ï¼Œå³ 32 æ¯”ç‰¹ã€‚è€Œ IPv6 çš„åœ°å€é•¿åº¦åˆ™æ˜¯åŸæ¥çš„ 4 å€ï¼Œå³ 128 æ¯”ç‰¹ï¼Œä¸€èˆ¬å†™æˆ 8 ä¸ª 16 ä½å­—èŠ‚ã€‚</p><p>IPv6 åè®®å¹¶ä¸æ˜¯ IPv4 çš„ç®€å•æ‰©å±•ï¼Œè€Œæ˜¯å®Œå…¨ç‹¬ç«‹çš„åè®®ã€‚ä»ä»¥å¤ªç½‘å¸§å°è£…çš„æ•°æ®ç±»å‹æ¥çœ‹ï¼Œå‰è€…ç±»å‹æ˜¯ 0X86ddï¼Œåè€…æ˜¯ 0x8600ï¼Œæ˜¯å®Œå…¨ä¸åŒçš„ç±»å‹ã€‚</p><p>IPv6 è§£å†³äº†ç½‘ç»œåœ°å€ä¸è¶³çš„é—®é¢˜ï¼Œå…¶å¤´éƒ¨å¢åŠ äº†å¤šæ’­å’Œæµçš„åŠŸèƒ½ï¼Œå¼•å…¥äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼Œè¿˜å¢åŠ äº†ç½‘ç»œå®‰å…¨çš„åŠŸèƒ½ã€‚</p><h3 id="IPv6-å¤´éƒ¨å›ºå®šéƒ¨åˆ†"><a href="#IPv6-å¤´éƒ¨å›ºå®šéƒ¨åˆ†" class="headerlink" title="IPv6 å¤´éƒ¨å›ºå®šéƒ¨åˆ†"></a>IPv6 å¤´éƒ¨å›ºå®šéƒ¨åˆ†</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70lv0wgqij30em05ydg6.jpg" alt="img"></p><ul><li><h6 id="æµæ ‡ç­¾"><a href="#æµæ ‡ç­¾" class="headerlink" title="æµæ ‡ç­¾"></a>æµæ ‡ç­¾</h6></li></ul><p>æ˜¯ IPv6 æ–°å¢åŠ çš„å­—æ®µï¼Œç”¨äºå¯¹æŸäº›è¿æ¥çš„æœåŠ¡è´¨é‡æœ‰ç‰¹æ®Šè¦æ±‚çš„é€šä¿¡ï¼Œæ¯”å¦‚éŸ³é¢‘æˆ–è€…è§†é¢‘ç­‰å®æ—¶æ•°æ®ä¼ é€’ã€‚</p><ul><li><h6 id="ä¸‹ä¸€ä¸ªåŒ…å¤´"><a href="#ä¸‹ä¸€ä¸ªåŒ…å¤´" class="headerlink" title="ä¸‹ä¸€ä¸ªåŒ…å¤´"></a>ä¸‹ä¸€ä¸ªåŒ…å¤´</h6></li></ul><p>æŒ‡å‡ºç´§è·Ÿ IPv6 å›ºå®šå¤´éƒ¨åçš„åŒ…å¤´ç±»å‹ï¼Œå¦‚æ‹“å±•å¤´ï¼Œæˆ–è€…æŸä¸ªä¸Šå±‚åè®®å¤´ï¼ˆICMPï¼ŒTCPï¼ŒUDPï¼‰ï¼Œå®ƒç±»ä¼¼ IPv4 ä¸­çš„åè®®å­—æ®µï¼Œä¸”ç›¸åŒçš„å–å€¼å…·æœ‰ç›¸åŒçš„å«ä¹‰ã€‚</p><h3 id="IPv6-çš„ç‰¹ç‚¹"><a href="#IPv6-çš„ç‰¹ç‚¹" class="headerlink" title="IPv6 çš„ç‰¹ç‚¹"></a>IPv6 çš„ç‰¹ç‚¹</h3><ul><li>IP å¾—çŸ¥çš„æ‰©å¤§ä¸è·¯ç”±æ§åˆ¶è¡¨çš„èšåˆã€‚</li><li>æ€§èƒ½æå‡ã€‚åŒ…é¦–éƒ¨é•¿åº¦é‡‡ç”¨å›ºå®šçš„å€¼ï¼ˆ40 å­—èŠ‚ï¼‰ï¼Œä¸å†é‡‡ç”¨é¦–éƒ¨æ£€éªŒç ã€‚ç®€åŒ–é¦–éƒ¨ç»“æ„ï¼Œå‡è½»è·¯ç”±å™¨è´Ÿæ‹…ã€‚è·¯ç”±å™¨ä¸å†åšåˆ†ç‰‡å¤„ç†ã€‚</li><li>æ”¯æŒå³æ’å³ç”¨åŠŸèƒ½ã€‚å³ä½¿æ²¡æœ‰ DHCP æœåŠ¡å™¨ä¹Ÿå¯ä»¥å®ç°è‡ªåŠ¨åˆ†é… IP åœ°å€ã€‚</li><li>é‡‡ç”¨è®¤è¯ä¸åŠ å¯†åŠŸèƒ½ã€‚åº”å¯¹ä¼ªé€  IP åœ°å€çš„ç½‘ç»œå®‰å…¨åŠŸèƒ½ä»¥åŠé˜²æ­¢çº¿è·¯çªƒå¬çš„åŠŸèƒ½ã€‚</li><li>å¤šæ’­ã€Mobile IP æˆä¸ºæ‰©å±•åŠŸèƒ½ã€‚</li></ul><h3 id="IPv6-ä¸­-IP-åœ°å€çš„æ ‡è®°æ–¹æ³•"><a href="#IPv6-ä¸­-IP-åœ°å€çš„æ ‡è®°æ–¹æ³•" class="headerlink" title="IPv6 ä¸­ IP åœ°å€çš„æ ‡è®°æ–¹æ³•"></a>IPv6 ä¸­ IP åœ°å€çš„æ ‡è®°æ–¹æ³•</h3><ul><li>ä¸€èˆ¬äººä»¬å°† 128 æ¯”ç‰¹ IP åœ°å€ä»¥æ¯ 16 æ¯”ç‰¹ä¸ºä¸€ç»„ï¼Œæ¯ç»„ç”¨å†’å·ï¼ˆâ€œï¼šâ€ï¼‰éš”å¼€è¿›è¡Œæ ‡è®°ã€‚</li><li>è€Œä¸”å¦‚æœå‡ºç°è¿ç»­çš„ 0 æ—¶è¿˜å¯ä»¥å°†è¿™äº› 0 çœç•¥ï¼Œå¹¶ç”¨ä¸¤ä¸ªå†’å·ï¼ˆâ€œï¼šï¼šâ€ï¼‰éš”å¼€ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ª IP åœ°å€ä¸­åªå…è®¸å‡ºç°ä¸€æ¬¡ä¸¤ä¸ªè¿ç»­çš„å†’å·ã€‚</li></ul><h3 id="IPv6-åœ°å€çš„ç»“æ„"><a href="#IPv6-åœ°å€çš„ç»“æ„" class="headerlink" title="IPv6 åœ°å€çš„ç»“æ„"></a>IPv6 åœ°å€çš„ç»“æ„</h3><ul><li>IPv6 ç±»ä¼¼ IPv4ï¼Œä¹Ÿæ˜¯é€šè¿‡ IP åœ°å€çš„å‰å‡ ä½æ ‡è¯† IP åœ°å€çš„ç§ç±»ã€‚</li><li>åœ¨äº’è”ç½‘é€šä¿¡ä¸­ï¼Œä½¿ç”¨ä¸€ç§å…¨å±€çš„å•æ’­åœ°å€ã€‚å®ƒæ˜¯äº’è”ç½‘ä¸­å”¯ä¸€çš„ä¸€ä¸ªåœ°å€ï¼Œä¸éœ€è¦æ­£å¼åˆ†é… IP åœ°å€ã€‚</li></ul><table><thead><tr><th>æœªå®šä¹‰</th><th>0000 â€¦ 0000ï¼ˆ128 æ¯”ç‰¹ï¼‰</th><th>ï¼šï¼š/ 128</th></tr></thead><tbody><tr><td>ç¯å›åœ°å€</td><td>0000 â€¦ 0001ï¼ˆ128 æ¯”ç‰¹ï¼‰</td><td>ï¼šï¼š1 / 128</td></tr><tr><td>å”¯ä¸€æœ¬åœ°åœ°å€</td><td>1111 110</td><td>FC00ï¼š/ 7</td></tr><tr><td>é“¾è·¯æœ¬åœ°å•æ’­åœ°å€</td><td>1111 1110 10</td><td>FE80ï¼šï¼š/ 10</td></tr><tr><td>å¤šæ’­åœ°å€</td><td>1111 1111</td><td>FF00ï¼šï¼š/ 8</td></tr><tr><td>å…¨å±€å•æ’­åœ°å€</td><td>ï¼ˆå…¶ä»–ï¼‰</td><td></td></tr></tbody></table><h3 id="å…¨å±€å•æ’­åœ°å€"><a href="#å…¨å±€å•æ’­åœ°å€" class="headerlink" title="å…¨å±€å•æ’­åœ°å€"></a>å…¨å±€å•æ’­åœ°å€</h3><ul><li>å…¨å±€å•æ’­åœ°å€æ˜¯æŒ‡ä¸–ç•Œä¸Šå”¯ä¸€çš„ä¸€ä¸ªåœ°å€ã€‚å®ƒæ˜¯äº’è”ç½‘é€šä¿¡ä»¥åŠå„ä¸ªåŸŸå†…éƒ¨é€šä¿¡ä¸­æœ€ä¸ºå¸¸ç”¨çš„ä¸€ä¸ª IPv6 åœ°å€ã€‚</li><li>æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç°åœ¨ IPv6 çš„ç½‘ç»œä¸­æ‰€ä½¿ç”¨çš„æ ¼å¼ä¸ºï¼Œn = 48ï¼Œm = 16 ä»¥åŠ 128 - n - m = 64ã€‚å³å‰ 64 æ¯”ç‰¹ä¸ºç½‘ç»œæ ‡è¯†ï¼Œå 64 æ¯”ç‰¹ä¸ºä¸»æœºæ ‡è¯†ã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70lktamkvj30lt08qmxq.jpg" alt="img"></p><h3 id="é“¾è·¯æœ¬åœ°å•æ’­åœ°å€"><a href="#é“¾è·¯æœ¬åœ°å•æ’­åœ°å€" class="headerlink" title="é“¾è·¯æœ¬åœ°å•æ’­åœ°å€"></a>é“¾è·¯æœ¬åœ°å•æ’­åœ°å€</h3><p>é“¾è·¯æœ¬åœ°å•æ’­åœ°å€æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªæ•°æ®é“¾è·¯å†…å”¯ä¸€çš„åœ°å€ã€‚å®ƒç”¨äºä¸ç»è¿‡è·¯ç”±å™¨ï¼Œåœ¨åŒä¸€ä¸ªé“¾è·¯ä¸­çš„é€šä¿¡ã€‚é€šå¸¸æ¥å£ ID ä¿å­˜ 64 æ¯”ç‰¹ç‰ˆçš„ MAC åœ°å€ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70llnrbecj30lg052weo.jpg" alt="img"></p><h3 id="å”¯ä¸€æœ¬åœ°åœ°å€"><a href="#å”¯ä¸€æœ¬åœ°åœ°å€" class="headerlink" title="å”¯ä¸€æœ¬åœ°åœ°å€"></a>å”¯ä¸€æœ¬åœ°åœ°å€</h3><ul><li>å”¯ä¸€æœ¬åœ°åœ°å€æ˜¯ä¸è¿›è¡Œäº’è”ç½‘é€šä¿¡æ—¶æ‰€ç”¨çš„åœ°å€ã€‚</li><li>å”¯ä¸€æœ¬åœ°åœ°å€è™½ç„¶ä¸ä¼šä¸äº’è”ç½‘è¿æ¥ï¼Œä½†æ˜¯ä¹Ÿä¼šå°½å¯èƒ½åœ°éšæœºç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„å…¨å±€ IDã€‚</li><li>L é€šå¸¸è¢«ç½®ä¸º 1</li><li>å…¨å±€ ID çš„å€¼éšæœºå†³å®š</li><li>å­ç½‘ ID æ˜¯æŒ‡è¯¥åŸŸå­ç½‘åœ°å€</li><li>æ¥å£ ID å³ä¸ºæ¥å£çš„ ID</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70lmkuopyj30ms053mxf.jpg" alt="img"></p><h3 id="IPv6-åˆ†æ®µå¤„ç†"><a href="#IPv6-åˆ†æ®µå¤„ç†" class="headerlink" title="IPv6 åˆ†æ®µå¤„ç†"></a>IPv6 åˆ†æ®µå¤„ç†</h3><ul><li>IPv6 çš„åˆ†ç‰‡å¤„ç†åªåœ¨ä½œä¸ºèµ·ç‚¹çš„å‘é€ç«¯ä¸»æœºä¸Šè¿›è¡Œï¼Œè·¯ç”±å™¨ä¸å‚ä¸åˆ†ç‰‡ã€‚</li><li>IPv6 ä¸­æœ€å° MTU ä¸º 1280 å­—èŠ‚ï¼Œå› æ­¤ï¼Œåœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­å¯¹äºé‚£äº›æœ‰ä¸€å®šç³»ç»Ÿèµ„æºé™åˆ¶çš„è®¾å¤‡æ¥è¯´ï¼Œä¸éœ€è¦è¿›è¡Œâ€œè·¯å¾„ MTU å‘ç°â€ï¼Œè€Œæ˜¯åœ¨å‘é€ IP åŒ…æ—¶ç›´æ¥ä»¥ 1280 å­—èŠ‚ä¸ºå•ä½åˆ†ç‰‡é€å‡ºã€‚</li></ul><h3 id="IP-é¦–éƒ¨ï¼ˆæš‚ç•¥ï¼‰"><a href="#IP-é¦–éƒ¨ï¼ˆæš‚ç•¥ï¼‰" class="headerlink" title="IP é¦–éƒ¨ï¼ˆæš‚ç•¥ï¼‰"></a>IP é¦–éƒ¨ï¼ˆæš‚ç•¥ï¼‰</h3><h2 id="IP-åè®®ç›¸å…³æŠ€æœ¯"><a href="#IP-åè®®ç›¸å…³æŠ€æœ¯" class="headerlink" title="IP åè®®ç›¸å…³æŠ€æœ¯"></a>IP åè®®ç›¸å…³æŠ€æœ¯</h2><p>IP æ—¨åœ¨è®©æœ€ç»ˆç›®æ ‡ä¸»æœºæ”¶åˆ°æ•°æ®åŒ…ï¼Œä½†æ˜¯åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ä»…ä»…æœ‰ IP æ˜¯æ— æ³•å®ç°é€šä¿¡çš„ã€‚å¿…é¡»è¿˜æœ‰èƒ½å¤Ÿè§£æä¸»æœºåç§°å’Œ MAC åœ°å€çš„åŠŸèƒ½ï¼Œä»¥åŠæ•°æ®åŒ…åœ¨å‘é€è¿‡ç¨‹ä¸­å¼‚å¸¸æƒ…å†µå¤„ç†çš„åŠŸèƒ½ã€‚</p><h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><ul><li>æˆ‘ä»¬å¹³å¸¸åœ¨è®¿é—®æŸä¸ªç½‘ç«™æ—¶ä¸é€‚ç”¨ IP åœ°å€ï¼Œè€Œæ˜¯ç”¨ä¸€ä¸²ç”±ç½—é©¬å­—å’Œç‚¹å·ç»„æˆçš„å­—ç¬¦ä¸²ã€‚è€Œä¸€èˆ¬ç”¨æˆ·åœ¨ä½¿ç”¨ TCP/IP è¿›è¡Œé€šä¿¡æ—¶ä¹Ÿä¸ä½¿ç”¨ IP åœ°å€ã€‚èƒ½å¤Ÿè¿™æ ·åšæ˜¯å› ä¸ºæœ‰äº† DNS ï¼ˆDomain Name Systemï¼‰åŠŸèƒ½çš„æ”¯æŒã€‚DNS å¯ä»¥å°†é‚£ä¸²å­—ç¬¦ä¸²è‡ªåŠ¨è½¬æ¢ä¸ºå…·ä½“çš„ IP åœ°å€ã€‚</li><li>è¿™ç§ DNS ä¸ä»…é€‚ç”¨äº IPv4ï¼Œè¿˜é€‚ç”¨äº IPv6ã€‚</li></ul><h3 id="ARP"><a href="#ARP" class="headerlink" title="ARP"></a>ARP</h3><ul><li>åªè¦ç¡®å®šäº† IP åœ°å€ï¼Œå°±å¯ä»¥å‘è¿™ä¸ªç›®æ ‡åœ°å€å‘é€ IP æ•°æ®æŠ¥ã€‚ç„¶è€Œï¼Œåœ¨åº•å±‚æ•°æ®é“¾è·¯å±‚ï¼Œè¿›è¡Œå®é™…é€šä¿¡æ—¶å´æœ‰å¿…è¦äº†è§£æ¯ä¸ª IP åœ°å€æ‰€å¯¹åº”çš„ MAC åœ°å€ã€‚</li><li>ARP æ˜¯ä¸€ç§è§£å†³åœ°å€é—®é¢˜çš„åè®®ã€‚ä»¥ç›®æ ‡ IP åœ°å€ä¸ºçº¿ç´¢ï¼Œç”¨æ¥å®šä½ä¸‹ä¸€ä¸ªåº”è¯¥æ¥æ”¶æ•°æ®åˆ†åŒ…çš„ç½‘ç»œè®¾å¤‡å¯¹åº”çš„ MAC åœ°å€ã€‚ä¸è¿‡ ARP åªé€‚ç”¨äº IPv4ï¼Œä¸èƒ½ç”¨äº IPv6ã€‚IPv6 ä¸­å¯ä»¥ç”¨ ICMPv6 æ›¿ä»£ ARP å‘é€é‚»å±…æ¢ç´¢æ¶ˆæ¯ã€‚</li><li>RARP æ˜¯å°† ARP åè¿‡æ¥ï¼Œä» MAC åœ°å€å®šä½ IP åœ°å€çš„ä¸€ç§åè®®ã€‚</li></ul><h3 id="ICMP"><a href="#ICMP" class="headerlink" title="ICMP"></a>ICMP</h3><ul><li>ICMP çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼Œç¡®è®¤ IP åŒ…æ˜¯å¦æˆåŠŸé€è¾¾ç›®æ ‡åœ°å€ï¼Œé€šçŸ¥åœ¨å‘é€è¿‡ç¨‹å½“ä¸­ IP åŒ…è¢«åºŸå¼ƒçš„å…·ä½“åŸå› ï¼Œæ”¹å–„ç½‘ç»œè®¾ç½®ç­‰ã€‚</li><li>IPv4 ä¸­ ICMP ä»…ä½œä¸ºä¸€ä¸ªè¾…åŠ©ä½œç”¨æ”¯æŒ IPv4ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ IPv4 æ—¶æœŸï¼Œå³ä½¿æ²¡æœ‰ ICMPï¼Œä»ç„¶å¯ä»¥å®ç° IP é€šä¿¡ã€‚ç„¶è€Œï¼Œåœ¨ IPv6 ä¸­ï¼ŒICMP çš„ä½œç”¨è¢«æ‰©å¤§ï¼Œå¦‚æœæ²¡æœ‰ ICMPv6ï¼ŒIPv6 å°±æ— æ³•è¿›è¡Œæ­£å¸¸é€šä¿¡ã€‚</li></ul><h3 id="DHCP"><a href="#DHCP" class="headerlink" title="DHCP"></a>DHCP</h3><ul><li>å¦‚æœé€ä¸€ä¸ºæ¯ä¸€å°ä¸»æœºè®¾ç½® IP åœ°å€ä¼šæ˜¯éå¸¸ç¹ççš„äº‹æƒ…ã€‚ç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ä½¿ç”¨ç¬”è®°æœ¬ç”µè„‘ã€åªèƒ½ç»ˆç«¯ä»¥åŠå¹³æ¿ç”µè„‘ç­‰è®¾å¤‡æ—¶ï¼Œæ¯ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„åœ°æ–¹ï¼Œéƒ½è¦é‡æ–°è®¾ç½® IP åœ°å€ã€‚</li><li>äºæ˜¯ï¼Œä¸ºäº†å®ç°è‡ªåŠ¨è®¾ç½® IP åœ°å€ã€ç»Ÿä¸€ç®¡ç† IP åœ°å€åˆ†é…ï¼Œå°±äº§ç”Ÿäº† DHCPï¼ˆDynamic Host Configuration Protocolï¼‰åè®®ã€‚æœ‰äº† DHCPï¼Œè®¡ç®—æœºåªè¦è¿æ¥åˆ°ç½‘ç»œï¼Œå°±å¯ä»¥è¿›è¡Œ TCP/IP é€šä¿¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒDHCP è®©å³æ’å³ç”¨å˜å¾—å¯èƒ½ã€‚</li><li>DHCP ä¸ä»…åœ¨ IPv4 ä¸­ï¼Œåœ¨ IPv6 ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</li></ul><h3 id="NAT"><a href="#NAT" class="headerlink" title="NAT"></a>NAT</h3><ul><li>NATï¼ˆNetwork Address Translatorï¼‰æ˜¯ç”¨äºåœ¨æœ¬åœ°ç½‘ç»œä¸­ä½¿ç”¨ç§æœ‰åœ°å€ï¼Œåœ¨è¿æ¥äº’è”ç½‘æ—¶è½¬è€Œä½¿ç”¨å…¨å±€ IP åœ°å€çš„æŠ€æœ¯ã€‚</li><li>é™¤è½¬æ¢ IP åœ°å€å¤–ï¼Œè¿˜å‡ºç°äº†å¯ä»¥è½¬æ¢ TCPã€UDP ç«¯å£å·çš„ NAPTï¼ˆNetwork Address Ports Translatorï¼‰æŠ€æœ¯ï¼Œç”±æ­¤å¯ä»¥å®ç°ç”¨ä¸€ä¸ªå…¨å±€ IP åœ°å€ä¸å¤šä¸ªä¸»æœºçš„é€šä¿¡ã€‚</li><li>NATï¼ˆNAPTï¼‰å®é™…ä¸Šæ˜¯ä¸ºæ­£åœ¨é¢ä¸´åœ°å€æ¯ç«­çš„ IPv4 è€Œå¼€å‘çš„æŠ€æœ¯ã€‚ä¸è¿‡ï¼Œåœ¨ IPv6 ä¸­ä¸ºäº†æé«˜ç½‘ç»œå®‰å…¨ä¹Ÿåœ¨ä½¿ç”¨ NATï¼Œåœ¨ IPv4 å’Œ IPv6 ä¹‹é—´çš„ç›¸äº’é€šä¿¡å½“ä¸­å¸¸å¸¸ä½¿ç”¨ NAT-PTã€‚</li></ul><h3 id="IP-éš§é“"><a href="#IP-éš§é“" class="headerlink" title="IP éš§é“"></a>IP éš§é“</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g70lqkzre9j30ht04caaa.jpg" alt="img"></p><ul><li>å¦‚ä¸Šå›¾çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œç½‘ç»œ A ä¸ç½‘ç»œ B ä¹‹é—´æ— æ³•ç›´æ¥è¿›è¡Œé€šä¿¡ï¼Œä¸ºäº†è®©å®ƒä»¬ä¹‹é—´æ­£å¸¸é€šä¿¡ï¼Œè¿™æ—¶å¿…é¡»å¾—é‡‡ç”¨ IP éš§é“çš„åŠŸèƒ½ã€‚</li><li>IP éš§é“å¯ä»¥å°†é‚£äº›ä»ç½‘ç»œ A å‘è¿‡æ¥çš„ IPv6 çš„åŒ…ç»Ÿåˆä¸ºä¸€ä¸ªæ•°æ®ï¼Œå†ä¸ºä¹‹è¿½åŠ ä¸€ä¸ª IPv4 çš„é¦–éƒ¨ä»¥åè½¬å‘ç»™ç½‘ç»œ Cã€‚</li><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç´§æ¥ç€ IP é¦–éƒ¨çš„æ˜¯ TCP æˆ– UDP çš„é¦–éƒ¨ã€‚ç„¶è€Œï¼Œç°åœ¨çš„åº”ç”¨å½“ä¸­â€œ IP é¦–éƒ¨çš„åé¢è¿˜æ˜¯ IP é¦–éƒ¨â€æˆ–è€…â€œ IP é¦–éƒ¨çš„åé¢æ˜¯ IPv6 çš„é¦–éƒ¨â€ç­‰æƒ…å†µä¸æ—¥ä¿±å¢ã€‚è¿™ç§åœ¨ç½‘ç»œå±‚çš„é¦–éƒ¨åé¢è¿½åŠ ç½‘ç»œå±‚é¦–éƒ¨çš„é€šä¿¡æ–¹æ³•å°±å«åšâ€œ IP éš§é“â€ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;IP&quot;&gt;&lt;a href=&quot;#IP&quot; class=&quot;headerlink&quot; title=&quot;IP&quot;&gt;&lt;/a&gt;IP&lt;/h1&gt;&lt;p&gt;IPï¼ˆIPv4ã€IPv6ï¼‰ç›¸å½“äº OSI å‚è€ƒæ¨¡å‹ä¸­çš„ç¬¬ 3 å±‚â€”â€”ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚çš„ä¸»è¦ä½œç”¨æ˜¯â€œ&lt;strong&gt;å®ç°ç»ˆç«¯èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡&lt;/s
      
    
    </summary>
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
      <category term="TCP/IP" scheme="http://yoursite.com/tags/TCP-IP/"/>
    
  </entry>
  
  <entry>
    <title>Http/1.0çš„Keep-Aliveå’ŒHttp/2.0çš„å¤šè·¯å¤ç”¨å¯¹æ¯”</title>
    <link href="http://yoursite.com/2019/10/04/Http1.0%E7%9A%84Keep-Alive%E5%92%8CHttp2.0%E7%9A%84%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E5%AF%B9%E6%AF%94%20copy/"/>
    <id>http://yoursite.com/2019/10/04/Http1.0çš„Keep-Aliveå’ŒHttp2.0çš„å¤šè·¯å¤ç”¨å¯¹æ¯” copy/</id>
    <published>2019-10-04T08:14:38.000Z</published>
    <updated>2019-11-10T14:37:39.018Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Http-1-0-çš„-Keep-Alive-å’Œ-Http-2-0-çš„å¤šè·¯å¤ç”¨å¯¹æ¯”"><a href="#Http-1-0-çš„-Keep-Alive-å’Œ-Http-2-0-çš„å¤šè·¯å¤ç”¨å¯¹æ¯”" class="headerlink" title="Http/1.0 çš„ Keep-Alive å’Œ Http/2.0 çš„å¤šè·¯å¤ç”¨å¯¹æ¯”"></a>Http/1.0 çš„ Keep-Alive å’Œ Http/2.0 çš„å¤šè·¯å¤ç”¨å¯¹æ¯”</h1><h2 id="Http-1-0-çš„-Keep-Alive"><a href="#Http-1-0-çš„-Keep-Alive" class="headerlink" title="Http/1.0 çš„ Keep-Alive"></a>Http/1.0 çš„ Keep-Alive</h2><p>åœ¨æ²¡æœ‰<code>Keep-Alive</code>å‰ï¼Œæˆ‘ä»¬ä¸æœåŠ¡å™¨è¯·æ±‚æ•°æ®çš„æµç¨‹æ˜¯è¿™æ ·ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6nsz9l0hxj30ac0caq3x.jpg" alt="clipboard.png"></p><ul><li>æµè§ˆå™¨è¯·æ±‚<code>//static.mtime.cn/a.js</code>â€“&gt;è§£æåŸŸåâ€“&gt;HTTP è¿æ¥â€“&gt;æœåŠ¡å™¨å¤„ç†æ–‡ä»¶â€“&gt;è¿”å›æ•°æ®â€“&gt;æµè§ˆå™¨è§£æã€æ¸²æŸ“æ–‡ä»¶</li><li>æµè§ˆå™¨è¯·æ±‚<code>//static.mtime.cn/b.js</code>â€“&gt;è§£æåŸŸåâ€“&gt;HTTP è¿æ¥â€“&gt;æœåŠ¡å™¨å¤„ç†æ–‡ä»¶â€“&gt;è¿”å›æ•°æ®â€“&gt;æµè§ˆå™¨è§£æã€æ¸²æŸ“æ–‡ä»¶</li><li>â€¦</li><li>è¿™æ ·å¾ªç¯ä¸‹å»ï¼Œç›´è‡³å…¨éƒ¨æ–‡ä»¶ä¸‹è½½å®Œæˆã€‚</li></ul><p>è¿™ä¸ªæµç¨‹æœ€å¤§çš„é—®é¢˜å°±æ˜¯ï¼š<strong>æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå»ºç«‹ä¸€æ¬¡ HTTP è¿æ¥</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ 3 æ¬¡æ¡æ‰‹ 4 æ¬¡æŒ¥æ‰‹ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨ä¸€æ¬¡è¯·æ±‚è¿‡ç¨‹ä¸­å ç”¨äº†ç›¸å½“é•¿çš„æ—¶é—´ï¼Œè€Œä¸”é€»è¾‘ä¸Šæ˜¯éå¿…éœ€çš„ï¼Œå› ä¸ºä¸é—´æ–­çš„è¯·æ±‚æ•°æ®ï¼Œç¬¬ä¸€æ¬¡å»ºç«‹è¿æ¥æ˜¯æ­£å¸¸çš„ï¼Œä»¥åå°±å ç”¨è¿™ä¸ªé€šé“ï¼Œä¸‹è½½å…¶ä»–æ–‡ä»¶ï¼Œè¿™æ ·æ•ˆç‡å¤šé«˜å•Šï¼ä½ çŒœå¯¹äº†ï¼Œè¿™å°±æ˜¯<code>Keep-Alive</code>ã€‚</p><h3 id="Keep-Aliveè§£å†³çš„é—®é¢˜"><a href="#Keep-Aliveè§£å†³çš„é—®é¢˜" class="headerlink" title="Keep-Aliveè§£å†³çš„é—®é¢˜"></a><code>Keep-Alive</code>è§£å†³çš„é—®é¢˜</h3><p><code>Keep-Alive</code>è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼šä¸€å®šæ—¶é—´å†…ï¼ŒåŒä¸€åŸŸåå¤šæ¬¡è¯·æ±‚æ•°æ®ï¼Œåªå»ºç«‹ä¸€æ¬¡ HTTP è¯·æ±‚ï¼Œå…¶ä»–è¯·æ±‚å¯å¤ç”¨æ¯ä¸€æ¬¡å»ºç«‹çš„è¿æ¥é€šé“ï¼Œä»¥è¾¾åˆ°æé«˜è¯·æ±‚æ•ˆç‡çš„é—®é¢˜ã€‚è¿™é‡Œé¢æ‰€è¯´çš„<strong>ä¸€å®šæ—¶é—´</strong>æ˜¯å¯ä»¥é…ç½®çš„ï¼Œä¸ç®¡ä½ ç”¨çš„æ˜¯<code>Apache</code>è¿˜æ˜¯<code>nginx</code>ã€‚</p><h3 id="HTTP1-1è¿˜æ˜¯å­˜åœ¨æ•ˆç‡é—®é¢˜"><a href="#HTTP1-1è¿˜æ˜¯å­˜åœ¨æ•ˆç‡é—®é¢˜" class="headerlink" title="HTTP1.1è¿˜æ˜¯å­˜åœ¨æ•ˆç‡é—®é¢˜"></a><code>HTTP1.1</code>è¿˜æ˜¯å­˜åœ¨æ•ˆç‡é—®é¢˜</h3><p>å¦‚ä¸Šé¢æ‰€è¯´ï¼Œåœ¨<code>HTTP1.1</code>ä¸­æ˜¯é»˜è®¤å¼€å¯äº†<code>Keep-Alive</code>ï¼Œä»–è§£å†³äº†å¤šæ¬¡è¿æ¥çš„é—®é¢˜ï¼Œä½†æ˜¯ä¾ç„¶æœ‰ä¸¤ä¸ªæ•ˆç‡ä¸Šçš„é—®é¢˜ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªï¼š<strong>ä¸²è¡Œçš„æ–‡ä»¶ä¼ è¾“</strong>ã€‚å½“è¯·æ±‚ a æ–‡ä»¶æ—¶ï¼Œb æ–‡ä»¶åªèƒ½ç­‰å¾…ï¼Œç­‰å¾… a è¿æ¥åˆ°æœåŠ¡å™¨ã€æœåŠ¡å™¨å¤„ç†æ–‡ä»¶ã€æœåŠ¡å™¨è¿”å›æ–‡ä»¶ï¼Œè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚æˆ‘ä»¬å‡è®¾è¿™ä¸‰æ­¥ç”¨æ—¶éƒ½æ˜¯ 1 ç§’ï¼Œé‚£ä¹ˆ a æ–‡ä»¶ç”¨æ—¶ä¸º 3 ç§’ï¼Œb æ–‡ä»¶ä¼ è¾“å®Œæˆç”¨æ—¶ä¸º 6 ç§’ï¼Œä¾æ­¤ç±»æ¨ã€‚ï¼ˆæ³¨ï¼šæ­¤é¡¹è®¡ç®—æœ‰ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œå°±æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨æ˜¯å•é€šé“ä¼ è¾“ï¼‰</li><li>ç¬¬äºŒä¸ªï¼š<strong>è¿æ¥æ•°è¿‡å¤š</strong>ã€‚æˆ‘ä»¬å‡è®¾<code>Apache</code>è®¾ç½®äº†æœ€å¤§å¹¶å‘æ•°ä¸º 300ï¼Œå› ä¸ºæµè§ˆå™¨é™åˆ¶ï¼Œæµè§ˆå™¨å‘èµ·çš„æœ€å¤§è¯·æ±‚æ•°ä¸º 6ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨èƒ½æ‰¿è½½çš„æœ€é«˜å¹¶å‘ä¸º 50ï¼Œå½“ç¬¬ 51 ä¸ªäººè®¿é—®æ—¶ï¼Œå°±éœ€è¦ç­‰å¾…å‰é¢æŸä¸ªè¯·æ±‚å¤„ç†å®Œæˆã€‚</li></ul><h2 id="HTTP-2-çš„å¤šè·¯å¤ç”¨"><a href="#HTTP-2-çš„å¤šè·¯å¤ç”¨" class="headerlink" title="HTTP/2 çš„å¤šè·¯å¤ç”¨"></a>HTTP/2 çš„å¤šè·¯å¤ç”¨</h2><p>HTTP/2 çš„å¤šè·¯å¤ç”¨å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°çš„ä¸¤ä¸ªæ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œä»–æ˜¯å¦‚ä½•è§£å†³çš„ã€‚</p><ul><li>è§£å†³ç¬¬ä¸€ä¸ªï¼šåœ¨<code>HTTP1.1</code>çš„åè®®ä¸­ï¼Œæˆ‘ä»¬ä¼ è¾“çš„<code>request</code>å’Œ<code>response</code>éƒ½æ˜¯åŸºæœ¬äºæ–‡æœ¬çš„ï¼Œè¿™æ ·å°±ä¼šå¼•å‘ä¸€ä¸ªé—®é¢˜ï¼šæ‰€æœ‰çš„æ•°æ®å¿…é¡»æŒ‰é¡ºåºä¼ è¾“ï¼Œæ¯”å¦‚éœ€è¦ä¼ è¾“ï¼š<code>hello world</code>ï¼Œåªèƒ½ä»<code>h</code>åˆ°<code>d</code>ä¸€ä¸ªä¸€ä¸ªçš„ä¼ è¾“ï¼Œä¸èƒ½å¹¶è¡Œä¼ è¾“ï¼Œå› ä¸ºæ¥æ”¶ç«¯å¹¶ä¸çŸ¥é“è¿™äº›å­—ç¬¦çš„é¡ºåºï¼Œæ‰€ä»¥å¹¶è¡Œä¼ è¾“åœ¨<code>HTTP1.1</code>æ˜¯ä¸èƒ½å®ç°çš„ã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6nszfhktpj30kp05lmxt.jpg" alt="clipboard.png"></p><p><code>HTTP/2</code>å¼•å…¥<code>äºŒè¿›åˆ¶æ•°æ®å¸§</code>å’Œ<code>æµ</code>çš„æ¦‚å¿µï¼Œå…¶ä¸­å¸§å¯¹æ•°æ®è¿›è¡Œé¡ºåºæ ‡è¯†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ ·æµè§ˆå™¨æ”¶åˆ°æ•°æ®ä¹‹åï¼Œå°±å¯ä»¥æŒ‰ç…§åºåˆ—å¯¹æ•°æ®è¿›è¡Œåˆå¹¶ï¼Œè€Œä¸ä¼šå‡ºç°åˆå¹¶åæ•°æ®é”™ä¹±çš„æƒ…å†µã€‚åŒæ ·æ˜¯å› ä¸ºæœ‰äº†åºåˆ—ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥å¹¶è¡Œçš„ä¼ è¾“æ•°æ®ï¼Œè¿™å°±æ˜¯<code>æµ</code>æ‰€åšçš„äº‹æƒ…ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6nszichcoj30fm0aft9y.jpg" alt="clipboard.png"></p><ul><li>è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼š<code>HTTP/2</code>å¯¹åŒä¸€åŸŸåä¸‹æ‰€æœ‰è¯·æ±‚éƒ½æ˜¯åŸºäº<code>æµ</code>ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€åŸŸåä¸ç®¡è®¿é—®å¤šå°‘æ–‡ä»¶ï¼Œä¹Ÿåª<strong>å»ºç«‹ä¸€è·¯è¿æ¥</strong>ã€‚åŒæ ·<code>Apache</code>çš„æœ€å¤§è¿æ¥æ•°ä¸º 300ï¼Œå› ä¸ºæœ‰äº†è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œæœ€å¤§çš„å¹¶å‘å°±å¯ä»¥æå‡åˆ° 300ï¼Œæ¯”åŸæ¥æå‡äº† 6 å€ï¼</li></ul><h2 id="å¤šè·¯å¤ç”¨å’Œ-keep-alive-åŒºåˆ«ï¼Ÿ"><a href="#å¤šè·¯å¤ç”¨å’Œ-keep-alive-åŒºåˆ«ï¼Ÿ" class="headerlink" title="å¤šè·¯å¤ç”¨å’Œ keep alive åŒºåˆ«ï¼Ÿ"></a><strong>å¤šè·¯å¤ç”¨å’Œ keep alive åŒºåˆ«ï¼Ÿ</strong></h2><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6nt1pb7xkj30ln0l940f.jpg" alt="img"></p><p>1ï¼‰çº¿å¤´é˜»å¡ï¼ˆHead-of-Line Blockingï¼‰ï¼ŒHTTP1.X è™½ç„¶å¯ä»¥é‡‡ç”¨ keep alive æ¥è§£å†³å¤ç”¨ TCP çš„é—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•è§£å†³è¯·æ±‚é˜»å¡é—®é¢˜ã€‚</p><p>2ï¼‰æ‰€è°“è¯·æ±‚é˜»å¡æ„æ€å°±æ˜¯ä¸€æ¡ TCP çš„ connection åœ¨åŒä¸€æ—¶é—´åªèƒ½å…è®¸ä¸€ä¸ªè¯·æ±‚ç»è¿‡ï¼Œè¿™æ ·å‡å¦‚åç»­è¯·æ±‚æƒ³è¦å¤ç”¨è¿™ä¸ªé“¾æ¥å°±å¿…é¡»ç­‰åˆ°å‰ä¸€ä¸ªå®Œæˆæ‰è¡Œï¼Œæ­£å¦‚ä¸Šå›¾å·¦è¾¹è¡¨ç¤ºçš„ã€‚</p><p>3ï¼‰ä¹‹æ‰€ä»¥æœ‰è¿™ä¸ªé—®é¢˜å°±æ˜¯å› ä¸º HTTP1.x éœ€è¦æ¯æ¡è¯·æ±‚éƒ½æ˜¯å¯æ˜¯è¯†åˆ«ï¼ŒæŒ‰é¡ºåºå‘é€ï¼Œå¦åˆ™ server å°±æ— æ³•åˆ¤æ–­è¯¥ç›¸åº”å“ªä¸ªå…·ä½“çš„è¯·æ±‚ã€‚</p><p>4ï¼‰HTTP2 é‡‡ç”¨å¤šè·¯å¤ç”¨æ˜¯æŒ‡ï¼Œåœ¨åŒä¸€ä¸ªåŸŸåä¸‹ï¼Œå¼€å¯ä¸€ä¸ª TCP çš„ connectionï¼Œæ¯ä¸ªè¯·æ±‚ä»¥ stream çš„æ–¹å¼ä¼ è¾“ï¼Œæ¯ä¸ª stream æœ‰å”¯ä¸€æ ‡è¯†ï¼Œconnection ä¸€æ—¦å»ºç«‹ï¼Œåç»­çš„è¯·æ±‚éƒ½å¯ä»¥å¤ç”¨è¿™ä¸ª connection å¹¶ä¸”å¯ä»¥åŒæ—¶å‘é€ï¼Œserver ç«¯å¯ä»¥æ ¹æ® stream çš„å”¯ä¸€æ ‡è¯†æ¥ç›¸åº”å¯¹åº”çš„è¯·æ±‚ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Http-1-0-çš„-Keep-Alive-å’Œ-Http-2-0-çš„å¤šè·¯å¤ç”¨å¯¹æ¯”&quot;&gt;&lt;a href=&quot;#Http-1-0-çš„-Keep-Alive-å’Œ-Http-2-0-çš„å¤šè·¯å¤ç”¨å¯¹æ¯”&quot; class=&quot;headerlink&quot; title=&quot;Http/1.0 çš„ K
      
    
    </summary>
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
    
      <category term="HTTP" scheme="http://yoursite.com/tags/HTTP/"/>
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>CSS æ¸…é™¤æµ®åŠ¨</title>
    <link href="http://yoursite.com/2019/09/29/CSS%20%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8/"/>
    <id>http://yoursite.com/2019/09/29/CSS æ¸…é™¤æµ®åŠ¨/</id>
    <published>2019-09-29T07:26:33.000Z</published>
    <updated>2019-11-10T14:37:39.013Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CSS-æ¸…é™¤æµ®åŠ¨"><a href="#CSS-æ¸…é™¤æµ®åŠ¨" class="headerlink" title="CSS æ¸…é™¤æµ®åŠ¨"></a>CSS æ¸…é™¤æµ®åŠ¨</h1><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6tbm9sca0j30op0fh0tp.jpg" alt="img"></p><h2 id="æµ®åŠ¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æµ®åŠ¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æµ®åŠ¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>æµ®åŠ¨æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>W3school ä¸­ç»™å‡ºçš„æµ®åŠ¨å®šä¹‰ä¸º<strong>æµ®åŠ¨çš„æ¡†å¯ä»¥å‘å·¦æˆ–å‘å³ç§»åŠ¨ï¼Œç›´åˆ°å®ƒçš„å¤–è¾¹ç¼˜ç¢°åˆ°åŒ…å«æ¡†æˆ–å¦ä¸€ä¸ªæµ®åŠ¨æ¡†çš„è¾¹æ¡†ä¸ºæ­¢ã€‚</strong>ç”±äºæµ®åŠ¨æ¡†è„±ç¦»æ–‡æ¡£çš„æ™®é€šæµä¸­ï¼Œæ‰€ä»¥æ–‡æ¡£çš„æ™®é€šæµä¸­çš„å—æ¡†è¡¨ç°å¾—å°±åƒæµ®åŠ¨æ¡†ä¸å­˜åœ¨ä¸€æ ·ã€‚</p><h2 id="æµ®åŠ¨çš„ç‰¹ç‚¹"><a href="#æµ®åŠ¨çš„ç‰¹ç‚¹" class="headerlink" title="æµ®åŠ¨çš„ç‰¹ç‚¹"></a>æµ®åŠ¨çš„ç‰¹ç‚¹</h2><p>æµ®åŠ¨çš„ç‰¹ç‚¹ï¼Œå¯ä»¥ç”¨å…«ä¸ªå­—æ€»ç»“ï¼š<strong>è„±æ ‡ã€è´´è¾¹ã€å­—å›´å’Œæ”¶ç¼©ã€‚</strong></p><p>ä¸ºäº†æ›´å¥½è¯´æ˜ï¼Œè¯·çœ‹ä¸‹å›¾ï¼š<br>å½“æ¡† 1 å‘å·¦æµ®åŠ¨æ—¶ï¼Œå®ƒè„±ç¦»æ–‡æ¡£æµï¼ˆ<strong>è„±æ ‡</strong>ï¼‰å¹¶ä¸”å‘å·¦ç§»åŠ¨ï¼ˆ<strong>è´´è¾¹</strong>ï¼‰ï¼Œç›´åˆ°å®ƒçš„å·¦è¾¹ç¼˜ç¢°åˆ°åŒ…å«æ¡†çš„å·¦è¾¹ç¼˜ã€‚å› ä¸ºå®ƒä¸å†å¤„äºæ–‡æ¡£æµä¸­ï¼Œæ‰€ä»¥å®ƒä¸å æ®ç©ºé—´ï¼Œå®é™…ä¸Šè¦†ç›–ä½äº†æ¡† 2ï¼Œä½¿æ¡† 2 ä»è§†å›¾ä¸­æ¶ˆå¤±ã€‚å¦‚æœæ¡† 2 ä¸­æœ‰æ–‡å­—ï¼Œå°±ä¼šå›´ç€æ¡† 1 æ’å¼€ï¼ˆ<strong>å­—å›´</strong>ï¼‰ã€‚</p><p>å¦‚æœæŠŠæ‰€æœ‰ä¸‰ä¸ªæ¡†éƒ½å‘å·¦æµ®åŠ¨ï¼Œé‚£ä¹ˆæ¡† 1 å‘å·¦æµ®åŠ¨ç›´åˆ°ç¢°åˆ°åŒ…å«æ¡†ï¼Œå¦å¤–ä¸¤ä¸ªæ¡†å‘å·¦æµ®åŠ¨ç›´åˆ°ç¢°åˆ°å‰ä¸€ä¸ªæµ®åŠ¨æ¡†ã€‚<br><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6tc3n56n2j30em06haa4.jpg" alt="img"><br>ä¸‹é¢ç€é‡è®²è§£ä¸‹ç¬¬å››ä¸ªç‰¹ç‚¹â€“<strong>æ”¶ç¼©</strong></p><p>ä¸€ä¸ªæµ®åŠ¨çš„å†…è”å…ƒç´ ï¼ˆæ¯”å¦‚ span img æ ‡ç­¾ï¼‰ä¸éœ€è¦è®¾ç½® displayï¼šblock å°±å¯ä»¥è®¾ç½®å®½åº¦ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    div &#123;</span><br><span class="line">      float: left;</span><br><span class="line">      background-color: greenyellow;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    è¿™æ˜¯ä¸€æ®µæ–‡å­—</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä»¥ä¸‹çš„æ•ˆæœï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6tc6sc8yzj30qo01ft8h.jpg" alt="img"><br>æˆ‘ä»¬éƒ½çŸ¥é“ div æ ‡ç­¾æ˜¯å—çº§å…ƒç´ ï¼Œä¼šç‹¬å ä¸€è¡Œï¼Œç„¶è€Œä¸Šé¢çš„ä¾‹å­ä¸­å°† div è®¾ç½®ä¸ºå·¦æµ®åï¼Œå…¶å®½åº¦ä¸å†æ˜¯å æ»¡ä¸€è¡Œï¼Œè€Œæ˜¯æ”¶ç´§ä¸ºå†…éƒ¨å…ƒç´ çš„å®½åº¦ï¼Œè¿™å°±æ˜¯æµ®åŠ¨ç¬¬å››ä¸ªç‰¹å¾çš„å«ä¹‰ã€‚</p><h2 id="æµ®åŠ¨çš„ç¼ºç‚¹"><a href="#æµ®åŠ¨çš„ç¼ºç‚¹" class="headerlink" title="æµ®åŠ¨çš„ç¼ºç‚¹"></a>æµ®åŠ¨çš„ç¼ºç‚¹</h2><p>å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.parent</span> &#123;</span></span><br><span class="line">      border: solid 5px;</span><br><span class="line">      width: 300px;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.child</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span></span><br><span class="line">      height: 100px;</span><br><span class="line">      width: 100px;</span><br><span class="line">      background-color: yellow;</span><br><span class="line">      float: left;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.child</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span></span><br><span class="line">      height: 100px;</span><br><span class="line">      width: 100px;</span><br><span class="line">      background-color: red;</span><br><span class="line">      float: left;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.child</span><span class="selector-pseudo">:nth-child(3)</span> &#123;</span></span><br><span class="line">      height: 100px;</span><br><span class="line">      width: 100px;</span><br><span class="line">      background-color: greenyellow;</span><br><span class="line">      float: left;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"child"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æƒ³è®©çˆ¶å®¹å™¨åŒ…è£¹ç€ä¸‰ä¸ªæµ®åŠ¨å…ƒç´ ï¼Œç„¶è€Œäº‹ä¸æ„¿è¿ï¼Œå¾—åˆ°å´æ˜¯è¿™æ ·çš„ç»“æœï¼š<br><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6tcc3apdwj30920393yb.jpg" alt="img"><br><strong>è¿™å°±æ˜¯æµ®åŠ¨å¸¦æ¥å‰¯ä½œç”¨â€”-çˆ¶å®¹å™¨é«˜åº¦å¡Œé™·ï¼Œäºæ˜¯æ¸…ç†æµ®åŠ¨å°±æ˜¾ç€è‡³å…³é‡è¦ã€‚</strong></p><h2 id="æ¸…ç†æµ®åŠ¨"><a href="#æ¸…ç†æµ®åŠ¨" class="headerlink" title="æ¸…ç†æµ®åŠ¨"></a>æ¸…ç†æµ®åŠ¨</h2><p><strong>æ¸…é™¤æµ®åŠ¨ä¸æ˜¯ä¸ç”¨æµ®åŠ¨ï¼Œæ˜¯æ¸…é™¤æµ®åŠ¨äº§ç”Ÿçš„çˆ¶å®¹å™¨é«˜åº¦å¡Œé™·</strong>ã€‚</p><h3 id="å¥—è·¯-1ï¼šç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ æ·»åŠ é«˜åº¦ï¼ˆæ‰©å±•æ€§ä¸å¥½ï¼‰"><a href="#å¥—è·¯-1ï¼šç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ æ·»åŠ é«˜åº¦ï¼ˆæ‰©å±•æ€§ä¸å¥½ï¼‰" class="headerlink" title="å¥—è·¯ 1ï¼šç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ æ·»åŠ é«˜åº¦ï¼ˆæ‰©å±•æ€§ä¸å¥½ï¼‰"></a>å¥—è·¯ 1ï¼šç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ æ·»åŠ é«˜åº¦ï¼ˆæ‰©å±•æ€§ä¸å¥½ï¼‰</h3><p>å¦‚æœä¸€ä¸ªå…ƒç´ è¦æµ®åŠ¨ï¼Œé‚£ä¹ˆå®ƒçš„çˆ¶å…ƒç´ ä¸€å®šè¦æœ‰é«˜åº¦ã€‚é«˜åº¦çš„ç›’å­ï¼Œæ‰èƒ½å…³ä½æµ®åŠ¨ã€‚å¯ä»¥é€šè¿‡ç›´æ¥ç»™çˆ¶å…ƒç´ è®¾ç½® heightï¼Œå®é™…åº”ç”¨ä¸­æˆ‘ä»¬ä¸å¤§å¯èƒ½ç»™æ‰€æœ‰çš„ç›’å­åŠ é«˜åº¦ï¼Œä¸ä»…éº»çƒ¦ï¼Œå¹¶ä¸”ä¸èƒ½é€‚åº”é¡µé¢çš„å¿«é€Ÿå˜åŒ–ï¼›å¦å¤–ä¸€ç§ï¼Œçˆ¶å®¹å™¨çš„é«˜åº¦å¯ä»¥é€šè¿‡å†…å®¹æ’‘å¼€ï¼ˆæ¯”å¦‚ img å›¾ç‰‡ï¼‰ï¼Œå®é™…å½“ä¸­æ­¤æ–¹æ³•ç”¨çš„æ¯”è¾ƒå¤šã€‚</p><h3 id="å¥—è·¯-2ï¼šclear-both"><a href="#å¥—è·¯-2ï¼šclear-both" class="headerlink" title="å¥—è·¯ 2ï¼šclear:both;"></a>å¥—è·¯ 2ï¼šclear:both;</h3><p>åœ¨æœ€åä¸€ä¸ªå­å…ƒç´ åæ–°æ·»åŠ ä¸€ä¸ªå†—ä½™å…ƒç´ ï¼Œç„¶åå°†å…¶è®¾ç½® clear:both,è¿™æ ·å°±å¯ä»¥æ¸…é™¤æµ®åŠ¨ã€‚è¿™é‡Œå¼ºè°ƒä¸€ç‚¹ï¼Œå³<strong>åœ¨çˆ¶çº§å…ƒç´ æœ«å°¾æ·»åŠ çš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå—çº§å…ƒç´ ï¼Œå¦åˆ™æ— æ³•æ’‘èµ·çˆ¶çº§å…ƒç´ é«˜åº¦</strong>ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"clear: both;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#inner</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¥—è·¯-3ï¼šä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨"><a href="#å¥—è·¯-3ï¼šä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨" class="headerlink" title="å¥—è·¯ 3ï¼šä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨"></a>å¥—è·¯ 3ï¼šä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨</h3><p>ä¸Šé¢é‚£ç§åŠæ³•å›ºç„¶å¯ä»¥æ¸…é™¤æµ®åŠ¨ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³åœ¨é¡µé¢ä¸­æ·»åŠ è¿™äº›æ²¡æœ‰æ„ä¹‰çš„å†—ä½™å…ƒç´ ï¼Œæ­¤æ—¶å¦‚ä½•æ¸…é™¤æµ®åŠ¨å—ï¼Ÿ<br><strong>ç»“åˆ :after ä¼ªå…ƒç´ å’Œ IEhack ï¼Œå¯ä»¥å®Œç¾å…¼å®¹å½“å‰ä¸»æµçš„å„å¤§æµè§ˆå™¨ï¼Œè¿™é‡Œçš„ IEhack æŒ‡çš„æ˜¯è§¦å‘ hasLayout</strong>ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrap"</span> <span class="attr">class</span>=<span class="string">"clearfix"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#inner</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*å¼€å¯haslayout*/</span></span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">  *zoom: 1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*ie6 7ä¸æ”¯æŒä¼ªå…ƒç´ */</span></span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">0</span>;</span><br><span class="line">  visibility: hidden; //å…è®¸æµè§ˆå™¨æ¸²æŸ“å®ƒï¼Œä½†æ˜¯ä¸æ˜¾ç¤ºå‡ºæ¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å®¹å™¨æ·»åŠ ä¸€ä¸ª clearfix çš„ classï¼Œç„¶åç»™è¿™ä¸ª class æ·»åŠ ä¸€ä¸ª:after ä¼ªå…ƒç´ ï¼Œå®ç°å…ƒç´ æœ«å°¾æ·»åŠ ä¸€ä¸ªçœ‹ä¸è§çš„å—å…ƒç´ æ¥æ¸…ç†æµ®åŠ¨ã€‚è¿™æ˜¯é€šç”¨çš„æ¸…ç†æµ®åŠ¨æ–¹æ¡ˆï¼Œæ¨èä½¿ç”¨</p><h3 id="å¥—è·¯-4ï¼šç»™çˆ¶å…ƒç´ ä½¿ç”¨-overflow-hidden"><a href="#å¥—è·¯-4ï¼šç»™çˆ¶å…ƒç´ ä½¿ç”¨-overflow-hidden" class="headerlink" title="å¥—è·¯ 4ï¼šç»™çˆ¶å…ƒç´ ä½¿ç”¨ overflow:hidden;"></a>å¥—è·¯ 4ï¼šç»™çˆ¶å…ƒç´ ä½¿ç”¨ overflow:hidden;</h3><p>è¿™ç§æ–¹æ¡ˆè®©çˆ¶å®¹å™¨å½¢æˆäº† BFCï¼ˆå—çº§æ ¼å¼ä¸Šä¸‹æ–‡ï¼‰ï¼Œè€Œ BFC å¯ä»¥åŒ…å«æµ®åŠ¨ï¼Œé€šå¸¸ç”¨æ¥è§£å†³æµ®åŠ¨çˆ¶å…ƒç´ é«˜åº¦åå¡Œçš„é—®é¢˜ã€‚</p><p><strong>BFC çš„è§¦å‘æ–¹å¼</strong></p><p>æˆ‘ä»¬å¯ä»¥ç»™çˆ¶å…ƒç´ æ·»åŠ ä»¥ä¸‹å±æ€§æ¥è§¦å‘ BFCï¼š</p><ul><li>float ä¸º left | right</li><li>overflow ä¸º hidden | auto | scorll</li><li>display ä¸º table-cell | table-caption | inline-block</li><li>position ä¸º absolute | fixed</li></ul><p>è¿™é‡Œå¯ä»¥ç»™çˆ¶å…ƒç´ è®¾ç½® overflow:autoï¼Œä½†æ˜¯ä¸ºäº†å…¼å®¹ IE æœ€å¥½ä½¿ç”¨ overflow:hiddenã€‚</p><p><strong>ä½†è¿™ç§åŠæ³•æœ‰ä¸ªç¼ºé™·ï¼šå¦‚æœæœ‰å†…å®¹å‡ºäº†ç›’å­ï¼Œç”¨è¿™ç§æ–¹æ³•å°±ä¼šæŠŠå¤šçš„éƒ¨åˆ†è£åˆ‡æ‰ï¼Œæ‰€ä»¥è¿™æ—¶å€™ä¸èƒ½ä½¿ç”¨ã€‚</strong></p><p><strong>BFC çš„ä¸»è¦ç‰¹å¾:</strong></p><ul><li>BFC å®¹å™¨æ˜¯ä¸€ä¸ªéš”ç¦»çš„å®¹å™¨ï¼Œå’Œå…¶ä»–å…ƒç´ äº’ä¸å¹²æ‰°ï¼›æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨è§¦å‘ä¸¤ä¸ªå…ƒç´ çš„ BFC æ¥è§£å†³å‚ç›´è¾¹è·æŠ˜å é—®é¢˜ã€‚</li><li>BFC ä¸ä¼šé‡å æµ®åŠ¨å…ƒç´ </li><li>BFC å¯ä»¥åŒ…å«æµ®åŠ¨,è¿™å¯ä»¥æ¸…é™¤æµ®åŠ¨ã€‚</li></ul><h3 id="å¥—è·¯-5ï¼šbr-æ ‡ç­¾æ¸…æµ®åŠ¨"><a href="#å¥—è·¯-5ï¼šbr-æ ‡ç­¾æ¸…æµ®åŠ¨" class="headerlink" title="å¥—è·¯ 5ï¼šbr æ ‡ç­¾æ¸…æµ®åŠ¨"></a>å¥—è·¯ 5ï¼šbr æ ‡ç­¾æ¸…æµ®åŠ¨</h3><p><strong>br æ ‡ç­¾å­˜åœ¨ä¸€ä¸ªå±æ€§ï¼šclearã€‚è¿™ä¸ªå±æ€§å°±æ˜¯èƒ½å¤Ÿæ¸…é™¤æµ®åŠ¨çš„åˆ©å™¨ï¼Œåœ¨ br æ ‡ç­¾ä¸­è®¾ç½®å±æ€§ clearï¼Œå¹¶èµ‹å€¼ allã€‚å³èƒ½æ¸…é™¤æ‰æµ®åŠ¨</strong>ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">br</span> <span class="attr">clear</span>=<span class="string">"all"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#inner</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;CSS-æ¸…é™¤æµ®åŠ¨&quot;&gt;&lt;a href=&quot;#CSS-æ¸…é™¤æµ®åŠ¨&quot; class=&quot;headerlink&quot; title=&quot;CSS æ¸…é™¤æµ®åŠ¨&quot;&gt;&lt;/a&gt;CSS æ¸…é™¤æµ®åŠ¨&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/006y8m
      
    
    </summary>
    
      <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
      <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
      <category term="æ¸…é™¤æµ®åŠ¨" scheme="http://yoursite.com/tags/%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8/"/>
    
  </entry>
  
  <entry>
    <title>git mergeå’Œgit rebaseçš„åŒºåˆ«</title>
    <link href="http://yoursite.com/2019/09/21/git%20merge%E5%92%8Cgit%20rebase%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>http://yoursite.com/2019/09/21/git mergeå’Œgit rebaseçš„åŒºåˆ«/</id>
    <published>2019-09-21T14:53:17.000Z</published>
    <updated>2019-09-21T14:54:12.854Z</updated>
    
    <content type="html"><![CDATA[<h1 id="git-mergeå’Œgit-rebaseçš„åŒºåˆ«"><a href="#git-mergeå’Œgit-rebaseçš„åŒºåˆ«" class="headerlink" title="git mergeå’Œgit rebaseçš„åŒºåˆ«"></a>git mergeå’Œgit rebaseçš„åŒºåˆ«</h1><p>git rebase å’Œ git merge ä¸€æ ·éƒ½æ˜¯ç”¨äºä»ä¸€ä¸ªåˆ†æ”¯è·å–å¹¶ä¸”åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ï¼Œä½†æ˜¯ä»–ä»¬é‡‡å–ä¸åŒçš„å·¥ä½œæ–¹å¼ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6wkw4uh2dj30xc0qtjsl.jpg" alt="img"></p><p>ä¸ºäº†å°†master ä¸Šæ–°çš„æäº¤åˆå¹¶åˆ°ä½ çš„featureåˆ†æ”¯ä¸Šï¼Œä½ æœ‰ä¸¤ç§é€‰æ‹©ï¼š<code>merging</code> or <code>rebase</code></p><h2 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h2><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git merge master</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge master feature</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ­¤æ—¶åœ¨featureä¸Šgit è‡ªåŠ¨ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„commit(merge commit)</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6wky69tunj30w90850te.jpg" alt="img"></p><h3 id="git-merge-æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š"><a href="#git-merge-æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š" class="headerlink" title="git merge æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š"></a><code>git merge</code> æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</h3><ul><li>åªå¤„ç†ä¸€æ¬¡å†²çªï¼Œå¦‚æœåˆå¹¶çš„æ—¶å€™é‡åˆ°å†²çªï¼Œä»…éœ€è¦ä¿®æ”¹åé‡æ–°commit</li><li>å¼•å…¥äº†ä¸€æ¬¡åˆå¹¶çš„å†å²è®°å½•ï¼Œåˆå¹¶åçš„æ‰€æœ‰ <code>commit</code> ä¼šæŒ‰ç…§æäº¤æ—¶é—´ä»æ—§åˆ°æ–°æ’åˆ—</li><li>æ‰€æœ‰çš„è¿‡ç¨‹ä¿¡æ¯æ›´å¤šï¼Œå¯èƒ½ä¼šæé«˜ä¹‹åæŸ¥æ‰¾é—®é¢˜çš„éš¾åº¦</li></ul><h3 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h3><p>è®°å½•äº†çœŸå®çš„commitæƒ…å†µï¼ŒåŒ…æ‹¬æ¯ä¸ªåˆ†æ”¯çš„è¯¦æƒ…</p><h3 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h3><p>å› ä¸ºæ¯æ¬¡mergeä¼šè‡ªåŠ¨äº§ç”Ÿä¸€ä¸ªmerge commitï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¸€äº›git çš„GUI toolsï¼Œç‰¹åˆ«æ˜¯commitæ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œçœ‹åˆ°åˆ†æ”¯å¾ˆæ‚ä¹±ã€‚</p><h2 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h2><p>ä¸ <code>git merge</code> ä¸€è‡´ï¼Œ<code>git rebase</code> çš„ç›®çš„ä¹Ÿæ˜¯å°†ä¸€ä¸ªåˆ†æ”¯çš„æ›´æ”¹å¹¶å…¥åˆ°å¦å¤–ä¸€ä¸ªåˆ†æ”¯ä¸­å»ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature</span><br><span class="line">git rebase master</span><br></pre></td></tr></table></figure><p>æœ¬è´¨æ˜¯<strong>å˜åŸº å˜åŸº å˜åŸº</strong></p><p>å˜åŸºæ˜¯ä»€ä¹ˆ? <code>æ‰¾å…¬å…±ç¥–å…ˆ</code></p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6wl0azimrj30wx0823zd.jpg" alt="img"></p><h3 id="rebase-ç‰¹ç‚¹ï¼š"><a href="#rebase-ç‰¹ç‚¹ï¼š" class="headerlink" title="rebase ç‰¹ç‚¹ï¼š"></a>rebase ç‰¹ç‚¹ï¼š</h3><ul><li>æ”¹å˜å½“å‰åˆ†æ”¯ä» <code>master</code>ä¸Šæ‹‰å‡ºåˆ†æ”¯çš„ä½ç½®</li><li>æ²¡æœ‰å¤šä½™çš„åˆå¹¶å†å²çš„è®°å½•ï¼Œä¼šåˆå¹¶ä¹‹å‰çš„commitå†å²ï¼Œä¸”åˆå¹¶åçš„ <code>commit</code>é¡ºåºä¸ä¸€å®šæŒ‰ç…§ <code>commit</code>çš„æäº¤æ—¶é—´æ’åˆ—</li><li>å¯èƒ½ä¼šå¤šæ¬¡è§£å†³åŒä¸€ä¸ªåœ°æ–¹çš„å†²çªï¼ˆæœ‰ <code>squash</code>æ¥è§£å†³ï¼‰</li><li>æ›´æ¸…çˆ½ä¸€äº›ï¼Œ<code>master</code>åˆ†æ”¯ä¸Šæ¯ä¸ª <code>commit</code>ç‚¹éƒ½æ˜¯ç›¸å¯¹ç‹¬ç«‹å®Œæ•´çš„åŠŸèƒ½å•å…ƒ</li></ul><h3 id="ä¼˜ç‚¹ï¼š-1"><a href="#ä¼˜ç‚¹ï¼š-1" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h3><p>å¾—åˆ°æ›´ç®€æ´çš„é¡¹ç›®å†å²ï¼Œå»æ‰äº†merge commit</p><h3 id="ç¼ºç‚¹ï¼š-1"><a href="#ç¼ºç‚¹ï¼š-1" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h3><p>å¦‚æœåˆå¹¶å‡ºç°ä»£ç é—®é¢˜ä¸å®¹æ˜“å®šä½ï¼Œå› ä¸ºrewriteäº†history</p><h3 id="åˆå¹¶æ—¶é‡åˆ°å†²çªï¼š"><a href="#åˆå¹¶æ—¶é‡åˆ°å†²çªï¼š" class="headerlink" title="åˆå¹¶æ—¶é‡åˆ°å†²çªï¼š"></a>åˆå¹¶æ—¶é‡åˆ°å†²çªï¼š</h3><p>åˆå¹¶æ—¶å¦‚æœå‡ºç°å†²çªéœ€è¦æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤è§£å†³</p><ul><li>ä¿®æ”¹å†²çªéƒ¨åˆ†</li><li>git add</li><li><code>git rebase --continue</code></li><li>ï¼ˆå¦‚æœç¬¬ä¸‰æ­¥æ— æ•ˆå¯ä»¥æ‰§è¡Œ <code>git rebase --skip</code>ï¼‰</li></ul><p>ä¸è¦åœ¨git add ä¹‹åä¹ æƒ¯æ€§çš„æ‰§è¡Œ git commitå‘½ä»¤</p><h3 id="git-rebase-çš„äº¤äº’æ¨¡å¼"><a href="#git-rebase-çš„äº¤äº’æ¨¡å¼" class="headerlink" title="git rebase çš„äº¤äº’æ¨¡å¼"></a>git rebase çš„äº¤äº’æ¨¡å¼</h3><p>æ‰“å¼€å˜åŸºçš„äº¤äº’æ¨¡å¼åªéœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•° <code>-i</code> å³å¯ï¼ŒåŒæ—¶è¿˜éœ€è¦æŒ‡å®šå¯¹å“ªäº›æäº¤è¿›è¡Œå¤„ç†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i HEAD~4</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤æŒ‡å®šäº†å¯¹å½“å‰åˆ†æ”¯çš„æœ€è¿‘å››æ¬¡æäº¤è¿›è¡Œæ“ä½œã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢è¿™è¡Œå‘½ä»¤å°† <code>feature</code> åˆ†æ”¯çš„æäº¤åˆå¹¶ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6wl7ji36xj30wi0gpq67.jpg" alt="img"></p><p>ä¸­é—´çº¢æ¡†å†…æœ‰ä¸€äº›å‘½ä»¤ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†æŸæ¬¡æäº¤çš„</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>å¦‚æœä½ æƒ³è¦ä¸€ä¸ªå¹²å‡€çš„ï¼Œæ²¡æœ‰merge commitçš„çº¿æ€§å†å²æ ‘ï¼Œæˆ–è€…å½“å‘ç°è‡ªå·±ä¿®æ”¹æŸä¸ªåŠŸèƒ½æ—¶ï¼Œé¢‘ç¹è¿›è¡Œäº†<code>git commit</code>æäº¤æ—¶ï¼Œå‘ç°å…¶å®è¿‡å¤šçš„æäº¤ä¿¡æ¯æ²¡æœ‰å¿…è¦æ—¶ï¼Œé‚£ä¹ˆä½ åº”è¯¥é€‰æ‹©git rebase</li><li>å½“éœ€è¦ä¿ç•™è¯¦ç»†çš„åˆå¹¶ä¿¡æ¯çš„æ—¶å€™å»ºè®®ä½¿ç”¨<code>git merge</code>ï¼Œç‰¹åˆ«æ˜¯éœ€è¦å°†åˆ†æ”¯åˆå¹¶è¿›å…¥<code>master</code>åˆ†æ”¯æ—¶ï¼Œå¹¶ä¸”æƒ³è¦é¿å…é‡å†™commit historyçš„é£é™©ï¼Œä½ åº”è¯¥é€‰æ‹©ä½¿ç”¨git merge</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;git-mergeå’Œgit-rebaseçš„åŒºåˆ«&quot;&gt;&lt;a href=&quot;#git-mergeå’Œgit-rebaseçš„åŒºåˆ«&quot; class=&quot;headerlink&quot; title=&quot;git mergeå’Œgit rebaseçš„åŒºåˆ«&quot;&gt;&lt;/a&gt;git mergeå’Œgit reb
      
    
    </summary>
    
      <category term="git" scheme="http://yoursite.com/categories/git/"/>
    
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶</title>
    <link href="http://yoursite.com/2019/09/14/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%90%8C%E5%9F%9F%E5%90%8D%E8%AF%B7%E6%B1%82%E7%9A%84%E6%9C%80%E5%A4%A7%E5%B9%B6%E5%8F%91%E6%95%B0%E9%99%90%E5%88%B6/"/>
    <id>http://yoursite.com/2019/09/14/æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶/</id>
    <published>2019-09-14T15:14:44.000Z</published>
    <updated>2019-11-10T14:37:39.038Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶"><a href="#æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶" class="headerlink" title="æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶"></a>æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶</h1><p>å½“æˆ‘ä»¬åœ¨æµè§ˆç½‘é¡µçš„æ—¶å€™ï¼Œå¯¹æµè§ˆé€Ÿåº¦æœ‰ä¸€ä¸ªé‡è¦çš„å½±å“å› ç´ ï¼Œå°±æ˜¯æµè§ˆå™¨çš„å¹¶å‘æ•°é‡ã€‚å¹¶å‘æ•°é‡ç®€å•é€šä¿—çš„è®²å°±æ˜¯ï¼Œå½“æµè§ˆå™¨ç½‘é¡µçš„æ—¶å€™åŒæ—¶å·¥ä½œçš„è¿›è¡Œæ•°é‡ã€‚</p><p>å¦‚æœåŒæ—¶åªæœ‰ 2 ä¸ªå¹¶å‘è¿æ¥æ•°æ•°é‡ï¼Œé‚£ç½‘é¡µæ‰“å¼€çš„æ—¶å€™åªèƒ½ä¾èµ–äºè¿™ 2 æ¡çº¿ç¨‹ï¼Œå‰é¢å¦‚æœæœ‰æ‰“å¼€æ…¢çš„å†…å®¹ï¼Œå°±ä¼šç›´æ¥å½±å“åˆ°åé¢çš„å†…å®¹æ‰“å¼€ã€‚ä½†æ˜¯å¦‚æœåŒæ—¶æœ‰æ›´å¤šçš„å¹¶å‘è¿æ¥æ•°ï¼Œè¿™æ ·å°±ä¼šå¤§å¤§çš„æé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦ã€‚ä½†æ˜¯æµè§ˆå™¨çš„å¹¶å‘è¿æ¥æ•°ä¹Ÿå¹¶éè¶Šå¤§è¶Šå¥½ã€‚</p><p>HTTP å®¢æˆ·ç«¯ä¸€èˆ¬å¯¹åŒä¸€ä¸ªæœåŠ¡å™¨çš„å¹¶å‘è¿æ¥ä¸ªæ•°éƒ½æ˜¯æœ‰é™åˆ¶çš„ã€‚å®é™…ä¸Šï¼Œæµè§ˆå™¨ç¡®å®ä½¿ç”¨å¹¶è¡Œè¿æ¥ï¼Œä½†å®ƒä»¬å°†å¹¶è¡Œè¿æ¥çš„æ€»æ•°é™åˆ¶ä¸ºå°‘é‡ï¼ˆ<strong>é€šå¸¸ä¸ºå››ä¸ª</strong>ï¼‰ã€‚æœåŠ¡å™¨å¯ä»¥è‡ªç”±åœ°å…³é—­æ¥è‡ªç‰¹å®šå®¢æˆ·ç«¯çš„è¿‡å¤šè¿æ¥ã€‚</p><h2 id="ä¸»æµæµè§ˆå™¨æœ€å¤§å¹¶å‘è¿æ¥æ•°"><a href="#ä¸»æµæµè§ˆå™¨æœ€å¤§å¹¶å‘è¿æ¥æ•°" class="headerlink" title="ä¸»æµæµè§ˆå™¨æœ€å¤§å¹¶å‘è¿æ¥æ•°"></a>ä¸»æµæµè§ˆå™¨æœ€å¤§å¹¶å‘è¿æ¥æ•°</h2><p>ä¸€äº›ä¸»æµæµè§ˆå™¨å¯¹ HTTP 1.1 å’Œ HTTP 1.0 çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°ç›®ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹è¡¨æ ¼ï¼š</p><table><thead><tr><th>æµè§ˆå™¨</th><th>HTTP / 1.1</th><th>HTTP / 1.0</th></tr></thead><tbody><tr><td>IE 11</td><td>6</td><td>6</td></tr><tr><td>IE 10</td><td>6</td><td>6</td></tr><tr><td>IE 9</td><td>10</td><td>10</td></tr><tr><td>IE 8</td><td>6</td><td>6</td></tr><tr><td>IE 6,7</td><td>2</td><td>4</td></tr><tr><td>ç«ç‹</td><td>6</td><td>6</td></tr><tr><td>Safari 3,4</td><td>4</td><td>4</td></tr><tr><td>Chrome 4+</td><td>6</td><td>6</td></tr><tr><td>æ­Œå‰§ 9.63,10.00alpha</td><td>4</td><td>4</td></tr><tr><td>Opera 10.51+</td><td>8</td><td>ï¼Ÿ</td></tr><tr><td>iPhone 2</td><td>4</td><td>ï¼Ÿ</td></tr><tr><td>iPhone 3</td><td>6</td><td>ï¼Ÿ</td></tr><tr><td>iPhone 4</td><td>4</td><td>ï¼Ÿ</td></tr><tr><td>iphone 5</td><td>6</td><td>ï¼Ÿ</td></tr><tr><td>Android2-4</td><td>4</td><td>ï¼Ÿ</td></tr></tbody></table><h3 id="Firefox-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"><a href="#Firefox-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°" class="headerlink" title="Firefox æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"></a>Firefox æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°</h3><p>åœ¨ Firefox ä¸­çš„åœ°å€æ è¾“å…¥â€œaboutï¼šconfig ä¸­â€ï¼Œç„¶åæœç´¢å¹¶ä¿®æ”¹å¦‚ä¸‹ä¸¤ä¸ªé…ç½®é¡¹ç›®å³å¯ï¼š</p><ul><li><code>network.http.max-persistent-connections-per-server:6</code>è¿æ¥åŒä¸€ä¸ªæœåŠ¡å™¨å…è®¸çš„æœ€å¤§æŒä¹…è¿æ¥æ•°ï¼Œé»˜è®¤ä¸º 6ï¼Œå¯ä»¥ä¸ç”¨æ›´æ”¹ã€‚</li><li><code>network.http.max-persistent-connections-per-proxy:8</code>æ¯ä¸ªä»£ç†æœåŠ¡å™¨å…è®¸çš„æœ€å¤§æŒä¹…è¿æ¥æ•°,å…¬å¸ç”¨æˆ·ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä½†æ˜¯å¤–é¢çš„å®¢æˆ·ä¸€èˆ¬ä¸ä½¿ç”¨ä»£ç†ï¼Œç«ç‹æ¨èçš„æ¯å°ä»£ç†æœåŠ¡å™¨è®¾ç½®ä¸ºï¼š&lt;= 10ã€‚</li></ul><h4 id="Firefox3-6"><a href="#Firefox3-6" class="headerlink" title="Firefox3.6"></a>Firefox3.6</h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6jbxx2j6tj30fq06faa1.jpg" alt="img"></p><p>å’Œ IE8 çš„å‡ ä¹å®Œå…¨ä¸€æ ·ï¼š</p><ul><li>æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°ä¸º 6 ä¸ªï¼ˆå¯åœ¨ about:config ä¸­ä¿®æ”¹ï¼‰ã€‚</li><li>javascript æ–‡ä»¶ä¸ä¼šé˜»å¡å…¶ä»–èµ„æºçš„åŠ è½½ï¼Œå¤šä¸ª javascript æ–‡ä»¶å¯ä»¥ä¸€èµ·åŠ è½½ã€‚</li><li>ä¼šåˆ†æ HTML ç»“æ„ï¼Œä¼˜å…ˆä¸‹è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºã€‚</li></ul><h4 id="Firefox4-beta12"><a href="#Firefox4-beta12" class="headerlink" title="Firefox4 beta12"></a>Firefox4 beta12</h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6jby0whawj30fv07n3yj.jpg" alt="img"></p><p>ä¸çŸ¥æ˜¯å› ä¸ºè®¾è®¡ç†å¿µä¸Šçš„ä¸åŒï¼Œè¿˜æ˜¯å› ä¸º beta ç‰ˆæœªç…§é¡¾åˆ°è¿™ä¸€å—ï¼ŒFirefox4 åè€Œé€€åŒ–äº†ï¼Œå’Œ Firefox3.6 çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å¯¹èµ„æºç±»å‹çš„å¤„ç†ä¸Šï¼ŒFirefox4 ä¸å†ä¸¥æ ¼åœ°ä¼˜å…ˆä¸‹è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºï¼Œè€Œæ˜¯æŒ‰ç…§ HTML ç»“æ„ä¸­å‡ºç°çš„é¡ºåºæ¥è¿›è¡ŒåŠ è½½ã€‚</p><h3 id="IE-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"><a href="#IE-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°" class="headerlink" title="IE æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"></a>IE æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°</h3><p>ç”¨â€œæ³¨å†Œè¡¨ç¼–è¾‘å™¨â€å‘½ä»¤æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼Œæ‰¾åˆ°ï¼š</p><p>[HKEY_CURRRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Internet Settings]ï¼Œå¯ä»¥çœ‹åˆ°<strong>MaxConnectionsPerServer</strong>å’Œ<strong>MaxConnectionsPer1_0Server</strong>è¿™ä¸¤ä¸ªé”®ï¼ˆåˆ†åˆ«æ˜¯é’ˆå¯¹ HTTP 1.1 å’Œ HTTP 1.0 çš„è®¾ç½®ï¼‰</p><p><strong>å¯¹äº IE 9</strong></p><p>[HKEY_CURRRENT_USER \ Software \ Policies \ Microsoft \ Internet Exploer \ Main \ FeatureControlï¼Œå¯ä»¥çœ‹åˆ°<strong>FEATURE_MAXCONNECTIONSPER1_0SERVER</strong>å’Œ<strong>FEATURE_MAXCONNECTIONSPERSERVER</strong>è¿™ä¸¤ä¸ªé”®ï¼ˆåˆ†åˆ«æ˜¯é’ˆå¯¹ HTTP 1.1 å’Œ HTTP 1.0 çš„è®¾ç½®ï¼‰</p><h4 id="IE8"><a href="#IE8" class="headerlink" title="IE8"></a>IE8</h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6jbx8rdwaj30g407pweh.jpg" alt="img"></p><p>å’Œ IE6 å®Œå…¨ä¸åŒçš„ç€‘å¸ƒå›¾ï¼Œå…¶ç‰¹ç‚¹æœ‰ï¼š</p><ul><li>æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°ä¸º 6 ä¸ªã€‚</li><li>javascript æ–‡ä»¶å·²ç»ä¸ä¼šé˜»å¡å…¶ä»–èµ„æºçš„åŠ è½½ï¼Œç”šè‡³å¤šä¸ª javascript æ–‡ä»¶å¯ä»¥ä¸€èµ·åŠ è½½ï¼Œå¹¶ä¸”ä¼šä¿è¯æ‰§è¡Œçš„é¡ºåºã€‚</li><li>ä¼šåˆ†æ HTML ç»“æ„ï¼Œä¼˜å…ˆä¸‹è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºã€‚</li></ul><h3 id="chrome-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"><a href="#chrome-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°" class="headerlink" title="chrome æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"></a>chrome æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°</h3><h4 id="Chrome8"><a href="#Chrome8" class="headerlink" title="Chrome8"></a>Chrome8</h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6jbzcty9xj30fw07zwef.jpg" alt="img"></p><p>Chrome è‡ªå¸¦çš„å·¥å…·ä¸èƒ½å¾ˆæ¸…æ¥šåœ°è¡¨ç¤ºå„è¯·æ±‚çš„å¼€å§‹æ—¶é—´ï¼Œæ‰€ä»¥ä½¿ç”¨äº† Fiddler çš„ç€‘å¸ƒå›¾ï¼Œä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒChrome ä¹Ÿæ˜¯æ¯”è¾ƒç‰¹ç«‹ç‹¬è¡Œçš„ä¸€ä½ï¼Œå…¶ç‰¹ç‚¹æœ‰ï¼š</p><ul><li>æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°ä¸º 6ã€‚</li><li>head éƒ¨åˆ†çš„èµ„æºä¼šå•ç‹¬ä¸‹è½½ï¼Œä¸”é˜»å¡ body ä¸­çš„å…¶ä»–èµ„æºçš„åŠ è½½ã€‚</li><li>ä¼šä¼˜å…ˆåŠ è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„èµ„æºã€‚</li></ul><h3 id="opera-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"><a href="#opera-æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°" class="headerlink" title="opera æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°"></a>opera æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°</h3><h4 id="Opera11"><a href="#Opera11" class="headerlink" title="Opera11"></a>Opera11</h4><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6jbzixw3tj30fj0813yh.jpg" alt="img"></p><p>å…ˆæŠ¥æ€¨ä¸€ä¸‹ï¼ŒDragonfly ä¸æ€ä¹ˆå¥½ç”¨æ¥ç€â€¦â€¦Opera çš„èµ„æºåŠ è½½ä¹Ÿæ¯”è¾ƒæœ‰ç‰¹è‰²ï¼Œè€Œä¸”å¾ˆéš¾çœ‹å‡ºè§„å¾‹ï¼Œåªèƒ½å¤§è‡´æ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li>Opera çš„æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°é»˜è®¤ä¸º 16ï¼Œå¯åœ¨ opera:config - Performance - Max Connections Server æŸ¥çœ‹å’Œä¿®æ”¹ã€‚</li><li>javascript æ–‡ä»¶çš„åŠ è½½ä¼šé˜»å¡å…¶ä»– script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºçš„åŠ è½½ï¼Œå¦‚å›¾ä¸­çš„ 2.jsã€‚ä½†ä¸ä¼šé˜»å¡å›¾ç‰‡ç­‰å…¶ä»–èµ„æºçš„åŠ è½½ï¼Œå¦‚å›¾ä¸­çš„ 3.jsã€‚</li><li>ä¼šä¸€å®šç¨‹åº¦ä¸Šå¯¹èµ„æºçš„ä¼˜å…ˆçº§è¿›è¡Œä¼˜åŒ–ï¼Œä½†ç”±äº javascript æ–‡ä»¶è¦é˜»æ­¢åç»­éƒ¨åˆ†èµ„æºçš„åŠ è½½ï¼Œåˆä¸ºäº†å……åˆ†åˆ©ç”¨æœ€å¤§ HTTP è¿æ¥æ•°ï¼Œå› æ­¤ä¸èƒ½ä¸¥æ ¼å…ˆåŠ è½½æ‰€æœ‰çš„ script å’Œ link æ ‡ç­¾å®šä¹‰çš„èµ„æºï¼Œå¯¼è‡´ç€‘å¸ƒå›¾ä¸Šå„ç±»å‹èµ„æºæœ‰ç›¸äº’ç©¿æ’ï¼Œéš¾å¯»è§„å¾‹ã€‚</li></ul><h2 id="HTTP-è¿æ¥è¯·æ±‚ä¸çº¿ç¨‹"><a href="#HTTP-è¿æ¥è¯·æ±‚ä¸çº¿ç¨‹" class="headerlink" title="HTTP è¿æ¥è¯·æ±‚ä¸çº¿ç¨‹"></a>HTTP è¿æ¥è¯·æ±‚ä¸çº¿ç¨‹</h2><p>HTTP è¿æ¥æ˜¯å¤æ‚ï¼Œæœ‰çŠ¶æ€çš„å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒå¿…é¡»è¢«å¦¥å–„ç®¡ç†ã€‚<strong>ä¸€ä¸ª HTTP è¿æ¥è¯·æ±‚åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚</strong></p><p>HttpClient ä½¿ç”¨ä¸€ä¸ªå«åšçš„ Http è¿æ¥ç®¡ç†å™¨çš„ç‰¹æ®Šå®ä½“ç±»æ¥ç®¡ç†çš„ Http è¿æ¥ã€‚Http è¿æ¥ç®¡ç†å™¨åœ¨æ–°å»ºçš„ HTTP è¿æ¥æ—¶ï¼Œä½œä¸ºå·¥å‚ç±»ï¼›ç®¡ç†æŒä¹…çš„ http è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸï¼›åŒæ­¥æŒä¹…è¿æ¥ï¼ˆç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œå³ä¸€ä¸ª HTTP è¿æ¥åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼‰ã€‚</p><p>å¦‚æœä¸€ä¸ªçš„ Http è¿æ¥è¢«é‡Šæ”¾æˆ–è€…è¢«å®ƒçš„æ¶ˆè´¹è€…æ˜ç¡®è¡¨ç¤ºè¦å…³é—­ï¼Œé‚£ä¹ˆåº•å±‚çš„è¿æ¥å°±ä¼šå’Œå®ƒçš„ä»£ç†è¿›è¡Œåˆ†ç¦»ï¼Œå¹¶ä¸”è¯¥è¿æ¥ä¼šè¢«äº¤è¿˜ç»™è¿æ¥ç®¡ç†å™¨ã€‚è¿™æ˜¯ï¼Œå³ä½¿æœåŠ¡æ¶ˆè´¹è€…ä»ç„¶æŒæœ‰ä»£ç†çš„å¼•ç”¨ï¼Œå®ƒä¹Ÿä¸èƒ½å†æ‰§è¡Œ I / O æ“ä½œï¼Œæˆ–è€…æ›´æ”¹çš„ Http è¿æ¥çš„çŠ¶æ€ã€‚</p><h3 id="è¿æ¥æ± ç®¡ç†å™¨"><a href="#è¿æ¥æ± ç®¡ç†å™¨" class="headerlink" title="è¿æ¥æ± ç®¡ç†å™¨"></a>è¿æ¥æ± ç®¡ç†å™¨</h3><p>è¿æ¥æ± ç®¡ç†å™¨æ˜¯ä¸ªå¤æ‚çš„ç±»ï¼Œå®ƒç®¡ç†ç€è¿æ¥æ± ï¼Œå¯ä»¥åŒæ—¶ä¸ºå¾ˆå¤šçº¿ç¨‹æä¾› HTTP è¿æ¥è¯·æ±‚ã€‚å½“è¯·æ±‚ä¸€ä¸ªæ–°çš„è¿æ¥æ—¶ï¼Œå¦‚æœè¿æ¥æ± æœ‰æœ‰å¯ç”¨çš„æŒä¹…è¿æ¥ï¼Œè¿æ¥ç®¡ç†å™¨å°±ä¼šä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªï¼Œè€Œä¸æ˜¯å†åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ã€‚</p><p>å½“ä½¿ç”¨äº†è¯·æ±‚è¿æ¥æ± ç®¡ç†å™¨åï¼ŒHttpClient çš„å°±å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªçº¿ç¨‹çš„è¯·æ±‚äº†ã€‚</p><p>è¿æ¥æ± ç®¡ç†å™¨ä¼šæ ¹æ®å®ƒçš„é…ç½®æ¥åˆ†é…è¯·æ±‚è¿æ¥ã€‚å¦‚æœè¿æ¥æ± ä¸­çš„æ‰€æœ‰è¿æ¥éƒ½è¢«å ç”¨äº†ï¼Œé‚£ä¹ˆåç»­çš„è¯·æ±‚å°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœ‰è¿æ¥è¢«é‡Šæ”¾å›è¿æ¥æ± ä¸­ã€‚</p><h3 id="çº¿ç¨‹æ± çš„åŸç†"><a href="#çº¿ç¨‹æ± çš„åŸç†" class="headerlink" title="çº¿ç¨‹æ± çš„åŸç†"></a>çº¿ç¨‹æ± çš„åŸç†</h3><p>çº¿ç¨‹æ± çš„åŸç†å¾ˆç®€å•ï¼Œç±»ä¼¼äºæ“ä½œç³»ç»Ÿä¸­çš„ç¼“å†²åŒºçš„æ¦‚å¿µï¼Œå®ƒçš„æµç¨‹å¦‚ä¸‹ï¼š</p><p>çº¿ç¨‹æ± åœ¨è¿˜æ²¡æœ‰ä»»åŠ¡åˆ°æ¥ä¹‹å‰ï¼Œåˆ›å»ºä¸€å®šæ•°é‡çš„çº¿ç¨‹ï¼Œæ”¾å…¥ç©ºé—²é˜Ÿåˆ—ä¸­ã€‚è¿™äº›çº¿ç¨‹éƒ½æ˜¯å¤„äºç¡çœ çŠ¶æ€ï¼Œå³å‡ä¸ºå¯åŠ¨ï¼Œä¸æ¶ˆè€— CPUï¼Œè€Œåªæ˜¯å ç”¨è¾ƒå°çš„å†…å­˜ç©ºé—´ã€‚å½“å®¢æˆ·ç«¯æœ‰ä¸€ä¸ªæ–°è¯·æ±‚æ—¶ï¼Œå°±ä¼šå”¤é†’çº¿ç¨‹æ± ä¸­çš„æŸä¸€ä¸ªç¡çœ çº¿ç¨‹ï¼Œè®©å®ƒæ¥å¤„ç†å®¢æˆ·ç«¯çš„è¿™ä¸ªè¯·æ±‚ï¼Œå½“å¤„ç†å®Œè¿™ä¸ªè¯·æ±‚åï¼Œçº¿ç¨‹åˆå¤„äºç¡çœ çŠ¶æ€ã€‚</p><p>çº¿ç¨‹æ± èƒ½èŠ‚çº¦å¤§é‡çš„çš„ç³»ç»Ÿèµ„æºï¼Œä½¿å¾—æ›´å¤šçš„ CPU æ—¶é—´å’Œå†…å­˜ç”¨æ¥å¤„ç†å®é™…çš„å•†ä¸šåº”ç”¨ï¼Œè€Œä¸æ˜¯é¢‘ç¹çš„çº¿ç¨‹åˆ›å»ºä¸é”€æ¯</p><p>æ¯ä¸ªçº¿ç¨‹éœ€è¦å¤§çº¦ 1MB å†…å­˜ï¼Œçº¿ç¨‹å¼€çš„è¶Šå¤šï¼Œæ¶ˆè€—çš„å†…å­˜ä¹Ÿå°±è¶Šå¤§ã€‚</p><p>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨çº¿ç¨‹æ± ï¼š</p><ol><li>å•ä¸ªä»»åŠ¡å¤„ç†çš„æ—¶é—´æ¯”è¾ƒçŸ­</li><li>å°†éœ€å¤„ç†çš„ä»»åŠ¡çš„æ•°é‡å¤§</li></ol><h3 id="æ•°æ®åº“è¿æ¥æ± "><a href="#æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="æ•°æ®åº“è¿æ¥æ± "></a>æ•°æ®åº“è¿æ¥æ± </h3><p>æ•°æ®åº“è¿æ¥æ± çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å»ºç«‹è¶³å¤Ÿçš„æ•°æ®åº“è¿æ¥ï¼Œå¹¶è®²è¿™äº›è¿æ¥ç»„æˆä¸€ä¸ªè¿æ¥æ± ï¼ˆç®€å•è¯´ï¼šåœ¨ä¸€ä¸ªâ€œæ± â€é‡Œæ”¾äº†å¥½å¤šåŠæˆå“çš„æ•°æ®åº“è”æ¥å¯¹è±¡ï¼‰ï¼Œç”±åº”ç”¨ç¨‹åºåŠ¨æ€åœ°å¯¹æ± ä¸­çš„è¿æ¥è¿›è¡Œç”³è¯·ï¼Œä½¿ç”¨å’Œé‡Šæ”¾ã€‚å¯¹äºå¤šäºè¿æ¥æ± ä¸­è¿æ¥æ•°çš„å¹¶å‘è¯·æ±‚ï¼Œåº”è¯¥åœ¨è¯·æ±‚é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…ã€‚å¹¶ä¸”åº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®æ± ä¸­è¿æ¥çš„ä½¿ç”¨ç‡ï¼ŒåŠ¨æ€å¢åŠ æˆ–å‡å°‘æ± ä¸­çš„è¿æ¥æ•°ã€‚<br>è¿æ¥æ± æŠ€æœ¯å°½å¯èƒ½å¤šåœ°é‡ç”¨äº†æ¶ˆè€—å†…å­˜åœ°èµ„æºï¼Œå¤§å¤§èŠ‚çœäº†å†…å­˜ï¼Œæé«˜äº†æœåŠ¡å™¨åœ°æœåŠ¡æ•ˆç‡ï¼Œèƒ½å¤Ÿæ”¯æŒæ›´å¤šçš„å®¢æˆ·æœåŠ¡ã€‚é€šè¿‡ä½¿ç”¨è¿æ¥æ± ï¼Œå°†å¤§å¤§æé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶è‡ªèº«çš„ç®¡ç†æœºåˆ¶æ¥ç›‘è§†æ•°æ®åº“è¿æ¥çš„æ•°é‡ï¼Œä½¿ç”¨æƒ…å†µç­‰ã€‚</p><p>1ï¼‰æœ€å°è¿æ¥æ•°æ˜¯è¿æ¥æ± ä¸€ç›´ä¿æŒçš„æ•°æ®åº“è¿æ¥ï¼Œæ‰€ä»¥å¦‚æœåº”ç”¨ç¨‹åºå¯¹æ•°æ®åº“è¿æ¥çš„ä½¿ç”¨é‡ä¸å¤§ï¼Œå°†ä¼šæœ‰å¤§é‡çš„æ•°æ®åº“è¿æ¥èµ„æºè¢«æµªè´¹;<br>2ï¼‰æœ€å¤§è¿æ¥æ•°æ˜¯è¿æ¥æ± èƒ½ç”³è¯·çš„æœ€å¤§è¿æ¥æ•°ï¼Œå¦‚æœæ•°æ®åº“è¿æ¥è¯·æ±‚è¶…è¿‡æ­¤æ•°ï¼Œåé¢çš„æ•°æ®åº“è¿æ¥è¯·æ±‚å°†è¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œè¿™ä¼šå½±å“ä¹‹åçš„æ•°æ®åº“æ“ä½œã€‚</p><p><strong>æ•°æ®åº“è¿æ¥æ˜¯ä¸€ç§å…³é”®çš„æœ‰é™çš„æ˜‚è´µçš„èµ„æºï¼Œè¿™ä¸€ç‚¹åœ¨å¤šç”¨æˆ·çš„ç½‘é¡µåº”ç”¨ç¨‹åºä¸­ä½“ç°å¾—å°¤ä¸ºçªå‡ºã€‚</strong>ä¸€ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡å‡å¯¹åº”ä¸€ä¸ªç‰©ç†æ•°æ®åº“è¿æ¥ï¼Œæ¯æ¬¡æ“ä½œéƒ½æ‰“å¼€ä¸€ä¸ªç‰©ç†è¿æ¥ï¼Œä½¿ç”¨å®Œéƒ½å…³é—­è¿æ¥ï¼Œè¿™æ ·é€ æˆç³»ç»Ÿçš„æ€§èƒ½ä½ä¸‹ã€‚</p><h3 id="WebSphere-Application-Server-æ€§èƒ½"><a href="#WebSphere-Application-Server-æ€§èƒ½" class="headerlink" title="WebSphere Application Server æ€§èƒ½"></a>WebSphere Application Server æ€§èƒ½</h3><p><a href="http://websphere.sys-con.com/node/46514/print" target="_blank" rel="noopener">http://websphere.sys-con.com/node/46514/print</a></p><p>æ„å»ºæœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªè¿‡äºç®€å•çš„æ¨¡å‹æ˜¯ï¼šæ¯å½“ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾å°±åˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡å¯¹è±¡ï¼Œç„¶ååœ¨æ–°çš„æœåŠ¡å¯¹è±¡ä¸­ä¸ºæœåŠ¡è¯·æ±‚ï¼Œä½†å½“æœ‰å¤§é‡è¯·æ±‚å¹¶å‘è®¿é—®æ—¶ï¼ŒæœåŠ¡å™¨ä¸æ–­çš„åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„å¼€é”€å¾ˆå¤§ã€‚</p><p>åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆæµªè´¹èµ„æºçš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨ Java çš„ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºè¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥ï¼Œæé«˜ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°ã€‚åˆ©ç”¨å·²æœ‰çš„å¯¹è±¡æ¥æœåŠ¡å°±æ˜¯â€œæ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚</p><p><strong>HTTP ä¾¦å¬å™¨</strong><br>HTTP ä¾¦å¬å™¨è´Ÿè´£åœ¨ HTTP æœåŠ¡å™¨çº§åˆ«åˆ›å»ºçº¿ç¨‹ã€‚è¿™é‡Œå‘ç”Ÿçš„å¤§å¤šæ•°å¤„ç†æ˜¯é™æ€é¡µé¢æœåŠ¡ï¼Œæˆ– HTTP post / GET ä¼ é€’å‘½ä»¤åˆ°åç«¯ã€‚è¿™æ˜¯å¿…é¡»è€ƒè™‘çš„ç¬¬ä¸€çº§çº¿ç¨‹é…ç½®ã€‚</p><p><strong>Web å®¹å™¨</strong><br>Web å®¹å™¨è´Ÿè´£åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨çº§åˆ«åˆ›å»ºçº¿ç¨‹æ± ã€‚æ­¤çº§åˆ«çš„å¤§å¤šæ•°å¤„ç†åŒ…æ‹¬ servletï¼ŒJSPï¼ŒEJBï¼ŒåŠ¨æ€é¡µé¢åˆ›å»ºå’Œåç«¯ä¼ é€’å¤„ç†ã€‚Web å®¹å™¨æ˜¯å¿…é¡»é…ç½®çš„ç¬¬äºŒçº§çº¿ç¨‹æ± é…ç½®ã€‚</p><p><strong>ORB å®¹å™¨</strong> ORB å®¹å™¨è´Ÿè´£åœ¨å¯¹è±¡çº§åˆ›å»ºçº¿ç¨‹æ± ã€‚è¿™é‡Œå‘ç”Ÿçš„å¤§éƒ¨åˆ†å¤„ç†åŒ…æ‹¬å¤„ç†åŸºäºé Web çš„å®¢æˆ·ç«¯ã€‚ORB å®¹å™¨æ˜¯å¿…é¡»é…ç½®çš„çº¿ç¨‹æ± é…ç½®çš„ç¬¬ä¸‰çº§ã€‚</p><p><strong>æ•°æ®æº</strong><br>æ•°æ®æºçº§è´Ÿè´£åˆ›å»ºä»æ•°æ®åº“æˆ–â€œä¼ ç»Ÿâ€ç³»ç»Ÿè®¿é—®çš„è¿æ¥çº¿ç¨‹ã€‚è¿™äº›çº¿ç¨‹æ˜¯å¿…é¡»è§£å†³çš„ç¬¬å››çº§é…ç½®</p><h3 id="WAS-çº¿ç¨‹æ± æ•°ä¸-IHS-server"><a href="#WAS-çº¿ç¨‹æ± æ•°ä¸-IHS-server" class="headerlink" title="WAS çº¿ç¨‹æ± æ•°ä¸ IHS server"></a>WAS çº¿ç¨‹æ± æ•°ä¸ IHS server</h3><p>å‡å®šä¸€ä¸ªæµè§ˆå™¨çš„å¹¶å‘è¿æ¥è¯·æ±‚æ•°ä¸º 10ï¼Œé€šå¸¸åŒä¸€æ—¶é—´å†…ä¼šæœ‰å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®ç½‘ç«™ã€‚åˆè€ƒè™‘åˆ°ï¼Œä¸€ä¸ª Http è¿æ¥è¯·æ±‚åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚æ‰€ä»¥ï¼ŒIHS æœåŠ¡å™¨çš„ httpd.conf é‡Œçš„ maxclientsï¼ˆå…è®¸å»ºç«‹çš„æ€»çº¿ç¨‹æ•°ï¼‰è¦èƒ½å¤Ÿå¤„ç†å³°å€¼æ—¶åˆ»çš„æµè§ˆå™¨è¿æ¥è¯·æ±‚æ‰è¡Œã€‚åŒæ—¶ï¼Œè€ƒè™‘ä¸æ˜¯æ‰€æœ‰çš„è¿æ¥è¯·æ±‚éƒ½ä¼šåˆ° was serverï¼Œæœ‰çš„è¿æ¥åªæ˜¯ä¸ºäº†åœ¨ web æœåŠ¡å™¨ä¸Šå–é™æ€èµ„æºï¼Œæ‰€ä»¥ï¼Œwas ä¸Šçš„çº¿ç¨‹æ± æ•°ç›®ï¼ˆThread pools ï¼š50 ï¼‰ä¼šè¿œå°äº IHS server ä¸Šçš„ maxclients å€¼è­¬å¦‚ 400ï¼‰ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶&quot;&gt;&lt;a href=&quot;#æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶&quot; class=&quot;headerlink&quot; title=&quot;æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶&quot;&gt;&lt;/a&gt;æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶&lt;/h1&gt;&lt;p&gt;å½“æˆ‘ä»¬åœ¨æµè§ˆç½‘é¡µçš„æ—¶å€™ï¼Œå¯¹æµ
      
    
    </summary>
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯ä¼˜åŒ–</title>
    <link href="http://yoursite.com/2019/09/08/%E5%89%8D%E7%AB%AF%E4%BC%98%E5%8C%96/"/>
    <id>http://yoursite.com/2019/09/08/å‰ç«¯ä¼˜åŒ–/</id>
    <published>2019-09-08T15:48:15.000Z</published>
    <updated>2019-11-10T14:37:39.031Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰ç«¯ä¼˜åŒ–"><a href="#å‰ç«¯ä¼˜åŒ–" class="headerlink" title="å‰ç«¯ä¼˜åŒ–"></a>å‰ç«¯ä¼˜åŒ–</h1><h2 id="å‰ç«¯æ€§èƒ½è¡¡é‡æŒ‡æ ‡"><a href="#å‰ç«¯æ€§èƒ½è¡¡é‡æŒ‡æ ‡" class="headerlink" title="å‰ç«¯æ€§èƒ½è¡¡é‡æŒ‡æ ‡"></a>å‰ç«¯æ€§èƒ½è¡¡é‡æŒ‡æ ‡</h2><ul><li><strong>ç™½å±æ—¶é—´</strong> è¯¥æ—¶é—´ç‚¹è¡¨ç¤ºæµè§ˆå™¨å¼€å§‹ç»˜åˆ¶é¡µé¢ï¼Œåœ¨æ­¤ä¹‹å‰é¡µé¢éƒ½æ˜¯ç™½å±ï¼Œä¹Ÿç§°ä¸ºå¼€å§‹æ¸²æŸ“æ—¶é—´</li><li><strong>é¦–å±æ—¶é—´</strong> è¯¥æ—¶é—´ç‚¹è¡¨ç¤ºç”¨æˆ·çœ‹åˆ°ç¬¬ä¸€å±é¡µé¢çš„æ—¶é—´</li><li><strong>ç”¨æˆ·å¯äº¤äº’æ—¶é—´</strong> ä¹Ÿå« DOM Ready,è¯¥æ—¶é—´ç‚¹è¡¨ç¤º DOM è§£æå®Œæˆï¼Œèµ„æºè¿˜æ²¡æœ‰å®Œæˆï¼Œè¿™ä¸ªæ—¶å€™ç”¨æˆ·ä¸é¡µé¢å¯ä»¥äº¤äº’äº†</li><li><strong>å®Œå…¨åŠ è½½æ—¶é—´</strong> è¯¥æ—¶é—´ç‚¹æ˜¯ window.onload æ—¶é—´è§¦å‘çš„æ—¶é—´ï¼Œè¡¨ç¤ºåŸå§‹æ–‡æ¡£å’Œæ‰€ç”¨å¼•ç”¨çš„å†…å®¹å·²ç»åŠ è½½å®Œæˆï¼Œç”¨æˆ·æœ€æ˜æ˜¾çš„æ„Ÿè§‰å°±æ˜¯æµè§ˆå™¨ tab ä¸Š loading çŠ¶æ€ç»“æŸ</li><li><strong>é¦–å­—èŠ‚æ—¶é—´ï¼ˆTTFBï¼‰</strong> ç¬¬ä¸€å­—èŠ‚å“åº”æ—¶é—´ï¼ˆTTFBï¼‰=å‘é€è¯·æ±‚åˆ° WEB æœåŠ¡å™¨çš„æ—¶é—´+WEB æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶ç”Ÿæˆå“åº”èŠ±è´¹çš„æ—¶é—´+WEB æœåŠ¡å™¨ç”Ÿæˆå“åº”åˆ°æµè§ˆå™¨èŠ±è´¹çš„æ—¶é—´</li><li><strong>DNS è§£ææ—¶é—´</strong></li><li><strong>TCP è¿æ¥æ—¶é—´</strong></li><li><strong>HTTP è¯·æ±‚æ—¶é—´</strong></li><li><strong>HTTP å“åº”æ—¶é—´</strong></li></ul><h2 id="ä¼˜åŒ–åŸåˆ™"><a href="#ä¼˜åŒ–åŸåˆ™" class="headerlink" title="ä¼˜åŒ–åŸåˆ™"></a>ä¼˜åŒ–åŸåˆ™</h2><p>é›…è™ 14 æ¡ä¼˜åŒ–åŸåˆ™ï¼š</p><ol><li><p>å°½å¯èƒ½çš„å‡å°‘ HTTP çš„è¯·æ±‚æ•° content</p></li><li><p>ä½¿ç”¨ CDNï¼ˆContent Delivery Networkï¼‰ server</p></li><li><p>æ·»åŠ  Expires å¤´(æˆ–è€… Cache-control ) server</p></li><li><p>Gzip ç»„ä»¶ server</p></li><li><p>å°† CSS æ ·å¼æ”¾åœ¨é¡µé¢çš„ä¸Šæ–¹ css</p></li><li><p>å°†è„šæœ¬ç§»åŠ¨åˆ°åº•éƒ¨ï¼ˆåŒ…æ‹¬å†…è”çš„ï¼‰ javascript</p></li><li><p>é¿å…ä½¿ç”¨ CSS ä¸­çš„ Expressions css</p></li><li><p>å°† JavaScript å’Œ CSS ç‹¬ç«‹æˆå¤–éƒ¨æ–‡ä»¶ javascript css</p></li><li><p>å‡å°‘ DNS æŸ¥è¯¢ content</p></li><li><p>å‹ç¼© JavaScript å’Œ CSS (åŒ…æ‹¬å†…è”çš„) javascript css</p></li><li><p>é¿å…é‡å®šå‘ server</p></li><li><p>ç§»é™¤é‡å¤çš„è„šæœ¬ javascript</p></li><li><p>é…ç½®å®ä½“æ ‡ç­¾ï¼ˆETagsï¼‰ css</p></li><li><p>ä½¿ AJAX ç¼“å­˜</p></li></ol><table><thead><tr><th>ä¼˜åŒ–æ–¹å‘</th><th>ä¼˜åŒ–æ‰‹æ®µ</th></tr></thead><tbody><tr><td>è¯·æ±‚æ•°é‡</td><td>åˆå¹¶è„šæœ¬å’Œæ ·å¼è¡¨ï¼ŒCSS Spritesï¼Œæ‹†åˆ†åˆå§‹åŒ–è´Ÿè½½ï¼Œåˆ’åˆ†ä¸»åŸŸï¼Œå­—ä½“å›¾æ ‡ï¼Œé›ªç¢§å›¾ç‰‡ç­‰</td></tr><tr><td>è¯·æ±‚å¸¦å®½</td><td>å¼€å¯æœåŠ¡å™¨ GZipï¼Œç²¾ç®€ JavaScriptï¼Œç§»é™¤é‡å¤è„šæœ¬ï¼Œå›¾åƒä¼˜åŒ–ï¼ˆåŒ…æ‹¬å›¾ç‰‡å¤§å° kbï¼‰</td></tr><tr><td>ç¼“å­˜åˆ©ç”¨</td><td>ä½¿ç”¨ CDNï¼Œä½¿ç”¨å¤–éƒ¨ JavaScript å’Œ CSSï¼Œæ·»åŠ  Expires å¤´ï¼Œå‡å°‘ DNS æŸ¥æ‰¾ï¼Œé…ç½® ETagï¼Œä½¿ AjaX å¯ç¼“å­˜</td></tr><tr><td>é¡µé¢ç»“æ„</td><td>å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ï¼Œå°†è„šæœ¬æ”¾åœ¨åº•éƒ¨ï¼Œå°½æ—©åˆ·æ–°æ–‡æ¡£çš„è¾“å‡º</td></tr><tr><td>ä»£ç æ ¡éªŒ</td><td>é¿å… CSS è¡¨è¾¾å¼ï¼Œé¿å…é‡å®šå‘</td></tr></tbody></table><h2 id="ç½‘ç»œç›¸å…³"><a href="#ç½‘ç»œç›¸å…³" class="headerlink" title="ç½‘ç»œç›¸å…³"></a>ç½‘ç»œç›¸å…³</h2><h3 id="DNS-é¢„è§£æ"><a href="#DNS-é¢„è§£æ" class="headerlink" title="DNS é¢„è§£æ"></a>DNS é¢„è§£æ</h3><p>DNS è§£æä¹Ÿæ˜¯éœ€è¦æ—¶é—´çš„ï¼Œå¯ä»¥é€šè¿‡é¢„è§£æçš„æ–¹å¼æ¥é¢„å…ˆè·å¾—åŸŸåæ‰€å¯¹åº”çš„ IPã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//yuchengkai.cn"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åˆ©ç”¨ç¼“å­˜"><a href="#åˆ©ç”¨ç¼“å­˜" class="headerlink" title="åˆ©ç”¨ç¼“å­˜"></a>åˆ©ç”¨ç¼“å­˜</h3><p>ç¼“å­˜å¯¹äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–æ¥è¯´æ˜¯ä¸ªå¾ˆé‡è¦çš„ç‚¹ï¼Œè‰¯å¥½çš„ç¼“å­˜ç­–ç•¥å¯ä»¥é™ä½èµ„æºçš„é‡å¤åŠ è½½æé«˜ç½‘é¡µçš„æ•´ä½“åŠ è½½é€Ÿåº¦ã€‚</p><p>é€šå¸¸æµè§ˆå™¨ç¼“å­˜ç­–ç•¥åˆ†ä¸ºä¸¤ç§ï¼šå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜</p><h4 id="é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥"><a href="#é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥" class="headerlink" title="é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥"></a>é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥</h4><p>å¯¹äºå¤§éƒ¨åˆ†çš„åœºæ™¯éƒ½å¯ä»¥ä½¿ç”¨å¼ºç¼“å­˜é…åˆåå•†ç¼“å­˜è§£å†³ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç‰¹æ®Šçš„åœ°æ–¹å¯èƒ½éœ€è¦é€‰æ‹©ç‰¹æ®Šçš„ç¼“å­˜ç­–ç•¥</p><ul><li>å¯¹äºæŸäº›ä¸éœ€è¦ç¼“å­˜çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ <code>Cache-control: no-store</code> ï¼Œè¡¨ç¤ºè¯¥èµ„æºä¸éœ€è¦ç¼“å­˜</li><li>å¯¹äºé¢‘ç¹å˜åŠ¨çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ <code>Cache-Control: no-cache</code> å¹¶é…åˆ <code>ETag</code> ä½¿ç”¨ï¼Œè¡¨ç¤ºè¯¥èµ„æºå·²è¢«ç¼“å­˜ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½ä¼šå‘é€è¯·æ±‚è¯¢é—®èµ„æºæ˜¯å¦æ›´æ–°ã€‚</li><li>å¯¹äºä»£ç æ–‡ä»¶æ¥è¯´ï¼Œé€šå¸¸ä½¿ç”¨ <code>Cache-Control: max-age=31536000</code> å¹¶é…åˆç­–ç•¥ç¼“å­˜ä½¿ç”¨ï¼Œç„¶åå¯¹æ–‡ä»¶è¿›è¡ŒæŒ‡çº¹å¤„ç†ï¼Œä¸€æ—¦æ–‡ä»¶åå˜åŠ¨å°±ä¼šç«‹åˆ»ä¸‹è½½æ–°çš„æ–‡ä»¶ã€‚</li></ul><h3 id="ä½¿ç”¨-HTTP-2-0"><a href="#ä½¿ç”¨-HTTP-2-0" class="headerlink" title="ä½¿ç”¨ HTTP / 2.0"></a>ä½¿ç”¨ HTTP / 2.0</h3><p>å› ä¸ºæµè§ˆå™¨ä¼šæœ‰å¹¶å‘è¯·æ±‚é™åˆ¶ï¼Œåœ¨ HTTP / 1.1 æ—¶ä»£ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦å»ºç«‹å’Œæ–­å¼€ï¼Œæ¶ˆè€—äº†å¥½å‡ ä¸ª RTT æ—¶é—´ï¼Œå¹¶ä¸”ç”±äº TCP æ…¢å¯åŠ¨çš„åŸå› ï¼ŒåŠ è½½ä½“ç§¯å¤§çš„æ–‡ä»¶ä¼šéœ€è¦æ›´å¤šçš„æ—¶é—´ã€‚</p><p>åœ¨ HTTP / 2.0 ä¸­å¼•å…¥äº†å¤šè·¯å¤ç”¨ï¼Œèƒ½å¤Ÿè®©å¤šä¸ªè¯·æ±‚ä½¿ç”¨åŒä¸€ä¸ª TCP é“¾æ¥ï¼Œæå¤§çš„åŠ å¿«äº†ç½‘é¡µçš„åŠ è½½é€Ÿåº¦ã€‚å¹¶ä¸”è¿˜æ”¯æŒ Header å‹ç¼©ï¼Œè¿›ä¸€æ­¥çš„å‡å°‘äº†è¯·æ±‚çš„æ•°æ®å¤§å°ã€‚</p><h3 id="é¢„åŠ è½½-amp-æ‡’åŠ è½½"><a href="#é¢„åŠ è½½-amp-æ‡’åŠ è½½" class="headerlink" title="é¢„åŠ è½½&amp;æ‡’åŠ è½½"></a>é¢„åŠ è½½&amp;æ‡’åŠ è½½</h3><h4 id="é¢„åŠ è½½"><a href="#é¢„åŠ è½½" class="headerlink" title="é¢„åŠ è½½"></a>é¢„åŠ è½½</h4><p>åœ¨å¼€å‘ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µã€‚æœ‰äº›èµ„æºä¸éœ€è¦é©¬ä¸Šç”¨åˆ°ï¼Œä½†æ˜¯å¸Œæœ›å°½æ—©è·å–ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨é¢„åŠ è½½ã€‚</p><p>é¢„åŠ è½½å…¶å®æ˜¯å£°æ˜å¼çš„ <code>fetch</code> ï¼Œå¼ºåˆ¶æµè§ˆå™¨è¯·æ±‚èµ„æºï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡ <code>onload</code> äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å¼€å¯é¢„åŠ è½½</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"http://example.com"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>é¢„åŠ è½½å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé™ä½é¦–å±çš„åŠ è½½æ—¶é—´ï¼Œå› ä¸ºå¯ä»¥å°†ä¸€äº›ä¸å½±å“é¦–å±ä½†é‡è¦çš„æ–‡ä»¶å»¶ååŠ è½½ï¼Œå”¯ä¸€ç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§ä¸å¥½ã€‚</p><h4 id="é¢„æ¸²æŸ“"><a href="#é¢„æ¸²æŸ“" class="headerlink" title="é¢„æ¸²æŸ“"></a>é¢„æ¸²æŸ“</h4><p>å¯ä»¥é€šè¿‡é¢„æ¸²æŸ“å°†ä¸‹è½½çš„æ–‡ä»¶é¢„å…ˆåœ¨åå°æ¸²æŸ“ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å¼€å¯é¢„æ¸²æŸ“</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"prerender"</span> <span class="attr">href</span>=<span class="string">"http://example.com"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>é¢„æ¸²æŸ“è™½ç„¶å¯ä»¥æé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä½†æ˜¯è¦ç¡®ä¿è¯¥é¡µé¢ç™¾åˆ†ç™¾ä¼šè¢«ç”¨æˆ·åœ¨ä¹‹åæ‰“å¼€ï¼Œå¦åˆ™å°±ç™½ç™½æµªè´¹èµ„æºå»æ¸²æŸ“ã€‚</p><h4 id="æ‡’æ‰§è¡Œ"><a href="#æ‡’æ‰§è¡Œ" class="headerlink" title="æ‡’æ‰§è¡Œ"></a>æ‡’æ‰§è¡Œ</h4><p>æ‡’æ‰§è¡Œå°±æ˜¯å°†æŸäº›é€»è¾‘å»¶è¿Ÿåˆ°ä½¿ç”¨æ—¶å†è®¡ç®—ã€‚è¯¥æŠ€æœ¯å¯ä»¥ç”¨äºé¦–å±ä¼˜åŒ–ï¼Œå¯¹äºæŸäº›è€—æ—¶é€»è¾‘å¹¶ä¸éœ€è¦åœ¨é¦–å±å°±ä½¿ç”¨çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨æ‡’æ‰§è¡Œã€‚æ‡’æ‰§è¡Œéœ€è¦å”¤é†’ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡å®šæ—¶å™¨æˆ–è€…äº‹ä»¶çš„è°ƒç”¨æ¥å”¤é†’ã€‚</p><h4 id="æ‡’åŠ è½½"><a href="#æ‡’åŠ è½½" class="headerlink" title="æ‡’åŠ è½½"></a>æ‡’åŠ è½½</h4><p>æ‡’åŠ è½½å°±æ˜¯å°†ä¸å…³é”®çš„èµ„æºå»¶ååŠ è½½ã€‚</p><p>æ‡’åŠ è½½çš„åŸç†å°±æ˜¯åªåŠ è½½è‡ªå®šä¹‰åŒºåŸŸï¼ˆé€šå¸¸æ˜¯å¯è§†åŒºåŸŸï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å³å°†è¿›å…¥å¯è§†åŒºåŸŸï¼‰å†…éœ€è¦åŠ è½½çš„ä¸œè¥¿ã€‚å¯¹äºå›¾ç‰‡æ¥è¯´ï¼Œå…ˆè®¾ç½®å›¾ç‰‡æ ‡ç­¾çš„ <code>src</code> å±æ€§ä¸ºä¸€å¼ å ä½å›¾ï¼Œå°†çœŸå®çš„å›¾ç‰‡èµ„æºæ”¾å…¥ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ä¸­ï¼Œå½“è¿›å…¥è‡ªå®šä¹‰åŒºåŸŸæ—¶ï¼Œå°±å°†è‡ªå®šä¹‰å±æ€§æ›¿æ¢ä¸º <code>src</code> å±æ€§ï¼Œè¿™æ ·å›¾ç‰‡å°±ä¼šå»ä¸‹è½½èµ„æºï¼Œå®ç°äº†å›¾ç‰‡æ‡’åŠ è½½ã€‚</p><p>æ‡’åŠ è½½ä¸ä»…å¯ä»¥ç”¨äºå›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨åˆ«çš„èµ„æºä¸Šã€‚æ¯”å¦‚è¿›å…¥å¯è§†åŒºåŸŸæ‰å¼€å§‹æ’­æ”¾è§†é¢‘ç­‰ç­‰ã€‚</p><h2 id="æ–‡ä»¶ä¼˜åŒ–"><a href="#æ–‡ä»¶ä¼˜åŒ–" class="headerlink" title="æ–‡ä»¶ä¼˜åŒ–"></a>æ–‡ä»¶ä¼˜åŒ–</h2><h3 id="å›¾ç‰‡ä¼˜åŒ–"><a href="#å›¾ç‰‡ä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡ä¼˜åŒ–"></a>å›¾ç‰‡ä¼˜åŒ–</h3><h4 id="å›¾ç‰‡å¤§å°è®¡ç®—"><a href="#å›¾ç‰‡å¤§å°è®¡ç®—" class="headerlink" title="å›¾ç‰‡å¤§å°è®¡ç®—"></a>å›¾ç‰‡å¤§å°è®¡ç®—</h4><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä¸€å¼ å›¾ç‰‡å¯èƒ½å¹¶ä¸éœ€è¦ä½¿ç”¨é‚£ä¹ˆå¤šé¢œè‰²å»æ˜¾ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡å°‘æ¯ä¸ªåƒç´ çš„è°ƒè‰²æ¿æ¥ç›¸åº”ç¼©å°å›¾ç‰‡çš„å¤§å°ã€‚</p><p>äº†è§£äº†å¦‚ä½•è®¡ç®—å›¾ç‰‡å¤§å°çš„çŸ¥è¯†ï¼Œé‚£ä¹ˆå¯¹äºå¦‚ä½•ä¼˜åŒ–å›¾ç‰‡ï¼Œæƒ³å¿…å¤§å®¶å·²ç»æœ‰ 2 ä¸ªæ€è·¯äº†ï¼š</p><ul><li>å‡å°‘åƒç´ ç‚¹</li><li>å‡å°‘æ¯ä¸ªåƒç´ ç‚¹èƒ½å¤Ÿæ˜¾ç¤ºçš„é¢œè‰²</li></ul><h4 id="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"><a href="#å›¾ç‰‡åŠ è½½ä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"></a>å›¾ç‰‡åŠ è½½ä¼˜åŒ–</h4><ol><li>ä¸ç”¨å›¾ç‰‡ã€‚å¾ˆå¤šæ—¶å€™ä¼šä½¿ç”¨åˆ°å¾ˆå¤šä¿®é¥°ç±»å›¾ç‰‡ï¼Œå…¶å®è¿™ç±»ä¿®é¥°å›¾ç‰‡å®Œå…¨å¯ä»¥ç”¨ CSS å»ä»£æ›¿ã€‚</li><li>å¯¹äºç§»åŠ¨ç«¯æ¥è¯´ï¼Œå±å¹•å®½åº¦å°±é‚£ä¹ˆç‚¹ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦å»åŠ è½½åŸå›¾æµªè´¹å¸¦å®½ã€‚ä¸€èˆ¬å›¾ç‰‡éƒ½ç”¨ CDN åŠ è½½ï¼Œå¯ä»¥è®¡ç®—å‡ºé€‚é…å±å¹•çš„å®½åº¦ï¼Œç„¶åå»è¯·æ±‚ç›¸åº”è£å‰ªå¥½çš„å›¾ç‰‡ã€‚</li><li>å°å›¾ä½¿ç”¨ base64 æ ¼å¼</li><li>å°†å¤šä¸ªå›¾æ ‡æ–‡ä»¶æ•´åˆåˆ°ä¸€å¼ å›¾ç‰‡ä¸­ï¼ˆé›ªç¢§å›¾ï¼‰</li><li>é€‰æ‹©æ­£ç¡®çš„å›¾ç‰‡æ ¼å¼ï¼š<ul><li>å¯¹äºèƒ½å¤Ÿæ˜¾ç¤º WebP æ ¼å¼çš„æµè§ˆå™¨å°½é‡ä½¿ç”¨ WebP æ ¼å¼ã€‚å› ä¸º WebP æ ¼å¼å…·æœ‰æ›´å¥½çš„å›¾åƒæ•°æ®å‹ç¼©ç®—æ³•ï¼Œèƒ½å¸¦æ¥æ›´å°çš„å›¾ç‰‡ä½“ç§¯ï¼Œè€Œä¸”æ‹¥æœ‰è‚‰çœ¼è¯†åˆ«æ— å·®å¼‚çš„å›¾åƒè´¨é‡ï¼Œç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§å¹¶ä¸å¥½</li><li>å°å›¾ä½¿ç”¨ PNGï¼Œå…¶å®å¯¹äºå¤§éƒ¨åˆ†å›¾æ ‡è¿™ç±»å›¾ç‰‡ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ SVG ä»£æ›¿</li><li>ç…§ç‰‡ä½¿ç”¨ JPEG</li></ul></li></ol><h3 id="å…¶ä»–æ–‡ä»¶ä¼˜åŒ–"><a href="#å…¶ä»–æ–‡ä»¶ä¼˜åŒ–" class="headerlink" title="å…¶ä»–æ–‡ä»¶ä¼˜åŒ–"></a>å…¶ä»–æ–‡ä»¶ä¼˜åŒ–</h3><ul><li>CSS æ–‡ä»¶æ”¾åœ¨ <code>head</code> ä¸­</li><li>æœåŠ¡ç«¯å¼€å¯æ–‡ä»¶å‹ç¼©åŠŸèƒ½</li><li>å°† <code>script</code> æ ‡ç­¾æ”¾åœ¨ <code>body</code> åº•éƒ¨ï¼Œå› ä¸º JS æ–‡ä»¶æ‰§è¡Œä¼šé˜»å¡æ¸²æŸ“ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æŠŠ <code>script</code> æ ‡ç­¾æ”¾åœ¨ä»»æ„ä½ç½®ç„¶ååŠ ä¸Š <code>defer</code> ï¼Œè¡¨ç¤ºè¯¥æ–‡ä»¶ä¼šå¹¶è¡Œä¸‹è½½ï¼Œä½†æ˜¯ä¼šæ”¾åˆ° HTML è§£æå®Œæˆåé¡ºåºæ‰§è¡Œã€‚å¯¹äºæ²¡æœ‰ä»»ä½•ä¾èµ–çš„ JS æ–‡ä»¶å¯ä»¥åŠ ä¸Š <code>async</code> ï¼Œè¡¨ç¤ºåŠ è½½å’Œæ¸²æŸ“åç»­æ–‡æ¡£å…ƒç´ çš„è¿‡ç¨‹å°†å’Œ JS æ–‡ä»¶çš„åŠ è½½ä¸æ‰§è¡Œå¹¶è¡Œæ— åºè¿›è¡Œã€‚</li><li>æ‰§è¡Œ JS ä»£ç è¿‡é•¿ä¼šå¡ä½æ¸²æŸ“ï¼Œå¯¹äºéœ€è¦å¾ˆå¤šæ—¶é—´è®¡ç®—çš„ä»£ç å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>Webworker</code>ã€‚<code>Webworker</code> å¯ä»¥è®©æˆ‘ä»¬å¦å¼€ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè„šæœ¬è€Œä¸å½±å“æ¸²æŸ“ã€‚</li></ul><h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><blockquote><p>CDN çš„å…¨ç§°æ˜¯ Content Delivery Networkï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚CDN æ˜¯æ„å»ºåœ¨ç½‘ç»œä¹‹ä¸Šçš„å†…å®¹åˆ†å‘ç½‘ç»œï¼Œä¾é éƒ¨ç½²åœ¨å„åœ°çš„è¾¹ç¼˜æœåŠ¡å™¨ï¼Œé€šè¿‡ä¸­å¿ƒå¹³å°çš„è´Ÿè½½å‡è¡¡ã€å†…å®¹åˆ†å‘ã€è°ƒåº¦ç­‰åŠŸèƒ½æ¨¡å—ï¼Œä½¿ç”¨æˆ·å°±è¿‘è·å–æ‰€éœ€å†…å®¹ï¼Œé™ä½ç½‘ç»œæ‹¥å¡ï¼Œæé«˜ç”¨æˆ·è®¿é—®å“åº”é€Ÿåº¦å’Œå‘½ä¸­ç‡ã€‚CDN çš„å…³é”®æŠ€æœ¯ä¸»è¦æœ‰å†…å®¹å­˜å‚¨å’Œåˆ†å‘æŠ€æœ¯ã€‚â€”â€” ç§‘å­¦ç™¾ç§‘</p></blockquote><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6p436ax42j30ia09l74f.jpg" alt="img"></p><h4 id="CDN-å­˜åœ¨çš„æ„ä¹‰"><a href="#CDN-å­˜åœ¨çš„æ„ä¹‰" class="headerlink" title="CDN å­˜åœ¨çš„æ„ä¹‰"></a>CDN å­˜åœ¨çš„æ„ä¹‰</h4><p>ä¸ºäº†ä¸è®©ç½‘ç»œæ‹¥å¡æˆä¸ºäº’è”ç½‘å‘å±•çš„éšœç¢ã€‚</p><h4 id="CDN-çš„ä¼˜åŠ¿"><a href="#CDN-çš„ä¼˜åŠ¿" class="headerlink" title="CDN çš„ä¼˜åŠ¿"></a>CDN çš„ä¼˜åŠ¿</h4><ol><li>CDN èŠ‚ç‚¹è§£å†³äº†è·¨è¿è¥å•†å’Œè·¨åœ°åŸŸè®¿é—®çš„é—®é¢˜ï¼Œè®¿é—®å»¶æ—¶å¤§å¤§é™ä½ï¼›</li><li>å¤§éƒ¨åˆ†è¯·æ±‚åœ¨ CDN è¾¹ç¼˜èŠ‚ç‚¹å®Œæˆï¼ŒCDN èµ·åˆ°äº†åˆ†æµä½œç”¨ï¼Œå‡è½»äº†æºç«™çš„è´Ÿè½½ï¼›</li><li>é™ä½â€œå¹¿æ’­é£æš´â€çš„å½±å“ï¼Œæé«˜ç½‘ç»œè®¿é—®çš„ç¨³å®šæ€§ï¼›èŠ‚çœéª¨å¹²ç½‘å¸¦å®½ï¼Œå‡å°‘å¸¦å®½éœ€æ±‚é‡ã€‚</li></ol><h4 id="CDN-çš„æ ¸å¿ƒç‚¹"><a href="#CDN-çš„æ ¸å¿ƒç‚¹" class="headerlink" title="CDN çš„æ ¸å¿ƒç‚¹"></a>CDN çš„æ ¸å¿ƒç‚¹</h4><ul><li><p>ç¼“å­˜ï¼šå°†ä»æ ¹æœåŠ¡å™¨è¯·æ±‚æ¥çš„èµ„æºæŒ‰è¦æ±‚ç¼“å­˜ã€‚</p></li><li><p>å›æºï¼šå½“æœ‰ç”¨æˆ·è®¿é—®æŸä¸ªèµ„æºçš„æ—¶å€™ï¼Œå¦‚æœè¢«è§£æåˆ°çš„é‚£ä¸ª CDN èŠ‚ç‚¹æ²¡æœ‰ç¼“å­˜å“åº”çš„å†…å®¹ï¼Œæˆ–è€…æ˜¯ç¼“å­˜å·²ç»åˆ°æœŸï¼Œå°±ä¼šå›æºç«™å»è·å–ã€‚æ²¡æœ‰äººè®¿é—®ï¼ŒCDN èŠ‚ç‚¹ä¸ä¼šä¸»åŠ¨å»æºç«™è¯·æ±‚èµ„æºã€‚</p></li></ul><h4 id="å…³é”®æŠ€æœ¯"><a href="#å…³é”®æŠ€æœ¯" class="headerlink" title="å…³é”®æŠ€æœ¯"></a>å…³é”®æŠ€æœ¯</h4><ol><li>å†…å®¹å‘å¸ƒï¼šå®ƒå€ŸåŠ©äºå»ºç«‹ç´¢å¼•ã€ç¼“å­˜ã€æµåˆ†è£‚ã€ç»„æ’­ï¼ˆMulticastï¼‰ç­‰æŠ€æœ¯ï¼Œå°†å†…å®¹å‘å¸ƒæˆ–æŠ•é€’åˆ°è·ç¦»ç”¨æˆ·æœ€è¿‘çš„è¿œç¨‹æœåŠ¡ç‚¹ï¼ˆPOPï¼‰å¤„ï¼›</li><li>å†…å®¹è·¯ç”±ï¼šå®ƒæ˜¯æ•´ä½“æ€§çš„ç½‘ç»œè´Ÿè½½å‡è¡¡æŠ€æœ¯ï¼Œé€šè¿‡å†…å®¹è·¯ç”±å™¨ä¸­çš„é‡å®šå‘ï¼ˆDNSï¼‰æœºåˆ¶ï¼Œåœ¨å¤šä¸ªè¿œç¨‹ POP ä¸Šå‡è¡¡ç”¨æˆ·çš„è¯·æ±‚ï¼Œä»¥ä½¿ç”¨æˆ·è¯·æ±‚å¾—åˆ°æœ€è¿‘å†…å®¹æºçš„å“åº”ï¼›</li><li>å†…å®¹äº¤æ¢ï¼šå®ƒæ ¹æ®å†…å®¹çš„å¯ç”¨æ€§ã€æœåŠ¡å™¨çš„å¯ç”¨æ€§ä»¥åŠç”¨æˆ·çš„èƒŒæ™¯ï¼Œåœ¨ POP çš„ç¼“å­˜æœåŠ¡å™¨ä¸Šï¼Œåˆ©ç”¨åº”ç”¨å±‚äº¤æ¢ã€æµåˆ†è£‚ã€é‡å®šå‘ï¼ˆICPã€WCCPï¼‰ç­‰æŠ€æœ¯ï¼Œæ™ºèƒ½åœ°å¹³è¡¡è´Ÿè½½æµé‡ï¼›</li><li>æ€§èƒ½ç®¡ç†ï¼šå®ƒé€šè¿‡å†…éƒ¨å’Œå¤–éƒ¨ç›‘æ§ç³»ç»Ÿï¼Œè·å–ç½‘ç»œéƒ¨ä»¶çš„çŠ¶å†µä¿¡æ¯ï¼Œæµ‹é‡å†…å®¹å‘å¸ƒçš„ç«¯åˆ°ç«¯æ€§èƒ½ï¼ˆå¦‚åŒ…ä¸¢å¤±ã€å»¶æ—¶ã€å¹³å‡å¸¦å®½ã€å¯åŠ¨æ—¶é—´ã€å¸§é€Ÿç‡ç­‰ï¼‰ï¼Œä¿è¯ç½‘ç»œå¤„äºæœ€ä½³çš„è¿è¡ŒçŠ¶æ€ã€‚</li></ol><h4 id="CDN-amp-é™æ€èµ„æº"><a href="#CDN-amp-é™æ€èµ„æº" class="headerlink" title="CDN &amp; é™æ€èµ„æº"></a>CDN &amp; é™æ€èµ„æº</h4><p>é™æ€èµ„æºæœ¬èº«å…·æœ‰è®¿é—®é¢‘ç‡é«˜ã€æ‰¿æ¥æµé‡å¤§çš„ç‰¹ç‚¹ï¼Œå› æ­¤é™æ€èµ„æºåŠ è½½é€Ÿåº¦å§‹ç»ˆæ˜¯å‰ç«¯æ€§èƒ½çš„ä¸€ä¸ªéå¸¸å…³é”®çš„æŒ‡æ ‡ã€‚CDN æ˜¯é™æ€èµ„æºæé€Ÿçš„é‡è¦æ‰‹æ®µã€‚</p><p>é™æ€èµ„æºå°½é‡ä½¿ç”¨ CDN åŠ è½½ï¼Œç”±äºæµè§ˆå™¨å¯¹äºå•ä¸ªåŸŸåæœ‰å¹¶å‘è¯·æ±‚ä¸Šé™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤šä¸ª CDN åŸŸåã€‚å¯¹äº CDN åŠ è½½é™æ€èµ„æºéœ€è¦æ³¨æ„ CDN åŸŸåè¦ä¸ä¸»ç«™ä¸åŒï¼Œå¦åˆ™æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå¸¦ä¸Šä¸»ç«™çš„ Cookieã€‚</p><h2 id="å…¶ä»–ä¼˜åŒ–"><a href="#å…¶ä»–ä¼˜åŒ–" class="headerlink" title="å…¶ä»–ä¼˜åŒ–"></a>å…¶ä»–ä¼˜åŒ–</h2><h3 id="ä½¿ç”¨-Webpack-ä¼˜åŒ–é¡¹ç›®"><a href="#ä½¿ç”¨-Webpack-ä¼˜åŒ–é¡¹ç›®" class="headerlink" title="ä½¿ç”¨ Webpack ä¼˜åŒ–é¡¹ç›®"></a>ä½¿ç”¨ Webpack ä¼˜åŒ–é¡¹ç›®</h3><ul><li>å¯¹äº Webpack4ï¼Œæ‰“åŒ…é¡¹ç›®ä½¿ç”¨ production æ¨¡å¼ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨å¼€å¯ä»£ç å‹ç¼©</li><li>ä½¿ç”¨ ES6 æ¨¡å—æ¥å¼€å¯ tree shakingï¼Œè¿™ä¸ªæŠ€æœ¯å¯ä»¥ç§»é™¤æ²¡æœ‰ä½¿ç”¨çš„ä»£ç </li><li>ä¼˜åŒ–å›¾ç‰‡ï¼Œå¯¹äºå°å›¾å¯ä»¥ä½¿ç”¨ base64 çš„æ–¹å¼å†™å…¥æ–‡ä»¶ä¸­</li><li>æŒ‰ç…§è·¯ç”±æ‹†åˆ†ä»£ç ï¼Œå®ç°æŒ‰éœ€åŠ è½½</li><li>ç»™æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åæ·»åŠ å“ˆå¸Œï¼Œå®ç°æµè§ˆå™¨ç¼“å­˜æ–‡ä»¶</li></ul><h3 id="ç›‘æ§"><a href="#ç›‘æ§" class="headerlink" title="ç›‘æ§"></a>ç›‘æ§</h3><p>å¯¹äºä»£ç è¿è¡Œé”™è¯¯ï¼Œé€šå¸¸çš„åŠæ³•æ˜¯ä½¿ç”¨ <code>window.onerror</code> æ‹¦æˆªæŠ¥é”™ã€‚è¯¥æ–¹æ³•èƒ½æ‹¦æˆªåˆ°å¤§éƒ¨åˆ†çš„è¯¦ç»†æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–</p><ul><li>å¯¹äºè·¨åŸŸçš„ä»£ç è¿è¡Œé”™è¯¯ä¼šæ˜¾ç¤º <code>Script error.</code> å¯¹äºè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦ç»™ <code>script</code> æ ‡ç­¾æ·»åŠ  <code>crossorigin</code> å±æ€§</li><li>å¯¹äºæŸäº›æµè§ˆå™¨å¯èƒ½ä¸ä¼šæ˜¾ç¤ºè°ƒç”¨æ ˆä¿¡æ¯ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡ <code>arguments.callee.caller</code> æ¥åšæ ˆé€’å½’</li></ul><p>å¯¹äºå¼‚æ­¥ä»£ç æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ <code>catch</code> çš„æ–¹å¼æ•è·é”™è¯¯ã€‚æ¯”å¦‚ <code>Promise</code> å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>catch</code> å‡½æ•°ï¼Œ<code>async await</code> å¯ä»¥ä½¿ç”¨ <code>try catch</code></p><p>ä½†æ˜¯è¦æ³¨æ„çº¿ä¸Šè¿è¡Œçš„ä»£ç éƒ½æ˜¯å‹ç¼©è¿‡çš„ï¼Œéœ€è¦åœ¨æ‰“åŒ…æ—¶ç”Ÿæˆ sourceMap æ–‡ä»¶ä¾¿äº debugã€‚</p><p>å¯¹äºæ•è·çš„é”™è¯¯éœ€è¦ä¸Šä¼ ç»™æœåŠ¡å™¨ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ <code>img</code> æ ‡ç­¾çš„ <code>src</code> å‘èµ·ä¸€ä¸ªè¯·æ±‚ã€‚</p><h2 id="å¦‚ä½•ä¼˜åŒ–ç¬¬äºŒæ¬¡åŠ è½½é€Ÿåº¦ï¼Ÿï¼ˆå¢é‡åŠ è½½ï¼‰"><a href="#å¦‚ä½•ä¼˜åŒ–ç¬¬äºŒæ¬¡åŠ è½½é€Ÿåº¦ï¼Ÿï¼ˆå¢é‡åŠ è½½ï¼‰" class="headerlink" title="å¦‚ä½•ä¼˜åŒ–ç¬¬äºŒæ¬¡åŠ è½½é€Ÿåº¦ï¼Ÿï¼ˆå¢é‡åŠ è½½ï¼‰"></a>å¦‚ä½•ä¼˜åŒ–ç¬¬äºŒæ¬¡åŠ è½½é€Ÿåº¦ï¼Ÿï¼ˆå¢é‡åŠ è½½ï¼‰</h2><p><a href="https://juejin.im/post/5d00820b5188255ee806a1c7" target="_blank" rel="noopener">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ä¸‰éƒ¨æ›²(åŠ è½½ç¯‡)</a></p><p><a href="https://juejin.im/entry/599403656fb9a0247f4f2ee3" target="_blank" rel="noopener">ç§»åŠ¨ H5 é¦–å±ç§’å¼€ä¼˜åŒ–æ–¹æ¡ˆæ¢è®¨</a></p><ol><li><strong>é™ä½è¯·æ±‚é‡ï¼š</strong>åˆå¹¶èµ„æºï¼Œå‡å°‘ HTTP è¯·æ±‚æ•°ï¼Œminify / gzip å‹ç¼©ï¼ŒwebPï¼ŒlazyLoadã€‚</li><li><strong>åŠ å¿«è¯·æ±‚é€Ÿåº¦ï¼š</strong>é¢„è§£æ DNSï¼Œå‡å°‘åŸŸåæ•°ï¼Œå¹¶è¡ŒåŠ è½½ï¼ŒCDN åˆ†å‘ã€‚</li><li><strong>ç¼“å­˜ï¼š</strong>HTTP åè®®ç¼“å­˜è¯·æ±‚ï¼Œç¦»çº¿ç¼“å­˜ manifestï¼Œç¦»çº¿æ•°æ®ç¼“å­˜ localStorageã€‚</li><li><strong>æ¸²æŸ“ï¼š</strong>JS/CSS ä¼˜åŒ–ï¼ŒåŠ è½½é¡ºåºï¼ŒæœåŠ¡ç«¯æ¸²æŸ“ï¼Œpipelineã€‚</li></ol><p>å…¶ä¸­å¯¹é¦–å±å¯åŠ¨é€Ÿåº¦å½±å“æœ€å¤§çš„å°±æ˜¯ç½‘ç»œè¯·æ±‚ï¼Œæ‰€ä»¥ä¼˜åŒ–çš„é‡ç‚¹å°±æ˜¯ç¼“å­˜</p><p><strong>å¢é‡å¼æ›´æ–°â€</strong>çš„è§£å†³æ–¹æ¡ˆï¼Œç®€å•åœ°è¯´å°±æ˜¯åœ¨ç‰ˆæœ¬æ›´æ–°çš„æ—¶å€™ä¸éœ€è¦é‡æ–°åŠ è½½èµ„æºï¼Œåªéœ€è¦åŠ è½½ä¸€æ®µå¾ˆå°çš„ diff ä¿¡æ¯ï¼Œç„¶ååˆå¹¶åˆ°å½“å‰èµ„æºä¸Šï¼Œç±»ä¼¼ git merge çš„æ•ˆæœã€‚</p><p>å¢é‡åŠ è½½çš„ä¸€ç§æ€è·¯ï¼š</p><p>1ã€ç”¨æˆ·ç«¯ä½¿ç”¨ LocalStorage æˆ–è€…å…¶å®ƒå‚¨å­˜æ–¹æ¡ˆï¼Œå­˜å‚¨ä¸€ä»½åŸå§‹ä»£ç +æ—¶é—´æˆ³ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    timeStamp: &quot;20161026xxxxxx&quot;,</span><br><span class="line">    data: &quot;aaabbbccc&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€æ¯æ¬¡åŠ è½½èµ„æºçš„æ—¶å€™å‘æœåŠ¡å™¨å‘é€è¿™ä¸ªæ—¶é—´æˆ³ï¼›</p><p>3ã€æœåŠ¡å™¨ä»æ¥å—åˆ°æ—¶é—´æˆ³ä¸­è¯†åˆ«å‡ºå®¢æˆ·ç«¯çš„ç‰ˆæœ¬ï¼Œå’Œæœ€æ–°çš„ç‰ˆæœ¬åšä¸€æ¬¡ diffï¼Œè¿”å›ä¸¤è€…çš„ diff ä¿¡æ¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">diff(<span class="string">"aaabbbccc"</span>, <span class="string">"aaagggccc"</span>);</span><br><span class="line"><span class="comment">// å‡è®¾æˆ‘ä»¬çš„diffä¿¡æ¯è¿™æ ·è¡¨ç¤ºï¼š</span></span><br><span class="line"><span class="comment">// [3, "-3", "+ggg", 3]</span></span><br></pre></td></tr></table></figure><p>4ã€å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿™ä¸ª diff ä¿¡æ¯ä¹‹åï¼ŒæŠŠæœ¬åœ°èµ„æºå’Œæ—¶é—´æˆ³æ›´æ–°åˆ°æœ€æ–°ï¼Œå®ç°ä¸€æ¬¡å¢é‡æ›´æ–°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mergeDiff(<span class="string">"aaabbbccc"</span>, [<span class="number">3</span>, <span class="string">"-3"</span>, <span class="string">"+ggg"</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="comment">//=&gt; "aaagggccc"</span></span><br></pre></td></tr></table></figure><h2 id="é¢è¯•é¢˜ï¼ˆå¦‚ä½•æ¸²æŸ“å‡ ä¸‡æ¡æ•°æ®å¹¶ä¸å¡ä½ç•Œï¼‰"><a href="#é¢è¯•é¢˜ï¼ˆå¦‚ä½•æ¸²æŸ“å‡ ä¸‡æ¡æ•°æ®å¹¶ä¸å¡ä½ç•Œï¼‰" class="headerlink" title="é¢è¯•é¢˜ï¼ˆå¦‚ä½•æ¸²æŸ“å‡ ä¸‡æ¡æ•°æ®å¹¶ä¸å¡ä½ç•Œï¼‰"></a>é¢è¯•é¢˜ï¼ˆå¦‚ä½•æ¸²æŸ“å‡ ä¸‡æ¡æ•°æ®å¹¶ä¸å¡ä½ç•Œï¼‰</h2><p>è¿™é“é¢˜è€ƒå¯Ÿäº†å¦‚ä½•åœ¨ä¸å¡ä½é¡µé¢çš„æƒ…å†µä¸‹æ¸²æŸ“æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ä¸€æ¬¡æ€§å°†å‡ ä¸‡æ¡éƒ½æ¸²æŸ“å‡ºæ¥ï¼Œè€Œåº”è¯¥ä¸€æ¬¡æ¸²æŸ“éƒ¨åˆ† DOMï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ <code>requestAnimationFrame</code> æ¥æ¯ 16 ms åˆ·æ–°ä¸€æ¬¡ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      æ§ä»¶</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// æ’å…¥åä¸‡æ¡æ•°æ®</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> total = <span class="number">100000</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// ä¸€æ¬¡æ’å…¥ 20 æ¡ï¼Œå¦‚æœè§‰å¾—æ€§èƒ½ä¸å¥½å°±å‡å°‘</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> once = <span class="number">20</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// æ¸²æŸ“æ•°æ®æ€»å…±éœ€è¦å‡ æ¬¡</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> loopCount = total / once;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> countOfRender = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> ul = <span class="built_in">document</span>.querySelector(<span class="string">"ul"</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// ä¼˜åŒ–æ€§èƒ½ï¼Œæ’å…¥ä¸ä¼šé€ æˆå›æµ</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> fragment = <span class="built_in">document</span>.createDocumentFragment();</span></span><br><span class="line"><span class="javascript">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; once; i++) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> li = <span class="built_in">document</span>.createElement(<span class="string">"li"</span>);</span></span><br><span class="line"><span class="javascript">            li.innerText = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * total);</span></span><br><span class="line">            fragment.appendChild(li);</span><br><span class="line">          &#125;</span><br><span class="line">          ul.appendChild(fragment);</span><br><span class="line">          countOfRender += 1;</span><br><span class="line"><span class="vbscript">          <span class="keyword">loop</span>();</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">if</span> (countOfRender &lt; loopCount) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.requestAnimationFrame(add);</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="vbscript">        <span class="keyword">loop</span>();</span></span><br><span class="line">      &#125;, 0);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ‹“å±•çŸ¥è¯†ä¹‹-Gzip"><a href="#æ‹“å±•çŸ¥è¯†ä¹‹-Gzip" class="headerlink" title="æ‹“å±•çŸ¥è¯†ä¹‹ Gzip"></a>æ‹“å±•çŸ¥è¯†ä¹‹ Gzip</h2><h3 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h3><p>gzip æ˜¯ GNUzip çš„ç¼©å†™ï¼Œæœ€æ—©ç”¨äº UNIX ç³»ç»Ÿçš„æ–‡ä»¶å‹ç¼©ã€‚HTTP åè®®ä¸Šçš„ gzip ç¼–ç æ˜¯ä¸€ç§ç”¨æ¥æ”¹è¿› web åº”ç”¨ç¨‹åºæ€§èƒ½çš„æŠ€æœ¯ï¼Œweb æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å¿…é¡»å…±åŒæ”¯æŒ gzipã€‚ç›®å‰ä¸»æµçš„æµè§ˆå™¨ï¼ŒChrome,firefox,IE ç­‰éƒ½æ”¯æŒè¯¥åè®®ã€‚å¸¸è§çš„æœåŠ¡å™¨å¦‚ Apacheï¼ŒNginxï¼ŒIIS åŒæ ·æ”¯æŒ gzipã€‚</p><p>gzip å‹ç¼©æ¯”ç‡åœ¨ 3 åˆ° 10 å€å·¦å³ï¼Œå¯ä»¥å¤§å¤§èŠ‚çœæœåŠ¡å™¨çš„ç½‘ç»œå¸¦å®½ã€‚è€Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¹¶ä¸æ˜¯å¯¹æ‰€æœ‰æ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œé€šå¸¸åªæ˜¯å‹ç¼©é™æ€æ–‡ä»¶ã€‚</p><h3 id="gzip-å·¥ä½œåŸç†ï¼š"><a href="#gzip-å·¥ä½œåŸç†ï¼š" class="headerlink" title="gzip å·¥ä½œåŸç†ï¼š"></a>gzip å·¥ä½œåŸç†ï¼š</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6sjepqxiaj30go0bcaa9.jpg" alt="img"></p><ol><li>æµè§ˆå™¨è¯·æ±‚ urlï¼Œå¹¶åœ¨ request header ä¸­è®¾ç½®å±æ€§ accept-encoding:gzipã€‚è¡¨æ˜æµè§ˆå™¨æ”¯æŒ gzipã€‚</li><li>æœåŠ¡å™¨æ”¶åˆ°æµè§ˆå™¨å‘é€çš„è¯·æ±‚ä¹‹åï¼Œåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒ gzipï¼Œå¦‚æœæ”¯æŒ gzipï¼Œåˆ™å‘æµè§ˆå™¨ä¼ é€å‹ç¼©è¿‡çš„å†…å®¹ï¼Œä¸æ”¯æŒåˆ™å‘æµè§ˆå™¨å‘é€æœªç»å‹ç¼©çš„å†…å®¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½æ”¯æŒ gzipï¼Œresponse headers è¿”å›åŒ…å« content-encoding:gzipã€‚</li><li>æµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨çš„å“åº”ä¹‹ååˆ¤æ–­å†…å®¹æ˜¯å¦è¢«å‹ç¼©ï¼Œå¦‚æœè¢«å‹ç¼©åˆ™è§£å‹ç¼©æ˜¾ç¤ºé¡µé¢å†…å®¹ã€‚</li></ol><h3 id="Nginx-ä¸­å¼€å¯-gzip"><a href="#Nginx-ä¸­å¼€å¯-gzip" class="headerlink" title="Nginx ä¸­å¼€å¯ gzip"></a>Nginx ä¸­å¼€å¯ gzip</h3><p>å¦‚æœæœåŠ¡ç«¯æ¥å£ä½¿ç”¨ nodejs å’Œ expressï¼Œé‚£ä¹ˆå¼€å¯ nginx éå¸¸ç®€å•ã€‚å¯ç”¨ compress() ä¸­é—´ä»¶å³å¯å¹¶åœ¨ nginx.conf ä¸­æ·»åŠ  gzip é…ç½®é¡¹å³å¯ï¼Œexpress.compress() gzip å‹ç¼©ä¸­é—´ä»¶ï¼Œé€šè¿‡ filter å‡½æ•°è®¾ç½®éœ€è¦å‹ç¼©çš„æ–‡ä»¶ç±»å‹ã€‚å‹ç¼©ç®—æ³•ä¸º gzip/deflateã€‚è¿™ä¸ªä¸­é—´ä»¶åº”è¯¥æ”¾ç½®åœ¨æ‰€æœ‰çš„ä¸­é—´ä»¶æœ€å‰é¢ä»¥ä¿è¯æ‰€æœ‰çš„è¿”å›éƒ½æ˜¯è¢«å‹ç¼©çš„ã€‚å¦‚æœä½¿ç”¨ java å¼€å‘ï¼Œéœ€è¦é…ç½® filterã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6sjg93f23j30go03eq2v.jpg" alt="img"></p><p>æ·»åŠ å®Œå‚æ•°åï¼Œè¿è¡Œ nginx â€“t æ£€æŸ¥ä¸€ä¸‹è¯­æ³•ï¼Œè‹¥è¯­æ³•æ£€æµ‹é€šè¿‡ï¼Œåˆ™å¼€å§‹è®¿é—® url æ£€æµ‹ gzip æ˜¯å¦æ·»åŠ æˆåŠŸã€‚</p><ol><li>gzip onï¼šå¼€å¯ gzipã€‚</li><li>gzip_comp_levelï¼šgzip å‹ç¼©æ¯”ã€‚</li><li>gzip_min_lengthï¼šå…è®¸è¢«å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ã€‚</li><li>gzip_typesï¼šåŒ¹é… MIME ç±»å‹è¿›è¡Œå‹ç¼©ï¼Œtext/html é»˜è®¤è¢«å‹ç¼©ã€‚</li></ol><h3 id="æ£€æµ‹-gzip-æ˜¯å¦å¼€å¯"><a href="#æ£€æµ‹-gzip-æ˜¯å¦å¼€å¯" class="headerlink" title="æ£€æµ‹ gzip æ˜¯å¦å¼€å¯"></a>æ£€æµ‹ gzip æ˜¯å¦å¼€å¯</h3><p>å¦‚æœæ²¡æœ‰ç°æˆçš„é¡¹ç›®ä»£ç ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ£€æµ‹æ–¹å¼ã€‚é¦–å…ˆåœ¨æœ¬åœ°å®‰è£… nginxï¼Œåœ¨ nginx é»˜è®¤ç›®å½•ä¸‹é¢æ·»åŠ äº†ä¸¤ä¸ªé™æ€æ–‡ä»¶ bootstrap.cssã€bootstrap.jsã€‚</p><p>OS X ç³»ç»Ÿçš„é»˜è®¤è·¯å¾„ä¸ºï¼š/usr/local/Cellar/nginx/1.10.2_1/htmlï¼ŒWindows ç³»ç»Ÿç›´æ¥å¤åˆ¶æ–‡ä»¶åˆ°æ–‡ä»¶å¤¹ä¸‹é¢ã€‚</p><p>æ‹·è´æ–‡ä»¶æŒ‡ä»¤å¯å‚è€ƒï¼šcp -r bootstrap.js /usr/local/Cellar/nginx/1.10.2_1/htmlï¼Œåœ¨ nginx çš„é»˜è®¤æˆåŠŸè·³è½¬é¡µé¢ index.html å¼•å…¥è¿™ä¸¤ä¸ªé™æ€æ–‡ä»¶ã€‚index.html é¡µé¢å†…å®¹å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6sjhnk9acj30go0c90tb.jpg" alt="img"></p><p>åšå¥½è¿™ä¸€åˆ‡çš„å‡†å¤‡å·¥ä½œä¹‹åï¼Œæµè§ˆå™¨è¾“å…¥<a href="https://link.juejin.im/?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttp%3A%2F%2Flocalhost%3A8080%2F" target="_blank" rel="noopener">http://localhost:8080/</a>ã€‚å‡ºç°å¦‚å›¾æ‰€ç¤ºé¡µé¢è¡¨æ˜ nginx å¯åŠ¨æˆåŠŸã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6sjii979gj30go048wei.jpg" alt="img"></p><p>nginx å¯åŠ¨æˆåŠŸç•Œé¢ã€‚</p><p>æ­¤æ—¶æ‰“å¼€ Chrome æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ° network ä¿¡æ¯ï¼Œresponse headers ä¸­è¿”å›äº† content-encoding:gzipï¼Œè¡¨æ˜ gzip å¼€å¯æˆåŠŸã€‚</p><p>gzip æœªå¼€å¯å‰ network ä¿¡æ¯å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6sjjd5bavj30go02ogll.jpg" alt="img"></p><p>å¼€å¯åè¿”å› network ä¿¡æ¯å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6sjjxm19cj30go02m0sp.jpg" alt="img"></p><p>url è¯·æ±‚çš„ headers æŠ¥æ–‡å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6sjk4yn88j30go0a4jrt.jpg" alt="img"></p><p>å¯¹æ¯”ä»¥ä¸Šä¸‰å›¾å¯ä»¥çœ‹å‡º gzip å‹ç¼©æ•ˆç‡éå¸¸é«˜ï¼Œä¸”ç»è¿‡å‹ç¼©åé™æ€æ–‡ä»¶å¤§å°ä¸åˆ°åŸæ¥çš„äº”åˆ†ä¹‹ä¸€ã€‚è¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯é™æ€èµ„æºæ–‡ä»¶è¶Šå¤§ï¼Œgzip çš„å‹ç¼©æ•ˆç‡è¶Šé«˜ã€‚æ‰€ä»¥å¯¹äºé™æ€èµ„æºé‡éå¸¸å¤§çš„ç½‘ç«™ï¼Œå¼€å¯ gzip å¯èŠ‚çœå¤§é‡æµé‡ï¼Œè€ŒåŒæ—¶ gzip çš„åº”ç”¨è¿œä¸æ­¢æé«˜ web æ€§èƒ½,Androidï¼ŒIOS åº•å±‚ç½‘ç»œè¯·æ±‚åŒæ ·å¯ç”¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰ç«¯ä¼˜åŒ–&quot;&gt;&lt;a href=&quot;#å‰ç«¯ä¼˜åŒ–&quot; class=&quot;headerlink&quot; title=&quot;å‰ç«¯ä¼˜åŒ–&quot;&gt;&lt;/a&gt;å‰ç«¯ä¼˜åŒ–&lt;/h1&gt;&lt;h2 id=&quot;å‰ç«¯æ€§èƒ½è¡¡é‡æŒ‡æ ‡&quot;&gt;&lt;a href=&quot;#å‰ç«¯æ€§èƒ½è¡¡é‡æŒ‡æ ‡&quot; class=&quot;headerlink&quot; title=&quot;å‰
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://yoursite.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="æ€§èƒ½ä¼˜åŒ–" scheme="http://yoursite.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>CSSçš„positionå±æ€§</title>
    <link href="http://yoursite.com/2019/08/31/CSS%E7%9A%84position%E5%B1%9E%E6%80%A7/"/>
    <id>http://yoursite.com/2019/08/31/CSSçš„positionå±æ€§/</id>
    <published>2019-08-31T13:48:53.000Z</published>
    <updated>2019-11-10T14:37:39.015Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CSS-çš„-position-å±æ€§"><a href="#CSS-çš„-position-å±æ€§" class="headerlink" title="CSS çš„ position å±æ€§"></a>CSS çš„ position å±æ€§</h1><h2 id="static"><a href="#static" class="headerlink" title="static"></a>static</h2><p>é»˜è®¤å€¼ã€‚è¯¥å…³é”®å­—æŒ‡å®šå…ƒç´ ä½¿ç”¨æ­£å¸¸çš„å¸ƒå±€è¡Œä¸ºï¼Œå³å…ƒç´ åœ¨æ–‡æ¡£å¸¸è§„æµä¸­å½“å‰çš„å¸ƒå±€ä½ç½®ã€‚æ­¤æ—¶ <code>top</code>, <code>right</code>, <code>bottom</code>, <code>left</code> å’Œ <code>z-index</code>å±æ€§æ— æ•ˆã€‚</p><h2 id="relative"><a href="#relative" class="headerlink" title="relative"></a>relative</h2><h3 id="å®šä½ç±»å‹"><a href="#å®šä½ç±»å‹" class="headerlink" title="å®šä½ç±»å‹"></a>å®šä½ç±»å‹</h3><p>ç›¸å¯¹å®šä½å…ƒç´ ï¼Œç›¸å¯¹å®šä½çš„å…ƒç´ æ˜¯åœ¨æ–‡æ¡£ä¸­çš„æ­£å¸¸ä½ç½®åç§»ç»™å®šçš„å€¼ï¼Œä½†æ˜¯ä¸å½±å“å…¶ä»–å…ƒç´ çš„åç§»ã€‚</p><h3 id="å®šä½æ–¹å¼"><a href="#å®šä½æ–¹å¼" class="headerlink" title="å®šä½æ–¹å¼"></a>å®šä½æ–¹å¼</h3><p>ç”Ÿæˆç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºå…¶æ­£å¸¸ä½ç½®è¿›è¡Œå®šä½ã€‚è¯¥å…³é”®å­—ä¸‹ï¼Œå…ƒç´ å…ˆæ”¾ç½®åœ¨æœªæ·»åŠ å®šä½æ—¶çš„ä½ç½®ï¼Œå†åœ¨ä¸æ”¹å˜é¡µé¢å¸ƒå±€çš„å‰æä¸‹è°ƒæ•´å…ƒç´ ä½ç½®ï¼ˆå› æ­¤ä¼šåœ¨æ­¤å…ƒç´ æœªæ·»åŠ å®šä½æ—¶æ‰€åœ¨ä½ç½®ç•™ä¸‹ç©ºç™½ï¼Œâ€left:20â€ ä¼šå‘å…ƒç´ çš„ LEFT ä½ç½®æ·»åŠ  20 åƒç´ ã€‚ï¼‰ã€‚<code>position:relative</code> å¯¹ <code>table-group</code>, <code>table-row</code>,<code>table-column</code>,<code>table-cell</code>,<code>table-caption</code> å…ƒç´ æ— æ•ˆã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"one"</span>&gt;</span>One<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"two"</span>&gt;</span>Two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"three"</span>&gt;</span>Three<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"four"</span>&gt;</span>Four<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background</span>: red;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#two</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6iyqx5px1j312q0b40t2.jpg" alt="img"></p><h2 id="absolute"><a href="#absolute" class="headerlink" title="absolute"></a>absolute</h2><h3 id="å®šä½ç±»å‹-1"><a href="#å®šä½ç±»å‹-1" class="headerlink" title="å®šä½ç±»å‹"></a>å®šä½ç±»å‹</h3><p>ç»å¯¹å®šä½å…ƒç´ ï¼Œç›¸å¯¹å®šä½çš„å…ƒç´ å¹¶æœªè„±ç¦»æ–‡æ¡£æµï¼Œè€Œç»å¯¹å®šä½çš„å…ƒç´ åˆ™è„±ç¦»äº†æ–‡æ¡£æµã€‚åœ¨å¸ƒç½®æ–‡æ¡£æµä¸­å…¶å®ƒå…ƒç´ æ—¶ï¼Œç»å¯¹å®šä½å…ƒç´ ä¸å æ®ç©ºé—´ã€‚ç»å¯¹å®šä½å…ƒç´ ç›¸å¯¹äº<em>æœ€è¿‘çš„é static ç¥–å…ˆå…ƒç´ </em>å®šä½ã€‚å½“è¿™æ ·çš„ç¥–å…ˆå…ƒç´ ä¸å­˜åœ¨æ—¶ï¼Œåˆ™ç›¸å¯¹äº ICBï¼ˆinital container block, åˆå§‹åŒ…å«å—ï¼‰ã€‚</p><h3 id="å®šä½æ–¹å¼-1"><a href="#å®šä½æ–¹å¼-1" class="headerlink" title="å®šä½æ–¹å¼"></a>å®šä½æ–¹å¼</h3><p>ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´ï¼Œç›¸å¯¹äº static å®šä½ä»¥å¤–çš„ç¬¬ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡ â€œleftâ€, â€œtopâ€, â€œrightâ€ ä»¥åŠ â€œbottomâ€ å±æ€§è¿›è¡Œè§„å®šã€‚ç»å¯¹å®šä½çš„å…ƒç´ å¯ä»¥è®¾ç½®å¤–è¾¹è·ï¼ˆmarginsï¼‰ï¼Œä¸”ä¸ä¼šä¸å…¶ä»–è¾¹è·åˆå¹¶ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"one"</span>&gt;</span>One<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"two"</span>&gt;</span>Two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"three"</span>&gt;</span>Three<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">id</span>=<span class="string">"four"</span>&gt;</span>Four<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background</span>: red;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#three</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6iyrszydtj310809e0sz.jpg" alt="image-20190823001646550"></p><h2 id="fixed"><a href="#fixed" class="headerlink" title="fixed"></a>fixed</h2><h3 id="å®šä½ç±»å‹-2"><a href="#å®šä½ç±»å‹-2" class="headerlink" title="å®šä½ç±»å‹"></a>å®šä½ç±»å‹</h3><p>ç»å¯¹å®šä½å…ƒç´ ï¼Œå›ºå®šå®šä½ä¸ç»å¯¹å®šä½ç›¸ä¼¼ï¼Œä½†å…ƒç´ çš„åŒ…å«å—ä¸º viewport è§†å£ã€‚è¯¥å®šä½æ–¹å¼å¸¸ç”¨äºåˆ›å»ºåœ¨æ»šåŠ¨å±å¹•æ—¶ä»å›ºå®šåœ¨ç›¸åŒä½ç½®çš„å…ƒç´ ã€‚</p><h3 id="å®šä½æ–¹å¼-2"><a href="#å®šä½æ–¹å¼-2" class="headerlink" title="å®šä½æ–¹å¼"></a>å®šä½æ–¹å¼</h3><p>ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´ï¼Œç›¸å¯¹äºæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡ â€œleftâ€, â€œtopâ€, â€œrightâ€ ä»¥åŠ â€œbottomâ€ å±æ€§è¿›è¡Œè§„å®šã€‚å…ƒç´ çš„ä½ç½®åœ¨å±å¹•æ»šåŠ¨æ—¶ä¸ä¼šæ”¹å˜ã€‚æ‰“å°æ—¶ï¼Œå…ƒç´ ä¼šå‡ºç°åœ¨çš„æ¯é¡µçš„å›ºå®šä½ç½®ã€‚<code>fixed</code> å±æ€§ä¼šåˆ›å»ºæ–°çš„å±‚å ä¸Šä¸‹æ–‡ã€‚</p><p><strong>å½“å…ƒç´ ç¥–å…ˆçš„ <code>transform</code> å±æ€§é <code>none</code> æ—¶ï¼Œå®¹å™¨ç”±è§†å£æ”¹ä¸ºè¯¥ç¥–å…ˆã€‚</strong></p><h2 id="sticky"><a href="#sticky" class="headerlink" title="sticky"></a>sticky</h2><h3 id="å®šä½ç±»å‹-3"><a href="#å®šä½ç±»å‹-3" class="headerlink" title="å®šä½ç±»å‹"></a>å®šä½ç±»å‹</h3><p>ç²˜æ€§å®šä½å…ƒç´ ï¼Œç²˜æ€§å®šä½å¯ä»¥è¢«è®¤ä¸ºæ˜¯ç›¸å¯¹å®šä½å’Œå›ºå®šå®šä½çš„æ··åˆã€‚å…ƒç´ åœ¨è·¨è¶Šç‰¹å®šé˜ˆå€¼å‰ä¸ºç›¸å¯¹å®šä½ï¼Œä¹‹åä¸ºå›ºå®šå®šä½ã€‚</p><h3 id="å®šä½æ–¹å¼-3"><a href="#å®šä½æ–¹å¼-3" class="headerlink" title="å®šä½æ–¹å¼"></a>å®šä½æ–¹å¼</h3><p>ç›’ä½ç½®æ ¹æ®æ­£å¸¸æµè®¡ç®—(è¿™ç§°ä¸ºæ­£å¸¸æµåŠ¨ä¸­çš„ä½ç½®)ï¼Œç„¶åç›¸å¯¹äºè¯¥å…ƒç´ åœ¨æµä¸­çš„ flow rootï¼ˆBFCï¼‰å’Œ containing blockï¼ˆæœ€è¿‘çš„å—çº§ç¥–å…ˆå…ƒç´ ï¼‰å®šä½ã€‚åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼ˆå³ä¾¿è¢«å®šä½å…ƒç´ ä¸º <code>table æ—¶</code>ï¼‰ï¼Œè¯¥å…ƒç´ å®šä½å‡ä¸å¯¹åç»­å…ƒç´ é€ æˆå½±å“ã€‚å½“å…ƒç´  B è¢«ç²˜æ€§å®šä½æ—¶ï¼Œåç»­å…ƒç´ çš„ä½ç½®ä»æŒ‰ç…§ B æœªå®šä½æ—¶çš„ä½ç½®æ¥ç¡®å®šã€‚<code>position: sticky</code>å¯¹ <code>table</code> å…ƒç´ çš„æ•ˆæœä¸ <code>position: relative</code>ç›¸åŒã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#one</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: sticky;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ viewport è§†å£æ»šåŠ¨åˆ°å…ƒç´  top è·ç¦»å°äº 10px ä¹‹å‰ï¼Œå…ƒç´ ä¸ºç›¸å¯¹å®šä½ã€‚ä¹‹åï¼Œå…ƒç´ å°†å›ºå®šåœ¨ä¸é¡¶éƒ¨è·ç¦» 10px çš„ä½ç½®ï¼Œç›´åˆ° viewport è§†å£å›æ»šåˆ°é˜ˆå€¼ä»¥ä¸‹ã€‚</p><p>ç²˜æ€§å®šä½å¸¸ç”¨äºå®šä½å­—æ¯åˆ—è¡¨çš„å¤´éƒ¨å…ƒç´ ã€‚æ ‡ç¤º B éƒ¨åˆ†å¼€å§‹çš„å¤´éƒ¨å…ƒç´ åœ¨æ»šåŠ¨ A éƒ¨åˆ†æ—¶ï¼Œå§‹ç»ˆå¤„äº A çš„ä¸‹æ–¹ã€‚è€Œåœ¨å¼€å§‹æ»šåŠ¨ B éƒ¨åˆ†æ—¶ï¼ŒB çš„å¤´éƒ¨ä¼šå›ºå®šåœ¨å±å¹•é¡¶éƒ¨ï¼Œç›´åˆ°æ‰€æœ‰ B çš„é¡¹å‡å®Œæˆæ»šåŠ¨åï¼Œæ‰è¢« C çš„å¤´éƒ¨æ›¿ä»£ã€‚</p><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>A<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Andrew W.K.<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Apparat<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Arcade Fire<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>At The Drive-In<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Aziz Ansari<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>C<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Chromeo<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Common<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Converge<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Crystal Castles<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Cursive<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>E<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Explosions In The Sky<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>T<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Ted Leo &amp; The Pharmacists<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>T-Pain<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Thrice<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>TV On The Radio<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>Two Gallants<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">dl</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">24px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">dt</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#b8c1c8</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#989ea4</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#717d85</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">font</span>: bold <span class="number">18px</span>/<span class="number">21px</span> Helvetica, Arial, sans-serif;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">position</span>: -webkit-sticky;</span><br><span class="line">  <span class="attribute">position</span>: sticky;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">dd</span> &#123;</span><br><span class="line">  <span class="attribute">font</span>: bold <span class="number">20px</span>/<span class="number">45px</span> Helvetica, Arial, sans-serif;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">dd</span> + <span class="selector-tag">dd</span> &#123;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç”Ÿæ•ˆè§„åˆ™"><a href="#ç”Ÿæ•ˆè§„åˆ™" class="headerlink" title="ç”Ÿæ•ˆè§„åˆ™"></a>ç”Ÿæ•ˆè§„åˆ™</h3><p><code>position:sticky</code> çš„ç”Ÿæ•ˆæ˜¯æœ‰ä¸€å®šçš„é™åˆ¶çš„ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>é¡»æŒ‡å®š top, right, bottom æˆ– left å››ä¸ªé˜ˆå€¼å…¶ä¸­ä¹‹ä¸€ï¼Œæ‰å¯ä½¿ç²˜æ€§å®šä½ç”Ÿæ•ˆã€‚å¦åˆ™å…¶è¡Œä¸ºä¸ç›¸å¯¹å®šä½ç›¸åŒã€‚<ul><li>å¹¶ä¸” <code>top</code> å’Œ <code>bottom</code> åŒæ—¶è®¾ç½®æ—¶ï¼Œ<code>top</code> ç”Ÿæ•ˆçš„ä¼˜å…ˆçº§é«˜ï¼Œ<code>left</code> å’Œ <code>right</code> åŒæ—¶è®¾ç½®æ—¶ï¼Œ<code>left</code> çš„ä¼˜å…ˆçº§é«˜ã€‚</li></ul></li><li>è®¾å®šä¸º <code>position:sticky</code> å…ƒç´ çš„ä»»æ„çˆ¶èŠ‚ç‚¹çš„ overflow å±æ€§å¿…é¡»æ˜¯ visibleï¼Œå¦åˆ™ <code>position:sticky</code> ä¸ä¼šç”Ÿæ•ˆã€‚è¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹ï¼š<ul><li>å¦‚æœ <code>position:sticky</code> å…ƒç´ çš„ä»»æ„çˆ¶èŠ‚ç‚¹å®šä½è®¾ç½®ä¸º <code>overflow:hidden</code>ï¼Œåˆ™çˆ¶å®¹å™¨æ— æ³•è¿›è¡Œæ»šåŠ¨ï¼Œæ‰€ä»¥ <code>position:sticky</code> å…ƒç´ ä¹Ÿä¸ä¼šæœ‰æ»šåŠ¨ç„¶åå›ºå®šçš„æƒ…å†µã€‚</li><li>å¦‚æœ <code>position:sticky</code> å…ƒç´ çš„ä»»æ„çˆ¶èŠ‚ç‚¹å®šä½è®¾ç½®ä¸º <code>position:relative | absolute | fixed</code>ï¼Œåˆ™å…ƒç´ ç›¸å¯¹çˆ¶å…ƒç´ è¿›è¡Œå®šä½ï¼Œè€Œä¸ä¼šç›¸å¯¹ viewprot å®šä½ã€‚</li></ul></li><li>è¾¾åˆ°è®¾å®šçš„é˜€å€¼ã€‚è¿™ä¸ªè¿˜ç®—å¥½ç†è§£ï¼Œä¹Ÿå°±æ˜¯è®¾å®šäº† <code>position:sticky</code> çš„å…ƒç´ è¡¨ç°ä¸º <code>relative</code> è¿˜æ˜¯ <code>fixed</code> æ˜¯æ ¹æ®å…ƒç´ æ˜¯å¦è¾¾åˆ°è®¾å®šäº†çš„é˜ˆå€¼å†³å®šçš„ã€‚</li></ol><h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><ol><li>åŒä¸€ä¸ªçˆ¶å®¹å™¨ä¸­çš„ sticky å…ƒç´ ï¼Œå¦‚æœå®šä½å€¼ç›¸ç­‰ï¼Œåˆ™ä¼šé‡å ï¼›å¦‚æœå±äºä¸åŒçˆ¶å…ƒç´ ï¼Œåˆ™ä¼šé¸ å é¹Šå·¢ï¼ŒæŒ¤å¼€åŸæ¥çš„å…ƒç´ ï¼Œå½¢æˆä¾æ¬¡å ä½çš„æ•ˆæœã€‚</li></ol><h2 id="initial"><a href="#initial" class="headerlink" title="initial"></a>initial</h2><p><code>initial</code> å…³é”®å­—ç”¨äºè®¾ç½® CSS å±æ€§ä¸ºå®ƒçš„é»˜è®¤å€¼ï¼Œå¯ä½œç”¨äºä»»ä½• CSS æ ·å¼ã€‚ï¼ˆIE ä¸æ”¯æŒè¯¥å…³é”®å­—ï¼‰</p><h2 id="inheritï¼š"><a href="#inheritï¼š" class="headerlink" title="inheritï¼š"></a>inheritï¼š</h2><p>è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ position å±æ€§çš„å€¼ã€‚</p><p>æ¯ä¸€ä¸ª CSS å±æ€§éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯ï¼Œè¿™ä¸ªå±æ€§å¿…ç„¶æ˜¯é»˜è®¤ç»§æ‰¿çš„ (<code>inherited: Yes</code>) æˆ–è€…æ˜¯é»˜è®¤ä¸ç»§æ‰¿çš„ (<code>inherited: no</code>)å…¶ä¸­ä¹‹ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Reference" target="_blank" rel="noopener">MDN</a> ä¸Šé€šè¿‡è¿™ä¸ªç´¢å¼•æŸ¥æ‰¾ï¼Œåˆ¤æ–­ä¸€ä¸ªå±æ€§çš„æ˜¯å¦ç»§æ‰¿ç‰¹æ€§ã€‚</p><h3 id="å¯ç»§æ‰¿å±æ€§"><a href="#å¯ç»§æ‰¿å±æ€§" class="headerlink" title="å¯ç»§æ‰¿å±æ€§"></a>å¯ç»§æ‰¿å±æ€§</h3><ul><li>æ‰€æœ‰å…ƒç´ å¯ç»§æ‰¿ï¼švisibility å’Œ cursor</li><li>å†…è”å…ƒç´ å¯ç»§æ‰¿ï¼šletter-spacingã€word-spacingã€white-spaceã€line-heightã€colorã€fontã€ font-familyã€font-sizeã€font-styleã€font-variantã€font-weightã€text- decorationã€text-transformã€direction</li><li>å—çŠ¶å…ƒç´ å¯ç»§æ‰¿ï¼štext-indent å’Œ text-align</li><li>åˆ—è¡¨å…ƒç´ å¯ç»§æ‰¿ï¼šlist-styleã€list-style-typeã€list-style-positionã€list-style-image</li><li>è¡¨æ ¼å…ƒç´ å¯ç»§æ‰¿ï¼šborder-collapse</li></ul><h2 id="unset"><a href="#unset" class="headerlink" title="unset"></a>unset</h2><p><code>unset</code> å…³é”®å­—æˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºä¸è®¾ç½®ã€‚å…¶å®ï¼Œå®ƒæ˜¯å…³é”®å­— <code>initial</code> å’Œ <code>inherit</code> çš„ç»„åˆã€‚</p><p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬ç»™ä¸€ä¸ª CSS å±æ€§è®¾ç½®äº† <code>unset</code> çš„è¯ï¼š</p><ol><li>å¦‚æœè¯¥å±æ€§æ˜¯é»˜è®¤ç»§æ‰¿å±æ€§ï¼Œè¯¥å€¼ç­‰åŒäº <code>inherit</code></li><li>å¦‚æœè¯¥å±æ€§æ˜¯éç»§æ‰¿å±æ€§ï¼Œè¯¥å€¼ç­‰åŒäº <code>initial</code></li></ol><h3 id="ä¾‹å­-1"><a href="#ä¾‹å­-1" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"father"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"children"</span>&gt;</span>å­çº§å…ƒç´ ä¸€<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"children unset"</span>&gt;</span>å­çº§å…ƒç´ äºŒ<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">.father &#123; color: red; border: 1px solid black; &#125; .children &#123; color: green;</span><br><span class="line">border: 1px solid blue; &#125; .unset &#123; color: unset; border: unset; &#125;</span><br></pre></td></tr></table></figure><ol><li>ç”±äº <code>color</code> æ˜¯å¯ç»§æ‰¿æ ·å¼ï¼Œè®¾ç½®äº† <code>color: unset</code> çš„å…ƒç´ ï¼Œæœ€ç»ˆè¡¨ç°ä¸ºäº†çˆ¶çº§çš„é¢œè‰² <code>red</code>ã€‚</li><li>ç”±äº <code>border</code> æ˜¯ä¸å¯ç»§æ‰¿æ ·å¼ï¼Œè®¾ç½®äº† <code>border: unset</code> çš„å…ƒç´ ï¼Œæœ€ç»ˆè¡¨ç°ä¸º <code>border: initial</code> ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤ border æ ·å¼ï¼Œæ— è¾¹æ¡†ã€‚</li></ol><h2 id="revert"><a href="#revert" class="headerlink" title="revert"></a>revert</h2><p>revert æœªåˆ—å…¥è§„èŒƒ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;CSS-çš„-position-å±æ€§&quot;&gt;&lt;a href=&quot;#CSS-çš„-position-å±æ€§&quot; class=&quot;headerlink&quot; title=&quot;CSS çš„ position å±æ€§&quot;&gt;&lt;/a&gt;CSS çš„ position å±æ€§&lt;/h1&gt;&lt;h2 id=&quot;stati
      
    
    </summary>
    
      <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
      <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
      <category term="position" scheme="http://yoursite.com/tags/position/"/>
    
  </entry>
  
  <entry>
    <title>ES6 è£…é¥°å™¨</title>
    <link href="http://yoursite.com/2019/08/18/ES6%20%E8%A3%85%E9%A5%B0%E5%99%A8/"/>
    <id>http://yoursite.com/2019/08/18/ES6 è£…é¥°å™¨/</id>
    <published>2019-08-18T14:47:55.000Z</published>
    <updated>2019-11-10T14:37:39.018Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ES6-è£…é¥°å™¨"><a href="#ES6-è£…é¥°å™¨" class="headerlink" title="ES6 è£…é¥°å™¨"></a>ES6 è£…é¥°å™¨</h1><p>è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ä¸€ç§ä¸ç±»ï¼ˆclassï¼‰ç›¸å…³çš„è¯­æ³•ï¼Œ<strong>ç”¨æ¥æ³¨é‡Šæˆ–ä¿®æ”¹ç±»å’Œç±»æ–¹æ³•</strong>ã€‚è£…é¥°å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå†™æˆ<code>@ + å‡½æ•°å</code>ã€‚å®ƒå¯ä»¥æ”¾åœ¨ç±»å’Œç±»æ–¹æ³•çš„å®šä¹‰å‰é¢ã€‚</p>  <a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@frozen</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  @configurable(<span class="literal">false</span>)</span><br><span class="line">  @enumerable(<span class="literal">true</span>)</span><br><span class="line">  method() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @throttle(<span class="number">500</span>)</span><br><span class="line">  expensiveMethod() &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸€å…±ä½¿ç”¨äº†å››ä¸ªè£…é¥°å™¨ï¼Œä¸€ä¸ªç”¨åœ¨ç±»æœ¬èº«ï¼Œå¦å¤–ä¸‰ä¸ªç”¨åœ¨ç±»æ–¹æ³•ã€‚å®ƒä»¬ä¸ä»…å¢åŠ äº†ä»£ç çš„å¯è¯»æ€§ï¼Œæ¸…æ™°åœ°è¡¨è¾¾äº†æ„å›¾ï¼Œè€Œä¸”æä¾›ä¸€ç§æ–¹ä¾¿çš„æ‰‹æ®µï¼Œå¢åŠ æˆ–ä¿®æ”¹ç±»çš„åŠŸèƒ½ã€‚</p><p><strong>Proxy çš„æ ¸å¿ƒä½œç”¨æ˜¯æ§åˆ¶å¤–ç•Œå¯¹è¢«ä»£ç†è€…å†…éƒ¨çš„è®¿é—®ï¼ŒDecorator çš„æ ¸å¿ƒä½œç”¨æ˜¯å¢å¼ºè¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚</strong></p><h2 id="ç±»çš„è£…é¥°"><a href="#ç±»çš„è£…é¥°" class="headerlink" title="ç±»çš„è£…é¥°"></a>ç±»çš„è£…é¥°</h2><p>è£…é¥°å™¨å¯ä»¥ç”¨æ¥è£…é¥°æ•´ä¸ªç±»ã€‚</p><h3 id="ä¸ºç±»æ·»åŠ é™æ€å±æ€§"><a href="#ä¸ºç±»æ·»åŠ é™æ€å±æ€§" class="headerlink" title="ä¸ºç±»æ·»åŠ é™æ€å±æ€§"></a>ä¸ºç±»æ·»åŠ é™æ€å±æ€§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@testable</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  target.isTestable = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyTestableClass.isTestable; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>@testable</code>å°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨ã€‚å®ƒä¿®æ”¹äº†<code>MyTestableClass</code>è¿™ä¸ªç±»çš„è¡Œä¸ºï¼Œä¸ºå®ƒåŠ ä¸Šäº†é™æ€å±æ€§<code>isTestable</code>ã€‚<code>testable</code>å‡½æ•°çš„å‚æ•°<code>target</code>æ˜¯<code>MyTestableClass</code>ç±»æœ¬èº«ã€‚</p><p>åŸºæœ¬ä¸Šï¼Œè£…é¥°å™¨çš„è¡Œä¸ºå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@decorator</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line">A = decorator(A) || A;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>è£…é¥°å™¨æ˜¯ä¸€ä¸ªå¯¹ç±»è¿›è¡Œå¤„ç†çš„å‡½æ•°ã€‚è£…é¥°å™¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ‰€è¦è£…é¥°çš„ç›®æ ‡ç±»ã€‚</strong></p><p>å¦‚æœè§‰å¾—ä¸€ä¸ªå‚æ•°ä¸å¤Ÿç”¨ï¼Œå¯ä»¥åœ¨è£…é¥°å™¨å¤–é¢å†å°è£…ä¸€å±‚å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">isTestable</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    target.isTestable = isTestable;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@testable(<span class="literal">true</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;&#125;</span><br><span class="line">MyTestableClass.isTestable; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">@testable(<span class="literal">false</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line">MyClass.isTestable; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè£…é¥°å™¨<code>testable</code>å¯ä»¥æ¥å—å‚æ•°ï¼Œè¿™å°±ç­‰äºå¯ä»¥ä¿®æ”¹è£…é¥°å™¨çš„è¡Œä¸ºã€‚</p><p><strong>æ³¨æ„ï¼Œè£…é¥°å™¨å¯¹ç±»çš„è¡Œä¸ºçš„æ”¹å˜ï¼Œæ˜¯ä»£ç ç¼–è¯‘æ—¶å‘ç”Ÿçš„ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶ã€‚è¿™æ„å‘³ç€ï¼Œè£…é¥°å™¨èƒ½åœ¨ç¼–è¯‘é˜¶æ®µè¿è¡Œä»£ç ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè£…é¥°å™¨æœ¬è´¨å°±æ˜¯ç¼–è¯‘æ—¶æ‰§è¡Œçš„å‡½æ•°ã€‚</strong></p><h3 id="ä¸ºç±»æ·»åŠ å®ä¾‹å±æ€§"><a href="#ä¸ºç±»æ·»åŠ å®ä¾‹å±æ€§" class="headerlink" title="ä¸ºç±»æ·»åŠ å®ä¾‹å±æ€§"></a>ä¸ºç±»æ·»åŠ å®ä¾‹å±æ€§</h3><p>å¦‚æœæƒ³æ·»åŠ å®ä¾‹å±æ€§ï¼Œå¯ä»¥é€šè¿‡ç›®æ ‡ç±»çš„<code>prototype</code>å¯¹è±¡æ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  target.prototype.isTestable = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@testable</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyTestableClass();</span><br><span class="line">obj.isTestable; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè£…é¥°å™¨å‡½æ•°<code>testable</code>æ˜¯åœ¨ç›®æ ‡ç±»çš„<code>prototype</code>å¯¹è±¡ä¸Šæ·»åŠ å±æ€§ï¼Œå› æ­¤å°±å¯ä»¥åœ¨å®ä¾‹ä¸Šè°ƒç”¨ã€‚</p><p>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mixins.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">mixins</span>(<span class="params">...list</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.assign(target.prototype, ...list);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; mixins &#125; <span class="keyword">from</span> <span class="string">"./mixins"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@mixins(Foo)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo(); <span class="comment">// 'foo'</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç é€šè¿‡è£…é¥°å™¨<code>mixins</code>ï¼ŒæŠŠ<code>Foo</code>å¯¹è±¡çš„æ–¹æ³•æ·»åŠ åˆ°äº†<code>MyClass</code>çš„å®ä¾‹ä¸Šé¢ã€‚å¯ä»¥ç”¨<code>Object.assign()</code>æ¨¡æ‹Ÿè¿™ä¸ªåŠŸèƒ½ã€‚</p><h2 id="æ–¹æ³•çš„è£…é¥°"><a href="#æ–¹æ³•çš„è£…é¥°" class="headerlink" title="æ–¹æ³•çš„è£…é¥°"></a>æ–¹æ³•çš„è£…é¥°</h2><h3 id="è£…é¥°å™¨ä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡"><a href="#è£…é¥°å™¨ä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡" class="headerlink" title="è£…é¥°å™¨ä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡"></a>è£…é¥°å™¨ä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡</h3><p>è£…é¥°å™¨ä¸ä»…å¯ä»¥è£…é¥°ç±»ï¼Œè¿˜å¯ä»¥è£…é¥°ç±»çš„å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @readonly</span><br><span class="line">  name() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.first&#125;</span> <span class="subst">$&#123;<span class="keyword">this</span>.last&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè£…é¥°å™¨<code>readonly</code>ç”¨æ¥è£…é¥°â€œç±»â€çš„<code>name</code>æ–¹æ³•ã€‚</p><p>è£…é¥°å™¨å‡½æ•°<code>readonly</code>ä¸€å…±å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readonly</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// descriptorå¯¹è±¡åŸæ¥çš„å€¼å¦‚ä¸‹</span></span><br><span class="line">  <span class="comment">// &#123;</span></span><br><span class="line">  <span class="comment">//   value: specifiedFunction,</span></span><br><span class="line">  <span class="comment">//   enumerable: false,</span></span><br><span class="line">  <span class="comment">//   configurable: true,</span></span><br><span class="line">  <span class="comment">//   writable: true</span></span><br><span class="line">  <span class="comment">// &#125;;</span></span><br><span class="line">  descriptor.writable = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">readonly(Person.prototype, <span class="string">"name"</span>, descriptor);</span><br><span class="line"><span class="comment">// ç±»ä¼¼äº</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Person.prototype, <span class="string">"name"</span>, descriptor);</span><br></pre></td></tr></table></figure><p>è£…é¥°å™¨ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»çš„åŸå‹å¯¹è±¡ï¼Œä¸Šä¾‹æ˜¯<code>Person.prototype</code>ï¼Œè£…é¥°å™¨çš„æœ¬æ„æ˜¯è¦â€œè£…é¥°â€ç±»çš„å®ä¾‹ï¼Œä½†æ˜¯<strong>è¿™ä¸ªæ—¶å€™å®ä¾‹è¿˜æ²¡ç”Ÿæˆï¼Œæ‰€ä»¥åªèƒ½å»è£…é¥°åŸå‹</strong>ï¼ˆè¿™ä¸åŒäºç±»çš„è£…é¥°ï¼Œé‚£ç§æƒ…å†µæ—¶<code>target</code>å‚æ•°æŒ‡çš„æ˜¯ç±»æœ¬èº«ï¼‰ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦è£…é¥°çš„å±æ€§åï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚</p><p>å¦å¤–ï¼Œä¸Šé¢ä»£ç è¯´æ˜ï¼Œ<strong>è£…é¥°å™¨ï¼ˆreadonlyï¼‰ä¼šä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡ï¼ˆdescriptorï¼‰ï¼Œç„¶åè¢«ä¿®æ”¹çš„æè¿°å¯¹è±¡å†ç”¨æ¥å®šä¹‰å±æ€§ã€‚</strong></p><p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œä¿®æ”¹å±æ€§æè¿°å¯¹è±¡çš„<code>enumerable</code>å±æ€§ï¼Œä½¿å¾—è¯¥å±æ€§ä¸å¯éå†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @nonenumerable</span><br><span class="line">  <span class="keyword">get</span> kidCount() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.children.length;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nonenumerable</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">  descriptor.enumerable = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„<code>@log</code>è£…é¥°å™¨ï¼Œå¯ä»¥èµ·åˆ°è¾“å‡ºæ—¥å¿—çš„ä½œç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Math</span> </span>&#123;</span><br><span class="line">  @log</span><br><span class="line">  add(a, b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> oldValue = descriptor.value;</span><br><span class="line"></span><br><span class="line">  descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Calling <span class="subst">$&#123;name&#125;</span> with`</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> oldValue.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> math = <span class="keyword">new</span> <span class="built_in">Math</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// passed parameters should get logged now</span></span><br><span class="line">math.add(<span class="number">2</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>@log</code>è£…é¥°å™¨çš„ä½œç”¨å°±æ˜¯åœ¨æ‰§è¡ŒåŸå§‹çš„æ“ä½œä¹‹å‰ï¼Œæ‰§è¡Œä¸€æ¬¡<code>console.log</code>ï¼Œä»è€Œè¾¾åˆ°è¾“å‡ºæ—¥å¿—çš„ç›®çš„ã€‚</p><h3 id="è£…é¥°å™¨çš„æ³¨é‡Šä½œç”¨"><a href="#è£…é¥°å™¨çš„æ³¨é‡Šä½œç”¨" class="headerlink" title="è£…é¥°å™¨çš„æ³¨é‡Šä½œç”¨"></a>è£…é¥°å™¨çš„æ³¨é‡Šä½œç”¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@testable</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @readonly</span><br><span class="line">  @nonenumerable</span><br><span class="line">  name() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.first&#125;</span> <span class="subst">$&#123;<span class="keyword">this</span>.last&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼Œ<code>Person</code>ç±»æ˜¯å¯æµ‹è¯•çš„ï¼Œè€Œ<code>name</code>æ–¹æ³•æ˜¯åªè¯»å’Œä¸å¯æšä¸¾çš„ã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨ Decorator å†™æ³•çš„<a href="https://github.com/ionic-team/stencil" target="_blank" rel="noopener">ç»„ä»¶</a>ï¼Œçœ‹ä¸Šå»ä¸€ç›®äº†ç„¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Component(&#123;</span><br><span class="line">  tag: <span class="string">"my-component"</span>,</span><br><span class="line">  styleUrl: <span class="string">"my-component.scss"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> </span>&#123;</span><br><span class="line">  @Prop() first: string;</span><br><span class="line">  @Prop() last: string;</span><br><span class="line">  @State() isVisible: boolean = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        Hello, my name is &#123;<span class="keyword">this</span>.first&#125; &#123;<span class="keyword">this</span>.last&#125;</span><br><span class="line">      &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="å¤šä¸ªè£…é¥°å™¨"><a href="#å¤šä¸ªè£…é¥°å™¨" class="headerlink" title="å¤šä¸ªè£…é¥°å™¨"></a>å¤šä¸ªè£…é¥°å™¨</h3><p>å¦‚æœåŒä¸€ä¸ªæ–¹æ³•æœ‰å¤šä¸ªè£…é¥°å™¨ï¼Œä¼šåƒå‰¥æ´‹è‘±ä¸€æ ·ï¼Œå…ˆä»å¤–åˆ°å†…è¿›å…¥ï¼Œç„¶åç”±å†…å‘å¤–æ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dec</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"evaluated"</span>, id);</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">target, property, descriptor</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"executed"</span>, id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">  @dec(<span class="number">1</span>)</span><br><span class="line">  @dec(<span class="number">2</span>)</span><br><span class="line">  method() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// evaluated 1</span></span><br><span class="line"><span class="comment">// evaluated 2</span></span><br><span class="line"><span class="comment">// executed 2</span></span><br><span class="line"><span class="comment">// executed 1</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¤–å±‚è£…é¥°å™¨<code>@dec(1)</code>å…ˆè¿›å…¥ï¼Œä½†æ˜¯å†…å±‚è£…é¥°å™¨<code>@dec(2)</code>å…ˆæ‰§è¡Œã€‚</p><h3 id="è£…é¥°å™¨å¯ç”¨ä½œç±»å‹æ£€æŸ¥"><a href="#è£…é¥°å™¨å¯ç”¨ä½œç±»å‹æ£€æŸ¥" class="headerlink" title="è£…é¥°å™¨å¯ç”¨ä½œç±»å‹æ£€æŸ¥"></a>è£…é¥°å™¨å¯ç”¨ä½œç±»å‹æ£€æŸ¥</h3><p>é™¤äº†æ³¨é‡Šï¼Œè£…é¥°å™¨è¿˜èƒ½ç”¨æ¥ç±»å‹æ£€æŸ¥ã€‚æ‰€ä»¥ï¼Œå¯¹äºç±»æ¥è¯´ï¼Œè¿™é¡¹åŠŸèƒ½ç›¸å½“æœ‰ç”¨ã€‚ä»é•¿æœŸæ¥çœ‹ï¼Œå®ƒå°†æ˜¯ JavaScript ä»£ç é™æ€åˆ†æçš„é‡è¦å·¥å…·ã€‚</p><h2 id="ä¸ºä»€ä¹ˆè£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°"><a href="#ä¸ºä»€ä¹ˆè£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°" class="headerlink" title="ä¸ºä»€ä¹ˆè£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°"></a>ä¸ºä»€ä¹ˆè£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°</h2><h3 id="å‡½æ•°æå‡ï¼Œç±»æ²¡æœ‰æå‡"><a href="#å‡½æ•°æå‡ï¼Œç±»æ²¡æœ‰æå‡" class="headerlink" title="å‡½æ•°æå‡ï¼Œç±»æ²¡æœ‰æå‡"></a>å‡½æ•°æå‡ï¼Œç±»æ²¡æœ‰æå‡</h3><p>è£…é¥°å™¨åªèƒ½ç”¨äºç±»å’Œç±»çš„æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºå‡½æ•°ï¼Œ<strong>å› ä¸ºå­˜åœ¨å‡½æ•°æå‡</strong>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  counter++;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@add</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ï¼Œæ„å›¾æ˜¯æ‰§è¡Œå<code>counter</code>ç­‰äº 1ï¼Œä½†æ˜¯å®é™…ä¸Šç»“æœæ˜¯<code>counter</code>ç­‰äº 0ã€‚å› ä¸ºå‡½æ•°æå‡ï¼Œä½¿å¾—å®é™…æ‰§è¡Œçš„ä»£ç æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@add</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> counter;</span><br><span class="line"><span class="keyword">var</span> add;</span><br><span class="line"></span><br><span class="line">counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  counter++;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> readOnly = <span class="built_in">require</span>(<span class="string">"some-decorator"</span>);</span><br><span class="line"></span><br><span class="line">@readOnly</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¹Ÿæœ‰é—®é¢˜ï¼Œå› ä¸ºå®é™…æ‰§è¡Œæ˜¯ä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> readOnly;</span><br><span class="line"></span><br><span class="line">@readOnly</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">readOnly = <span class="built_in">require</span>(<span class="string">"some-decorator"</span>);</span><br></pre></td></tr></table></figure><p>æ€»ä¹‹ï¼Œç”±äºå­˜åœ¨å‡½æ•°æå‡ï¼Œä½¿å¾—è£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°ã€‚ç±»æ˜¯ä¸ä¼šæå‡çš„ï¼Œæ‰€ä»¥å°±æ²¡æœ‰è¿™æ–¹é¢çš„é—®é¢˜ã€‚</p><h3 id="å‡½æ•°ä¸€å®šè¦ç”¨è£…é¥°å™¨"><a href="#å‡½æ•°ä¸€å®šè¦ç”¨è£…é¥°å™¨" class="headerlink" title="å‡½æ•°ä¸€å®šè¦ç”¨è£…é¥°å™¨"></a>å‡½æ•°ä¸€å®šè¦ç”¨è£…é¥°å™¨</h3><p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä¸€å®šè¦è£…é¥°å‡½æ•°ï¼Œå¯ä»¥é‡‡ç”¨é«˜é˜¶å‡½æ•°çš„å½¢å¼ç›´æ¥æ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Hello, "</span> + name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loggingDecorator</span>(<span class="params">wrapped</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Starting"</span>);</span><br><span class="line">    <span class="keyword">const</span> result = wrapped.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Finished"</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wrapped = loggingDecorator(doSomething);</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§è£…é¥°å™¨"><a href="#å¸¸è§è£…é¥°å™¨" class="headerlink" title="å¸¸è§è£…é¥°å™¨"></a>å¸¸è§è£…é¥°å™¨</h2><p><a href="https://github.com/jayphelps/core-decorators.js" target="_blank" rel="noopener">core-decorators.js</a>æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæä¾›äº†å‡ ä¸ªå¸¸è§çš„è£…é¥°å™¨ï¼Œé€šè¿‡å®ƒå¯ä»¥æ›´å¥½åœ°ç†è§£è£…é¥°å™¨ã€‚</p><h3 id="1-autobind"><a href="#1-autobind" class="headerlink" title="1. @autobind"></a>1. @autobind</h3><p><code>autobind</code>è£…é¥°å™¨ä½¿å¾—æ–¹æ³•ä¸­çš„<code>this</code>å¯¹è±¡ï¼Œç»‘å®šåŸå§‹å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; autobind &#125; <span class="keyword">from</span> <span class="string">"core-decorators"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @autobind</span><br><span class="line">  getPerson() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">let</span> getPerson = person.getPerson;</span><br><span class="line"></span><br><span class="line">getPerson() === person;</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="2-readonly"><a href="#2-readonly" class="headerlink" title="2. @readonly"></a>2. @readonly</h3><p><code>readonly</code>è£…é¥°å™¨ä½¿å¾—å±æ€§æˆ–æ–¹æ³•ä¸å¯å†™ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; readonly &#125; <span class="keyword">from</span> <span class="string">"core-decorators"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line">  @readonly</span><br><span class="line">  entree = <span class="string">"steak"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dinner = <span class="keyword">new</span> Meal();</span><br><span class="line">dinner.entree = <span class="string">"salmon"</span>;</span><br><span class="line"><span class="comment">// Cannot assign to read only property 'entree' of [object Object]</span></span><br></pre></td></tr></table></figure><h3 id="3-override"><a href="#3-override" class="headerlink" title="3. @override"></a>3. @override</h3><p><code>override</code>è£…é¥°å™¨æ£€æŸ¥å­ç±»çš„æ–¹æ³•ï¼Œæ˜¯å¦æ­£ç¡®è¦†ç›–äº†çˆ¶ç±»çš„åŒåæ–¹æ³•ï¼Œå¦‚æœä¸æ­£ç¡®ä¼šæŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; override &#125; <span class="keyword">from</span> <span class="string">"core-decorators"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">  speak(first, second) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">  @override</span><br><span class="line">  speak() &#123;&#125;</span><br><span class="line">  <span class="comment">// SyntaxError: Child#speak() does not properly override Parent#speak(first, second)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">  @override</span><br><span class="line">  speaks() &#123;&#125;</span><br><span class="line">  <span class="comment">// SyntaxError: No descriptor matching Child#speaks() was found on the prototype chain.</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">//   Did you mean "speak"?</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-deprecate-åˆ«å-deprecated"><a href="#4-deprecate-åˆ«å-deprecated" class="headerlink" title="4. @deprecate (åˆ«å@deprecated)"></a>4. @deprecate (åˆ«å@deprecated)</h3><p><code>deprecate</code>æˆ–<code>deprecated</code>è£…é¥°å™¨åœ¨æ§åˆ¶å°æ˜¾ç¤ºä¸€æ¡è­¦å‘Šï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•å°†åºŸé™¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; deprecate &#125; <span class="keyword">from</span> <span class="string">"core-decorators"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @deprecate</span><br><span class="line">  facepalm() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @deprecate(<span class="string">"We stopped facepalming"</span>)</span><br><span class="line">  facepalmHard() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @deprecate(<span class="string">"We stopped facepalming"</span>, &#123;</span><br><span class="line">    url: <span class="string">"http://knowyourmeme.com/memes/facepalm"</span></span><br><span class="line">  &#125;)</span><br><span class="line">  facepalmHarder() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">person.facepalm();</span><br><span class="line"><span class="comment">// DEPRECATION Person#facepalm: This function will be removed in future versions.</span></span><br><span class="line"></span><br><span class="line">person.facepalmHard();</span><br><span class="line"><span class="comment">// DEPRECATION Person#facepalmHard: We stopped facepalming</span></span><br><span class="line"></span><br><span class="line">person.facepalmHarder();</span><br><span class="line"><span class="comment">// DEPRECATION Person#facepalmHarder: We stopped facepalming</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     See http://knowyourmeme.com/memes/facepalm for more details.</span></span><br><span class="line"><span class="comment">//</span></span><br></pre></td></tr></table></figure><h3 id="5-suppressWarnings"><a href="#5-suppressWarnings" class="headerlink" title="5. @suppressWarnings"></a>5. @suppressWarnings</h3><p><code>suppressWarnings</code>è£…é¥°å™¨æŠ‘åˆ¶<code>deprecated</code>è£…é¥°å™¨å¯¼è‡´çš„<code>console.warn()</code>è°ƒç”¨ã€‚ä½†æ˜¯ï¼Œå¼‚æ­¥ä»£ç å‘å‡ºçš„è°ƒç”¨é™¤å¤–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; suppressWarnings &#125; <span class="keyword">from</span> <span class="string">"core-decorators"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @deprecated</span><br><span class="line">  facepalm() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @suppressWarnings</span><br><span class="line">  facepalmWithoutWarning() &#123;</span><br><span class="line">    <span class="keyword">this</span>.facepalm();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">person.facepalmWithoutWarning();</span><br><span class="line"><span class="comment">// no warning is logged</span></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨è£…é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶"><a href="#ä½¿ç”¨è£…é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶" class="headerlink" title="ä½¿ç”¨è£…é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶"></a>ä½¿ç”¨è£…é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è£…é¥°å™¨ï¼Œä½¿å¾—å¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> postal = <span class="built_in">require</span>(<span class="string">"postal/lib/postal.lodash"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">publish</span>(<span class="params">topic, channel</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> channelName = channel || <span class="string">"/"</span>;</span><br><span class="line">  <span class="keyword">const</span> msgChannel = postal.channel(channelName);</span><br><span class="line">  msgChannel.subscribe(topic, v =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"é¢‘é“: "</span>, channelName);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"äº‹ä»¶: "</span>, topic);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"æ•°æ®: "</span>, v);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> fn = descriptor.value;</span><br><span class="line"></span><br><span class="line">    descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> value = fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">      msgChannel.publish(topic, value);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>publish</code>çš„è£…é¥°å™¨ï¼Œå®ƒé€šè¿‡æ”¹å†™<code>descriptor.value</code>ï¼Œä½¿å¾—åŸæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚å®ƒä½¿ç”¨çš„äº‹ä»¶â€œå‘å¸ƒ/è®¢é˜…â€åº“æ˜¯<a href="https://github.com/postaljs/postal.js" target="_blank" rel="noopener">Postal.js</a>ã€‚</p><p>å®ƒçš„ç”¨æ³•å¦‚ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> publish <span class="keyword">from</span> <span class="string">"./publish"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooComponent</span> </span>&#123;</span><br><span class="line">  @publish(<span class="string">"foo.some.message"</span>, <span class="string">"component"</span>)</span><br><span class="line">  someMethod() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">my</span>: <span class="string">"data"</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  @publish(<span class="string">"foo.some.other"</span>)</span><br><span class="line">  anotherMethod() &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> foo = <span class="keyword">new</span> FooComponent();</span><br><span class="line"></span><br><span class="line">foo.someMethod();</span><br><span class="line">foo.anotherMethod();</span><br></pre></td></tr></table></figure><p>ä»¥åï¼Œåªè¦è°ƒç”¨<code>someMethod</code>æˆ–è€…<code>anotherMethod</code>ï¼Œå°±ä¼šè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ bash-node index.js</span><br><span class="line">é¢‘é“:  component</span><br><span class="line">äº‹ä»¶:  foo.some.message</span><br><span class="line">æ•°æ®:  &#123; my: <span class="string">'data'</span> &#125;</span><br><span class="line"></span><br><span class="line">é¢‘é“:  /</span><br><span class="line">äº‹ä»¶:  foo.some.other</span><br><span class="line">æ•°æ®:  undefined</span><br></pre></td></tr></table></figure><h2 id="Mixin"><a href="#Mixin" class="headerlink" title="Mixin"></a>Mixin</h2><p>åœ¨è£…é¥°å™¨çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å®ç°<code>Mixin</code>æ¨¡å¼ã€‚æ‰€è°“<code>Mixin</code>æ¨¡å¼ï¼Œå°±æ˜¯<strong>å¯¹è±¡ç»§æ‰¿çš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼Œä¸­æ–‡è¯‘ä¸ºâ€œæ··å…¥â€ï¼ˆmix inï¼‰ï¼Œæ„ä¸ºåœ¨ä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­æ··å…¥å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚</p><p>è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.assign(MyClass.prototype, Foo);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo(); <span class="comment">// 'foo'</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œå¯¹è±¡<code>Foo</code>æœ‰ä¸€ä¸ª<code>foo</code>æ–¹æ³•ï¼Œé€šè¿‡<code>Object.assign</code>æ–¹æ³•ï¼Œå¯ä»¥å°†<code>foo</code>æ–¹æ³•â€œæ··å…¥â€<code>MyClass</code>ç±»ï¼Œå¯¼è‡´<code>MyClass</code>çš„å®ä¾‹<code>obj</code>å¯¹è±¡éƒ½å…·æœ‰<code>foo</code>æ–¹æ³•ã€‚è¿™å°±æ˜¯â€œæ··å…¥â€æ¨¡å¼çš„ä¸€ä¸ªç®€å•å®ç°ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªé€šç”¨è„šæœ¬<code>mixins.js</code>ï¼Œå°† Mixin å†™æˆä¸€ä¸ªè£…é¥°å™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">mixins</span>(<span class="params">...list</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.assign(target.prototype, ...list);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸Šé¢è¿™ä¸ªè£…é¥°å™¨ï¼Œä¸ºç±»â€œæ··å…¥â€å„ç§æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mixins &#125; <span class="keyword">from</span> <span class="string">"./mixins"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@mixins(Foo)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo(); <span class="comment">// "foo"</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>mixins</code>è¿™ä¸ªè£…é¥°å™¨ï¼Œå®ç°äº†åœ¨<code>MyClass</code>ç±»ä¸Šé¢â€œæ··å…¥â€<code>Foo</code>å¯¹è±¡çš„<code>foo</code>æ–¹æ³•ã€‚</p><p>ä¸è¿‡ï¼Œä¸Šé¢çš„æ–¹æ³•ä¼šæ”¹å†™<code>MyClass</code>ç±»çš„<code>prototype</code>å¯¹è±¡ï¼Œå¦‚æœä¸å–œæ¬¢è¿™ä¸€ç‚¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç±»çš„ç»§æ‰¿å®ç° Mixinã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">MyBaseClass</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>MyClass</code>ç»§æ‰¿äº†<code>MyBaseClass</code>ã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨<code>MyClass</code>é‡Œé¢â€œæ··å…¥â€ä¸€ä¸ª<code>foo</code>æ–¹æ³•ï¼Œä¸€ä¸ªåŠæ³•æ˜¯åœ¨<code>MyClass</code>å’Œ<code>MyBaseClass</code>ä¹‹é—´æ’å…¥ä¸€ä¸ªæ··å…¥ç±»ï¼Œè¿™ä¸ªç±»å…·æœ‰<code>foo</code>æ–¹æ³•ï¼Œå¹¶ä¸”ç»§æ‰¿äº†<code>MyBaseClass</code>çš„æ‰€æœ‰æ–¹æ³•ï¼Œç„¶å<code>MyClass</code>å†ç»§æ‰¿è¿™ä¸ªç±»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> MyMixin = <span class="function"><span class="params">superclass</span> =&gt;</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">superclass</span> </span>&#123;</span><br><span class="line">    foo() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"foo from MyMixin"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>MyMixin</code>æ˜¯ä¸€ä¸ªæ··å…¥ç±»ç”Ÿæˆå™¨ï¼Œæ¥å—<code>superclass</code>ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªç»§æ‰¿<code>superclass</code>çš„å­ç±»ï¼Œè¯¥å­ç±»åŒ…å«ä¸€ä¸ª<code>foo</code>æ–¹æ³•ã€‚</p><p>æ¥ç€ï¼Œç›®æ ‡ç±»å†å»ç»§æ‰¿è¿™ä¸ªæ··å…¥ç±»ï¼Œå°±è¾¾åˆ°äº†â€œæ··å…¥â€<code>foo</code>æ–¹æ³•çš„ç›®çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">MyMixin</span>(<span class="title">MyBaseClass</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> MyClass();</span><br><span class="line">c.foo(); <span class="comment">// "foo from MyMixin"</span></span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦â€œæ··å…¥â€å¤šä¸ªæ–¹æ³•ï¼Œå°±ç”Ÿæˆå¤šä¸ªæ··å…¥ç±»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">Mixin1</span>(<span class="title">Mixin2</span>(<span class="title">MyBaseClass</span>)) </span>&#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§å†™æ³•çš„ä¸€ä¸ªå¥½å¤„ï¼Œæ˜¯å¯ä»¥è°ƒç”¨<code>super</code>ï¼Œå› æ­¤å¯ä»¥é¿å…åœ¨â€œæ··å…¥â€è¿‡ç¨‹ä¸­è¦†ç›–çˆ¶ç±»çš„åŒåæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Mixin1 = <span class="function"><span class="params">superclass</span> =&gt;</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">superclass</span> </span>&#123;</span><br><span class="line">    foo() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"foo from Mixin1"</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">super</span>.foo) <span class="keyword">super</span>.foo();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Mixin2 = <span class="function"><span class="params">superclass</span> =&gt;</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">superclass</span> </span>&#123;</span><br><span class="line">    foo() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"foo from Mixin2"</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">super</span>.foo) <span class="keyword">super</span>.foo();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span> </span>&#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo from S"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">Mixin1</span>(<span class="title">Mixin2</span>(<span class="title">S</span>)) </span>&#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo from C"</span>);</span><br><span class="line">    <span class="keyword">super</span>.foo();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯ä¸€æ¬¡<code>æ··å…¥</code>å‘ç”Ÿæ—¶ï¼Œéƒ½è°ƒç”¨äº†çˆ¶ç±»çš„<code>super.foo</code>æ–¹æ³•ï¼Œå¯¼è‡´çˆ¶ç±»çš„åŒåæ–¹æ³•æ²¡æœ‰è¢«è¦†ç›–ï¼Œè¡Œä¸ºè¢«ä¿ç•™äº†ä¸‹æ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> C().foo();</span><br><span class="line"><span class="comment">// foo from C</span></span><br><span class="line"><span class="comment">// foo from Mixin1</span></span><br><span class="line"><span class="comment">// foo from Mixin2</span></span><br><span class="line"><span class="comment">// foo from S</span></span><br></pre></td></tr></table></figure><h2 id="Trait"><a href="#Trait" class="headerlink" title="Trait"></a>Trait</h2><p>Trait ä¹Ÿæ˜¯ä¸€ç§è£…é¥°å™¨ï¼Œæ•ˆæœä¸ Mixin ç±»ä¼¼ï¼Œä½†æ˜¯æä¾›æ›´å¤šåŠŸèƒ½ï¼Œæ¯”å¦‚é˜²æ­¢åŒåæ–¹æ³•çš„å†²çªã€æ’é™¤æ··å…¥æŸäº›æ–¹æ³•ã€ä¸ºæ··å…¥çš„æ–¹æ³•èµ·åˆ«åç­‰ç­‰ã€‚</p><p>ä¸‹é¢é‡‡ç”¨<a href="https://github.com/CocktailJS/traits-decorator" target="_blank" rel="noopener">traits-decorator</a>è¿™ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ä½œä¸ºä¾‹å­ã€‚è¿™ä¸ªæ¨¡å—æä¾›çš„<code>traits</code>è£…é¥°å™¨ï¼Œä¸ä»…å¯ä»¥æ¥å—å¯¹è±¡ï¼Œè¿˜å¯ä»¥æ¥å— ES6 ç±»ä½œä¸ºå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; traits &#125; <span class="keyword">from</span> <span class="string">"traits-decorator"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TBar = &#123;</span><br><span class="line">  bar() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"bar"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@traits(TFoo, TBar)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo(); <span class="comment">// foo</span></span><br><span class="line">obj.bar(); <span class="comment">// bar</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œé€šè¿‡<code>traits</code>è£…é¥°å™¨ï¼Œåœ¨<code>MyClass</code>ç±»ä¸Šé¢â€œæ··å…¥â€äº†<code>TFoo</code>ç±»çš„<code>foo</code>æ–¹æ³•å’Œ<code>TBar</code>å¯¹è±¡çš„<code>bar</code>æ–¹æ³•ã€‚</p><p>Trait ä¸å…è®¸â€œæ··å…¥â€åŒåæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; traits &#125; <span class="keyword">from</span> <span class="string">"traits-decorator"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TBar = &#123;</span><br><span class="line">  bar() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"bar"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@traits(TFoo, TBar)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="comment">// throw new Error('Method named: ' + methodName + ' is defined twice.');</span></span><br><span class="line"><span class="comment">//        ^</span></span><br><span class="line"><span class="comment">// Error: Method named: foo is defined twice.</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>TFoo</code>å’Œ<code>TBar</code>éƒ½æœ‰<code>foo</code>æ–¹æ³•ï¼Œç»“æœ<code>traits</code>è£…é¥°å™¨æŠ¥é”™ã€‚</p><p>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯æ’é™¤<code>TBar</code>çš„<code>foo</code>æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; traits, excludes &#125; <span class="keyword">from</span> <span class="string">"traits-decorator"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TBar = &#123;</span><br><span class="line">  bar() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"bar"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@traits(TFoo, <span class="attr">TBar</span>::excludes(<span class="string">"foo"</span>))</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo(); <span class="comment">// foo</span></span><br><span class="line">obj.bar(); <span class="comment">// bar</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä½¿ç”¨ç»‘å®šè¿ç®—ç¬¦ï¼ˆ::ï¼‰åœ¨<code>TBar</code>ä¸Šæ’é™¤<code>foo</code>æ–¹æ³•ï¼Œæ··å…¥æ—¶å°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯ä¸º<code>TBar</code>çš„<code>foo</code>æ–¹æ³•èµ·ä¸€ä¸ªåˆ«åã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; traits, alias &#125; <span class="keyword">from</span> <span class="string">"traits-decorator"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TBar = &#123;</span><br><span class="line">  bar() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"bar"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  foo() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@traits(TFoo, <span class="attr">TBar</span>::alias(&#123; <span class="attr">foo</span>: <span class="string">"aliasFoo"</span> &#125;))</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo(); <span class="comment">// foo</span></span><br><span class="line">obj.aliasFoo(); <span class="comment">// foo</span></span><br><span class="line">obj.bar(); <span class="comment">// bar</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸º<code>TBar</code>çš„<code>foo</code>æ–¹æ³•èµ·äº†åˆ«å<code>aliasFoo</code>ï¼Œäºæ˜¯<code>MyClass</code>ä¹Ÿå¯ä»¥æ··å…¥<code>TBar</code>çš„<code>foo</code>æ–¹æ³•äº†ã€‚</p><p><code>alias</code>å’Œ<code>excludes</code>æ–¹æ³•ï¼Œå¯ä»¥ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@traits(TExample::excludes(<span class="string">"foo"</span>, <span class="string">"bar"</span>)::alias(&#123; <span class="attr">baz</span>: <span class="string">"exampleBaz"</span> &#125;))</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç æ’é™¤äº†<code>TExample</code>çš„<code>foo</code>æ–¹æ³•å’Œ<code>bar</code>æ–¹æ³•ï¼Œä¸º<code>baz</code>æ–¹æ³•èµ·äº†åˆ«å<code>exampleBaz</code>ã€‚</p><p><code>as</code>æ–¹æ³•åˆ™ä¸ºä¸Šé¢çš„ä»£ç æä¾›äº†å¦ä¸€ç§å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@traits(</span><br><span class="line">  TExample::<span class="keyword">as</span>(&#123; <span class="attr">excludes</span>: [<span class="string">"foo"</span>, <span class="string">"bar"</span>], <span class="attr">alias</span>: &#123; <span class="attr">baz</span>: <span class="string">"exampleBaz"</span> &#125; &#125;)</span><br><span class="line">)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ES6-è£…é¥°å™¨&quot;&gt;&lt;a href=&quot;#ES6-è£…é¥°å™¨&quot; class=&quot;headerlink&quot; title=&quot;ES6 è£…é¥°å™¨&quot;&gt;&lt;/a&gt;ES6 è£…é¥°å™¨&lt;/h1&gt;&lt;p&gt;è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ä¸€ç§ä¸ç±»ï¼ˆclassï¼‰ç›¸å…³çš„è¯­æ³•ï¼Œ&lt;strong&gt;ç”¨æ¥æ³¨é‡Šæˆ–ä¿®æ”¹ç±»å’Œç±»æ–¹æ³•&lt;/strong&gt;ã€‚è£…é¥°å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå†™æˆ&lt;code&gt;@ + å‡½æ•°å&lt;/code&gt;ã€‚å®ƒå¯ä»¥æ”¾åœ¨ç±»å’Œç±»æ–¹æ³•çš„å®šä¹‰å‰é¢ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ES6" scheme="http://yoursite.com/categories/ES6/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
      <category term="ES6" scheme="http://yoursite.com/tags/ES6/"/>
    
  </entry>
  
  <entry>
    <title>QUIC</title>
    <link href="http://yoursite.com/2019/08/16/QUIC/"/>
    <id>http://yoursite.com/2019/08/16/QUIC/</id>
    <published>2019-08-15T17:52:20.000Z</published>
    <updated>2019-11-10T14:37:39.022Z</updated>
    
    <content type="html"><![CDATA[<h1 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h1><h2 id="QUIC-æ¦‚è¿°"><a href="#QUIC-æ¦‚è¿°" class="headerlink" title="QUIC æ¦‚è¿°"></a>QUIC æ¦‚è¿°</h2><p>Quic å…¨ç§° quick udp internet connection [1]ï¼Œâ€œå¿«é€Ÿ UDP äº’è”ç½‘è¿æ¥â€ï¼Œï¼ˆå’Œè‹±æ–‡ quick è°éŸ³ï¼Œç®€ç§°â€œå¿«â€ï¼‰æ˜¯ç”± google æå‡ºçš„ä½¿ç”¨ udp è¿›è¡Œå¤šè·¯å¹¶å‘ä¼ è¾“çš„åè®®ã€‚</p><p>QUIC åè®®å†…ç½®äº† TLS æ ˆï¼Œå®ç°äº†è‡ªå·±çš„<a href="https://docs.google.com/document/d/1g5nIXAIkN_Y-7XJW5K45IblHd_L2f5LTaDUDwvZ5L6g/edit" target="_blank" rel="noopener">ä¼ è¾“åŠ å¯†å±‚</a>ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„ TLS 1.2ã€‚åŒæ—¶ QUIC è¿˜åŒ…å«äº†éƒ¨åˆ† HTTP/2 çš„å®ç°ï¼Œå› æ­¤ QUIC çš„åœ°ä½çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p><a id="more"></a><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izr9eluaj315w0k0aaa.jpg" alt="img"></p><p>ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒQUIC åº•å±‚é€šè¿‡ UDP åè®®æ›¿ä»£äº† TCPï¼Œä¸Šå±‚åªéœ€è¦ä¸€å±‚ç”¨äºå’Œè¿œç¨‹æœåŠ¡å™¨äº¤äº’çš„ HTTP/2 APIã€‚è¿™æ˜¯å› ä¸º QUIC åè®®å·²ç»åŒ…å«äº†å¤šè·¯å¤ç”¨å’Œè¿æ¥ç®¡ç†ï¼ŒHTTP API åªéœ€è¦å®Œæˆ HTTP åè®®çš„è§£æå³å¯ã€‚</p><h2 id="QUIC-ä¼˜åŠ¿"><a href="#QUIC-ä¼˜åŠ¿" class="headerlink" title="QUIC ä¼˜åŠ¿"></a>QUIC ä¼˜åŠ¿</h2><ol><li>å‡å°‘äº† TCP ä¸‰æ¬¡æ¡æ‰‹åŠ TLS æ¡æ‰‹æ—¶é—´ã€‚</li><li>æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶ã€‚</li><li>é¿å…é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨ã€‚</li><li>è¿æ¥è¿ç§»ã€‚</li><li>å‰å‘å†—ä½™çº é”™ã€‚ï¼ˆç›®å‰é»˜è®¤çš„å†—ä½™é‡æ˜¯ 10%ï¼Œæ—¢æ¯å‘é€ 10 ä¸ªæ•°æ®åŒ…ï¼Œå…¶å†—ä½™æ•°æ®å°±å¯ä»¥é‡æ–°æ„å»ºä¸€ä¸ªä¸¢å¤±çš„æ•°æ®åŒ…ï¼‰</li></ol><h2 id="ä¸ºä»€ä¹ˆéœ€è¦-QUIC"><a href="#ä¸ºä»€ä¹ˆéœ€è¦-QUIC" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ QUIC"></a>ä¸ºä»€ä¹ˆéœ€è¦ QUIC</h2><ol><li><p>åè®®å†å²æ‚ ä¹…å¯¼è‡´ä¸­é—´è®¾å¤‡åƒµåŒ–ã€‚</p><p>TCP åè®®æœ¬æ¥æ˜¯æ”¯æŒç«¯å£ã€é€‰é¡¹åŠç‰¹æ€§çš„å¢åŠ å’Œä¿®æ”¹ã€‚ä½†æ˜¯ç”±äº TCP åè®®å’ŒçŸ¥åç«¯å£ï¼ˆ80ã€443ï¼‰åŠé€‰é¡¹ä½¿ç”¨çš„å†å²å¤ªæ‚ ä¹…ï¼Œä¸­é—´è®¾å¤‡å·²ç»ä¾èµ–äºè¿™äº›æ½œè§„åˆ™ï¼Œæ‰€ä»¥å¯¹è¿™äº›å†…å®¹çš„ä¿®æ”¹å¾ˆå®¹æ˜“é­åˆ°ä¸­é—´ç¯èŠ‚çš„å¹²æ‰°è€Œå¤±è´¥ã€‚</p></li><li><p>ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„å®ç°å¯¼è‡´åè®®æœ¬èº«åƒµåŒ–ã€‚</p><p>TCP æ˜¯ç”±æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸è¥¿æ–¹æ ˆå±‚é¢å®ç°çš„ï¼Œåº”ç”¨ç¨‹åºåªèƒ½ä½¿ç”¨ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚è™½ç„¶åº”ç”¨ç¨‹åºçš„æ›´æ–°è¿­ä»£éå¸¸å¿«é€Ÿå’Œç®€å•ã€‚ä½†æ˜¯ TCP çš„è¿­ä»£å´éå¸¸ç¼“æ…¢ï¼ŒåŸå› å°±æ˜¯æ“ä½œç³»ç»Ÿå‡çº§å¾ˆéº»çƒ¦ã€‚æœåŠ¡ç«¯ç³»ç»Ÿä¸ä¾èµ–ç”¨æˆ·å‡çº§ï¼Œä½†æ˜¯ç”±äºæ“ä½œç³»ç»Ÿå‡çº§æ¶‰åŠåˆ°åº•å±‚è½¯ä»¶å’Œè¿è¡Œåº“çš„æ›´æ–°ï¼Œæ‰€ä»¥ä¹Ÿæ¯”è¾ƒä¿å®ˆå’Œç¼“æ…¢ã€‚</p></li><li><p>å»ºç«‹è¿æ¥çš„æ¡æ‰‹å»¶è¿Ÿå¤§ã€‚</p><p>ä¸ç®¡æ˜¯ HTTP1.0/1.1 è¿˜æ˜¯ HTTPSï¼ŒHTTP2ï¼Œéƒ½ä½¿ç”¨äº† TCP è¿›è¡Œä¼ è¾“ã€‚HTTPS å’Œ HTTP2 è¿˜éœ€è¦ä½¿ç”¨ TLS åè®®æ¥è¿›è¡Œå®‰å…¨ä¼ è¾“ã€‚è¿™å°±å‡ºç°äº†ä¸¤ä¸ªæ¡æ‰‹å»¶è¿Ÿï¼š</p><ul><li>TCP ä¸‰æ¬¡æ¡æ‰‹å¯¼è‡´çš„ TCP è¿æ¥å»ºç«‹çš„å»¶è¿Ÿã€‚</li><li>TLS å®Œå…¨æ¡æ‰‹éœ€è¦è‡³å°‘ 2 ä¸ª RTT æ‰èƒ½å»ºç«‹ï¼Œç®€åŒ–æ¡æ‰‹éœ€è¦ 1 ä¸ª RTT çš„æ¡æ‰‹å»¶è¿Ÿã€‚</li></ul><p>å¯¹äºå¾ˆå¤šçŸ­è¿æ¥åœºæ™¯ï¼Œè¿™æ ·çš„æ¡æ‰‹å»¶è¿Ÿå½±å“å¾ˆå¤§ï¼Œä¸”æ— æ³•æ¶ˆé™¤ã€‚</p></li><li><p>é˜Ÿå¤´é˜»å¡ã€‚</p><p>é˜Ÿå¤´é˜»å¡ä¸»è¦æ˜¯ TCP åè®®çš„å¯é æ€§æœºåˆ¶å¼•å…¥çš„ã€‚TCP ä½¿ç”¨åºåˆ—å·æ¥æ ‡è¯†æ•°æ®çš„é¡ºåºï¼Œæ•°æ®å¿…é¡»æŒ‰ç…§é¡ºåºå¤„ç†ï¼Œå¦‚æœå‰é¢çš„æ•°æ®ä¸¢å¤±ï¼Œåé¢çš„æ•°æ®å°±ç®—åˆ°è¾¾äº†ä¹Ÿä¸ä¼šé€šçŸ¥åº”ç”¨å±‚æ¥å¤„ç†ã€‚</p><p>å¦å¤– TLS åè®®å±‚é¢ä¹Ÿæœ‰ä¸€ä¸ªé˜Ÿå¤´é˜»å¡ï¼Œå› ä¸º TLS åè®®éƒ½æ˜¯æŒ‰ç…§ record æ¥å¤„ç†æ•°æ®çš„ï¼Œå¦‚æœä¸€ä¸ª record ä¸­ä¸¢å¤±äº†æ•°æ®ï¼Œä¹Ÿä¼šå¯¼è‡´æ•´ä¸ª record æ— æ³•æ­£ç¡®å¤„ç†ã€‚</p></li></ol><p><strong>QUIC åè®®é€‰æ‹©äº† UDPï¼Œå› ä¸º UDP æœ¬èº«æ²¡æœ‰è¿æ¥çš„æ¦‚å¿µï¼Œä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼˜åŒ–äº†è¿æ¥å»ºç«‹çš„æ¡æ‰‹å»¶è¿Ÿï¼ŒåŒæ—¶åœ¨åº”ç”¨ç¨‹åºå±‚é¢å®ç°äº† TCP çš„å¯é æ€§ï¼ŒTLS çš„å®‰å…¨æ€§å’Œ HTTP2 çš„å¹¶å‘æ€§ï¼Œåªéœ€è¦ç”¨æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åº”ç”¨ç¨‹åºæ”¯æŒ QUIC åè®®ï¼Œå®Œå…¨é¿å¼€äº†æ“ä½œç³»ç»Ÿå’Œä¸­é—´è®¾å¤‡çš„é™åˆ¶ã€‚</strong></p><h2 id="QUIC-è¯¦è§£"><a href="#QUIC-è¯¦è§£" class="headerlink" title="QUIC è¯¦è§£"></a>QUIC è¯¦è§£</h2><h3 id="1-QUIC-æ ¸å¿ƒç‰¹æ€§è¿æ¥å»ºç«‹å»¶æ—¶ä½"><a href="#1-QUIC-æ ¸å¿ƒç‰¹æ€§è¿æ¥å»ºç«‹å»¶æ—¶ä½" class="headerlink" title="1. QUIC æ ¸å¿ƒç‰¹æ€§è¿æ¥å»ºç«‹å»¶æ—¶ä½"></a>1. QUIC æ ¸å¿ƒç‰¹æ€§è¿æ¥å»ºç«‹å»¶æ—¶ä½</h3><p><strong>0RTT å»ºè¿</strong>å¯ä»¥è¯´æ˜¯ QUIC ç›¸æ¯” HTTP2 æœ€å¤§çš„æ€§èƒ½ä¼˜åŠ¿ã€‚é‚£ä»€ä¹ˆæ˜¯ 0RTT å»ºè¿å‘¢ï¼Ÿè¿™é‡Œé¢æœ‰ä¸¤å±‚å«ä¹‰ã€‚</p><ol><li>ä¼ è¾“å±‚ 0RTT å°±èƒ½å»ºç«‹è¿æ¥ã€‚</li><li>åŠ å¯†å±‚ 0RTT å°±èƒ½å»ºç«‹åŠ å¯†è¿æ¥ã€‚</li></ol><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izr8c4vjj314a0n0gpa.jpg" alt="img"></p><p>æ¯”å¦‚ä¸Šå›¾å·¦è¾¹æ˜¯ HTTPS çš„ä¸€æ¬¡å®Œå…¨æ¡æ‰‹çš„å»ºè¿è¿‡ç¨‹ï¼Œéœ€è¦ 3 ä¸ª RTTã€‚å°±ç®—æ˜¯ Session Resumption[14]ï¼Œä¹Ÿéœ€è¦è‡³å°‘ 2 ä¸ª RTTã€‚</p><p>è€Œ QUIC å‘¢ï¼Ÿç”±äºå»ºç«‹åœ¨ UDP çš„åŸºç¡€ä¸Šï¼ŒåŒæ—¶åˆå®ç°äº† 0RTT çš„å®‰å…¨æ¡æ‰‹ï¼Œæ‰€ä»¥åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåªéœ€è¦ 0 ä¸ª RTT å°±èƒ½å®ç°æ•°æ®å‘é€ï¼Œåœ¨å®ç°å‰å‘åŠ å¯†çš„åŸºç¡€ä¸Šï¼Œå¹¶ä¸” 0RTT çš„æˆåŠŸç‡ç›¸æ¯” TLS çš„ Sesison Ticket[13] è¦é«˜å¾ˆå¤šã€‚</p><h3 id="2-æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶"><a href="#2-æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶" class="headerlink" title="2. æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶"></a>2. æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶</h3><p>TCP çš„æ‹¥å¡æ§åˆ¶å®é™…ä¸ŠåŒ…å«äº†å››ä¸ªç®—æ³•ï¼šæ…¢å¯åŠ¨ï¼Œæ‹¥å¡é¿å…ï¼Œå¿«é€Ÿé‡ä¼ ï¼Œå¿«é€Ÿæ¢å¤ã€‚</p><p>QUIC åè®®å½“å‰é»˜è®¤ä½¿ç”¨äº† TCP åè®®çš„ Cubic æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒ CubicBytes, Reno, RenoBytes, BBR, PCC ç­‰æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚</p><p>ä»æ‹¥å¡ç®—æ³•æœ¬èº«æ¥çœ‹ï¼ŒQUIC åªæ˜¯æŒ‰ç…§ TCP åè®®é‡æ–°å®ç°äº†ä¸€éï¼Œé‚£ä¹ˆ QUIC åè®®åˆ°åº•æ”¹è¿›åœ¨å“ªäº›æ–¹é¢å‘¢ï¼Ÿä¸»è¦æœ‰å¦‚ä¸‹å‡ ç‚¹ï¼š</p><ul><li><strong>å¯æ’æ‹”</strong></li></ul><p>ä»€ä¹ˆå«å¯æ’æ‹”å‘¢ï¼Ÿå°±æ˜¯èƒ½å¤Ÿéå¸¸çµæ´»åœ°ç”Ÿæ•ˆï¼Œå˜æ›´å’Œåœæ­¢ã€‚ä½“ç°åœ¨å¦‚ä¸‹æ–¹é¢ï¼š</p><ol><li>åº”ç”¨ç¨‹åºå±‚é¢å°±èƒ½å®ç°ä¸åŒçš„æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œä¸éœ€è¦æ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦å†…æ ¸æ”¯æŒã€‚è¿™æ˜¯ä¸€ä¸ªé£è·ƒï¼Œå› ä¸ºä¼ ç»Ÿçš„ TCP æ‹¥å¡æ§åˆ¶ï¼Œå¿…é¡»è¦ç«¯åˆ°ç«¯çš„ç½‘ç»œåè®®æ ˆæ”¯æŒï¼Œæ‰èƒ½å®ç°æ§åˆ¶æ•ˆæœã€‚è€Œå†…æ ¸å’Œæ“ä½œç³»ç»Ÿçš„éƒ¨ç½²æˆæœ¬éå¸¸é«˜ï¼Œå‡çº§å‘¨æœŸå¾ˆé•¿ï¼Œè¿™åœ¨äº§å“å¿«é€Ÿè¿­ä»£ï¼Œç½‘ç»œçˆ†ç‚¸å¼å¢é•¿çš„ä»Šå¤©ï¼Œæ˜¾ç„¶æœ‰ç‚¹æ»¡è¶³ä¸äº†éœ€æ±‚ã€‚</li><li>å³ä½¿æ˜¯å•ä¸ªåº”ç”¨ç¨‹åºçš„ä¸åŒè¿æ¥ä¹Ÿèƒ½æ”¯æŒé…ç½®ä¸åŒçš„æ‹¥å¡æ§åˆ¶ã€‚å°±ç®—æ˜¯ä¸€å°æœåŠ¡å™¨ï¼Œæ¥å…¥çš„ç”¨æˆ·ç½‘ç»œç¯å¢ƒä¹Ÿåƒå·®ä¸‡åˆ«ï¼Œç»“åˆå¤§æ•°æ®åŠäººå·¥æ™ºèƒ½å¤„ç†ï¼Œæˆ‘ä»¬èƒ½ä¸ºå„ä¸ªç”¨æˆ·æä¾›ä¸åŒçš„ä½†åˆæ›´åŠ ç²¾å‡†æ›´åŠ æœ‰æ•ˆçš„æ‹¥å¡æ§åˆ¶ã€‚æ¯”å¦‚ BBR é€‚åˆï¼ŒCubic é€‚åˆã€‚</li><li>åº”ç”¨ç¨‹åºä¸éœ€è¦åœæœºå’Œå‡çº§å°±èƒ½å®ç°æ‹¥å¡æ§åˆ¶çš„å˜æ›´ï¼Œæˆ‘ä»¬åœ¨æœåŠ¡ç«¯åªéœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®ï¼Œreload ä¸€ä¸‹ï¼Œå®Œå…¨ä¸éœ€è¦åœæ­¢æœåŠ¡å°±èƒ½å®ç°æ‹¥å¡æ§åˆ¶çš„åˆ‡æ¢ã€‚</li></ol><p>STGW åœ¨é…ç½®å±‚é¢è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸åŒä¸šåŠ¡ï¼Œä¸åŒç½‘ç»œåˆ¶å¼ï¼Œç”šè‡³ä¸åŒçš„ RTTï¼Œä½¿ç”¨ä¸åŒçš„æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚</p><ul><li><strong>å•è°ƒé€’å¢çš„ Packet Number</strong></li></ul><p>TCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œä½¿ç”¨äº†åŸºäºå­—èŠ‚åºå·çš„ Sequence Number åŠ Ack æ¥ç¡®è®¤æ¶ˆæ¯çš„æœ‰åºåˆ°è¾¾ã€‚</p><p>QUIC åŒæ ·æ˜¯ä¸€ä¸ªå¯é çš„åè®®ï¼Œå®ƒä½¿ç”¨ Packet Number ä»£æ›¿äº† TCP çš„ sequence numberï¼Œå¹¶ä¸”æ¯ä¸ª Packet Number éƒ½ä¸¥æ ¼é€’å¢ï¼Œä¹Ÿå°±æ˜¯è¯´å°±ç®— Packet N ä¸¢å¤±äº†ï¼Œé‡ä¼ çš„ Packet N çš„ Packet Number å·²ç»ä¸æ˜¯ Nï¼Œè€Œæ˜¯ä¸€ä¸ªæ¯” N å¤§çš„å€¼ã€‚è€Œ TCP å‘¢ï¼Œé‡ä¼  segment çš„ sequence number å’ŒåŸå§‹çš„ segment çš„ Sequence Number ä¿æŒä¸å˜ï¼Œä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸ªç‰¹æ€§ï¼Œå¼•å…¥äº† Tcp é‡ä¼ çš„æ­§ä¹‰é—®é¢˜ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izrp5123j30k008rjro.jpg" alt="img"></p><p>â€‹ å›¾ 2 Tcp é‡ä¼ æ­§ä¹‰æ€§</p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¶…æ—¶äº‹ä»¶ RTO å‘ç”Ÿåï¼Œå®¢æˆ·ç«¯å‘èµ·é‡ä¼ ï¼Œç„¶åæ¥æ”¶åˆ°äº† Ack æ•°æ®ã€‚ç”±äºåºåˆ—å·ä¸€æ ·ï¼Œè¿™ä¸ª Ack æ•°æ®åˆ°åº•æ˜¯åŸå§‹è¯·æ±‚çš„å“åº”è¿˜æ˜¯é‡ä¼ è¯·æ±‚çš„å“åº”å‘¢ï¼Ÿä¸å¥½åˆ¤æ–­ã€‚</p><p>å¦‚æœç®—æˆåŸå§‹è¯·æ±‚çš„å“åº”ï¼Œä½†å®é™…ä¸Šæ˜¯é‡ä¼ è¯·æ±‚çš„å“åº”ï¼ˆä¸Šå›¾å·¦ï¼‰ï¼Œä¼šå¯¼è‡´é‡‡æ · RTT å˜å¤§ã€‚å¦‚æœç®—æˆé‡ä¼ è¯·æ±‚çš„å“åº”ï¼Œä½†å®é™…ä¸Šæ˜¯åŸå§‹è¯·æ±‚çš„å“åº”ï¼Œåˆå¾ˆå®¹æ˜“å¯¼è‡´é‡‡æ · RTT è¿‡å°ã€‚</p><p>ç”±äº Quic é‡ä¼ çš„ Packet å’ŒåŸå§‹ Packet çš„ Pakcet Number æ˜¯ä¸¥æ ¼é€’å¢çš„ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izrs95mpj30k007xjrn.jpg" alt="img"></p><p>â€‹ å›¾ 3 Quic é‡ä¼ æ²¡æœ‰æ­§ä¹‰æ€§</p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒRTO å‘ç”Ÿåï¼Œæ ¹æ®é‡ä¼ çš„ Packet Number å°±èƒ½ç¡®å®šç²¾ç¡®çš„ RTT è®¡ç®—ã€‚å¦‚æœ Ack çš„ Packet Number æ˜¯ N+Mï¼Œå°±æ ¹æ®é‡ä¼ è¯·æ±‚è®¡ç®—é‡‡æ · RTTã€‚å¦‚æœ Ack çš„ Pakcet Number æ˜¯ Nï¼Œå°±æ ¹æ®åŸå§‹è¯·æ±‚çš„æ—¶é—´è®¡ç®—é‡‡æ · RTTï¼Œæ²¡æœ‰æ­§ä¹‰æ€§ã€‚</p><p>ä½†æ˜¯å•çº¯ä¾é ä¸¥æ ¼é€’å¢çš„ Packet Number è‚¯å®šæ˜¯æ— æ³•ä¿è¯æ•°æ®çš„é¡ºåºæ€§å’Œå¯é æ€§ã€‚QUIC åˆå¼•å…¥äº†ä¸€ä¸ª Stream Offset çš„æ¦‚å¿µã€‚</p><p>å³ä¸€ä¸ª Stream å¯ä»¥ç»è¿‡å¤šä¸ª Packet ä¼ è¾“ï¼ŒPacket Number ä¸¥æ ¼é€’å¢ï¼Œæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯ Packet é‡Œçš„ Payload å¦‚æœæ˜¯ Stream çš„è¯ï¼Œå°±éœ€è¦ä¾é  Stream çš„ Offset æ¥ä¿è¯åº”ç”¨æ•°æ®çš„é¡ºåºã€‚å¦‚é”™è¯¯! æœªæ‰¾åˆ°å¼•ç”¨æºã€‚æ‰€ç¤ºï¼Œå‘é€ç«¯å…ˆåå‘é€äº† Pakcet N å’Œ Pakcet N+1ï¼ŒStream çš„ Offset åˆ†åˆ«æ˜¯ x å’Œ x+yã€‚</p><p>å‡è®¾ Packet N ä¸¢å¤±äº†ï¼Œå‘èµ·é‡ä¼ ï¼Œé‡ä¼ çš„ Packet Number æ˜¯ N+2ï¼Œä½†æ˜¯å®ƒçš„ Stream çš„ Offset ä¾ç„¶æ˜¯ xï¼Œè¿™æ ·å°±ç®— Packet N + 2 æ˜¯ååˆ°çš„ï¼Œä¾ç„¶å¯ä»¥å°† Stream x å’Œ Stream x+y æŒ‰ç…§é¡ºåºç»„ç»‡èµ·æ¥ï¼Œäº¤ç»™åº”ç”¨ç¨‹åºå¤„ç†ã€‚<br><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izrw4o31j30k005smxc.jpg" alt="img"></p><p>â€‹ å›¾ 4 Stream Offset ä¿è¯æœ‰åºæ€§</p><ul><li><strong>ä¸å…è®¸ Reneging</strong></li></ul><p>ä»€ä¹ˆå« Reneging å‘¢ï¼Ÿå°±æ˜¯æ¥æ”¶æ–¹ä¸¢å¼ƒå·²ç»æ¥æ”¶å¹¶ä¸”ä¸ŠæŠ¥ç»™ SACK é€‰é¡¹çš„å†…å®¹ã€‚TCP åè®®ä¸é¼“åŠ±è¿™ç§è¡Œä¸ºï¼Œä½†æ˜¯åè®®å±‚é¢å…è®¸è¿™æ ·çš„è¡Œä¸ºã€‚ä¸»è¦æ˜¯è€ƒè™‘åˆ°æœåŠ¡å™¨èµ„æºæœ‰é™ï¼Œæ¯”å¦‚ Buffer æº¢å‡ºï¼Œå†…å­˜ä¸å¤Ÿç­‰æƒ…å†µã€‚</p><p>Reneging å¯¹æ•°æ®é‡ä¼ ä¼šäº§ç”Ÿå¾ˆå¤§çš„å¹²æ‰°ã€‚å› ä¸º Sack éƒ½å·²ç»è¡¨æ˜æ¥æ”¶åˆ°äº†ï¼Œä½†æ˜¯æ¥æ”¶ç«¯äº‹å®ä¸Šä¸¢å¼ƒäº†è¯¥æ•°æ®ã€‚</p><p>QUIC åœ¨åè®®å±‚é¢ç¦æ­¢ Renegingï¼Œä¸€ä¸ª Packet åªè¦è¢« Ackï¼Œå°±è®¤ä¸ºå®ƒä¸€å®šè¢«æ­£ç¡®æ¥æ”¶ï¼Œå‡å°‘äº†è¿™ç§å¹²æ‰°ã€‚</p><ul><li><strong>æ›´å¤šçš„ Ack å—</strong></li></ul><p>TCP çš„ Sack é€‰é¡¹èƒ½å¤Ÿå‘Šè¯‰å‘é€æ–¹å·²ç»æ¥æ”¶åˆ°çš„è¿ç»­ Segment çš„èŒƒå›´ï¼Œæ–¹ä¾¿å‘é€æ–¹è¿›è¡Œé€‰æ‹©æ€§é‡ä¼ ã€‚</p><p>ç”±äº TCP å¤´éƒ¨æœ€å¤§åªæœ‰ 60 ä¸ªå­—èŠ‚ï¼Œæ ‡å‡†å¤´éƒ¨å ç”¨äº† 20 å­—èŠ‚ï¼Œæ‰€ä»¥ Tcp Option æœ€å¤§é•¿åº¦åªæœ‰ 40 å­—èŠ‚ï¼Œå†åŠ ä¸Š Tcp Timestamp option å ç”¨äº† 10 ä¸ªå­—èŠ‚ [25]ï¼Œæ‰€ä»¥ç•™ç»™ Sack é€‰é¡¹çš„åªæœ‰ 30 ä¸ªå­—èŠ‚ã€‚</p><p>æ¯ä¸€ä¸ª Sack Block çš„é•¿åº¦æ˜¯ 8 ä¸ªï¼ŒåŠ ä¸Š Sack Option å¤´éƒ¨ 2 ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ„å‘³ç€ Tcp Sack Option æœ€å¤§åªèƒ½æä¾› 3 ä¸ª Blockã€‚</p><p>ä½†æ˜¯ Quic Ack Frame å¯ä»¥åŒæ—¶æä¾› 256 ä¸ª Ack Blockï¼Œåœ¨ä¸¢åŒ…ç‡æ¯”è¾ƒé«˜çš„ç½‘ç»œä¸‹ï¼Œæ›´å¤šçš„ Sack Block å¯ä»¥æå‡ç½‘ç»œçš„æ¢å¤é€Ÿåº¦ï¼Œå‡å°‘é‡ä¼ é‡ã€‚</p><ul><li><strong>Ack Delay æ—¶é—´</strong></li></ul><p>Tcp çš„ Timestamp é€‰é¡¹å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒåªæ˜¯å›æ˜¾äº†å‘é€æ–¹çš„æ—¶é—´æˆ³ï¼Œä½†æ˜¯æ²¡æœ‰è®¡ç®—æ¥æ”¶ç«¯æ¥æ”¶åˆ° segment åˆ°å‘é€ Ack è¯¥ segment çš„æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´å¯ä»¥ç®€ç§°ä¸º Ack Delayã€‚</p><p>è¿™æ ·å°±ä¼šå¯¼è‡´ RTT è®¡ç®—è¯¯å·®ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izrzqtwlj30k00f4wf5.jpg" alt="img"></p><p>å¯ä»¥è®¤ä¸º TCP çš„ RTT è®¡ç®—ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izs42dncj308d015743.jpg" alt="img"></p><p>è€Œ Quic è®¡ç®—å¦‚ä¸‹ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izs6x1lbj30a70153yc.jpg" alt="img"></p><p>å½“ç„¶ RTT çš„å…·ä½“è®¡ç®—æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œéœ€è¦é‡‡æ ·ï¼Œå‚è€ƒå†å²æ•°å€¼è¿›è¡Œå¹³æ»‘è®¡ç®—ï¼Œå‚è€ƒå¦‚ä¸‹å…¬å¼ [9]ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izs9tffbj308d01vwed.jpg" alt="img"></p><h3 id="3-åŸºäº-stream-å’Œ-connecton-çº§åˆ«çš„æµé‡æ§åˆ¶"><a href="#3-åŸºäº-stream-å’Œ-connecton-çº§åˆ«çš„æµé‡æ§åˆ¶" class="headerlink" title="3.åŸºäº stream å’Œ connecton çº§åˆ«çš„æµé‡æ§åˆ¶"></a>3.åŸºäº stream å’Œ connecton çº§åˆ«çš„æµé‡æ§åˆ¶</h3><p>QUIC çš„æµé‡æ§åˆ¶ç±»ä¼¼ HTTP2ï¼Œå³åœ¨ Connection å’Œ Stream çº§åˆ«æä¾›äº†ä¸¤ç§æµé‡æ§åˆ¶ã€‚ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç±»æµé‡æ§åˆ¶å‘¢ï¼Ÿä¸»è¦æ˜¯å› ä¸º QUIC æ”¯æŒå¤šè·¯å¤ç”¨ã€‚</p><ol><li>Stream å¯ä»¥è®¤ä¸ºå°±æ˜¯ä¸€æ¡ HTTP è¯·æ±‚ã€‚</li><li>Connection å¯ä»¥ç±»æ¯”ä¸€æ¡ TCP è¿æ¥ã€‚å¤šè·¯å¤ç”¨æ„å‘³ç€åœ¨ä¸€æ¡ Connetion ä¸Šä¼šåŒæ—¶å­˜åœ¨å¤šæ¡ Streamã€‚æ—¢éœ€è¦å¯¹å•ä¸ª Stream è¿›è¡Œæ§åˆ¶ï¼Œåˆéœ€è¦é’ˆå¯¹æ‰€æœ‰ Stream è¿›è¡Œæ€»ä½“æ§åˆ¶ã€‚</li></ol><p>QUIC å®ç°æµé‡æ§åˆ¶çš„åŸç†æ¯”è¾ƒç®€å•ï¼š</p><p>é€šè¿‡ window_update å¸§å‘Šè¯‰å¯¹ç«¯è‡ªå·±å¯ä»¥æ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å‘é€æ–¹å°±ä¸ä¼šå‘é€è¶…è¿‡è¿™ä¸ªæ•°é‡çš„æ•°æ®ã€‚</p><p>é€šè¿‡ BlockFrame å‘Šè¯‰å¯¹ç«¯ç”±äºæµé‡æ§åˆ¶è¢«é˜»å¡äº†ï¼Œæ— æ³•å‘é€æ•°æ®ã€‚</p><p>QUIC çš„æµé‡æ§åˆ¶å’Œ TCP æœ‰ç‚¹åŒºåˆ«ï¼ŒTCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œçª—å£å·¦è¾¹æ²¿å‘å³æ»‘åŠ¨æ—¶çš„é•¿åº¦å–å†³äºå·²ç»ç¡®è®¤çš„å­—èŠ‚æ•°ã€‚å¦‚æœä¸­é—´å‡ºç°ä¸¢åŒ…ï¼Œå°±ç®—æ¥æ”¶åˆ°äº†æ›´å¤§åºå·çš„ Segmentï¼Œçª—å£ä¹Ÿæ— æ³•è¶…è¿‡è¿™ä¸ªåºåˆ—å·ã€‚</p><p>ä½† QUIC ä¸åŒï¼Œå°±ç®—æ­¤å‰æœ‰äº› packet æ²¡æœ‰æ¥æ”¶åˆ°ï¼Œå®ƒçš„æ»‘åŠ¨åªå–å†³äºæ¥æ”¶åˆ°çš„æœ€å¤§åç§»å­—èŠ‚æ•°ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izsddv9lj30k0087q3a.jpg" alt="img"></p><p>â€‹ å›¾ 5 Quic Flow Control</p><p>é’ˆå¯¹ Streamï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izsh7d39j30bz011glh.jpg" alt="img"></p><p>é’ˆå¯¹ Connectionï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izsk0cpyj30gy011a9z.jpg" alt="img"></p><p>åŒæ ·åœ°ï¼ŒSTGW ä¹Ÿåœ¨è¿æ¥å’Œ Stream çº§åˆ«è®¾ç½®äº†ä¸åŒçš„çª—å£æ•°ã€‚</p><p>æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å†…å­˜ä¸è¶³æˆ–è€…ä¸Šæ¸¸å¤„ç†æ€§èƒ½å‡ºç°é—®é¢˜æ—¶ï¼Œé€šè¿‡æµé‡æ§åˆ¶æ¥é™åˆ¶ä¼ è¾“é€Ÿç‡ï¼Œä¿éšœæœåŠ¡å¯ç”¨æ€§ã€‚</p><h3 id="4-æ²¡æœ‰é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨"><a href="#4-æ²¡æœ‰é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨" class="headerlink" title="4.æ²¡æœ‰é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨"></a>4.æ²¡æœ‰é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨</h3><p>QUIC çš„å¤šè·¯å¤ç”¨å’Œ HTTP2 ç±»ä¼¼ã€‚åœ¨ä¸€æ¡ QUIC è¿æ¥ä¸Šå¯ä»¥å¹¶å‘å‘é€å¤šä¸ª HTTP è¯·æ±‚ (stream)ã€‚ä½†æ˜¯ QUIC çš„å¤šè·¯å¤ç”¨ç›¸æ¯” HTTP2 æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŠ¿ã€‚</p><p>QUIC ä¸€ä¸ªè¿æ¥ä¸Šçš„å¤šä¸ª stream ä¹‹é—´æ²¡æœ‰ä¾èµ–ã€‚è¿™æ ·å‡å¦‚ stream2 ä¸¢äº†ä¸€ä¸ª udp packetï¼Œä¹Ÿåªä¼šå½±å“ stream2 çš„å¤„ç†ã€‚ä¸ä¼šå½±å“ stream2 ä¹‹å‰åŠä¹‹åçš„ stream çš„å¤„ç†ã€‚</p><p>è¿™ä¹Ÿå°±åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šç¼“è§£ç”šè‡³æ¶ˆé™¤äº†é˜Ÿå¤´é˜»å¡çš„å½±å“ã€‚</p><p>å¤šè·¯å¤ç”¨æ˜¯ HTTP2 æœ€å¼ºå¤§çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿå°†å¤šæ¡è¯·æ±‚åœ¨ä¸€æ¡ TCP è¿æ¥ä¸ŠåŒæ—¶å‘å‡ºå»ã€‚ä½†ä¹Ÿæ¶åŒ–äº† TCP çš„ä¸€ä¸ªé—®é¢˜ï¼Œé˜Ÿå¤´é˜»å¡ï¼Œå¦‚ä¸‹å›¾ç¤ºï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izsn9t0ej30k007gq3a.jpg" alt="img"></p><p>â€‹ å›¾ 6 HTTP2 é˜Ÿå¤´é˜»å¡</p><p>HTTP2 åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸ŠåŒæ—¶å‘é€ 4 ä¸ª Streamã€‚å…¶ä¸­ Stream1 å·²ç»æ­£ç¡®åˆ°è¾¾ï¼Œå¹¶è¢«åº”ç”¨å±‚è¯»å–ã€‚ä½†æ˜¯ Stream2 çš„ç¬¬ä¸‰ä¸ª tcp segment ä¸¢å¤±äº†ï¼ŒTCP ä¸ºäº†ä¿è¯æ•°æ®çš„å¯é æ€§ï¼Œéœ€è¦å‘é€ç«¯é‡ä¼ ç¬¬ 3 ä¸ª segment æ‰èƒ½é€šçŸ¥åº”ç”¨å±‚è¯»å–æ¥ä¸‹å»çš„æ•°æ®ï¼Œè™½ç„¶è¿™ä¸ªæ—¶å€™ Stream3 å’Œ Stream4 çš„å…¨éƒ¨æ•°æ®å·²ç»åˆ°è¾¾äº†æ¥æ”¶ç«¯ï¼Œä½†éƒ½è¢«é˜»å¡ä½äº†ã€‚</p><p>ä¸ä»…å¦‚æ­¤ï¼Œç”±äº HTTP2 å¼ºåˆ¶ä½¿ç”¨ TLSï¼Œè¿˜å­˜åœ¨ä¸€ä¸ª TLS åè®®å±‚é¢çš„é˜Ÿå¤´é˜»å¡ [12]ã€‚<br><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izsr1djhj30k00ctaac.jpg" alt="img"></p><p>â€‹ å›¾ 7 TLS é˜Ÿå¤´é˜»å¡</p><p>Record æ˜¯ TLS åè®®å¤„ç†çš„æœ€å°å•ä½ï¼Œæœ€å¤§ä¸èƒ½è¶…è¿‡ 16Kï¼Œä¸€äº›æœåŠ¡å™¨æ¯”å¦‚ Nginx é»˜è®¤çš„å¤§å°å°±æ˜¯ 16Kã€‚ç”±äºä¸€ä¸ª record å¿…é¡»ç»è¿‡æ•°æ®ä¸€è‡´æ€§æ ¡éªŒæ‰èƒ½è¿›è¡ŒåŠ è§£å¯†ï¼Œæ‰€ä»¥ä¸€ä¸ª 16K çš„ recordï¼Œå°±ç®—ä¸¢äº†ä¸€ä¸ªå­—èŠ‚ï¼Œä¹Ÿä¼šå¯¼è‡´å·²ç»æ¥æ”¶åˆ°çš„ 15.99K æ•°æ®æ— æ³•å¤„ç†ï¼Œå› ä¸ºå®ƒä¸å®Œæ•´ã€‚</p><p>é‚£ QUIC å¤šè·¯å¤ç”¨ä¸ºä»€ä¹ˆèƒ½é¿å…ä¸Šè¿°é—®é¢˜å‘¢ï¼Ÿ</p><ol><li>QUIC æœ€åŸºæœ¬çš„ä¼ è¾“å•å…ƒæ˜¯ Packetï¼Œä¸ä¼šè¶…è¿‡ MTU çš„å¤§å°ï¼Œæ•´ä¸ªåŠ å¯†å’Œè®¤è¯è¿‡ç¨‹éƒ½æ˜¯åŸºäº Packet çš„ï¼Œä¸ä¼šè·¨è¶Šå¤šä¸ª Packetã€‚è¿™æ ·å°±èƒ½é¿å… TLS åè®®å­˜åœ¨çš„é˜Ÿå¤´é˜»å¡ã€‚</li><li>Stream ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ¯”å¦‚ Stream2 ä¸¢äº†ä¸€ä¸ª Pakcetï¼Œä¸ä¼šå½±å“ Stream3 å’Œ Stream4ã€‚ä¸å­˜åœ¨ TCP é˜Ÿå¤´é˜»å¡ã€‚ï¼ˆQUIC åè®®ç›´æ¥é€šè¿‡åº•å±‚ä½¿ç”¨ UDP åè®®å¤©ç„¶çš„é¿å…äº†è¯¥é—®é¢˜ã€‚ç”±äº UDP åè®®æ²¡æœ‰ä¸¥æ ¼çš„é¡ºåºï¼Œå½“ä¸€ä¸ªæ•°æ®åŒ…é‡åˆ°é—®é¢˜éœ€è¦é‡ä¼ æ—¶ï¼Œåªä¼šå½±å“è¯¥æ•°æ®åŒ…å¯¹åº”çš„èµ„æºï¼Œå…¶ä»–ç‹¬ç«‹çš„èµ„æºï¼ˆå¦‚å…¶ä»– cssã€js æ–‡ä»¶ï¼‰ä¸ä¼šå—åˆ°å½±å“ï¼‰</li></ol><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izsvoeyqj30k007gdg7.jpg" alt="img"></p><p>â€‹ å›¾ 8 QUIC å¤šè·¯å¤ç”¨æ—¶æ²¡æœ‰é˜Ÿå¤´é˜»å¡çš„é—®é¢˜</p><p>å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ QUIC æ•°æ®éƒ½ä¸ä¼šå—åˆ°é˜Ÿå¤´é˜»å¡çš„å½±å“ï¼Œæ¯”å¦‚ QUIC å½“å‰ä¹Ÿæ˜¯ä½¿ç”¨ Hpack å‹ç¼©ç®—æ³• [10]ï¼Œç”±äºç®—æ³•çš„é™åˆ¶ï¼Œä¸¢å¤±ä¸€ä¸ªå¤´éƒ¨æ•°æ®æ—¶ï¼Œå¯èƒ½é‡åˆ°é˜Ÿå¤´é˜»å¡ã€‚</p><p>æ€»ä½“æ¥è¯´ï¼ŒQUIC åœ¨ä¼ è¾“å¤§é‡æ•°æ®æ—¶ï¼Œæ¯”å¦‚è§†é¢‘ï¼Œå—åˆ°é˜Ÿå¤´é˜»å¡çš„å½±å“å¾ˆå°ã€‚</p><h3 id="5-åŠ å¯†è®¤è¯çš„æŠ¥æ–‡"><a href="#5-åŠ å¯†è®¤è¯çš„æŠ¥æ–‡" class="headerlink" title="5.åŠ å¯†è®¤è¯çš„æŠ¥æ–‡"></a>5.åŠ å¯†è®¤è¯çš„æŠ¥æ–‡</h3><p>TCP åè®®å¤´éƒ¨æ²¡æœ‰ç»è¿‡ä»»ä½•åŠ å¯†å’Œè®¤è¯ï¼Œæ‰€ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¾ˆå®¹æ˜“è¢«ä¸­é—´ç½‘ç»œè®¾å¤‡ç¯¡æ”¹ï¼Œæ³¨å…¥å’Œçªƒå¬ã€‚æ¯”å¦‚ä¿®æ”¹åºåˆ—å·ã€æ»‘åŠ¨çª—å£ã€‚è¿™äº›è¡Œä¸ºæœ‰å¯èƒ½æ˜¯å‡ºäºæ€§èƒ½ä¼˜åŒ–ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸»åŠ¨æ”»å‡»ã€‚</p><p>ä½†æ˜¯ QUIC çš„ packet å¯ä»¥è¯´æ˜¯æ­¦è£…åˆ°äº†ç‰™é½¿ã€‚é™¤äº†ä¸ªåˆ«æŠ¥æ–‡æ¯”å¦‚ PUBLIC_RESET å’Œ CHLOï¼Œæ‰€æœ‰æŠ¥æ–‡å¤´éƒ¨éƒ½æ˜¯ç»è¿‡è®¤è¯çš„ï¼ŒæŠ¥æ–‡ Body éƒ½æ˜¯ç»è¿‡åŠ å¯†çš„ã€‚</p><p>è¿™æ ·åªè¦å¯¹ QUIC æŠ¥æ–‡ä»»ä½•ä¿®æ”¹ï¼Œæ¥æ”¶ç«¯éƒ½èƒ½å¤ŸåŠæ—¶å‘ç°ï¼Œæœ‰æ•ˆåœ°é™ä½äº†å®‰å…¨é£é™©ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œçº¢è‰²éƒ¨åˆ†æ˜¯ Stream Frame çš„æŠ¥æ–‡å¤´éƒ¨ï¼Œæœ‰è®¤è¯ã€‚ç»¿è‰²éƒ¨åˆ†æ˜¯æŠ¥æ–‡å†…å®¹ï¼Œå…¨éƒ¨ç»è¿‡åŠ å¯†ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izsyv3ovj30i3091dgf.jpg" alt="img"></p><h3 id="6-è¿æ¥è¿ç§»"><a href="#6-è¿æ¥è¿ç§»" class="headerlink" title="6.è¿æ¥è¿ç§»"></a>6.è¿æ¥è¿ç§»</h3><p>ä¸€æ¡ TCP è¿æ¥æ˜¯ç”±å››å…ƒç»„æ ‡è¯†çš„ï¼ˆæº IPï¼Œæºç«¯å£ï¼Œç›®çš„ IPï¼Œç›®çš„ç«¯å£ï¼‰ã€‚ä»€ä¹ˆå«è¿æ¥è¿ç§»å‘¢ï¼Ÿå°±æ˜¯å½“å…¶ä¸­ä»»ä½•ä¸€ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™æ¡è¿æ¥ä¾ç„¶ç»´æŒç€ï¼Œèƒ½å¤Ÿä¿æŒä¸šåŠ¡é€»è¾‘ä¸ä¸­æ–­ã€‚å½“ç„¶è¿™é‡Œé¢ä¸»è¦å…³æ³¨çš„æ˜¯å®¢æˆ·ç«¯çš„å˜åŒ–ï¼Œå› ä¸ºå®¢æˆ·ç«¯ä¸å¯æ§å¹¶ä¸”ç½‘ç»œç¯å¢ƒç»å¸¸å‘ç”Ÿå˜åŒ–ï¼Œè€ŒæœåŠ¡ç«¯çš„ IP å’Œç«¯å£ä¸€èˆ¬éƒ½æ˜¯å›ºå®šçš„ã€‚</p><p>æ¯”å¦‚å¤§å®¶ä½¿ç”¨æ‰‹æœºåœ¨ WIFI å’Œ 4G ç§»åŠ¨ç½‘ç»œåˆ‡æ¢æ—¶ï¼Œå®¢æˆ·ç«¯çš„ IP è‚¯å®šä¼šå‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦é‡æ–°å»ºç«‹å’ŒæœåŠ¡ç«¯çš„ TCP è¿æ¥ã€‚</p><p>åˆæ¯”å¦‚å¤§å®¶ä½¿ç”¨å…¬å…± NAT å‡ºå£æ—¶ï¼Œæœ‰äº›è¿æ¥ç«äº‰æ—¶éœ€è¦é‡æ–°ç»‘å®šç«¯å£ï¼Œå¯¼è‡´å®¢æˆ·ç«¯çš„ç«¯å£å‘ç”Ÿå˜åŒ–ï¼ŒåŒæ ·éœ€è¦é‡æ–°å»ºç«‹ TCP è¿æ¥ã€‚</p><p>é’ˆå¯¹ TCP çš„è¿æ¥å˜åŒ–ï¼ŒMPTCP å…¶å®å·²ç»æœ‰äº†è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ç”±äº MPTCP éœ€è¦æ“ä½œç³»ç»ŸåŠç½‘ç»œåè®®æ ˆæ”¯æŒï¼Œéƒ¨ç½²é˜»åŠ›éå¸¸å¤§ï¼Œç›®å‰å¹¶ä¸é€‚ç”¨ã€‚</p><p>æ‰€ä»¥ä» TCP è¿æ¥çš„è§’åº¦æ¥è®²ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯æ— è§£çš„ã€‚</p><p>é‚£ QUIC æ˜¯å¦‚ä½•åšåˆ°è¿æ¥è¿ç§»å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä»»ä½•ä¸€æ¡ QUIC è¿æ¥ä¸å†ä»¥ IP åŠç«¯å£å››å…ƒç»„æ ‡è¯†ï¼Œè€Œæ˜¯ä»¥ä¸€ä¸ª 64 ä½çš„éšæœºæ•°ä½œä¸º ID æ¥æ ‡è¯†ï¼Œè¿™æ ·å°±ç®— IP æˆ–è€…ç«¯å£å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªè¦ ID ä¸å˜ï¼Œè¿™æ¡è¿æ¥ä¾ç„¶ç»´æŒç€ï¼Œä¸Šå±‚ä¸šåŠ¡é€»è¾‘æ„ŸçŸ¥ä¸åˆ°å˜åŒ–ï¼Œä¸ä¼šä¸­æ–­ï¼Œä¹Ÿå°±ä¸éœ€è¦é‡è¿ã€‚</p><p>ç”±äºè¿™ä¸ª ID æ˜¯å®¢æˆ·ç«¯éšæœºäº§ç”Ÿçš„ï¼Œå¹¶ä¸”é•¿åº¦æœ‰ 64 ä½ï¼Œæ‰€ä»¥å†²çªæ¦‚ç‡éå¸¸ä½ã€‚</p><h3 id="7-å…¶ä»–äº®ç‚¹"><a href="#7-å…¶ä»–äº®ç‚¹" class="headerlink" title="7.å…¶ä»–äº®ç‚¹"></a>7.å…¶ä»–äº®ç‚¹</h3><p>æ­¤å¤–ï¼ŒQUIC è¿˜èƒ½å®ç°å‰å‘å†—ä½™çº é”™ï¼Œåœ¨é‡è¦çš„åŒ…æ¯”å¦‚æ¡æ‰‹æ¶ˆæ¯å‘ç”Ÿä¸¢å¤±æ—¶ï¼Œèƒ½å¤Ÿæ ¹æ®å†—ä½™ä¿¡æ¯è¿˜åŸå‡ºæ¡æ‰‹æ¶ˆæ¯ã€‚</p><p>QUIC è¿˜èƒ½å®ç°è¯ä¹¦å‹ç¼©ï¼Œå‡å°‘è¯ä¹¦ä¼ è¾“é‡ï¼Œé’ˆå¯¹åŒ…å¤´è¿›è¡ŒéªŒè¯ç­‰ã€‚</p><h2 id="QUIC-åè®®å®è·µ"><a href="#QUIC-åè®®å®è·µ" class="headerlink" title="QUIC åè®®å®è·µ"></a>QUIC åè®®å®è·µ</h2><p>Chrome æµè§ˆå™¨ä» 2014 å¹´å¼€å§‹å·²ç»å®éªŒæ€§çš„æ”¯æŒäº† QUIC åè®®ã€‚å¯ä»¥é€šè¿‡åœ¨ Chrome æµè§ˆå™¨ä¸­è¾“å…¥<code>chrome://net-internals/#quic</code>æŸ¥çœ‹æ˜¯å¦å·²ç»æ”¯æŒ QUIC åè®®ã€‚å¦‚æœè¿˜æœªæ”¯æŒï¼Œå¯ä»¥åœ¨<code>chrome://flags/#enable-quic</code>ä¸­è¿›è¡Œå¼€å¯ã€‚</p><p>å¼€å§‹ Chrome æµè§ˆå™¨å¯¹ QUIC åè®®çš„æ”¯æŒä¹‹åï¼Œå¯ä»¥åœ¨<code>chrome://net-internals/#quic</code>ä¸­æŸ¥çœ‹åˆ°å½“å‰æµè§ˆå™¨çš„ QUIC ä¸€äº›è¿æ¥ã€‚å½“ç„¶ç›®å‰åªæœ‰ Google æœåŠ¡æ‰æ”¯æŒ QUIC åè®®ï¼ˆå¦‚ YouTubeã€ Google.comï¼‰ã€‚</p><h3 id="1-å…³äºé˜²ç«å¢™"><a href="#1-å…³äºé˜²ç«å¢™" class="headerlink" title="1. å…³äºé˜²ç«å¢™"></a>1. å…³äºé˜²ç«å¢™</h3><p>é€šå¸¸ç³»ç»Ÿç®¡ç†å‘˜ä¼šå…³æ³¨é˜²ç«å¢™çš„ TCP è§„åˆ™ï¼Œè€Œå¿½ç•¥ UDP è§„åˆ™ã€‚å¦‚æœè¦åœ¨é˜²ç«å¢™ä¹‹åä½¿ç”¨ QUIC åè®®ï¼Œé™¤äº†ä¼ ç»Ÿ web æœåŠ¡éœ€è¦å¼€æ”¾çš„<code>80/TCP</code>ã€<code>443/TCP</code>ä¹‹å¤–ï¼Œé’ˆå¯¹ QUIC è¿˜éœ€è¦å¼€æ”¾<code>443/UDP</code>çš„è®¿é—®ã€‚</p><h3 id="2-æœåŠ¡ç«¯ä½¿ç”¨-QUIC-åè®®"><a href="#2-æœåŠ¡ç«¯ä½¿ç”¨-QUIC-åè®®" class="headerlink" title="2.æœåŠ¡ç«¯ä½¿ç”¨ QUIC åè®®"></a>2.æœåŠ¡ç«¯ä½¿ç”¨ QUIC åè®®</h3><p>ç›®å‰æ”¯æŒ QUIC åè®®çš„ web æœåŠ¡åªæœ‰ 0.9 ç‰ˆæœ¬ä»¥åçš„<a href="https://github.com/mholt/caddy/wiki/QUIC" target="_blank" rel="noopener">Caddy</a>ã€‚å…¶ä»–å¸¸ç”¨ web æœåŠ¡å¦‚ nginxã€apache ç­‰éƒ½æœªå¼€å§‹æ”¯æŒã€‚curl è¡¨è¾¾äº†å¯¹ QUIC åè®®<a href="https://daniel.haxx.se/blog/2016/07/20/curl-wants-to-quic/" target="_blank" rel="noopener">æ”¯æŒçš„å…´è¶£</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;QUIC&quot;&gt;&lt;a href=&quot;#QUIC&quot; class=&quot;headerlink&quot; title=&quot;QUIC&quot;&gt;&lt;/a&gt;QUIC&lt;/h1&gt;&lt;h2 id=&quot;QUIC-æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#QUIC-æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;QUIC æ¦‚è¿°&quot;&gt;&lt;/a&gt;QUIC æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;Quic å…¨ç§° quick udp internet connection [1]ï¼Œâ€œå¿«é€Ÿ UDP äº’è”ç½‘è¿æ¥â€ï¼Œï¼ˆå’Œè‹±æ–‡ quick è°éŸ³ï¼Œç®€ç§°â€œå¿«â€ï¼‰æ˜¯ç”± google æå‡ºçš„ä½¿ç”¨ udp è¿›è¡Œå¤šè·¯å¹¶å‘ä¼ è¾“çš„åè®®ã€‚&lt;/p&gt;
&lt;p&gt;QUIC åè®®å†…ç½®äº† TLS æ ˆï¼Œå®ç°äº†è‡ªå·±çš„&lt;a href=&quot;https://docs.google.com/document/d/1g5nIXAIkN_Y-7XJW5K45IblHd_L2f5LTaDUDwvZ5L6g/edit&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¼ è¾“åŠ å¯†å±‚&lt;/a&gt;ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„ TLS 1.2ã€‚åŒæ—¶ QUIC è¿˜åŒ…å«äº†éƒ¨åˆ† HTTP/2 çš„å®ç°ï¼Œå› æ­¤ QUIC çš„åœ°ä½çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
      <category term="TCP/IP" scheme="http://yoursite.com/tags/TCP-IP/"/>
    
  </entry>
  
  <entry>
    <title>TCP</title>
    <link href="http://yoursite.com/2019/08/11/TCP/"/>
    <id>http://yoursite.com/2019/08/11/TCP/</id>
    <published>2019-08-11T13:15:33.000Z</published>
    <updated>2019-11-10T14:37:39.023Z</updated>
    
    <content type="html"><![CDATA[<h1 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h1><ul><li>TCP åœ¨ç½‘ç»œ OSI çš„ä¸ƒå±‚æ¨¡å‹ä¸­çš„ç¬¬å››å±‚â€”â€”Transport å±‚ï¼ˆç¬¬å››å±‚çš„æ•°æ®å« Segmentï¼‰</li><li>IP åœ¨ç¬¬ä¸‰å±‚â€”â€”Network å±‚ï¼ˆåœ¨ç¬¬ä¸‰å±‚ä¸Šçš„æ•°æ®å« Packetï¼‰</li><li>ARP åœ¨ç¬¬äºŒå±‚â€”â€”Data Link å±‚ï¼ˆåœ¨ç¬¬äºŒå±‚ä¸Šçš„æ•°æ®å« Frameï¼‰</li></ul><p>æˆ‘ä»¬ç¨‹åºçš„æ•°æ®é¦–å…ˆä¼šæ‰“åˆ° TCP çš„ Segment ä¸­ï¼Œç„¶å TCP çš„ Segment ä¼šæ‰“åˆ° IP çš„ Packet ä¸­ï¼Œç„¶åå†æ‰“åˆ°ä»¥å¤ªç½‘ Ethernet çš„ Frame ä¸­ï¼Œä¼ åˆ°å¯¹ç«¯åï¼Œå„ä¸ªå±‚è§£æè‡ªå·±çš„åè®®ï¼Œç„¶åæŠŠæ•°æ®äº¤ç»™æ›´é«˜å±‚çš„åè®®å¤„ç†ã€‚</p><a id="more"></a><h2 id="TCP-å¤´æ ¼å¼"><a href="#TCP-å¤´æ ¼å¼" class="headerlink" title="TCP å¤´æ ¼å¼"></a>TCP å¤´æ ¼å¼</h2><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izttyfinj30m8090jsz.jpg" alt="img"></p><p>ä½ éœ€è¦æ³¨æ„è¿™ä¹ˆå‡ ç‚¹ï¼š</p><ul><li>TCP çš„åŒ…æ˜¯æ²¡æœ‰ IP åœ°å€çš„ï¼Œé‚£æ˜¯ IP å±‚ä¸Šçš„äº‹ã€‚ä½†æ˜¯æœ‰æºç«¯å£å’Œç›®æ ‡ç«¯å£ã€‚</li><li>ä¸€ä¸ª TCP è¿æ¥éœ€è¦å››ä¸ªå…ƒç»„æ¥è¡¨ç¤ºæ˜¯åŒä¸€ä¸ªè¿æ¥ï¼ˆsrc_ip, src_port, dst_ip, dst_portï¼‰å‡†ç¡®è¯´æ˜¯äº”å…ƒç»„ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯åè®®ã€‚ä½†å› ä¸ºè¿™é‡Œåªæ˜¯è¯´ TCP åè®®ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘åªè¯´å››å…ƒç»„ã€‚</li><li>æ³¨æ„ä¸Šå›¾ä¸­çš„å››ä¸ªéå¸¸é‡è¦çš„ä¸œè¥¿ï¼š<ul><li><strong>Sequence Number</strong>æ˜¯åŒ…çš„åºå·ï¼Œ<strong>ç”¨æ¥è§£å†³ç½‘ç»œåŒ…ä¹±åºï¼ˆreorderingï¼‰é—®é¢˜ã€‚</strong></li><li><strong>Acknowledgement Number</strong>å°±æ˜¯ ACKâ€”â€”ç”¨äºç¡®è®¤æ”¶åˆ°ï¼Œ<strong>ç”¨æ¥è§£å†³ä¸ä¸¢åŒ…çš„é—®é¢˜</strong>ã€‚</li><li><strong>Window åˆå« Advertised-Window</strong>ï¼Œä¹Ÿå°±æ˜¯è‘—åçš„æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰ï¼Œ<strong>ç”¨äºè§£å†³æµæ§çš„</strong>ã€‚</li><li><strong>TCP Flag</strong> ï¼Œä¹Ÿå°±æ˜¯åŒ…çš„ç±»å‹ï¼Œ<strong>ä¸»è¦æ˜¯ç”¨äºæ“æ§ TCP çš„çŠ¶æ€æœºçš„</strong>ã€‚</li></ul></li></ul><h2 id="TCP-çŠ¶æ€æœº"><a href="#TCP-çŠ¶æ€æœº" class="headerlink" title="TCP çŠ¶æ€æœº"></a>TCP çŠ¶æ€æœº</h2><p>å…¶å®ï¼Œ<strong>ç½‘ç»œä¸Šçš„ä¼ è¾“æ˜¯æ²¡æœ‰è¿æ¥çš„ï¼ŒåŒ…æ‹¬ TCP ä¹Ÿæ˜¯ä¸€æ ·çš„</strong>ã€‚è€Œ TCP æ‰€è°“çš„â€œè¿æ¥â€ï¼Œå…¶å®åªä¸è¿‡æ˜¯åœ¨é€šè®¯çš„åŒæ–¹ç»´æŠ¤ä¸€ä¸ªâ€œè¿æ¥çŠ¶æ€â€ï¼Œè®©å®ƒçœ‹ä¸Šå»å¥½åƒæœ‰è¿æ¥ä¸€æ ·ã€‚æ‰€ä»¥ï¼ŒTCP çš„çŠ¶æ€å˜æ¢æ˜¯éå¸¸é‡è¦çš„ã€‚</p><p>â€œ<strong>TCP åè®®çš„çŠ¶æ€æœº</strong>â€å’Œ â€œ<strong>TCP å»ºé“¾æ¥</strong>â€ã€â€œ<strong>TCP æ–­é“¾æ¥</strong>â€ã€â€œ<strong>ä¼ æ•°æ®</strong>â€ çš„å¯¹ç…§å›¾</p><p><img src="https://coolshell.cn/wp-content/uploads/2014/05/tcpfsm.png" style="zoom:70%;display:inline"><img src="https://coolshell.cn/wp-content/uploads/2014/05/tcp_open_close.jpg" style="zoom:40%;display:inline"></p><p>å¾ˆå¤šäººä¼šé—®ï¼Œä¸ºä»€ä¹ˆå»ºé“¾æ¥è¦ 3 æ¬¡æ¡æ‰‹ï¼Œæ–­é“¾æ¥éœ€è¦ 4 æ¬¡æŒ¥æ‰‹ï¼Ÿ</p><ul><li><strong>å¯¹äºå»ºé“¾æ¥çš„ 3 æ¬¡æ¡æ‰‹ï¼Œ</strong>ä¸»è¦æ˜¯è¦åˆå§‹åŒ– Sequence Number çš„åˆå§‹å€¼ã€‚é€šä¿¡çš„åŒæ–¹è¦äº’ç›¸é€šçŸ¥å¯¹æ–¹è‡ªå·±çš„åˆå§‹åŒ–çš„ Sequence Numberï¼ˆç¼©å†™ä¸º ISNï¼šInital Sequence Numberï¼‰â€”â€”æ‰€ä»¥å« SYNï¼Œå…¨ç§° Synchronize Sequence Numbersã€‚ä¹Ÿå°±ä¸Šå›¾ä¸­çš„ x å’Œ yã€‚è¿™ä¸ªå·è¦ä½œä¸ºä»¥åçš„æ•°æ®é€šä¿¡çš„åºå·ï¼Œä»¥ä¿è¯åº”ç”¨å±‚æ¥æ”¶åˆ°çš„æ•°æ®ä¸ä¼šå› ä¸ºç½‘ç»œä¸Šçš„ä¼ è¾“çš„é—®é¢˜è€Œä¹±åºï¼ˆTCP ä¼šç”¨è¿™ä¸ªåºå·æ¥æ‹¼æ¥æ•°æ®ï¼‰ã€‚</li><li><strong>å¯¹äº 4 æ¬¡æŒ¥æ‰‹ï¼Œ</strong>å…¶å®ä½ ä»”ç»†çœ‹æ˜¯ 2 æ¬¡ï¼Œå› ä¸º TCP æ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹éƒ½éœ€è¦ Fin å’Œ Ackã€‚åªä¸è¿‡ï¼Œæœ‰ä¸€æ–¹æ˜¯è¢«åŠ¨çš„ï¼Œæ‰€ä»¥çœ‹ä¸Šå»å°±æˆäº†æ‰€è°“çš„ 4 æ¬¡æŒ¥æ‰‹ã€‚å¦‚æœä¸¤è¾¹åŒæ—¶æ–­è¿æ¥ï¼Œé‚£å°±ä¼šå°±è¿›å…¥åˆ° CLOSING çŠ¶æ€ï¼Œç„¶ååˆ°è¾¾ TIME_WAIT çŠ¶æ€ã€‚ä¸‹å›¾æ˜¯åŒæ–¹åŒæ—¶æ–­è¿æ¥çš„ç¤ºæ„å›¾ï¼ˆä½ åŒæ ·å¯ä»¥å¯¹ç…§ç€ TCP çŠ¶æ€æœºçœ‹ï¼‰ï¼š</li></ul><h2 id="æ•°æ®ä¼ è¾“ä¸­çš„-Sequence-Number"><a href="#æ•°æ®ä¼ è¾“ä¸­çš„-Sequence-Number" class="headerlink" title="æ•°æ®ä¼ è¾“ä¸­çš„ Sequence Number"></a>æ•°æ®ä¼ è¾“ä¸­çš„ Sequence Number</h2><p>ä¸‹å›¾æ˜¯ä» Wireshark ä¸­æˆªäº†ä¸ªæˆ‘åœ¨è®¿é—® coolshell.cn æ—¶çš„æœ‰æ•°æ®ä¼ è¾“çš„å›¾ç»™ä½ çœ‹ä¸€ä¸‹ï¼ŒSeqNum æ˜¯æ€ä¹ˆå˜çš„ã€‚ï¼ˆä½¿ç”¨ Wireshark èœå•ä¸­çš„ Statistics -&gt;Flow Graphâ€¦ ï¼‰</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5nx0rq0j30al0a1jsq.jpg" alt="img"></p><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œ<strong>SeqNum çš„å¢åŠ æ˜¯å’Œä¼ è¾“çš„å­—èŠ‚æ•°ç›¸å…³çš„</strong>ã€‚ä¸Šå›¾ä¸­ï¼Œä¸‰æ¬¡æ¡æ‰‹åï¼Œæ¥äº†ä¸¤ä¸ª Len:1440 çš„åŒ…ï¼Œè€Œç¬¬äºŒä¸ªåŒ…çš„ SeqNum å°±æˆäº† 1441ã€‚ç„¶åç¬¬ä¸€ä¸ª ACK å›çš„æ˜¯ 1441ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ª 1440 æ”¶åˆ°äº†ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœä½ ç”¨ Wireshark æŠ“åŒ…ç¨‹åºçœ‹ 3 æ¬¡æ¡æ‰‹ï¼Œä½ ä¼šå‘ç° SeqNum æ€»æ˜¯ä¸º 0ï¼Œä¸æ˜¯è¿™æ ·çš„ï¼ŒWireshark ä¸ºäº†æ˜¾ç¤ºæ›´å‹å¥½ï¼Œä½¿ç”¨äº† Relative SeqNumâ€”â€”ç›¸å¯¹åºå·ï¼Œä½ åªè¦åœ¨å³é”®èœå•ä¸­çš„ protocol preference ä¸­å–æ¶ˆæ‰å°±å¯ä»¥çœ‹åˆ°â€œAbsolute SeqNumâ€äº†</p><h2 id="TCP-é‡ä¼ æœºåˆ¶"><a href="#TCP-é‡ä¼ æœºåˆ¶" class="headerlink" title="TCP é‡ä¼ æœºåˆ¶"></a>TCP é‡ä¼ æœºåˆ¶</h2><p>TCP è¦ä¿è¯æ‰€æœ‰çš„æ•°æ®åŒ…éƒ½å¯ä»¥åˆ°è¾¾ï¼Œæ‰€ä»¥ï¼Œå¿…éœ€è¦æœ‰é‡ä¼ æœºåˆ¶ã€‚</p><p>æ³¨æ„ï¼Œæ¥æ”¶ç«¯ç»™å‘é€ç«¯çš„ Ack ç¡®è®¤åªä¼šç¡®è®¤æœ€åä¸€ä¸ªè¿ç»­çš„åŒ…ï¼Œæ¯”å¦‚ï¼Œå‘é€ç«¯å‘äº† 1,2,3,4,5 ä¸€å…±äº”ä»½æ•°æ®ï¼Œæ¥æ”¶ç«¯æ”¶åˆ°äº† 1ï¼Œ2ï¼Œäºæ˜¯å› ack 3ï¼Œç„¶åæ”¶åˆ°äº† 4ï¼ˆæ³¨æ„æ­¤æ—¶ 3 æ²¡æ”¶åˆ°ï¼‰ï¼Œæ­¤æ—¶çš„ TCP ä¼šæ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬è¦çŸ¥é“ï¼Œå› ä¸ºæ­£å¦‚å‰é¢æ‰€è¯´çš„ï¼Œ<strong>SeqNum å’Œ Ack æ˜¯ä»¥å­—èŠ‚æ•°ä¸ºå•ä½ï¼Œæ‰€ä»¥ ack çš„æ—¶å€™ï¼Œä¸èƒ½è·³ç€ç¡®è®¤ï¼Œåªèƒ½ç¡®è®¤æœ€å¤§çš„è¿ç»­æ”¶åˆ°çš„åŒ…</strong>ï¼Œä¸ç„¶ï¼Œå‘é€ç«¯å°±ä»¥ä¸ºä¹‹å‰çš„éƒ½æ”¶åˆ°äº†ã€‚</p><h3 id="è¶…æ—¶é‡ä¼ æœºåˆ¶"><a href="#è¶…æ—¶é‡ä¼ æœºåˆ¶" class="headerlink" title="è¶…æ—¶é‡ä¼ æœºåˆ¶"></a>è¶…æ—¶é‡ä¼ æœºåˆ¶</h3><p>ä¸€ç§æ˜¯ä¸å› ackï¼Œæ­»ç­‰ 3ï¼Œå½“å‘é€æ–¹å‘ç°æ”¶ä¸åˆ° 3 çš„ ack è¶…æ—¶åï¼Œä¼šé‡ä¼  3ã€‚ä¸€æ—¦æ¥æ”¶æ–¹æ”¶åˆ° 3 åï¼Œä¼š ack å› 4â€”â€”æ„å‘³ç€ 3 å’Œ 4 éƒ½æ”¶åˆ°äº†ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ç§æ–¹å¼ä¼šæœ‰æ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å› ä¸ºè¦æ­»ç­‰ 3ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ 4 å’Œ 5 å³ä¾¿å·²ç»æ”¶åˆ°äº†ï¼Œè€Œå‘é€æ–¹ä¹Ÿå®Œå…¨ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Œå› ä¸ºæ²¡æœ‰æ”¶åˆ° Ackï¼Œæ‰€ä»¥ï¼Œå‘é€æ–¹å¯èƒ½ä¼šæ‚²è§‚åœ°è®¤ä¸ºä¹Ÿä¸¢äº†ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¹Ÿä¼šå¯¼è‡´ 4 å’Œ 5 çš„é‡ä¼ ã€‚</p><p>å¯¹æ­¤æœ‰ä¸¤ç§é€‰æ‹©ï¼š</p><ul><li>ä¸€ç§æ˜¯ä»…é‡ä¼  timeout çš„åŒ…ã€‚ä¹Ÿå°±æ˜¯ç¬¬ 3 ä»½æ•°æ®ã€‚</li><li>å¦ä¸€ç§æ˜¯é‡ä¼  timeout åæ‰€æœ‰çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ç¬¬ 3ï¼Œ4ï¼Œ5 è¿™ä¸‰ä»½æ•°æ®ã€‚</li></ul><p>è¿™ä¸¤ç§æ–¹å¼æœ‰å¥½ä¹Ÿæœ‰ä¸å¥½ã€‚ç¬¬ä¸€ç§ä¼šèŠ‚çœå¸¦å®½ï¼Œä½†æ˜¯æ…¢ï¼Œç¬¬äºŒç§ä¼šå¿«ä¸€ç‚¹ï¼Œä½†æ˜¯ä¼šæµªè´¹å¸¦å®½ï¼Œä¹Ÿå¯èƒ½ä¼šæœ‰æ— ç”¨åŠŸã€‚ä½†æ€»ä½“æ¥è¯´éƒ½ä¸å¥½ã€‚å› ä¸ºéƒ½åœ¨ç­‰ timeoutï¼Œtimeout å¯èƒ½ä¼šå¾ˆé•¿ï¼ˆåœ¨ä¸‹ç¯‡ä¼šè¯´ TCP æ˜¯æ€ä¹ˆåŠ¨æ€åœ°è®¡ç®—å‡º timeout çš„ï¼‰</p><h3 id="å¿«é€Ÿé‡ä¼ æœºåˆ¶"><a href="#å¿«é€Ÿé‡ä¼ æœºåˆ¶" class="headerlink" title="å¿«é€Ÿé‡ä¼ æœºåˆ¶"></a>å¿«é€Ÿé‡ä¼ æœºåˆ¶</h3><p>äºæ˜¯ï¼ŒTCP å¼•å…¥äº†ä¸€ç§å«<strong>Fast Retransmit</strong> çš„ç®—æ³•ï¼Œ<strong>ä¸ä»¥æ—¶é—´é©±åŠ¨ï¼Œè€Œä»¥æ•°æ®é©±åŠ¨é‡ä¼ </strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœï¼ŒåŒ…æ²¡æœ‰è¿ç»­åˆ°è¾¾ï¼Œå°± ack æœ€åé‚£ä¸ªå¯èƒ½è¢«ä¸¢äº†çš„åŒ…ï¼Œå¦‚æœå‘é€æ–¹è¿ç»­æ”¶åˆ° 3 æ¬¡ç›¸åŒçš„ ackï¼Œå°±é‡ä¼ ã€‚Fast Retransmit çš„å¥½å¤„æ˜¯ä¸ç”¨ç­‰ timeout äº†å†é‡ä¼ ã€‚</p><p>æ¯”å¦‚ï¼šå¦‚æœå‘é€æ–¹å‘å‡ºäº† 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5 ä»½æ•°æ®ï¼Œç¬¬ä¸€ä»½å…ˆåˆ°é€äº†ï¼Œäºæ˜¯å°± ack å› 2ï¼Œç»“æœ 2 å› ä¸ºæŸäº›åŸå› æ²¡æ”¶åˆ°ï¼Œ3 åˆ°è¾¾äº†ï¼Œäºæ˜¯è¿˜æ˜¯ ack å› 2ï¼Œåé¢çš„ 4 å’Œ 5 éƒ½åˆ°äº†ï¼Œä½†æ˜¯è¿˜æ˜¯ ack å› 2ï¼Œå› ä¸º 2 è¿˜æ˜¯æ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯å‘é€ç«¯æ”¶åˆ°äº†ä¸‰ä¸ª ack=2 çš„ç¡®è®¤ï¼ŒçŸ¥é“äº† 2 è¿˜æ²¡æœ‰åˆ°ï¼Œäºæ˜¯å°±é©¬ä¸Šé‡è½¬ 2ã€‚ç„¶åï¼Œæ¥æ”¶ç«¯æ”¶åˆ°äº† 2ï¼Œæ­¤æ—¶å› ä¸º 3ï¼Œ4ï¼Œ5 éƒ½æ”¶åˆ°äº†ï¼Œäºæ˜¯ ack å› 6ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5o1shzuj30ci0833yx.jpg" alt="img"></p><p>Fast Retransmit åªè§£å†³äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ timeout çš„é—®é¢˜ï¼Œå®ƒä¾ç„¶é¢ä¸´ä¸€ä¸ªè‰°éš¾çš„é€‰æ‹©ï¼Œå°±æ˜¯ï¼Œæ˜¯é‡ä¼ ä¹‹å‰çš„ä¸€ä¸ªè¿˜æ˜¯é‡ä¼ æ‰€æœ‰çš„é—®é¢˜ã€‚å¯¹äºä¸Šé¢çš„ç¤ºä¾‹æ¥è¯´ï¼Œæ˜¯é‡ä¼ #2 å‘¢è¿˜æ˜¯é‡ä¼ #2ï¼Œ#3ï¼Œ#4ï¼Œ#5 å‘¢ï¼Ÿå› ä¸ºå‘é€ç«¯å¹¶ä¸æ¸…æ¥šè¿™è¿ç»­çš„ 3 ä¸ª ack(2)æ˜¯è°ä¼ å›æ¥çš„ï¼Ÿä¹Ÿè®¸å‘é€ç«¯å‘äº† 20 ä»½æ•°æ®ï¼Œæ˜¯#6ï¼Œ#10ï¼Œ#20 ä¼ æ¥çš„å‘¢ã€‚è¿™æ ·ï¼Œå‘é€ç«¯å¾ˆæœ‰å¯èƒ½è¦é‡ä¼ ä» 2 åˆ° 20 çš„è¿™å †æ•°æ®ï¼ˆè¿™å°±æ˜¯æŸäº› TCP çš„å®é™…çš„å®ç°ï¼‰ã€‚å¯è§ï¼Œè¿™æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚</p><h3 id="SACK-æ–¹æ³•"><a href="#SACK-æ–¹æ³•" class="headerlink" title="SACK æ–¹æ³•"></a>SACK æ–¹æ³•</h3><p>å¦å¤–ä¸€ç§æ›´å¥½çš„æ–¹å¼å«ï¼š<strong>Selective Acknowledgment (SACK)</strong>ï¼ˆå‚çœ‹<a href="http://tools.ietf.org/html/rfc2018" target="_blank" rel="noopener">RFC 2018</a>ï¼‰ï¼Œè¿™ç§æ–¹å¼éœ€è¦åœ¨ TCP å¤´é‡ŒåŠ ä¸€ä¸ª SACK çš„ä¸œè¥¿ï¼ŒACK è¿˜æ˜¯ Fast Retransmit çš„ ACKï¼ŒSACK åˆ™æ˜¯æ±‡æŠ¥æ”¶åˆ°çš„æ•°æ®ç¢ç‰ˆã€‚å‚çœ‹ä¸‹å›¾ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5o7gj8sj30sg0g1ta5.jpg" alt="img"></p><p>è¿™æ ·ï¼Œåœ¨å‘é€ç«¯å°±å¯ä»¥æ ¹æ®å›ä¼ çš„ SACK æ¥çŸ¥é“å“ªäº›æ•°æ®åˆ°äº†ï¼Œå“ªäº›æ²¡æœ‰åˆ°ã€‚äºæ˜¯å°±ä¼˜åŒ–äº† Fast Retransmit çš„ç®—æ³•ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåè®®éœ€è¦ä¸¤è¾¹éƒ½æ”¯æŒã€‚åœ¨ Linux ä¸‹ï¼Œå¯ä»¥é€šè¿‡<strong>tcp_sack</strong>å‚æ•°æ‰“å¼€è¿™ä¸ªåŠŸèƒ½ï¼ˆLinux 2.4 åé»˜è®¤æ‰“å¼€ï¼‰ã€‚</p><p>è¿™é‡Œè¿˜éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜â€”â€”<strong>æ¥æ”¶æ–¹ Renegingï¼Œæ‰€è°“ Reneging çš„æ„æ€å°±æ˜¯æ¥æ”¶æ–¹æœ‰æƒæŠŠå·²ç»æŠ¥ç»™å‘é€ç«¯ SACK é‡Œçš„æ•°æ®ç»™ä¸¢äº†</strong>ã€‚è¿™æ ·å¹²æ˜¯ä¸è¢«é¼“åŠ±çš„ï¼Œå› ä¸ºè¿™ä¸ªäº‹ä¼šæŠŠé—®é¢˜å¤æ‚åŒ–äº†ï¼Œä½†æ˜¯ï¼Œæ¥æ”¶æ–¹è¿™ä¹ˆåšå¯èƒ½ä¼šæœ‰äº›æç«¯æƒ…å†µï¼Œæ¯”å¦‚è¦æŠŠå†…å­˜ç»™åˆ«çš„æ›´é‡è¦çš„ä¸œè¥¿ã€‚<strong>æ‰€ä»¥ï¼Œå‘é€æ–¹ä¹Ÿä¸èƒ½å®Œå…¨ä¾èµ– SACKï¼Œè¿˜æ˜¯è¦ä¾èµ– ACKï¼Œå¹¶ç»´æŠ¤ Time-Outï¼Œå¦‚æœåç»­çš„ ACK æ²¡æœ‰å¢é•¿ï¼Œé‚£ä¹ˆè¿˜æ˜¯è¦æŠŠ SACK çš„ä¸œè¥¿é‡ä¼ ï¼Œå¦å¤–ï¼Œæ¥æ”¶ç«¯è¿™è¾¹æ°¸è¿œä¸èƒ½æŠŠ SACK çš„åŒ…æ ‡è®°ä¸º Ackã€‚</strong></p><p>æ³¨æ„ï¼šSACK ä¼šæ¶ˆè´¹å‘é€æ–¹çš„èµ„æºï¼Œè¯•æƒ³ï¼Œå¦‚æœä¸€ä¸ªæ”»å‡»è€…ç»™æ•°æ®å‘é€æ–¹å‘ä¸€å † SACK çš„é€‰é¡¹ï¼Œè¿™ä¼šå¯¼è‡´å‘é€æ–¹å¼€å§‹è¦é‡ä¼ ç”šè‡³éå†å·²ç»å‘å‡ºçš„æ•°æ®ï¼Œè¿™ä¼šæ¶ˆè€—å¾ˆå¤šå‘é€ç«¯çš„èµ„æºã€‚</p><h3 id="Duplicate-SACK-â€“-é‡å¤æ”¶åˆ°æ•°æ®çš„é—®é¢˜"><a href="#Duplicate-SACK-â€“-é‡å¤æ”¶åˆ°æ•°æ®çš„é—®é¢˜" class="headerlink" title="Duplicate SACK â€“ é‡å¤æ”¶åˆ°æ•°æ®çš„é—®é¢˜"></a>Duplicate SACK â€“ é‡å¤æ”¶åˆ°æ•°æ®çš„é—®é¢˜</h3><p>Duplicate SACK åˆç§° D-SACKï¼Œ<strong>å…¶ä¸»è¦ä½¿ç”¨äº† SACK æ¥å‘Šè¯‰å‘é€æ–¹æœ‰å“ªäº›æ•°æ®è¢«é‡å¤æ¥æ”¶äº†</strong>ã€‚<a href="http://www.ietf.org/rfc/rfc2883.txt" target="_blank" rel="noopener">RFC-2883 </a>é‡Œæœ‰è¯¦ç»†æè¿°å’Œç¤ºä¾‹ã€‚ä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­ï¼ˆæ¥æºäº<a href="http://www.ietf.org/rfc/rfc2883.txt" target="_blank" rel="noopener">RFC-2883</a>ï¼‰</p><p>D-SACK ä½¿ç”¨äº† SACK çš„ç¬¬ä¸€ä¸ªæ®µæ¥åšæ ‡å¿—ï¼Œ</p><ul><li>å¦‚æœ SACK çš„ç¬¬ä¸€ä¸ªæ®µçš„èŒƒå›´è¢« ACK æ‰€è¦†ç›–ï¼Œé‚£ä¹ˆå°±æ˜¯ D-SACK</li><li>å¦‚æœ SACK çš„ç¬¬ä¸€ä¸ªæ®µçš„èŒƒå›´è¢« SACK çš„ç¬¬äºŒä¸ªæ®µè¦†ç›–ï¼Œé‚£ä¹ˆå°±æ˜¯ D-SACK</li></ul><h4 id="ç¤ºä¾‹ä¸€ï¼šACK-ä¸¢åŒ…"><a href="#ç¤ºä¾‹ä¸€ï¼šACK-ä¸¢åŒ…" class="headerlink" title="ç¤ºä¾‹ä¸€ï¼šACK ä¸¢åŒ…"></a>ç¤ºä¾‹ä¸€ï¼šACK ä¸¢åŒ…</h4><p>ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œä¸¢äº†ä¸¤ä¸ª ACKï¼Œæ‰€ä»¥ï¼Œå‘é€ç«¯é‡ä¼ äº†ç¬¬ä¸€ä¸ªæ•°æ®åŒ…ï¼ˆ3000-3499ï¼‰ï¼Œäºæ˜¯æ¥æ”¶ç«¯å‘ç°é‡å¤æ”¶åˆ°ï¼Œäºæ˜¯å›äº†ä¸€ä¸ª SACK=3000-3500ï¼Œå› ä¸º ACK éƒ½åˆ°äº† 4000 æ„å‘³ç€æ”¶åˆ°äº† 4000 ä¹‹å‰çš„æ‰€æœ‰æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸ª SACK å°±æ˜¯ D-SACKâ€”â€”æ—¨åœ¨å‘Šè¯‰å‘é€ç«¯æˆ‘æ”¶åˆ°äº†é‡å¤çš„æ•°æ®ï¼Œè€Œä¸”æˆ‘ä»¬çš„å‘é€ç«¯è¿˜çŸ¥é“ï¼Œæ•°æ®åŒ…æ²¡æœ‰ä¸¢ï¼Œä¸¢çš„æ˜¯ ACK åŒ…ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Transmitted  Received    ACK Sent</span><br><span class="line">Segment      Segment     (Including SACK Blocks)</span><br><span class="line">3000-3499    3000-3499   3500 (ACK dropped)</span><br><span class="line">3500-3999    3500-3999   4000 (ACK dropped)</span><br><span class="line">3000-3499    3000-3499   4000, SACK=3000-3500</span><br><span class="line">                                    ---------</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹äºŒï¼Œç½‘ç»œå»¶è¯¯"><a href="#ç¤ºä¾‹äºŒï¼Œç½‘ç»œå»¶è¯¯" class="headerlink" title="ç¤ºä¾‹äºŒï¼Œç½‘ç»œå»¶è¯¯"></a>ç¤ºä¾‹äºŒï¼Œç½‘ç»œå»¶è¯¯</h4><p>ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œç½‘ç»œåŒ…ï¼ˆ1000-1499ï¼‰è¢«ç½‘ç»œç»™å»¶è¯¯äº†ï¼Œå¯¼è‡´å‘é€æ–¹æ²¡æœ‰æ”¶åˆ° ACKï¼Œè€Œåé¢åˆ°è¾¾çš„ä¸‰ä¸ªåŒ…è§¦å‘äº†â€œFast Retransmit ç®—æ³•â€ï¼Œæ‰€ä»¥é‡ä¼ ï¼Œä½†é‡ä¼ æ—¶ï¼Œè¢«å»¶è¯¯çš„åŒ…åˆåˆ°äº†ï¼Œæ‰€ä»¥ï¼Œå›äº†ä¸€ä¸ª SACK=1000-1500ï¼Œå› ä¸º ACK å·²åˆ°äº† 3000ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ª SACK æ˜¯ D-SACKâ€”â€”æ ‡è¯†æ”¶åˆ°äº†é‡å¤çš„åŒ…ã€‚</p><p>è¿™ä¸ªæ¡ˆä¾‹ä¸‹ï¼Œå‘é€ç«¯çŸ¥é“ä¹‹å‰å› ä¸ºâ€œFast Retransmit ç®—æ³•â€è§¦å‘çš„é‡ä¼ ä¸æ˜¯å› ä¸ºå‘å‡ºå»çš„åŒ…ä¸¢äº†ï¼Œä¹Ÿä¸æ˜¯å› ä¸ºå›åº”çš„ ACK åŒ…ä¸¢äº†ï¼Œè€Œæ˜¯å› ä¸ºç½‘ç»œå»¶æ—¶äº†ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Transmitted    Received    ACK Sent</span><br><span class="line">Segment        Segment     (Including SACK Blocks)</span><br><span class="line"><span class="number">500</span><span class="number">-999</span>        <span class="number">500</span><span class="number">-999</span>     <span class="number">1000</span></span><br><span class="line">1000-1499      (delayed)</span><br><span class="line">1500-1999      1500-1999   1000, SACK=1500-2000</span><br><span class="line">2000-2499      2000-2499   1000, SACK=1500-2500</span><br><span class="line">2500-2999      2500-2999   1000, SACK=1500-3000</span><br><span class="line"><span class="number">1000</span><span class="number">-1499</span>      <span class="number">1000</span><span class="number">-1499</span>   <span class="number">3000</span></span><br><span class="line">               1000-1499   3000, SACK=1000-1500</span><br><span class="line">                                      ---------</span><br></pre></td></tr></table></figure><p>å¯è§ï¼Œå¼•å…¥äº† D-SACKï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªå¥½å¤„ï¼š</p><p>1ï¼‰å¯ä»¥è®©å‘é€æ–¹çŸ¥é“ï¼Œæ˜¯å‘å‡ºå»çš„åŒ…ä¸¢äº†ï¼Œè¿˜æ˜¯å›æ¥çš„ ACK åŒ…ä¸¢äº†ã€‚</p><p>2ï¼‰æ˜¯ä¸æ˜¯è‡ªå·±çš„ timeout å¤ªå°äº†ï¼Œå¯¼è‡´é‡ä¼ ã€‚</p><p>3ï¼‰ç½‘ç»œä¸Šå‡ºç°äº†å…ˆå‘çš„åŒ…ååˆ°çš„æƒ…å†µï¼ˆåˆç§° reorderingï¼‰</p><p>4ï¼‰ç½‘ç»œä¸Šæ˜¯ä¸æ˜¯æŠŠæˆ‘çš„æ•°æ®åŒ…ç»™å¤åˆ¶äº†ã€‚</p><p><strong>çŸ¥é“è¿™äº›ä¸œè¥¿å¯ä»¥å¾ˆå¥½å¾—å¸®åŠ© TCP äº†è§£ç½‘ç»œæƒ…å†µï¼Œä»è€Œå¯ä»¥æ›´å¥½çš„åšç½‘ç»œä¸Šçš„æµæ§</strong>ã€‚</p><p>Linux ä¸‹çš„ tcp_dsack å‚æ•°ç”¨äºå¼€å¯è¿™ä¸ªåŠŸèƒ½ï¼ˆLinux 2.4 åé»˜è®¤æ‰“å¼€ï¼‰</p><h2 id="TCP-çš„-RTT-ç®—æ³•"><a href="#TCP-çš„-RTT-ç®—æ³•" class="headerlink" title="TCP çš„ RTT ç®—æ³•"></a>TCP çš„ RTT ç®—æ³•</h2><p>ä»å‰é¢çš„ TCP é‡ä¼ æœºåˆ¶æˆ‘ä»¬çŸ¥é“ Timeout çš„è®¾ç½®å¯¹äºé‡ä¼ éå¸¸é‡è¦ã€‚</p><ul><li>è®¾é•¿äº†ï¼Œé‡å‘å°±æ…¢ï¼Œä¸¢äº†è€åŠå¤©æ‰é‡å‘ï¼Œæ²¡æœ‰æ•ˆç‡ï¼Œæ€§èƒ½å·®ï¼›</li><li>è®¾çŸ­äº†ï¼Œä¼šå¯¼è‡´å¯èƒ½å¹¶æ²¡æœ‰ä¸¢å°±é‡å‘ã€‚äºæ˜¯é‡å‘çš„å°±å¿«ï¼Œä¼šå¢åŠ ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´æ›´å¤šçš„è¶…æ—¶ï¼Œæ›´å¤šçš„è¶…æ—¶å¯¼è‡´æ›´å¤šçš„é‡å‘ã€‚</li></ul><p>è€Œä¸”ï¼Œè¿™ä¸ªè¶…æ—¶æ—¶é—´åœ¨ä¸åŒçš„ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œæ ¹æœ¬æ²¡æœ‰åŠæ³•è®¾ç½®ä¸€ä¸ªæ­»çš„å€¼ã€‚åªèƒ½åŠ¨æ€åœ°è®¾ç½®ã€‚ ä¸ºäº†åŠ¨æ€åœ°è®¾ç½®ï¼ŒTCP å¼•å…¥äº† RTTâ€”â€”Round Trip Timeï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°æ®åŒ…ä»å‘å‡ºå»åˆ°å›æ¥çš„æ—¶é—´ã€‚è¿™æ ·å‘é€ç«¯å°±å¤§çº¦çŸ¥é“éœ€è¦å¤šå°‘çš„æ—¶é—´ï¼Œä»è€Œå¯ä»¥æ–¹ä¾¿åœ°è®¾ç½® Timeoutâ€”â€”RTOï¼ˆRetransmission TimeOutï¼‰ï¼Œä»¥è®©æˆ‘ä»¬çš„é‡ä¼ æœºåˆ¶æ›´é«˜æ•ˆã€‚ å¬èµ·æ¥ä¼¼ä¹å¾ˆç®€å•ï¼Œå¥½åƒå°±æ˜¯åœ¨å‘é€ç«¯å‘åŒ…æ—¶è®°ä¸‹ t0ï¼Œç„¶åæ¥æ”¶ç«¯å†æŠŠè¿™ä¸ª ack å›æ¥æ—¶å†è®°ä¸€ä¸ª t1ï¼Œäºæ˜¯ RTT = t1 â€“ t0ã€‚æ²¡é‚£ä¹ˆç®€å•ï¼Œè¿™åªæ˜¯ä¸€ä¸ªé‡‡æ ·ï¼Œä¸èƒ½ä»£è¡¨æ™®éæƒ…å†µã€‚</p><h3 id="ç»å…¸ç®—æ³•"><a href="#ç»å…¸ç®—æ³•" class="headerlink" title="ç»å…¸ç®—æ³•"></a>ç»å…¸ç®—æ³•</h3><p><a href="http://tools.ietf.org/html/rfc793" target="_blank" rel="noopener">RFC793</a> ä¸­å®šä¹‰çš„ç»å…¸ç®—æ³•æ˜¯è¿™æ ·çš„ï¼š</p><p>1ï¼‰é¦–å…ˆï¼Œå…ˆé‡‡æ · RTTï¼Œè®°ä¸‹æœ€è¿‘å¥½å‡ æ¬¡çš„ RTT å€¼ã€‚</p><p>2ï¼‰ç„¶ååšå¹³æ»‘è®¡ç®— SRTTï¼ˆ Smoothed RTTï¼‰ã€‚å…¬å¼ä¸ºï¼šï¼ˆå…¶ä¸­çš„ Î± å–å€¼åœ¨ 0.8 åˆ° 0.9 ä¹‹é—´ï¼Œè¿™ä¸ªç®—æ³•è‹±æ–‡å« Exponential weighted moving averageï¼Œä¸­æ–‡å«ï¼šåŠ æƒç§»åŠ¨å¹³å‡ï¼‰</p><p><strong>SRTT = ( Î± * SRTT ) + ((1- Î±) * RTT)</strong></p><p>3ï¼‰å¼€å§‹è®¡ç®— RTOã€‚å…¬å¼å¦‚ä¸‹ï¼š</p><p><strong>RTO = min [ UBOUND, max [ LBOUND, (Î² * SRTT) ] ]</strong></p><p>å…¶ä¸­ï¼š</p><ul><li>UBOUND æ˜¯æœ€å¤§çš„ timeout æ—¶é—´ï¼Œä¸Šé™å€¼</li><li>LBOUND æ˜¯æœ€å°çš„ timeout æ—¶é—´ï¼Œä¸‹é™å€¼</li><li>Î² å€¼ä¸€èˆ¬åœ¨ 1.3 åˆ° 2.0 ä¹‹é—´ã€‚</li></ul><h3 id="Karn-Partridge-ç®—æ³•"><a href="#Karn-Partridge-ç®—æ³•" class="headerlink" title="Karn / Partridge ç®—æ³•"></a>Karn / Partridge ç®—æ³•</h3><p>ä½†æ˜¯ä¸Šé¢çš„è¿™ä¸ªç®—æ³•åœ¨é‡ä¼ çš„æ—¶å€™ä¼šå‡ºæœ‰ä¸€ä¸ªç»ˆæé—®é¢˜â€”â€”ä½ æ˜¯ç”¨ç¬¬ä¸€æ¬¡å‘æ•°æ®çš„æ—¶é—´å’Œ ack å›æ¥çš„æ—¶é—´åš RTT æ ·æœ¬å€¼ï¼Œè¿˜æ˜¯ç”¨é‡ä¼ çš„æ—¶é—´å’Œ ACK å›æ¥çš„æ—¶é—´åš RTT æ ·æœ¬å€¼ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜æ— è®ºä½ é€‰é‚£å¤´éƒ½æ˜¯æŒ‰ä¸‹è‘«èŠ¦èµ·äº†ç“¢ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><ul><li>æƒ…å†µï¼ˆaï¼‰æ˜¯ ack æ²¡å›æ¥ï¼Œæ‰€ä»¥é‡ä¼ ã€‚å¦‚æœä½ è®¡ç®—ç¬¬ä¸€æ¬¡å‘é€å’Œ ACK çš„æ—¶é—´ï¼Œé‚£ä¹ˆï¼Œæ˜æ˜¾ç®—å¤§äº†ã€‚</li><li>æƒ…å†µï¼ˆbï¼‰æ˜¯ ack å›æ¥æ…¢äº†ï¼Œä½†æ˜¯å¯¼è‡´äº†é‡ä¼ ï¼Œä½†åˆšé‡ä¼ ä¸ä¸€ä¼šå„¿ï¼Œä¹‹å‰ ACK å°±å›æ¥äº†ã€‚å¦‚æœä½ æ˜¯ç®—é‡ä¼ çš„æ—¶é—´å’Œ ACK å›æ¥çš„æ—¶é—´çš„å·®ï¼Œå°±ä¼šç®—çŸ­äº†ã€‚</li></ul><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5odttngj30kp098mxm.jpg" alt="img"></p><p>æ‰€ä»¥ 1987 å¹´çš„æ—¶å€™ï¼Œæäº†ä¸€ä¸ªå«<a href="http://en.wikipedia.org/wiki/Karn's_Algorithm" target="_blank" rel="noopener">Karn / Partridge Algorithm</a>ï¼Œè¿™ä¸ªç®—æ³•çš„æœ€å¤§ç‰¹ç‚¹æ˜¯â€”â€”<strong>å¿½ç•¥é‡ä¼ ï¼Œä¸æŠŠé‡ä¼ çš„ RTT åšé‡‡æ ·</strong>ï¼ˆä½ çœ‹ï¼Œä½ ä¸éœ€è¦å»è§£å†³ä¸å­˜åœ¨çš„é—®é¢˜ï¼‰ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåˆä¼šå¼•å‘ä¸€ä¸ªå¤§ BUGâ€”â€”<strong>å¦‚æœåœ¨æŸä¸€æ—¶é—´ï¼Œç½‘ç»œé—ªåŠ¨ï¼Œçªç„¶å˜æ…¢äº†ï¼Œäº§ç”Ÿäº†æ¯”è¾ƒå¤§çš„å»¶æ—¶ï¼Œè¿™ä¸ªå»¶æ—¶å¯¼è‡´è¦é‡è½¬æ‰€æœ‰çš„åŒ…ï¼ˆå› ä¸ºä¹‹å‰çš„ RTO å¾ˆå°ï¼‰ï¼Œäºæ˜¯ï¼Œå› ä¸ºé‡è½¬çš„ä¸ç®—ï¼Œæ‰€ä»¥ï¼ŒRTO å°±ä¸ä¼šè¢«æ›´æ–°ï¼Œè¿™æ˜¯ä¸€ä¸ªç¾éš¾</strong>ã€‚ äºæ˜¯ Karn ç®—æ³•ç”¨äº†ä¸€ä¸ªå–å·§çš„æ–¹å¼â€”â€”åªè¦ä¸€å‘ç”Ÿé‡ä¼ ï¼Œå°±å¯¹ç°æœ‰çš„ RTO å€¼ç¿»å€ï¼ˆè¿™å°±æ˜¯æ‰€è°“çš„ Exponential backoffï¼‰ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™ç§æ­»è§„çŸ©å¯¹äºä¸€ä¸ªéœ€è¦ä¼°è®¡æ¯”è¾ƒå‡†ç¡®çš„ RTT ä¹Ÿä¸é è°±ã€‚</p><h3 id="Jacobson-Karels-ç®—æ³•"><a href="#Jacobson-Karels-ç®—æ³•" class="headerlink" title="Jacobson / Karels ç®—æ³•"></a>Jacobson / Karels ç®—æ³•</h3><p>å‰é¢ä¸¤ç§ç®—æ³•ç”¨çš„éƒ½æ˜¯â€œåŠ æƒç§»åŠ¨å¹³å‡â€ï¼Œè¿™ç§æ–¹æ³•æœ€å¤§çš„æ¯›ç—…å°±æ˜¯å¦‚æœ RTT æœ‰ä¸€ä¸ªå¤§çš„æ³¢åŠ¨çš„è¯ï¼Œå¾ˆéš¾è¢«å‘ç°ï¼Œå› ä¸ºè¢«å¹³æ»‘æ‰äº†ã€‚æ‰€ä»¥ï¼Œ1988 å¹´ï¼Œåˆæœ‰äººæ¨å‡ºæ¥äº†ä¸€ä¸ªæ–°çš„ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•å« Jacobson / Karels Algorithmï¼ˆå‚çœ‹<a href="http://tools.ietf.org/html/rfc6298" target="_blank" rel="noopener">RFC6289</a>ï¼‰ã€‚è¿™ä¸ªç®—æ³•å¼•å…¥äº†æœ€æ–°çš„ RTT çš„é‡‡æ ·å’Œå¹³æ»‘è¿‡çš„ SRTT çš„å·®è·åšå› å­æ¥è®¡ç®—ã€‚ å…¬å¼å¦‚ä¸‹ï¼šï¼ˆå…¶ä¸­çš„ DevRTT æ˜¯ Deviation RTT çš„æ„æ€ï¼‰</p><p><strong>SRTT</strong> <strong>= S**</strong>RTT** <strong>+ Î±</strong> <strong>(**</strong>RTT** <strong>â€“ S**</strong>RTT*<strong>*)</strong> â€”â€” è®¡ç®—å¹³æ»‘ RTT</p><p><strong>DevRTT</strong> <strong>= (1-Î²**</strong>)**<strong>*DevRTT</strong> <strong>+ Î²***</strong>(|*<strong>*RTT-SRTT**</strong>|)** â€”â€”è®¡ç®—å¹³æ»‘ RTT å’ŒçœŸå®çš„å·®è·ï¼ˆåŠ æƒç§»åŠ¨å¹³å‡ï¼‰</p><p><strong>RTO= Âµ * SRTT + âˆ‚ *DevRTT</strong> â€”â€” ç¥ä¸€æ ·çš„å…¬å¼</p><p>ï¼ˆå…¶ä¸­ï¼šåœ¨ Linux ä¸‹ï¼ŒÎ± = 0.125ï¼ŒÎ² = 0.25ï¼Œ Î¼ = 1ï¼Œâˆ‚ = 4 â€”â€”è¿™å°±æ˜¯ç®—æ³•ä¸­çš„â€œè°ƒå¾—ä¸€æ‰‹å¥½å‚æ•°â€ï¼Œnobody knows why, it just worksâ€¦ï¼‰ æœ€åçš„è¿™ä¸ªç®—æ³•åœ¨è¢«ç”¨åœ¨ä»Šå¤©çš„ TCP åè®®ä¸­ï¼ˆLinux çš„æºä»£ç åœ¨ï¼š<a href="http://lxr.free-electrons.com/source/net/ipv4/tcp_input.c?v=2.6.32#L609" target="_blank" rel="noopener">tcp_rtt_estimator</a>ï¼‰ã€‚</p><h2 id="TCP-æ»‘åŠ¨çª—å£"><a href="#TCP-æ»‘åŠ¨çª—å£" class="headerlink" title="TCP æ»‘åŠ¨çª—å£"></a>TCP æ»‘åŠ¨çª—å£</h2><p>éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚æœä½ ä¸äº†è§£ TCP çš„æ»‘åŠ¨çª—å£è¿™ä¸ªäº‹ï¼Œä½ ç­‰äºä¸äº†è§£ TCP åè®®ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ<strong>TCP å¿…éœ€è¦è§£å†³çš„å¯é ä¼ è¾“ä»¥åŠåŒ…ä¹±åºï¼ˆreorderingï¼‰çš„é—®é¢˜</strong>ï¼Œæ‰€ä»¥ï¼ŒTCP å¿…éœ€è¦çŸ¥é“ç½‘ç»œå®é™…çš„æ•°æ®å¤„ç†å¸¦å®½æˆ–æ˜¯æ•°æ®å¤„ç†é€Ÿåº¦ï¼Œè¿™æ ·æ‰ä¸ä¼šå¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´ä¸¢åŒ…ã€‚</p><p>æ‰€ä»¥ï¼ŒTCP å¼•å…¥äº†ä¸€äº›æŠ€æœ¯å’Œè®¾è®¡æ¥åšç½‘ç»œæµæ§ï¼ŒSliding Window æ˜¯å…¶ä¸­ä¸€ä¸ªæŠ€æœ¯ã€‚ å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œ<strong>TCP å¤´é‡Œæœ‰ä¸€ä¸ªå­—æ®µå« Windowï¼Œåˆå« Advertised-Windowï¼Œè¿™ä¸ªå­—æ®µæ˜¯æ¥æ”¶ç«¯å‘Šè¯‰å‘é€ç«¯è‡ªå·±è¿˜æœ‰å¤šå°‘ç¼“å†²åŒºå¯ä»¥æ¥æ”¶æ•°æ®</strong>ã€‚<strong>äºæ˜¯å‘é€ç«¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›æ¥å‘é€æ•°æ®ï¼Œè€Œä¸ä¼šå¯¼è‡´æ¥æ”¶ç«¯å¤„ç†ä¸è¿‡æ¥</strong>ã€‚ ä¸ºäº†è¯´æ˜æ»‘åŠ¨çª—å£ï¼Œæˆ‘ä»¬éœ€è¦å…ˆçœ‹ä¸€ä¸‹ TCP ç¼“å†²åŒºçš„ä¸€äº›æ•°æ®ç»“æ„ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5oinwowj30p60a13z5.jpg" alt="img"></p><p>ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><ul><li>æ¥æ”¶ç«¯ LastByteRead æŒ‡å‘äº† TCP ç¼“å†²åŒºä¸­è¯»åˆ°çš„ä½ç½®ï¼ŒNextByteExpected æŒ‡å‘çš„åœ°æ–¹æ˜¯æ”¶åˆ°çš„è¿ç»­åŒ…çš„æœ€åä¸€ä¸ªä½ç½®ï¼ŒLastByteRcved æŒ‡å‘çš„æ˜¯æ”¶åˆ°çš„åŒ…çš„æœ€åä¸€ä¸ªä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸­é—´æœ‰äº›æ•°æ®è¿˜æ²¡æœ‰åˆ°è¾¾ï¼Œæ‰€ä»¥æœ‰æ•°æ®ç©ºç™½åŒºã€‚</li><li>å‘é€ç«¯çš„ LastByteAcked æŒ‡å‘äº†è¢«æ¥æ”¶ç«¯ Ack è¿‡çš„ä½ç½®ï¼ˆè¡¨ç¤ºæˆåŠŸå‘é€ç¡®è®¤ï¼‰ï¼ŒLastByteSent è¡¨ç¤ºå‘å‡ºå»äº†ï¼Œä½†è¿˜æ²¡æœ‰æ”¶åˆ°æˆåŠŸç¡®è®¤çš„ Ackï¼ŒLastByteWritten æŒ‡å‘çš„æ˜¯ä¸Šå±‚åº”ç”¨æ­£åœ¨å†™çš„åœ°æ–¹ã€‚</li></ul><p>äºæ˜¯ï¼š</p><ul><li>æ¥æ”¶ç«¯åœ¨ç»™å‘é€ç«¯å› ACK ä¸­ä¼šæ±‡æŠ¥è‡ªå·±çš„ AdvertisedWindow = MaxRcvBuffer â€“ LastByteRcvd â€“ 1;</li><li>è€Œå‘é€æ–¹ä¼šæ ¹æ®è¿™ä¸ªçª—å£æ¥æ§åˆ¶å‘é€æ•°æ®çš„å¤§å°ï¼Œä»¥ä¿è¯æ¥æ”¶æ–¹å¯ä»¥å¤„ç†ã€‚</li></ul><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‘é€æ–¹çš„æ»‘åŠ¨çª—å£ç¤ºæ„å›¾ï¼š<br><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5omcs7ej30ic07i750.jpg" alt="img"></p><p>ä¸Šå›¾ä¸­åˆ†æˆäº†å››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šï¼ˆå…¶ä¸­é‚£ä¸ªé»‘æ¨¡å‹å°±æ˜¯æ»‘åŠ¨çª—å£ï¼‰</p><ul><li>#1 å·²æ”¶åˆ° ack ç¡®è®¤çš„æ•°æ®ã€‚</li><li>#2 å‘è¿˜æ²¡æ”¶åˆ° ack çš„ã€‚</li><li>#3 åœ¨çª—å£ä¸­è¿˜æ²¡æœ‰å‘å‡ºçš„ï¼ˆæ¥æ”¶æ–¹è¿˜æœ‰ç©ºé—´ï¼‰ã€‚</li><li>#4 çª—å£ä»¥å¤–çš„æ•°æ®ï¼ˆæ¥æ”¶æ–¹æ²¡ç©ºé—´ï¼‰</li></ul><p>ä¸‹é¢æ˜¯ä¸ªæ»‘åŠ¨åçš„ç¤ºæ„å›¾ï¼ˆæ”¶åˆ° 36 çš„ ackï¼Œå¹¶å‘å‡ºäº† 46-51 çš„å­—èŠ‚ï¼‰ï¼š<br><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5oq49tuj30ic05uwev.jpg" alt="img"></p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ¥å—ç«¯æ§åˆ¶å‘é€ç«¯çš„å›¾ç¤ºï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5ot8lvsj30ii0n8wfy.jpg" alt="img"></p><h3 id="Zero-Window"><a href="#Zero-Window" class="headerlink" title="Zero Window"></a>Zero Window</h3><p>ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¤„ç†ç¼“æ…¢çš„ Serverï¼ˆæ¥æ”¶ç«¯ï¼‰æ˜¯æ€ä¹ˆæŠŠ Clientï¼ˆå‘é€ç«¯ï¼‰çš„ TCP Sliding Window ç»™é™æˆ 0 çš„ã€‚æ­¤æ—¶ï¼Œä½ ä¸€å®šä¼šé—®ï¼Œå¦‚æœ Window å˜æˆ 0 äº†ï¼ŒTCP ä¼šæ€ä¹ˆæ ·ï¼Ÿæ˜¯ä¸æ˜¯å‘é€ç«¯å°±ä¸å‘æ•°æ®äº†ï¼Ÿæ˜¯çš„ï¼Œå‘é€ç«¯å°±ä¸å‘æ•°æ®äº†ï¼Œä½ å¯ä»¥æƒ³åƒæˆâ€œWindow Closedâ€ï¼Œé‚£ä½ ä¸€å®šè¿˜ä¼šé—®ï¼Œå¦‚æœå‘é€ç«¯ä¸å‘æ•°æ®äº†ï¼Œæ¥æ”¶æ–¹ä¸€ä¼šå„¿ Window size å¯ç”¨äº†ï¼Œæ€ä¹ˆé€šçŸ¥å‘é€ç«¯å‘¢ï¼Ÿ</p><p>è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒTCP ä½¿ç”¨äº† Zero Window Probe æŠ€æœ¯ï¼Œç¼©å†™ä¸º ZWPï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€ç«¯åœ¨çª—å£å˜æˆ 0 åï¼Œä¼šå‘ ZWP çš„åŒ…ç»™æ¥æ”¶æ–¹ï¼Œè®©æ¥æ”¶æ–¹æ¥ ack ä»–çš„ Window å°ºå¯¸ï¼Œä¸€èˆ¬è¿™ä¸ªå€¼ä¼šè®¾ç½®æˆ 3 æ¬¡ï¼Œç¬¬æ¬¡å¤§çº¦ 30-60 ç§’ï¼ˆä¸åŒçš„å®ç°å¯èƒ½ä¼šä¸ä¸€æ ·ï¼‰ã€‚å¦‚æœ 3 æ¬¡è¿‡åè¿˜æ˜¯ 0 çš„è¯ï¼Œæœ‰çš„ TCP å®ç°å°±ä¼šå‘ RST æŠŠé“¾æ¥æ–­äº†ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šåªè¦æœ‰ç­‰å¾…çš„åœ°æ–¹éƒ½å¯èƒ½å‡ºç° DDoS æ”»å‡»ï¼ŒZero Window ä¹Ÿä¸ä¾‹å¤–ï¼Œä¸€äº›æ”»å‡»è€…ä¼šåœ¨å’Œ HTTP å»ºå¥½é“¾å‘å®Œ GET è¯·æ±‚åï¼Œå°±æŠŠ Window è®¾ç½®ä¸º 0ï¼Œç„¶åæœåŠ¡ç«¯å°±åªèƒ½ç­‰å¾…è¿›è¡Œ ZWPï¼Œäºæ˜¯æ”»å‡»è€…ä¼šå¹¶å‘å¤§é‡çš„è¿™æ ·çš„è¯·æ±‚ï¼ŒæŠŠæœåŠ¡å™¨ç«¯çš„èµ„æºè€—å°½ã€‚ï¼ˆå…³äºè¿™æ–¹é¢çš„æ”»å‡»ï¼Œå¤§å®¶å¯ä»¥ç§»æ­¥çœ‹ä¸€ä¸‹<a href="http://en.wikipedia.org/wiki/Sockstress" target="_blank" rel="noopener">Wikipedia çš„ SockStress è¯æ¡</a>ï¼‰</p><p>å¦å¤–ï¼ŒWireshark ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ tcp.analysis.zero_window æ¥è¿‡æ»¤åŒ…ï¼Œç„¶åä½¿ç”¨å³é”®èœå•é‡Œçš„ follow TCP streamï¼Œä½ å¯ä»¥çœ‹åˆ° ZeroWindowProbe åŠ ZeroWindowProbeAck çš„åŒ…ã€‚</p><h3 id="Silly-Window-Syndrome"><a href="#Silly-Window-Syndrome" class="headerlink" title="Silly Window Syndrome"></a>Silly Window Syndrome</h3><p>Silly Window Syndrome ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯â€œç³Šæ¶‚çª—å£ç»¼åˆç—‡â€ã€‚æ­£å¦‚ä½ ä¸Šé¢çœ‹åˆ°çš„ä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬çš„æ¥æ”¶æ–¹å¤ªå¿™äº†ï¼Œæ¥ä¸åŠå–èµ° Receive Windows é‡Œçš„æ•°æ®ï¼Œé‚£ä¹ˆï¼Œå°±ä¼šå¯¼è‡´å‘é€æ–¹è¶Šæ¥è¶Šå°ã€‚åˆ°æœ€åï¼Œå¦‚æœæ¥æ”¶æ–¹è…¾å‡ºå‡ ä¸ªå­—èŠ‚å¹¶å‘Šè¯‰å‘é€æ–¹ç°åœ¨æœ‰å‡ ä¸ªå­—èŠ‚çš„ windowï¼Œè€Œæˆ‘ä»¬çš„å‘é€æ–¹ä¼šä¹‰æ— åé¡¾åœ°å‘é€è¿™å‡ ä¸ªå­—èŠ‚ã€‚</p><p>è¦çŸ¥é“ï¼Œæˆ‘ä»¬çš„ TCP+IP å¤´æœ‰ 40 ä¸ªå­—èŠ‚ï¼Œä¸ºäº†å‡ ä¸ªå­—èŠ‚ï¼Œè¦è¾¾ä¸Šè¿™ä¹ˆå¤§çš„å¼€é”€ï¼Œè¿™å¤ªä¸ç»æµäº†ã€‚</p><p>å¦å¤–ï¼Œä½ éœ€è¦çŸ¥é“ç½‘ç»œä¸Šæœ‰ä¸ª MTUï¼Œå¯¹äºä»¥å¤ªç½‘æ¥è¯´ï¼ŒMTU æ˜¯ 1500 å­—èŠ‚ï¼Œé™¤å» TCP+IP å¤´çš„ 40 ä¸ªå­—èŠ‚ï¼ŒçœŸæ­£çš„æ•°æ®ä¼ è¾“å¯ä»¥æœ‰ 1460ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ MSSï¼ˆMax Segment Sizeï¼‰æ³¨æ„ï¼ŒTCP çš„ RFC å®šä¹‰è¿™ä¸ª MSS çš„é»˜è®¤å€¼æ˜¯ 536ï¼Œè¿™æ˜¯å› ä¸º <a href="http://tools.ietf.org/html/rfc791" target="_blank" rel="noopener">RFC 791</a>é‡Œè¯´äº†ä»»ä½•ä¸€ä¸ª IP è®¾å¤‡éƒ½å¾—æœ€å°‘æ¥æ”¶ 576 å°ºå¯¸çš„å¤§å°ï¼ˆå®é™…ä¸Šæ¥è¯´ 576 æ˜¯æ‹¨å·çš„ç½‘ç»œçš„ MTUï¼Œè€Œ 576 å‡å» IP å¤´çš„ 20 ä¸ªå­—èŠ‚å°±æ˜¯ 536ï¼‰ã€‚</p><p><strong>å¦‚æœä½ çš„ç½‘ç»œåŒ…å¯ä»¥å¡æ»¡ MTUï¼Œé‚£ä¹ˆä½ å¯ä»¥ç”¨æ»¡æ•´ä¸ªå¸¦å®½ï¼Œå¦‚æœä¸èƒ½ï¼Œé‚£ä¹ˆä½ å°±ä¼šæµªè´¹å¸¦å®½</strong>ã€‚ï¼ˆå¤§äº MTU çš„åŒ…æœ‰ä¸¤ç§ç»“å±€ï¼Œä¸€ç§æ˜¯ç›´æ¥è¢«ä¸¢äº†ï¼Œå¦ä¸€ç§æ˜¯ä¼šè¢«é‡æ–°åˆ†å—æ‰“åŒ…å‘é€ï¼‰ ä½ å¯ä»¥æƒ³åƒæˆä¸€ä¸ª MTU å°±ç›¸å½“äºä¸€ä¸ªé£æœºçš„æœ€å¤šå¯ä»¥è£…çš„äººï¼Œå¦‚æœè¿™é£æœºé‡Œæ»¡è½½çš„è¯ï¼Œå¸¦å®½æœ€é«˜ï¼Œå¦‚æœä¸€ä¸ªé£æœºåªè¿ä¸€ä¸ªäººçš„è¯ï¼Œæ— ç–‘æˆæœ¬å¢åŠ äº†ï¼Œä¹Ÿè€Œç›¸å½“äºŒã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>Silly Windows Syndrome è¿™ä¸ªç°åƒå°±åƒæ˜¯ä½ æœ¬æ¥å¯ä»¥å 200 äººçš„é£æœºé‡Œåªåšäº†ä¸€ä¸¤ä¸ªäºº</strong>ã€‚ è¦è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯é¿å…å¯¹å°çš„ window size åšå‡ºå“åº”ï¼Œç›´åˆ°æœ‰è¶³å¤Ÿå¤§çš„ window size å†å“åº”ï¼Œè¿™ä¸ªæ€è·¯å¯ä»¥åŒæ—¶å®ç°åœ¨ sender å’Œ receiver ä¸¤ç«¯ã€‚</p><ul><li>å¦‚æœè¿™ä¸ªé—®é¢˜æ˜¯ç”± Receiver ç«¯å¼•èµ·çš„ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨ David D Clarkâ€™s æ–¹æ¡ˆã€‚åœ¨ receiver ç«¯ï¼Œå¦‚æœæ”¶åˆ°çš„æ•°æ®å¯¼è‡´ window size å°äºæŸä¸ªå€¼ï¼Œå¯ä»¥ç›´æ¥ ack(0)å› senderï¼Œè¿™æ ·å°±æŠŠ window ç»™å…³é—­äº†ï¼Œä¹Ÿé˜»æ­¢äº† sender å†å‘æ•°æ®è¿‡æ¥ï¼Œç­‰åˆ° receiver ç«¯å¤„ç†äº†ä¸€äº›æ•°æ®å windows size å¤§äºç­‰äºäº† MSSï¼Œæˆ–è€…ï¼Œreceiver buffer æœ‰ä¸€åŠä¸ºç©ºï¼Œå°±å¯ä»¥æŠŠ window æ‰“å¼€è®© send å‘é€æ•°æ®è¿‡æ¥ã€‚</li><li>å¦‚æœè¿™ä¸ªé—®é¢˜æ˜¯ç”± Sender ç«¯å¼•èµ·çš„ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨è‘—åçš„ <a href="http://en.wikipedia.org/wiki/Nagle's_algorithm" target="_blank" rel="noopener">Nagleâ€™s algorithm</a>ã€‚è¿™ä¸ªç®—æ³•çš„æ€è·¯ä¹Ÿæ˜¯å»¶æ—¶å¤„ç†ï¼Œä»–æœ‰ä¸¤ä¸ªä¸»è¦çš„æ¡ä»¶ï¼š1ï¼‰è¦ç­‰åˆ° Window Size&gt;=MSS æˆ–æ˜¯ Data Size &gt;=MSSï¼Œ2ï¼‰æ”¶åˆ°ä¹‹å‰å‘é€æ•°æ®çš„ ack å›åŒ…ï¼Œä»–æ‰ä¼šå‘æ•°æ®ï¼Œå¦åˆ™å°±æ˜¯åœ¨æ”’æ•°æ®ã€‚</li></ul><p>å¦å¤–ï¼ŒNagle ç®—æ³•é»˜è®¤æ˜¯æ‰“å¼€çš„ï¼Œæ‰€ä»¥ï¼Œå¯¹äºä¸€äº›éœ€è¦å°åŒ…åœºæ™¯çš„ç¨‹åºâ€”â€”<strong>æ¯”å¦‚åƒ telnet æˆ– ssh è¿™æ ·çš„äº¤äº’æ€§æ¯”è¾ƒå¼ºçš„ç¨‹åºï¼Œä½ éœ€è¦å…³é—­è¿™ä¸ªç®—æ³•</strong>ã€‚ä½ å¯ä»¥åœ¨ Socket è®¾ç½® TCP_NODELAY é€‰é¡¹æ¥å…³é—­è¿™ä¸ªç®—æ³•ï¼ˆå…³é—­ Nagle ç®—æ³•æ²¡æœ‰å…¨å±€å‚æ•°ï¼Œéœ€è¦æ ¹æ®æ¯ä¸ªåº”ç”¨è‡ªå·±çš„ç‰¹ç‚¹æ¥å…³é—­ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setsockopt(sock_fd, IPPROTO_TCP, TCP_NODELAY, (char*)&amp;value,sizeof(int));</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œç½‘ä¸Šæœ‰äº›æ–‡ç« è¯´ TCP_CORK çš„ socket option æ˜¯ä¹Ÿå…³é—­ Nagle ç®—æ³•ï¼Œè¿™ä¸å¯¹ã€‚<strong>TCP_CORK å…¶å®æ˜¯æ›´æ–°æ¿€è¿›çš„ Nagle ç®—æ±‰ï¼Œå®Œå…¨ç¦æ­¢å°åŒ…å‘é€ï¼Œè€Œ Nagle ç®—æ³•æ²¡æœ‰ç¦æ­¢å°åŒ…å‘é€ï¼Œåªæ˜¯ç¦æ­¢äº†å¤§é‡çš„å°åŒ…å‘é€</strong>ã€‚æœ€å¥½ä¸è¦ä¸¤ä¸ªé€‰é¡¹éƒ½è®¾ç½®ã€‚</p><h2 id="TCP-çš„æ‹¥å¡å¤„ç†-â€“-Congestion-Handling"><a href="#TCP-çš„æ‹¥å¡å¤„ç†-â€“-Congestion-Handling" class="headerlink" title="TCP çš„æ‹¥å¡å¤„ç† â€“ Congestion Handling"></a>TCP çš„æ‹¥å¡å¤„ç† â€“ Congestion Handling</h2><p>ä¸Šé¢æˆ‘ä»¬çŸ¥é“äº†ï¼ŒTCP é€šè¿‡ Sliding Window æ¥åšæµæ§ï¼ˆFlow Controlï¼‰ï¼Œä½†æ˜¯ TCP è§‰å¾—è¿™è¿˜ä¸å¤Ÿï¼Œå› ä¸º Sliding Window éœ€è¦ä¾èµ–äºè¿æ¥çš„å‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼Œå…¶å¹¶ä¸çŸ¥é“ç½‘ç»œä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆã€‚TCP çš„è®¾è®¡è€…è§‰å¾—ï¼Œä¸€ä¸ªä¼Ÿå¤§è€Œç‰›é€¼çš„åè®®ä»…ä»…åšåˆ°æµæ§å¹¶ä¸å¤Ÿï¼Œå› ä¸ºæµæ§åªæ˜¯ç½‘ç»œæ¨¡å‹ 4 å±‚ä»¥ä¸Šçš„äº‹ï¼ŒTCP çš„è¿˜åº”è¯¥æ›´èªæ˜åœ°çŸ¥é“æ•´ä¸ªç½‘ç»œä¸Šçš„äº‹ã€‚</p><p>å…·ä½“ä¸€ç‚¹ï¼Œæˆ‘ä»¬çŸ¥é“ TCP é€šè¿‡ä¸€ä¸ª timer é‡‡æ ·äº† RTT å¹¶è®¡ç®— RTOï¼Œä½†æ˜¯ï¼Œ<strong>å¦‚æœç½‘ç»œä¸Šçš„å»¶æ—¶çªç„¶å¢åŠ ï¼Œé‚£ä¹ˆï¼ŒTCP å¯¹è¿™ä¸ªäº‹åšå‡ºçš„åº”å¯¹åªæœ‰é‡ä¼ æ•°æ®ï¼Œä½†æ˜¯ï¼Œé‡ä¼ ä¼šå¯¼è‡´ç½‘ç»œçš„è´Ÿæ‹…æ›´é‡ï¼Œäºæ˜¯ä¼šå¯¼è‡´æ›´å¤§çš„å»¶è¿Ÿä»¥åŠæ›´å¤šçš„ä¸¢åŒ…ï¼Œäºæ˜¯ï¼Œè¿™ä¸ªæƒ…å†µå°±ä¼šè¿›å…¥æ¶æ€§å¾ªç¯è¢«ä¸æ–­åœ°æ”¾å¤§ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªç½‘ç»œå†…æœ‰æˆåƒä¸Šä¸‡çš„ TCP è¿æ¥éƒ½è¿™ä¹ˆè¡Œäº‹ï¼Œé‚£ä¹ˆé©¬ä¸Šå°±ä¼šå½¢æˆâ€œç½‘ç»œé£æš´â€ï¼ŒTCP è¿™ä¸ªåè®®å°±ä¼šæ‹–å®æ•´ä¸ªç½‘ç»œã€‚</strong>è¿™æ˜¯ä¸€ä¸ªç¾éš¾ã€‚</p><p>æ‰€ä»¥ï¼ŒTCP ä¸èƒ½å¿½ç•¥ç½‘ç»œä¸Šå‘ç”Ÿçš„äº‹æƒ…ï¼Œè€Œæ— è„‘åœ°ä¸€ä¸ªåŠ²åœ°é‡å‘æ•°æ®ï¼Œå¯¹ç½‘ç»œé€ æˆæ›´å¤§çš„ä¼¤å®³ã€‚å¯¹æ­¤ TCP çš„è®¾è®¡ç†å¿µæ˜¯ï¼š<strong>TCP ä¸æ˜¯ä¸€ä¸ªè‡ªç§çš„åè®®ï¼Œå½“æ‹¥å¡å‘ç”Ÿçš„æ—¶å€™ï¼Œè¦åšè‡ªæˆ‘ç‰ºç‰²ã€‚å°±åƒäº¤é€šé˜»å¡ä¸€æ ·ï¼Œæ¯ä¸ªè½¦éƒ½åº”è¯¥æŠŠè·¯è®©å‡ºæ¥ï¼Œè€Œä¸è¦å†å»æŠ¢è·¯äº†ã€‚</strong></p><p>æ‹¥å¡æ§åˆ¶ä¸»è¦æ˜¯å››ä¸ªç®—æ³•ï¼š<strong>1ï¼‰æ…¢å¯åŠ¨</strong>ï¼Œ<strong>2ï¼‰æ‹¥å¡é¿å…</strong>ï¼Œ<strong>3ï¼‰æ‹¥å¡å‘ç”Ÿ</strong>ï¼Œ<strong>4ï¼‰å¿«é€Ÿæ¢å¤</strong>ã€‚è¿™å››ä¸ªç®—æ³•ä¸æ˜¯ä¸€å¤©éƒ½æå‡ºæ¥çš„ï¼Œè¿™ä¸ªå››ç®—æ³•çš„å‘å±•ç»å†äº†å¾ˆå¤šæ—¶é—´ï¼Œåˆ°ä»Šå¤©éƒ½è¿˜åœ¨ä¼˜åŒ–ä¸­ã€‚ å¤‡æ³¨:</p><ul><li>1988 å¹´ï¼ŒTCP-Tahoe æå‡ºäº† 1ï¼‰æ…¢å¯åŠ¨ï¼Œ2ï¼‰æ‹¥å¡é¿å…ï¼Œ3ï¼‰æ‹¥å¡å‘ç”Ÿæ—¶çš„å¿«é€Ÿé‡ä¼ </li><li>1990 å¹´ï¼ŒTCP Reno åœ¨ Tahoe çš„åŸºç¡€ä¸Šå¢åŠ äº† 4ï¼‰å¿«é€Ÿæ¢å¤</li></ul><h3 id="æ…¢çƒ­å¯åŠ¨ç®—æ³•-â€“-Slow-Start"><a href="#æ…¢çƒ­å¯åŠ¨ç®—æ³•-â€“-Slow-Start" class="headerlink" title="æ…¢çƒ­å¯åŠ¨ç®—æ³• â€“ Slow Start"></a>æ…¢çƒ­å¯åŠ¨ç®—æ³• â€“ Slow Start</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ TCP çš„æ…¢çƒ­å¯åŠ¨ã€‚æ…¢å¯åŠ¨çš„æ„æ€æ˜¯ï¼ŒåˆšåˆšåŠ å…¥ç½‘ç»œçš„è¿æ¥ï¼Œä¸€ç‚¹ä¸€ç‚¹åœ°æé€Ÿï¼Œä¸è¦ä¸€ä¸Šæ¥å°±åƒé‚£äº›ç‰¹æƒè½¦ä¸€æ ·éœ¸é“åœ°æŠŠè·¯å æ»¡ã€‚æ–°åŒå­¦ä¸Šé«˜é€Ÿè¿˜æ˜¯è¦æ…¢ä¸€ç‚¹ï¼Œä¸è¦æŠŠå·²ç»åœ¨é«˜é€Ÿä¸Šçš„ç§©åºç»™æä¹±äº†ã€‚</p><p>æ…¢å¯åŠ¨çš„ç®—æ³•å¦‚ä¸‹(cwnd å…¨ç§° Congestion Window)ï¼š</p><p>1ï¼‰è¿æ¥å»ºå¥½çš„å¼€å§‹å…ˆåˆå§‹åŒ– cwnd = 1ï¼Œè¡¨æ˜å¯ä»¥ä¼ ä¸€ä¸ª MSS å¤§å°çš„æ•°æ®ã€‚</p><p>2ï¼‰æ¯å½“æ”¶åˆ°ä¸€ä¸ª ACKï¼Œcwnd++; å‘ˆçº¿æ€§ä¸Šå‡</p><p>3ï¼‰æ¯å½“è¿‡äº†ä¸€ä¸ª RTTï¼Œcwnd = cwnd*2; å‘ˆæŒ‡æ•°è®©å‡</p><p>4ï¼‰è¿˜æœ‰ä¸€ä¸ª ssthreshï¼ˆslow start thresholdï¼‰ï¼Œæ˜¯ä¸€ä¸ªä¸Šé™ï¼Œå½“ cwnd &gt;= ssthresh æ—¶ï¼Œå°±ä¼šè¿›å…¥â€œæ‹¥å¡é¿å…ç®—æ³•â€ï¼ˆåé¢ä¼šè¯´è¿™ä¸ªç®—æ³•ï¼‰</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœç½‘é€Ÿå¾ˆå¿«çš„è¯ï¼ŒACK ä¹Ÿä¼šè¿”å›å¾—å¿«ï¼ŒRTT ä¹Ÿä¼šçŸ­ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªæ…¢å¯åŠ¨å°±ä¸€ç‚¹ä¹Ÿä¸æ…¢ã€‚ä¸‹å›¾è¯´æ˜äº†è¿™ä¸ªè¿‡ç¨‹ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5oz81ffj30ie0asjsi.jpg" alt="img"></p><p>ä¸€ç¯‡ Google çš„è®ºæ–‡ã€Š<a href="http://static.googleusercontent.com/media/research.google.com/zh-CN//pubs/archive/36640.pdf" target="_blank" rel="noopener">An Argument for Increasing TCPâ€™s Initial Congestion Window</a>ã€‹Linux 3.0 åé‡‡ç”¨äº†è¿™ç¯‡è®ºæ–‡çš„å»ºè®®â€”â€”æŠŠ cwnd åˆå§‹åŒ–æˆäº† 10 ä¸ª MSSã€‚è€Œ Linux 3.0 ä»¥å‰ï¼Œæ¯”å¦‚ 2.6ï¼ŒLinux é‡‡ç”¨äº†<a href="http://www.rfc-editor.org/rfc/rfc3390.txt" target="_blank" rel="noopener">RFC3390</a>ï¼Œcwnd æ˜¯è·Ÿ MSS çš„å€¼æ¥å˜çš„ï¼Œå¦‚æœ MSS&lt; 1095ï¼Œåˆ™ cwnd = 4ï¼›å¦‚æœ MSS&gt;2190ï¼Œåˆ™ cwnd=2ï¼›å…¶å®ƒæƒ…å†µä¸‹ï¼Œåˆ™æ˜¯ 3ã€‚</p><h3 id="æ‹¥å¡é¿å…ç®—æ³•-â€“-Congestion-Avoidance"><a href="#æ‹¥å¡é¿å…ç®—æ³•-â€“-Congestion-Avoidance" class="headerlink" title="æ‹¥å¡é¿å…ç®—æ³• â€“ Congestion Avoidance"></a>æ‹¥å¡é¿å…ç®—æ³• â€“ Congestion Avoidance</h3><p>å‰é¢è¯´è¿‡ï¼Œè¿˜æœ‰ä¸€ä¸ª ssthreshï¼ˆslow start thresholdï¼‰ï¼Œæ˜¯ä¸€ä¸ªä¸Šé™ï¼Œå½“ cwnd &gt;= ssthresh æ—¶ï¼Œå°±ä¼šè¿›å…¥â€œæ‹¥å¡é¿å…ç®—æ³•â€ã€‚ä¸€èˆ¬æ¥è¯´ ssthresh çš„å€¼æ˜¯ 65535ï¼Œå•ä½æ˜¯å­—èŠ‚ï¼Œå½“ cwnd è¾¾åˆ°è¿™ä¸ªå€¼æ—¶åï¼Œç®—æ³•å¦‚ä¸‹ï¼š</p><p>1ï¼‰æ”¶åˆ°ä¸€ä¸ª ACK æ—¶ï¼Œcwnd = cwnd + 1/cwnd</p><p>2ï¼‰å½“æ¯è¿‡ä¸€ä¸ª RTT æ—¶ï¼Œcwnd = cwnd + 1</p><p>è¿™æ ·å°±å¯ä»¥é¿å…å¢é•¿è¿‡å¿«å¯¼è‡´ç½‘ç»œæ‹¥å¡ï¼Œæ…¢æ…¢çš„å¢åŠ è°ƒæ•´åˆ°ç½‘ç»œçš„æœ€ä½³å€¼ã€‚å¾ˆæ˜æ˜¾ï¼Œæ˜¯ä¸€ä¸ªçº¿æ€§ä¸Šå‡çš„ç®—æ³•ã€‚</p><h3 id="æ‹¥å¡çŠ¶æ€æ—¶çš„ç®—æ³•"><a href="#æ‹¥å¡çŠ¶æ€æ—¶çš„ç®—æ³•" class="headerlink" title="æ‹¥å¡çŠ¶æ€æ—¶çš„ç®—æ³•"></a>æ‹¥å¡çŠ¶æ€æ—¶çš„ç®—æ³•</h3><p>å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œå½“ä¸¢åŒ…çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸¤ç§æƒ…å†µï¼š</p><p>1ï¼‰ç­‰åˆ° RTO è¶…æ—¶ï¼Œé‡ä¼ æ•°æ®åŒ…ã€‚TCP è®¤ä¸ºè¿™ç§æƒ…å†µå¤ªç³Ÿç³•ï¼Œååº”ä¹Ÿå¾ˆå¼ºçƒˆã€‚</p><ul><li><ul><li>sshthresh = cwnd /2</li><li>cwnd é‡ç½®ä¸º 1</li><li>è¿›å…¥æ…¢å¯åŠ¨è¿‡ç¨‹</li></ul></li></ul><p>2ï¼‰Fast Retransmit ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨æ”¶åˆ° 3 ä¸ª duplicate ACK æ—¶å°±å¼€å¯é‡ä¼ ï¼Œè€Œä¸ç”¨ç­‰åˆ° RTO è¶…æ—¶ã€‚</p><ul><li><ul><li>TCP Tahoe çš„å®ç°å’Œ RTO è¶…æ—¶ä¸€æ ·ã€‚</li></ul></li><li><ul><li>TCP Reno çš„å®ç°æ˜¯ï¼š<ul><li>cwnd = cwnd /2</li><li>sshthresh = cwnd</li><li>è¿›å…¥å¿«é€Ÿæ¢å¤ç®—æ³•â€”â€”Fast Recovery</li></ul></li></ul></li></ul><p>ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ° RTO è¶…æ—¶åï¼Œsshthresh ä¼šå˜æˆ cwnd çš„ä¸€åŠï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœ cwnd&lt;=sshthresh æ—¶å‡ºç°çš„ä¸¢åŒ…ï¼Œé‚£ä¹ˆ TCP çš„ sshthresh å°±ä¼šå‡äº†ä¸€åŠï¼Œç„¶åç­‰ cwnd åˆå¾ˆå¿«åœ°ä»¥æŒ‡æ•°çº§å¢æ¶¨çˆ¬åˆ°è¿™ä¸ªåœ°æ–¹æ—¶ï¼Œå°±ä¼šæˆæ…¢æ…¢çš„çº¿æ€§å¢æ¶¨ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒTCP æ˜¯æ€ä¹ˆé€šè¿‡è¿™ç§å¼ºçƒˆåœ°éœ‡è¡å¿«é€Ÿè€Œå°å¿ƒå¾—æ‰¾åˆ°ç½‘ç«™æµé‡çš„å¹³è¡¡ç‚¹çš„ã€‚</p><h3 id="å¿«é€Ÿæ¢å¤ç®—æ³•-â€“-Fast-Recovery"><a href="#å¿«é€Ÿæ¢å¤ç®—æ³•-â€“-Fast-Recovery" class="headerlink" title="å¿«é€Ÿæ¢å¤ç®—æ³• â€“ Fast Recovery"></a>å¿«é€Ÿæ¢å¤ç®—æ³• â€“ Fast Recovery</h3><h4 id="TCP-Reno"><a href="#TCP-Reno" class="headerlink" title="TCP Reno"></a>TCP Reno</h4><p>è¿™ä¸ªç®—æ³•å®šä¹‰åœ¨<a href="http://tools.ietf.org/html/rfc5681" target="_blank" rel="noopener">RFC5681</a>ã€‚å¿«é€Ÿé‡ä¼ å’Œå¿«é€Ÿæ¢å¤ç®—æ³•ä¸€èˆ¬åŒæ—¶ä½¿ç”¨ã€‚å¿«é€Ÿæ¢å¤ç®—æ³•æ˜¯è®¤ä¸ºï¼Œä½ è¿˜æœ‰ 3 ä¸ª Duplicated Acks è¯´æ˜ç½‘ç»œä¹Ÿä¸é‚£ä¹ˆç³Ÿç³•ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦åƒ RTO è¶…æ—¶é‚£ä¹ˆå¼ºçƒˆã€‚ æ³¨æ„ï¼Œæ­£å¦‚å‰é¢æ‰€è¯´ï¼Œè¿›å…¥ Fast Recovery ä¹‹å‰ï¼Œcwnd å’Œ sshthresh å·²è¢«æ›´æ–°ï¼š</p><ul><li>cwnd = cwnd /2</li><li>sshthresh = cwnd</li></ul><p>ç„¶åï¼ŒçœŸæ­£çš„ Fast Recovery ç®—æ³•å¦‚ä¸‹ï¼š</p><ul><li>cwnd = sshthresh + 3 * MSS ï¼ˆ3 çš„æ„æ€æ˜¯ç¡®è®¤æœ‰ 3 ä¸ªæ•°æ®åŒ…è¢«æ”¶åˆ°äº†ï¼‰</li><li>é‡ä¼  Duplicated ACKs æŒ‡å®šçš„æ•°æ®åŒ…</li><li>å¦‚æœå†æ”¶åˆ° duplicated Acksï¼Œé‚£ä¹ˆ cwnd = cwnd +1</li><li>å¦‚æœæ”¶åˆ°äº†æ–°çš„ Ackï¼Œé‚£ä¹ˆï¼Œcwnd = sshthresh ï¼Œç„¶åå°±è¿›å…¥äº†æ‹¥å¡é¿å…çš„ç®—æ³•äº†ã€‚</li></ul><p>å¦‚æœä½ ä»”ç»†æ€è€ƒä¸€ä¸‹ä¸Šé¢çš„è¿™ä¸ªç®—æ³•ï¼Œä½ å°±ä¼šçŸ¥é“ï¼Œ<strong>ä¸Šé¢è¿™ä¸ªç®—æ³•ä¹Ÿæœ‰é—®é¢˜ï¼Œé‚£å°±æ˜¯â€”â€”å®ƒä¾èµ–äº 3 ä¸ªé‡å¤çš„ Acks</strong>ã€‚æ³¨æ„ï¼Œ3 ä¸ªé‡å¤çš„ Acks å¹¶ä¸ä»£è¡¨åªä¸¢äº†ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯ä¸¢äº†å¥½å¤šåŒ…ã€‚ä½†è¿™ä¸ªç®—æ³•åªä¼šé‡ä¼ ä¸€ä¸ªï¼Œè€Œå‰©ä¸‹çš„é‚£äº›åŒ…åªèƒ½ç­‰åˆ° RTO è¶…æ—¶ï¼Œäºæ˜¯ï¼Œè¿›å…¥äº†æ¶æ¢¦æ¨¡å¼â€”â€”è¶…æ—¶ä¸€ä¸ªçª—å£å°±å‡åŠä¸€ä¸‹ï¼Œå¤šä¸ªè¶…æ—¶ä¼šè¶…æˆ TCP çš„ä¼ è¾“é€Ÿåº¦å‘ˆçº§æ•°ä¸‹é™ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šè§¦å‘ Fast Recovery ç®—æ³•äº†ã€‚</p><p>é€šå¸¸æ¥è¯´ï¼Œæ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è¯´çš„ï¼ŒSACK æˆ– D-SACK çš„æ–¹æ³•å¯ä»¥è®© Fast Recovery æˆ– Sender åœ¨åšå†³å®šæ—¶æ›´èªæ˜ä¸€äº›ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„ TCP çš„å®ç°éƒ½æ”¯æŒ SACKï¼ˆSACK éœ€è¦ä¸¤ç«¯éƒ½æ”¯æŒï¼‰ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä¸€ä¸ªæ²¡æœ‰ SACK çš„è§£å†³æ–¹æ¡ˆã€‚è€Œé€šè¿‡ SACK è¿›è¡Œæ‹¥å¡æ§åˆ¶çš„ç®—æ³•æ˜¯ FACKï¼ˆåé¢ä¼šè®²ï¼‰</p><h4 id="TCP-New-Reno"><a href="#TCP-New-Reno" class="headerlink" title="TCP New Reno"></a>TCP New Reno</h4><p>äºæ˜¯ï¼Œ1995 å¹´ï¼ŒTCP New Renoï¼ˆå‚è§ <a href="http://tools.ietf.org/html/rfc6582" target="_blank" rel="noopener">RFC 6582</a> ï¼‰ç®—æ³•æå‡ºæ¥ï¼Œä¸»è¦å°±æ˜¯åœ¨æ²¡æœ‰ SACK çš„æ”¯æŒä¸‹æ”¹è¿› Fast Recovery ç®—æ³•çš„â€”â€”</p><ul><li>å½“ sender è¿™è¾¹æ”¶åˆ°äº† 3 ä¸ª Duplicated Acksï¼Œè¿›å…¥ Fast Retransimit æ¨¡å¼ï¼Œå¼€å‘é‡ä¼ é‡å¤ Acks æŒ‡ç¤ºçš„é‚£ä¸ªåŒ…ã€‚å¦‚æœåªæœ‰è¿™ä¸€ä¸ªåŒ…ä¸¢äº†ï¼Œé‚£ä¹ˆï¼Œé‡ä¼ è¿™ä¸ªåŒ…åå›æ¥çš„ Ack ä¼šæŠŠæ•´ä¸ªå·²ç»è¢« sender ä¼ è¾“å‡ºå»çš„æ•°æ® ack å›æ¥ã€‚å¦‚æœæ²¡æœ‰çš„è¯ï¼Œè¯´æ˜æœ‰å¤šä¸ªåŒ…ä¸¢äº†ã€‚æˆ‘ä»¬å«è¿™ä¸ª ACK ä¸º Partial ACKã€‚</li><li>ä¸€æ—¦ Sender è¿™è¾¹å‘ç°äº† Partial ACK å‡ºç°ï¼Œé‚£ä¹ˆï¼Œsender å°±å¯ä»¥æ¨ç†å‡ºæ¥æœ‰å¤šä¸ªåŒ…è¢«ä¸¢äº†ï¼Œäºæ˜¯ä¹ç»§ç»­é‡ä¼  sliding window é‡Œæœªè¢« ack çš„ç¬¬ä¸€ä¸ªåŒ…ã€‚ç›´åˆ°å†ä¹Ÿæ”¶ä¸åˆ°äº† Partial Ackï¼Œæ‰çœŸæ­£ç»“æŸ Fast Recovery è¿™ä¸ªè¿‡ç¨‹</li></ul><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªâ€œFast Recovery çš„å˜æ›´â€æ˜¯ä¸€ä¸ªéå¸¸æ¿€è¿›çš„ç©æ³•ï¼Œä»–åŒæ—¶å»¶é•¿äº† Fast Retransmit å’Œ Fast Recovery çš„è¿‡ç¨‹ã€‚</p><h5 id="ç®—æ³•ç¤ºæ„å›¾"><a href="#ç®—æ³•ç¤ºæ„å›¾" class="headerlink" title="ç®—æ³•ç¤ºæ„å›¾"></a>ç®—æ³•ç¤ºæ„å›¾</h5><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„å›¾ç¤ºä»¥åŒæ—¶çœ‹ä¸€ä¸‹ä¸Šé¢çš„å„ç§ç®—æ³•çš„æ ·å­ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5p47j65j30sg09zgmc.jpg" alt="img"></p><h4 id="FACK-ç®—æ³•"><a href="#FACK-ç®—æ³•" class="headerlink" title="FACK ç®—æ³•"></a>FACK ç®—æ³•</h4><p>FACK å…¨ç§° Forward Acknowledgment ç®—æ³•ï¼Œè®ºæ–‡åœ°å€åœ¨è¿™é‡Œï¼ˆPDFï¼‰<a href="http://conferences.sigcomm.org/sigcomm/1996/papers/mathis.pdf" target="_blank" rel="noopener">Forward Acknowledgement: Refining TCP Congestion Control</a> è¿™ä¸ªç®—æ³•æ˜¯å…¶äº SACK çš„ï¼Œå‰é¢æˆ‘ä»¬è¯´è¿‡ SACK æ˜¯ä½¿ç”¨äº† TCP æ‰©å±•å­—æ®µ Ack äº†æœ‰å“ªäº›æ•°æ®æ”¶åˆ°ï¼Œå“ªäº›æ•°æ®æ²¡æœ‰æ”¶åˆ°ï¼Œä»–æ¯” Fast Retransmit çš„ 3 ä¸ª duplicated acks å¥½å¤„åœ¨äºï¼Œå‰è€…åªçŸ¥é“æœ‰åŒ…ä¸¢äº†ï¼Œä¸çŸ¥é“æ˜¯ä¸€ä¸ªè¿˜æ˜¯å¤šä¸ªï¼Œè€Œ SACK å¯ä»¥å‡†ç¡®çš„çŸ¥é“æœ‰å“ªäº›åŒ…ä¸¢äº†ã€‚ æ‰€ä»¥ï¼ŒSACK å¯ä»¥è®©å‘é€ç«¯è¿™è¾¹åœ¨é‡ä¼ è¿‡ç¨‹ä¸­ï¼ŒæŠŠé‚£äº›ä¸¢æ‰çš„åŒ…é‡ä¼ ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„ä¼ ï¼Œä½†è¿™æ ·çš„ä¸€æ¥ï¼Œå¦‚æœé‡ä¼ çš„åŒ…æ•°æ®æ¯”è¾ƒå¤šçš„è¯ï¼Œåˆä¼šå¯¼è‡´æœ¬æ¥å°±å¾ˆå¿™çš„ç½‘ç»œå°±æ›´å¿™äº†ã€‚æ‰€ä»¥ï¼ŒFACK ç”¨æ¥åšé‡ä¼ è¿‡ç¨‹ä¸­çš„æ‹¥å¡æµæ§ã€‚</p><ul><li>è¿™ä¸ªç®—æ³•ä¼šæŠŠ SACK ä¸­æœ€å¤§çš„ Sequence Number ä¿å­˜åœ¨<strong>snd.fack</strong>è¿™ä¸ªå˜é‡ä¸­ï¼Œsnd.fack çš„æ›´æ–°ç”± ack å¸¦ç§‹ï¼Œå¦‚æœç½‘ç»œä¸€åˆ‡å®‰å¥½åˆ™å’Œ snd.una ä¸€æ ·ï¼ˆsnd.una å°±æ˜¯è¿˜æ²¡æœ‰æ”¶åˆ° ack çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯å‰é¢ sliding window é‡Œçš„ category #2 çš„ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼‰</li><li>ç„¶åå®šä¹‰ä¸€ä¸ª<strong>awnd = snd.nxt â€“ snd.fack</strong>ï¼ˆsnd.nxt æŒ‡å‘å‘é€ç«¯ sliding window ä¸­æ­£åœ¨è¦è¢«å‘é€çš„åœ°æ–¹â€”â€”å‰é¢ sliding windows å›¾ç¤ºçš„ category#3 ç¬¬ä¸€ä¸ªä½ç½®ï¼‰ï¼Œè¿™æ · awnd çš„æ„æ€å°±æ˜¯åœ¨ç½‘ç»œä¸Šçš„æ•°æ®ã€‚ï¼ˆæ‰€è°“ awnd æ„ä¸ºï¼šactual quantity of data outstanding in the networkï¼‰</li><li>å¦‚æœéœ€è¦é‡ä¼ æ•°æ®ï¼Œé‚£ä¹ˆï¼Œ<strong>awnd = snd.nxt â€“ snd.fack + retran_data</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œawnd æ˜¯ä¼ å‡ºå»çš„æ•°æ® + é‡ä¼ çš„æ•°æ®ã€‚</li><li>ç„¶åè§¦å‘ Fast Recovery çš„æ¡ä»¶æ˜¯ï¼š ( <strong>( snd.fack â€“ snd.una ) &gt; (3*MSS)</strong> ) || (dupacks == 3) ) ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ä¸éœ€è¦ç­‰åˆ° 3 ä¸ª duplicated acks æ‰é‡ä¼ ï¼Œè€Œæ˜¯åªè¦ sack ä¸­çš„æœ€å¤§çš„ä¸€ä¸ªæ•°æ®å’Œ ack çš„æ•°æ®æ¯”è¾ƒé•¿äº†ï¼ˆ3 ä¸ª MSSï¼‰ï¼Œé‚£å°±è§¦å‘é‡ä¼ ã€‚åœ¨æ•´ä¸ªé‡ä¼ è¿‡ç¨‹ä¸­ cwnd ä¸å˜ã€‚ç›´åˆ°å½“ç¬¬ä¸€æ¬¡ä¸¢åŒ…çš„ snd.nxt&lt;=snd.unaï¼ˆä¹Ÿå°±æ˜¯é‡ä¼ çš„æ•°æ®éƒ½è¢«ç¡®è®¤äº†ï¼‰ï¼Œç„¶åè¿›æ¥æ‹¥å¡é¿å…æœºåˆ¶â€”â€”cwnd çº¿æ€§ä¸Šæ¶¨ã€‚</li></ul><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœæ²¡æœ‰ FACK åœ¨ï¼Œé‚£ä¹ˆåœ¨ä¸¢åŒ…æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼ŒåŸæ¥ä¿å®ˆçš„ç®—æ³•ä¼šä½ä¼°äº†éœ€è¦ä½¿ç”¨çš„ window çš„å¤§å°ï¼Œè€Œéœ€è¦å‡ ä¸ª RTT çš„æ—¶é—´æ‰ä¼šå®Œæˆæ¢å¤ï¼Œè€Œ FACK ä¼šæ¯”è¾ƒæ¿€è¿›åœ°æ¥å¹²è¿™äº‹ã€‚ ä½†æ˜¯ï¼ŒFACK å¦‚æœåœ¨ä¸€ä¸ªç½‘ç»œåŒ…ä¼šè¢« reordering çš„ç½‘ç»œé‡Œä¼šæœ‰å¾ˆå¤§çš„é—®é¢˜ã€‚</p><h2 id="å…¶å®ƒæ‹¥å¡æ§åˆ¶ç®—æ³•ç®€ä»‹"><a href="#å…¶å®ƒæ‹¥å¡æ§åˆ¶ç®—æ³•ç®€ä»‹" class="headerlink" title="å…¶å®ƒæ‹¥å¡æ§åˆ¶ç®—æ³•ç®€ä»‹"></a>å…¶å®ƒæ‹¥å¡æ§åˆ¶ç®—æ³•ç®€ä»‹</h2><h3 id="TCP-Vegas-æ‹¥å¡æ§åˆ¶ç®—æ³•"><a href="#TCP-Vegas-æ‹¥å¡æ§åˆ¶ç®—æ³•" class="headerlink" title="TCP Vegas æ‹¥å¡æ§åˆ¶ç®—æ³•"></a><strong>TCP Vegas æ‹¥å¡æ§åˆ¶ç®—æ³•</strong></h3><p>è¿™ä¸ªç®—æ³• 1994 å¹´è¢«æå‡ºï¼Œå®ƒä¸»è¦å¯¹ TCP Reno åšäº†äº›ä¿®æ”¹ã€‚è¿™ä¸ªç®—æ³•é€šè¿‡å¯¹ RTT çš„éå¸¸é‡çš„ç›‘æ§æ¥è®¡ç®—ä¸€ä¸ªåŸºå‡† RTTã€‚ç„¶åé€šè¿‡è¿™ä¸ªåŸºå‡† RTT æ¥ä¼°è®¡å½“å‰çš„ç½‘ç»œå®é™…å¸¦å®½ï¼Œå¦‚æœå®é™…å¸¦å®½æ¯”æˆ‘ä»¬çš„æœŸæœ›çš„å¸¦å®½è¦å°æˆ–æ˜¯è¦å¤šçš„æ´»ï¼Œé‚£ä¹ˆå°±å¼€å§‹çº¿æ€§åœ°å‡å°‘æˆ–å¢åŠ  cwnd çš„å¤§å°ã€‚å¦‚æœè¿™ä¸ªè®¡ç®—å‡ºæ¥çš„ RTT å¤§äºäº† Timeout åï¼Œé‚£ä¹ˆï¼Œä¸ç­‰ ack è¶…æ—¶å°±ç›´æ¥é‡ä¼ ã€‚ï¼ˆVegas çš„æ ¸å¿ƒæ€æƒ³æ˜¯ç”¨ RTT çš„å€¼æ¥å½±å“æ‹¥å¡çª—å£ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¸¢åŒ…ï¼‰ è¿™ä¸ªç®—æ³•çš„è®ºæ–‡æ˜¯ã€Š<a href="http://www.cs.cmu.edu/~srini/15-744/F02/readings/BP95.pdf" target="_blank" rel="noopener">TCP Vegas: End to End Congestion Avoidance on a Global Internet</a>ã€‹è¿™ç¯‡è®ºæ–‡ç»™äº† Vegas å’Œ New Reno çš„å¯¹æ¯”ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6j5p96am2j30sg0fftd3.jpg" alt="img"></p><p>å…³äºè¿™ä¸ªç®—æ³•å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š<a href="http://lxr.free-electrons.com/source/net/ipv4/tcp_vegas.h" target="_blank" rel="noopener">/net/ipv4/tcp_vegas.h</a>ï¼Œ <a href="http://lxr.free-electrons.com/source/net/ipv4/tcp_vegas.c" target="_blank" rel="noopener">/net/ipv4/tcp_vegas.c</a></p><h3 id="HSTCP-High-Speed-TCP-ç®—æ³•"><a href="#HSTCP-High-Speed-TCP-ç®—æ³•" class="headerlink" title="HSTCP(High Speed TCP) ç®—æ³•"></a>HSTCP(High Speed TCP) ç®—æ³•</h3><p>è¿™ä¸ªç®—æ³•æ¥è‡ª<a href="http://tools.ietf.org/html/rfc3649" target="_blank" rel="noopener">RFC 3649</a>ï¼ˆ<a href="http://en.wikipedia.org/wiki/HSTCP" target="_blank" rel="noopener">Wikipedia è¯æ¡</a>ï¼‰ã€‚å…¶å¯¹æœ€åŸºç¡€çš„ç®—æ³•è¿›è¡Œäº†æ›´æ”¹ï¼Œä»–ä½¿å¾— Congestion Window æ¶¨å¾—å¿«ï¼Œå‡å¾—æ…¢ã€‚å…¶ä¸­ï¼š</p><ul><li>æ‹¥å¡é¿å…æ—¶çš„çª—å£å¢é•¿æ–¹å¼ï¼š cwnd = cwnd + Î±(cwnd) / cwnd</li><li>ä¸¢åŒ…åçª—å£ä¸‹é™æ–¹å¼ï¼šcwnd = (1- Î²(cwnd))*cwnd</li></ul><p>æ³¨ï¼šÎ±(cwnd)å’Œ Î²(cwnd)éƒ½æ˜¯å‡½æ•°ï¼Œå¦‚æœä½ è¦è®©ä»–ä»¬å’Œæ ‡å‡†çš„ TCP ä¸€æ ·ï¼Œé‚£ä¹ˆè®© Î±(cwnd)=1ï¼ŒÎ²(cwnd)=0.5 å°±å¯ä»¥äº†ã€‚ å¯¹äº Î±(cwnd)å’Œ Î²(cwnd)çš„å€¼æ˜¯ä¸ªåŠ¨æ€çš„å˜æ¢çš„ä¸œè¥¿ã€‚ å…³äºè¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š<a href="http://lxr.free-electrons.com/source/net/ipv4/tcp_highspeed.c" target="_blank" rel="noopener">/net/ipv4/tcp_highspeed.c</a></p><h3 id="TCP-BIC-ç®—æ³•"><a href="#TCP-BIC-ç®—æ³•" class="headerlink" title="TCP BIC ç®—æ³•"></a>TCP BIC ç®—æ³•</h3><p>2004 å¹´ï¼Œäº§å†…å‡º BIC ç®—æ³•ã€‚ç°åœ¨ä½ è¿˜å¯ä»¥æŸ¥å¾—åˆ°ç›¸å…³çš„æ–°é—»ã€ŠGoogleï¼š<a href="https://www.google.com/search?lr=lang_zh-CN|lang_zh-TW&newwindow=1&biw=1366&bih=597&tbs=lr%3Alang_1zh-CN|lang_1zh-TW&q=ç¾ç§‘å­¦å®¶ç ”å‘BIC-TCPåè®®+é€Ÿåº¦æ˜¯DSLå…­åƒå€&oq=ç¾ç§‘å­¦å®¶ç ”å‘BIC-TCPåè®®+é€Ÿåº¦æ˜¯DSLå…­åƒå€" target="_blank" rel="noopener">ç¾ç§‘å­¦å®¶ç ”å‘ BIC-TCP åè®® é€Ÿåº¦æ˜¯ DSL å…­åƒå€</a>ã€‹ BIC å…¨ç§°<a href="http://research.csc.ncsu.edu/netsrv/?q=content/bic-and-cubic" target="_blank" rel="noopener">Binary Increase Congestion control</a>ï¼Œåœ¨ Linux 2.6.8 ä¸­æ˜¯é»˜è®¤æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚BIC çš„å‘æ˜è€…å‘è¿™ä¹ˆå¤šçš„æ‹¥å¡æ§åˆ¶ç®—æ³•éƒ½åœ¨åŠªåŠ›æ‰¾ä¸€ä¸ªåˆé€‚çš„ cwnd â€“ Congestion Windowï¼Œè€Œä¸” BIC-TCP çš„æå‡ºè€…ä»¬çœ‹ç©¿äº†äº‹æƒ…çš„æœ¬è´¨ï¼Œå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªæœç´¢çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ BIC è¿™ä¸ªç®—æ³•ä¸»è¦ç”¨çš„æ˜¯ Binary Searchâ€”â€”äºŒåˆ†æŸ¥æ‰¾æ¥å¹²è¿™ä¸ªäº‹ã€‚ å…³äºè¿™ä¸ªç®—æ³•å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š<a href="http://lxr.free-electrons.com/source/net/ipv4/tcp_bic.c" target="_blank" rel="noopener">/net/ipv4/tcp_bic.c</a></p><h3 id="TCP-WestWood-ç®—æ³•"><a href="#TCP-WestWood-ç®—æ³•" class="headerlink" title="TCP WestWood ç®—æ³•"></a>TCP WestWood ç®—æ³•</h3><p>westwood é‡‡ç”¨å’Œ Reno ç›¸åŒçš„æ…¢å¯åŠ¨ç®—æ³•ã€æ‹¥å¡é¿å…ç®—æ³•ã€‚westwood çš„ä¸»è¦æ”¹è¿›æ–¹é¢ï¼šåœ¨å‘é€ç«¯åšå¸¦å®½ä¼°è®¡ï¼Œå½“æ¢æµ‹åˆ°ä¸¢åŒ…æ—¶ï¼Œæ ¹æ®å¸¦å®½å€¼æ¥è®¾ç½®æ‹¥å¡çª—å£ã€æ…¢å¯åŠ¨é˜ˆå€¼ã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ªç®—æ³•æ˜¯æ€ä¹ˆæµ‹é‡å¸¦å®½çš„ï¼Ÿæ¯ä¸ª RTT æ—¶é—´ï¼Œä¼šæµ‹é‡ä¸€æ¬¡å¸¦å®½ï¼Œæµ‹é‡å¸¦å®½çš„å…¬å¼å¾ˆç®€å•ï¼Œå°±æ˜¯è¿™æ®µ RTT å†…æˆåŠŸè¢« ack äº†å¤šå°‘å­—èŠ‚ã€‚å› ä¸ºï¼Œè¿™ä¸ªå¸¦å®½å’Œç”¨ RTT è®¡ç®— RTO ä¸€æ ·ï¼Œä¹Ÿæ˜¯éœ€è¦ä»æ¯ä¸ªæ ·æœ¬æ¥å¹³æ»‘åˆ°ä¸€ä¸ªå€¼çš„â€”â€”ä¹Ÿæ˜¯ç”¨ä¸€ä¸ªåŠ æƒç§»å¹³å‡çš„å…¬å¼ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸€ä¸ªç½‘ç»œçš„å¸¦å®½æ˜¯æ¯ç§’å¯ä»¥å‘é€ X ä¸ªå­—èŠ‚ï¼Œè€Œ RTT æ˜¯ä¸€ä¸ªæ•°æ®å‘å‡ºå»åç¡®è®¤éœ€è¦çš„æ—¶å€™ï¼Œæ‰€ä»¥ï¼ŒX _ RTT åº”è¯¥æ˜¯æˆ‘ä»¬ç¼“å†²åŒºå¤§å°ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªç®—æ³•ä¸­ï¼Œssthresh çš„å€¼å°±æ˜¯ est_BD _ min-RTT(æœ€å°çš„ RTT å€¼)ï¼Œå¦‚æœä¸¢åŒ…æ˜¯ Duplicated ACKs å¼•èµ·çš„ï¼Œé‚£ä¹ˆå¦‚æœ cwnd &gt; ssthreshï¼Œåˆ™ cwin = ssthreshã€‚å¦‚æœæ˜¯ RTO å¼•èµ·çš„ï¼Œcwnd = 1ï¼Œè¿›å…¥æ…¢å¯åŠ¨ã€‚ å…³äºè¿™ä¸ªç®—æ³•å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š <a href="http://lxr.free-electrons.com/source/net/ipv4/tcp_westwood.c" target="_blank" rel="noopener">/net/ipv4/tcp_westwood.c</a></p><h2 id="å››æ¬¡æŒ¥æ‰‹ä¼˜åŒ–â€”â€”ä¸‰æ¬¡æŒ¥æ‰‹"><a href="#å››æ¬¡æŒ¥æ‰‹ä¼˜åŒ–â€”â€”ä¸‰æ¬¡æŒ¥æ‰‹" class="headerlink" title="å››æ¬¡æŒ¥æ‰‹ä¼˜åŒ–â€”â€”ä¸‰æ¬¡æŒ¥æ‰‹"></a>å››æ¬¡æŒ¥æ‰‹ä¼˜åŒ–â€”â€”ä¸‰æ¬¡æŒ¥æ‰‹</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#ä¸‰æ¬¡æŒ¥æ‰‹ -- å®¢æˆ·ç«¯å‘èµ·æ–­å¼€è¿æ¥è¯·æ±‚    å®¢æˆ·ç«¯åºåˆ—å·ä¸º 3495051432</span><br><span class="line">#fin  seq = 3495051432</span><br><span class="line">00:05:30.157325 IP 221.122.42.100.58706 &gt; VM_0_6_centos.webcache: Flags [F.], seq 3495051432, ack 485492629, win 115, options [nop,nop,TS val 1695781058 ecr 629900122], length 0</span><br><span class="line">#ä¸‰æ¬¡æŒ¥æ‰‹ -- æœåŠ¡å™¨ç«¯å‘èµ·æ–­å¼€è¿æ¥è¯·æ±‚</span><br><span class="line">#ack = 3495051432 + 1 = 3495051433  æ³¨æ„ å› ä¸ºæœåŠ¡å™¨ç«¯ä¹Ÿæ²¡æœ‰ä¸œè¥¿è¦å‘é€äº†ï¼Œæ‰€ä»¥ä¹Ÿè¦å…³é—­è¿æ¥ï¼Œå› æ­¤åŒæ—¶å‘é€äº†finä¿¡å·ï¼Œseq = 485492629</span><br><span class="line">00:05:30.157562 IP VM_0_6_centos.webcache &gt; 221.122.42.100.58706: Flags [F.], seq 485492629, ack 3495051433, win 235, options [nop,nop,TS val 629900162 ecr 1695781058], length 0</span><br><span class="line">#ä¸‰æ¬¡æŒ¥æ‰‹ -- å®¢æˆ·ç«¯åº”ç­”</span><br><span class="line">#ack = 485492629 + 1 = 485492630</span><br><span class="line">00:05:30.196710 IP 221.122.42.100.58706 &gt; VM_0_6_centos.webcache: Flags [.], ack 485492630, win 115, options [nop,nop,TS val 1695781097 ecr 629900162], length 0</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å› ä¸ºå…³é—­è¿æ¥æœ‰ä¸¤ç§æ–¹å¼ï¼Œå½“ä¸€æ–¹å…³é—­è¿æ¥ï¼Œå¦å¤–ä¸€æ–¹æ²¡æœ‰æ•°æ®å‘é€æ—¶ï¼Œé©¬ä¸Šå…³é—­è¿æ¥ï¼Œä¹Ÿå°±å°†ç¬¬äºŒæ­¥çš„ ack ä¸ç¬¬ä¸‰æ­¥çš„ fin åˆå¹¶ä¸ºä¸€æ­¥äº†</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;TCP&quot;&gt;&lt;a href=&quot;#TCP&quot; class=&quot;headerlink&quot; title=&quot;TCP&quot;&gt;&lt;/a&gt;TCP&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;TCP åœ¨ç½‘ç»œ OSI çš„ä¸ƒå±‚æ¨¡å‹ä¸­çš„ç¬¬å››å±‚â€”â€”Transport å±‚ï¼ˆç¬¬å››å±‚çš„æ•°æ®å« Segmentï¼‰&lt;/li&gt;
&lt;li&gt;IP åœ¨ç¬¬ä¸‰å±‚â€”â€”Network å±‚ï¼ˆåœ¨ç¬¬ä¸‰å±‚ä¸Šçš„æ•°æ®å« Packetï¼‰&lt;/li&gt;
&lt;li&gt;ARP åœ¨ç¬¬äºŒå±‚â€”â€”Data Link å±‚ï¼ˆåœ¨ç¬¬äºŒå±‚ä¸Šçš„æ•°æ®å« Frameï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬ç¨‹åºçš„æ•°æ®é¦–å…ˆä¼šæ‰“åˆ° TCP çš„ Segment ä¸­ï¼Œç„¶å TCP çš„ Segment ä¼šæ‰“åˆ° IP çš„ Packet ä¸­ï¼Œç„¶åå†æ‰“åˆ°ä»¥å¤ªç½‘ Ethernet çš„ Frame ä¸­ï¼Œä¼ åˆ°å¯¹ç«¯åï¼Œå„ä¸ªå±‚è§£æè‡ªå·±çš„åè®®ï¼Œç„¶åæŠŠæ•°æ®äº¤ç»™æ›´é«˜å±‚çš„åè®®å¤„ç†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="http://yoursite.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
      <category term="TCP/IP" scheme="http://yoursite.com/tags/TCP-IP/"/>
    
  </entry>
  
  <entry>
    <title>Promise</title>
    <link href="http://yoursite.com/2019/08/05/promise/"/>
    <id>http://yoursite.com/2019/08/05/promise/</id>
    <published>2019-08-05T11:44:02.000Z</published>
    <updated>2019-11-10T14:37:39.027Z</updated>
    
    <content type="html"><![CDATA[<h1 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h1><h2 id="åˆ›å»º-XHR-çš„-promise-å¯¹è±¡ï¼ˆPromise-åŒ…è£…-XHR-ajax-å¤„ç†ï¼‰"><a href="#åˆ›å»º-XHR-çš„-promise-å¯¹è±¡ï¼ˆPromise-åŒ…è£…-XHR-ajax-å¤„ç†ï¼‰" class="headerlink" title="åˆ›å»º XHR çš„ promise å¯¹è±¡ï¼ˆPromise åŒ…è£… XHR[ajax]å¤„ç†ï¼‰"></a>åˆ›å»º XHR çš„ promise å¯¹è±¡ï¼ˆPromise åŒ…è£… XHR[ajax]å¤„ç†ï¼‰</h2><p>æ–¹æ³•ä¸€ï¼š</p><p>åˆ›å»ºä¸€ä¸ªç”¨ Promise æŠŠ XHR å¤„ç†åŒ…è£…èµ·æ¥çš„åä¸º <code>getURL</code> çš„å‡½æ•°ã€‚</p><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getURL</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    req.open(<span class="string">"GET"</span>, URL, <span class="literal">true</span>);</span><br><span class="line">    req.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123;</span><br><span class="line">        resolve(req.responseText);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    req.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">    &#125;;</span><br><span class="line">    req.send();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">var</span> URL = <span class="string">"http://httpbin.org/get"</span>;</span><br><span class="line">getURL(URL)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> <span class="title">onFulfilled</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> <span class="title">onRejected</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajaxPromise</span>(<span class="params">url, data, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">      url: url,</span><br><span class="line">      type: data == <span class="literal">null</span> ? <span class="string">"GET"</span> : <span class="string">"POST"</span>,</span><br><span class="line">      dataType: <span class="string">"json"</span>,</span><br><span class="line">      data: data == <span class="literal">null</span> ? <span class="string">""</span> : <span class="built_in">JSON</span>.stringify(data),</span><br><span class="line">      <span class="keyword">async</span>: <span class="literal">true</span>,</span><br><span class="line">      contentType: <span class="string">"application/json"</span>,</span><br><span class="line">      success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">        callback(res);</span><br><span class="line">        resolve();</span><br><span class="line">      &#125;,</span><br><span class="line">      error: <span class="function"><span class="keyword">function</span>(<span class="params">XMLHttpRequest, textStatus, errorThrown</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (XMLHttpRequest.status == <span class="string">"401"</span>) &#123;</span><br><span class="line">          <span class="built_in">window</span>.parent.location = <span class="string">"/enterprise/enterprise_login.html"</span>;</span><br><span class="line">          self.location = <span class="string">"/enterprise/enterprise_login.html"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          alert(XMLHttpRequest.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        reject();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ajaxPromise(<span class="string">'/prefix/entity1/action1'</span>,<span class="literal">null</span>, <span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">     <span class="comment">//do something on response</span></span><br><span class="line">&#125;).then(</span><br><span class="line">     ajaxPromise(<span class="string">'/prefix/entity2/action2'</span>, someData, <span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">          <span class="comment">//do something on response</span></span><br><span class="line">     &#125;</span><br><span class="line">).then(</span><br><span class="line">     initVue() ;</span><br><span class="line">).then(</span><br><span class="line">     <span class="comment">//do  something else</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="promise-çš„å®ç°å’ŒåŸç†ï¼ˆç”¨-jsï¼‰"><a href="#promise-çš„å®ç°å’ŒåŸç†ï¼ˆç”¨-jsï¼‰" class="headerlink" title="promise çš„å®ç°å’ŒåŸç†ï¼ˆç”¨ jsï¼‰"></a>promise çš„å®ç°å’ŒåŸç†ï¼ˆç”¨ jsï¼‰</h2><p><a href="https://juejin.im/post/5b83cb5ae51d4538cc3ec354" target="_blank" rel="noopener">promise å®ç°åŸç†</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ¤æ–­å˜é‡å¦ä¸ºfunction</span></span><br><span class="line"><span class="keyword">const</span> isFunction = <span class="function"><span class="params">variable</span> =&gt;</span> <span class="keyword">typeof</span> variable === <span class="string">"function"</span>;</span><br><span class="line"><span class="comment">// å®šä¹‰Promiseçš„ä¸‰ç§çŠ¶æ€å¸¸é‡</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">"PENDING"</span>;</span><br><span class="line"><span class="keyword">const</span> FULFILLED = <span class="string">"FULFILLED"</span>;</span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">"REJECTED"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPromise</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(handle) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isFunction(handle)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"MyPromise must accept a function as a parameter"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ·»åŠ çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">this</span>._status = PENDING;</span><br><span class="line">    <span class="comment">// æ·»åŠ çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">this</span>._value = <span class="literal">undefined</span>;</span><br><span class="line">    <span class="comment">// æ·»åŠ æˆåŠŸå›è°ƒå‡½æ•°é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">this</span>._fulfilledQueues = [];</span><br><span class="line">    <span class="comment">// æ·»åŠ å¤±è´¥å›è°ƒå‡½æ•°é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">this</span>._rejectedQueues = [];</span><br><span class="line">    <span class="comment">// æ‰§è¡Œhandle</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      handle(<span class="keyword">this</span>._resolve.bind(<span class="keyword">this</span>), <span class="keyword">this</span>._reject.bind(<span class="keyword">this</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="keyword">this</span>._reject(err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ resovleæ—¶æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">  _resolve(val) &#123;</span><br><span class="line">    <span class="keyword">const</span> run = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>._status !== PENDING) <span class="keyword">return</span>;</span><br><span class="line">      <span class="comment">// ä¾æ¬¡æ‰§è¡ŒæˆåŠŸé˜Ÿåˆ—ä¸­çš„å‡½æ•°ï¼Œå¹¶æ¸…ç©ºé˜Ÿåˆ—</span></span><br><span class="line">      <span class="keyword">const</span> runFulfilled = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> cb;</span><br><span class="line">        <span class="keyword">while</span> ((cb = <span class="keyword">this</span>._fulfilledQueues.shift())) &#123;</span><br><span class="line">          cb(value);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// ä¾æ¬¡æ‰§è¡Œå¤±è´¥é˜Ÿåˆ—ä¸­çš„å‡½æ•°ï¼Œå¹¶æ¸…ç©ºé˜Ÿåˆ—</span></span><br><span class="line">      <span class="keyword">const</span> runRejected = <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> cb;</span><br><span class="line">        <span class="keyword">while</span> ((cb = <span class="keyword">this</span>._rejectedQueues.shift())) &#123;</span><br><span class="line">          cb(error);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">/* å¦‚æœresolveçš„å‚æ•°ä¸ºPromiseå¯¹è±¡ï¼Œåˆ™å¿…é¡»ç­‰å¾…è¯¥Promiseå¯¹è±¡çŠ¶æ€æ”¹å˜å,</span></span><br><span class="line"><span class="comment">          å½“å‰Promsieçš„çŠ¶æ€æ‰ä¼šæ”¹å˜ï¼Œä¸”çŠ¶æ€å–å†³äºå‚æ•°Promsieå¯¹è±¡çš„çŠ¶æ€ */</span></span><br><span class="line">      <span class="keyword">if</span> (val <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">        val.then(</span><br><span class="line">          value =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>._value = value;</span><br><span class="line">            <span class="keyword">this</span>._status = FULFILLED;</span><br><span class="line">            runFulfilled(value);</span><br><span class="line">          &#125;,</span><br><span class="line">          err =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>._value = err;</span><br><span class="line">            <span class="keyword">this</span>._status = REJECTED;</span><br><span class="line">            runRejected(err);</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>._value = val;</span><br><span class="line">        <span class="keyword">this</span>._status = FULFILLED;</span><br><span class="line">        runFulfilled(val);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// ä¸ºäº†æ”¯æŒåŒæ­¥çš„Promiseï¼Œè¿™é‡Œé‡‡ç”¨å¼‚æ­¥è°ƒç”¨</span></span><br><span class="line">    setTimeout(run, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ rejectæ—¶æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">  _reject(err) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._status !== PENDING) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// ä¾æ¬¡æ‰§è¡Œå¤±è´¥é˜Ÿåˆ—ä¸­çš„å‡½æ•°ï¼Œå¹¶æ¸…ç©ºé˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">const</span> run = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>._status = REJECTED;</span><br><span class="line">      <span class="keyword">this</span>._value = err;</span><br><span class="line">      <span class="keyword">let</span> cb;</span><br><span class="line">      <span class="keyword">while</span> ((cb = <span class="keyword">this</span>._rejectedQueues.shift())) &#123;</span><br><span class="line">        cb(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// ä¸ºäº†æ”¯æŒåŒæ­¥çš„Promiseï¼Œè¿™é‡Œé‡‡ç”¨å¼‚æ­¥è°ƒç”¨</span></span><br><span class="line">    setTimeout(run, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ thenæ–¹æ³•</span></span><br><span class="line">  then(onFulfilled, onRejected) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; _value, _status &#125; = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">onFulfilledNext, onRejectedNext</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// å°è£…ä¸€ä¸ªæˆåŠŸæ—¶æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">      <span class="keyword">let</span> fulfilled = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (!isFunction(onFulfilled)) &#123;</span><br><span class="line">            onFulfilledNext(value);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> res = onFulfilled(value);</span><br><span class="line">            <span class="keyword">if</span> (res <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">              <span class="comment">// å¦‚æœå½“å‰å›è°ƒå‡½æ•°è¿”å›MyPromiseå¯¹è±¡ï¼Œå¿…é¡»ç­‰å¾…å…¶çŠ¶æ€æ”¹å˜ååœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªå›è°ƒ</span></span><br><span class="line">              res.then(onFulfilledNext, onRejectedNext);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">//å¦åˆ™ä¼šå°†è¿”å›ç»“æœç›´æ¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•°ï¼Œå¹¶ç«‹å³æ‰§è¡Œä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•°</span></span><br><span class="line">              onFulfilledNext(res);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">          <span class="comment">// å¦‚æœå‡½æ•°æ‰§è¡Œå‡ºé”™ï¼Œæ–°çš„Promiseå¯¹è±¡çš„çŠ¶æ€ä¸ºå¤±è´¥</span></span><br><span class="line">          onRejectedNext(err);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// å°è£…ä¸€ä¸ªå¤±è´¥æ—¶æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line">      <span class="keyword">let</span> rejected = <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (!isFunction(onRejected)) &#123;</span><br><span class="line">            onRejectedNext(error);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> res = onRejected(error);</span><br><span class="line">            <span class="keyword">if</span> (res <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">              <span class="comment">// å¦‚æœå½“å‰å›è°ƒå‡½æ•°è¿”å›MyPromiseå¯¹è±¡ï¼Œå¿…é¡»ç­‰å¾…å…¶çŠ¶æ€æ”¹å˜ååœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªå›è°ƒ</span></span><br><span class="line">              res.then(onFulfilledNext, onRejectedNext);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">//å¦åˆ™ä¼šå°†è¿”å›ç»“æœç›´æ¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•°ï¼Œå¹¶ç«‹å³æ‰§è¡Œä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•°</span></span><br><span class="line">              onFulfilledNext(res);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">          <span class="comment">// å¦‚æœå‡½æ•°æ‰§è¡Œå‡ºé”™ï¼Œæ–°çš„Promiseå¯¹è±¡çš„çŠ¶æ€ä¸ºå¤±è´¥</span></span><br><span class="line">          onRejectedNext(err);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">switch</span> (_status) &#123;</span><br><span class="line">        <span class="comment">// å½“çŠ¶æ€ä¸ºpendingæ—¶ï¼Œå°†thenæ–¹æ³•å›è°ƒå‡½æ•°åŠ å…¥æ‰§è¡Œé˜Ÿåˆ—ç­‰å¾…æ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">case</span> PENDING:</span><br><span class="line">          <span class="keyword">this</span>._fulfilledQueues.push(fulfilled);</span><br><span class="line">          <span class="keyword">this</span>._rejectedQueues.push(rejected);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// å½“çŠ¶æ€å·²ç»æ”¹å˜æ—¶ï¼Œç«‹å³æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">        <span class="keyword">case</span> FULFILLED:</span><br><span class="line">          fulfilled(_value);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> REJECTED:</span><br><span class="line">          rejected(_value);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ catchæ–¹æ³•</span></span><br><span class="line">  <span class="keyword">catch</span>(onRejected) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.then(<span class="literal">undefined</span>, onRejected);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ é™æ€resolveæ–¹æ³•</span></span><br><span class="line">  <span class="keyword">static</span> resolve(value) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå‚æ•°æ˜¯MyPromiseå®ä¾‹ï¼Œç›´æ¥è¿”å›è¿™ä¸ªå®ä¾‹</span></span><br><span class="line">    <span class="keyword">if</span> (value <span class="keyword">instanceof</span> MyPromise) <span class="keyword">return</span> value;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="params">resolve</span> =&gt;</span> resolve(value));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ é™æ€rejectæ–¹æ³•</span></span><br><span class="line">  <span class="keyword">static</span> reject(value) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> reject(value));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ é™æ€allæ–¹æ³•</span></span><br><span class="line">  <span class="keyword">static</span> all(list) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * è¿”å›å€¼çš„é›†åˆ</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">let</span> values = [];</span><br><span class="line">      <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> [i, p] <span class="keyword">of</span> list.entries()) &#123;</span><br><span class="line">        <span class="comment">// æ•°ç»„å‚æ•°å¦‚æœä¸æ˜¯MyPromiseå®ä¾‹ï¼Œå…ˆè°ƒç”¨MyPromise.resolve</span></span><br><span class="line">        <span class="keyword">this</span>.resolve(p).then(</span><br><span class="line">          res =&gt; &#123;</span><br><span class="line">            values[i] = res;</span><br><span class="line">            count++;</span><br><span class="line">            <span class="comment">// æ‰€æœ‰çŠ¶æ€éƒ½å˜æˆfulfilledæ—¶è¿”å›çš„MyPromiseçŠ¶æ€å°±å˜æˆfulfilled</span></span><br><span class="line">            <span class="keyword">if</span> (count === list.length) resolve(values);</span><br><span class="line">          &#125;,</span><br><span class="line">          err =&gt; &#123;</span><br><span class="line">            <span class="comment">// æœ‰ä¸€ä¸ªè¢«rejectedæ—¶è¿”å›çš„MyPromiseçŠ¶æ€å°±å˜æˆrejected</span></span><br><span class="line">            reject(err);</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ·»åŠ é™æ€raceæ–¹æ³•</span></span><br><span class="line">  <span class="keyword">static</span> race(list) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> p <span class="keyword">of</span> list) &#123;</span><br><span class="line">        <span class="comment">// åªè¦æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œæ–°çš„MyPromiseçš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜</span></span><br><span class="line">        <span class="keyword">this</span>.resolve(p).then(</span><br><span class="line">          res =&gt; &#123;</span><br><span class="line">            resolve(res);</span><br><span class="line">          &#125;,</span><br><span class="line">          err =&gt; &#123;</span><br><span class="line">            reject(err);</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">finally</span>(cb) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.then(</span><br><span class="line">      value =&gt; MyPromise.resolve(cb()).then(<span class="function"><span class="params">()</span> =&gt;</span> value),</span><br><span class="line">      reason =&gt;</span><br><span class="line">        MyPromise.resolve(cb()).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">throw</span> reason;</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="promise-race-å’Œè¶…æ—¶å¤„ç†"><a href="#promise-race-å’Œè¶…æ—¶å¤„ç†" class="headerlink" title="promise.race å’Œè¶…æ—¶å¤„ç†"></a>promise.race å’Œè¶…æ—¶å¤„ç†</h2><p>å‡½æ•° <code>timeoutPromise(æ¯”è¾ƒå¯¹è±¡promise, ms)</code> æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯éœ€è¦ä½¿ç”¨è¶…æ—¶æœºåˆ¶çš„ promise å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¶…æ—¶æ—¶é—´ï¼Œå®ƒè¿”å›ä¸€ä¸ªç”± <code>Promise.race</code> åˆ›å»ºçš„ç›¸äº’ç«äº‰çš„ promise å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delayPromise</span>(<span class="params">ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    setTimeout(resolve, ms);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeoutPromise</span>(<span class="params">promise, ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> timeout = delayPromise(ms).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Operation timed out after "</span> + ms + <span class="string">" ms"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.race([promise, timeout]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delayPromise</span>(<span class="params">ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    setTimeout(resolve, ms);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeoutPromise</span>(<span class="params">promise, ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> timeout = delayPromise(ms).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Operation timed out after "</span> + ms + <span class="string">" ms"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.race([promise, timeout]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">var</span> taskPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// éšä¾¿ä¸€äº›ä»€ä¹ˆå¤„ç†</span></span><br><span class="line">  <span class="keyword">var</span> delay = <span class="built_in">Math</span>.random() * <span class="number">2000</span>;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    resolve(delay + <span class="string">"ms"</span>);</span><br><span class="line">  &#125;, delay);</span><br><span class="line">&#125;);</span><br><span class="line">timeoutPromise(taskPromise, <span class="number">1000</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"taskPromiseåœ¨è§„å®šæ—¶é—´å†…ç»“æŸ : "</span> + value);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"å‘ç”Ÿè¶…æ—¶"</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>è™½ç„¶åœ¨å‘ç”Ÿè¶…æ—¶çš„æ—¶å€™æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä½†æ˜¯è¿™æ ·çš„è¯æˆ‘ä»¬å°±ä¸èƒ½åŒºåˆ†è¿™ä¸ªå¼‚å¸¸åˆ°åº•æ˜¯<em>æ™®é€šçš„é”™è¯¯</em>è¿˜æ˜¯<em>è¶…æ—¶é”™è¯¯</em>äº†ã€‚</p><p>ä¸ºäº†èƒ½åŒºåˆ†è¿™ä¸ª <code>Error</code> å¯¹è±¡çš„ç±»å‹ï¼Œæˆ‘ä»¬å†æ¥å®šä¹‰ä¸€ä¸ª<code>Error</code> å¯¹è±¡çš„å­ç±» <code>TimeoutError</code>ã€‚</p><ul><li><h4 id="å®šåˆ¶-Error-å¯¹è±¡"><a href="#å®šåˆ¶-Error-å¯¹è±¡" class="headerlink" title="å®šåˆ¶ Error å¯¹è±¡"></a>å®šåˆ¶ Error å¯¹è±¡</h4></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TimeoutError.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyOwnFrom</span>(<span class="params">target, source</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">Object</span>.getOwnPropertyNames(source).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">propName</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(</span><br><span class="line">      target,</span><br><span class="line">      propName,</span><br><span class="line">      <span class="built_in">Object</span>.getOwnPropertyDescriptor(source, propName)</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TimeoutError</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> superInstance = <span class="built_in">Error</span>.apply(<span class="literal">null</span>, <span class="built_in">arguments</span>);</span><br><span class="line">  copyOwnFrom(<span class="keyword">this</span>, superInstance);</span><br><span class="line">&#125;</span><br><span class="line">TimeoutError.prototype = <span class="built_in">Object</span>.create(<span class="built_in">Error</span>.prototype);</span><br><span class="line">TimeoutError.prototype.constructor = TimeoutError;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å®šä¹‰äº† <code>TimeoutError</code> ç±»å’Œæ„é€ å‡½æ•°ï¼Œè¿™ä¸ªç±»ç»§æ‰¿äº† Error çš„ prototypeã€‚</p><p>å®ƒçš„ä½¿ç”¨æ–¹æ³•å’Œæ™®é€šçš„ <code>Error</code> å¯¹è±¡ä¸€æ ·ï¼Œä½¿ç”¨ <code>throw</code> è¯­å¥å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> TimeoutError(<span class="string">"timeout"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(error <span class="keyword">instanceof</span> TimeoutError); <span class="comment">// true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><h4 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h4></li></ul><p>å–æ¶ˆ XHR æ“ä½œæœ¬èº«çš„è¯å¹¶ä¸éš¾ï¼Œåªéœ€è¦è°ƒç”¨ <code>XMLHttpRequest</code> å¯¹è±¡çš„ <code>abort()</code> æ–¹æ³•å°±å¯ä»¥äº†ã€‚</p><p>ä¸ºäº†èƒ½åœ¨å¤–éƒ¨è°ƒç”¨ <code>abort()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆå¯¹ä¹‹å‰æœ¬èŠ‚å‡ºç°çš„ <a href="http://liubin.org/promises-book/#xhr-promise.js" target="_blank" rel="noopener"><code>getURL</code></a> è¿›è¡Œç®€å•çš„æ‰©å±•ï¼Œ<code>cancelableXHR</code> æ–¹æ³•é™¤äº†è¿”å›ä¸€ä¸ªåŒ…è£…äº† XHR çš„ promise å¯¹è±¡ä¹‹å¤–ï¼Œè¿˜è¿”å›äº†ä¸€ä¸ªç”¨äºå–æ¶ˆè¯¥ XHR è¯·æ±‚çš„<code>abort</code>æ–¹æ³•ã€‚</p><p>å¤§ä½“çš„æµç¨‹å°±åƒä¸‹é¢è¿™æ ·ã€‚</p><ol><li>é€šè¿‡ <code>cancelableXHR</code> æ–¹æ³•å–å¾—åŒ…è£…äº† XHR çš„ promise å¯¹è±¡å’Œå–æ¶ˆè¯¥ XHR è¯·æ±‚çš„æ–¹æ³•</li><li>åœ¨ <code>timeoutPromise</code> æ–¹æ³•ä¸­é€šè¿‡ <code>Promise.race</code> è®© XHR çš„åŒ…è£… promise å’Œè¶…æ—¶ç”¨ promise è¿›è¡Œç«äº‰ã€‚<ul><li>XHR åœ¨è¶…æ—¶å‰è¿”å›ç»“æœçš„è¯<ol><li>å’Œæ­£å¸¸çš„ promise ä¸€æ ·ï¼Œé€šè¿‡ <code>then</code> è¿”å›è¯·æ±‚ç»“æœ</li></ol></li><li>å‘ç”Ÿè¶…æ—¶çš„æ—¶å€™<ol><li>æŠ›å‡º <code>throw TimeoutError</code> å¼‚å¸¸å¹¶è¢« <code>catch</code></li><li>catch çš„é”™è¯¯å¯¹è±¡å¦‚æœæ˜¯ <code>TimeoutError</code> ç±»å‹çš„è¯ï¼Œåˆ™è°ƒç”¨ <code>abort</code> æ–¹æ³•å–æ¶ˆ XHR è¯·æ±‚</li></ol></li></ul></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyOwnFrom</span>(<span class="params">target, source</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">Object</span>.getOwnPropertyNames(source).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">propName</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(</span><br><span class="line">      target,</span><br><span class="line">      propName,</span><br><span class="line">      <span class="built_in">Object</span>.getOwnPropertyDescriptor(source, propName)</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TimeoutError</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> superInstance = <span class="built_in">Error</span>.apply(<span class="literal">null</span>, <span class="built_in">arguments</span>);</span><br><span class="line">  copyOwnFrom(<span class="keyword">this</span>, superInstance);</span><br><span class="line">&#125;</span><br><span class="line">TimeoutError.prototype = <span class="built_in">Object</span>.create(<span class="built_in">Error</span>.prototype);</span><br><span class="line">TimeoutError.prototype.constructor = TimeoutError;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delayPromise</span>(<span class="params">ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    setTimeout(resolve, ms);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeoutPromise</span>(<span class="params">promise, ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> timeout = delayPromise(ms).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(</span><br><span class="line">      <span class="keyword">new</span> TimeoutError(<span class="string">"Operation timed out after "</span> + ms + <span class="string">" ms"</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.race([promise, timeout]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cancelableXHR</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">  <span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    req.open(<span class="string">"GET"</span>, URL, <span class="literal">true</span>);</span><br><span class="line">    req.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123;</span><br><span class="line">        resolve(req.responseText);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    req.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">    &#125;;</span><br><span class="line">    req.onabort = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"abort this request"</span>));</span><br><span class="line">    &#125;;</span><br><span class="line">    req.send();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">var</span> abort = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœrequestè¿˜æ²¡æœ‰ç»“æŸçš„è¯å°±æ‰§è¡Œabort</span></span><br><span class="line">    <span class="comment">// https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest</span></span><br><span class="line">    <span class="keyword">if</span> (req.readyState !== XMLHttpRequest.UNSENT) &#123;</span><br><span class="line">      req.abort();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    promise: promise,</span><br><span class="line">    abort: abort</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> object = cancelableXHR(<span class="string">"http://httpbin.org/get"</span>);</span><br><span class="line"><span class="comment">// main</span></span><br><span class="line">timeoutPromise(object.promise, <span class="number">1000</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Contents"</span>, contents);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (error <span class="keyword">instanceof</span> TimeoutError) &#123;</span><br><span class="line">      object.abort();</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"XHR Error :"</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h2 id="promise-all-å’Œé¡ºåºå¤„ç†"><a href="#promise-all-å’Œé¡ºåºå¤„ç†" class="headerlink" title="promise.all å’Œé¡ºåºå¤„ç†"></a>promise.all å’Œé¡ºåºå¤„ç†</h2><ul><li>åœ¨ <a href="http://liubin.org/promises-book/#multiple-xhr.js" target="_blank" rel="noopener">é‡å¤ä½¿ç”¨å¤šä¸ª then çš„æ–¹æ³•</a> ä¸­çš„å®ç°æ–¹æ³•å¦‚ä¸‹ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getURL</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    req.open(<span class="string">"GET"</span>, URL, <span class="literal">true</span>);</span><br><span class="line">    req.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123;</span><br><span class="line">        resolve(req.responseText);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    req.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">    &#125;;</span><br><span class="line">    req.send();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> request = &#123;</span><br><span class="line">  comment: <span class="function"><span class="keyword">function</span> <span class="title">getComment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/comment.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  people: <span class="function"><span class="keyword">function</span> <span class="title">getPeople</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/people.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">recordValue</span>(<span class="params">results, value</span>) </span>&#123;</span><br><span class="line">    results.push(value);</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// [] ç”¨æ¥ä¿å­˜åˆå§‹åŒ–çš„å€¼</span></span><br><span class="line">  <span class="keyword">var</span> pushValue = recordValue.bind(<span class="literal">null</span>, []);</span><br><span class="line">  <span class="keyword">return</span> request</span><br><span class="line">    .comment()</span><br><span class="line">    .then(pushValue)</span><br><span class="line">    .then(request.people)</span><br><span class="line">    .then(pushValue);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç¤ºä¾‹</span></span><br><span class="line">main()</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ç§å†™æ³•çš„è¯é‚£ä¹ˆéšç€ <code>request</code> ä¸­å…ƒç´ æ•°é‡çš„å¢åŠ ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸æ–­å¢åŠ å¯¹ <code>then</code> æ–¹æ³•çš„è°ƒç”¨</p><ul><li>å°†å¤„ç†å†…å®¹ç»Ÿä¸€æ”¾åˆ°æ•°ç»„é‡Œï¼Œå†é…åˆ for å¾ªç¯è¿›è¡Œå¤„ç†</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getURL</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    req.open(<span class="string">"GET"</span>, URL, <span class="literal">true</span>);</span><br><span class="line">    req.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123;</span><br><span class="line">        resolve(req.responseText);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    req.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">    &#125;;</span><br><span class="line">    req.send();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> request = &#123;</span><br><span class="line">  comment: <span class="function"><span class="keyword">function</span> <span class="title">getComment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/comment.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  people: <span class="function"><span class="keyword">function</span> <span class="title">getPeople</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/people.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">recordValue</span>(<span class="params">results, value</span>) </span>&#123;</span><br><span class="line">    results.push(value);</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// [] ç”¨æ¥ä¿å­˜åˆå§‹åŒ–å€¼</span></span><br><span class="line">  <span class="keyword">var</span> pushValue = recordValue.bind(<span class="literal">null</span>, []);</span><br><span class="line">  <span class="comment">// è¿”å›promiseå¯¹è±¡çš„å‡½æ•°çš„æ•°ç»„</span></span><br><span class="line">  <span class="keyword">var</span> tasks = [request.comment, request.people];</span><br><span class="line">  <span class="keyword">var</span> promise = <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  <span class="comment">// å¼€å§‹çš„åœ°æ–¹</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; tasks.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> task = tasks[i];</span><br><span class="line">    promise = promise.then(task).then(pushValue);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç¤ºä¾‹</span></span><br><span class="line">main()</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p><code>promise = promise.then(task).then(pushValue);</code> çš„ä»£ç å°±æ˜¯é€šè¿‡ä¸æ–­å¯¹ promise è¿›è¡Œå¤„ç†ï¼Œä¸æ–­çš„è¦†ç›– <code>promise</code> å˜é‡çš„å€¼ï¼Œä»¥è¾¾åˆ°å¯¹ promise å¯¹è±¡çš„ç´¯ç§¯å¤„ç†æ•ˆæœã€‚</p><p>ä½†æ˜¯è¿™ç§æ–¹æ³•éœ€è¦ <code>promise</code> è¿™ä¸ªä¸´æ—¶å˜é‡ï¼Œä»ä»£ç è´¨é‡ä¸Šæ¥è¯´æ˜¾å¾—ä¸é‚£ä¹ˆç®€æ´ã€‚</p><ul><li>Promise chain å’Œ reduce</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getURL</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    req.open(<span class="string">"GET"</span>, URL, <span class="literal">true</span>);</span><br><span class="line">    req.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123;</span><br><span class="line">        resolve(req.responseText);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    req.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">    &#125;;</span><br><span class="line">    req.send();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> request = &#123;</span><br><span class="line">  comment: <span class="function"><span class="keyword">function</span> <span class="title">getComment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/comment.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  people: <span class="function"><span class="keyword">function</span> <span class="title">getPeople</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/people.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">recordValue</span>(<span class="params">results, value</span>) </span>&#123;</span><br><span class="line">    results.push(value);</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> pushValue = recordValue.bind(<span class="literal">null</span>, []);</span><br><span class="line">  <span class="keyword">var</span> tasks = [request.comment, request.people];</span><br><span class="line">  <span class="keyword">return</span> tasks.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">promise, task</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> promise.then(task).then(pushValue);</span><br><span class="line">  &#125;, <span class="built_in">Promise</span>.resolve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç¤ºä¾‹</span></span><br><span class="line">main()</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p><code>Array.prototype.reduce</code> çš„ç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥è®¾ç½®ç››æ”¾è®¡ç®—ç»“æœçš„åˆå§‹å€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ <code>Promise.resolve()</code> ä¼šèµ‹å€¼ç»™ <code>promise</code>ï¼Œæ­¤æ—¶çš„ <code>task</code> ä¸º <code>request.comment</code> ã€‚</p><p>åœ¨ reduce ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸­è¢« <code>return</code> çš„å€¼ï¼Œåˆ™ä¼šè¢«èµ‹å€¼ä¸ºä¸‹æ¬¡å¾ªç¯æ—¶çš„ <code>promise</code> ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡è¿”å›ç”± <code>then</code> åˆ›å»ºçš„æ–°çš„ promise å¯¹è±¡ï¼Œå°±å®ç°äº†å’Œ for å¾ªç¯ç±»ä¼¼çš„ <a href="http://liubin.org/promises-book/#promise-chain" target="_blank" rel="noopener">Promise chain</a> äº†ã€‚</p><p>ä½¿ç”¨ reduce å’Œ for å¾ªç¯ä¸åŒçš„åœ°æ–¹æ˜¯ reduce ä¸å†éœ€è¦ä¸´æ—¶å˜é‡ <code>promise</code> äº†ï¼Œå› æ­¤ä¹Ÿä¸ç”¨ç¼–å†™ <code>promise = promise.then(task).then(pushValue);</code> è¿™æ ·å†—é•¿çš„ä»£ç äº†ï¼Œè¿™æ˜¯éå¸¸å¤§çš„è¿›æ­¥ã€‚</p><ul><li>å®šä¹‰è¿›è¡Œé¡ºåºå¤„ç†çš„å‡½æ•°</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sequenceTasks</span>(<span class="params">tasks</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">recordValue</span>(<span class="params">results, value</span>) </span>&#123;</span><br><span class="line">    results.push(value);</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> pushValue = recordValue.bind(<span class="literal">null</span>, []);</span><br><span class="line">  <span class="keyword">return</span> tasks.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">promise, task</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> promise.then(task).then(pushValue);</span><br><span class="line">  &#125;, <span class="built_in">Promise</span>.resolve());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå’Œ <code>Promise.all</code> ç­‰ä¸åŒï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ•°ç»„ã€‚ä¸ºä»€ä¹ˆä¼ ç»™è¿™ä¸ªå‡½æ•°çš„ä¸æ˜¯ä¸€ä¸ª promise å¯¹è±¡çš„æ•°ç»„å‘¢ï¼Ÿè¿™æ˜¯å› ä¸º promise å¯¹è±¡åˆ›å»ºçš„æ—¶å€™ï¼ŒXHR å·²ç»å¼€å§‹æ‰§è¡Œäº†ï¼Œå› æ­¤å†å¯¹è¿™äº› promise å¯¹è±¡è¿›è¡Œé¡ºåºå¤„ç†çš„è¯å°±ä¸èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚</p><p>é‡å†™ä¸Šä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sequenceTasks</span>(<span class="params">tasks</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">recordValue</span>(<span class="params">results, value</span>) </span>&#123;</span><br><span class="line">    results.push(value);</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> pushValue = recordValue.bind(<span class="literal">null</span>, []);</span><br><span class="line">  <span class="keyword">return</span> tasks.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">promise, task</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> promise.then(task).then(pushValue);</span><br><span class="line">  &#125;, <span class="built_in">Promise</span>.resolve());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getURL</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    req.open(<span class="string">"GET"</span>, URL, <span class="literal">true</span>);</span><br><span class="line">    req.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123;</span><br><span class="line">        resolve(req.responseText);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    req.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(req.statusText));</span><br><span class="line">    &#125;;</span><br><span class="line">    req.send();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> request = &#123;</span><br><span class="line">  comment: <span class="function"><span class="keyword">function</span> <span class="title">getComment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/comment.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  people: <span class="function"><span class="keyword">function</span> <span class="title">getPeople</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getURL(<span class="string">"http://azu.github.io/promises-book/json/people.json"</span>).then(</span><br><span class="line">      <span class="built_in">JSON</span>.parse</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sequenceTasks([request.comment, request.people]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿è¡Œç¤ºä¾‹</span></span><br><span class="line">main()</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•å®ç°-Promise-all"><a href="#å¦‚ä½•å®ç°-Promise-all" class="headerlink" title="å¦‚ä½•å®ç° Promise.all ?"></a>å¦‚ä½•å®ç° Promise.all ?</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all = <span class="function"><span class="keyword">function</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> result = [];</span><br><span class="line">    <span class="keyword">if</span> (promises.length === <span class="number">0</span>) &#123;</span><br><span class="line">      resolve(result);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">processValue</span>(<span class="params">i, data</span>) </span>&#123;</span><br><span class="line">        result[i] = data;</span><br><span class="line">        <span class="keyword">if</span> (++index === promises.length) &#123;</span><br><span class="line">          resolve(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; promises.length; i++) &#123;</span><br><span class="line">        <span class="comment">//promises[i] å¯èƒ½æ˜¯æ™®é€šå€¼</span></span><br><span class="line">        <span class="built_in">Promise</span>.resolve(promises[i]).then(</span><br><span class="line">          data =&gt; &#123;</span><br><span class="line">            processValue(i, data);</span><br><span class="line">          &#125;,</span><br><span class="line">          err =&gt; &#123;</span><br><span class="line">            reject(err);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•å®ç°-Promise-finally"><a href="#å¦‚ä½•å®ç°-Promise-finally" class="headerlink" title="å¦‚ä½•å®ç° Promise.finally ?"></a>å¦‚ä½•å®ç° Promise.finally ?</h2><p>ä¸ç®¡æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šèµ°åˆ° finally ä¸­,å¹¶ä¸” finally ä¹‹åï¼Œè¿˜å¯ä»¥ç»§ç»­ thenã€‚å¹¶ä¸”ä¼šå°†å€¼åŸå°ä¸åŠ¨çš„ä¼ é€’ç»™åé¢çš„ then.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.prototype.finally = <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.then(</span><br><span class="line">    value =&gt; &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(callback()).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(callback()).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><ol><li><p>è¾“å‡ºç»“æœï¼šsuccess</p><p>è§£é¢˜æ€è·¯ï¼šPromise çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œæ— æ³•åœ¨å‘ç”Ÿå˜æ›´ã€‚</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">"success"</span>);</span><br><span class="line">    reject(<span class="string">"error"</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise.then(</span><br><span class="line">  res =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;,</span><br><span class="line">  err =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ol start="2"><li><p>è¾“å‡ºç»“æœï¼š1</p><p>è§£é¢˜æ€è·¯ï¼šPromise çš„ then æ–¹æ³•çš„å‚æ•°æœŸæœ›æ˜¯å‡½æ•°ï¼Œä¼ å…¥éå‡½æ•°åˆ™ä¼šå‘ç”Ÿå€¼ç©¿é€ã€‚</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="number">1</span>)</span><br><span class="line">  .then(<span class="number">2</span>)</span><br><span class="line">  .then(<span class="built_in">Promise</span>.resolve(<span class="number">3</span>))</span><br><span class="line">  .then(<span class="built_in">console</span>.log);</span><br></pre></td></tr></table></figure><ol start="3"><li><p>ç»“æœæ˜¯ï¼š3 4 6 8 7 5 2 1</p><p>ä¼˜å…ˆçº§å…³ç³»å¦‚ä¸‹ï¼š<code>process.nextTick &gt; promise.then &gt; setTimeout &gt; setImmediate</code></p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">setImmediate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">  resolve();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">6</span>);</span><br><span class="line">process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">7</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">8</span>);</span><br></pre></td></tr></table></figure><p>V8 å®ç°ä¸­ï¼Œä¸¤ä¸ªé˜Ÿåˆ—å„åŒ…å«ä¸åŒçš„ä»»åŠ¡ï¼š</p><p><code>macrotasks: script(æ•´ä½“ä»£ç ),setTimeout, setInterval, setImmediate, I/O, UI rendering</code><br><code>microtasks: process.nextTick, Promises, Object.observe, MutationObserver</code></p><ol start="4"><li><p>å®ç°ä¸€ä¸ªç®€å•çš„ Promise</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Promise</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> status = <span class="string">"pending"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">successNotify</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status = <span class="string">"fulfilled"</span>; <span class="comment">//çŠ¶æ€å˜ä¸ºfulfilled</span></span><br><span class="line">    toDoThen.apply(<span class="literal">undefined</span>, <span class="built_in">arguments</span>); <span class="comment">//æ‰§è¡Œå›è°ƒ</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">failNotify</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status = <span class="string">"rejected"</span>; <span class="comment">//çŠ¶æ€å˜ä¸ºrejected</span></span><br><span class="line">    toDoThen.apply(<span class="literal">undefined</span>, <span class="built_in">arguments</span>); <span class="comment">//æ‰§è¡Œå›è°ƒ</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">toDoThen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// ä¿è¯å›è°ƒæ˜¯å¼‚æ­¥æ‰§è¡Œçš„</span></span><br><span class="line">      <span class="keyword">if</span> (status === <span class="string">"fulfilled"</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; successArray.length; i++) &#123;</span><br><span class="line">          successArray[i].apply(<span class="literal">undefined</span>, <span class="built_in">arguments</span>); <span class="comment">//æ‰§è¡Œthené‡Œé¢çš„å›æ‰å‡½æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (status === <span class="string">"rejected"</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; failArray.length; i++) &#123;</span><br><span class="line">          failArray[i].apply(<span class="literal">undefined</span>, <span class="built_in">arguments</span>); <span class="comment">//æ‰§è¡Œthené‡Œé¢çš„å›æ‰å‡½æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> successArray = [];</span><br><span class="line">  <span class="keyword">var</span> failArray = [];</span><br><span class="line">  fn.call(<span class="literal">undefined</span>, successNotify, failNotify);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    then: <span class="function"><span class="keyword">function</span>(<span class="params">successFn, failFn</span>) </span>&#123;</span><br><span class="line">      successArray.push(successFn);</span><br><span class="line">      failArray.push(failFn);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>; <span class="comment">// æ­¤å¤„åº”è¯¥è¿”å›ä¸€ä¸ªPromise</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>è§£é¢˜æ€è·¯ï¼šPromise ä¸­çš„ resolve å’Œ reject ç”¨äºæ”¹å˜ Promise çš„çŠ¶æ€å’Œä¼ å‚ï¼Œthen ä¸­çš„å‚æ•°å¿…é¡»æ˜¯ä½œä¸ºå›è°ƒæ‰§è¡Œçš„å‡½æ•°ã€‚å› æ­¤ï¼Œå½“ Promise æ”¹å˜çŠ¶æ€ä¹‹åä¼šè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œæ ¹æ®çŠ¶æ€çš„ä¸åŒé€‰æ‹©éœ€è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;promise&quot;&gt;&lt;a href=&quot;#promise&quot; class=&quot;headerlink&quot; title=&quot;promise&quot;&gt;&lt;/a&gt;promise&lt;/h1&gt;&lt;h2 id=&quot;åˆ›å»º-XHR-çš„-promise-å¯¹è±¡ï¼ˆPromise-åŒ…è£…-XHR-ajax-å¤„ç†ï¼‰&quot;&gt;&lt;a href=&quot;#åˆ›å»º-XHR-çš„-promise-å¯¹è±¡ï¼ˆPromise-åŒ…è£…-XHR-ajax-å¤„ç†ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;åˆ›å»º XHR çš„ promise å¯¹è±¡ï¼ˆPromise åŒ…è£… XHR[ajax]å¤„ç†ï¼‰&quot;&gt;&lt;/a&gt;åˆ›å»º XHR çš„ promise å¯¹è±¡ï¼ˆPromise åŒ…è£… XHR[ajax]å¤„ç†ï¼‰&lt;/h2&gt;&lt;p&gt;æ–¹æ³•ä¸€ï¼š&lt;/p&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªç”¨ Promise æŠŠ XHR å¤„ç†åŒ…è£…èµ·æ¥çš„åä¸º &lt;code&gt;getURL&lt;/code&gt; çš„å‡½æ•°ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ES6" scheme="http://yoursite.com/categories/ES6/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
      <category term="ES6" scheme="http://yoursite.com/tags/ES6/"/>
    
  </entry>
  
  <entry>
    <title>JSå¼•æ“æ‰§è¡Œæœºåˆ¶</title>
    <link href="http://yoursite.com/2019/07/30/JS%E5%BC%95%E6%93%8E%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/"/>
    <id>http://yoursite.com/2019/07/30/JSå¼•æ“æ‰§è¡Œæœºåˆ¶/</id>
    <published>2019-07-30T05:13:29.000Z</published>
    <updated>2019-11-10T14:37:39.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JS-å¼•æ“æ‰§è¡Œæœºåˆ¶"><a href="#JS-å¼•æ“æ‰§è¡Œæœºåˆ¶" class="headerlink" title="JS å¼•æ“æ‰§è¡Œæœºåˆ¶"></a>JS å¼•æ“æ‰§è¡Œæœºåˆ¶</h1><p><strong>(1) JS æ˜¯å•çº¿ç¨‹è¯­è¨€</strong></p><p><strong>(2) JS çš„ Event Loop æ˜¯ JS çš„æ‰§è¡Œæœºåˆ¶ã€‚æ·±å…¥äº†è§£ JS çš„æ‰§è¡Œ,å°±ç­‰äºæ·±å…¥äº†è§£ JS é‡Œçš„ event loop</strong></p><a id="more"></a><h2 id="JS-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„-ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥-å•çº¿ç¨‹åˆæ˜¯å¦‚ä½•å®ç°å¼‚æ­¥çš„å‘¢"><a href="#JS-ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„-ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥-å•çº¿ç¨‹åˆæ˜¯å¦‚ä½•å®ç°å¼‚æ­¥çš„å‘¢" class="headerlink" title="JS ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„? ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥? å•çº¿ç¨‹åˆæ˜¯å¦‚ä½•å®ç°å¼‚æ­¥çš„å‘¢?"></a>JS ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„? ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥? å•çº¿ç¨‹åˆæ˜¯å¦‚ä½•å®ç°å¼‚æ­¥çš„å‘¢?</h2><ul><li><p>JS æœ€åˆè¢«è®¾è®¡ç”¨åœ¨æµè§ˆå™¨ä¸­,é‚£ä¹ˆæƒ³è±¡ä¸€ä¸‹,å¦‚æœæµè§ˆå™¨ä¸­çš„ JS æ˜¯å¤šçº¿ç¨‹çš„ã€‚</p><p>åœºæ™¯æè¿°:</p><p>é‚£ä¹ˆç°åœ¨æœ‰ 2 ä¸ªçº¿ç¨‹,process1 process2,ç”±äºæ˜¯å¤šçº¿ç¨‹çš„ JS,æ‰€ä»¥ä»–ä»¬å¯¹åŒä¸€ä¸ª dom,åŒæ—¶è¿›è¡Œæ“ä½œã€‚process1 åˆ é™¤äº†è¯¥ dom,è€Œ process2 ç¼–è¾‘äº†è¯¥ dom,åŒæ—¶ä¸‹è¾¾ 2 ä¸ªçŸ›ç›¾çš„å‘½ä»¤,æµè§ˆå™¨ç©¶ç«Ÿè¯¥å¦‚ä½•æ‰§è¡Œå‘¢?</p></li><li><p>JS ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥?</p><p>å¦‚æœ JS ä¸­ä¸å­˜åœ¨å¼‚æ­¥,åªèƒ½è‡ªä¸Šè€Œä¸‹æ‰§è¡Œ,å¦‚æœä¸Šä¸€è¡Œè§£ææ—¶é—´å¾ˆé•¿,é‚£ä¹ˆä¸‹é¢çš„ä»£ç å°±ä¼šè¢«é˜»å¡ã€‚<br>å¯¹äºç”¨æˆ·è€Œè¨€,é˜»å¡å°±æ„å‘³ç€â€å¡æ­»â€,è¿™æ ·å°±å¯¼è‡´äº†å¾ˆå·®çš„ç”¨æˆ·ä½“éªŒ</p></li><li><p>JS å•çº¿ç¨‹åˆæ˜¯å¦‚ä½•å®ç°å¼‚æ­¥çš„å‘¢?</p><p><strong>æ˜¯é€šè¿‡çš„äº‹ä»¶å¾ªç¯(event loop),ç†è§£äº† event loop æœºåˆ¶,å°±ç†è§£äº† JS çš„æ‰§è¡Œæœºåˆ¶</strong></p></li></ul><h2 id="JS-ä¸­çš„-event-loop"><a href="#JS-ä¸­çš„-event-loop" class="headerlink" title="JS ä¸­çš„ event loop"></a>JS ä¸­çš„ event loop</h2><h3 id="event-loopï¼ˆ1ï¼‰"><a href="#event-loopï¼ˆ1ï¼‰" class="headerlink" title="event loopï¼ˆ1ï¼‰"></a>event loopï¼ˆ1ï¼‰</h3><p>JS é‡Œçš„ä¸€ç§åˆ†ç±»æ–¹å¼,å°±æ˜¯å°†ä»»åŠ¡åˆ†ä¸º: åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡</p><p>JS çš„æ‰§è¡Œæœºåˆ¶æ˜¯ï¼š</p><ul><li>é¦–å…ˆåˆ¤æ–­ JS æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥,åŒæ­¥å°±è¿›å…¥ä¸»çº¿ç¨‹,å¼‚æ­¥å°±è¿›å…¥ event table</li><li>å¼‚æ­¥ä»»åŠ¡åœ¨ event table ä¸­æ³¨å†Œå‡½æ•°,å½“æ»¡è¶³è§¦å‘æ¡ä»¶å,è¢«æ¨å…¥ event queue</li><li>åŒæ­¥ä»»åŠ¡è¿›å…¥ä¸»çº¿ç¨‹åä¸€ç›´æ‰§è¡Œ,ç›´åˆ°ä¸»çº¿ç¨‹ç©ºé—²æ—¶,æ‰ä¼šå» event queue ä¸­æŸ¥çœ‹æ˜¯å¦æœ‰å¯æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡,å¦‚æœæœ‰å°±æ¨å…¥ä¸»çº¿ç¨‹ä¸­</li></ul><h3 id="event-loopï¼ˆ2ï¼‰"><a href="#event-loopï¼ˆ2ï¼‰" class="headerlink" title="event loopï¼ˆ2ï¼‰"></a>event loopï¼ˆ2ï¼‰</h3><p>å‡†ç¡®çš„åˆ’åˆ†æ–¹å¼æ˜¯:</p><ul><li>macro-task(å®ä»»åŠ¡)ï¼šåŒ…æ‹¬æ•´ä½“ä»£ç  scriptï¼ŒsetTimeoutï¼ŒsetInterval</li><li>micro-task(å¾®ä»»åŠ¡)ï¼šPromise.thenï¼Œprocess.nextTick</li></ul><p>JS çš„æ‰§è¡Œæœºåˆ¶æ˜¯ï¼š</p><ul><li>æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡,è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡,å°±å°†å…¶æ”¾åˆ°å¾®ä»»åŠ¡çš„ã€äº‹ä»¶é˜Ÿåˆ—ã€‘é‡Œ</li><li>å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæˆå,ä¼šæŸ¥çœ‹å¾®ä»»åŠ¡çš„ã€äº‹ä»¶é˜Ÿåˆ—ã€‘,å¹¶å°†é‡Œé¢å…¨éƒ¨çš„å¾®ä»»åŠ¡ä¾æ¬¡æ‰§è¡Œå®Œ</li></ul><p><strong>é‡å¤ä»¥ä¸Š 2 æ­¥éª¤,ç»“åˆ event loop(1) event loop(2) ,å°±æ˜¯æ›´ä¸ºå‡†ç¡®çš„ JS æ‰§è¡Œæœºåˆ¶äº†ã€‚</strong></p><h2 id="ç†è§£-JavaScript-çš„-async-await"><a href="#ç†è§£-JavaScript-çš„-async-await" class="headerlink" title="ç†è§£ JavaScript çš„ async/await"></a>ç†è§£ JavaScript çš„ async/await</h2><h3 id="async-å’Œ-await-åœ¨å¹²ä»€ä¹ˆ"><a href="#async-å’Œ-await-åœ¨å¹²ä»€ä¹ˆ" class="headerlink" title="async å’Œ await åœ¨å¹²ä»€ä¹ˆ"></a>async å’Œ await åœ¨å¹²ä»€ä¹ˆ</h3><p>å…ˆä»å­—é¢æ„æ€æ¥ç†è§£ã€‚async æ˜¯â€œå¼‚æ­¥â€çš„ç®€å†™ï¼Œè€Œ await å¯ä»¥è®¤ä¸ºæ˜¯ async wait çš„ç®€å†™ã€‚æ‰€ä»¥åº”è¯¥å¾ˆå¥½ç†è§£ async ç”¨äºç”³æ˜ä¸€ä¸ª function æ˜¯å¼‚æ­¥çš„ï¼Œè€Œ await ç”¨äºç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæˆã€‚</p><ul><li>async å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª <strong>Promise</strong> å¯¹è±¡ã€‚<ul><li>å¦‚æœåœ¨å‡½æ•°ä¸­ <code>return</code> ä¸€ä¸ªç›´æ¥é‡ï¼Œasync ä¼šæŠŠè¿™ä¸ªç›´æ¥é‡é€šè¿‡ <code>Promise.resolve()</code> å°è£…æˆ Promise å¯¹è±¡ã€‚</li><li>å¦‚æœ async å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œåˆè¯¥å¦‚ä½•ï¼Ÿå¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œå®ƒä¼šè¿”å› <code>Promise.resolve(undefined)</code>ã€‚</li><li>Promise çš„ç‰¹ç‚¹â€”â€”æ— ç­‰å¾…ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰ <code>await</code> çš„æƒ…å†µä¸‹æ‰§è¡Œ async å‡½æ•°ï¼Œå®ƒä¼šç«‹å³æ‰§è¡Œï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¹¶ä¸”ï¼Œç»ä¸ä¼šé˜»å¡åé¢çš„è¯­å¥ã€‚è¿™å’Œæ™®é€šè¿”å› Promise å¯¹è±¡çš„å‡½æ•°å¹¶æ— äºŒè‡´ã€‚</li></ul></li><li>await ç­‰å¾…çš„æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚<ul><li>è¿™ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœæ˜¯ Promise å¯¹è±¡æˆ–è€…å…¶å®ƒå€¼ï¼ˆæ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ²¡æœ‰ç‰¹æ®Šé™å®šï¼‰ã€‚</li><li>await ä¸ä»…ä»…ç”¨äºç­‰ Promise å¯¹è±¡ï¼Œå®ƒå¯ä»¥ç­‰ä»»æ„è¡¨è¾¾å¼çš„ç»“æœï¼Œæ‰€ä»¥ï¼Œawait åé¢å®é™…æ˜¯å¯ä»¥æ¥æ™®é€šå‡½æ•°è°ƒç”¨æˆ–è€…ç›´æ¥é‡çš„ã€‚</li></ul></li><li>await ç­‰åˆ°äº†è¦ç­‰çš„ï¼Œç„¶åå‘¢ï¼Ÿ<ul><li><code>await</code> æ˜¯ä¸ªè¿ç®—ç¬¦ï¼Œç”¨äºç»„æˆè¡¨è¾¾å¼ï¼Œawait è¡¨è¾¾å¼çš„è¿ç®—ç»“æœå–å†³äºå®ƒç­‰çš„ä¸œè¥¿ã€‚</li><li>å¦‚æœå®ƒç­‰åˆ°çš„ä¸æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œé‚£ await è¡¨è¾¾å¼çš„è¿ç®—ç»“æœå°±æ˜¯å®ƒç­‰åˆ°çš„ä¸œè¥¿ã€‚</li><li>å¦‚æœå®ƒç­‰åˆ°çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œawait å°±å¿™èµ·æ¥äº†ï¼Œå®ƒä¼šé˜»å¡åé¢çš„ä»£ç ï¼Œç­‰ç€ Promise å¯¹è±¡ resolveï¼Œç„¶åå¾—åˆ° resolve çš„å€¼ï¼Œä½œä¸º await è¡¨è¾¾å¼çš„è¿ç®—ç»“æœã€‚</li></ul></li></ul><p>è¿™å°±æ˜¯ await å¿…é¡»ç”¨åœ¨ async å‡½æ•°ä¸­çš„åŸå› ã€‚async å‡½æ•°è°ƒç”¨ä¸ä¼šé€ æˆé˜»å¡ï¼Œå®ƒå†…éƒ¨æ‰€æœ‰çš„é˜»å¡éƒ½è¢«å°è£…åœ¨ä¸€ä¸ª Promise å¯¹è±¡ä¸­å¼‚æ­¥æ‰§è¡Œã€‚</p><h3 id="await-ç­‰å¾…çš„è¡¨è¾¾å¼è¯¦è§£"><a href="#await-ç­‰å¾…çš„è¡¨è¾¾å¼è¯¦è§£" class="headerlink" title="await ç­‰å¾…çš„è¡¨è¾¾å¼è¯¦è§£"></a>await ç­‰å¾…çš„è¡¨è¾¾å¼è¯¦è§£</h3><p><strong>await ç­‰çš„æ˜¯å³ä¾§ã€Œè¡¨è¾¾å¼ã€çš„ç»“æœ</strong></p><p>await æ˜¯ä»<strong>å³å‘å·¦æ‰§è¡Œçš„</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"async1 start"</span>);</span><br><span class="line">  <span class="keyword">await</span> async2();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"async1 end"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"async2"</span>);</span><br><span class="line">&#125;</span><br><span class="line">async1();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"script start"</span>);</span><br></pre></td></tr></table></figure><p>å…ˆæ‰§è¡Œ async2 åï¼Œå‘ç°æœ‰ await å…³é”®å­—ï¼Œäºæ˜¯è®©å‡ºçº¿ç¨‹ï¼Œé˜»å¡ä»£ç </p><p>å³ä¾§è¡¨è¾¾å¼çš„ç»“æœ:</p><ul><li>å¦‚æœä¸æ˜¯ promise , await ä¼šé˜»å¡åé¢çš„ä»£ç ï¼Œå…ˆæ‰§è¡Œ async å¤–é¢çš„åŒæ­¥ä»£ç ï¼ŒåŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼Œå†å›åˆ° async å†…éƒ¨ï¼ŒæŠŠè¿™ä¸ªé promise çš„ä¸œè¥¿ï¼Œä½œä¸º await è¡¨è¾¾å¼çš„ç»“æœ</li><li>å¦‚æœå®ƒç­‰åˆ°çš„æ˜¯ä¸€ä¸ª promise å¯¹è±¡ï¼Œawait ä¹Ÿä¼šæš‚åœ async åé¢çš„ä»£ç ï¼Œå…ˆæ‰§è¡Œ async å¤–é¢çš„åŒæ­¥ä»£ç ï¼Œç­‰ç€ Promise å¯¹è±¡ fulfilledï¼Œç„¶åæŠŠ resolve çš„å‚æ•°ä½œä¸º await è¡¨è¾¾å¼çš„è¿ç®—ç»“æœã€‚</li></ul><h3 id="async-await-çš„ä¼˜åŠ¿åœ¨äºå¤„ç†-then-é“¾"><a href="#async-await-çš„ä¼˜åŠ¿åœ¨äºå¤„ç†-then-é“¾" class="headerlink" title="async/await çš„ä¼˜åŠ¿åœ¨äºå¤„ç† then é“¾"></a>async/await çš„ä¼˜åŠ¿åœ¨äºå¤„ç† then é“¾</h3><p>å•ä¸€çš„ Promise é“¾å¹¶ä¸èƒ½å‘ç° async/await çš„ä¼˜åŠ¿ï¼Œä½†æ˜¯ï¼Œå¦‚æœéœ€è¦å¤„ç†ç”±å¤šä¸ª Promise ç»„æˆçš„ then é“¾çš„æ—¶å€™ï¼Œä¼˜åŠ¿å°±èƒ½ä½“ç°å‡ºæ¥äº†ã€‚</p><ul><li>Async/await ä»£ç æ¸…æ™°å¾ˆå¤šï¼Œå‡ ä¹è·ŸåŒæ­¥ä»£ç ä¸€æ ·ã€‚</li><li>Promise æ–¹æ¡ˆçš„æ­»ç©´â€”â€” é“¾å¼è°ƒç”¨å‚æ•°ä¼ é€’å¤ªéº»çƒ¦</li></ul><h2 id="async-await-å’Œ-promise-çš„æ‰§è¡Œé¡ºåº"><a href="#async-await-å’Œ-promise-çš„æ‰§è¡Œé¡ºåº" class="headerlink" title="async/await å’Œ promise çš„æ‰§è¡Œé¡ºåº"></a>async/await å’Œ promise çš„æ‰§è¡Œé¡ºåº</h2><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"async1 start"</span>);</span><br><span class="line">  <span class="keyword">await</span> async2();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"async1 end"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"async2"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"script start"</span>);</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"setTimeout"</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line">async1();</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"promise1"</span>);</span><br><span class="line">  resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"promise2"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"script end"</span>);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">script start</span><br><span class="line">async1 start</span><br><span class="line">async2</span><br><span class="line">promise1</span><br><span class="line">script end</span><br><span class="line">promise2</span><br><span class="line">async1 end</span><br><span class="line">setTimeout</span><br></pre></td></tr></table></figure><p>å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„æ…¨å¿µï¼Œåœ¨æˆ‘è„‘æµ·ä¸­å®ä»»åŠ¡å’Œä¸ºå¾®ä»»åŠ¡å¦‚å›¾æ‰€ç¤º</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izm5nu3ij30f204qq2z.jpg" alt="img"></p><p>ä¹Ÿå°±æ˜¯ã€Œå®ä»»åŠ¡ã€ã€ã€Œå¾®ä»»åŠ¡ã€éƒ½æ˜¯é˜Ÿåˆ—ã€‚</p><p>ä¸€æ®µä»£ç æ‰§è¡Œæ—¶ï¼Œä¼šå…ˆæ‰§è¡Œå®ä»»åŠ¡ä¸­çš„åŒæ­¥ä»£ç ï¼Œ</p><ul><li>å¦‚æœæ‰§è¡Œä¸­é‡åˆ° setTimeout ä¹‹ç±»å®ä»»åŠ¡ï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸ª setTimeout å†…éƒ¨çš„å‡½æ•°æ¨å…¥ã€Œå®ä»»åŠ¡çš„é˜Ÿåˆ—ã€ä¸­ï¼Œä¸‹ä¸€è½®å®ä»»åŠ¡æ‰§è¡Œæ—¶è°ƒç”¨ã€‚</li><li>å¦‚æœæ‰§è¡Œä¸­é‡åˆ° promise.then()ä¹‹ç±»çš„å¾®ä»»åŠ¡ï¼Œå°±ä¼šæ¨å…¥åˆ°ã€Œå½“å‰å®ä»»åŠ¡çš„å¾®ä»»åŠ¡é˜Ÿåˆ—ã€ä¸­ï¼Œåœ¨æœ¬è½®å®ä»»åŠ¡çš„åŒæ­¥ä»£ç æ‰§è¡Œéƒ½å®Œæˆåï¼Œä¾æ¬¡æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡ 1ã€2ã€3</li></ul><h3 id="ä¾‹å­åˆ†ææ‰§è¡Œé¡ºåº"><a href="#ä¾‹å­åˆ†ææ‰§è¡Œé¡ºåº" class="headerlink" title="ä¾‹å­åˆ†ææ‰§è¡Œé¡ºåº"></a>ä¾‹å­åˆ†ææ‰§è¡Œé¡ºåº</h3><h4 id="ç›´æ¥æ‰“å°åŒæ­¥ä»£ç -console-log-â€˜script-startâ€™"><a href="#ç›´æ¥æ‰“å°åŒæ­¥ä»£ç -console-log-â€˜script-startâ€™" class="headerlink" title="ç›´æ¥æ‰“å°åŒæ­¥ä»£ç  console.log(â€˜script startâ€™)"></a>ç›´æ¥æ‰“å°åŒæ­¥ä»£ç  console.log(â€˜script startâ€™)</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆæ˜¯2ä¸ªå‡½æ•°å£°æ˜ï¼Œè™½ç„¶æœ‰asyncå…³é”®å­—ï¼Œä½†ä¸æ˜¯è°ƒç”¨æˆ‘ä»¬å°±ä¸çœ‹ã€‚ç„¶åé¦–å…ˆæ˜¯æ‰“å°åŒæ­¥ä»£ç </span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"script start"</span>);</span><br></pre></td></tr></table></figure><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izmivm1ij30m801x745.jpg" alt="img"></p><h4 id="å°†-setTimeout-æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—"><a href="#å°†-setTimeout-æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—" class="headerlink" title="å°† setTimeout æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—"></a>å°† setTimeout æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—</h4><p>é»˜è®¤æ‰€åŒ…è£¹çš„ä»£ç ï¼Œå…¶å®å¯ä»¥ç†è§£ä¸ºæ˜¯ç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯å®ä»»åŠ¡ 2</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izmvovzjj30m8034dft.jpg" alt="img"></p><h4 id="è°ƒç”¨-async1ï¼Œæ‰“å°-åŒæ­¥ä»£ç -console-log-â€˜async1-startâ€™"><a href="#è°ƒç”¨-async1ï¼Œæ‰“å°-åŒæ­¥ä»£ç -console-log-â€˜async1-startâ€™" class="headerlink" title="è°ƒç”¨ async1ï¼Œæ‰“å° åŒæ­¥ä»£ç  console.log( â€˜async1 startâ€™ )"></a>è°ƒç”¨ async1ï¼Œæ‰“å° åŒæ­¥ä»£ç  console.log( â€˜async1 startâ€™ )</h4><p>æˆ‘ä»¬è¯´è¿‡çœ‹åˆ°å¸¦æœ‰ async å…³é”®å­—çš„å‡½æ•°ï¼Œä¸ç”¨å®³æ€•ï¼Œå®ƒçš„ä»…ä»…æ˜¯æŠŠ return å€¼åŒ…è£…æˆäº† promiseï¼Œå…¶ä»–å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒçš„åœ°æ–¹ã€‚æ‰€ä»¥å°±å¾ˆæ™®é€šçš„æ‰“å° console.log( â€˜async1 startâ€™ )</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izn7f29dj30m803dt8o.jpg" alt="img"></p><h4 id="åˆ†æä¸€ä¸‹-await-async2"><a href="#åˆ†æä¸€ä¸‹-await-async2" class="headerlink" title="åˆ†æä¸€ä¸‹ await async2()"></a>åˆ†æä¸€ä¸‹ await async2()</h4><p>å‰æ–‡æè¿‡ awaitï¼Œ1.å®ƒå…ˆè®¡ç®—å‡ºå³ä¾§çš„ç»“æœï¼Œ2.ç„¶åçœ‹åˆ° await åï¼Œä¸­æ–­ async å‡½æ•°</p><ul><li>å…ˆå¾—åˆ° await å³ä¾§è¡¨è¾¾å¼çš„ç»“æœã€‚æ‰§è¡Œ async2()ï¼Œæ‰“å°åŒæ­¥ä»£ç  console.log(â€˜async2â€™), å¹¶ä¸” return Promise.resolve(undefined)</li><li>await åï¼Œä¸­æ–­ async å‡½æ•°ï¼Œå…ˆæ‰§è¡Œ async å¤–çš„åŒæ­¥ä»£ç </li></ul><p>ç›®å‰å°±ç›´æ¥æ‰“å° console.log(â€˜async2â€™)</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6iznit5adj30m803edfu.jpg" alt="img"></p><h4 id="è¢«é˜»å¡åï¼Œè¦æ‰§è¡Œ-async-ä¹‹å¤–çš„ä»£ç "><a href="#è¢«é˜»å¡åï¼Œè¦æ‰§è¡Œ-async-ä¹‹å¤–çš„ä»£ç " class="headerlink" title="è¢«é˜»å¡åï¼Œè¦æ‰§è¡Œ async ä¹‹å¤–çš„ä»£ç "></a>è¢«é˜»å¡åï¼Œè¦æ‰§è¡Œ async ä¹‹å¤–çš„ä»£ç </h4><p>æ‰§è¡Œ new Promise()ï¼ŒPromise æ„é€ å‡½æ•°æ˜¯ç›´æ¥è°ƒç”¨çš„åŒæ­¥ä»£ç ï¼Œæ‰€ä»¥ console.log( â€˜promise1â€™ )</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6iznu7o6jj30m803l74a.jpg" alt="img"></p><h4 id="ä»£ç è¿è¡Œåˆ°-promise-then"><a href="#ä»£ç è¿è¡Œåˆ°-promise-then" class="headerlink" title="ä»£ç è¿è¡Œåˆ° promise.then()"></a>ä»£ç è¿è¡Œåˆ° promise.then()</h4><p>ä»£ç è¿è¡Œåˆ° promise.then()ï¼Œå‘ç°è¿™ä¸ªæ˜¯å¾®ä»»åŠ¡ï¼Œæ‰€ä»¥æš‚æ—¶ä¸æ‰“å°ï¼Œåªæ˜¯æ¨å…¥å½“å‰å®ä»»åŠ¡çš„å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</p><p><strong>æ³¨æ„ï¼šè¿™é‡Œåªæ˜¯æŠŠ promise2 æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œã€‚å¾®ä»»åŠ¡ä¼šåœ¨å½“å‰å®ä»»åŠ¡çš„åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šä¾æ¬¡æ‰§è¡Œ</strong></p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izo8rmlkj30m803c0sp.jpg" alt="img"></p><h4 id="æ‰“å°åŒæ­¥ä»£ç -console-log-â€˜script-endâ€™"><a href="#æ‰“å°åŒæ­¥ä»£ç -console-log-â€˜script-endâ€™" class="headerlink" title="æ‰“å°åŒæ­¥ä»£ç  console.log(â€˜script endâ€™)"></a>æ‰“å°åŒæ­¥ä»£ç  console.log(â€˜script endâ€™)</h4><p>æ‰§è¡Œå®Œè¿™ä¸ªåŒæ­¥ä»£ç åï¼Œã€Œasync å¤–çš„ä»£ç ã€ç»ˆäºèµ°äº†ä¸€é</p><p>ä¸‹é¢è¯¥å›åˆ° await è¡¨è¾¾å¼é‚£é‡Œï¼Œæ‰§è¡Œ await Promise.resolve(undefined)äº†<br><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izoj1zjkj30m803c749.jpg" alt="img"></p><h4 id="å›åˆ°-async-å†…éƒ¨ï¼Œæ‰§è¡Œ-await-Promise-resolve-undefined"><a href="#å›åˆ°-async-å†…éƒ¨ï¼Œæ‰§è¡Œ-await-Promise-resolve-undefined" class="headerlink" title="å›åˆ° async å†…éƒ¨ï¼Œæ‰§è¡Œ await Promise.resolve(undefined)"></a>å›åˆ° async å†…éƒ¨ï¼Œæ‰§è¡Œ await Promise.resolve(undefined)</h4><p>è¿™éƒ¨åˆ†å¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œæˆ‘å°½é‡è¡¨è¾¾æˆ‘çš„æƒ³æ³•ã€‚</p><p>å¯¹äº await Promise.resolve(undefined) å¦‚ä½•ç†è§£å‘¢ï¼Ÿ</p><p>æ ¹æ® <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/await" target="_blank" rel="noopener">MDN</a> åŸè¯æˆ‘ä»¬çŸ¥é“</p><p><strong>å¦‚æœä¸€ä¸ª Promise è¢«ä¼ é€’ç»™ä¸€ä¸ª await æ“ä½œç¬¦ï¼Œawait å°†ç­‰å¾… Promise æ­£å¸¸å¤„ç†å®Œæˆå¹¶è¿”å›å…¶å¤„ç†ç»“æœã€‚</strong></p><p>åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯ Promise.resolve(undefined)æ­£å¸¸å¤„ç†å®Œæˆï¼Œå¹¶è¿”å›å…¶å¤„ç†ç»“æœã€‚é‚£ä¹ˆ await async2()å°±ç®—æ˜¯æ‰§è¡Œç»“æŸäº†ã€‚</p><p>ç›®å‰è¿™ä¸ª promise çš„çŠ¶æ€æ˜¯ fulfilledï¼Œç­‰å…¶å¤„ç†ç»“æœè¿”å›å°±å¯ä»¥æ‰§è¡Œ await ä¸‹é¢çš„ä»£ç äº†ã€‚</p><p>é‚£ä½•æ—¶èƒ½æ‹¿åˆ°å¤„ç†ç»“æœå‘¢ï¼Ÿ</p><p>å›å¿†å¹³æ—¶æˆ‘ä»¬ç”¨ promiseï¼Œè°ƒç”¨ resolve åï¼Œä½•æ—¶èƒ½æ‹¿åˆ°å¤„ç†ç»“æœï¼Ÿæ˜¯ä¸æ˜¯éœ€è¦åœ¨ then çš„ç¬¬ä¸€ä¸ªå‚æ•°é‡Œï¼Œæ‰èƒ½æ‹¿åˆ°ç»“æœã€‚</p><p>ï¼ˆè°ƒç”¨ resolve æ—¶ï¼Œä¼šæŠŠ then çš„å‚æ•°æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰ä¸»çº¿ç¨‹ç©ºé—²æ—¶ï¼Œå†è°ƒç”¨å®ƒï¼‰</p><p>æ‰€ä»¥è¿™é‡Œçš„ await Promise.resolve() å°±ç±»ä¼¼äº</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="literal">undefined</span>).then(<span class="function"><span class="params">undefined</span> =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure><p>æŠŠ then çš„ç¬¬ä¸€ä¸ªå›è°ƒå‚æ•° (undefined) =&gt; {} æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚</p><p>then æ‰§è¡Œå®Œï¼Œæ‰æ˜¯ await async2()æ‰§è¡Œç»“æŸã€‚</p><p>await async2()æ‰§è¡Œç»“æŸï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç </p><p>å¦‚å›¾</p><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6izovbp1aj30m8037q2y.jpg" alt="img"></p><h4 id="æ­¤æ—¶å½“å‰å®ä»»åŠ¡-1-éƒ½æ‰§è¡Œå®Œäº†ï¼Œè¦å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»£ç ã€‚"><a href="#æ­¤æ—¶å½“å‰å®ä»»åŠ¡-1-éƒ½æ‰§è¡Œå®Œäº†ï¼Œè¦å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»£ç ã€‚" class="headerlink" title="æ­¤æ—¶å½“å‰å®ä»»åŠ¡ 1 éƒ½æ‰§è¡Œå®Œäº†ï¼Œè¦å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»£ç ã€‚"></a>æ­¤æ—¶å½“å‰å®ä»»åŠ¡ 1 éƒ½æ‰§è¡Œå®Œäº†ï¼Œè¦å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»£ç ã€‚</h4><p>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå…ˆè¿›é€‰å‡ºçš„åŸåˆ™ï¼Œ</p><ol><li>æ‰§è¡Œå¾®ä»»åŠ¡ 1ï¼Œæ‰“å° promise2</li><li>æ‰§è¡Œå¾®ä»»åŠ¡ 2ï¼Œæ²¡ä»€ä¹ˆå†…å®¹..</li></ol><p>ä½†æ˜¯å¾®ä»»åŠ¡ 2 æ‰§è¡Œåï¼Œawait async2()è¯­å¥ç»“æŸï¼Œåé¢çš„ä»£ç ä¸å†è¢«é˜»å¡ï¼Œæ‰€ä»¥æ‰“å°</p><p>console.log(â€˜async1 endâ€™)</p><h4 id="å®ä»»åŠ¡-1-æ‰§è¡Œå®Œæˆå-æ‰§è¡Œå®ä»»åŠ¡-2"><a href="#å®ä»»åŠ¡-1-æ‰§è¡Œå®Œæˆå-æ‰§è¡Œå®ä»»åŠ¡-2" class="headerlink" title="å®ä»»åŠ¡ 1 æ‰§è¡Œå®Œæˆå,æ‰§è¡Œå®ä»»åŠ¡ 2"></a>å®ä»»åŠ¡ 1 æ‰§è¡Œå®Œæˆå,æ‰§è¡Œå®ä»»åŠ¡ 2</h4><p>å®ä»»åŠ¡ 2 çš„æ‰§è¡Œæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ‰“å°</p><p>console.log(â€˜setTimeoutâ€™)</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JS-å¼•æ“æ‰§è¡Œæœºåˆ¶&quot;&gt;&lt;a href=&quot;#JS-å¼•æ“æ‰§è¡Œæœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;JS å¼•æ“æ‰§è¡Œæœºåˆ¶&quot;&gt;&lt;/a&gt;JS å¼•æ“æ‰§è¡Œæœºåˆ¶&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;(1) JS æ˜¯å•çº¿ç¨‹è¯­è¨€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(2) JS çš„ Event Loop æ˜¯ JS çš„æ‰§è¡Œæœºåˆ¶ã€‚æ·±å…¥äº†è§£ JS çš„æ‰§è¡Œ,å°±ç­‰äºæ·±å…¥äº†è§£ JS é‡Œçš„ event loop&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>JSäº‹ä»¶æœºåˆ¶</title>
    <link href="http://yoursite.com/2019/07/24/JS%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/"/>
    <id>http://yoursite.com/2019/07/24/JSäº‹ä»¶æœºåˆ¶/</id>
    <published>2019-07-24T07:22:00.000Z</published>
    <updated>2019-11-10T14:37:39.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JS-äº‹ä»¶æœºåˆ¶"><a href="#JS-äº‹ä»¶æœºåˆ¶" class="headerlink" title="JS äº‹ä»¶æœºåˆ¶"></a>JS äº‹ä»¶æœºåˆ¶</h1><h2 id="js-é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ"><a href="#js-é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ" class="headerlink" title="js é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ"></a>js é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ</h2><p>event.preventDefault()å¯ä»¥å–æ¶ˆé»˜è®¤äº‹ä»¶</p><p>event.stopPropagation()èµ·åˆ°é˜»æ­¢æ•è·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚</p><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cancelHandler</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> event = event || <span class="built_in">window</span>.event; <span class="comment">//å…¼å®¹IE</span></span><br><span class="line">  <span class="comment">//å–æ¶ˆäº‹ä»¶ç›¸å…³çš„é»˜è®¤è¡Œä¸º</span></span><br><span class="line">  <span class="keyword">if</span> (event.preventDefault)</span><br><span class="line">    <span class="comment">//æ ‡å‡†æŠ€æœ¯</span></span><br><span class="line">    event.preventDefault();</span><br><span class="line">  <span class="keyword">if</span> (event.returnValue)</span><br><span class="line">    <span class="comment">//å…¼å®¹IE9ä¹‹å‰çš„IE</span></span><br><span class="line">    event.returnValue = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">//ç”¨äºå¤„ç†ä½¿ç”¨å¯¹è±¡å±æ€§æ³¨å†Œçš„å¤„ç†ç¨‹åº</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†’æ³¡çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿä¸‹é¢ä»£ç è¾“å‡ºé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ2-gt-button-gt-1ï¼‰"><a href="#å†’æ³¡çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿä¸‹é¢ä»£ç è¾“å‡ºé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ2-gt-button-gt-1ï¼‰" class="headerlink" title="å†’æ³¡çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿä¸‹é¢ä»£ç è¾“å‡ºé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ2-&gt;button-&gt;1ï¼‰"></a>å†’æ³¡çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿä¸‹é¢ä»£ç è¾“å‡ºé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ2-&gt;button-&gt;1ï¼‰</h2><ul><li>è§¦å‘é¡ºåºï¼šbutton-&gt;1-&gt;2</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">button</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"1"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">false</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"2"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">false</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"button"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"button"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">false</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>è§¦å‘é¡ºåºï¼š2-&gt;button-&gt;1</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">button</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"1"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">false</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"2"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">true</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"button"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"button"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">false</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>è§¦å‘é¡ºåºï¼š2-&gt;button-&gt;1</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">button</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"1"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">false</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"div"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"2"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">true</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"button"</span>).addEventListener(</span></span><br><span class="line"><span class="actionscript">    <span class="string">"click"</span>,</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"button"</span>);</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    <span class="literal">true</span></span></span><br><span class="line">  );</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JS-äº‹ä»¶æœºåˆ¶&quot;&gt;&lt;a href=&quot;#JS-äº‹ä»¶æœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;JS äº‹ä»¶æœºåˆ¶&quot;&gt;&lt;/a&gt;JS äº‹ä»¶æœºåˆ¶&lt;/h1&gt;&lt;h2 id=&quot;js-é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ&quot;&gt;&lt;a href=&quot;#js-é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;js é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ&quot;&gt;&lt;/a&gt;js é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿ&lt;/h2&gt;&lt;p&gt;event.preventDefault()å¯ä»¥å–æ¶ˆé»˜è®¤äº‹ä»¶&lt;/p&gt;
&lt;p&gt;event.stopPropagation()èµ·åˆ°é˜»æ­¢æ•è·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>JSé™æ€ä½œç”¨åŸŸ</title>
    <link href="http://yoursite.com/2019/07/11/JS%E9%9D%99%E6%80%81%E4%BD%9C%E7%94%A8%E5%9F%9F/"/>
    <id>http://yoursite.com/2019/07/11/JSé™æ€ä½œç”¨åŸŸ/</id>
    <published>2019-07-11T03:01:34.000Z</published>
    <updated>2019-11-10T14:37:39.020Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JS-é™æ€ä½œç”¨åŸŸ"><a href="#JS-é™æ€ä½œç”¨åŸŸ" class="headerlink" title="JS é™æ€ä½œç”¨åŸŸ"></a>JS é™æ€ä½œç”¨åŸŸ</h1><h2 id="js-çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#js-çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="js çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«"></a>js çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«</h2><h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h3><p>ä½œç”¨åŸŸæ˜¯æŒ‡ç¨‹åºæºä»£ç ä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸã€‚</p><p>ä½œç”¨åŸŸè§„å®šäº†å¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼Œä¹Ÿå°±æ˜¯ç¡®å®šå½“å‰æ‰§è¡Œä»£ç å¯¹å˜é‡çš„è®¿é—®æƒé™ã€‚</p><p>JavaScript é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸ(lexical scoping)ï¼Œä¹Ÿå°±æ˜¯é™æ€ä½œç”¨åŸŸã€‚</p><a id="more"></a><h3 id="é™æ€ä½œç”¨åŸŸä¸åŠ¨æ€ä½œç”¨åŸŸ"><a href="#é™æ€ä½œç”¨åŸŸä¸åŠ¨æ€ä½œç”¨åŸŸ" class="headerlink" title="é™æ€ä½œç”¨åŸŸä¸åŠ¨æ€ä½œç”¨åŸŸ"></a>é™æ€ä½œç”¨åŸŸä¸åŠ¨æ€ä½œç”¨åŸŸ</h3><p>å› ä¸º JavaScript é‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±å†³å®šäº†ã€‚</p><p>è€Œä¸è¯æ³•ä½œç”¨åŸŸç›¸å¯¹çš„æ˜¯åŠ¨æ€ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸæ˜¯åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ‰å†³å®šçš„ã€‚</p><p>è®©æˆ‘ä»¬è®¤çœŸçœ‹ä¸ªä¾‹å­å°±èƒ½æ˜ç™½ä¹‹é—´çš„åŒºåˆ«ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> value = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> value = <span class="number">2</span>;</span><br><span class="line">  foo();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bar();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœæ˜¯ ???</span></span><br></pre></td></tr></table></figure><p>å‡è®¾ JavaScript é‡‡ç”¨é™æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š</p><p>æ‰§è¡Œ foo å‡½æ•°ï¼Œå…ˆä» foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ valueï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æ ¹æ®ä¹¦å†™çš„ä½ç½®ï¼ŒæŸ¥æ‰¾ä¸Šé¢ä¸€å±‚çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯ value ç­‰äº 1ï¼Œæ‰€ä»¥ç»“æœä¼šæ‰“å° 1ã€‚</p><p>å‡è®¾ JavaScript é‡‡ç”¨åŠ¨æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š</p><p>æ‰§è¡Œ foo å‡½æ•°ï¼Œä¾ç„¶æ˜¯ä» foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ valueã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±ä»è°ƒç”¨å‡½æ•°çš„ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯ bar å‡½æ•°å†…éƒ¨æŸ¥æ‰¾ value å˜é‡ï¼Œæ‰€ä»¥ç»“æœä¼šæ‰“å° 2ã€‚</p><p>å‰é¢æˆ‘ä»¬å·²ç»è¯´äº†ï¼ŒJavaScript é‡‡ç”¨çš„æ˜¯é™æ€ä½œç”¨åŸŸï¼Œæ‰€ä»¥è¿™ä¸ªä¾‹å­çš„ç»“æœæ˜¯ 1ã€‚</p><p>æœ€åï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªã€ŠJavaScript æƒå¨æŒ‡å—ã€‹ä¸­çš„ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scope = <span class="string">"global scope"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkscope</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> scope = <span class="string">"local scope"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> scope;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f();</span><br><span class="line">&#125;</span><br><span class="line">checkscope();</span><br><span class="line"><span class="keyword">var</span> scope = <span class="string">"global scope"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkscope</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> scope = <span class="string">"local scope"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> scope;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line">checkscope()();</span><br></pre></td></tr></table></figure><p>çŒœçŒœä¸¤æ®µä»£ç å„è‡ªçš„æ‰§è¡Œç»“æœæ˜¯å¤šå°‘ï¼Ÿ</p><p>è¿™é‡Œç›´æ¥å‘Šè¯‰å¤§å®¶ç»“æœï¼Œä¸¤æ®µä»£ç éƒ½ä¼šæ‰“å°ï¼š<code>local scope</code>ã€‚</p><p>åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸º JavaScript é‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåŸºäºå‡½æ•°åˆ›å»ºçš„ä½ç½®ã€‚</p><p>è€Œå¼•ç”¨ã€ŠJavaScript æƒå¨æŒ‡å—ã€‹çš„å›ç­”å°±æ˜¯ï¼š</p><p>JavaScript å‡½æ•°çš„æ‰§è¡Œç”¨åˆ°äº†ä½œç”¨åŸŸé“¾ï¼Œè¿™ä¸ªä½œç”¨åŸŸé“¾æ˜¯åœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™åˆ›å»ºçš„ã€‚åµŒå¥—çš„å‡½æ•° f() å®šä¹‰åœ¨è¿™ä¸ªä½œç”¨åŸŸé“¾é‡Œï¼Œå…¶ä¸­çš„å˜é‡ scope ä¸€å®šæ˜¯å±€éƒ¨å˜é‡ï¼Œä¸ç®¡ä½•æ—¶ä½•åœ°æ‰§è¡Œå‡½æ•° f()ï¼Œè¿™ç§ç»‘å®šåœ¨æ‰§è¡Œ f() æ—¶ä¾ç„¶æœ‰æ•ˆã€‚</p><p><strong>bash å°±æ˜¯åŠ¨æ€ä½œç”¨åŸŸ</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JS-é™æ€ä½œç”¨åŸŸ&quot;&gt;&lt;a href=&quot;#JS-é™æ€ä½œç”¨åŸŸ&quot; class=&quot;headerlink&quot; title=&quot;JS é™æ€ä½œç”¨åŸŸ&quot;&gt;&lt;/a&gt;JS é™æ€ä½œç”¨åŸŸ&lt;/h1&gt;&lt;h2 id=&quot;js-çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«&quot;&gt;&lt;a href=&quot;#js-çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«&quot; class=&quot;headerlink&quot; title=&quot;js çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«&quot;&gt;&lt;/a&gt;js çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«&lt;/h2&gt;&lt;h3 id=&quot;ä½œç”¨åŸŸ&quot;&gt;&lt;a href=&quot;#ä½œç”¨åŸŸ&quot; class=&quot;headerlink&quot; title=&quot;ä½œç”¨åŸŸ&quot;&gt;&lt;/a&gt;ä½œç”¨åŸŸ&lt;/h3&gt;&lt;p&gt;ä½œç”¨åŸŸæ˜¯æŒ‡ç¨‹åºæºä»£ç ä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸã€‚&lt;/p&gt;
&lt;p&gt;ä½œç”¨åŸŸè§„å®šäº†å¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼Œä¹Ÿå°±æ˜¯ç¡®å®šå½“å‰æ‰§è¡Œä»£ç å¯¹å˜é‡çš„è®¿é—®æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;JavaScript é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸ(lexical scoping)ï¼Œä¹Ÿå°±æ˜¯é™æ€ä½œç”¨åŸŸã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
</feed>
