{"meta":{"title":"01ä¸æ˜¯åŒ…å­è„¸","subtitle":"å°01çš„ç¨‹åºçŒ¿æˆé•¿ä¹‹è·¯","description":null,"author":"Linyi Li","url":"http://yoursite.com"},"pages":[{"title":"About","date":"2018-06-20T16:00:00.000Z","updated":"2020-02-08T16:11:14.056Z","comments":true,"path":"about/index.html","permalink":"http://yoursite.com/about/index.html","excerpt":"","text":"å…³äº 01æˆ‘æ˜¯ã€01ã€ã€‚ä¸€ä¸ªä¸æ‰¿è®¤è‡ªå·±æ˜¯åŒ…å­è„¸çš„å°ä»™å¥³ï½ä¸€ä¸ªåŠªåŠ›æˆé•¿çš„æŠ€æœ¯å°èœé¸Ÿã€‚ğŸ™ˆå–œæ¬¢åƒçºï¼Œå–œæ¬¢åˆ·å‰§çœ‹ç»¼è‰ºï¼Œå–œæ¬¢å¤å¤©ç©¿å°è£™å­ã€å¼€ç€ç©ºè°ƒçªåœ¨è¢«å­é‡Œåƒè¥¿ç“œã€‚ğŸ‰å–œæ¬¢æ—…è¡Œï¼Œå–œæ¬¢çŒ«çŒ«ç‹—ç‹—ï¼Œå–œæ¬¢æ‹ç…§è®°å½•ç”Ÿæ´»ï¼Œå–œæ¬¢èº«è¾¹æœ‰ä¸€ç¾¤å¿—åŒé“åˆçš„å¥½æœ‹å‹ã€‚ğŸ‘¯â€â™€ï¸å–œæ¬¢æç…Šã€‚â¤ï¸ å…³äºåšå®¢è¿™ä¸ªåšå®¢ï¼Œæƒ³è®°å½•ä¸€è·¯èµ°æ¥çš„ç‚¹ç‚¹æ»´æ»´ã€‚æœ‰å…³äºå¤§ç¥çš„è§è§£æ¬è¿ï¼Œæœ‰è‡ªå·±æ€»ç»“çš„å°å°å¿ƒå¾—ã€‚å¸Œæœ›çœ‹åšå®¢çš„ä½ ï¼Œä¹Ÿèƒ½æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„é—®é¢˜ç­”æ¡ˆã€‚ğŸ— å…³äºç°åœ¨æˆ–æœªæ¥å¸Œæœ›æˆ‘å’Œä½ ï¼Œæˆ‘ä»¬ï¼Œéƒ½èƒ½æœ‰è‡ªå·±çš„ä¸€æŠ€ä¹‹é•¿ï¼Œèƒ½åœ¨ç¤¾ä¼šä¸Šçš„æŸä¸ªæ–¹é¢æˆä¸ºç‹¬å½“ä¸€é¢çš„ä½¼ä½¼è€…ã€‚ğŸ‰2020 çš„å°å¿ƒæ„¿ï¼šèƒ½å¤Ÿè¢«çƒ­çƒˆçš„çˆ±ç€ä»¥åŠå¥½å¥½çš„æ´»ç€ã€‚ğŸ˜˜ å…³äºç¤¾äº¤ : 01 ä¸æ˜¯åŒ…å­è„¸å•Š : linyi531 : linyi531"},{"title":"Categories","date":"2018-06-20T16:00:00.000Z","updated":"2019-09-21T10:49:32.277Z","comments":false,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"Tags","date":"2018-06-20T16:00:00.000Z","updated":"2019-09-21T10:49:32.277Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"babel","slug":"babel","date":"2020-04-01T07:22:34.000Z","updated":"2020-04-03T06:23:06.567Z","comments":true,"path":"2020/04/01/babel/","link":"","permalink":"http://yoursite.com/2020/04/01/babel/","excerpt":"","text":"babelBabel æ˜¯ä»€ä¹ˆBabel æ˜¯ä¸€ä¸ª JavaScript ç¼–è¯‘å™¨ Babel æ˜¯ä¸€ä¸ªå·¥å…·é“¾ï¼Œä¸»è¦ç”¨äºå°† ECMAScript 2015+ ç‰ˆæœ¬çš„ä»£ç è½¬æ¢ä¸ºå‘åå…¼å®¹çš„ JavaScript è¯­æ³•ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¿è¡Œåœ¨å½“å‰å’Œæ—§ç‰ˆæœ¬çš„æµè§ˆå™¨æˆ–å…¶ä»–ç¯å¢ƒä¸­ã€‚ä¸‹é¢åˆ—å‡ºçš„æ˜¯ Babel èƒ½ä¸ºä½ åšçš„äº‹æƒ…ï¼š è¯­æ³•è½¬æ¢ é€šè¿‡ Polyfill æ–¹å¼åœ¨ç›®æ ‡ç¯å¢ƒä¸­æ·»åŠ ç¼ºå¤±çš„ç‰¹æ€§ (é€šè¿‡ @babel/polyfill æ¨¡å—) æºç è½¬æ¢ (codemods) Babelçš„åŠŸèƒ½éå¸¸çº¯ç²¹ï¼Œä»¥å­—ç¬¦ä¸²çš„å½¢å¼å°†æºä»£ç ä¼ ç»™å®ƒï¼Œå®ƒå°±ä¼šè¿”å›ä¸€æ®µæ–°çš„ä»£ç å­—ç¬¦ä¸²ï¼ˆä»¥åŠsourcemapï¼‰ã€‚ä»–æ—¢ä¸ä¼šè¿è¡Œä½ çš„ä»£ç ï¼Œä¹Ÿä¸ä¼šå°†å¤šä¸ªä»£ç æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œå®ƒå°±æ˜¯ä¸ªç¼–è¯‘å™¨ï¼Œè¾“å…¥è¯­è¨€æ˜¯ES6+ï¼Œç¼–è¯‘ç›®æ ‡è¯­è¨€æ˜¯ES5ã€‚ babel å†…éƒ¨ä½¿ç”¨çš„è§£æç±»åº“å«åš babylonï¼Œå¹¶é babel è‡ªè¡Œå¼€å‘ Babelå·¥ä½œçš„ä¸‰ä¸ªé˜¶æ®µBabelçš„ç¼–è¯‘è¿‡ç¨‹è·Ÿç»å¤§å¤šæ•°å…¶ä»–è¯­è¨€çš„ç¼–è¯‘å™¨å¤§è‡´åŒç†ï¼Œåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š è§£æï¼šå°†ä»£ç å­—ç¬¦ä¸²è§£ææˆæŠ½è±¡è¯­æ³•æ ‘ å˜æ¢ï¼šå¯¹æŠ½è±¡è¯­æ³•æ ‘è¿›è¡Œå˜æ¢æ“ä½œ å†å»ºï¼šæ ¹æ®å˜æ¢åçš„æŠ½è±¡è¯­æ³•æ ‘å†ç”Ÿæˆä»£ç å­—ç¬¦ä¸² ç¬¬1æ­¥è½¬æ¢çš„è¿‡ç¨‹ä¸­å¯ä»¥éªŒè¯è¯­æ³•çš„æ­£ç¡®æ€§ï¼ŒåŒæ—¶ç”±å­—ç¬¦ä¸²å˜ä¸ºå¯¹è±¡ç»“æ„åæ›´æœ‰åˆ©äºç²¾å‡†åœ°åˆ†æä»¥åŠè¿›è¡Œä»£ç ç»“æ„è°ƒæ•´ã€‚ ç¬¬2æ­¥åŸç†å°±å¾ˆç®€å•äº†ï¼Œå°±æ˜¯éå†è¿™ä¸ªå¯¹è±¡æ‰€æè¿°çš„æŠ½è±¡è¯­æ³•æ ‘ï¼Œé‡åˆ°å“ªé‡Œéœ€è¦åšä¸€ä¸‹æ”¹å˜ï¼Œå°±ç›´æ¥åœ¨å¯¹è±¡ä¸Šè¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚æˆ‘æŠŠIfStatementç»™æ”¹æˆWhileStatementå°±è¾¾åˆ°äº†æŠŠæ¡ä»¶åˆ¤æ–­æ”¹æˆå¾ªç¯çš„æ•ˆæœã€‚ ç¬¬3æ­¥ä¹Ÿç®€å•ï¼Œé€’å½’éå†è¿™é¢—è¯­æ³•æ ‘ï¼Œç„¶åç”Ÿæˆç›¸åº”çš„ä»£ç ã€‚ æŠ½è±¡è¯­æ³•æ ‘æ˜¯å¦‚ä½•äº§ç”Ÿçš„è§£æè¿™ä¸€æ­¥åˆåˆ†æˆä¸¤ä¸ªæ­¥éª¤ï¼š åˆ†è¯ï¼šå°†æ•´ä¸ªä»£ç å­—ç¬¦ä¸²åˆ†å‰²æˆ è¯­æ³•å•å…ƒ æ•°ç»„ è¯­ä¹‰åˆ†æï¼šåœ¨åˆ†è¯ç»“æœçš„åŸºç¡€ä¹‹ä¸Šåˆ†æ è¯­æ³•å•å…ƒä¹‹é—´çš„å…³ç³» åˆ†è¯é¦–å…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯è¯­æ³•å•å…ƒï¼šè¯­æ³•å•å…ƒæ˜¯è¢«è§£æè¯­æ³•å½“ä¸­å…·å¤‡å®é™…æ„ä¹‰çš„æœ€å°å•å…ƒï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ç±»ä¼¼äºè‡ªç„¶è¯­è¨€ä¸­çš„è¯è¯­ã€‚ JSä»£ç æœ‰å“ªäº›è¯­æ³•å•å…ƒ ç©ºç™½ï¼šJSä¸­è¿ç»­çš„ç©ºæ ¼ã€æ¢è¡Œã€ç¼©è¿›ç­‰è¿™äº›å¦‚æœä¸åœ¨å­—ç¬¦ä¸²é‡Œï¼Œå°±æ²¡æœ‰ä»»ä½•å®é™…é€»è¾‘æ„ä¹‰ï¼Œæ‰€ä»¥æŠŠè¿ç»­çš„ç©ºç™½ç¬¦ç›´æ¥ç»„åˆåœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªè¯­æ³•å•å…ƒã€‚ æ³¨é‡Šï¼šè¡Œæ³¨é‡Šæˆ–å—æ³¨é‡Šï¼Œè™½ç„¶å¯¹äºäººç±»æ¥è¯´æœ‰æ„ä¹‰ï¼Œä½†æ˜¯å¯¹äºè®¡ç®—æœºæ¥è¯´çŸ¥é“è¿™æ˜¯ä¸ªâ€œæ³¨é‡Šâ€å°±è¡Œäº†ï¼Œå¹¶ä¸å…³å¿ƒå†…å®¹ï¼Œæ‰€ä»¥ç›´æ¥ä½œä¸ºä¸€ä¸ªä¸å¯å†æ‹†çš„è¯­æ³•å•å…ƒ å­—ç¬¦ä¸²ï¼šå¯¹äºæœºå™¨è€Œè¨€ï¼Œå­—ç¬¦ä¸²çš„å†…å®¹åªæ˜¯ä¼šå‚ä¸è®¡ç®—æˆ–å±•ç¤ºï¼Œé‡Œé¢å†ç»†åˆ†çš„å†…å®¹ä¹Ÿæ˜¯æ²¡å¿…è¦åˆ†æçš„ æ•°å­—ï¼šJSè¯­è¨€é‡Œå°±æœ‰16ã€10ã€8è¿›åˆ¶ä»¥åŠç§‘å­¦è¡¨è¾¾æ³•ç­‰æ•°å­—è¡¨è¾¾è¯­æ³•ï¼Œæ•°å­—ä¹Ÿæ˜¯ä¸ªå…·å¤‡å«ä¹‰çš„æœ€å°å•å…ƒ æ ‡è¯†ç¬¦ï¼šæ²¡æœ‰è¢«å¼•å·æ‰©èµ·æ¥çš„è¿ç»­å­—ç¬¦ï¼Œå¯åŒ…å«å­—æ¯ã€_ã€$ã€åŠæ•°å­—ï¼ˆæ•°å­—ä¸èƒ½ä½œä¸ºå¼€å¤´ï¼‰ã€‚æ ‡è¯†ç¬¦å¯èƒ½ä»£è¡¨ä¸€ä¸ªå˜é‡ï¼Œæˆ–è€…trueã€falseè¿™ç§å†…ç½®å¸¸é‡ã€ä¹Ÿå¯èƒ½æ˜¯ifã€returnã€functionè¿™ç§å…³é”®å­—ï¼Œæ˜¯å“ªç§è¯­ä¹‰ï¼Œåˆ†è¯é˜¶æ®µå¹¶ä¸åœ¨ä¹ï¼Œåªè¦æ­£ç¡®åˆ‡åˆ†å°±å¥½äº†ã€‚ è¿ç®—ç¬¦ï¼š+ã€-ã€*ã€/ã€&gt;ã€&lt;ç­‰ç­‰ æ‹¬å·ï¼š(â€¦)å¯èƒ½è¡¨ç¤ºè¿ç®—ä¼˜å…ˆçº§ã€ä¹Ÿå¯èƒ½è¡¨ç¤ºå‡½æ•°è°ƒç”¨ï¼Œåˆ†è¯é˜¶æ®µå¹¶ä¸å…³æ³¨æ˜¯å“ªç§è¯­ä¹‰ï¼ŒåªæŠŠâ€œ(â€æˆ–â€œ)â€å½“åšä¸€ç§åŸºæœ¬è¯­æ³•å•å…ƒ è¿˜æœ‰å…¶ä»–ï¼šå¦‚ä¸­æ‹¬å·ã€å¤§æ‹¬å·ã€åˆ†å·ã€å†’å·ã€ç‚¹ç­‰ç­‰ä¸å†ä¸€ä¸€åˆ—ä¸¾ è¿™æ‹†åˆ†è¿‡ç¨‹å…¶å®æ²¡å•¥å¯å–å·§çš„ï¼Œå°±æ˜¯ç®€å•ç²—æš´åœ°ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°éå†ï¼Œç„¶ååˆ†æƒ…å†µè®¨è®ºï¼Œæ•´ä¸ªå®ç°æ–¹æ³•å°±æ˜¯é¡ºåºéå†å’Œå¤§é‡çš„æ¡ä»¶åˆ¤æ–­ã€‚ è¯­ä¹‰åˆ†æè¯­ä¹‰åˆ†æå°±æ˜¯æŠŠè¯æ±‡è¿›è¡Œç«‹ä½“çš„ç»„åˆï¼Œç¡®å®šæœ‰å¤šé‡æ„ä¹‰çš„è¯è¯­æœ€ç»ˆæ˜¯ä»€ä¹ˆæ„æ€ã€å¤šä¸ªè¯è¯­ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ä»¥åŠåˆåº”è¯¥å†å“ªé‡Œæ–­å¥ç­‰ã€‚ åœ¨ç¼–ç¨‹è¯­è¨€è§£é‡Šå½“ä¸­ï¼Œè¿™å°±æ˜¯è¦æœ€ç»ˆç”Ÿæˆè¯­æ³•æ ‘çš„æ­¥éª¤äº†ã€‚ä¸åƒè‡ªç„¶è¯­è¨€ï¼Œåƒâ€œä»å¥â€è¿™ç§ç»“æ„å¾€å¾€æœ€å¤šåªæœ‰ä¸€å±‚ï¼Œç¼–ç¨‹è¯­è¨€çš„å„ç§ä»å±å…³ç³»æ›´åŠ å¤æ‚ã€‚ åœ¨ç¼–ç¨‹è¯­è¨€çš„è§£æä¸­æœ‰ä¸¤ä¸ªå¾ˆç›¸ä¼¼ä½†æ˜¯åˆæœ‰åŒºåˆ«çš„é‡è¦æ¦‚å¿µï¼š è¯­å¥ï¼šè¯­å¥æ˜¯ä¸€ä¸ªå…·å¤‡è¾¹ç•Œçš„ä»£ç åŒºåŸŸï¼Œç›¸é‚»çš„ä¸¤ä¸ªè¯­å¥ä¹‹é—´ä»è¯­æ³•ä¸Šæ¥è®²äº’ä¸å¹²æ‰°ï¼Œè°ƒæ¢é¡ºåºè™½ç„¶å¯èƒ½ä¼šå½±å“æ‰§è¡Œç»“æœï¼Œä½†ä¸ä¼šäº§ç”Ÿè¯­æ³•é”™è¯¯æ¯”å¦‚return trueã€var a = 10ã€if (â€¦) {â€¦} è¡¨è¾¾å¼ï¼šæœ€ç»ˆæœ‰ä¸ªç»“æœçš„ä¸€å°æ®µä»£ç ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥åŸæ ·åµŒå…¥åˆ°å¦ä¸€ä¸ªè¡¨è¾¾å¼æ¯”å¦‚myVarã€1+1ã€str.replace(â€˜aâ€™, â€˜bâ€™)ã€i &lt; 10 &amp;&amp; i &gt; 0ç­‰ å¾ˆå¤šæƒ…å†µä¸‹ä¸€ä¸ªè¯­å¥å¯èƒ½åªåŒ…å«ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ¯”å¦‚console.log(â€˜hiâ€™);ã€‚estreeæ ‡å‡†å½“ä¸­ï¼Œè¿™ç§è¯­å¥èŠ‚ç‚¹ç§°ä½œExpressionStatementã€‚ è¯­ä¹‰åˆ†æçš„è¿‡ç¨‹åˆæ˜¯ä¸ªéå†è¯­æ³•å•å…ƒçš„è¿‡ç¨‹ï¼Œä¸è¿‡ç›¸æ¯”è¾ƒè€Œè¨€æ›´å¤æ‚ï¼Œå› ä¸ºåˆ†è¯è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªè¯­æ³•å•å…ƒéƒ½æ˜¯ç‹¬ç«‹å¹³é“ºçš„ï¼Œè€Œè¯­æ³•åˆ†æä¸­ï¼Œè¯­å¥å’Œè¡¨è¾¾å¼ä¼šä»¥æ ‘çŠ¶çš„ç»“æ„äº’ç›¸åŒ…å«ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥ç”¨æ ˆï¼Œä¹Ÿå¯ä»¥ç”¨é€’å½’æ¥å®ç°ã€‚","categories":[{"name":"å‰ç«¯å·¥å…·","slug":"å‰ç«¯å·¥å…·","permalink":"http://yoursite.com/categories/å‰ç«¯å·¥å…·/"}],"tags":[{"name":"webpack","slug":"webpack","permalink":"http://yoursite.com/tags/webpack/"}]},{"title":"webpack DllPlugin","slug":"webpack DllPlugin","date":"2020-03-23T18:19:08.000Z","updated":"2020-04-03T06:20:35.930Z","comments":true,"path":"2020/03/24/webpack DllPlugin/","link":"","permalink":"http://yoursite.com/2020/03/24/webpack DllPlugin/","excerpt":"","text":"webpack DllPluginDllPlugin å’Œ DllReferencePluginåœ¨ä½¿ç”¨webpackè¿›è¡Œæ‰“åŒ…æ—¶å€™ï¼Œå¯¹äºä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚vueï¼Œvuexç­‰è¿™äº›ä¸ä¼šä¿®æ”¹çš„ä¾èµ–ï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒå’Œæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ä»£ç åˆ†å¼€æ‰“åŒ…ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯æ¯æ¬¡æ›´æ”¹æˆ‘æœ¬åœ°ä»£ç çš„æ–‡ä»¶çš„æ—¶å€™ï¼Œwebpackåªéœ€è¦æ‰“åŒ…æˆ‘é¡¹ç›®æœ¬èº«çš„æ–‡ä»¶ä»£ç ï¼Œè€Œä¸ä¼šå†å»ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“ï¼Œé‚£ä¹ˆç¬¬ä¸‰æ–¹åº“åœ¨ç¬¬ä¸€æ¬¡æ‰“åŒ…çš„æ—¶å€™åªæ‰“åŒ…ä¸€æ¬¡ï¼Œä»¥ååªè¦æˆ‘ä»¬ä¸å‡çº§ç¬¬ä¸‰æ–¹åŒ…çš„æ—¶å€™ï¼Œé‚£ä¹ˆwebpackå°±ä¸ä¼šå¯¹è¿™äº›åº“å»æ‰“åŒ…ï¼Œè¿™æ ·çš„å¯ä»¥å¿«é€Ÿçš„æé«˜æ‰“åŒ…çš„é€Ÿåº¦ã€‚å› æ­¤ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒDllPlugin å’Œ DllReferencePluginæ’ä»¶å°±äº§ç”Ÿäº†ã€‚ é‚£ä¹ˆå¯¹äºç›®å‰webpackç¤¾åŒºæ¥è®²ï¼Œæˆ‘ä»¬å¸Œæœ›å’Œè‡ªå·±ç¼–å†™çš„ä»£ç åˆ†ç¦»å¼€çš„è¯ï¼Œwebpackç¤¾åŒºæä¾›äº†2ç§æ–¹æ¡ˆï¼š1. CommonsChunkPlugin2. DLLPlugin CommonsChunkPlugin æ’ä»¶æ¯æ¬¡æ‰“åŒ…çš„æ—¶å€™è¿˜æ˜¯ä¼šå»å¤„ç†ä¸€äº›ç¬¬ä¸‰æ–¹ä¾èµ–åº“ï¼Œåªæ˜¯å®ƒèƒ½æŠŠç¬¬ä¸‰æ–¹åº“æ–‡ä»¶å’Œæˆ‘ä»¬çš„ä»£ç åˆ†å¼€æ‰ï¼Œç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„jsæ–‡ä»¶ã€‚ä½†æ˜¯å®ƒè¿˜æ˜¯ä¸èƒ½æé«˜æ‰“åŒ…çš„é€Ÿåº¦ã€‚ DLLPlugin å®ƒèƒ½æŠŠç¬¬ä¸‰æ–¹åº“ä»£ç åˆ†ç¦»å¼€ï¼Œå¹¶ä¸”æ¯æ¬¡æ–‡ä»¶æ›´æ”¹çš„æ—¶å€™ï¼Œå®ƒåªä¼šæ‰“åŒ…è¯¥é¡¹ç›®è‡ªèº«çš„ä»£ç ã€‚æ‰€ä»¥æ‰“åŒ…é€Ÿåº¦ä¼šæ›´å¿«ã€‚ DllPluginçš„ä½œç”¨DLLPluginè¿™ä¸ªæ’ä»¶æ˜¯åœ¨ä¸€ä¸ªé¢å¤–ç‹¬ç«‹çš„webpackè®¾ç½®ä¸­åˆ›å»ºä¸€ä¸ªåªæœ‰dllçš„bundleï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹é™¤äº†æœ‰webpack.config.jsï¼Œè¿˜ä¼šæ–°å»ºä¸€ä¸ªwebpack.dll.config.jsæ–‡ä»¶ã€‚webpack.dll.config.jsä½œç”¨æ˜¯æŠŠæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“ä¾èµ–æ‰“åŒ…åˆ°ä¸€ä¸ªbundleçš„dllæ–‡ä»¶é‡Œé¢ï¼Œè¿˜ä¼šç”Ÿæˆä¸€ä¸ªåä¸º manifest.jsonæ–‡ä»¶ã€‚è¯¥manifest.jsonçš„ä½œç”¨æ˜¯ç”¨æ¥è®© DllReferencePlugin æ˜ å°„åˆ°ç›¸å…³çš„ä¾èµ–ä¸Šå»çš„ã€‚ DllReferencePluginè¿™ä¸ªæ’ä»¶æ˜¯åœ¨webpack.config.jsä¸­ä½¿ç”¨çš„ï¼Œè¯¥æ’ä»¶çš„ä½œç”¨æ˜¯æŠŠåˆšåˆšåœ¨webpack.dll.config.jsä¸­æ‰“åŒ…ç”Ÿæˆçš„dllæ–‡ä»¶å¼•ç”¨åˆ°éœ€è¦çš„é¢„ç¼–è¯‘çš„ä¾èµ–ä¸Šæ¥ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´åœ¨webpack.dll.config.jsä¸­æ‰“åŒ…åæ¯”å¦‚ä¼šç”Ÿæˆ vendor.dll.jsæ–‡ä»¶å’Œvendor-manifest.jsonæ–‡ä»¶ï¼Œvendor.dll.jsæ–‡ä»¶åŒ…å«æ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶ï¼Œvendor-manifest.jsonæ–‡ä»¶ä¼šåŒ…å«æ‰€æœ‰åº“ä»£ç çš„ä¸€ä¸ªç´¢å¼•ï¼Œå½“åœ¨ä½¿ç”¨webpack.config.jsæ–‡ä»¶æ‰“åŒ…DllReferencePluginæ’ä»¶çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨è¯¥DllReferencePluginæ’ä»¶è¯»å–vendor-manifest.jsonæ–‡ä»¶ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰è¯¥ç¬¬ä¸‰æ–¹åº“ã€‚vendor-manifest.jsonæ–‡ä»¶å°±æ˜¯æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“çš„ä¸€ä¸ªæ˜ å°„è€Œå·²ã€‚ æ‰€ä»¥è¯´ ç¬¬ä¸€æ¬¡ä½¿ç”¨ webpack.dll.config.js æ–‡ä»¶ä¼šå¯¹ç¬¬ä¸‰æ–¹åº“æ‰“åŒ…ï¼Œæ‰“åŒ…å®Œæˆåå°±ä¸ä¼šå†æ‰“åŒ…å®ƒäº†ï¼Œç„¶åæ¯æ¬¡è¿è¡Œ webpack.config.jsæ–‡ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šæ‰“åŒ…é¡¹ç›®ä¸­æœ¬èº«çš„æ–‡ä»¶ä»£ç ï¼Œå½“éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¾èµ–çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ DllReferencePluginæ’ä»¶å»è¯»å–ç¬¬ä¸‰æ–¹ä¾èµ–åº“ã€‚æ‰€ä»¥è¯´å®ƒçš„æ‰“åŒ…é€Ÿåº¦ä¼šå¾—åˆ°ä¸€ä¸ªå¾ˆå¤§çš„æå‡ã€‚ ##åœ¨é¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨ DllPlugin å’Œ DllReferencePluginï¼Ÿ åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹ä¸‹æˆ‘ä»¬é¡¹ç›®ç°åœ¨çš„æ•´ä¸ªç›®å½•æ¶æ„å¦‚ä¸‹ï¼š 1234567891011121314151617### ç›®å½•ç»“æ„å¦‚ä¸‹ï¼šdemo1 # å·¥ç¨‹å| |--- dist # æ‰“åŒ…åç”Ÿæˆçš„ç›®å½•æ–‡ä»¶ | |--- node_modules # æ‰€æœ‰çš„ä¾èµ–åŒ…| |--- js # å­˜æ”¾æ‰€æœ‰jsæ–‡ä»¶| | |-- demo1.js | | |-- main.js # jså…¥å£æ–‡ä»¶| |--- webpack.config.js # webpacké…ç½®æ–‡ä»¶| |--- webpack.dll.config.js # æ‰“åŒ…ç¬¬ä¸‰æ–¹ä¾èµ–çš„åº“æ–‡ä»¶| |--- index.html # htmlæ–‡ä»¶| |--- styles # å­˜æ”¾æ‰€æœ‰çš„cssæ ·å¼æ–‡ä»¶ | | |-- main.styl # main.stylæ–‡ä»¶ | | |-- index.styl | |--- .gitignore | |--- README.md| |--- package.json| |--- .babelrc # babelè½¬ç æ–‡ä»¶ å› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨æˆ‘ä»¬çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª webpack.dll.config.js æ–‡ä»¶ã€‚ç„¶åé…ç½®ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637const path = require('path');const DllPlugin = require('webpack/lib/DllPlugin');module.exports = &#123; // å…¥å£æ–‡ä»¶ entry: &#123; // é¡¹ç›®ä¸­ç”¨åˆ°è¯¥ä¸¤ä¸ªä¾èµ–åº“æ–‡ä»¶ jquery: ['jquery'], echarts: ['echarts'] &#125;, // è¾“å‡ºæ–‡ä»¶ output: &#123; // æ–‡ä»¶åç§° filename: '[name].dll.js', // å°†è¾“å‡ºçš„æ–‡ä»¶æ”¾åˆ°distç›®å½•ä¸‹ path: path.resolve(__dirname, 'dist'), /* å­˜æ”¾ç›¸å…³çš„dllæ–‡ä»¶çš„å…¨å±€å˜é‡åç§°ï¼Œæ¯”å¦‚å¯¹äºjqueryæ¥è¯´çš„è¯å°±æ˜¯ _dll_jquery, åœ¨å‰é¢åŠ  _dll æ˜¯ä¸ºäº†é˜²æ­¢å…¨å±€å˜é‡å†²çªã€‚ */ library: '_dll_[name]' &#125;, plugins: [ // ä½¿ç”¨æ’ä»¶ DllPlugin new DllPlugin(&#123; /* è¯¥æ’ä»¶çš„nameå±æ€§å€¼éœ€è¦å’Œ output.libraryä¿å­˜ä¸€è‡´ï¼Œè¯¥å­—æ®µå€¼ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºçš„ manifest.jsonæ–‡ä»¶ä¸­nameå­—æ®µçš„å€¼ã€‚ æ¯”å¦‚åœ¨jquery.manifestæ–‡ä»¶ä¸­æœ‰ name: '_dll_jquery' */ name: '_dll_[name]', /* ç”Ÿæˆmanifestæ–‡ä»¶è¾“å‡ºçš„ä½ç½®å’Œæ–‡ä»¶åç§° */ path: path.join(__dirname, 'dist', '[name].manifest.json') &#125;) ]a&#125;; DllPlugin æ’ä»¶æœ‰ä¸‰ä¸ªé…ç½®é¡¹å‚æ•°å¦‚ä¸‹ï¼šcontext(å¯é€‰)ï¼š manifestæ–‡ä»¶ä¸­è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼Œé»˜è®¤ä¸ºè¯¥webpackæ–‡ä»¶ä¸Šä¸‹æ–‡ã€‚name: å…¬å¼€çš„dllå‡½æ•°çš„åç§°ï¼Œå’Œ output.libraryä¿æŒä¸€è‡´ã€‚path: manifest.json ç”Ÿæˆæ–‡ä»¶çš„ä½ç½®å’Œæ–‡ä»¶åç§°ã€‚ ä¸‹é¢æˆ‘ä»¬ç»§ç»­çœ‹ä¸‹ webpack.config.js é…ç½®ä»£ç å¦‚ä¸‹ï¼š é¦–å…ˆå¼•å…¥æ–‡ä»¶å¦‚ä¸‹ä»£ç ï¼š 12// å¼•å…¥ DllReferencePluginconst DllReferencePlugin = require('webpack/lib/DllReferencePlugin'); ç„¶ååœ¨æ’ä»¶ä¸­ä½¿ç”¨è¯¥æ’ä»¶ï¼Œå¦‚ä¸‹ä»£ç ï¼š 12345678910111213module.exports = &#123; plugins: [ // å‘Šè¯‰webpackä½¿ç”¨äº†å“ªäº›ç¬¬ä¸‰æ–¹åº“ä»£ç  new DllReferencePlugin(&#123; // jquery æ˜ å°„åˆ°jsonæ–‡ä»¶ä¸Šå» manifest: require('./dist/jquery.manifest.json') &#125;), new DllReferencePlugin(&#123; // echarts æ˜ å°„åˆ°jsonæ–‡ä»¶ä¸Šå» manifest: require('./dist/echarts.manifest.json') &#125;) ]&#125; DllReferencePluginé¡¹çš„å‚æ•°æœ‰å¦‚ä¸‹ï¼š context: manifestæ–‡ä»¶ä¸­è¯·æ±‚çš„ä¸Šä¸‹æ–‡ã€‚manifest: ç¼–è¯‘æ—¶çš„ä¸€ä¸ªç”¨äºåŠ è½½çš„JSONçš„manifestçš„ç»å¯¹è·¯å¾„ã€‚context: è¯·æ±‚åˆ°æ¨¡å—idçš„æ˜ å°„(é»˜è®¤å€¼ä¸º manifest.content)name: dllæš´éœ²çš„åœ°æ–¹çš„åç§°(é»˜è®¤å€¼ä¸ºmanifest.name)scope: dllä¸­å†…å®¹çš„å‰ç¼€ã€‚sourceType: dllæ˜¯å¦‚ä½•æš´éœ²çš„libraryTargetã€‚ webpack.config.js æ‰€æœ‰ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114const path = require('path');// æå–cssçš„æ’ä»¶const ExtractTextPlugin = require('extract-text-webpack-plugin');// æ¸…é™¤distç›®å½•ä¸‹çš„æ–‡ä»¶// const ClearWebpackPlugin = require('clean-webpack-plugin');const webpack = require('webpack');// å¼•å…¥æ‰“åŒ…htmlæ–‡ä»¶const HtmlWebpackPlugin = require('html-webpack-plugin');// å¼•å…¥ DllReferencePluginconst DllReferencePlugin = require('webpack/lib/DllReferencePlugin');module.exports = &#123; // å…¥å£æ–‡ä»¶ entry: &#123; main: './js/main.js' &#125;, output: &#123; filename: '[name].js', // å°†è¾“å‡ºçš„æ–‡ä»¶éƒ½æ”¾åœ¨distç›®å½•ä¸‹ path: path.resolve(__dirname, 'dist') &#125;, module: &#123; rules: [ &#123; // ä½¿ç”¨æ­£åˆ™å»åŒ¹é… test: /\\.styl$/, use: ExtractTextPlugin.extract(&#123; fallback: &#123; loader: 'style-loader' &#125;, use: [ &#123; loader: 'css-loader', options: &#123;&#125; &#125;, &#123; loader: 'postcss-loader', options: &#123; ident: 'postcss', plugins: [ require('postcss-cssnext')(), require('cssnano')(), require('postcss-pxtorem')(&#123; rootValue: 16, unitPrecision: 5, propWhiteList: [] &#125;), require('postcss-sprites')() ] &#125; &#125;, &#123; loader: 'stylus-loader', options: &#123;&#125; &#125; ] &#125;) &#125;, &#123; test: /\\.(png|jpg)$/, loader: 'url-loader', options: &#123; limit: 10000, name: '[name].[ext]' &#125; &#125;, &#123; test: /\\.js$/, exclude: path.resolve(__dirname, 'node_modules'), // æ’é™¤æ–‡ä»¶ loader: 'babel-loader' &#125; ] &#125;, resolve: &#123; extensions: ['*', '.js', '.json'] &#125;, devtool: 'cheap-module-eval-source-map', devServer: &#123; // contentBase: path.join(__dirname, \"dist\"), port: 8081, host: '0.0.0.0', headers: &#123; 'X-foo': '112233' &#125;, // hot: true, inline: true, // open: true, overlay: true, stats: 'errors-only' &#125;, plugins: [ // new ClearWebpackPlugin(['dist']), new HtmlWebpackPlugin(&#123; template: './index.html' // æ¨¡ç‰ˆæ–‡ä»¶ &#125;), new ExtractTextPlugin(&#123; // ä»jsæ–‡ä»¶ä¸­æå–å‡ºæ¥çš„ .cssæ–‡ä»¶çš„åç§° filename: `main.css` &#125;), // å‘Šè¯‰webpackä½¿ç”¨äº†å“ªäº›ç¬¬ä¸‰æ–¹åº“ä»£ç  new DllReferencePlugin(&#123; // jquery æ˜ å°„åˆ°jsonæ–‡ä»¶ä¸Šå» manifest: require('./dist/jquery.manifest.json') &#125;), new DllReferencePlugin(&#123; // echarts æ˜ å°„åˆ°jsonæ–‡ä»¶ä¸Šå» manifest: require('./dist/echarts.manifest.json') &#125;) ]&#125;; æ‰§è¡Œæ„å»ºï¼š æœ€åä¸€æ­¥å°±æ˜¯æ„å»ºä»£ç äº†ï¼Œå…ˆç”Ÿå­˜ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 1webpack --config webpack.dll.config.js ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨package.jsonä¸­scriptsåŠ å¦‚ä¸‹ä»£ç äº†ï¼š 12345\"scripts\": &#123; \"dev\": \"webpack-dev-server --progress --colors --devtool cheap-module-eval-source-map --hot --inline\", \"build\": \"webpack --progress --colors --devtool cheap-module-source-map\", \"build:dll\": \"webpack --config webpack.dll.config.js\"&#125;, æ‰€ä»¥æˆ‘ä»¬å…ˆè¿è¡Œ npm run build:dll å‘½ä»¤ï¼Œè¿è¡Œå®Œæˆåï¼Œä¼šåœ¨distç›®å½•ä¸‹ç”Ÿå­˜ echarts.dll.js, echarts.manifest.json,jquery.dll.js, jquery.manifest.json æ–‡ä»¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å†çœ‹ä¸‹æ‰“åŒ…ä¸¤ä¸ªåº“æ‰§è¡Œçš„æ—¶é—´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š xx.dll.js æ–‡ä»¶ä»£ç å¤§æ¦‚å¦‚ä¸‹è¿™ä¸ªæ ·å­ï¼Œæ¯”å¦‚echarts.dll.js ä»£ç ä¸ºä¾‹ï¼š 1234567891011var _dll_echarts = (function(modules) &#123; // ... æ­¤å¤„çœç•¥ webpackBootstrap å‡½æ•°ä»£ç &#125;([ (function(module, exports, __webpack_require__) &#123; // IDä¸º0æ¨¡å—å¯¹åº”çš„ä»£ç  &#125;), (function(module, exports, __webpack_require__) &#123; // IDä¸º1æ¨¡å—å¯¹åº”çš„ä»£ç  &#125;), // ....... å¾ˆå¤šæ¨¡å—ä»£ç ])); é‚£ä¹ˆ echarts.manifest.json ç”Ÿå­˜çš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718&#123; \"name\": \"_dll_echarts\", \"content\": &#123; \"./node_modules/zrender/lib/core/util.js\": &#123; \"id\": 0, \"meta\": &#123;&#125; &#125;, \"./node_modules/echarts/lib/echarts.js\": &#123; \"id\": 1, \"meta\": &#123;&#125; &#125;, \"./node_modules/echarts/lib/util/graphic.js\": &#123; \"id\": 2, \"meta\": &#123;&#125; &#125;, // ..... &#125;&#125; echarts.manifest.json æ–‡ä»¶å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ä¸å…¶å¯¹åº”çš„dll.jsæ–‡ä»¶ä¸­åŒ…å«äº†å“ªäº›æ¨¡å—ï¼Œä»¥åŠæ¯ä¸ªæ¨¡å—çš„è·¯å¾„å’ŒIDã€‚ å¦‚ä¸Šæ‰“åŒ…å®Œåº“æ–‡ä»¶åï¼Œæˆ‘ä»¬éœ€è¦ è¿è¡Œ npm run buildå‘½ä»¤æ‰“åŒ…é¡¹ç›®ä¸­æ–‡ä»¶äº†ï¼Œå¦‚ä¸‹distç›®å½•åçš„æ–‡ä»¶ ç„¶åæˆ‘ä»¬æŸ¥çœ‹index.htmlä»£ç å¦‚ä¸‹ï¼š 123456789101112&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Title&lt;/title&gt;&lt;link href=\"main.css\" rel=\"stylesheet\"&gt;&lt;/head&gt;&lt;body&gt; &lt;div id=\"app\"&gt;22222&lt;/div&gt; &lt;div class=\"test1\"&gt;12aaa&lt;/div&gt; &lt;div class='test2'&gt;vvvvv&lt;/div&gt;&lt;script type=\"text/javascript\" src=\"main.js\"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¯ä»¥çœ‹åˆ°jqueryæ–‡ä»¶æ²¡æœ‰è‡ªåŠ¨åŠ ä¸Šï¼Œå› æ­¤éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨åŠ ä¸Šï¼ŒåŠ ä¸Šåä»£ç å˜æˆå¦‚ä¸‹ï¼š 12345678910111213&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Title&lt;/title&gt;&lt;link href=\"main.css\" rel=\"stylesheet\"&gt;&lt;/head&gt;&lt;body&gt; &lt;div id=\"app\"&gt;22222&lt;/div&gt; &lt;div class=\"test1\"&gt;12aaa&lt;/div&gt; &lt;div class='test2'&gt;vvvvv&lt;/div&gt;&lt;script type=\"text/javascript\" src=\"jquery.dll.js\"&gt;&lt;/script&gt;&lt;script type=\"text/javascript\" src=\"main.js\"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; åŠ ä¸Šjquery.dll.jsæ–‡ä»¶åï¼Œmain.jså…¥å£æ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š 1234567require('../styles/main.styl');const $ = require('jquery');$('#app').html('æ¬¢è¿ä½ æ¥æˆ‘çš„åšå®¢');console.log('è¿™æ˜¯main.js');require('./demo1.js'); $(â€˜#appâ€™) å°±å¯ä»¥æ“ä½œå…ƒç´ äº†ã€‚ githubä¸ŠæŸ¥çœ‹demo ##DllPlugin DllReferencePluginä½¿ç”¨åœ¨vueå’Œvuexé¡¹ç›®ä¸­ é¦–å…ˆvuex-demoä»£ç å¯ä»¥æŸ¥çœ‹githubä¸Šçš„ä»£ç äº†ã€‚ç„¶åæˆ‘ä»¬åœ¨æ²¡æœ‰ä½¿ç”¨ DllPlugin æ’ä»¶æ—¶å€™ï¼Œæ‰“åŒ…çš„é€Ÿåº¦å¦‚ä¸‹ï¼Œä½¿ç”¨äº†åå‡ ç§’ï¼š githubæŸ¥çœ‹demo é¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹æˆ‘ä»¬çš„å…¥å£æ–‡ä»¶ src/business/examine/app.jsï¼Œå¼•å…¥æˆ‘ä»¬æ‰€å®‰è£…çš„é™æ€èµ„æºï¼Œç»“æœä¸ºï¼š 12345678910111213141516171819202122232425262728import Vue from 'vue';import VueRouter from 'vue-router';import VueResource from 'vue-resource';import App from './base/main';import routerConfig from './router';import store from './store';// ä¸»é¢˜æ ·å¼import '../../components/common/common.styl';Vue.config.devtools = true;// RouterVue.use(VueRouter);// ResourceVue.use(VueResource);// é…ç½® resourceVue.http.options.root = '';Vue.http.options.emulateJSON = true;const router = routerConfig(VueRouter);new Vue(Vue.util.extend(&#123; router, store&#125;, App)).$mount('#app'); åœ¨storeæ–‡ä»¶å†…ç”¨åˆ°äº†vuexï¼Œå¦‚ä¸‹ä»£ç ï¼š 1234567891011121314import Vue from 'vue';import Vuex from 'vuex';import state from './state';import mutations from './mutations';import actions from './actions';Vue.use(Vuex);export default new Vuex.Store(&#123; state, mutations, actions&#125;); å¦‚ä¸Šä»£ç æˆ‘ä»¬æŠŠvueå’Œvue-router,vue-resourceï¼Œvuexä¸€èµ·æ‰“åŒ…çš„ã€‚å¦‚ä¸Šåªæ˜¯ç”¨åˆ°ä¸€äº›vueå¸¸è§çš„æ’ä»¶ï¼Œè¿˜æ²¡æœ‰ä½¿ç”¨å¾ˆå¤šå…¶ä»–çš„æ’ä»¶ï¼Œå°±è€—æ—¶äº†åå‡ ç§’çš„æ—¶é—´ï¼Œå¦‚æœæ’ä»¶æ›´å¤šçš„è¯ï¼Œé‚£ä¹ˆç›¸å¯¹æ¥è¯´è€—æ—¶æ›´é•¿ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬å¸Œæœ›æŠŠ vueï¼Œvuex, vue-router, vue-resourceè¿™æ ·çš„åœ¨ webpack.dll.config.jsä¸­è¿›è¡Œæ‰“åŒ…ï¼Œç„¶åå†ä½¿ç”¨webpack.config.jsæ‰“åŒ…æœ¬é¡¹ç›®ä¸­çš„æ–‡ä»¶ä»£ç ï¼›è¿˜æ˜¯å’Œä¸Šé¢ä¸€æ ·åœ¨é¡¹ç›®ä¸­æ ¹ç›®å½•ä¸‹æ–°å»º webpack.dll.config.jsï¼Œæˆ‘æŠŠæ‰“åŒ…æ–‡ä»¶ç»Ÿä¸€éƒ½æ”¾åˆ°buildæ–‡ä»¶å†…ï¼Œé…ç½®ä»£ç å¦‚ä¸‹ï¼š é…ç½®å…¥å£æ–‡ä»¶ä»£ç ï¼š 12345678910111213141516171819module.exports = &#123; entry: &#123; // é¡¹ç›®ä¸­ç”¨åˆ°è¯¥ä¾èµ–åº“æ–‡ä»¶ vendor: ['vue/dist/vue.esm.js', 'vue', 'vuex', 'vue-router', 'vue-resource'] &#125;, plugins: [ // ä½¿ç”¨æ’ä»¶ DllPlugin new DllPlugin(&#123; /* è¯¥æ’ä»¶çš„nameå±æ€§å€¼éœ€è¦å’Œ output.libraryä¿å­˜ä¸€è‡´ï¼Œè¯¥å­—æ®µå€¼ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºçš„ manifest.jsonæ–‡ä»¶ä¸­nameå­—æ®µçš„å€¼ã€‚ æ¯”å¦‚åœ¨jquery.manifestæ–‡ä»¶ä¸­æœ‰ name: '_dll_jquery' */ name: '_dll_[name]', /* ç”Ÿæˆmanifestæ–‡ä»¶è¾“å‡ºçš„ä½ç½®å’Œæ–‡ä»¶åç§° */ path: path.resolve(__dirname, paths.dist, '[name].manifest.json') &#125;) ]&#125; webpack.config.js é…ç½®ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š 123456789101112// å¼•å…¥ DllReferencePluginconst DllReferencePlugin = require('webpack/lib/DllReferencePlugin');module.exports = &#123; plugins: [ // å‘Šè¯‰webpackä½¿ç”¨äº†å“ªäº›ç¬¬ä¸‰æ–¹åº“ä»£ç  new DllReferencePlugin(&#123; // jquery æ˜ å°„åˆ°jsonæ–‡ä»¶ä¸Šå» manifest: require(path.resolve(__dirname, paths.dist, 'vendor.manifest.json')) &#125;), ]&#125; ç„¶åè¿è¡Œæ‰“åŒ… npm run build åï¼Œæ‰“åŒ…çš„æ—¶é—´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°æ²¡æœ‰ä½¿ç”¨ DllPlugin DllReferencePlugin æ‰“åŒ…å‰ï¼Œæ‰“åŒ…çš„æ—¶é—´éœ€è¦12.5ç§’ï¼Œä½¿ç”¨äº†è¯¥æ’ä»¶åï¼Œä»…ä»…éœ€è¦4ç§’çš„æ—¶é—´ï¼Œå¯è§æé«˜äº†8ç§’çš„æ‰“åŒ…æ—¶é—´ã€‚å¹¶ä¸”åˆ†äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‰€æœ‰ç›¸å…³çš„vueçš„ä¾èµ–éƒ½æ”¾åœ¨äº†vendor.dll.jså†…ï¼Œæˆ‘ä»¬é¡¹ç›®ä¸Šç›¸å…³çš„ä»£ç æ”¾åœ¨äº†bundle.jså†…ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘ä¸€ä¸ªjsæ–‡ä»¶éå¸¸å¤§çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨é¡µé¢ä¸Šéœ€è¦å¼•ç”¨ vendor.dll.js æ–‡ä»¶äº†ã€‚","categories":[{"name":"å‰ç«¯å·¥å…·","slug":"å‰ç«¯å·¥å…·","permalink":"http://yoursite.com/categories/å‰ç«¯å·¥å…·/"}],"tags":[{"name":"webpack","slug":"webpack","permalink":"http://yoursite.com/tags/webpack/"}]},{"title":"Htmlæ ‡ç­¾é»˜è®¤å±æ€§æ ·å¼åŠæµè§ˆå™¨é»˜è®¤æ ·å¼","slug":"Htmlæ ‡ç­¾é»˜è®¤å±æ€§æ ·å¼åŠæµè§ˆå™¨é»˜è®¤æ ·å¼","date":"2020-03-14T06:20:32.000Z","updated":"2020-04-03T06:15:57.271Z","comments":true,"path":"2020/03/14/Htmlæ ‡ç­¾é»˜è®¤å±æ€§æ ·å¼åŠæµè§ˆå™¨é»˜è®¤æ ·å¼/","link":"","permalink":"http://yoursite.com/2020/03/14/Htmlæ ‡ç­¾é»˜è®¤å±æ€§æ ·å¼åŠæµè§ˆå™¨é»˜è®¤æ ·å¼/","excerpt":"","text":"htmlæ ‡ç­¾é»˜è®¤å±æ€§æ ·å¼åŠæµè§ˆå™¨é»˜è®¤æ ·å¼å…·æœ‰é»˜è®¤æ ·å¼çš„htmlæ ‡ç­¾ html address blockquote body dd div dl dt fieldset form frame frameset h1 h2 H3 h4 h5 h6 noframes ol p ul center dir hr menu pre ä»¥ä¸Šåˆ—è¡¨å…ƒç´ é»˜è®¤çŠ¶æ€ä¸‹ä»¥å—çŠ¶æ˜¾ç¤ºï¼Œæœªæ˜¾ç¤ºçš„å°†ä»¥å†…è”å…ƒç´ æ˜¾ç¤ºï¼Œè¯¥åˆ—è¡¨é’ˆå¯¹HTML4ç‰ˆæœ¬ï¼Œéƒ¨åˆ†å…ƒç´ åœ¨XHTML1ä¸­å°†åºŸå¼ƒ 12345678910111213141516171819202122232425262728293031323334353637383940li &#123;display: list-item &#125;`/*é»˜è®¤ä»¥åˆ—è¡¨æ˜¾ç¤º*/`head &#123;display: none &#125;/*é»˜è®¤ä¸æ˜¾ç¤º*/table &#123;display: table &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼æ˜¾ç¤º*/tr &#123;display: table-row &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼è¡Œæ˜¾ç¤º*/thead &#123;display: table-header-group &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼å¤´éƒ¨åˆ†ç»„æ˜¾ç¤º*/tbody &#123;display: table-row-group &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼è¡Œåˆ†ç»„æ˜¾ç¤º*/tfoot &#123;display: table-footer-group &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼åº•éƒ¨åˆ†ç»„æ˜¾ç¤º*/col &#123;display: table-column &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼åˆ—æ˜¾ç¤º*/colgroup &#123;display: table-column-group &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼åˆ—åˆ†ç»„æ˜¾ç¤º*/td, th &#123; display:table-cell; &#125;/*é»˜è®¤ä¸ºå•å…ƒæ ¼æ˜¾ç¤º*/caption &#123;display: table-caption &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼æ ‡é¢˜æ˜¾ç¤º*/th &#123;font-weight: bolder; text-align: center &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼æ ‡é¢˜æ˜¾ç¤ºï¼Œå‘ˆç°åŠ ç²—å±…ä¸­çŠ¶æ€*/caption &#123;text-align: center &#125;/*é»˜è®¤ä¸ºè¡¨æ ¼æ ‡é¢˜æ˜¾ç¤ºï¼Œå‘ˆç°å±…ä¸­çŠ¶æ€*/body &#123;margin: 8px; line-height: 1.12 &#125;h1 &#123;font-size: 2em; margin: .67em 0 &#125;h2 &#123;font-size: 1.5em; margin: .75em 0 &#125;h3 &#123;font-size: 1.17em; margin: .83em 0 &#125;h4, p,blockquote, ul, fieldset, form, ol, dl, dir, menu &#123; margin: 1.12em 0 &#125;h5 &#123;font-size: .83em; margin: 1.5em 0 &#125;h6 &#123;font-size: .75em; margin: 1.67em 0 &#125;h1, h2,h3, h4, h5, h6, b,strong &#123; font-weight: bolder &#125;blockquote&#123; margin-left: 40px; margin-right: 40px &#125;i, cite,em,var, address &#123; font-style: italic &#125;pre, tt,code, kbd, samp &#123; font-family: monospace &#125;pre &#123;white-space: pre &#125;button,textarea, input, object, select &#123; display:inline-block; &#125;big &#123;font-size: 1.17em &#125;small,sub, sup &#123; font-size: .83em &#125;sub &#123;vertical-align: sub &#125;/*å®šä¹‰subå…ƒç´ é»˜è®¤ä¸ºä¸‹æ ‡æ˜¾ç¤º*/sup &#123;vertical-align: super &#125;/*å®šä¹‰subå…ƒç´ é»˜è®¤ä¸ºä¸Šæ ‡æ˜¾ç¤º*/table &#123;border-spacing: 2px; &#125;thead,tbody, tfoot &#123; vertical-align: middle &#125;/*å®šä¹‰è¡¨å¤´ã€ä¸»ä½“è¡¨ã€è¡¨è„šå…ƒç´ é»˜è®¤ä¸ºå‚ç›´å¯¹é½*/td, th &#123;vertical-align: inherit &#125;/*å®šä¹‰å•å…ƒæ ¼ã€åˆ—æ ‡é¢˜é»˜è®¤ä¸ºå‚ç›´å¯¹é½é»˜è®¤ä¸ºç»§æ‰¿*/s, strike,del &#123; text-decoration: line-through &#125;/*å®šä¹‰è¿™äº›å…ƒç´ é»˜è®¤ä¸ºåˆ é™¤çº¿æ˜¾ç¤º*/hr &#123;border: 1px inset &#125;/*å®šä¹‰åˆ†å‰²çº¿é»˜è®¤ä¸º1pxå®½çš„3Då‡¹è¾¹æ•ˆæœ*/ol, ul,dir, menu, dd &#123; margin-left: 40px &#125;ol &#123;list-style-type: decimal &#125;ol ul, ulol, ul ul, ol ol &#123; margin-top: 0; margin-bottom: 0 &#125;u, ins &#123;text-decoration: underline &#125;br:before&#123; content: \"\"A\" &#125;/*å®šä¹‰æ¢è¡Œå…ƒç´ çš„ä¼ªå¯¹è±¡å†…å®¹æ ·å¼*/ 123456789101112131415:before,:after &#123; white-space: pre-line &#125;/*å®šä¹‰ä¼ªå¯¹è±¡ç©ºæ ¼å­—ç¬¦çš„é»˜è®¤æ ·å¼*/center &#123;text-align: center &#125;abbr,acronym &#123; font-variant: small-caps; letter-spacing: 0.1em &#125;:link,:visited &#123; text-decoration: underline &#125;:focus &#123;outline: thin dotted invert &#125;/* Beginbidirectionality settings (do not change) */BDO[DIR=\"ltr\"]&#123; direction: ltr; unicode-bidi: bidi-override &#125;/*å®šä¹‰BDOå…ƒç´ å½“å…¶å±æ€§ä¸ºDIR=\"ltr\"æ—¶çš„é»˜è®¤æ–‡æœ¬è¯»å†™æ˜¾ç¤ºé¡ºåº*/BDO[DIR=\"rtl\"]&#123; direction: rtl; unicode-bidi: bidi-override &#125;/*å®šä¹‰BDOå…ƒç´ å½“å…¶å±æ€§ä¸ºDIR=\"rtl\"æ—¶çš„é»˜è®¤æ–‡æœ¬è¯»å†™æ˜¾ç¤ºé¡ºåº*/*[DIR=\"ltr\"]&#123; direction: ltr; unicode-bidi: embed &#125;/*å®šä¹‰ä»»ä½•å…ƒç´ å½“å…¶å±æ€§ä¸ºDIR=\"ltr\"æ—¶çš„é»˜è®¤æ–‡æœ¬è¯»å†™æ˜¾ç¤ºé¡ºåº*/*[DIR=\"rtl\"]&#123; direction: rtl; unicode-bidi: embed &#125;/*å®šä¹‰ä»»ä½•å…ƒç´ å½“å…¶å±æ€§ä¸ºDIR=\"rtl\"æ—¶çš„é»˜è®¤æ–‡æœ¬è¯»å†™æ˜¾ç¤ºé¡ºåº*/@mediaprint &#123; /*å®šä¹‰æ ‡é¢˜å’Œåˆ—è¡¨é»˜è®¤çš„æ‰“å°æ ·å¼*/h1 &#123;page-break-before: always &#125;h1, h2,h3, h4, h5, h6 &#123; page-break-after: avoid &#125;ul, ol, dl&#123; page-break-before: avoid &#125;&#125; æµè§ˆå™¨é»˜è®¤æ ·å¼é¡µè¾¹è· IEé»˜è®¤ä¸º10pxï¼Œé€šè¿‡bodyçš„marginå±æ€§è®¾ç½® FFé»˜è®¤ä¸º8pxï¼Œé€šè¿‡bodyçš„paddingå±æ€§è®¾ç½® è¦æ¸…é™¤é¡µè¾¹è·ä¸€å®šè¦æ¸…é™¤è¿™ä¸¤ä¸ªå±æ€§å€¼ 1234body &#123; margin:0; padding:0;&#125; æ®µé—´è· IEé»˜è®¤ä¸º19pxï¼Œé€šè¿‡pçš„margin-topå±æ€§è®¾ç½® FFé»˜è®¤ä¸º1.12emï¼Œé€šè¿‡pçš„margin-bottomå±æ€§è®¾ pé»˜è®¤ä¸ºå—çŠ¶æ˜¾ç¤ºï¼Œè¦æ¸…é™¤æ®µé—´è·ï¼Œä¸€èˆ¬å¯ä»¥è®¾ç½® 1234p &#123; margin-top:0; margin-bottom:0;&#125; æ ‡é¢˜æ ·å¼h1~h6é»˜è®¤åŠ ç²—æ˜¾ç¤ºï¼šfont-weight:bold;ã€‚é»˜è®¤å¤§å°è¯·å‚ä¸Šè¡¨ 123456h1&#123;font-size:xx-large;&#125;h2&#123;font-size:x-large;&#125;h3&#123;font-size:large;&#125;h4&#123;font-size:medium;&#125;h5&#123;font-size:small;&#125;h6&#123;font-size:x-small;&#125; å„å¤§æµè§ˆå™¨é»˜è®¤å­—ä½“å¤§å°ä¸º16pxï¼Œå³ç­‰äºmediumï¼Œh1~h6å…ƒç´ é»˜è®¤ä»¥å—çŠ¶æ˜¾ç¤ºå­—ä½“æ˜¾ç¤ºä¸ºç²—ä½“ï¼Œè¦æ¸…é™¤æ ‡é¢˜æ ·å¼ï¼Œä¸€èˆ¬å¯ä»¥è®¾ç½® 1234hx &#123; font-weight:normal; font-size:value;&#125; åˆ—è¡¨æ ·å¼ IEé»˜è®¤ä¸º40pxï¼Œé€šè¿‡ulã€olçš„marginå±æ€§è®¾ç½® FFé»˜è®¤ä¸º40pxï¼Œé€šè¿‡ulã€olçš„paddingå±æ€§è®¾ç½® dlæ— ç¼©è¿›ï¼Œä½†èµ·å†…éƒ¨çš„è¯´æ˜å…ƒç´ ddé»˜è®¤ç¼©è¿›40pxï¼Œè€Œåç§°å…ƒç´ dtæ²¡æœ‰ç¼©è¿›ã€‚è¦æ¸…é™¤åˆ—è¡¨æ ·å¼ï¼Œä¸€èˆ¬å¯ä»¥è®¾ç½® 12345ul, ol, dd&#123; list-style-type:none;/*æ¸…æ¥šåˆ—è¡¨æ ·å¼ç¬¦*/ margin-left:0;/*æ¸…æ¥šIEå·¦ç¼©è¿›*/ padding-left:0;/*æ¸…æ¥šéIEå·¦ç¼©è¿›*/&#125; å…ƒç´ å±…ä¸­ IEé»˜è®¤ä¸ºtext-align:center; FFé»˜è®¤ä¸ºmargin-left:auto;margin-right:auto; è¶…é“¾æ¥æ ·å¼a æ ·å¼é»˜è®¤å¸¦æœ‰ä¸‹åˆ’çº¿ï¼Œæ˜¾ç¤ºé¢œè‰²ä¸ºè“è‰²ï¼Œè¢«è®¿é—®è¿‡çš„è¶…é“¾æ¥å˜ç´«è‰²ï¼Œè¦æ¸…é™¤é“¾æ¥æ ·å¼ï¼Œä¸€èˆ¬å¯ä»¥è®¾ç½®ä»£ç å¦‚ä¸‹: 1234a &#123; text-decoration:none; color:#colorname;&#125; é¼ æ ‡æ ·å¼ IEé»˜è®¤ä¸ºcursor:hand; FFé»˜è®¤ä¸ºcursor:pointer;ã€‚è¯¥å£°æ˜åœ¨IEä¸­ä¹Ÿæœ‰æ•ˆ å›¾ç‰‡é“¾æ¥æ ·å¼ IEé»˜è®¤ä¸ºç´«è‰²2pxçš„è¾¹æ¡†çº¿ FFé»˜è®¤ä¸ºè“è‰²2pxçš„è¾¹æ¡†çº¿ è¦æ¸…é™¤å›¾ç‰‡é“¾æ¥æ ·å¼ï¼Œä¸€èˆ¬å¯ä»¥è®¾ç½® 123img &#123; border:0;&#125;","categories":[{"name":"HTML","slug":"HTML","permalink":"http://yoursite.com/categories/HTML/"}],"tags":[{"name":"HTML","slug":"HTML","permalink":"http://yoursite.com/tags/HTML/"}]},{"title":"CSS viewport","slug":"CSS viewport","date":"2020-03-05T07:20:55.000Z","updated":"2020-04-03T03:21:08.780Z","comments":true,"path":"2020/03/05/CSS viewport/","link":"","permalink":"http://yoursite.com/2020/03/05/CSS viewport/","excerpt":"","text":"#viewport é¡µé¢é€‚é…çš„æ ‡ç­¾viewportè¿™ä¸ªæ ‡ç­¾æ˜¯ä»€ä¹ˆä½œç”¨ï¼Ÿmetaå‡ ä¸ªå±æ€§éƒ½æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Ÿuser-scanl=noä¸ç”Ÿæ•ˆæ—¶ï¼Œç”¨jsæ€ä¹ˆæ§åˆ¶è¾¾åˆ°ç¦æ­¢ç¼©æ”¾çš„æ•ˆæœï¼Ÿviewport metaçš„èƒŒæ™¯æµè§ˆå™¨çš„ viewport æ˜¯å¯ä»¥çœ‹åˆ°Webå†…å®¹çš„çª—å£åŒºåŸŸï¼Œé€šå¸¸ä¸æ¸²æŸ“å‡ºçš„é¡µé¢çš„å¤§å°ä¸åŒï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šæä¾›æ»šåŠ¨æ¡ä»¥æ»šåŠ¨è®¿é—®æ‰€æœ‰å†…å®¹ã€‚ çª„å±å¹•è®¾å¤‡ï¼ˆå¦‚ç§»åŠ¨è®¾å¤‡ï¼‰åœ¨ä¸€ä¸ªè™šæ‹Ÿçª—å£æˆ–è§†å£ä¸­æ¸²æŸ“é¡µé¢ï¼Œè¿™ä¸ªçª—å£æˆ–è§†å£é€šå¸¸æ¯”å±å¹•å®½ï¼›ç„¶åç¼©å°æ¸²æŸ“çš„ç»“æœï¼Œä»¥ä¾¿åœ¨ä¸€å±å†…æ˜¾ç¤ºæ‰€æœ‰å†…å®¹ã€‚ç„¶åç”¨æˆ·å¯ä»¥ç§»åŠ¨ã€ç¼©æ”¾ä»¥æŸ¥çœ‹é¡µé¢çš„ä¸åŒåŒºåŸŸã€‚ä¾‹å¦‚ï¼Œå¦‚æœç§»åŠ¨å±å¹•çš„å®½åº¦ä¸º640pxï¼Œåˆ™å¯èƒ½ä¼šç”¨980pxçš„è™šæ‹Ÿè§†å£æ¸²æŸ“é¡µé¢ï¼Œç„¶åç¼©å°é¡µé¢ä»¥é€‚åº”640pxçš„çª—å£å¤§å°ã€‚ è¿™æ ·åšæ˜¯å› ä¸ºè®¸å¤šé¡µé¢æ²¡æœ‰åšç§»åŠ¨ç«¯ä¼˜åŒ–ï¼Œåœ¨å°çª—å£æ¸²æŸ“æ—¶ä¼šä¹±æ‰ï¼ˆæˆ–çœ‹èµ·æ¥ä¹±ï¼‰ã€‚æ‰€ä»¥ï¼Œè¿™ç§è™šæ‹Ÿè§†å£æ˜¯ä¸€ç§è®©æœªåšç§»åŠ¨ç«¯ä¼˜åŒ–çš„ç½‘ç«™åœ¨çª„å±è®¾å¤‡ä¸Šçœ‹èµ·æ¥æ›´å¥½çš„åŠæ³•ã€‚ ä½†æ˜¯ï¼Œå¯¹äºç”¨åª’ä½“æŸ¥è¯¢é’ˆå¯¹çª„å±å¹•åšäº†ä¼˜åŒ–çš„é¡µé¢ï¼Œè¿™ç§æœºåˆ¶ä¸å¤§å¥½ - æ¯”å¦‚å¦‚æœè™šæ‹Ÿè§†å£å®½ 980pxï¼Œé‚£ä¹ˆåœ¨ 640px æˆ– 480px æˆ–æ›´å°å®½åº¦è¦èµ·ä½œç”¨çš„åª’ä½“æŸ¥è¯¢å°±ä¸ä¼šè§¦å‘äº†ï¼Œæµªè´¹äº†è¿™äº›å“åº”å¼è®¾è®¡ã€‚ ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼ŒApple åœ¨ Safari iOS ä¸­å¼•å…¥äº†â€œviewport meta æ ‡ç­¾â€ï¼Œè®©Webå¼€å‘äººå‘˜æ§åˆ¶è§†å£çš„å¤§å°å’Œæ¯”ä¾‹ã€‚å¾ˆå¤šå…¶ä»–ç§»åŠ¨æµè§ˆå™¨ç°åœ¨ä¹Ÿæ”¯æŒæ­¤æ ‡ç­¾ï¼Œä½†å®ƒä¸å±äº Web æ ‡å‡†ã€‚ viewport meta æ ‡ç­¾çš„æ¦‚å¿µç§»åŠ¨è®¾å¤‡ä¸Šçš„viewportå°±æ˜¯è®¾å¤‡çš„å±å¹•ä¸Šèƒ½ç”¨æ¥æ˜¾ç¤ºæˆ‘ä»¬çš„ç½‘é¡µçš„é‚£ä¸€å—åŒºåŸŸï¼Œåœ¨å…·ä½“ä¸€ç‚¹ï¼Œå°±æ˜¯æµè§ˆå™¨ä¸Š(ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªappä¸­çš„webview)ç”¨æ¥æ˜¾ç¤ºç½‘é¡µçš„é‚£éƒ¨åˆ†åŒºåŸŸï¼Œä½†viewportåˆä¸å±€é™äºæµè§ˆå™¨å¯è§†åŒºåŸŸçš„å¤§å°ï¼Œå®ƒå¯èƒ½æ¯”æµè§ˆå™¨çš„å¯è§†åŒºåŸŸè¦å¤§ï¼Œä¹Ÿå¯èƒ½æ¯”æµè§ˆå™¨çš„å¯è§†åŒºåŸŸè¦å°ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€èˆ¬æ¥è®²ï¼Œç§»åŠ¨è®¾å¤‡ä¸Šçš„viewportéƒ½æ˜¯è¦å¤§äºæµè§ˆå™¨å¯è§†åŒºåŸŸçš„ï¼Œè¿™æ˜¯å› ä¸ºè€ƒè™‘åˆ°ç§»åŠ¨è®¾å¤‡çš„åˆ†è¾¨ç‡ç›¸å¯¹äºæ¡Œé¢ç”µè„‘æ¥è¯´éƒ½æ¯”è¾ƒå°ï¼Œæ‰€ä»¥ä¸ºäº†èƒ½åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šæ­£å¸¸æ˜¾ç¤ºé‚£äº›ä¼ ç»Ÿçš„ä¸ºæ¡Œé¢æµè§ˆå™¨è®¾è®¡çš„ç½‘ç«™ï¼Œç§»åŠ¨è®¾å¤‡ä¸Šçš„æµè§ˆå™¨éƒ½ä¼šæŠŠè‡ªå·±é»˜è®¤çš„viewportè®¾ä¸º980pxæˆ–1024pxï¼ˆä¹Ÿå¯èƒ½æ˜¯å…¶å®ƒå€¼ï¼Œè¿™ä¸ªæ˜¯ç”±è®¾å¤‡è‡ªå·±å†³å®šçš„ï¼‰ï¼Œä½†å¸¦æ¥çš„åæœå°±æ˜¯æµè§ˆå™¨ä¼šå‡ºç°æ¨ªå‘æ»šåŠ¨æ¡ï¼Œå› ä¸ºæµè§ˆå™¨å¯è§†åŒºåŸŸçš„å®½åº¦æ˜¯æ¯”è¿™ä¸ªé»˜è®¤çš„viewportçš„å®½åº¦è¦å°çš„ã€‚ä¸‹å›¾åˆ—å‡ºäº†ä¸€äº›è®¾å¤‡ä¸Šæµè§ˆå™¨çš„é»˜è®¤viewportçš„å®½åº¦ã€‚ cssä¸­çš„1pxå¹¶ä¸ç­‰äºè®¾å¤‡çš„1px åœ¨cssä¸­æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨pxä½œä¸ºå•ä½ï¼Œåœ¨æ¡Œé¢æµè§ˆå™¨ä¸­cssçš„1ä¸ªåƒç´ å¾€å¾€éƒ½æ˜¯å¯¹åº”ç€ç”µè„‘å±å¹•çš„1ä¸ªç‰©ç†åƒç´ ï¼Œä½†åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œåœ¨æ—©å…ˆçš„ç§»åŠ¨è®¾å¤‡ä¸­ï¼Œå±å¹•åƒç´ å¯†åº¦éƒ½æ¯”è¾ƒä½ï¼Œå¦‚iphone3ï¼Œå®ƒçš„åˆ†è¾¨ç‡ä¸º320x480ï¼Œåœ¨iphone3ä¸Šï¼Œä¸€ä¸ªcssåƒç´ ç¡®å®æ˜¯ç­‰äºä¸€ä¸ªå±å¹•ç‰©ç†åƒç´ çš„ã€‚åæ¥éšç€æŠ€æœ¯çš„å‘å±•ï¼Œç§»åŠ¨è®¾å¤‡çš„å±å¹•åƒç´ å¯†åº¦è¶Šæ¥è¶Šé«˜ï¼Œä»iphone4å¼€å§‹ï¼Œè‹¹æœå…¬å¸ä¾¿æ¨å‡ºäº†æ‰€è°“çš„Retinaå±ï¼Œåˆ†è¾¨ç‡æé«˜äº†ä¸€å€ï¼Œå˜æˆ640x960ï¼Œä½†å±å¹•å°ºå¯¸å´æ²¡å˜åŒ–ï¼Œè¿™å°±æ„å‘³ç€åŒæ ·å¤§å°çš„å±å¹•ä¸Šï¼Œåƒç´ å´å¤šäº†ä¸€å€ï¼Œè¿™æ—¶ï¼Œä¸€ä¸ªcssåƒç´ æ˜¯ç­‰äºä¸¤ä¸ªç‰©ç†åƒç´ çš„ã€‚å…¶ä»–å“ç‰Œçš„ç§»åŠ¨è®¾å¤‡ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ã€‚ä¾‹å¦‚å®‰å“è®¾å¤‡æ ¹æ®å±å¹•åƒç´ å¯†åº¦å¯åˆ†ä¸ºldpiã€mdpiã€hdpiã€xhdpiç­‰ä¸åŒçš„ç­‰çº§ï¼Œåˆ†è¾¨ç‡ä¹Ÿæ˜¯äº”èŠ±å…«é—¨ï¼Œå®‰å“è®¾å¤‡ä¸Šçš„ä¸€ä¸ªcssåƒç´ ç›¸å½“äºå¤šå°‘ä¸ªå±å¹•ç‰©ç†åƒç´ ï¼Œä¹Ÿå› è®¾å¤‡çš„ä¸åŒè€Œä¸åŒï¼Œæ²¡æœ‰ä¸€ä¸ªå®šè®ºã€‚ è¿˜æœ‰ä¸€ä¸ªå› ç´ ä¹Ÿä¼šå¼•èµ·cssä¸­pxçš„å˜åŒ–ï¼Œé‚£å°±æ˜¯ç”¨æˆ·ç¼©æ”¾ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·æŠŠé¡µé¢æ”¾å¤§ä¸€å€ï¼Œé‚£ä¹ˆcssä¸­1pxæ‰€ä»£è¡¨çš„ç‰©ç†åƒç´ ä¹Ÿä¼šå¢åŠ ä¸€å€ï¼›åä¹‹æŠŠé¡µé¢ç¼©å°ä¸€å€ï¼Œcssä¸­1pxæ‰€ä»£è¡¨çš„ç‰©ç†åƒç´ ä¹Ÿä¼šå‡å°‘ä¸€å€ã€‚ windowå¯¹è±¡æœ‰ä¸€ä¸ªdevicePixelRatioå±æ€§ï¼Œå®ƒçš„å®˜æ–¹çš„å®šä¹‰ä¸ºï¼šè®¾å¤‡ç‰©ç†åƒç´ å’Œè®¾å¤‡ç‹¬ç«‹åƒç´ çš„æ¯”ä¾‹ï¼Œä¹Ÿå°±æ˜¯ devicePixelRatio = ç‰©ç†åƒç´  / ç‹¬ç«‹åƒç´ ã€‚ ä¾‹å¦‚ï¼Œåœ¨Retinaå±çš„iphoneä¸Šï¼ŒdevicePixelRatioçš„å€¼ä¸º2ï¼Œä¹Ÿå°±æ˜¯è¯´1ä¸ªcssåƒç´ ç›¸å½“äº2ä¸ªç‰©ç†åƒç´ ã€‚ ä¸‰ä¸ªviewportè¿™äº›æµè§ˆå™¨å°±å†³å®šé»˜è®¤æƒ…å†µä¸‹æŠŠviewportè®¾ä¸ºä¸€ä¸ªè¾ƒå®½çš„å€¼ï¼Œæ¯”å¦‚980pxï¼Œè¿™æ ·çš„è¯å³ä½¿æ˜¯é‚£äº›ä¸ºæ¡Œé¢è®¾è®¡çš„ç½‘ç«™ä¹Ÿèƒ½åœ¨ç§»åŠ¨æµè§ˆå™¨ä¸Šæ­£å¸¸æ˜¾ç¤ºäº†ã€‚ppkæŠŠè¿™ä¸ªæµè§ˆå™¨é»˜è®¤çš„viewportå«åš *layout viewportã€‚*layout viewport çš„å®½åº¦æ˜¯å¤§äºæµè§ˆå™¨å¯è§†åŒºåŸŸçš„å®½åº¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªviewportæ¥ä»£è¡¨ æµè§ˆå™¨å¯è§†åŒºåŸŸçš„å¤§å°ï¼ŒppkæŠŠè¿™ä¸ªviewportå«åš visual viewportã€‚visual viewportçš„å®½åº¦å¯ä»¥é€šè¿‡window.innerWidth æ¥è·å–ï¼Œä½†åœ¨Android 2, Oprea mini å’Œ UC 8ä¸­æ— æ³•æ­£ç¡®è·å–ã€‚ å®Œç¾é€‚é…æŒ‡çš„æ˜¯ï¼Œé¦–å…ˆä¸éœ€è¦ç”¨æˆ·ç¼©æ”¾å’Œæ¨ªå‘æ»šåŠ¨æ¡å°±èƒ½æ­£å¸¸çš„æŸ¥çœ‹ç½‘ç«™çš„æ‰€æœ‰å†…å®¹ï¼›ç¬¬äºŒï¼Œæ˜¾ç¤ºçš„æ–‡å­—çš„å¤§å°æ˜¯åˆé€‚ï¼›ä¸åªæ˜¯æ–‡å­—ï¼Œå…¶ä»–å…ƒç´ åƒå›¾ç‰‡ä»€ä¹ˆçš„ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ppkæŠŠè¿™ä¸ªviewportå«åš ideal viewportï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸‰ä¸ªviewportâ€”â€”ç§»åŠ¨è®¾å¤‡çš„ç†æƒ³viewportã€‚ ideal viewportå¹¶æ²¡æœ‰ä¸€ä¸ªå›ºå®šçš„å°ºå¯¸ï¼Œä¸åŒçš„è®¾å¤‡æ‹¥æœ‰æœ‰ä¸åŒçš„ideal viewportã€‚æ‰€æœ‰çš„iphoneçš„ideal viewportå®½åº¦éƒ½æ˜¯320pxï¼Œæ— è®ºå®ƒçš„å±å¹•å®½åº¦æ˜¯320è¿˜æ˜¯640ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨iphoneä¸­ï¼Œcssä¸­çš„320pxå°±ä»£è¡¨iphoneå±å¹•çš„å®½åº¦ã€‚ ä½†æ˜¯å®‰å“è®¾å¤‡å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œæœ‰320pxçš„ï¼Œæœ‰360pxçš„ï¼Œæœ‰384pxçš„ç­‰ç­‰ï¼Œå…³äºä¸åŒçš„è®¾å¤‡ideal viewportçš„å®½åº¦éƒ½ä¸ºå¤šå°‘ï¼Œå¯ä»¥åˆ°http://viewportsizes.comå»æŸ¥çœ‹ä¸€ä¸‹ï¼Œé‡Œé¢æ”¶é›†äº†ä¼—å¤šè®¾å¤‡çš„ç†æƒ³å®½åº¦ã€‚ åˆ©ç”¨metaæ ‡ç­¾å¯¹viewportè¿›è¡Œæ§åˆ¶ ç§»åŠ¨è®¾å¤‡é»˜è®¤çš„viewportæ˜¯layout viewportï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ªæ¯”å±å¹•è¦å®½çš„viewportï¼Œä½†åœ¨è¿›è¡Œç§»åŠ¨è®¾å¤‡ç½‘ç«™çš„å¼€å‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ideal viewportã€‚ æˆ‘ä»¬åœ¨å¼€å‘ç§»åŠ¨è®¾å¤‡çš„ç½‘ç«™æ—¶ï¼Œæœ€å¸¸è§çš„çš„ä¸€ä¸ªåŠ¨ä½œå°±æ˜¯æŠŠä¸‹é¢è¿™ä¸ªä¸œè¥¿å¤åˆ¶åˆ°æˆ‘ä»¬çš„headæ ‡ç­¾ä¸­ï¼š 1&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0\"&gt; è¯¥metaæ ‡ç­¾çš„ä½œç”¨æ˜¯è®©å½“å‰viewportçš„å®½åº¦ç­‰äºè®¾å¤‡çš„å®½åº¦ï¼ŒåŒæ—¶ä¸å…è®¸ç”¨æˆ·æ‰‹åŠ¨ç¼©æ”¾ã€‚ meta viewport æ ‡ç­¾é¦–å…ˆæ˜¯ç”±è‹¹æœå…¬å¸åœ¨å…¶safariæµè§ˆå™¨ä¸­å¼•å…¥çš„ï¼Œç›®çš„å°±æ˜¯è§£å†³ç§»åŠ¨è®¾å¤‡çš„viewporté—®é¢˜ã€‚åæ¥å®‰å“ä»¥åŠå„å¤§æµè§ˆå™¨å‚å•†ä¹Ÿéƒ½çº·çº·æ•ˆä»¿ï¼Œå¼•å…¥å¯¹meta viewportçš„æ”¯æŒï¼Œäº‹å®ä¹Ÿè¯æ˜è¿™ä¸ªä¸œè¥¿è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ meta viewport æœ‰6ä¸ªå±æ€§(æš‚ä¸”æŠŠcontentä¸­çš„é‚£äº›ä¸œè¥¿ç§°ä¸ºä¸€ä¸ªä¸ªå±æ€§å’Œå€¼)ï¼Œå¦‚ä¸‹ï¼š å±æ€§ ä½œç”¨ width è®¾ç½®layout viewport çš„å®½åº¦ï¼Œä¸ºä¸€ä¸ªæ­£æ•´æ•°ï¼Œæˆ–å­—ç¬¦ä¸²â€device-widthâ€ initial-scale è®¾ç½®é¡µé¢çš„åˆå§‹ç¼©æ”¾å€¼ï¼Œä¸ºä¸€ä¸ªæ•°å­—ï¼Œå¯ä»¥å¸¦å°æ•°ï¼ˆç¼©æ”¾æ˜¯ç›¸å¯¹äº ideal viewportæ¥è¿›è¡Œç¼©æ”¾çš„ï¼‰ minimum-scale å…è®¸ç”¨æˆ·çš„æœ€å°ç¼©æ”¾å€¼ï¼Œä¸ºä¸€ä¸ªæ•°å­—ï¼Œå¯ä»¥å¸¦å°æ•° maximum-scale å…è®¸ç”¨æˆ·çš„æœ€å¤§ç¼©æ”¾å€¼ï¼Œä¸ºä¸€ä¸ªæ•°å­—ï¼Œå¯ä»¥å¸¦å°æ•° height è®¾ç½®layout viewport çš„é«˜åº¦ï¼Œè¿™ä¸ªå±æ€§å¯¹æˆ‘ä»¬å¹¶ä¸é‡è¦ï¼Œå¾ˆå°‘ä½¿ç”¨ user-scalable æ˜¯å¦å…è®¸ç”¨æˆ·è¿›è¡Œç¼©æ”¾ï¼Œå€¼ä¸ºâ€noâ€æˆ–â€yesâ€, no ä»£è¡¨ä¸å…è®¸ï¼Œyesä»£è¡¨å…è®¸ widthè®¾ä¸ºdevice-width ç‰¹æ®Šå€¼ï¼Œä»£è¡¨ç¼©æ”¾ä¸º 100% æ—¶ä»¥ CSS åƒç´ è®¡é‡çš„å±å¹•å®½åº¦ã€‚ï¼ˆç›¸åº”çš„ä¹Ÿæœ‰heightåŠdevice-heightå±æ€§ï¼Œå¯èƒ½å¯¹åŒ…å«åŸºäºè§†å£é«˜åº¦è°ƒæ•´å¤§å°åŠä½ç½®çš„å…ƒç´ çš„é¡µé¢æœ‰ç”¨ã€‚ï¼‰ æ³¨æ„çš„æ˜¯ï¼Œåœ¨iphoneå’Œipadä¸Šï¼Œæ— è®ºæ˜¯ç«–å±è¿˜æ˜¯æ¨ªå±ï¼Œå®½åº¦éƒ½æ˜¯ç«–å±æ—¶ideal viewportçš„å®½åº¦ã€‚ å¯¹äºè®¾ç½®äº†åˆå§‹æˆ–æœ€å¤§ç¼©æ”¾çš„é¡µé¢ï¼Œwidthå±æ€§å®é™…ä¸Šå˜æˆäº†æœ€å°è§†å£å®½åº¦ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ çš„å¸ƒå±€éœ€è¦è‡³å°‘500åƒç´ çš„å®½åº¦ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ ‡è®°ã€‚å½“å±å¹•å®½åº¦å¤§äº500åƒç´ æ—¶ï¼Œæµè§ˆå™¨ä¼šæ‰©å±•è§†å£ï¼ˆè€Œä¸æ˜¯æ”¾å¤§é¡µé¢ï¼‰æ¥é€‚åº”å±å¹•ï¼š 1&lt;meta name=\"viewport\" content=\"width=500, initial-scale=1\"&gt; å½“é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œæµè§ˆå™¨ä¼šå–å®ƒä»¬ä¸¤ä¸ªä¸­è¾ƒå¤§çš„é‚£ä¸ªå€¼ã€‚ä¾‹å¦‚ï¼Œå½“width=400ï¼Œideal viewportçš„å®½åº¦ä¸º320æ—¶ï¼Œå–çš„æ˜¯400ï¼›å½“width=400ï¼Œ ideal viewportçš„å®½åº¦ä¸º480æ—¶ï¼Œå–çš„æ˜¯ideal viewportçš„å®½åº¦ã€‚ åœ¨å®‰å“ä¸­è¿˜æ”¯æŒ target-densitydpi è¿™ä¸ªç§æœ‰å±æ€§ï¼Œå®ƒè¡¨ç¤ºç›®æ ‡è®¾å¤‡çš„å¯†åº¦ç­‰çº§ï¼Œä½œç”¨æ˜¯å†³å®šcssä¸­çš„1pxä»£è¡¨å¤šå°‘ç‰©ç†åƒç´  target-densitydpiï¼šå€¼å¯ä»¥ä¸ºä¸€ä¸ªæ•°å€¼æˆ– high-dpi ã€ medium-dpiã€ low-dpiã€ device-dpi è¿™å‡ ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ª ç‰¹åˆ«è¯´æ˜çš„æ˜¯ï¼Œå½“ target-densitydpi=device-dpi æ—¶ï¼Œ cssä¸­çš„1pxä¼šç­‰äºç‰©ç†åƒç´ ä¸­çš„1pxã€‚ å› ä¸ºè¿™ä¸ªå±æ€§åªæœ‰å®‰å“æ”¯æŒï¼Œå¹¶ä¸”å®‰å“å·²ç»å†³å®šè¦åºŸå¼ƒtarget-densitydpi è¿™ä¸ªå±æ€§äº†ï¼Œæ‰€ä»¥è¿™ä¸ªå±æ€§æˆ‘ä»¬è¦é¿å…è¿›è¡Œä½¿ç”¨ å…³äºç¼©æ”¾ç¼©æ”¾æ˜¯ç›¸å¯¹äºideal viewportæ¥ç¼©æ”¾çš„ï¼Œç¼©æ”¾å€¼è¶Šå¤§ï¼Œå½“å‰viewportçš„å®½åº¦å°±ä¼šè¶Šå°ï¼Œåä¹‹äº¦ç„¶ã€‚ä¾‹å¦‚åœ¨iphoneä¸­ï¼Œideal viewportçš„å®½åº¦æ˜¯320pxï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½® initial-scale=2 ï¼Œæ­¤æ—¶viewportçš„å®½åº¦ä¼šå˜ä¸ºåªæœ‰160pxäº†ï¼Œè¿™ä¹Ÿå¥½ç†è§£ï¼Œæ”¾å¤§äº†ä¸€å€å˜›ï¼Œå°±æ˜¯åŸæ¥1pxçš„ä¸œè¥¿å˜æˆ2pxäº†ï¼Œä½†æ˜¯1pxå˜ä¸º2pxå¹¶ä¸æ˜¯æŠŠåŸæ¥çš„320pxå˜ä¸º640pxäº†ï¼Œè€Œæ˜¯åœ¨å®é™…å®½åº¦ä¸å˜çš„æƒ…å†µä¸‹ï¼Œ1pxå˜å¾—è·ŸåŸæ¥çš„2pxçš„é•¿åº¦ä¸€æ ·äº†ï¼Œæ‰€ä»¥æ”¾å¤§2å€ååŸæ¥éœ€è¦320pxæ‰èƒ½å¡«æ»¡çš„å®½åº¦ç°åœ¨åªéœ€è¦160pxå°±åšåˆ°äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªå…¬å¼ï¼š 123visual viewportå®½åº¦ = ideal viewportå®½åº¦ / å½“å‰ç¼©æ”¾å€¼å½“å‰ç¼©æ”¾å€¼ = ideal viewportå®½åº¦ / visual viewportå®½åº¦ æ ¹æ®æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨iphoneå’Œipadä¸Šå¾—åˆ°ä¸€ä¸ªç»“è®ºï¼Œå°±æ˜¯æ— è®ºä½ ç»™layout viewporè®¾ç½®çš„å®½åº¦æ˜¯å¤šå°‘ï¼Œè€Œåˆæ²¡æœ‰æŒ‡å®šåˆå§‹çš„ç¼©æ”¾å€¼çš„è¯ï¼Œé‚£ä¹ˆiphoneå’Œipadä¼šè‡ªåŠ¨è®¡ç®—initial-scaleè¿™ä¸ªå€¼ï¼Œä»¥ä¿è¯å½“å‰layout viewportçš„å®½åº¦åœ¨ç¼©æ”¾åå°±æ˜¯æµè§ˆå™¨å¯è§†åŒºåŸŸçš„å®½åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šå‡ºç°æ¨ªå‘æ»šåŠ¨æ¡ã€‚ å½“å‰ç¼©æ”¾å€¼ = ideal viewportå®½åº¦ / visual viewportå®½åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼š â€‹ å½“å‰ç¼©æ”¾å€¼ = 320 / 980 ä¹Ÿå°±æ˜¯å½“å‰çš„initial-scaleé»˜è®¤å€¼åº”è¯¥æ˜¯ 0.33è¿™æ ·å­ã€‚å½“ä½ æŒ‡å®šäº†initial-scaleçš„å€¼åï¼Œè¿™ä¸ªé»˜è®¤å€¼å°±ä¸èµ·ä½œç”¨äº†ã€‚ åœ¨iphoneå’Œipadä¸Šï¼Œæ— è®ºä½ ç»™viewportè®¾çš„å®½çš„æ˜¯å¤šå°‘ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šé»˜è®¤çš„ç¼©æ”¾å€¼ï¼Œåˆ™iphoneå’Œipadä¼šè‡ªåŠ¨è®¡ç®—è¿™ä¸ªç¼©æ”¾å€¼ï¼Œä»¥è¾¾åˆ°å½“å‰é¡µé¢ä¸ä¼šå‡ºç°æ¨ªå‘æ»šåŠ¨æ¡(æˆ–è€…è¯´viewportçš„å®½åº¦å°±æ˜¯å±å¹•çš„å®½åº¦)çš„ç›®çš„ã€‚ jsäº‹ä»¶ç›‘å¬é˜»æ­¢ç”¨æˆ·ç¼©æ”¾ç§»åŠ¨ç«¯webç¼©æ”¾æœ‰ä¸¤ç§ï¼š 1.åŒå‡»ç¼©æ”¾ï¼› 2.åŒæŒ‡æ‰‹åŠ¿ç¼©æ”¾ã€‚ ç¦æ­¢åŒå‡»ç¼©æ”¾ 123456789101112131415window.Î¿nlÎ¿ad=function () &#123; document.addEventListener('touchstart',function (event) &#123; if(event.touches.length&gt;1)&#123; event.preventDefault(); &#125; &#125;) var lastTouchEnd=0; document.addEventListener('touchend',function (event) &#123; var now=(new Date()).getTime(); if(now-lastTouchEnd&lt;=300)&#123; event.preventDefault(); &#125; lastTouchEnd=now; &#125;,false) &#125; å®Œç¾æ–¹æ¡ˆ 123456789101112131415161718192021&lt;script&gt; window.onload=function () &#123; document.addEventListener('touchstart',function (event) &#123; if(event.touches.length&gt;1)&#123; event.preventDefault(); &#125; &#125;); var lastTouchEnd=0; document.addEventListener('touchend',function (event) &#123; var now=(new Date()).getTime(); if(now-lastTouchEnd&lt;=300)&#123; event.preventDefault(); &#125; lastTouchEnd=now; &#125;,false); //ä¾ç„¶å­˜åœ¨bugï¼ŒåŒæŒ‡åŒæ—¶æ”¾ä¸‹æ”¾å¤§ç¦æ­¢äº†ï¼Œä½†ä¸€æŒ‡å…ˆæ”¾ä¸‹ï¼Œå¦ä¸€æŒ‡åœ¨æ”¾ä¸‹æ»‘åŠ¨æ”¾å¤§ä¾ç„¶ä¸ç®¡ç”¨ document.addEventListener('gesturestart', function (event) &#123; event.preventDefault(); &#125;); &#125;&lt;/script&gt;","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"viewport","slug":"viewport","permalink":"http://yoursite.com/tags/viewport/"}]},{"title":"Vueç»„ä»¶é—´çš„é€šä¿¡","slug":"Vueç»„ä»¶é—´çš„é€šä¿¡","date":"2020-02-26T03:18:32.000Z","updated":"2020-04-03T03:50:33.254Z","comments":true,"path":"2020/02/26/Vueç»„ä»¶é—´çš„é€šä¿¡/","link":"","permalink":"http://yoursite.com/2020/02/26/Vueç»„ä»¶é—´çš„é€šä¿¡/","excerpt":"","text":"vueç»„ä»¶é—´çš„é€šä¿¡ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒA å’Œ Bã€B å’Œ Cã€B å’Œ D éƒ½æ˜¯çˆ¶å­å…³ç³»ï¼ŒC å’Œ D æ˜¯å…„å¼Ÿå…³ç³»ï¼ŒA å’Œ C æ˜¯éš”ä»£å…³ç³»ï¼ˆå¯èƒ½éš”å¤šä»£ï¼‰ã€‚ props/$emitçˆ¶ç»„ä»¶Aé€šè¿‡propsçš„æ–¹å¼å‘å­ç»„ä»¶Bä¼ é€’ï¼ŒB to A é€šè¿‡åœ¨ B ç»„ä»¶ä¸­ $emit, A ç»„ä»¶ä¸­ v-on çš„æ–¹å¼å®ç°ã€‚ 1.çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜çˆ¶ç»„ä»¶å¦‚ä½•å‘å­ç»„ä»¶ä¼ é€’å€¼ï¼šåœ¨å­ç»„ä»¶Users.vueä¸­å¦‚ä½•è·å–çˆ¶ç»„ä»¶App.vueä¸­çš„æ•°æ® users:[&quot;Henry&quot;,&quot;Bucky&quot;,&quot;Emily&quot;] 12345678910111213141516171819//App.vueçˆ¶ç»„ä»¶&lt;template&gt; &lt;div id=&quot;app&quot;&gt; &lt;users v-bind:users=&quot;users&quot;&gt;&lt;/users&gt;//å‰è€…è‡ªå®šä¹‰åç§°ä¾¿äºå­ç»„ä»¶è°ƒç”¨ï¼Œåè€…è¦ä¼ é€’æ•°æ®å &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import Users from &quot;./components/Users&quot;export default &#123; name: &apos;App&apos;, data()&#123; return&#123; users:[&quot;Henry&quot;,&quot;Bucky&quot;,&quot;Emily&quot;] &#125; &#125;, components:&#123; &quot;users&quot;:Users &#125;&#125; 12345678910111213141516171819//userså­ç»„ä»¶&lt;template&gt; &lt;div class=&quot;hello&quot;&gt; &lt;ul&gt; &lt;li v-for=&quot;user in users&quot;&gt;&#123;&#123;user&#125;&#125;&lt;/li&gt;//éå†ä¼ é€’è¿‡æ¥çš„å€¼ï¼Œç„¶åå‘ˆç°åˆ°é¡µé¢ &lt;/ul&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &apos;HelloWorld&apos;, props:&#123; users:&#123; //è¿™ä¸ªå°±æ˜¯çˆ¶ç»„ä»¶ä¸­å­æ ‡ç­¾è‡ªå®šä¹‰åå­— type:Array, required:true &#125; &#125;&#125;&lt;/script&gt; æ€»ç»“ï¼šçˆ¶ç»„ä»¶é€šè¿‡propså‘ä¸‹ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ã€‚æ³¨ï¼šç»„ä»¶ä¸­çš„æ•°æ®å…±æœ‰ä¸‰ç§å½¢å¼ï¼šdataã€propsã€computed 2.å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ å€¼ï¼ˆé€šè¿‡äº‹ä»¶å½¢å¼ï¼‰æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜å­ç»„ä»¶å¦‚ä½•å‘çˆ¶ç»„ä»¶ä¼ é€’å€¼ï¼šå½“æˆ‘ä»¬ç‚¹å‡»â€œVue.js Demoâ€åï¼Œå­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’å€¼ï¼Œæ–‡å­—ç”±åŸæ¥çš„â€œä¼ é€’çš„æ˜¯ä¸€ä¸ªå€¼â€å˜æˆâ€œå­å‘çˆ¶ç»„ä»¶ä¼ å€¼â€ï¼Œå®ç°å­ç»„ä»¶å‘çˆ¶ç»„ä»¶å€¼çš„ä¼ é€’ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// å­ç»„ä»¶&lt;template&gt; &lt;header&gt; &lt;h1 @click=&quot;changeTitle&quot;&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;//ç»‘å®šä¸€ä¸ªç‚¹å‡»äº‹ä»¶ &lt;/header&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &apos;app-header&apos;, data() &#123; return &#123; title:&quot;Vue.js Demo&quot; &#125; &#125;, methods:&#123; changeTitle() &#123; this.$emit(&quot;titleChanged&quot;,&quot;å­å‘çˆ¶ç»„ä»¶ä¼ å€¼&quot;);//è‡ªå®šä¹‰äº‹ä»¶ ä¼ é€’å€¼â€œå­å‘çˆ¶ç»„ä»¶ä¼ å€¼â€ &#125; &#125;&#125;&lt;/script&gt;// çˆ¶ç»„ä»¶&lt;template&gt; &lt;div id=&quot;app&quot;&gt; &lt;app-header v-on:titleChanged=&quot;updateTitle&quot; &gt;&lt;/app-header&gt;//ä¸å­ç»„ä»¶titleChangedè‡ªå®šä¹‰äº‹ä»¶ä¿æŒä¸€è‡´ // updateTitle($event)æ¥å—ä¼ é€’è¿‡æ¥çš„æ–‡å­— &lt;h2&gt;&#123;&#123;title&#125;&#125;&lt;/h2&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import Header from &quot;./components/Header&quot;export default &#123; name: &apos;App&apos;, data()&#123; return&#123; title:&quot;ä¼ é€’çš„æ˜¯ä¸€ä¸ªå€¼&quot; &#125; &#125;, methods:&#123; updateTitle(e)&#123; //å£°æ˜è¿™ä¸ªå‡½æ•° this.title = e; &#125; &#125;, components:&#123; &quot;app-header&quot;:Header, &#125;&#125;&lt;/script&gt; æ€»ç»“ï¼šå­ç»„ä»¶é€šè¿‡eventsç»™çˆ¶ç»„ä»¶å‘é€æ¶ˆæ¯ï¼Œå®é™…ä¸Šå°±æ˜¯å­ç»„ä»¶æŠŠè‡ªå·±çš„æ•°æ®å‘é€åˆ°çˆ¶ç»„ä»¶ã€‚ $emit/$onè¿™ç§æ–¹æ³•é€šè¿‡ä¸€ä¸ªç©ºçš„Vueå®ä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»çº¿ï¼ˆäº‹ä»¶ä¸­å¿ƒï¼‰ï¼Œç”¨å®ƒæ¥è§¦å‘äº‹ä»¶å’Œç›‘å¬äº‹ä»¶,å·§å¦™è€Œè½»é‡åœ°å®ç°äº†ä»»ä½•ç»„ä»¶é—´çš„é€šä¿¡ï¼ŒåŒ…æ‹¬çˆ¶å­ã€å…„å¼Ÿã€è·¨çº§ã€‚å½“æˆ‘ä»¬çš„é¡¹ç›®æ¯”è¾ƒå¤§æ—¶ï¼Œå¯ä»¥é€‰æ‹©æ›´å¥½çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆvuexã€‚ 1.å…·ä½“å®ç°æ–¹å¼ï¼š123var Event=new Vue();Event.$emit(äº‹ä»¶å,æ•°æ®);Event.$on(äº‹ä»¶å,data =&gt; &#123;&#125;); 2.ä¸¾ä¸ªä¾‹å­å‡è®¾å…„å¼Ÿç»„ä»¶æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯Aã€Bã€Cç»„ä»¶ï¼ŒCç»„ä»¶å¦‚ä½•è·å–Aæˆ–è€…Bç»„ä»¶çš„æ•°æ® 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576&lt;div id=&quot;itany&quot;&gt; &lt;my-a&gt;&lt;/my-a&gt; &lt;my-b&gt;&lt;/my-b&gt; &lt;my-c&gt;&lt;/my-c&gt;&lt;/div&gt;&lt;template id=&quot;a&quot;&gt; &lt;div&gt; &lt;h3&gt;Aç»„ä»¶ï¼š&#123;&#123;name&#125;&#125;&lt;/h3&gt; &lt;button @click=&quot;send&quot;&gt;å°†æ•°æ®å‘é€ç»™Cç»„ä»¶&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;template id=&quot;b&quot;&gt; &lt;div&gt; &lt;h3&gt;Bç»„ä»¶ï¼š&#123;&#123;age&#125;&#125;&lt;/h3&gt; &lt;button @click=&quot;send&quot;&gt;å°†æ•°ç»„å‘é€ç»™Cç»„ä»¶&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;template id=&quot;c&quot;&gt; &lt;div&gt; &lt;h3&gt;Cç»„ä»¶ï¼š&#123;&#123;name&#125;&#125;ï¼Œ&#123;&#123;age&#125;&#125;&lt;/h3&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;var Event = new Vue();//å®šä¹‰ä¸€ä¸ªç©ºçš„Vueå®ä¾‹var A = &#123; template: &apos;#a&apos;, data() &#123; return &#123; name: &apos;tom&apos; &#125; &#125;, methods: &#123; send() &#123; Event.$emit(&apos;data-a&apos;, this.name); &#125; &#125;&#125;var B = &#123; template: &apos;#b&apos;, data() &#123; return &#123; age: 20 &#125; &#125;, methods: &#123; send() &#123; Event.$emit(&apos;data-b&apos;, this.age); &#125; &#125;&#125;var C = &#123; template: &apos;#c&apos;, data() &#123; return &#123; name: &apos;&apos;, age: &quot;&quot; &#125; &#125;, mounted() &#123;//åœ¨æ¨¡æ¿ç¼–è¯‘å®Œæˆåæ‰§è¡Œ Event.$on(&apos;data-a&apos;,name =&gt; &#123; this.name = name;//ç®­å¤´å‡½æ•°å†…éƒ¨ä¸ä¼šäº§ç”Ÿæ–°çš„thisï¼Œè¿™è¾¹å¦‚æœä¸ç”¨=&gt;,thisæŒ‡ä»£Event &#125;) Event.$on(&apos;data-b&apos;,age =&gt; &#123; this.age = age; &#125;) &#125;&#125;var vm = new Vue(&#123; el: &apos;#itany&apos;, components: &#123; &apos;my-a&apos;: A, &apos;my-b&apos;: B, &apos;my-c&apos;: C &#125;&#125;); &lt;/script&gt; $on ç›‘å¬äº†è‡ªå®šä¹‰äº‹ä»¶ data-aå’Œdata-bï¼Œå› ä¸ºæœ‰æ—¶ä¸ç¡®å®šä½•æ—¶ä¼šè§¦å‘äº‹ä»¶ï¼Œä¸€èˆ¬ä¼šåœ¨ mounted æˆ– created é’©å­ä¸­æ¥ç›‘å¬ã€‚ vuex 1.ç®€è¦ä»‹ç»VuexåŸç†Vuexå®ç°äº†ä¸€ä¸ªå•å‘æ•°æ®æµï¼Œåœ¨å…¨å±€æ‹¥æœ‰ä¸€ä¸ªStateå­˜æ”¾æ•°æ®ï¼Œå½“ç»„ä»¶è¦æ›´æ”¹Stateä¸­çš„æ•°æ®æ—¶ï¼Œå¿…é¡»é€šè¿‡Mutationè¿›è¡Œï¼ŒMutationåŒæ—¶æä¾›äº†è®¢é˜…è€…æ¨¡å¼ä¾›å¤–éƒ¨æ’ä»¶è°ƒç”¨è·å–Stateæ•°æ®çš„æ›´æ–°ã€‚è€Œå½“æ‰€æœ‰å¼‚æ­¥æ“ä½œ(å¸¸è§äºè°ƒç”¨åç«¯æ¥å£å¼‚æ­¥è·å–æ›´æ–°æ•°æ®)æˆ–æ‰¹é‡çš„åŒæ­¥æ“ä½œéœ€è¦èµ°Actionï¼Œä½†Actionä¹Ÿæ˜¯æ— æ³•ç›´æ¥ä¿®æ”¹Stateçš„ï¼Œè¿˜æ˜¯éœ€è¦é€šè¿‡Mutationæ¥ä¿®æ”¹Stateçš„æ•°æ®ã€‚æœ€åï¼Œæ ¹æ®Stateçš„å˜åŒ–ï¼Œæ¸²æŸ“åˆ°è§†å›¾ä¸Šã€‚ 2.ç®€è¦ä»‹ç»å„æ¨¡å—åœ¨æµç¨‹ä¸­çš„åŠŸèƒ½ï¼š Vue Componentsï¼šVueç»„ä»¶ã€‚HTMLé¡µé¢ä¸Šï¼Œè´Ÿè´£æ¥æ”¶ç”¨æˆ·æ“ä½œç­‰äº¤äº’è¡Œä¸ºï¼Œæ‰§è¡Œdispatchæ–¹æ³•è§¦å‘å¯¹åº”actionè¿›è¡Œå›åº”ã€‚ dispatchï¼šæ“ä½œè¡Œä¸ºè§¦å‘æ–¹æ³•ï¼Œæ˜¯å”¯ä¸€èƒ½æ‰§è¡Œactionçš„æ–¹æ³•ã€‚ actionsï¼šæ“ä½œè¡Œä¸ºå¤„ç†æ¨¡å—,ç”±ç»„ä»¶ä¸­çš„$store.dispatch(â€˜action åç§°â€™, data1)æ¥è§¦å‘ã€‚ç„¶åç”±commit()æ¥è§¦å‘mutationçš„è°ƒç”¨ , é—´æ¥æ›´æ–° stateã€‚è´Ÿè´£å¤„ç†Vue Componentsæ¥æ”¶åˆ°çš„æ‰€æœ‰äº¤äº’è¡Œä¸ºã€‚åŒ…å«åŒæ­¥/å¼‚æ­¥æ“ä½œï¼Œæ”¯æŒå¤šä¸ªåŒåæ–¹æ³•ï¼ŒæŒ‰ç…§æ³¨å†Œçš„é¡ºåºä¾æ¬¡è§¦å‘ã€‚å‘åå°APIè¯·æ±‚çš„æ“ä½œå°±åœ¨è¿™ä¸ªæ¨¡å—ä¸­è¿›è¡Œï¼ŒåŒ…æ‹¬è§¦å‘å…¶ä»–actionä»¥åŠæäº¤mutationçš„æ“ä½œã€‚è¯¥æ¨¡å—æä¾›äº†Promiseçš„å°è£…ï¼Œä»¥æ”¯æŒactionçš„é“¾å¼è§¦å‘ã€‚ commitï¼šçŠ¶æ€æ”¹å˜æäº¤æ“ä½œæ–¹æ³•ã€‚å¯¹mutationè¿›è¡Œæäº¤ï¼Œæ˜¯å”¯ä¸€èƒ½æ‰§è¡Œmutationçš„æ–¹æ³•ã€‚ mutationsï¼šçŠ¶æ€æ”¹å˜æ“ä½œæ–¹æ³•ï¼Œç”±actionsä¸­çš„commit(â€˜mutation åç§°â€™)æ¥è§¦å‘ã€‚æ˜¯Vuexä¿®æ”¹stateçš„å”¯ä¸€æ¨èæ–¹æ³•ã€‚è¯¥æ–¹æ³•åªèƒ½è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œä¸”æ–¹æ³•ååªèƒ½å…¨å±€å”¯ä¸€ã€‚æ“ä½œä¹‹ä¸­ä¼šæœ‰ä¸€äº›hookæš´éœ²å‡ºæ¥ï¼Œä»¥è¿›è¡Œstateçš„ç›‘æ§ç­‰ã€‚ stateï¼šé¡µé¢çŠ¶æ€ç®¡ç†å®¹å™¨å¯¹è±¡ã€‚é›†ä¸­å­˜å‚¨Vue componentsä¸­dataå¯¹è±¡çš„é›¶æ•£æ•°æ®ï¼Œå…¨å±€å”¯ä¸€ï¼Œä»¥è¿›è¡Œç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†ã€‚é¡µé¢æ˜¾ç¤ºæ‰€éœ€çš„æ•°æ®ä»è¯¥å¯¹è±¡ä¸­è¿›è¡Œè¯»å–ï¼Œåˆ©ç”¨Vueçš„ç»†ç²’åº¦æ•°æ®å“åº”æœºåˆ¶æ¥è¿›è¡Œé«˜æ•ˆçš„çŠ¶æ€æ›´æ–°ã€‚ gettersï¼šstateå¯¹è±¡è¯»å–æ–¹æ³•ã€‚å›¾ä¸­æ²¡æœ‰å•ç‹¬åˆ—å‡ºè¯¥æ¨¡å—ï¼Œåº”è¯¥è¢«åŒ…å«åœ¨äº†renderä¸­ï¼ŒVue Componentsé€šè¿‡è¯¥æ–¹æ³•è¯»å–å…¨å±€stateå¯¹è±¡ã€‚ 3.Vuexä¸localStoragevuex æ˜¯ vue çš„çŠ¶æ€ç®¡ç†å™¨ï¼Œå­˜å‚¨çš„æ•°æ®æ˜¯å“åº”å¼çš„ã€‚ä½†æ˜¯å¹¶ä¸ä¼šä¿å­˜èµ·æ¥ï¼Œåˆ·æ–°ä¹‹åå°±å›åˆ°äº†åˆå§‹çŠ¶æ€ï¼Œå…·ä½“åšæ³•åº”è¯¥åœ¨vuexé‡Œæ•°æ®æ”¹å˜çš„æ—¶å€™æŠŠæ•°æ®æ‹·è´ä¸€ä»½ä¿å­˜åˆ°localStorageé‡Œé¢ï¼Œåˆ·æ–°ä¹‹åï¼Œå¦‚æœlocalStorageé‡Œæœ‰ä¿å­˜çš„æ•°æ®ï¼Œå–å‡ºæ¥å†æ›¿æ¢storeé‡Œçš„stateã€‚ 1234567891011121314151617181920let defaultCity = \"ä¸Šæµ·\"try &#123; // ç”¨æˆ·å…³é—­äº†æœ¬åœ°å­˜å‚¨åŠŸèƒ½ï¼Œæ­¤æ—¶åœ¨å¤–å±‚åŠ ä¸ªtry...catch if (!defaultCity)&#123; defaultCity = JSON.parse(window.localStorage.getItem('defaultCity')) &#125;&#125;catch(e)&#123;&#125;export default new Vuex.Store(&#123; state: &#123; city: defaultCity &#125;, mutations: &#123; changeCity(state, city) &#123; state.city = city try &#123; window.localStorage.setItem('defaultCity', JSON.stringify(state.city)); // æ•°æ®æ”¹å˜çš„æ—¶å€™æŠŠæ•°æ®æ‹·è´ä¸€ä»½ä¿å­˜åˆ°localStorageé‡Œé¢ &#125; catch (e) &#123;&#125; &#125; &#125;&#125;) è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”±äºvuexé‡Œï¼Œæˆ‘ä»¬ä¿å­˜çš„çŠ¶æ€ï¼Œéƒ½æ˜¯æ•°ç»„ï¼Œè€ŒlocalStorageåªæ”¯æŒå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥éœ€è¦ç”¨JSONè½¬æ¢ï¼š 12JSON.stringify(state.subscribeList); // array -&gt; stringJSON.parse(window.localStorage.getItem(\"subscribeList\")); // string -&gt; array ##$attrs/$listeners å¤šçº§ç»„ä»¶åµŒå¥—éœ€è¦ä¼ é€’æ•°æ®æ—¶ï¼Œé€šå¸¸ä½¿ç”¨çš„æ–¹æ³•æ˜¯é€šè¿‡vuexã€‚ä½†å¦‚æœä»…ä»…æ˜¯ä¼ é€’æ•°æ®ï¼Œè€Œä¸åšä¸­é—´å¤„ç†ï¼Œä½¿ç”¨ vuex å¤„ç†ï¼Œæœªå…æœ‰ç‚¹å¤§æå°ç”¨ã€‚ä¸ºæ­¤Vue2.4 ç‰ˆæœ¬æä¾›äº†å¦ä¸€ç§æ–¹æ³•â€”-$attrs/$listeners $attrsï¼šåŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­ä¸è¢« prop æ‰€è¯†åˆ« (ä¸”è·å–) çš„ç‰¹æ€§ç»‘å®š (class å’Œ style é™¤å¤–)ã€‚å½“ä¸€ä¸ªç»„ä»¶æ²¡æœ‰å£°æ˜ä»»ä½• prop æ—¶ï¼Œè¿™é‡Œä¼šåŒ…å«æ‰€æœ‰çˆ¶ä½œç”¨åŸŸçš„ç»‘å®š (class å’Œ style é™¤å¤–)ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ v-bind=â€$attrsâ€ ä¼ å…¥å†…éƒ¨ç»„ä»¶ã€‚é€šå¸¸é…åˆ inheritAttrs é€‰é¡¹ä¸€èµ·ä½¿ç”¨ã€‚ $listenersï¼šåŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­çš„ (ä¸å« .native ä¿®é¥°å™¨çš„) v-on äº‹ä»¶ç›‘å¬å™¨ã€‚å®ƒå¯ä»¥é€šè¿‡ v-on=â€$listenersâ€ ä¼ å…¥å†…éƒ¨ç»„ä»¶ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸ªè·¨çº§é€šä¿¡çš„ä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687// index.vue&lt;template&gt; &lt;div&gt; &lt;h2&gt;æµªé‡Œè¡ŒèˆŸ&lt;/h2&gt; &lt;child-com1 :foo=&quot;foo&quot; :boo=&quot;boo&quot; :coo=&quot;coo&quot; :doo=&quot;doo&quot; title=&quot;å‰ç«¯å·¥åŒ &quot; &gt;&lt;/child-com1&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;const childCom1 = () =&gt; import(&quot;./childCom1.vue&quot;);export default &#123; components: &#123; childCom1 &#125;, data() &#123; return &#123; foo: &quot;Javascript&quot;, boo: &quot;Html&quot;, coo: &quot;CSS&quot;, doo: &quot;Vue&quot; &#125;; &#125;&#125;;&lt;/script&gt;// childCom1.vue&lt;template class=&quot;border&quot;&gt; &lt;div&gt; &lt;p&gt;foo: &#123;&#123; foo &#125;&#125;&lt;/p&gt; &lt;p&gt;childCom1çš„$attrs: &#123;&#123; $attrs &#125;&#125;&lt;/p&gt; &lt;child-com2 v-bind=&quot;$attrs&quot;&gt;&lt;/child-com2&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;const childCom2 = () =&gt; import(&quot;./childCom2.vue&quot;);export default &#123; components: &#123; childCom2 &#125;, inheritAttrs: false, // å¯ä»¥å…³é—­è‡ªåŠ¨æŒ‚è½½åˆ°ç»„ä»¶æ ¹å…ƒç´ ä¸Šçš„æ²¡æœ‰åœ¨propså£°æ˜çš„å±æ€§ props: &#123; foo: String // fooä½œä¸ºpropså±æ€§ç»‘å®š &#125;, created() &#123; console.log(this.$attrs); // &#123; &quot;boo&quot;: &quot;Html&quot;, &quot;coo&quot;: &quot;CSS&quot;, &quot;doo&quot;: &quot;Vue&quot;, &quot;title&quot;: &quot;å‰ç«¯å·¥åŒ &quot; &#125; &#125;&#125;;&lt;/script&gt;// childCom2.vue&lt;template&gt; &lt;div class=&quot;border&quot;&gt; &lt;p&gt;boo: &#123;&#123; boo &#125;&#125;&lt;/p&gt; &lt;p&gt;childCom2: &#123;&#123; $attrs &#125;&#125;&lt;/p&gt; &lt;child-com3 v-bind=&quot;$attrs&quot;&gt;&lt;/child-com3&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;const childCom3 = () =&gt; import(&quot;./childCom3.vue&quot;);export default &#123; components: &#123; childCom3 &#125;, inheritAttrs: false, props: &#123; boo: String &#125;, created() &#123; console.log(this.$attrs); // &#123; &quot;coo&quot;: &quot;CSS&quot;, &quot;doo&quot;: &quot;Vue&quot;, &quot;title&quot;: &quot;å‰ç«¯å·¥åŒ &quot; &#125; &#125;&#125;;&lt;/script&gt;// childCom3.vue&lt;template&gt; &lt;div class=&quot;border&quot;&gt; &lt;p&gt;childCom3: &#123;&#123; $attrs &#125;&#125;&lt;/p&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; props: &#123; coo: String, title: String &#125;&#125;;&lt;/script&gt; å¦‚ä¸Šå›¾æ‰€ç¤º$attrsè¡¨ç¤ºæ²¡æœ‰ç»§æ‰¿æ•°æ®çš„å¯¹è±¡ï¼Œæ ¼å¼ä¸º{å±æ€§åï¼šå±æ€§å€¼}ã€‚Vue2.4æä¾›äº†$attrs , $listeners æ¥ä¼ é€’æ•°æ®ä¸äº‹ä»¶ï¼Œè·¨çº§ç»„ä»¶ä¹‹é—´çš„é€šè®¯å˜å¾—æ›´ç®€å•ã€‚ ç®€å•æ¥è¯´ï¼š$attrsä¸$listeners æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œ$attrs é‡Œå­˜æ”¾çš„æ˜¯çˆ¶ç»„ä»¶ä¸­ç»‘å®šçš„é Props å±æ€§ï¼Œ$listenersé‡Œå­˜æ”¾çš„æ˜¯çˆ¶ç»„ä»¶ä¸­ç»‘å®šçš„éåŸç”Ÿäº‹ä»¶ã€‚ ##provide/inject 1.ç®€ä»‹Vue2.2.0æ–°å¢API,è¿™å¯¹é€‰é¡¹éœ€è¦ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å…è®¸ä¸€ä¸ªç¥–å…ˆç»„ä»¶å‘å…¶æ‰€æœ‰å­å­™åä»£æ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Œä¸è®ºç»„ä»¶å±‚æ¬¡æœ‰å¤šæ·±ï¼Œå¹¶åœ¨èµ·ä¸Šä¸‹æ¸¸å…³ç³»æˆç«‹çš„æ—¶é—´é‡Œå§‹ç»ˆç”Ÿæ•ˆã€‚ä¸€è¨€è€Œè”½ä¹‹ï¼šç¥–å…ˆç»„ä»¶ä¸­é€šè¿‡provideræ¥æä¾›å˜é‡ï¼Œç„¶ååœ¨å­å­™ç»„ä»¶ä¸­é€šè¿‡injectæ¥æ³¨å…¥å˜é‡ã€‚provide / inject API ä¸»è¦è§£å†³äº†è·¨çº§ç»„ä»¶é—´çš„é€šä¿¡é—®é¢˜ï¼Œä¸è¿‡å®ƒçš„ä½¿ç”¨åœºæ™¯ï¼Œä¸»è¦æ˜¯å­ç»„ä»¶è·å–ä¸Šçº§ç»„ä»¶çš„çŠ¶æ€ï¼Œè·¨çº§ç»„ä»¶é—´å»ºç«‹äº†ä¸€ç§ä¸»åŠ¨æä¾›ä¸ä¾èµ–æ³¨å…¥çš„å…³ç³»ã€‚ 2.ä¸¾ä¸ªä¾‹å­å‡è®¾æœ‰ä¸¤ä¸ªç»„ä»¶ï¼š A.vue å’Œ B.vueï¼ŒB æ˜¯ A çš„å­ç»„ä»¶ 12345678910111213// A.vueexport default &#123; provide: &#123; name: 'æµªé‡Œè¡ŒèˆŸ' &#125;&#125;// B.vueexport default &#123; inject: ['name'], mounted () &#123; console.log(this.name); // æµªé‡Œè¡ŒèˆŸ &#125;&#125; å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ A.vue é‡Œï¼Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ª provide: nameï¼Œå€¼ä¸º æµªé‡Œè¡ŒèˆŸï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å°† name è¿™ä¸ªå˜é‡æä¾›ç»™å®ƒçš„æ‰€æœ‰å­ç»„ä»¶ã€‚è€Œåœ¨ B.vue ä¸­ï¼Œé€šè¿‡ inject æ³¨å…¥äº†ä» A ç»„ä»¶ä¸­æä¾›çš„ name å˜é‡ï¼Œé‚£ä¹ˆåœ¨ç»„ä»¶ B ä¸­ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡ this.name è®¿é—®è¿™ä¸ªå˜é‡äº†ï¼Œå®ƒçš„å€¼ä¹Ÿæ˜¯ æµªé‡Œè¡ŒèˆŸã€‚è¿™å°±æ˜¯ provide / inject API æœ€æ ¸å¿ƒçš„ç”¨æ³•ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šprovide å’Œ inject ç»‘å®šå¹¶ä¸æ˜¯å¯å“åº”çš„ã€‚è¿™æ˜¯åˆ»æ„ä¸ºä¹‹çš„ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªå¯ç›‘å¬çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…¶å¯¹è±¡çš„å±æ€§è¿˜æ˜¯å¯å“åº”çš„â€”-vueå®˜æ–¹æ–‡æ¡£æ‰€ä»¥ï¼Œä¸Šé¢ A.vue çš„ name å¦‚æœæ”¹å˜äº†ï¼ŒB.vue çš„ this.name æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œä»ç„¶æ˜¯ æµªé‡Œè¡ŒèˆŸã€‚ 3.provideä¸inject æ€ä¹ˆå®ç°æ•°æ®å“åº”å¼ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼š provideç¥–å…ˆç»„ä»¶çš„å®ä¾‹ï¼Œç„¶ååœ¨å­å­™ç»„ä»¶ä¸­æ³¨å…¥ä¾èµ–ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å­å­™ç»„ä»¶ä¸­ç›´æ¥ä¿®æ”¹ç¥–å…ˆç»„ä»¶çš„å®ä¾‹çš„å±æ€§ï¼Œä¸è¿‡è¿™ç§æ–¹æ³•æœ‰ä¸ªç¼ºç‚¹å°±æ˜¯è¿™ä¸ªå®ä¾‹ä¸ŠæŒ‚è½½å¾ˆå¤šæ²¡æœ‰å¿…è¦çš„ä¸œè¥¿æ¯”å¦‚propsï¼Œmethods ä½¿ç”¨2.6æœ€æ–°API Vue.observable ä¼˜åŒ–å“åº”å¼ provide(æ¨è) æˆ‘ä»¬æ¥çœ‹ä¸ªä¾‹å­ï¼šå­™ç»„ä»¶Dã€Eå’ŒFè·å–Aç»„ä»¶ä¼ é€’è¿‡æ¥çš„colorå€¼ï¼Œå¹¶èƒ½å®ç°æ•°æ®å“åº”å¼å˜åŒ–ï¼Œå³Aç»„ä»¶çš„colorå˜åŒ–åï¼Œç»„ä»¶Dã€Eã€Fä¼šè·Ÿç€å˜ï¼ˆæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼šï¼‰ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768// A ç»„ä»¶ &lt;div&gt; &lt;h1&gt;A ç»„ä»¶&lt;/h1&gt; &lt;button @click=&quot;() =&gt; changeColor()&quot;&gt;æ”¹å˜color&lt;/button&gt; &lt;ChildrenB /&gt; &lt;ChildrenC /&gt;&lt;/div&gt;...... data() &#123; return &#123; color: &quot;blue&quot; &#125;; &#125;, // provide() &#123; // return &#123; // theme: &#123; // color: this.color //è¿™ç§æ–¹å¼ç»‘å®šçš„æ•°æ®å¹¶ä¸æ˜¯å¯å“åº”çš„ // &#125; // å³Aç»„ä»¶çš„colorå˜åŒ–åï¼Œç»„ä»¶Dã€Eã€Fä¸ä¼šè·Ÿç€å˜ // &#125;; // &#125;, provide() &#123; return &#123; theme: this//æ–¹æ³•ä¸€ï¼šæä¾›ç¥–å…ˆç»„ä»¶çš„å®ä¾‹ &#125;; &#125;, methods: &#123; changeColor(color) &#123; if (color) &#123; this.color = color; &#125; else &#123; this.color = this.color === &quot;blue&quot; ? &quot;red&quot; : &quot;blue&quot;; &#125; &#125; &#125; // æ–¹æ³•äºŒ:ä½¿ç”¨2.6æœ€æ–°API Vue.observable ä¼˜åŒ–å“åº”å¼ provide // provide() &#123; // this.theme = Vue.observable(&#123; // color: &quot;blue&quot; // &#125;); // return &#123; // theme: this.theme // &#125;; // &#125;, // methods: &#123; // changeColor(color) &#123; // if (color) &#123; // this.theme.color = color; // &#125; else &#123; // this.theme.color = this.theme.color === &quot;blue&quot; ? &quot;red&quot; : &quot;blue&quot;; // &#125; // &#125; // &#125;// F ç»„ä»¶ &lt;template functional&gt; &lt;div class=&quot;border2&quot;&gt; &lt;h3 :style=&quot;&#123; color: injections.theme.color &#125;&quot;&gt;F ç»„ä»¶&lt;/h3&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; inject: &#123; theme: &#123; //å‡½æ•°å¼ç»„ä»¶å–å€¼ä¸ä¸€æ · default: () =&gt; (&#123;&#125;) &#125; &#125;&#125;;&lt;/script&gt; è™½è¯´provide å’Œ inject ä¸»è¦ä¸ºé«˜é˜¶æ’ä»¶/ç»„ä»¶åº“æä¾›ç”¨ä¾‹ï¼Œä½†å¦‚æœä½ èƒ½åœ¨ä¸šåŠ¡ä¸­ç†Ÿç»ƒè¿ç”¨ï¼Œå¯ä»¥è¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœï¼ $parent / $childrenä¸ ref refï¼šå¦‚æœåœ¨æ™®é€šçš„ DOM å…ƒç´ ä¸Šä½¿ç”¨ï¼Œå¼•ç”¨æŒ‡å‘çš„å°±æ˜¯ DOM å…ƒç´ ï¼›å¦‚æœç”¨åœ¨å­ç»„ä»¶ä¸Šï¼Œå¼•ç”¨å°±æŒ‡å‘ç»„ä»¶å®ä¾‹ $parent / $childrenï¼šè®¿é—®çˆ¶ / å­å®ä¾‹ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™ä¸¤ç§éƒ½æ˜¯ç›´æ¥å¾—åˆ°ç»„ä»¶å®ä¾‹ï¼Œä½¿ç”¨åå¯ä»¥ç›´æ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•æˆ–è®¿é—®æ•°æ®ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªç”¨ refæ¥è®¿é—®ç»„ä»¶çš„ä¾‹å­ï¼š 1234567891011121314151617181920212223242526// component-a å­ç»„ä»¶export default &#123; data () &#123; return &#123; title: &apos;Vue.js&apos; &#125; &#125;, methods: &#123; sayHello () &#123; window.alert(&apos;Hello&apos;); &#125; &#125;&#125;// çˆ¶ç»„ä»¶&lt;template&gt; &lt;component-a ref=&quot;comA&quot;&gt;&lt;/component-a&gt;&lt;/template&gt;&lt;script&gt; export default &#123; mounted () &#123; const comA = this.$refs.comA; console.log(comA.title); // Vue.js comA.sayHello(); // å¼¹çª— &#125; &#125;&lt;/script&gt; ä¸è¿‡ï¼Œè¿™ä¸¤ç§æ–¹æ³•çš„å¼Šç«¯æ˜¯ï¼Œæ— æ³•åœ¨è·¨çº§æˆ–å…„å¼Ÿé—´é€šä¿¡ã€‚ 1234// parent.vue&lt;component-a&gt;&lt;/component-a&gt;&lt;component-b&gt;&lt;/component-b&gt;&lt;component-b&gt;&lt;/component-b&gt; æˆ‘ä»¬æƒ³åœ¨ component-a ä¸­ï¼Œè®¿é—®åˆ°å¼•ç”¨å®ƒçš„é¡µé¢ä¸­ï¼ˆè¿™é‡Œå°±æ˜¯ parent.vueï¼‰çš„ä¸¤ä¸ª component-b ç»„ä»¶ï¼Œé‚£è¿™ç§æƒ…å†µä¸‹ï¼Œå°±å¾—é…ç½®é¢å¤–çš„æ’ä»¶æˆ–å·¥å…·äº†ï¼Œæ¯”å¦‚ Vuex å’Œ Bus çš„è§£å†³æ–¹æ¡ˆã€‚ ##æ€»ç»“ å¸¸è§ä½¿ç”¨åœºæ™¯å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š çˆ¶å­é€šä¿¡ï¼šçˆ¶å‘å­ä¼ é€’æ•°æ®æ˜¯é€šè¿‡ propsï¼Œå­å‘çˆ¶æ˜¯é€šè¿‡ eventsï¼ˆ$emitï¼‰ï¼›é€šè¿‡çˆ¶é“¾ / å­é“¾ä¹Ÿå¯ä»¥é€šä¿¡ï¼ˆ$parent / $childrenï¼‰ï¼›ref ä¹Ÿå¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ï¼›provide / inject APIï¼›$attrs/$listeners å…„å¼Ÿé€šä¿¡ï¼šBusï¼›Vuex è·¨çº§é€šä¿¡ï¼šBusï¼›Vuexï¼›provide / inject APIã€$attrs/$listeners","categories":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/categories/VUE/"}],"tags":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/tags/VUE/"}]},{"title":"Vueç›¸å…³é¢è¯•é¢˜","slug":"Vueç›¸å…³é¢è¯•é¢˜","date":"2020-02-17T02:45:21.000Z","updated":"2020-04-03T06:18:17.580Z","comments":true,"path":"2020/02/17/Vueç›¸å…³é¢è¯•é¢˜/","link":"","permalink":"http://yoursite.com/2020/02/17/Vueç›¸å…³é¢è¯•é¢˜/","excerpt":"","text":"vueVue.jsï¼ˆè¯»éŸ³ /vjuË/, ç±»ä¼¼äº viewï¼‰ æ˜¯ä¸€å¥—æ„å»ºç”¨æˆ·ç•Œé¢çš„ æ¸è¿›å¼æ¡†æ¶ã€‚ä¸å…¶ä»–é‡é‡çº§æ¡†æ¶ä¸åŒçš„æ˜¯ï¼ŒVue é‡‡ç”¨è‡ªåº•å‘ä¸Šå¢é‡å¼€å‘çš„è®¾è®¡ã€‚Vue çš„æ ¸å¿ƒåº“åªå…³æ³¨è§†å›¾å±‚ï¼Œå¹¶ä¸”éå¸¸å®¹æ˜“å­¦ä¹ ï¼Œéå¸¸å®¹æ˜“ä¸å…¶å®ƒåº“æˆ–å·²æœ‰é¡¹ç›®æ•´åˆã€‚å¦ä¸€æ–¹é¢ï¼ŒVue å®Œå…¨æœ‰èƒ½åŠ›é©±åŠ¨é‡‡ç”¨å•æ–‡ä»¶ç»„ä»¶å’Œ Vue ç”Ÿæ€ç³»ç»Ÿæ”¯æŒçš„åº“å¼€å‘çš„å¤æ‚å•é¡µåº”ç”¨ã€‚ Vue.js çš„ç›®æ ‡æ˜¯é€šè¿‡å°½å¯èƒ½ç®€å•çš„ API å®ç°å“åº”çš„æ•°æ®ç»‘å®šå’Œç»„åˆçš„è§†å›¾ç»„ä»¶ã€‚ å“åº”å¼ç¼–ç¨‹ï¼ˆåŒå‘æ•°æ®ç»‘å®š MVVMï¼‰ ç»„ä»¶åŒ– æ¨¡å—åŒ–ï¼ˆé…åˆ Webpack æˆ–è€… Browserifyç­‰æ‰“åŒ…å·¥å…·ï¼Œç„¶åå†åŠ ä¸Š ES2015ã€‚æ¯ä¸€ä¸ª Vue ç»„ä»¶éƒ½å¯ä»¥çœ‹åšä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼‰ åŠ¨ç”»ï¼ˆVue è‡ªå¸¦ç®€æ´æ˜“ç”¨çš„è¿‡æ¸¡åŠ¨ç”»ç³»ç»Ÿã€‚Vue çš„ååº”å¼ç³»ç»Ÿä¹Ÿä½¿å¾—å®ƒå¯ä»¥ç”¨æ¥å¼€å‘é«˜æ•ˆçš„æ•°æ®é©±åŠ¨çš„é€å¸§åŠ¨ç”»ã€‚è¿™ä¸€ç±»é€å¸§åŠ¨ç”»åœ¨åŸºäºè„æ£€æŸ¥æˆ–æ˜¯ Virtual DOM çš„æ¡†æ¶ä¸­ï¼Œå¾€å¾€ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºå³ä½¿åªæ˜¯æ”¹äº†ä¸€ä¸ªå€¼ï¼Œæ•´ä¸ªæ‰€å¤„çš„å­æ ‘ï¼ˆscope æˆ–æ˜¯ componentï¼‰éƒ½éœ€è¦é‡æ–°è®¡ç®—ã€‚è€Œ Vue åˆ™æ˜¯æ”¹äº†å¤šå°‘ï¼Œè®¡ç®—å¤šå°‘ï¼Œä¸ä¼šæœ‰æ— è°“çš„æµªè´¹ã€‚åœ¨å° demo ä¸­ï¼Œè„æ£€æŸ¥æˆ–æ˜¯ Virtual DOM å¾€å¾€ä¹Ÿè¶³å¤Ÿå¿«ï¼Œä½†æ˜¯åœ¨å¤§å‹åº”ç”¨ä¸­å¯å°±ä¸ä¸€å®šäº†ã€‚ï¼‰ Virtual DOM Vuex Vue-router 1. å¯¹äºMVVMçš„ç†è§£ï¼ŸMVVM æ˜¯ Model-View-ViewModel çš„ç¼©å†™ã€‚ Modelä»£è¡¨æ•°æ®æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥åœ¨Modelä¸­å®šä¹‰æ•°æ®ä¿®æ”¹å’Œæ“ä½œçš„ä¸šåŠ¡é€»è¾‘ã€‚ View ä»£è¡¨UI ç»„ä»¶ï¼Œå®ƒè´Ÿè´£å°†æ•°æ®æ¨¡å‹è½¬åŒ–æˆUI å±•ç°å‡ºæ¥ã€‚ ViewModel ç›‘å¬æ¨¡å‹æ•°æ®çš„æ”¹å˜å’Œæ§åˆ¶è§†å›¾è¡Œä¸ºã€å¤„ç†ç”¨æˆ·äº¤äº’ï¼Œç®€å•ç†è§£å°±æ˜¯ä¸€ä¸ªåŒæ­¥View å’Œ Modelçš„å¯¹è±¡ï¼Œè¿æ¥Modelå’ŒViewã€‚ åœ¨MVVMæ¶æ„ä¸‹ï¼ŒView å’Œ Model ä¹‹é—´å¹¶æ²¡æœ‰ç›´æ¥çš„è”ç³»ï¼Œè€Œæ˜¯é€šè¿‡ViewModelè¿›è¡Œäº¤äº’ï¼ŒModel å’Œ ViewModel ä¹‹é—´çš„äº¤äº’æ˜¯åŒå‘çš„ï¼Œ å› æ­¤View æ•°æ®çš„å˜åŒ–ä¼šåŒæ­¥åˆ°Modelä¸­ï¼Œè€ŒModel æ•°æ®çš„å˜åŒ–ä¹Ÿä¼šç«‹å³ååº”åˆ°View ä¸Šã€‚ ViewModel é€šè¿‡åŒå‘æ•°æ®ç»‘å®šæŠŠ View å±‚å’Œ Model å±‚è¿æ¥äº†èµ·æ¥ï¼Œè€ŒView å’Œ Model ä¹‹é—´çš„åŒæ­¥å·¥ä½œå®Œå…¨æ˜¯è‡ªåŠ¨çš„ï¼Œæ— éœ€äººä¸ºå¹²æ¶‰ï¼Œå› æ­¤å¼€å‘è€…åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ“ä½œDOM, ä¸éœ€è¦å…³æ³¨æ•°æ®çŠ¶æ€çš„åŒæ­¥é—®é¢˜ï¼Œå¤æ‚çš„æ•°æ®çŠ¶æ€ç»´æŠ¤å®Œå…¨ç”± MVVM æ¥ç»Ÿä¸€ç®¡ç†ã€‚ ###æ€ä¹ˆå®ç°MVVM è„å€¼æ£€æŸ¥ï¼šangularangular.js æ˜¯é€šè¿‡è„å€¼æ£€æµ‹çš„æ–¹å¼æ¯”å¯¹æ•°æ®æ˜¯å¦æœ‰å˜æ›´ï¼Œæ¥å†³å®šæ˜¯å¦æ›´æ–°è§†å›¾ã€‚ æ•°æ®åŠ«æŒï¼šä½¿ç”¨Object.defineProperty()æ–¹æ³•æŠŠè¿™äº›vm.dataå±æ€§å…¨éƒ¨è½¬æˆsetterã€getteræ–¹æ³•ã€‚ Vue MVVMçš„å®ç°(defineProperty) Vue3.0 MVVMçš„å®ç°(proxy)ï¼ˆVue 3.0 ä½¿ç”¨äº† Proxy åï¼Œå°†ä¼šæ¶ˆé™¤ä¹‹å‰ Vue 2.x ä¸­åŸºäº Object.defineProperty çš„å®ç°æ‰€å­˜åœ¨çš„ä¸€äº›é™åˆ¶ï¼šæ— æ³•ç›‘å¬ å±æ€§çš„æ·»åŠ å’Œåˆ é™¤ã€æ•°ç»„ç´¢å¼•å€¼å’Œé•¿åº¦çš„å˜æ›´ã€‚ï¼‰ MVVM å„æ¨¡å—èŒè´£ MVVM: Vue å®ä¾‹åˆå§‹åŒ–ï¼Œè°ƒç”¨ Observer æ•°æ®åŠ«æŒï¼Œè°ƒç”¨ Compiler è§£ææ¨¡æ¿ï¼› Observer: åˆ©ç”¨Object.definePropertyæ•°æ®åŠ«æŒdataå…¨éƒ¨å±æ€§ï¼Œå®šä¹‰ setter ã€getterï¼Œæ·»åŠ å’Œé€šçŸ¥è®¢é˜…è€…ï¼›ï¼ˆæ‰€ä»¥vueä¸èƒ½æ–°å¢å±æ€§å¿…é¡»äº‹å…ˆå®šä¹‰ï¼Œmodel-&gt;vm.dataï¼‰ Compiler: è§£ææ¨¡æ¿åˆå§‹åŒ–è§†å›¾ï¼Œæ”¶é›†æ¨¡æ¿ä¸­çš„æ•°æ®ä¾èµ–ï¼Œåˆ›å»ºè®¢é˜…è€…è®¢é˜…å˜åŒ–ï¼Œç»‘å®šæ›´æ–°å‡½æ•°ï¼›ï¼ˆåœ¨æ–‡æ¡£ç¢ç‰‡ä¸­æ“ä½œdomèŠ‚ç‚¹ï¼Œéå†æ­£åˆ™åŒ¹é…æ›¿æ¢dataå±æ€§ï¼Œview-&gt;vm.$elï¼‰ Depï¼šè®¢é˜…ä¸­å¿ƒï¼Œæä¾›æ·»åŠ ã€ç§»é™¤ã€é€šçŸ¥è®¢é˜…çš„æ¥å£ï¼› Watcher: data å±æ€§çš„è®¢é˜…è€…ï¼Œæ”¶åˆ°å˜åŒ–é€šçŸ¥åè°ƒç”¨æ›´æ–°å‡½æ•°æ›´æ–°è§†å›¾ã€‚ ###Object.defineProperty() å’Œ Proxy å®ç° MVVM æ•°æ®åŠ«æŒçš„åŒºåˆ« Object.defineProperty() å’Œ Proxy å®ç° MVVM æ•°æ®åŠ«æŒçš„åŒºåˆ«æ˜¯ï¼šObject.defineProperty() éœ€è¦ä¸ºæ¯ä¸ª key å®šä¹‰ getter å’Œ setterï¼Œä¹Ÿå°±æ˜¯éœ€è¦éå† data ä¸‹çš„å…¨éƒ¨å­å±æ€§ï¼›è€Œ Proxy åªéœ€è¦ä¸º data æœ¬èº«å’Œå†…éƒ¨åµŒå¥—çš„å¯¹è±¡åˆ›å»ºä»£ç†ï¼Œæ¯ä¸ªå¯¹è±¡ç»Ÿä¸€ä»£ç†è®¿é—®å†…éƒ¨å±æ€§ï¼Œå¯¹å¤–æä¾›ä»£ç†çš„å¼•ç”¨ã€‚ 2.vueç”Ÿå‘½å‘¨æœŸï¼š1. åœ¨beforeCreateå’Œcreatedé’©å­å‡½æ•°ä¹‹é—´çš„ç”Ÿå‘½å‘¨æœŸåœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¹‹é—´ï¼Œè¿›è¡Œåˆå§‹åŒ–äº‹ä»¶ï¼Œè¿›è¡Œæ•°æ®çš„è§‚æµ‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨createdçš„æ—¶å€™æ•°æ®å·²ç»å’Œdataå±æ€§è¿›è¡Œç»‘å®šï¼ˆæ”¾åœ¨dataä¸­çš„å±æ€§å½“å€¼å‘ç”Ÿæ”¹å˜çš„åŒæ—¶ï¼Œè§†å›¾ä¹Ÿä¼šæ”¹å˜ï¼‰ã€‚æ³¨æ„çœ‹ä¸‹ï¼šæ­¤æ—¶è¿˜æ˜¯æ²¡æœ‰elé€‰é¡¹ ç»„ä»¶å®ä¾‹åˆšåˆšåˆ›å»ºï¼Œè¿˜æœªè¿›è¡Œæ•°æ®è§‚æµ‹å’Œäº‹ä»¶é…ç½®//è¿™é‡Œä¸è¦è¢«beforeCreateè¯¯å¯¼ï¼Œå®é™…ä¸Šç»„ä»¶å®ä¾‹å·²ç»åˆ›å»ºäº† 2. createdé’©å­å‡½æ•°å’ŒbeforeMounté—´çš„ç”Ÿå‘½å‘¨æœŸå®ä¾‹å·²ç»åˆ›å»ºå®Œæˆï¼Œå¹¶ä¸”å·²ç»å®Œæˆæ•°æ®è§‚æµ‹ï¼Œå±æ€§å’Œæ–¹æ³•çš„è¿ç®—ï¼Œwatch/event äº‹ä»¶å›è°ƒã€‚//å¸¸ç”¨ï¼ï¼ï¼ é¦–å…ˆä¼šåˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰elé€‰é¡¹ã€‚å¦‚æœæœ‰çš„è¯å°±ç»§ç»­å‘ä¸‹ç¼–è¯‘ï¼Œå¦‚æœæ²¡æœ‰elé€‰é¡¹ï¼Œåˆ™åœæ­¢ç¼–è¯‘ï¼Œä¹Ÿå°±æ„å‘³ç€åœæ­¢äº†ç”Ÿå‘½å‘¨æœŸï¼Œç›´åˆ°åœ¨è¯¥vueå®ä¾‹ä¸Šè°ƒç”¨vm.$mount(el)ã€‚ ç„¶åï¼Œæˆ‘ä»¬å¾€ä¸‹çœ‹ï¼Œtemplateå‚æ•°é€‰é¡¹çš„æœ‰æ— å¯¹ç”Ÿå‘½å‘¨æœŸçš„å½±å“ã€‚ï¼ˆ1ï¼‰.å¦‚æœvueå®ä¾‹å¯¹è±¡ä¸­æœ‰templateå‚æ•°é€‰é¡¹ï¼Œåˆ™å°†å…¶ä½œä¸ºæ¨¡æ¿ç¼–è¯‘æˆrenderå‡½æ•°ã€‚ï¼ˆ2ï¼‰.å¦‚æœæ²¡æœ‰templateé€‰é¡¹ï¼Œåˆ™å°†å¤–éƒ¨HTMLä½œä¸ºæ¨¡æ¿ç¼–è¯‘ã€‚ï¼ˆ3ï¼‰.å¯ä»¥çœ‹åˆ°templateä¸­çš„æ¨¡æ¿ä¼˜å…ˆçº§è¦é«˜äºouter HTMLçš„ä¼˜å…ˆçº§ã€‚ æ‰€ä»¥ç»¼åˆæ’åä¼˜å…ˆçº§ï¼šrenderå‡½æ•°é€‰é¡¹ &gt; templateé€‰é¡¹ &gt; outer HTML. 3. beforeMountå’Œmounted é’©å­å‡½æ•°é—´çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥çœ‹åˆ°æ­¤æ—¶æ˜¯ç»™vueå®ä¾‹å¯¹è±¡æ·»åŠ $elæˆå‘˜ï¼Œå¹¶ä¸”æ›¿æ¢æ‰æŒ‚åœ¨çš„DOMå…ƒç´ ã€‚å› ä¸ºåœ¨ä¹‹å‰consoleä¸­æ‰“å°çš„ç»“æœå¯ä»¥çœ‹åˆ°beforeMountä¹‹å‰elä¸Šè¿˜æ˜¯undefinedã€‚ æ¨¡æ¿ç¼–è¯‘ä¹‹å‰ï¼Œè¿˜æ²¡æŒ‚è½½ï¼Œé¡µé¢ä»æœªå±•ç¤ºï¼Œä½†è™šæ‹ŸDomå·²ç»é…ç½®//å…ˆæŠŠå‘å ä½äº†ï¼Œåˆ°åé¢mountedæŒ‚è½½çš„æ—¶å€™å†æŠŠå€¼æ¸²æŸ“è¿›å» 4. mountedæ¨¡æ¿ç¼–è¯‘ä¹‹åï¼Œå·²ç»æŒ‚è½½ï¼Œæ­¤æ—¶æ‰ä¼šæ¸²æŸ“é¡µé¢ï¼Œæ‰èƒ½çœ‹åˆ°é¡µé¢ä¸Šæ•°æ®çš„å±•ç¤º//å¸¸ç”¨ï¼ï¼ï¼ æ³¨æ„: mounted ä¸ä¼šæ‰¿è¯ºæ‰€æœ‰çš„å­ç»„ä»¶ä¹Ÿéƒ½ä¸€èµ·è¢«æŒ‚è½½ã€‚å¦‚æœä½ å¸Œæœ›ç­‰åˆ°æ•´ä¸ªè§†å›¾éƒ½æ¸²æŸ“å®Œæ¯•ï¼Œå¯ä»¥ç”¨ vm.$nextTick æ›¿æ¢æ‰ mounted åœ¨mountedä¹‹å‰h1ä¸­è¿˜æ˜¯é€šè¿‡è¿›è¡Œå ä½çš„ï¼Œå› ä¸ºæ­¤æ—¶è¿˜æœ‰æŒ‚åœ¨åˆ°é¡µé¢ä¸Šï¼Œè¿˜æ˜¯JavaScriptä¸­çš„è™šæ‹ŸDOMå½¢å¼å­˜åœ¨çš„ã€‚åœ¨mountedä¹‹åå¯ä»¥çœ‹åˆ°h1ä¸­çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–ã€‚ el æ›¿æ¢ï¼Œå¹¶æŒ‚è½½åˆ°å®ä¾‹ä¸Šå»ä¹‹åè°ƒç”¨ã€‚å®ä¾‹å·²å®Œæˆä»¥ä¸‹çš„é…ç½®ï¼šç”¨ä¸Šé¢ç¼–è¯‘å¥½çš„htmlå†…å®¹æ›¿æ¢elå±æ€§æŒ‡å‘çš„DOMå¯¹è±¡ã€‚å®Œæˆæ¨¡æ¿ä¸­çš„htmlæ¸²æŸ“åˆ°htmlé¡µé¢ä¸­ã€‚æ­¤è¿‡ç¨‹ä¸­è¿›è¡Œajaxäº¤äº’ã€‚ 5. beforeUpdateï¼ˆæ›´æ–°å‰ï¼‰åœ¨æ•°æ®æ›´æ–°ä¹‹å‰è°ƒç”¨ï¼Œå‘ç”Ÿåœ¨è™šæ‹ŸDOMé‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ä¹‹å‰ã€‚å¯ä»¥åœ¨è¯¥é’©å­ä¸­è¿›ä¸€æ­¥åœ°æ›´æ”¹çŠ¶æ€ï¼Œä¸ä¼šè§¦å‘é™„åŠ çš„é‡æ¸²æŸ“è¿‡ç¨‹ã€‚ 6. updatedï¼ˆæ›´æ–°åï¼‰åœ¨ç”±äºæ•°æ®æ›´æ”¹å¯¼è‡´çš„è™šæ‹ŸDOMé‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ä¹‹åè°ƒç”¨ã€‚è°ƒç”¨æ—¶ï¼Œç»„ä»¶DOMå·²ç»æ›´æ–°ï¼Œæ‰€ä»¥å¯ä»¥æ‰§è¡Œä¾èµ–äºDOMçš„æ“ä½œã€‚ç„¶è€Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåº”è¯¥é¿å…åœ¨æ­¤æœŸé—´æ›´æ”¹çŠ¶æ€ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´æ›´æ–°æ— é™å¾ªç¯ã€‚è¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨ã€‚ 7. beforeDestroyï¼ˆé”€æ¯å‰ï¼‰åœ¨å®ä¾‹é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚å®ä¾‹ä»ç„¶å®Œå…¨å¯ç”¨ã€‚ 8. destroyedï¼ˆé”€æ¯åï¼‰åœ¨å®ä¾‹é”€æ¯ä¹‹åè°ƒç”¨ã€‚è°ƒç”¨åï¼Œæ‰€æœ‰çš„äº‹ä»¶ç›‘å¬å™¨ä¼šè¢«ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å®ä¾‹ä¹Ÿä¼šè¢«é”€æ¯ã€‚è¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨ã€‚ å…³äºç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜ï¼š1.ä»€ä¹ˆæ˜¯vueç”Ÿå‘½å‘¨æœŸï¼Ÿ ç­”ï¼š Vue å®ä¾‹ä»åˆ›å»ºåˆ°é”€æ¯çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ç”Ÿå‘½å‘¨æœŸã€‚ä»å¼€å§‹åˆ›å»ºã€åˆå§‹åŒ–æ•°æ®ã€ç¼–è¯‘æ¨¡æ¿ã€æŒ‚è½½Domâ†’æ¸²æŸ“ã€æ›´æ–°â†’æ¸²æŸ“ã€é”€æ¯ç­‰ä¸€ç³»åˆ—è¿‡ç¨‹ï¼Œç§°ä¹‹ä¸º Vue çš„ç”Ÿå‘½å‘¨æœŸã€‚ 2.vueç”Ÿå‘½å‘¨æœŸçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼šå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸­æœ‰å¤šä¸ªäº‹ä»¶é’©å­ï¼Œè®©æˆ‘ä»¬åœ¨æ§åˆ¶æ•´ä¸ªVueå®ä¾‹çš„è¿‡ç¨‹æ—¶æ›´å®¹æ˜“å½¢æˆå¥½çš„é€»è¾‘ã€‚ 3.vueç”Ÿå‘½å‘¨æœŸæ€»å…±æœ‰å‡ ä¸ªé˜¶æ®µï¼Ÿ ç­”ï¼šå®ƒå¯ä»¥æ€»å…±åˆ†ä¸º8ä¸ªé˜¶æ®µï¼šåˆ›å»ºå‰/å, è½½å…¥å‰/å,æ›´æ–°å‰/å,é”€æ¯å‰/é”€æ¯åã€‚ 4.ç¬¬ä¸€æ¬¡é¡µé¢åŠ è½½ä¼šè§¦å‘å“ªå‡ ä¸ªé’©å­ï¼Ÿ ç­”ï¼šä¼šè§¦å‘ ä¸‹é¢è¿™å‡ ä¸ªbeforeCreate, created, beforeMount, mounted 5.DOM æ¸²æŸ“åœ¨ å“ªä¸ªå‘¨æœŸä¸­å°±å·²ç»å®Œæˆï¼Ÿ ç­”ï¼šDOM æ¸²æŸ“åœ¨ mounted ä¸­å°±å·²ç»å®Œæˆäº†ã€‚ 3.Vueå®ç°æ•°æ®åŒå‘ç»‘å®šçš„åŸç†ï¼šObject.definePropertyï¼ˆï¼‰vueå®ç°æ•°æ®åŒå‘ç»‘å®šä¸»è¦æ˜¯ï¼šé‡‡ç”¨æ•°æ®åŠ«æŒç»“åˆå‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼çš„æ–¹å¼ï¼Œé€šè¿‡Object.definePropertyï¼ˆï¼‰æ¥åŠ«æŒå„ä¸ªå±æ€§çš„setterï¼Œgetterï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œè§¦å‘ç›¸åº”ç›‘å¬å›è°ƒã€‚å½“æŠŠä¸€ä¸ªæ™®é€š Javascript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹æ¥ä½œä¸ºå®ƒçš„ data é€‰é¡¹æ—¶ï¼ŒVue å°†éå†å®ƒçš„å±æ€§ï¼Œç”¨ Object.defineProperty å°†å®ƒä»¬è½¬ä¸º getter/setterã€‚ç”¨æˆ·çœ‹ä¸åˆ° getter/setterï¼Œä½†æ˜¯åœ¨å†…éƒ¨å®ƒä»¬è®© Vue è¿½è¸ªä¾èµ–ï¼Œåœ¨å±æ€§è¢«è®¿é—®å’Œä¿®æ”¹æ—¶é€šçŸ¥å˜åŒ–ã€‚ vueçš„æ•°æ®åŒå‘ç»‘å®š å°†MVVMä½œä¸ºæ•°æ®ç»‘å®šçš„å…¥å£ï¼Œæ•´åˆObserverï¼ŒCompileå’ŒWatcherä¸‰è€…ï¼Œé€šè¿‡Observeræ¥ç›‘å¬è‡ªå·±çš„modelçš„æ•°æ®å˜åŒ–ï¼Œé€šè¿‡Compileæ¥è§£æç¼–è¯‘æ¨¡æ¿æŒ‡ä»¤ï¼ˆvueä¸­æ˜¯ç”¨æ¥è§£æåŒèŠ±æ‹¬å·çš„ï¼‰ï¼Œæœ€ç»ˆåˆ©ç”¨watcheræ­èµ·observerå’ŒCompileä¹‹é—´çš„é€šä¿¡æ¡¥æ¢ï¼Œè¾¾åˆ°æ•°æ®å˜åŒ– â€”&gt;è§†å›¾æ›´æ–°ï¼›è§†å›¾äº¤äº’å˜åŒ–ï¼ˆinputï¼‰â€”&gt;æ•°æ®modelå˜æ›´åŒå‘ç»‘å®šæ•ˆæœã€‚ å…³äºObject.defineProperty è¯­æ³• Object.defineProperty(obj,prop,descriptor) å‚æ•° obj:ç›®æ ‡å¯¹è±¡ prop:éœ€è¦å®šä¹‰çš„å±æ€§æˆ–æ–¹æ³•çš„åç§° descriptor:ç›®æ ‡å±æ€§æ‰€æ‹¥æœ‰çš„ç‰¹æ€§ å¯ä¾›å®šä¹‰çš„ç‰¹æ€§åˆ—è¡¨ value:å±æ€§çš„å€¼ writable:å¦‚æœä¸ºfalseï¼Œå±æ€§çš„å€¼å°±ä¸èƒ½è¢«é‡å†™ã€‚ get: ä¸€æ—¦ç›®æ ‡å±æ€§è¢«è®¿é—®å°±ä¼šè°ƒå›æ­¤æ–¹æ³•ï¼Œå¹¶å°†æ­¤æ–¹æ³•çš„è¿ç®—ç»“æœè¿”å›ç”¨æˆ·ã€‚ set:ä¸€æ—¦ç›®æ ‡å±æ€§è¢«èµ‹å€¼ï¼Œå°±ä¼šè°ƒå›æ­¤æ–¹æ³•ã€‚ configurable:å¦‚æœä¸ºfalseï¼Œåˆ™ä»»ä½•å°è¯•åˆ é™¤ç›®æ ‡å±æ€§æˆ–ä¿®æ”¹å±æ€§æ€§ä»¥ä¸‹ç‰¹æ€§ï¼ˆwritable, configurable, enumerableï¼‰çš„è¡Œä¸ºå°†è¢«æ— æ•ˆåŒ–ã€‚ enumerable:æ˜¯å¦èƒ½åœ¨forâ€¦inå¾ªç¯ä¸­éå†å‡ºæ¥æˆ–åœ¨Object.keysä¸­åˆ—ä¸¾å‡ºæ¥ã€‚ jså®ç°ç®€å•çš„åŒå‘ç»‘å®š 123456789101112131415161718192021&lt;body&gt; &lt;div id=\"app\"&gt; &lt;input type=\"text\"id=\"txt\"/&gt; &lt;p id=\"show\"&gt;&lt;/p&gt; &lt;/div&gt;&lt;/body&gt;&lt;script type=\"text/javascript\"&gt; var obj = &#123;&#125; Object.defineProperty(obj, 'txt', &#123; get: function () &#123; return obj &#125;, set: function (newValue) &#123; document.getElementById('txt').value = newValue document.getElementById('show').innerHTML = newValue &#125; &#125;) document.addEventListener('keyup', function (e) &#123; obj.txt = e.target.value &#125;)&lt;/script&gt; 4. Vueçš„è·¯ç”±å®ç°ï¼šhashæ¨¡å¼ å’Œ historyæ¨¡å¼hashæ¨¡å¼ï¼šåœ¨æµè§ˆå™¨ä¸­ç¬¦å·â€œ#â€ï¼Œ#ä»¥åŠ#åé¢çš„å­—ç¬¦ç§°ä¹‹ä¸ºhashï¼Œç”¨window.location.hashè¯»å–ï¼› ç‰¹ç‚¹ï¼šhashè™½ç„¶åœ¨URLä¸­ï¼Œä½†ä¸è¢«åŒ…æ‹¬åœ¨HTTPè¯·æ±‚ä¸­ï¼›ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨åŠ¨ä½œï¼Œå¯¹æœåŠ¡ç«¯å®‰å…¨æ— ç”¨ï¼Œhashä¸ä¼šé‡åŠ è½½é¡µé¢ã€‚ hash æ¨¡å¼ä¸‹ï¼Œä»… hash ç¬¦å·ä¹‹å‰çš„å†…å®¹ä¼šè¢«åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œå¦‚ www.xxx.comï¼Œå› æ­¤å¯¹äºåç«¯æ¥è¯´ï¼Œå³ä½¿æ²¡æœ‰åšåˆ°å¯¹è·¯ç”±çš„å…¨è¦†ç›–ï¼Œä¹Ÿä¸ä¼šè¿”å› 404 é”™è¯¯ã€‚ historyæ¨¡å¼ï¼šhistoryé‡‡ç”¨HTML5çš„æ–°ç‰¹æ€§ï¼›ä¸”æä¾›äº†ä¸¤ä¸ªæ–°æ–¹æ³•ï¼špushStateï¼ˆï¼‰ï¼ŒreplaceStateï¼ˆï¼‰å¯ä»¥å¯¹æµè§ˆå™¨å†å²è®°å½•æ ˆè¿›è¡Œä¿®æ”¹ï¼Œä»¥åŠpopStateäº‹ä»¶çš„ç›‘å¬åˆ°çŠ¶æ€å˜æ›´ã€‚ history æ¨¡å¼ä¸‹ï¼Œå‰ç«¯çš„ URL å¿…é¡»å’Œå®é™…å‘åç«¯å‘èµ·è¯·æ±‚çš„ URL ä¸€è‡´ï¼Œå¦‚ www.xxx.com/items/idã€‚åç«¯å¦‚æœç¼ºå°‘å¯¹ /items/id çš„è·¯ç”±å¤„ç†ï¼Œå°†è¿”å› 404 é”™è¯¯ã€‚Vue-Router å®˜ç½‘é‡Œå¦‚æ­¤æè¿°ï¼šâ€œä¸è¿‡è¿™ç§æ¨¡å¼è¦ç©å¥½ï¼Œè¿˜éœ€è¦åå°é…ç½®æ”¯æŒâ€¦â€¦æ‰€ä»¥å‘¢ï¼Œä½ è¦åœ¨æœåŠ¡ç«¯å¢åŠ ä¸€ä¸ªè¦†ç›–æ‰€æœ‰æƒ…å†µçš„å€™é€‰èµ„æºï¼šå¦‚æœ URL åŒ¹é…ä¸åˆ°ä»»ä½•é™æ€èµ„æºï¼Œåˆ™åº”è¯¥è¿”å›åŒä¸€ä¸ª index.html é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢å°±æ˜¯ä½  app ä¾èµ–çš„é¡µé¢ã€‚â€ 5. Vueä¸Angularä»¥åŠReactçš„åŒºåˆ«ï¼Ÿ1.ä¸AngularJSçš„åŒºåˆ« ç›¸åŒç‚¹ï¼š éƒ½æ”¯æŒæŒ‡ä»¤ï¼šå†…ç½®æŒ‡ä»¤å’Œè‡ªå®šä¹‰æŒ‡ä»¤ï¼›éƒ½æ”¯æŒè¿‡æ»¤å™¨ï¼šå†…ç½®è¿‡æ»¤å™¨å’Œè‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼›éƒ½æ”¯æŒåŒå‘æ•°æ®ç»‘å®šï¼›éƒ½ä¸æ”¯æŒä½ç«¯æµè§ˆå™¨ã€‚ ä¸åŒç‚¹ï¼š AngularJSçš„å­¦ä¹ æˆæœ¬é«˜ï¼Œæ¯”å¦‚å¢åŠ äº†Dependency Injectionç‰¹æ€§ï¼Œè€ŒVue.jsæœ¬èº«æä¾›çš„APIéƒ½æ¯”è¾ƒç®€å•ã€ç›´è§‚ï¼›åœ¨æ€§èƒ½ä¸Šï¼ŒAngularJSä¾èµ–å¯¹æ•°æ®åšè„æ£€æŸ¥ï¼Œæ‰€ä»¥Watcherè¶Šå¤šè¶Šæ…¢ï¼›Vue.jsä½¿ç”¨åŸºäºä¾èµ–è¿½è¸ªçš„è§‚å¯Ÿå¹¶ä¸”ä½¿ç”¨å¼‚æ­¥é˜Ÿåˆ—æ›´æ–°ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ç‹¬ç«‹è§¦å‘çš„ã€‚ 2.ä¸Reactçš„åŒºåˆ« ï¼ˆè¯¦è§vueå’ŒreactåŒºåˆ«ï¼‰ ç›¸åŒç‚¹ï¼š Reacté‡‡ç”¨ç‰¹æ®Šçš„JSXè¯­æ³•ï¼ŒVue.jsåœ¨ç»„ä»¶å¼€å‘ä¸­ä¹Ÿæ¨å´‡ç¼–å†™.vueç‰¹æ®Šæ–‡ä»¶æ ¼å¼ï¼Œå¯¹æ–‡ä»¶å†…å®¹éƒ½æœ‰ä¸€äº›çº¦å®šï¼Œä¸¤è€…éƒ½éœ€è¦ç¼–è¯‘åä½¿ç”¨ï¼› ä¸­å¿ƒæ€æƒ³ç›¸åŒï¼šä¸€åˆ‡éƒ½æ˜¯ç»„ä»¶ï¼Œç»„ä»¶å®ä¾‹ä¹‹é—´å¯ä»¥åµŒå¥—ï¼› éƒ½æä¾›åˆç†çš„é’©å­å‡½æ•°ï¼Œå¯ä»¥è®©å¼€å‘è€…å®šåˆ¶åŒ–åœ°å»å¤„ç†éœ€æ±‚ï¼› åœ¨ç»„ä»¶å¼€å‘ä¸­éƒ½æ”¯æŒmixinsçš„ç‰¹æ€§ã€‚ ä½¿ç”¨ Virtual DOMï¼Œæœ‰è‡ªå·±çš„diffæ¸²æŸ“ç®—æ³• æä¾›äº†å“åº”å¼ (Reactive) å’Œç»„ä»¶åŒ– (Composable) çš„è§†å›¾ç»„ä»¶ã€‚ å°†æ³¨æ„åŠ›é›†ä¸­ä¿æŒåœ¨æ ¸å¿ƒåº“ï¼Œè€Œå°†å…¶ä»–åŠŸèƒ½å¦‚è·¯ç”±å’Œå…¨å±€çŠ¶æ€ç®¡ç†äº¤ç»™ç›¸å…³çš„åº“ã€‚éƒ½ä¸å†…ç½®åˆ—æ•°AJAXï¼ŒRouteç­‰åŠŸèƒ½åˆ°æ ¸å¿ƒåŒ…ï¼Œè€Œæ˜¯ä»¥æ’ä»¶çš„æ–¹å¼åŠ è½½ã€‚ ä¸åŒç‚¹ï¼š Reacté‡‡ç”¨çš„Virtual DOMä¼šå¯¹æ¸²æŸ“å‡ºæ¥çš„ç»“æœåšè„æ£€æŸ¥ï¼›åœ¨ React åº”ç”¨ä¸­ï¼Œå½“æŸä¸ªç»„ä»¶çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒä¼šä»¥è¯¥ç»„ä»¶ä¸ºæ ¹ï¼Œé‡æ–°æ¸²æŸ“æ•´ä¸ªç»„ä»¶å­æ ‘ã€‚ å¦‚è¦é¿å…ä¸å¿…è¦çš„å­ç»„ä»¶çš„é‡æ¸²æŸ“ï¼Œä½ éœ€è¦åœ¨æ‰€æœ‰å¯èƒ½çš„åœ°æ–¹ä½¿ç”¨ PureComponentï¼Œæˆ–æ˜¯æ‰‹åŠ¨å®ç° shouldComponentUpdate æ–¹æ³•ã€‚åŒæ—¶ä½ å¯èƒ½ä¼šéœ€è¦ä½¿ç”¨ä¸å¯å˜çš„æ•°æ®ç»“æ„æ¥ä½¿å¾—ä½ çš„ç»„ä»¶æ›´å®¹æ˜“è¢«ä¼˜åŒ–ã€‚ ç„¶è€Œï¼Œä½¿ç”¨ PureComponent å’Œ shouldComponentUpdate æ—¶ï¼Œéœ€è¦ä¿è¯è¯¥ç»„ä»¶çš„æ•´ä¸ªå­æ ‘çš„æ¸²æŸ“è¾“å‡ºéƒ½æ˜¯ç”±è¯¥ç»„ä»¶çš„ props æ‰€å†³å®šçš„ã€‚å¦‚æœä¸ç¬¦åˆè¿™ä¸ªæƒ…å†µï¼Œé‚£ä¹ˆæ­¤ç±»ä¼˜åŒ–å°±ä¼šå¯¼è‡´éš¾ä»¥å¯Ÿè§‰çš„æ¸²æŸ“ç»“æœä¸ä¸€è‡´ã€‚è¿™ä½¿å¾— React ä¸­çš„ç»„ä»¶ä¼˜åŒ–ä¼´éšç€ç›¸å½“çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚ åœ¨ Vue åº”ç”¨ä¸­ï¼Œç»„ä»¶çš„ä¾èµ–æ˜¯åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­è‡ªåŠ¨è¿½è¸ªçš„ï¼Œæ‰€ä»¥ç³»ç»Ÿèƒ½ç²¾ç¡®çŸ¥æ™“å“ªä¸ªç»„ä»¶ç¡®å®éœ€è¦è¢«é‡æ¸²æŸ“ã€‚ä½ å¯ä»¥ç†è§£ä¸ºæ¯ä¸€ä¸ªç»„ä»¶éƒ½å·²ç»è‡ªåŠ¨è·å¾—äº† shouldComponentUpdateï¼Œå¹¶ä¸”æ²¡æœ‰ä¸Šè¿°çš„å­æ ‘é—®é¢˜é™åˆ¶ã€‚ Vue.jsåœ¨æ¨¡æ¿ä¸­æä¾›äº†æŒ‡ä»¤ï¼Œè¿‡æ»¤å™¨ç­‰ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿ï¼Œå¿«æ·åœ°æ“ä½œVirtual DOMã€‚ 6. vueè·¯ç”±çš„é’©å­å‡½æ•°é¦–é¡µå¯ä»¥æ§åˆ¶å¯¼èˆªè·³è½¬ï¼ŒbeforeEachï¼ŒafterEachç­‰ï¼Œä¸€èˆ¬ç”¨äºé¡µé¢titleçš„ä¿®æ”¹ã€‚ä¸€äº›éœ€è¦ç™»å½•æ‰èƒ½è°ƒæ•´é¡µé¢çš„é‡å®šå‘åŠŸèƒ½ã€‚ beforeEachä¸»è¦æœ‰3ä¸ªå‚æ•°toï¼Œfromï¼Œnextï¼š toï¼šrouteå³å°†è¿›å…¥çš„ç›®æ ‡è·¯ç”±å¯¹è±¡ï¼Œ fromï¼šrouteå½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”± nextï¼šfunctionä¸€å®šè¦è°ƒç”¨è¯¥æ–¹æ³•resolveè¿™ä¸ªé’©å­ã€‚æ‰§è¡Œæ•ˆæœä¾èµ–nextæ–¹æ³•çš„è°ƒç”¨å‚æ•°ã€‚å¯ä»¥æ§åˆ¶ç½‘é¡µçš„è·³è½¬ã€‚ 7. vueä¸­å¸¸ç”¨çš„æŒ‡ä»¤æœ‰å“ªäº›ï¼ŸæŒ‡ä»¤ è§£é‡Šï¼šæŒ‡ä»¤ (Directives) æ˜¯å¸¦æœ‰ v- å‰ç¼€çš„ç‰¹æ®Šå±æ€§ ä½œç”¨ï¼šå½“è¡¨è¾¾å¼çš„å€¼æ”¹å˜æ—¶ï¼Œå°†å…¶äº§ç”Ÿçš„è¿å¸¦å½±å“ï¼Œå“åº”å¼åœ°ä½œç”¨äº DOM å¸¸ç”¨æŒ‡ä»¤1.v-textï¼šæ›´æ–°å…ƒç´ çš„ textContent1&lt;h1 v-text=&quot;msg&quot;&gt;&lt;/h1&gt; 2.v-htmlï¼šæ›´æ–°å…ƒç´ çš„ innerHTML1&lt;h1 v-html=&quot;msg&quot;&gt;&lt;/h1&gt; 3.v-bind ä½œç”¨ï¼šå½“è¡¨è¾¾å¼çš„å€¼æ”¹å˜æ—¶ï¼Œå°†å…¶äº§ç”Ÿçš„è¿å¸¦å½±å“ï¼Œå“åº”å¼åœ°ä½œç”¨äº DOM è¯­æ³•ï¼šv-bind:title=&quot;msg&quot; ç®€å†™ï¼š:title=&quot;msg&quot; 12345678910111213141516&lt;!-- å®Œæ•´è¯­æ³• --&gt;&lt;a v-bind:href=&quot;url&quot;&gt;&lt;/a&gt;&lt;!-- ç¼©å†™ --&gt;&lt;a :href=&quot;url&quot;&gt;&lt;/a&gt;&lt;script&gt; // 2 åˆ›å»º Vue çš„å®ä¾‹å¯¹è±¡ var vm = new Vue(&#123; // el ç”¨æ¥æŒ‡å®švueæŒ‚è½½åˆ°é¡µé¢ä¸­çš„å…ƒç´ ï¼Œå€¼æ˜¯ï¼šé€‰æ‹©å™¨ // ç†è§£ï¼šç”¨æ¥æŒ‡å®švueç®¡ç†çš„HTMLåŒºåŸŸ el: &apos;#app&apos;, // æ•°æ®å¯¹è±¡ï¼Œç”¨æ¥ç»™è§†å›¾ä¸­æä¾›æ•°æ®çš„ data: &#123; url: &apos;http://www.baidu.com&apos; &#125; &#125;) &lt;/script&gt; 4.v-on ä½œç”¨ï¼šç»‘å®šäº‹ä»¶ è¯­æ³•ï¼šv-on:click=&quot;say&quot; or v-on:click=&quot;say(&#39;å‚æ•°&#39;, $event)&quot; ç®€å†™ï¼š@click=&quot;say&quot; è¯´æ˜ï¼šç»‘å®šçš„äº‹ä»¶ä»methodsä¸­è·å– 1234567891011121314151617181920&lt;!-- å®Œæ•´è¯­æ³• --&gt;&lt;a v-on:click=&quot;doSomething&quot;&gt;&lt;/a&gt;&lt;!-- ç¼©å†™ --&gt;&lt;a @click=&quot;doSomething&quot;&gt;&lt;/a&gt;&lt;!-- æ–¹æ³•ä¼ å‚ --&gt;&lt;a @click=&quot;doSomethingï¼ˆâ€œ123â€ï¼‰&quot;&gt;&lt;/a&gt; &lt;script&gt; // 2 åˆ›å»º Vue çš„å®ä¾‹å¯¹è±¡ var vm = new Vue(&#123; el: &apos;#app&apos;, // methodså±æ€§ç”¨æ¥ç»™vueå®ä¾‹æä¾›æ–¹æ³•ï¼ˆäº‹ä»¶ï¼‰ methods: &#123; doSomething: function(str) &#123; //æ¥å—å‚æ•°ï¼Œå¹¶è¾“å‡º console.log(str); &#125; &#125; &#125;) &lt;/script&gt; 5.v-modelæ•°æ®å“åº”ï¼Œæ˜¯é€šè¿‡æ•°æ®çš„æ”¹å˜å»é©±åŠ¨ DOM è§†å›¾çš„å˜åŒ–ï¼Œè€ŒåŒå‘ç»‘å®šé™¤äº†æ•°æ®é©±åŠ¨ DOM å¤–ï¼Œ DOM çš„å˜åŒ–åè¿‡æ¥å½±å“æ•°æ®ï¼Œæ˜¯ä¸€ä¸ªåŒå‘å…³ç³»ï¼Œåœ¨ Vue ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ v-model æ¥å®ç°åŒå‘ç»‘å®šã€‚ ä½œç”¨ï¼šåœ¨è¡¨å•å…ƒç´ ä¸Šåˆ›å»ºåŒå‘æ•°æ®ç»‘å®š è¯´æ˜ï¼šç›‘å¬ç”¨æˆ·çš„è¾“å…¥äº‹ä»¶ä»¥æ›´æ–°æ•°æ® 12&lt;input v-model=&quot;message&quot; placeholder=&quot;edit me&quot;&gt;&lt;p&gt;Message is: &#123;&#123; message &#125;&#125;&lt;/p&gt; v-modelåªä¸è¿‡æ˜¯ä¸€ä¸ªè¯­æ³•ç³–è€Œå·²,çœŸæ­£çš„å®ç°é çš„è¿˜æ˜¯ v-bind:ç»‘å®šå“åº”å¼æ•°æ® è§¦å‘ input äº‹ä»¶ï¼Œå¹¶ä¼ é€’æ•°æ® (é‡ç‚¹) v-model åœ¨ä¸åŒçš„ HTML æ ‡ç­¾ä¸Šä½¿ç”¨ä¼šç›‘æ§ä¸åŒçš„å±æ€§å’ŒæŠ›å‡ºä¸åŒçš„äº‹ä»¶ï¼š text å’Œ textarea å…ƒç´ ä½¿ç”¨ value å±æ€§å’Œ input äº‹ä»¶ï¼› checkbox å’Œ radio ä½¿ç”¨ checked å±æ€§å’Œ change äº‹ä»¶ï¼› select å­—æ®µå°† value ä½œä¸º prop å¹¶å°† change ä½œä¸ºäº‹ä»¶ã€‚ v-modelæºç åˆ†æ 6.v-for ä½œç”¨ï¼šåŸºäºæºæ•°æ®å¤šæ¬¡æ¸²æŸ“å…ƒç´ æˆ–æ¨¡æ¿å— keyå±æ€§ æ¨èï¼šä½¿ç”¨ v-for çš„æ—¶å€™æä¾› key å±æ€§ï¼Œä»¥è·å¾—æ€§èƒ½æå‡ã€‚ è¯´æ˜ï¼šä½¿ç”¨ keyï¼ŒVUEä¼šåŸºäº key çš„å˜åŒ–é‡æ–°æ’åˆ—å…ƒç´ é¡ºåºï¼Œå¹¶ä¸”ä¼šç§»é™¤ key ä¸å­˜åœ¨çš„å…ƒç´ ã€‚ 12345678910&lt;!-- 1 åŸºç¡€ç”¨æ³• --&gt;&lt;div v-for=&quot;item in items&quot;&gt; &#123;&#123; item.text &#125;&#125;&lt;/div&gt;&lt;!-- item ä¸ºå½“å‰é¡¹ï¼Œindex ä¸ºç´¢å¼• --&gt;&lt;p v-for=&quot;(item, index) in list&quot;&gt;&#123;&#123;item&#125;&#125; -- &#123;&#123;index&#125;&#125;&lt;/p&gt;&lt;!-- item ä¸ºå€¼ï¼Œkey ä¸ºé”®ï¼Œindex ä¸ºç´¢å¼• --&gt;&lt;p v-for=&quot;(item, key, index) in obj&quot;&gt;&#123;&#123;item&#125;&#125; -- &#123;&#123;key&#125;&#125;&lt;/p&gt;&lt;p v-for=&quot;item in 10&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/p&gt; 7.v-if å’Œ v-show æ¡ä»¶æ¸²æŸ“ v-ifï¼šæ ¹æ®è¡¨è¾¾å¼çš„å€¼çš„çœŸå‡æ¡ä»¶ï¼Œé”€æ¯æˆ–é‡å»ºå…ƒç´  v-showï¼šæ ¹æ®è¡¨è¾¾å¼ä¹‹çœŸå‡å€¼ï¼Œåˆ‡æ¢å…ƒç´ çš„ display CSS å±æ€§ 8.æå‡ç”¨æˆ·ä½“éªŒï¼šv-cloak è¿™ä¸ªæŒ‡ä»¤ä¿æŒåœ¨å…ƒç´ ä¸Šç›´åˆ°å…³è”å®ä¾‹ç»“æŸç¼–è¯‘ã€‚å’Œ CSS è§„åˆ™å¦‚ [v-cloak] { display: none } ä¸€èµ·ç”¨æ—¶ï¼Œè¿™ä¸ªæŒ‡ä»¤å¯ä»¥éšè—æœªç¼–è¯‘çš„ Mustache æ ‡ç­¾ç›´åˆ°å®ä¾‹å‡†å¤‡å®Œæ¯•ã€‚ é˜²æ­¢åˆ·æ–°é¡µé¢ï¼Œç½‘é€Ÿæ…¢çš„æƒ…å†µä¸‹å‡ºç°ç­‰æ•°æ®æ ¼å¼ 123&lt;div v-cloak&gt; &#123;&#123; message &#125;&#125;&lt;/div&gt; 9.æå‡æ€§èƒ½ï¼šv-pre è¯´æ˜ï¼šè·³è¿‡è¿™ä¸ªå…ƒç´ å’Œå®ƒçš„å­å…ƒç´ çš„ç¼–è¯‘è¿‡ç¨‹ã€‚å¯ä»¥ç”¨æ¥æ˜¾ç¤ºåŸå§‹ Mustache æ ‡ç­¾ã€‚è·³è¿‡å¤§é‡æ²¡æœ‰æŒ‡ä»¤çš„èŠ‚ç‚¹ä¼šåŠ å¿«ç¼–è¯‘ã€‚ 1&lt;span v-pre&gt;&#123;&#123; this will not be compiled &#125;&#125;&lt;/span&gt; 10.æå‡æ€§èƒ½ï¼šv-once è¯´æ˜ï¼šåªæ¸²æŸ“å…ƒç´ å’Œç»„ä»¶ä¸€æ¬¡ã€‚éšåçš„é‡æ–°æ¸²æŸ“ï¼Œå…ƒç´ /ç»„ä»¶åŠå…¶æ‰€æœ‰çš„å­èŠ‚ç‚¹å°†è¢«è§†ä¸ºé™æ€å†…å®¹å¹¶è·³è¿‡ã€‚è¿™å¯ä»¥ç”¨äºä¼˜åŒ–æ›´æ–°æ€§èƒ½ã€‚ 1&lt;span v-once&gt;This will never change: &#123;&#123;msg&#125;&#125;&lt;/span&gt; è‡ªå®šä¹‰æŒ‡ä»¤é™¤äº†æ ¸å¿ƒåŠŸèƒ½é»˜è®¤å†…ç½®çš„æŒ‡ä»¤ (v-model å’Œ v-show)ï¼ŒVue ä¹Ÿå…è®¸æ³¨å†Œè‡ªå®šä¹‰æŒ‡ä»¤ã€‚æ³¨æ„ï¼Œåœ¨ Vue2.0 ä¸­ï¼Œä»£ç å¤ç”¨å’ŒæŠ½è±¡çš„ä¸»è¦å½¢å¼æ˜¯ç»„ä»¶ã€‚ç„¶è€Œï¼Œæœ‰çš„æƒ…å†µä¸‹ï¼Œä½ ä»ç„¶éœ€è¦å¯¹æ™®é€š DOM å…ƒç´ è¿›è¡Œåº•å±‚æ“ä½œï¼Œè¿™æ—¶å€™å°±ä¼šç”¨åˆ°è‡ªå®šä¹‰æŒ‡ä»¤ã€‚ ä¾‹å¦‚ï¼š å½“é¡µé¢åŠ è½½æ—¶ï¼Œè¯¥å…ƒç´ å°†è·å¾—ç„¦ç‚¹ (æ³¨æ„ï¼šautofocus åœ¨ç§»åŠ¨ç‰ˆ Safari ä¸Šä¸å·¥ä½œ)ã€‚äº‹å®ä¸Šï¼Œåªè¦ä½ åœ¨æ‰“å¼€è¿™ä¸ªé¡µé¢åè¿˜æ²¡ç‚¹å‡»è¿‡ä»»ä½•å†…å®¹ï¼Œè¿™ä¸ªè¾“å…¥æ¡†å°±åº”å½“è¿˜æ˜¯å¤„äºèšç„¦çŠ¶æ€ã€‚ç°åœ¨è®©æˆ‘ä»¬ç”¨æŒ‡ä»¤æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š 12345678// æ³¨å†Œä¸€ä¸ªå…¨å±€è‡ªå®šä¹‰æŒ‡ä»¤ `v-focus`Vue.directive(&apos;focus&apos;, &#123; // å½“è¢«ç»‘å®šçš„å…ƒç´ æ’å…¥åˆ° DOM ä¸­æ—¶â€¦â€¦ inserted: function (el) &#123; // èšç„¦å…ƒç´  el.focus() &#125;&#125;) å¦‚æœæƒ³æ³¨å†Œå±€éƒ¨æŒ‡ä»¤ï¼Œç»„ä»¶ä¸­ä¹Ÿæ¥å—ä¸€ä¸ª directives çš„é€‰é¡¹ï¼š 12345678directives: &#123; focus: &#123; // æŒ‡ä»¤çš„å®šä¹‰ inserted: function (el) &#123; el.focus() &#125; &#125;&#125; ç„¶åä½ å¯ä»¥åœ¨æ¨¡æ¿ä¸­ä»»ä½•å…ƒç´ ä¸Šä½¿ç”¨æ–°çš„ v-focus å±æ€§ï¼Œå¦‚ä¸‹ï¼š 1&lt;input v-focus&gt; é’©å­å‡½æ•°ä¸€ä¸ªæŒ‡ä»¤å®šä¹‰å¯¹è±¡å¯ä»¥æä¾›å¦‚ä¸‹å‡ ä¸ªé’©å­å‡½æ•° (å‡ä¸ºå¯é€‰)ï¼š bindï¼šåªè°ƒç”¨ä¸€æ¬¡ï¼ŒæŒ‡ä»¤ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ æ—¶è°ƒç”¨ã€‚åœ¨è¿™é‡Œå¯ä»¥è¿›è¡Œä¸€æ¬¡æ€§çš„åˆå§‹åŒ–è®¾ç½®ã€‚ insertedï¼šè¢«ç»‘å®šå…ƒç´ æ’å…¥çˆ¶èŠ‚ç‚¹æ—¶è°ƒç”¨ (ä»…ä¿è¯çˆ¶èŠ‚ç‚¹å­˜åœ¨ï¼Œä½†ä¸ä¸€å®šå·²è¢«æ’å…¥æ–‡æ¡£ä¸­)ã€‚ updateï¼šæ‰€åœ¨ç»„ä»¶çš„ VNode æ›´æ–°æ—¶è°ƒç”¨ï¼Œä½†æ˜¯å¯èƒ½å‘ç”Ÿåœ¨å…¶å­ VNode æ›´æ–°ä¹‹å‰ã€‚æŒ‡ä»¤çš„å€¼å¯èƒ½å‘ç”Ÿäº†æ”¹å˜ï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰ã€‚ä½†æ˜¯ä½ å¯ä»¥é€šè¿‡æ¯”è¾ƒæ›´æ–°å‰åçš„å€¼æ¥å¿½ç•¥ä¸å¿…è¦çš„æ¨¡æ¿æ›´æ–° (è¯¦ç»†çš„é’©å­å‡½æ•°å‚æ•°è§ä¸‹)ã€‚ componentUpdatedï¼šæŒ‡ä»¤æ‰€åœ¨ç»„ä»¶çš„ VNode åŠå…¶å­ VNode å…¨éƒ¨æ›´æ–°åè°ƒç”¨ã€‚ unbindï¼šåªè°ƒç”¨ä¸€æ¬¡ï¼ŒæŒ‡ä»¤ä¸å…ƒç´ è§£ç»‘æ—¶è°ƒç”¨ã€‚ é’©å­å‡½æ•°å‚æ•°æŒ‡ä»¤é’©å­å‡½æ•°ä¼šè¢«ä¼ å…¥ä»¥ä¸‹å‚æ•°ï¼š elï¼šæŒ‡ä»¤æ‰€ç»‘å®šçš„å…ƒç´ ï¼Œå¯ä»¥ç”¨æ¥ç›´æ¥æ“ä½œ DOM ã€‚ bindingï¼šä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼š nameï¼šæŒ‡ä»¤åï¼Œä¸åŒ…æ‹¬ v- å‰ç¼€ã€‚ valueï¼šæŒ‡ä»¤çš„ç»‘å®šå€¼ï¼Œä¾‹å¦‚ï¼šv-my-directive=&quot;1 + 1&quot; ä¸­ï¼Œç»‘å®šå€¼ä¸º 2ã€‚ oldValueï¼šæŒ‡ä»¤ç»‘å®šçš„å‰ä¸€ä¸ªå€¼ï¼Œä»…åœ¨ update å’Œ componentUpdated é’©å­ä¸­å¯ç”¨ã€‚æ— è®ºå€¼æ˜¯å¦æ”¹å˜éƒ½å¯ç”¨ã€‚ expressionï¼šå­—ç¬¦ä¸²å½¢å¼çš„æŒ‡ä»¤è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ v-my-directive=&quot;1 + 1&quot; ä¸­ï¼Œè¡¨è¾¾å¼ä¸º &quot;1 + 1&quot;ã€‚ argï¼šä¼ ç»™æŒ‡ä»¤çš„å‚æ•°ï¼Œå¯é€‰ã€‚ä¾‹å¦‚ v-my-directive:foo ä¸­ï¼Œå‚æ•°ä¸º &quot;foo&quot;ã€‚ modifiersï¼šä¸€ä¸ªåŒ…å«ä¿®é¥°ç¬¦çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼šv-my-directive.foo.bar ä¸­ï¼Œä¿®é¥°ç¬¦å¯¹è±¡ä¸º { foo: true, bar: true }ã€‚ vnodeï¼šVue ç¼–è¯‘ç”Ÿæˆçš„è™šæ‹ŸèŠ‚ç‚¹ã€‚ç§»æ­¥ VNode API æ¥äº†è§£æ›´å¤šè¯¦æƒ…ã€‚ oldVnodeï¼šä¸Šä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œä»…åœ¨ update å’Œ componentUpdated é’©å­ä¸­å¯ç”¨ã€‚ é™¤äº† el ä¹‹å¤–ï¼Œå…¶å®ƒå‚æ•°éƒ½åº”è¯¥æ˜¯åªè¯»çš„ï¼Œåˆ‡å‹¿è¿›è¡Œä¿®æ”¹ã€‚å¦‚æœéœ€è¦åœ¨é’©å­ä¹‹é—´å…±äº«æ•°æ®ï¼Œå»ºè®®é€šè¿‡å…ƒç´ çš„ dataset æ¥è¿›è¡Œã€‚ 1234567891011121314151617181920&lt;div id=&quot;dynamicexample&quot;&gt; &lt;h3&gt;Scroll down inside this section â†“&lt;/h3&gt; &lt;p v-pin:[direction]=&quot;200&quot;&gt;I am pinned onto the page at 200px to the left.&lt;/p&gt;&lt;/div&gt;Vue.directive(&apos;pin&apos;, &#123; bind: function (el, binding, vnode) &#123; el.style.position = &apos;fixed&apos; var s = (binding.arg == &apos;left&apos; ? &apos;left&apos; : &apos;top&apos;) el.style[s] = binding.value + &apos;px&apos; &#125;&#125;)new Vue(&#123; el: &apos;#dynamicexample&apos;, data: function () &#123; return &#123; direction: &apos;left&apos; &#125; &#125;&#125;) 8. ä¸€å¥è¯å°±èƒ½å›ç­”çš„é¢è¯•é¢˜1.cssåªåœ¨å½“å‰ç»„ä»¶èµ·ä½œç”¨ ç­”ï¼šåœ¨styleæ ‡ç­¾ä¸­å†™å…¥scopedå³å¯ ä¾‹å¦‚ï¼š 2.v-if å’Œ v-show åŒºåˆ« ç­”ï¼šv-ifæŒ‰ç…§æ¡ä»¶æ˜¯å¦æ¸²æŸ“ï¼Œv-showæ˜¯displayçš„blockæˆ–noneï¼› 3.routeå’Œrouterçš„åŒºåˆ« ç­”ï¼šrouteæ˜¯â€è·¯ç”±ä¿¡æ¯å¯¹è±¡â€ï¼ŒåŒ…æ‹¬pathï¼Œparamsï¼Œhashï¼Œqueryï¼ŒfullPathï¼Œmatchedï¼Œnameç­‰è·¯ç”±ä¿¡æ¯å‚æ•°ã€‚è€Œrouteræ˜¯â€œè·¯ç”±å®ä¾‹â€å¯¹è±¡åŒ…æ‹¬äº†è·¯ç”±çš„è·³è½¬æ–¹æ³•ï¼Œé’©å­å‡½æ•°ç­‰ã€‚ 4.vue.jsçš„ä¸¤ä¸ªæ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼šæ•°æ®é©±åŠ¨ã€ç»„ä»¶ç³»ç»Ÿ 5.vueå‡ ç§å¸¸ç”¨çš„æŒ‡ä»¤ ç­”ï¼šv-for ã€ v-if ã€v-bindã€v-onã€v-showã€v-else 6.vueå¸¸ç”¨çš„ä¿®é¥°ç¬¦ï¼Ÿ ç­”ï¼š.prevent: æäº¤äº‹ä»¶ä¸å†é‡è½½é¡µé¢ï¼›.stop: é˜»æ­¢å•å‡»äº‹ä»¶å†’æ³¡ï¼›.self: å½“äº‹ä»¶å‘ç”Ÿåœ¨è¯¥å…ƒç´ æœ¬èº«è€Œä¸æ˜¯å­å…ƒç´ çš„æ—¶å€™ä¼šè§¦å‘ï¼›.capture: äº‹ä»¶ä¾¦å¬ï¼Œäº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ä¼šè°ƒç”¨ 7.v-on å¯ä»¥ç»‘å®šå¤šä¸ªæ–¹æ³•å—ï¼Ÿ ç­”ï¼šå¯ä»¥ 8.vueä¸­ key å€¼çš„ä½œç”¨ï¼Ÿ ç­”ï¼šå½“ Vue.js ç”¨ v-for æ­£åœ¨æ›´æ–°å·²æ¸²æŸ“è¿‡çš„å…ƒç´ åˆ—è¡¨æ—¶ï¼Œå®ƒé»˜è®¤ç”¨â€œå°±åœ°å¤ç”¨â€ç­–ç•¥ã€‚å¦‚æœæ•°æ®é¡¹çš„é¡ºåºè¢«æ”¹å˜ï¼ŒVue å°†ä¸ä¼šç§»åŠ¨ DOM å…ƒç´ æ¥åŒ¹é…æ•°æ®é¡¹çš„é¡ºåºï¼Œ è€Œæ˜¯ç®€å•å¤ç”¨æ­¤å¤„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”ç¡®ä¿å®ƒåœ¨ç‰¹å®šç´¢å¼•ä¸‹æ˜¾ç¤ºå·²è¢«æ¸²æŸ“è¿‡çš„æ¯ä¸ªå…ƒç´ ã€‚keyçš„ä½œç”¨ä¸»è¦æ˜¯ä¸ºäº†é«˜æ•ˆçš„æ›´æ–°è™šæ‹ŸDOMã€‚ 9.ä»€ä¹ˆæ˜¯vueçš„è®¡ç®—å±æ€§ï¼Ÿ ç­”ï¼šåœ¨æ¨¡æ¿ä¸­æ”¾å…¥å¤ªå¤šçš„é€»è¾‘ä¼šè®©æ¨¡æ¿è¿‡é‡ä¸”éš¾ä»¥ç»´æŠ¤ï¼Œåœ¨éœ€è¦å¯¹æ•°æ®è¿›è¡Œå¤æ‚å¤„ç†ï¼Œä¸”å¯èƒ½å¤šæ¬¡ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œå°½é‡é‡‡å–è®¡ç®—å±æ€§çš„æ–¹å¼ã€‚å¥½å¤„ï¼šâ‘ ä½¿å¾—æ•°æ®å¤„ç†ç»“æ„æ¸…æ™°ï¼›â‘¡ä¾èµ–äºæ•°æ®ï¼Œæ•°æ®æ›´æ–°ï¼Œå¤„ç†ç»“æœè‡ªåŠ¨æ›´æ–°ï¼›â‘¢è®¡ç®—å±æ€§å†…éƒ¨thisæŒ‡å‘vmå®ä¾‹ï¼›â‘£åœ¨templateè°ƒç”¨æ—¶ï¼Œç›´æ¥å†™è®¡ç®—å±æ€§åå³å¯ï¼›â‘¤å¸¸ç”¨çš„æ˜¯getteræ–¹æ³•ï¼Œè·å–æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨setæ–¹æ³•æ”¹å˜æ•°æ®ï¼›â‘¥ç›¸è¾ƒäºmethodsï¼Œä¸ç®¡ä¾èµ–çš„æ•°æ®å˜ä¸å˜ï¼Œmethodséƒ½ä¼šé‡æ–°è®¡ç®—ï¼Œä½†æ˜¯ä¾èµ–æ•°æ®ä¸å˜çš„æ—¶å€™computedä»ç¼“å­˜ä¸­è·å–ï¼Œä¸ä¼šé‡æ–°è®¡ç®—ã€‚ 10.vueç­‰å•é¡µé¢åº”ç”¨åŠå…¶ä¼˜ç¼ºç‚¹ ç­”ï¼šä¼˜ç‚¹ï¼šVue çš„ç›®æ ‡æ˜¯é€šè¿‡å°½å¯èƒ½ç®€å•çš„ API å®ç°å“åº”çš„æ•°æ®ç»‘å®šå’Œç»„åˆçš„è§†å›¾ç»„ä»¶ï¼Œæ ¸å¿ƒæ˜¯ä¸€ä¸ªå“åº”çš„æ•°æ®ç»‘å®šç³»ç»Ÿã€‚MVVMã€æ•°æ®é©±åŠ¨ã€ç»„ä»¶åŒ–ã€è½»é‡ã€ç®€æ´ã€é«˜æ•ˆã€å¿«é€Ÿã€æ¨¡å—å‹å¥½ã€‚ ==ç¼ºç‚¹ï¼šä¸æ”¯æŒä½ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œæœ€ä½åªæ”¯æŒåˆ°IE9ï¼›ä¸åˆ©äºSEOçš„ä¼˜åŒ–ï¼ˆå¦‚æœè¦æ”¯æŒSEOï¼Œå»ºè®®é€šè¿‡æœåŠ¡ç«¯æ¥è¿›è¡Œæ¸²æŸ“ç»„ä»¶ï¼‰ï¼›ç¬¬ä¸€æ¬¡åŠ è½½é¦–é¡µè€—æ—¶ç›¸å¯¹é•¿ä¸€äº›ï¼›ä¸å¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„å¯¼èˆªæŒ‰é’®éœ€è¦è‡ªè¡Œå®ç°å‰è¿›ã€åé€€ã€‚==","categories":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/categories/VUE/"}],"tags":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/tags/VUE/"}]},{"title":"Vueä½¿ç”¨å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—","slug":"Vueä½¿ç”¨å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—","date":"2020-02-08T16:06:21.000Z","updated":"2020-02-08T16:07:02.269Z","comments":true,"path":"2020/02/09/Vueä½¿ç”¨å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—/","link":"","permalink":"http://yoursite.com/2020/02/09/Vueä½¿ç”¨å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—/","excerpt":"","text":"Vueä½¿ç”¨å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—DOMçš„å¼‚æ­¥æ›´æ–°å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—æŒ‡çš„æ˜¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒVueå¼‚æ­¥æ‰§è¡ŒDOMæ›´æ–°ã€‚ æˆ‘ä»¬åœ¨é¡¹ç›®å¼€å‘ä¸­ä¼šé‡åˆ°è¿™æ ·ä¸€ç§åœºæ™¯ï¼šå½“æˆ‘ä»¬å°†çŠ¶æ€æ”¹å˜ä¹‹åæƒ³è·å–æ›´æ–°åçš„DOMï¼Œå¾€å¾€æˆ‘ä»¬è·å–åˆ°çš„DOMæ˜¯æ›´æ–°å‰çš„æ—§DOMï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨vm.$nextTickæ–¹æ³•å¼‚æ­¥è·å–DOMï¼Œä¾‹å¦‚ï¼š 1234567891011121314151617Vue.component('example', &#123; template: '&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;', data: function () &#123; return &#123; message: 'æ²¡æœ‰æ›´æ–°' &#125; &#125;, methods: &#123; updateMessage: function () &#123; this.message = 'æ›´æ–°å®Œæˆ' console.log(this.$el.textContent) // =&gt; 'æ²¡æœ‰æ›´æ–°' this.$nextTick(function () &#123; console.log(this.$el.textContent) // =&gt; 'æ›´æ–°å®Œæˆ' &#125;) &#125; &#125;&#125;) æˆ‘ä»¬éƒ½çŸ¥é“è¿™æ ·åšå¾ˆéº»çƒ¦ï¼Œä½†ä¸ºä»€ä¹ˆVueè¿˜è¦è¿™æ ·åšå‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬å‡è®¾Vueæ˜¯åŒæ­¥æ‰§è¡ŒDOMæ›´æ–°ï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ å¦‚æœåŒæ­¥æ›´æ–°DOMå°†ä¼šæœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­åŒæ­¥æ›´æ–°æ•°æ®Næ¬¡ï¼ŒDOMä¹Ÿä¼šæ›´æ–°Næ¬¡ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š 1234this.message = 'æ›´æ–°å®Œæˆ' // DOMæ›´æ–°ä¸€æ¬¡this.message = 'æ›´æ–°å®Œæˆ2' // DOMæ›´æ–°ä¸¤æ¬¡this.message = 'æ›´æ–°å®Œæˆ3' // DOMæ›´æ–°ä¸‰æ¬¡this.message = 'æ›´æ–°å®Œæˆ4' // DOMæ›´æ–°å››æ¬¡ ä½†äº‹å®ä¸Šï¼Œæˆ‘ä»¬çœŸæ­£æƒ³è¦çš„å…¶å®åªæ˜¯æœ€åä¸€æ¬¡æ›´æ–°è€Œå·²ï¼Œä¹Ÿå°±æ˜¯è¯´å‰ä¸‰æ¬¡DOMæ›´æ–°éƒ½æ˜¯å¯ä»¥çœç•¥çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ç­‰æ‰€æœ‰çŠ¶æ€éƒ½ä¿®æ”¹å¥½äº†ä¹‹åå†è¿›è¡Œæ¸²æŸ“å°±å¯ä»¥å‡å°‘ä¸€äº›æ— ç”¨åŠŸã€‚ è€Œè¿™ç§æ— ç”¨åŠŸåœ¨Vue2.0å¼€å§‹å˜å¾—æ›´ä¸ºé‡è¦ï¼ŒVue2.0å¼€å§‹å¼•å…¥äº†Virtualdomï¼Œæ¯ä¸€æ¬¡çŠ¶æ€å‘ç”Ÿå˜åŒ–åï¼ŒçŠ¶æ€å˜åŒ–çš„ä¿¡å·ä¼šå‘é€ç»™ç»„ä»¶ï¼Œç»„ä»¶å†…éƒ¨ä½¿ç”¨VirtualDOMè¿›è¡Œè®¡ç®—å¾—å‡ºéœ€è¦æ›´æ–°çš„å…·ä½“çš„DOMèŠ‚ç‚¹ï¼Œç„¶åå¯¹DOMè¿›è¡Œæ›´æ–°æ“ä½œï¼Œæ¯æ¬¡æ›´æ–°çŠ¶æ€åçš„æ¸²æŸ“è¿‡ç¨‹éœ€è¦æ›´å¤šçš„è®¡ç®—ï¼Œè€Œè¿™ç§æ— ç”¨åŠŸä¹Ÿå°†æµªè´¹æ›´å¤šçš„æ€§èƒ½ï¼Œæ‰€ä»¥å¼‚æ­¥æ¸²æŸ“å˜å¾—æ›´åŠ è‡³å…³é‡è¦ã€‚ ç»„ä»¶å†…éƒ¨ä½¿ç”¨VIrtualDOMè¿›è¡Œæ¸²æŸ“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»„ä»¶å†…éƒ¨å…¶å®æ˜¯ä¸å…³å¿ƒå“ªä¸ªçŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ï¼Œå®ƒåªéœ€è¦è®¡ç®—ä¸€æ¬¡å°±å¯ä»¥å¾—çŸ¥å“ªäº›èŠ‚ç‚¹éœ€è¦æ›´æ–°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ›´æ”¹äº†Nä¸ªçŠ¶æ€ï¼Œå…¶å®åªéœ€è¦å‘é€ä¸€ä¸ªä¿¡å·å°±å¯ä»¥å°†DOMæ›´æ–°åˆ°æœ€æ–°ã€‚ä¾‹å¦‚ï¼š 123this.message = 'æ›´æ–°å®Œæˆ'this.age = 23this.name = berwin ä»£ç ä¸­æˆ‘ä»¬åˆ†ä¸‰æ¬¡ä¿®æ”¹äº†ä¸‰ç§çŠ¶æ€ï¼Œä½†å…¶å®Vueåªä¼šæ¸²æŸ“ä¸€æ¬¡ã€‚å› ä¸ºVIrtualDOMåªéœ€è¦ä¸€æ¬¡å°±å¯ä»¥å°†æ•´ä¸ªç»„ä»¶çš„DOMæ›´æ–°åˆ°æœ€æ–°ï¼Œå®ƒæ ¹æœ¬ä¸ä¼šå…³å¿ƒè¿™ä¸ªæ›´æ–°çš„ä¿¡å·åˆ°åº•æ˜¯ä»å“ªä¸ªå…·ä½“çš„çŠ¶æ€å‘å‡ºæ¥çš„ã€‚ é‚£å¦‚ä½•æ‰èƒ½å°†æ¸²æŸ“æ“ä½œæ¨è¿Ÿåˆ°æ‰€æœ‰çŠ¶æ€éƒ½ä¿®æ”¹å®Œæ¯•å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å°†æ¸²æŸ“æ“ä½œæ¨è¿Ÿåˆ°æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ€åæˆ–è€…ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªéœ€è¦åœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ€åï¼Œç­‰å‰é¢æ›´æ–°çŠ¶æ€çš„è¯­å¥éƒ½æ‰§è¡Œå®Œä¹‹åï¼Œæ‰§è¡Œä¸€æ¬¡æ¸²æŸ“æ“ä½œï¼Œå®ƒå°±å¯ä»¥æ— è§†å‰é¢å„ç§æ›´æ–°çŠ¶æ€çš„è¯­æ³•ï¼Œæ— è®ºå‰é¢å†™äº†å¤šå°‘æ¡æ›´æ–°çŠ¶æ€çš„è¯­å¥ï¼Œåªåœ¨æœ€åæ¸²æŸ“ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚ å°†æ¸²æŸ“æ¨è¿Ÿåˆ°æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ€åæ‰§è¡Œæ¸²æŸ“çš„æ—¶æœºä¼šæ¯”æ¨è¿Ÿåˆ°ä¸‹ä¸€è½®å¿«å¾ˆå¤šï¼Œæ‰€ä»¥Vueä¼˜å…ˆå°†æ¸²æŸ“æ“ä½œæ¨è¿Ÿåˆ°æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ€åï¼Œå¦‚æœæ‰§è¡Œç¯å¢ƒä¸æ”¯æŒä¼šé™çº§åˆ°ä¸‹ä¸€è½®ã€‚ å½“ç„¶ï¼ŒVueçš„å˜åŒ–ä¾¦æµ‹æœºåˆ¶å†³å®šäº†å®ƒå¿…ç„¶ä¼šåœ¨æ¯æ¬¡çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶éƒ½ä¼šå‘å‡ºæ¸²æŸ“çš„ä¿¡å·ï¼Œä½†Vueä¼šåœ¨æ”¶åˆ°ä¿¡å·ä¹‹åæ£€æŸ¥é˜Ÿåˆ—ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¿™ä¸ªä»»åŠ¡ï¼Œä¿è¯é˜Ÿåˆ—ä¸­ä¸ä¼šæœ‰é‡å¤ã€‚å¦‚æœé˜Ÿåˆ—ä¸­ä¸å­˜åœ¨åˆ™å°†æ¸²æŸ“æ“ä½œæ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚ ä¹‹åé€šè¿‡å¼‚æ­¥çš„æ–¹å¼å»¶è¿Ÿæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ¸²æŸ“çš„æ“ä½œå¹¶æ¸…ç©ºé˜Ÿåˆ—ï¼Œå½“åŒä¸€è½®äº‹ä»¶å¾ªç¯ä¸­åå¤ä¿®æ”¹çŠ¶æ€æ—¶ï¼Œå¹¶ä¸ä¼šåå¤å‘é˜Ÿåˆ—ä¸­æ·»åŠ ç›¸åŒçš„æ¸²æŸ“æ“ä½œã€‚ æ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨Vueæ—¶ï¼Œä¿®æ”¹çŠ¶æ€åæ›´æ–°DOMéƒ½æ˜¯å¼‚æ­¥çš„ã€‚ Watcheré˜Ÿåˆ—updateåœ¨Watcherçš„æºç ä¸­ï¼Œæˆ‘ä»¬å‘ç°watcherçš„updateå…¶å®æ˜¯å¼‚æ­¥çš„ã€‚ï¼ˆæ³¨ï¼šsyncå±æ€§é»˜è®¤ä¸ºfalseï¼Œä¹Ÿå°±æ˜¯å¼‚æ­¥ï¼‰ 123456789101112update () &#123; /* istanbul ignore else */ if (this.lazy) &#123; this.dirty = true &#125; else if (this.sync) &#123; /*åŒæ­¥åˆ™æ‰§è¡Œrunç›´æ¥æ¸²æŸ“è§†å›¾*/ this.run() &#125; else &#123; /*å¼‚æ­¥æ¨é€åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œä¸‹ä¸€ä¸ªtickæ—¶è°ƒç”¨ã€‚*/ queueWatcher(this) &#125;&#125; queueWatcherqueueWatcher(this)å‡½æ•°çš„ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920/*å°†ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡pushè¿›è§‚å¯Ÿè€…é˜Ÿåˆ—ï¼Œåœ¨é˜Ÿåˆ—ä¸­å·²ç»å­˜åœ¨ç›¸åŒçš„idåˆ™è¯¥è§‚å¯Ÿè€…å¯¹è±¡å°†è¢«è·³è¿‡ï¼Œé™¤éå®ƒæ˜¯åœ¨é˜Ÿåˆ—è¢«åˆ·æ–°æ—¶æ¨é€*/export function queueWatcher (watcher: Watcher) &#123; /*è·å–watcherçš„id*/ const id = watcher.id /*æ£€éªŒidæ˜¯å¦å­˜åœ¨ï¼Œå·²ç»å­˜åœ¨åˆ™ç›´æ¥è·³è¿‡ï¼Œä¸å­˜åœ¨åˆ™æ ‡è®°å“ˆå¸Œè¡¨hasï¼Œç”¨äºä¸‹æ¬¡æ£€éªŒ*/ if (has[id] == null) &#123; has[id] = true if (!flushing) &#123; /*å¦‚æœæ²¡æœ‰flushæ‰ï¼Œç›´æ¥pushåˆ°é˜Ÿåˆ—ä¸­å³å¯*/ queue.push(watcher) &#125; else &#123; ... &#125; // queue the flush if (!waiting) &#123; waiting = true nextTick(flushSchedulerQueue) &#125; &#125;&#125; è¿™æ®µæºç æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š é¦–å…ˆéœ€è¦çŸ¥é“çš„æ˜¯watcheræ‰§è¡Œupdateçš„æ—¶å€™ï¼Œé»˜è®¤æƒ…å†µä¸‹è‚¯å®šæ˜¯å¼‚æ­¥çš„ï¼Œå®ƒä¼šåšä»¥ä¸‹çš„ä¸¤ä»¶äº‹ï¼š åˆ¤æ–­hasæ•°ç»„ä¸­æ˜¯å¦æœ‰è¿™ä¸ªwatcherçš„id å¦‚æœæœ‰çš„è¯æ˜¯ä¸éœ€è¦æŠŠwatcheråŠ å…¥queueä¸­çš„ï¼Œå¦åˆ™ä¸åšä»»ä½•å¤„ç†ã€‚ è¿™é‡Œé¢çš„nextTick(flushSchedulerQueue)ä¸­ï¼ŒflushScheduleQueueå‡½æ•°çš„ä½œç”¨ä¸»è¦æ˜¯æ‰§è¡Œè§†å›¾æ›´æ–°çš„æ“ä½œï¼Œå®ƒä¼šæŠŠqueueä¸­æ‰€æœ‰çš„watcherå–å‡ºæ¥å¹¶æ‰§è¡Œç›¸åº”çš„è§†å›¾æ›´æ–°ã€‚ æ ¸å¿ƒå…¶å®æ˜¯nextTickå‡½æ•°äº†ï¼Œä¸‹é¢æˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸‹nextTickåˆ°åº•æœ‰ä»€ä¹ˆç”¨ã€‚ nextTicknextTickå‡½æ•°å…¶å®åšäº†ä¸¤ä»¶äº‹æƒ…ï¼Œä¸€æ˜¯ç”Ÿæˆä¸€ä¸ªtimerFuncï¼ŒæŠŠå›è°ƒä½œä¸ºmicroTaskæˆ–macroTaskå‚ä¸åˆ°äº‹ä»¶å¾ªç¯ä¸­æ¥ã€‚äºŒæ˜¯æŠŠå›è°ƒå‡½æ•°æ”¾å…¥ä¸€ä¸ªcallbacksé˜Ÿåˆ—ï¼Œç­‰å¾…é€‚å½“çš„æ—¶æœºæ‰§è¡Œã€‚ï¼ˆè¿™ä¸ªæ—¶æœºå’ŒtimerFuncä¸åŒçš„å®ç°æœ‰å…³ï¼‰ é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹å®ƒæ˜¯æ€ä¹ˆç”Ÿæˆä¸€ä¸ªtimerFuncæŠŠå›è°ƒä½œä¸ºmicroTaskæˆ–macroTaskçš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839if (typeof Promise !== 'undefined' &amp;&amp; isNative(Promise)) &#123; /*ä½¿ç”¨Promise*/ var p = Promise.resolve() var logError = err =&gt; &#123; console.error(err) &#125; timerFunc = () =&gt; &#123; p.then(nextTickHandler).catch(logError) // in problematic UIWebViews, Promise.then doesn't completely break, but // it can get stuck in a weird state where callbacks are pushed into the // microTask queue but the queue isn't being flushed, until the browser // needs to do some other work, e.g. handle a timer. Therefore we can // \"force\" the microTask queue to be flushed by adding an empty timer. if (isIOS) setTimeout(noop) &#125;&#125; else if (typeof MutationObserver !== 'undefined' &amp;&amp; ( isNative(MutationObserver) || // PhantomJS and iOS 7.x MutationObserver.toString() === '[object MutationObserverConstructor]' )) &#123; // use MutationObserver where native Promise is not available, // e.g. PhantomJS IE11, iOS7, Android 4.4 /*æ–°å»ºä¸€ä¸ªtextNodeçš„DOMå¯¹è±¡ï¼Œç”¨MutationObserverç»‘å®šè¯¥DOMå¹¶æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œåœ¨DOMå˜åŒ–çš„æ—¶å€™åˆ™ä¼šè§¦å‘å›è°ƒ,è¯¥å›è°ƒä¼šè¿›å…¥ä¸»çº¿ç¨‹ï¼ˆæ¯”ä»»åŠ¡é˜Ÿåˆ—ä¼˜å…ˆæ‰§è¡Œï¼‰ï¼Œå³textNode.data = String(counter)æ—¶ä¾¿ä¼šè§¦å‘å›è°ƒ*/ var counter = 1 var observer = new MutationObserver(nextTickHandler) var textNode = document.createTextNode(String(counter)) observer.observe(textNode, &#123; characterData: true &#125;) timerFunc = () =&gt; &#123; counter = (counter + 1) % 2 textNode.data = String(counter) &#125;&#125; else &#123; // fallback to setTimeout /* istanbul ignore next */ /*ä½¿ç”¨setTimeoutå°†å›è°ƒæ¨å…¥ä»»åŠ¡é˜Ÿåˆ—å°¾éƒ¨*/ timerFunc = () =&gt; &#123; setTimeout(nextTickHandler, 0) &#125;&#125; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå®ƒä¼šæŒ‰ç…§Promiseã€MutationObserverã€setTimeoutä¼˜å…ˆçº§å»è°ƒç”¨ä¼ å…¥çš„å›è°ƒå‡½æ•°ã€‚å‰ä¸¤è€…ä¼šç”Ÿæˆä¸€ä¸ªmicroTaskä»»åŠ¡ï¼Œè€Œåè€…ä¼šç”Ÿæˆä¸€ä¸ªmacroTaskã€‚ï¼ˆå¾®ä»»åŠ¡å’Œå®ä»»åŠ¡ï¼‰ ä¹‹æ‰€ä»¥ä¼šè®¾ç½®è¿™æ ·çš„ä¼˜å…ˆçº§ï¼Œä¸»è¦æ˜¯è€ƒè™‘åˆ°æµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹æ€§ï¼ˆIEæ²¡æœ‰å†…ç½®Promiseï¼‰ã€‚å¦å¤–ï¼Œè®¾ç½®Promiseæœ€ä¼˜å…ˆæ˜¯å› ä¸ºPromise.resolve().thenå›è°ƒå‡½æ•°å±äºä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œæµè§ˆå™¨åœ¨ä¸€ä¸ªTickä¸­æ‰§è¡Œå®ŒmacroTaskåä¼šæ¸…ç©ºå½“å‰Tickæ‰€æœ‰çš„microTaskå†è¿›è¡ŒUIæ¸²æŸ“ï¼ŒæŠŠDOMæ›´æ–°çš„æ“ä½œæ”¾åœ¨Tickæ‰§è¡ŒmicroTaskçš„é˜¶æ®µæ¥å®Œæˆï¼Œç›¸æ¯”ä½¿ç”¨setTimeoutç”Ÿæˆçš„ä¸€ä¸ªmacroTaskä¼šå°‘ä¸€æ¬¡UIçš„æ¸²æŸ“ã€‚ è€ŒnextTickHandlerå‡½æ•°ï¼Œå…¶å®æ‰æ˜¯æˆ‘ä»¬çœŸæ­£è¦æ‰§è¡Œçš„å‡½æ•°ã€‚ 123456789function nextTickHandler () &#123; pending = false /*æ‰§è¡Œæ‰€æœ‰callback*/ const copies = callbacks.slice(0) callbacks.length = 0 for (let i = 0; i &lt; copies.length; i++) &#123; copies[i]() &#125;&#125; è¿™é‡Œçš„callbackså˜é‡ä¾›nextTickHandleræ¶ˆè´¹ã€‚è€Œå‰é¢æˆ‘ä»¬æ‰€è¯´çš„nextTickå‡½æ•°ç¬¬äºŒç‚¹åŠŸèƒ½ä¸­â€œç­‰å¾…é€‚å½“çš„æ—¶æœºæ‰§è¡Œâ€ï¼Œå…¶å®å°±æ˜¯å› ä¸ºtimerFuncçš„å®ç°æ–¹å¼æœ‰å·®å¼‚ï¼Œå¦‚æœæ˜¯Promise\\MutationObserveråˆ™nextTickHandlerå›è°ƒæ˜¯ä¸€ä¸ªmicroTaskï¼Œå®ƒä¼šåœ¨å½“å‰Tickçš„æœ«å°¾æ¥æ‰§è¡Œã€‚å¦‚æœæ˜¯setTiemoutåˆ™nextTickHandlerå›è°ƒæ˜¯ä¸€ä¸ªmacroTaskï¼Œå®ƒä¼šåœ¨ä¸‹ä¸€ä¸ªTickæ¥æ‰§è¡Œã€‚ è¿˜æœ‰å°±æ˜¯callbacksä¸­çš„æˆå‘˜æ˜¯å¦‚ä½•è¢«pushè¿›æ¥çš„ï¼Ÿä»æºç ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒnextTickæ˜¯ä¸€ä¸ªè‡ªæ‰§è¡Œçš„å‡½æ•°ï¼Œä¸€æ—¦æ‰§è¡Œæ˜¯returnäº†ä¸€ä¸ªqueueNextTickï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è°ƒç”¨nextTickå…¶å®å°±æ˜¯åœ¨è°ƒç”¨queueNextTickè¿™ä¸ªå‡½æ•°ã€‚å®ƒçš„æºä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324return function queueNextTick (cb?: Function, ctx?: Object) &#123; let _resolve /*cbå­˜åˆ°callbacksä¸­*/ callbacks.push(() =&gt; &#123; if (cb) &#123; try &#123; cb.call(ctx) &#125; catch (e) &#123; handleError(e, ctx, 'nextTick') &#125; &#125; else if (_resolve) &#123; _resolve(ctx) &#125; &#125;) if (!pending) &#123; pending = true timerFunc() &#125; if (!cb &amp;&amp; typeof Promise !== 'undefined') &#123; return new Promise((resolve, reject) =&gt; &#123; _resolve = resolve &#125;) &#125;&#125; å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦è°ƒç”¨nextTickå‡½æ•°æ—¶å€™ï¼Œä¼ å…¥çš„functionå°±ä¼šè¢«å­˜æ”¾åˆ°callbacksé—­åŒ…ä¸­ï¼Œç„¶åè¿™ä¸ªcallbacksç”±nextTickHandleræ¶ˆè´¹ï¼Œè€ŒnextTickHandlerçš„æ‰§è¡Œæ—¶é—´åˆæ˜¯ç”±timerFuncæ¥å†³å®šã€‚ å›çœ‹Watcherè¿™é‡Œé¢çš„nextTick(flushSchedulerQueue)ä¸­çš„flushSchedulerQueueå‡½æ•°å…¶å®å°±æ˜¯watcherçš„è§†å›¾æ›´æ–°ã€‚è°ƒç”¨çš„æ—¶å€™ä¼šæŠŠå®ƒpushåˆ°callbacksä¸­æ¥å¼‚æ­¥æ‰§è¡Œã€‚ å¦å¤–ï¼Œå…³äºwaitingå˜é‡ï¼Œè¿™æ˜¯å¾ˆé‡è¦çš„ä¸€ä¸ªæ ‡å¿—ä½ï¼Œå®ƒä¿è¯flushSchedulerQueueå›è°ƒåªå…è®¸è¢«ç½®å…¥callbacksä¸€æ¬¡ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤waitingå˜é‡ä¸ºfalseï¼Œæ‰§è¡Œä¸€æ¬¡åwaitingä¸ºtrueï¼Œåç»­çš„this.xxxä¸ä¼šå†æ¬¡è§¦å‘nextTickçš„æ‰§è¡Œï¼Œè€Œæ˜¯æŠŠthis.xxxç›¸å¯¹åº”çš„watcheræ¨å…¥flushSchedulerQueueçš„queueé˜Ÿåˆ—ä¸­ã€‚ æ‰€ä»¥ï¼Œä¹Ÿå°±æ˜¯è¯´DOMç¡®å®æ˜¯å¼‚æ­¥æ›´æ–°ï¼Œä½†æ˜¯å…·ä½“æ˜¯åœ¨ä¸‹ä¸€ä¸ªTickæ›´æ–°è¿˜æ˜¯åœ¨å½“å‰Tickæ‰§è¡ŒmicroTaskçš„æ—¶å€™æ›´æ–°ï¼Œå…·ä½“è¦çœ‹nextTcikçš„å®ç°æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å…·ä½“è·‘çš„æ˜¯Promise/MutationObserverè¿˜æ˜¯setTimeoutã€‚ ä¸ºä»€ä¹ˆè¦å¼‚æ­¥æ›´æ–°12345&lt;template&gt; &lt;div&gt; &lt;div&gt;&#123;&#123;test&#125;&#125;&lt;/div&gt; &lt;/div&gt;&lt;/template&gt; 123456789101112export default &#123; data () &#123; return &#123; test: 0 &#125;; &#125;, mounted () &#123; for(let i = 0; i &lt; 1000; i++) &#123; this.test++; &#125; &#125;&#125; ç°åœ¨æœ‰è¿™æ ·çš„ä¸€ç§æƒ…å†µï¼Œmountedçš„æ—¶å€™testçš„å€¼ä¼šè¢«++å¾ªç¯æ‰§è¡Œ1000æ¬¡ã€‚ æ¯æ¬¡++æ—¶ï¼Œéƒ½ä¼šæ ¹æ®å“åº”å¼è§¦å‘setter-&gt;Dep-&gt;Watcher-&gt;update-&gt;runã€‚ å¦‚æœè¿™æ—¶å€™æ²¡æœ‰å¼‚æ­¥æ›´æ–°è§†å›¾ï¼Œé‚£ä¹ˆæ¯æ¬¡++éƒ½ä¼šç›´æ¥æ“ä½œDOMæ›´æ–°è§†å›¾ï¼Œè¿™æ˜¯éå¸¸æ¶ˆè€—æ€§èƒ½çš„ã€‚ æ‰€ä»¥Vueå®ç°äº†ä¸€ä¸ªqueueé˜Ÿåˆ—ï¼Œåœ¨ä¸‹ä¸€ä¸ªTickï¼ˆæˆ–è€…æ˜¯å½“å‰Tickçš„å¾®ä»»åŠ¡é˜¶æ®µï¼‰çš„æ—¶å€™ä¼šç»Ÿä¸€æ‰§è¡Œqueueä¸­Watcherçš„runã€‚åŒæ—¶ï¼Œæ‹¥æœ‰ç›¸åŒidçš„Watcherä¸ä¼šè¢«é‡å¤åŠ å…¥åˆ°è¯¥queueä¸­å»ï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œ1000æ¬¡Watcherçš„runã€‚æœ€ç»ˆæ›´æ–°è§†å›¾åªä¼šç›´æ¥å°†testå¯¹åº”çš„DOMçš„0å˜æˆ1000ã€‚ ä¿è¯æ›´æ–°è§†å›¾æ“ä½œDOMçš„åŠ¨ä½œæ˜¯åœ¨å½“å‰æ ˆæ‰§è¡Œå®Œä»¥åä¸‹ä¸€ä¸ªTickï¼ˆæˆ–è€…æ˜¯å½“å‰Tickçš„å¾®ä»»åŠ¡é˜¶æ®µï¼‰çš„æ—¶å€™è°ƒç”¨ï¼Œå¤§å¤§ä¼˜åŒ–äº†æ€§èƒ½ã€‚","categories":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/categories/VUE/"}],"tags":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/tags/VUE/"}]},{"title":"tokenè¯¦è§£","slug":"tokenè¯¦è§£","date":"2020-02-03T13:44:07.000Z","updated":"2020-02-08T16:01:08.662Z","comments":true,"path":"2020/02/03/tokenè¯¦è§£/","link":"","permalink":"http://yoursite.com/2020/02/03/tokenè¯¦è§£/","excerpt":"","text":"tokenè¯¦è§£1.ä¼ ç»Ÿèº«ä»½éªŒè¯çš„æ–¹æ³•ï¼ˆsessionï¼‰HTTP æ˜¯ä¸€ç§æ²¡æœ‰çŠ¶æ€çš„åè®®ï¼Œä¹Ÿå°±æ˜¯å®ƒå¹¶ä¸çŸ¥é“æ˜¯è°æ˜¯è®¿é—®åº”ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬æŠŠç”¨æˆ·çœ‹æˆæ˜¯å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·åè¿˜æœ‰å¯†ç é€šè¿‡äº†èº«ä»½éªŒè¯ï¼Œä¸è¿‡ä¸‹å›è¿™ä¸ªå®¢æˆ·ç«¯å†å‘é€è¯·æ±‚æ—¶å€™ï¼Œè¿˜å¾—å†éªŒè¯ä¸€ä¸‹ã€‚ è§£å†³çš„æ–¹æ³•å°±æ˜¯ï¼Œå½“ç”¨æˆ·è¯·æ±‚ç™»å½•çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨æœåŠ¡ç«¯ç”Ÿæˆä¸€æ¡è®°å½•ï¼Œè¿™ä¸ªè®°å½•é‡Œå¯ä»¥è¯´æ˜ä¸€ä¸‹ç™»å½•çš„ç”¨æˆ·æ˜¯è°ï¼Œç„¶åæŠŠè¿™æ¡è®°å½•çš„ ID å·å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°ä»¥åæŠŠè¿™ä¸ª ID å·å­˜å‚¨åœ¨ Cookie é‡Œï¼Œä¸‹æ¬¡è¿™ä¸ªç”¨æˆ·å†å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥å¸¦ç€è¿™ä¸ª Cookie ï¼Œè¿™æ ·æœåŠ¡ç«¯ä¼šéªŒè¯ä¸€ä¸ªè¿™ä¸ª Cookie é‡Œçš„ä¿¡æ¯ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½åœ¨æœåŠ¡ç«¯è¿™é‡Œæ‰¾åˆ°å¯¹åº”çš„è®°å½•ï¼Œå¦‚æœå¯ä»¥ï¼Œè¯´æ˜ç”¨æˆ·å·²ç»é€šè¿‡äº†èº«ä»½éªŒè¯ï¼Œå°±æŠŠç”¨æˆ·è¯·æ±‚çš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ ä¸Šé¢è¯´çš„å°±æ˜¯ Sessionï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡ç«¯å­˜å‚¨ä¸ºç™»å½•çš„ç”¨æˆ·ç”Ÿæˆçš„ Session ï¼Œè¿™äº› Session å¯èƒ½ä¼šå­˜å‚¨åœ¨å†…å­˜ï¼Œç£ç›˜ï¼Œæˆ–è€…æ•°æ®åº“é‡Œã€‚æˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æœåŠ¡ç«¯å®šæœŸçš„å»æ¸…ç†è¿‡æœŸçš„ Session ã€‚ åŸºäºæœåŠ¡å™¨éªŒè¯æ–¹å¼æš´éœ²çš„ä¸€äº›é—®é¢˜1.Seesionï¼šæ¯æ¬¡è®¤è¯ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦å»åˆ›å»ºä¸€ä¸ªè®°å½•æ¥å­˜å‚¨ä¿¡æ¯ã€‚å½“è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·å‘è¯·æ±‚æ—¶ï¼Œå†…å­˜çš„å¼€é”€ä¹Ÿä¼šä¸æ–­å¢åŠ ã€‚ 2.å¯æ‰©å±•æ€§ï¼šåœ¨æœåŠ¡ç«¯çš„å†…å­˜ä¸­ä½¿ç”¨Seesionå­˜å‚¨ç™»å½•ä¿¡æ¯ï¼Œä¼´éšè€Œæ¥çš„æ˜¯å¯æ‰©å±•æ€§é—®é¢˜ã€‚ 3.CORS(è·¨åŸŸèµ„æºå…±äº«)ï¼šå½“æˆ‘ä»¬éœ€è¦è®©æ•°æ®è·¨å¤šå°ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨æ—¶ï¼Œè·¨åŸŸèµ„æºçš„å…±äº«ä¼šæ˜¯ä¸€ä¸ªè®©äººå¤´ç–¼çš„é—®é¢˜ã€‚åœ¨ä½¿ç”¨AjaxæŠ“å–å¦ä¸€ä¸ªåŸŸçš„èµ„æºï¼Œå°±å¯èƒ½ä¼šå‡ºç°ç¦æ­¢è¯·æ±‚çš„æƒ…å†µã€‚ 4.CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )ï¼šç”¨æˆ·åœ¨è®¿é—®é“¶è¡Œç½‘ç«™æ—¶ï¼Œä»–ä»¬å¾ˆå®¹æ˜“å—åˆ°è·¨ç«™è¯·æ±‚ä¼ªé€ çš„æ”»å‡»ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«åˆ©ç”¨å…¶è®¿é—®å…¶ä»–çš„ç½‘ç«™ã€‚ åœ¨è¿™äº›é—®é¢˜ä¸­ï¼Œå¯æ‰©å±•è¡Œæ˜¯æœ€çªå‡ºçš„ã€‚ 2.åŸºäº Token çš„èº«ä»½éªŒè¯æ–¹æ³•ä½¿ç”¨åŸºäº Token çš„èº«ä»½éªŒè¯æ–¹æ³•æ˜¯æ— çŠ¶æ€çš„ï¼Œåœ¨æœåŠ¡ç«¯ä¸éœ€è¦å­˜å‚¨ç”¨æˆ·çš„ç™»å½•è®°å½•ã€‚NoSessionæ„å‘³ç€ä½ çš„ç¨‹åºå¯ä»¥æ ¹æ®éœ€è¦å»å¢å‡æœºå™¨ï¼Œè€Œä¸ç”¨å»æ‹…å¿ƒç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚ å¤§æ¦‚çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·åè·Ÿå¯†ç è¯·æ±‚ç™»å½• æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œå»éªŒè¯ç”¨æˆ·åä¸å¯†ç  éªŒè¯æˆåŠŸåï¼ŒæœåŠ¡ç«¯ä¼šç­¾å‘ä¸€ä¸ª Tokenï¼Œå†æŠŠè¿™ä¸ª Token å‘é€ç»™å®¢æˆ·ç«¯ å®¢æˆ·ç«¯æ”¶åˆ° Token ä»¥åå¯ä»¥æŠŠå®ƒå­˜å‚¨èµ·æ¥ï¼Œæ¯”å¦‚æ”¾åœ¨ Cookie é‡Œæˆ–è€… Local Storage é‡Œ å®¢æˆ·ç«¯æ¯æ¬¡å‘æœåŠ¡ç«¯è¯·æ±‚èµ„æºçš„æ—¶å€™éœ€è¦å¸¦ç€æœåŠ¡ç«¯ç­¾å‘çš„ Token æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œç„¶åå»éªŒè¯å®¢æˆ·ç«¯è¯·æ±‚é‡Œé¢å¸¦ç€çš„ Tokenï¼Œå¦‚æœéªŒè¯æˆåŠŸï¼Œå°±å‘å®¢æˆ·ç«¯è¿”å›è¯·æ±‚çš„æ•°æ®ï¼ˆtokenåº”è¯¥åœ¨HTTPçš„å¤´éƒ¨å‘é€ä»è€Œä¿è¯äº†Httpè¯·æ±‚æ— çŠ¶æ€ã€‚æˆ‘ä»¬åŒæ ·é€šè¿‡è®¾ç½®æœåŠ¡å™¨å±æ€§Access-Control-Allow-Origin:*ï¼Œè®©æœåŠ¡å™¨èƒ½æ¥å—åˆ°æ¥è‡ªæ‰€æœ‰åŸŸçš„è¯·æ±‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ACAOå¤´éƒ¨æ ‡æ˜(designating)*æ—¶ï¼Œä¸å¾—å¸¦æœ‰åƒHTTPè®¤è¯ï¼Œå®¢æˆ·ç«¯SSLè¯ä¹¦å’Œcookiesçš„è¯ä¹¦ã€‚ï¼‰ ä»¥ä¸‹å‡ ç‚¹ç‰¹æ€§ä¼šè®©ä½ åœ¨ç¨‹åºä¸­ä½¿ç”¨åŸºäºTokençš„èº«ä»½éªŒè¯ æ— çŠ¶æ€ã€å¯æ‰©å±• æ”¯æŒç§»åŠ¨è®¾å¤‡ è·¨ç¨‹åºè°ƒç”¨ å®‰å…¨ 3.Tokensçš„ä¼˜åŠ¿æ— çŠ¶æ€ã€å¯æ‰©å±•åœ¨å®¢æˆ·ç«¯å­˜å‚¨çš„Tokensæ˜¯æ— çŠ¶æ€çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«æ‰©å±•ã€‚åŸºäºè¿™ç§æ— çŠ¶æ€å’Œä¸å­˜å‚¨Sessionä¿¡æ¯ï¼Œè´Ÿè½½è´Ÿè½½å‡è¡¡å™¨èƒ½å¤Ÿå°†ç”¨æˆ·ä¿¡æ¯ä»ä¸€ä¸ªæœåŠ¡ä¼ åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šã€‚ å¦‚æœæˆ‘ä»¬å°†å·²éªŒè¯çš„ç”¨æˆ·çš„ä¿¡æ¯ä¿å­˜åœ¨Sessionä¸­ï¼Œåˆ™æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦ç”¨æˆ·å‘å·²éªŒè¯çš„æœåŠ¡å™¨å‘é€éªŒè¯ä¿¡æ¯(ç§°ä¸ºSessionäº²å’Œæ€§)ã€‚ç”¨æˆ·é‡å¤§æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆä¸€äº›æ‹¥å µã€‚ ä½¿ç”¨tokensä¹‹åè¿™äº›é—®é¢˜éƒ½è¿åˆƒè€Œè§£ï¼Œå› ä¸ºtokensè‡ªå·±holdä½äº†ç”¨æˆ·çš„éªŒè¯ä¿¡æ¯ã€‚ Tokensèƒ½å¤Ÿåˆ›å»ºä¸å…¶å®ƒç¨‹åºå…±äº«æƒé™çš„ç¨‹åºã€‚ä¾‹å¦‚ï¼Œèƒ½å°†ä¸€ä¸ªéšä¾¿çš„ç¤¾äº¤å¸å·å’Œè‡ªå·±çš„å¤§å·(Fackbookæˆ–æ˜¯Twitter)è”ç³»èµ·æ¥ã€‚å½“é€šè¿‡æœåŠ¡ç™»å½•Twitter(æˆ‘ä»¬å°†è¿™ä¸ªè¿‡ç¨‹Buffer)æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›Bufferé™„åˆ°Twitterçš„æ•°æ®æµä¸Š(we are allowing Buffer to post to our Twitter stream)ã€‚ ä½¿ç”¨tokensæ—¶ï¼Œå¯ä»¥æä¾›å¯é€‰çš„æƒé™ç»™ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºã€‚å½“ç”¨æˆ·æƒ³è®©å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºè®¿é—®å®ƒä»¬çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å»ºç«‹è‡ªå·±çš„APIï¼Œå¾—å‡ºç‰¹æ®Šæƒé™çš„tokensã€‚ å®‰å…¨æ€§è¯·æ±‚ä¸­å‘é€tokenè€Œä¸å†æ˜¯å‘é€cookieèƒ½å¤Ÿé˜²æ­¢CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )ã€‚å³ä½¿åœ¨å®¢æˆ·ç«¯ä½¿ç”¨cookieå­˜å‚¨tokenï¼Œcookieä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªå­˜å‚¨æœºåˆ¶è€Œä¸æ˜¯ç”¨äºè®¤è¯ã€‚ä¸å°†ä¿¡æ¯å­˜å‚¨åœ¨Sessionä¸­ï¼Œè®©æˆ‘ä»¬å°‘äº†å¯¹sessionæ“ä½œã€‚ tokenæ˜¯æœ‰æ—¶æ•ˆçš„ï¼Œä¸€æ®µæ—¶é—´ä¹‹åç”¨æˆ·éœ€è¦é‡æ–°éªŒè¯ã€‚æˆ‘ä»¬ä¹Ÿä¸ä¸€å®šéœ€è¦ç­‰åˆ°tokenè‡ªåŠ¨å¤±æ•ˆï¼Œtokenæœ‰æ’¤å›çš„æ“ä½œï¼Œé€šè¿‡token revocataionå¯ä»¥ä½¿ä¸€ä¸ªç‰¹å®šçš„tokenæˆ–æ˜¯ä¸€ç»„æœ‰ç›¸åŒè®¤è¯çš„tokenæ— æ•ˆã€‚ å¤šå¹³å°è·¨åŸŸæˆ‘ä»¬æå‰å…ˆæ¥è°ˆè®ºä¸€ä¸‹CORS(è·¨åŸŸèµ„æºå…±äº«)ï¼Œå¯¹åº”ç”¨ç¨‹åºå’ŒæœåŠ¡è¿›è¡Œæ‰©å±•çš„æ—¶å€™ï¼Œéœ€è¦ä»‹å…¥å„ç§å„æ ·çš„è®¾å¤‡å’Œåº”ç”¨ç¨‹åºã€‚ åªè¦ç”¨æˆ·æœ‰ä¸€ä¸ªé€šè¿‡äº†éªŒè¯çš„tokenï¼Œæ•°æ®å’Œèµ„æºå°±èƒ½å¤Ÿåœ¨ä»»ä½•åŸŸä¸Šè¢«è¯·æ±‚åˆ°ã€‚ åŸºäºæ ‡å‡†åˆ›å»ºtokençš„æ—¶å€™ï¼Œä½ å¯ä»¥è®¾å®šä¸€äº›é€‰é¡¹ã€‚æˆ‘ä»¬åœ¨åç»­çš„æ–‡ç« ä¸­ä¼šè¿›è¡Œæ›´åŠ è¯¦å°½çš„æè¿°ï¼Œä½†æ˜¯æ ‡å‡†çš„ç”¨æ³•ä¼šåœ¨JSON Web Tokensä½“ç°ã€‚ æœ€è¿‘çš„ç¨‹åºå’Œæ–‡æ¡£æ˜¯ä¾›ç»™JSON Web Tokensçš„ã€‚å®ƒæ”¯æŒä¼—å¤šçš„è¯­è¨€ã€‚è¿™æ„å‘³åœ¨æœªæ¥çš„ä½¿ç”¨ä¸­ä½ å¯ä»¥çœŸæ­£çš„è½¬æ¢ä½ çš„è®¤è¯æœºåˆ¶ã€‚ 4.ä¼ ç»Ÿçš„tokenç»„æˆtokenä¹Ÿç§°ä½œä»¤ç‰Œï¼Œç”±uid+time+sign[+å›ºå®šå‚æ•°]ç»„æˆ: uid: ç”¨æˆ·å”¯ä¸€èº«ä»½æ ‡è¯† time: å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ sign: ç­¾å, ä½¿ç”¨ hash/encrypt å‹ç¼©æˆå®šé•¿çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»¥é˜²æ­¢ç¬¬ä¸‰æ–¹æ¶æ„æ‹¼æ¥ å›ºå®šå‚æ•°(å¯é€‰): å°†ä¸€äº›å¸¸ç”¨çš„å›ºå®šå‚æ•°åŠ å…¥åˆ° token ä¸­æ˜¯ä¸ºäº†é¿å…é‡å¤æŸ¥åº“ 5.JWT tokençš„ç»„æˆå®æ–½ Token éªŒè¯çš„æ–¹æ³•æŒºå¤šçš„ï¼Œè¿˜æœ‰ä¸€äº›æ ‡å‡†æ–¹æ³•ï¼Œæ¯”å¦‚ JWTï¼Œè¯»ä½œï¼šjot ï¼Œè¡¨ç¤ºï¼šJSON Web Tokens ã€‚JWT æ ‡å‡†çš„ Token æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š header payload signature ä¸­é—´ç”¨ç‚¹åˆ†éš”å¼€ï¼Œå¹¶ä¸”éƒ½ä¼šä½¿ç”¨ Base64 ç¼–ç ï¼Œæ‰€ä»¥çœŸæ­£çš„ Token çœ‹èµ·æ¥åƒè¿™æ ·ï¼š 123eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ.SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc headerheader éƒ¨åˆ†ä¸»è¦æ˜¯ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œä¸€ä¸ªæ˜¯ Token çš„ç±»å‹ï¼Œå¦ä¸€ä¸ªæ˜¯ä½¿ç”¨çš„ç®—æ³• 1234&#123; \"typ\": \"JWT\", \"alg\": \"HS256\"&#125; ç±»å‹å°±æ˜¯ JWTï¼Œä½¿ç”¨çš„ç®—æ³•æ˜¯ HS256. ä¸Šé¢çš„å†…å®¹è¦ç”¨ Base64 çš„å½¢å¼ç¼–ç ä¸€ä¸‹ï¼Œæ‰€ä»¥å°±å˜æˆè¿™æ ·ï¼š 1eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9 PayloadPayload é‡Œé¢æ˜¯ Token çš„å…·ä½“å†…å®¹ï¼Œè¿™äº›å†…å®¹é‡Œé¢æœ‰ä¸€äº›æ˜¯æ ‡å‡†å­—æ®µï¼Œä½ ä¹Ÿå¯ä»¥æ·»åŠ å…¶å®ƒéœ€è¦çš„å†…å®¹ã€‚ä¸‹é¢æ˜¯æ ‡å‡†å­—æ®µï¼š issï¼šIssuerï¼Œå‘è¡Œè€… subï¼šSubjectï¼Œä¸»é¢˜ audï¼šAudienceï¼Œè§‚ä¼— expï¼šExpiration timeï¼Œè¿‡æœŸæ—¶é—´ nbfï¼šNot before iatï¼šIssued atï¼Œå‘è¡Œæ—¶é—´ jtiï¼šJWT ID 123456&#123; \"iss\": \"ninghao.net\", \"exp\": \"1438955445\", \"name\": \"wanghao\", \"admin\": true&#125; ä½¿ç”¨ Base64 ç¼–ç ä»¥åå°±å˜æˆäº†è¿™ä¸ªæ ·å­ï¼š 12eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ SignatureJWT çš„æœ€åä¸€éƒ¨åˆ†æ˜¯ Signature ï¼Œè¿™éƒ¨åˆ†å†…å®¹æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå…ˆæ˜¯ç”¨ Base64 ç¼–ç çš„ header.payload ï¼Œå†ç”¨åŠ å¯†ç®—æ³•åŠ å¯†ä¸€ä¸‹ï¼ŒåŠ å¯†çš„æ—¶å€™è¦æ”¾è¿›å»ä¸€ä¸ª Secret ï¼Œè¿™ä¸ªç›¸å½“äºæ˜¯ä¸€ä¸ªå¯†ç ï¼Œè¿™ä¸ªå¯†ç ç§˜å¯†åœ°å­˜å‚¨åœ¨æœåŠ¡ç«¯ã€‚ 12encodedString = base64UrlEncode(header) + \".\" + base64UrlEncode(payload); HMACSHA256(encodedString, 'secret'); å¤„ç†å®Œæˆä»¥åçœ‹èµ·æ¥åƒè¿™æ ·ï¼š 1SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc æœ€åè¿™ä¸ªåœ¨æœåŠ¡ç«¯ç”Ÿæˆå¹¶ä¸”è¦å‘é€ç»™å®¢æˆ·ç«¯çš„ Token çœ‹èµ·æ¥åƒè¿™æ ·ï¼š 123eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJuaW5naGFvLm5ldCIsImV4cCI6IjE0Mzg5NTU0NDUiLCJuYW1lIjoid2FuZ2hhbyIsImFkbWluIjp0cnVlfQ.SwyHTEx_RQppr97g4J5lKXtabJecpejuef8AqKYMAJc","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"å®‰å…¨","slug":"å®‰å…¨","permalink":"http://yoursite.com/tags/å®‰å…¨/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"}]},{"title":"symbol","slug":"symbol","date":"2020-01-22T07:20:01.000Z","updated":"2020-02-08T15:52:00.342Z","comments":true,"path":"2020/01/22/symbol/","link":"","permalink":"http://yoursite.com/2020/01/22/symbol/","excerpt":"","text":"symbolsymbolçš„ç‰¹æ€§ã€‚ Symbol å€¼é€šè¿‡Symbolå‡½æ•°ç”Ÿæˆã€‚è¿™å°±æ˜¯è¯´ï¼Œå¯¹è±¡çš„å±æ€§åç°åœ¨å¯ä»¥æœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯åŸæ¥å°±æœ‰çš„å­—ç¬¦ä¸²ï¼Œå¦ä¸€ç§å°±æ˜¯æ–°å¢çš„ Symbol ç±»å‹ã€‚ å‡¡æ˜¯å±æ€§åå±äº Symbol ç±»å‹ï¼Œå°±éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¯ä»¥ä¿è¯ä¸ä¼šä¸å…¶ä»–å±æ€§åäº§ç”Ÿå†²çªã€‚ï¼ˆSymbol å€¼ä½œä¸ºå¯¹è±¡å±æ€§åæ—¶ï¼Œä¸èƒ½ç”¨ç‚¹è¿ç®—ç¬¦ã€‚å› ä¸ºç‚¹è¿ç®—ç¬¦åé¢æ€»æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ä¼šè¯»å–mySymbolä½œä¸ºæ ‡è¯†åæ‰€æŒ‡ä»£çš„é‚£ä¸ªå€¼ï¼Œå¯¼è‡´açš„å±æ€§åå®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª Symbol å€¼ã€‚åŒç†ï¼Œåœ¨å¯¹è±¡çš„å†…éƒ¨ï¼Œä½¿ç”¨ Symbol å€¼å®šä¹‰å±æ€§æ—¶ï¼ŒSymbol å€¼å¿…é¡»æ”¾åœ¨æ–¹æ‹¬å·ä¹‹ä¸­ã€‚ï¼‰Symbol å€¼ä½œä¸ºå±æ€§åæ—¶ï¼Œè¯¥å±æ€§è¿˜æ˜¯å…¬å¼€å±æ€§ï¼Œä¸æ˜¯ç§æœ‰å±æ€§ã€‚ æ³¨æ„ï¼ŒSymbolå‡½æ•°å‰ä¸èƒ½ä½¿ç”¨newå‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„ Symbol æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¸æ˜¯å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äº Symbol å€¼ä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¸èƒ½æ·»åŠ å±æ€§ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¯ä¸€ç§ç±»ä¼¼äºå­—ç¬¦ä¸²çš„æ•°æ®ç±»å‹ã€‚ symbolä¸€æ—¦åˆ›å»ºåå°±ä¸å¯æ›´æ”¹ã€‚ å¦‚æœ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„toStringæ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚Symbolå‡½æ•°çš„å‚æ•°åªæ˜¯è¡¨ç¤ºå¯¹å½“å‰ Symbol å€¼çš„æè¿°ï¼Œå› æ­¤ç›¸åŒå‚æ•°çš„Symbolå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸ç›¸ç­‰çš„ã€‚ Symbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚ï¼ˆSymbol ä¸èƒ½è‡ªåŠ¨è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå½“å°è¯•å°†ä¸€ä¸ª Symbol å¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œå°†è¿”å›ä¸€ä¸ª TypeErrorã€‚ï¼‰ Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚ 1234let sym = Symbol('My symbol');String(sym) // 'Symbol(My symbol)'sym.toString() // 'Symbol(My symbol)' å¦å¤–ï¼ŒSymbol å€¼ä¹Ÿå¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼ï¼Œä½†æ˜¯ä¸èƒ½è½¬ä¸ºæ•°å€¼ã€‚ 12345678910let sym = Symbol();Boolean(sym) // true!sym // falseif (sym) &#123; // ...&#125;Number(sym) // TypeErrorsym + 2 // TypeError Symbolå±æ€§åéå†ï¼šSymbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨for...inã€for...ofå¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢«Object.keys()ã€Object.getOwnPropertyNames()ã€JSON.stringify()è¿”å›ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ç§æœ‰å±æ€§ï¼Œæœ‰ä¸€ä¸ªObject.getOwnPropertySymbolsæ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚ Object.getOwnPropertySymbolsæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å½“å‰å¯¹è±¡çš„æ‰€æœ‰ç”¨ä½œå±æ€§åçš„ Symbol å€¼ã€‚ 1234567891011121314151617const obj = &#123;&#125;;let foo = Symbol(\"foo\");Object.defineProperty(obj, foo, &#123; value: \"foobar\",&#125;);for (let i in obj) &#123; console.log(i); // æ— è¾“å‡º&#125;Object.getOwnPropertyNames(obj)// []Object.getOwnPropertySymbols(obj)// [Symbol(foo)] Reflect.ownKeysæ–¹æ³•å¯ä»¥è¿”å›æ‰€æœ‰ç±»å‹çš„é”®åï¼ŒåŒ…æ‹¬å¸¸è§„é”®åå’Œ Symbol é”®åã€‚ 12345678let obj = &#123; [Symbol('my_key')]: 1, enum: 2, nonEnum: 3&#125;;Reflect.ownKeys(obj)// [\"enum\", \"nonEnum\", Symbol(my_key)] ç”±äºä»¥ Symbol å€¼ä½œä¸ºåç§°çš„å±æ€§ï¼Œä¸ä¼šè¢«å¸¸è§„æ–¹æ³•éå†å¾—åˆ°ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œä¸ºå¯¹è±¡å®šä¹‰ä¸€äº›éç§æœ‰çš„ã€ä½†åˆå¸Œæœ›åªç”¨äºå†…éƒ¨çš„æ–¹æ³•ã€‚ è·å– Symbol çš„ä¸‰ç§æ–¹æ³• Symbol() æ¯æ¬¡è°ƒç”¨æ—¶éƒ½è¿”å›ä¸€ä¸ªå”¯ä¸€çš„ Symbolã€‚ Symbol.for(string) ã€Symbol.keyFor()Symbol.Forä» Symbol æ³¨å†Œè¡¨ä¸­è¿”å›ç›¸åº”çš„ Symbolï¼Œä¸ä¸Šä¸ªæ–¹æ³•ä¸åŒçš„æ˜¯ï¼ŒSymbol æ³¨å†Œè¡¨ä¸­çš„ Symbol æ˜¯å…±äº«çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ è°ƒç”¨ Symbol.for(&quot;cat&quot;) ä¸‰æ¬¡ï¼Œéƒ½å°†è¿”å›ç›¸åŒçš„ Symbolã€‚å½“ä¸åŒé¡µé¢æˆ–åŒä¸€é¡µé¢ä¸åŒæ¨¡å—éœ€è¦å…±äº« Symbol æ—¶ï¼Œæ³¨å†Œè¡¨å°±éå¸¸æœ‰ç”¨ã€‚ï¼ˆSymbol.for()ä¸Symbol()è¿™ä¸¤ç§å†™æ³•ï¼Œéƒ½ä¼šç”Ÿæˆæ–°çš„ Symbolã€‚å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¼šè¢«ç™»è®°åœ¨å…¨å±€ç¯å¢ƒä¸­ä¾›æœç´¢ï¼Œåè€…ä¸ä¼šã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ è°ƒç”¨Symbol.for(&quot;cat&quot;)30 æ¬¡ï¼Œæ¯æ¬¡éƒ½ä¼šè¿”å›åŒä¸€ä¸ª Symbol å€¼ï¼Œä½†æ˜¯è°ƒç”¨Symbol(&quot;cat&quot;)30 æ¬¡ï¼Œä¼šè¿”å› 30 ä¸ªä¸åŒçš„ Symbol å€¼ã€‚ï¼‰Symbol.keyForæ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„keyã€‚ Symbol.iterator è¿”å›è¯­è¨€é¢„å®šä¹‰çš„ä¸€äº› Symbolï¼Œæ¯ä¸ªéƒ½æœ‰å…¶ç‰¹æ®Šçš„ç”¨é€”ã€‚ Symbol åœ¨ ES6 è§„èŒƒä¸­çš„åº”ç”¨æˆ‘ä»¬å·²ç»çŸ¥é“å¯ä»¥ä½¿ç”¨ Symbol æ¥é¿å…ä»£ç å†²çªã€‚ä¹‹å‰åœ¨ä»‹ç» iterator æ—¶ï¼Œæˆ‘ä»¬è¿˜è§£æäº† for (var item of myArray) å†…éƒ¨æ˜¯ä»¥è°ƒç”¨ myArray[Symbol.iterator]() å¼€å§‹çš„ï¼Œå½“æ—¶æˆ‘æåˆ°è¿™ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨ myArray.iterator() æ¥ä»£æ›¿ï¼Œä½†æ˜¯ä½¿ç”¨ Symbol çš„åå‘å…¼å®¹æ€§æ›´å¥½ã€‚ åœ¨ ES6 ä¸­è¿˜æœ‰ä¸€äº›åœ°æ–¹ä½¿ç”¨åˆ°äº† Symbolã€‚ï¼ˆè¿™äº›ç‰¹æ€§è¿˜æ²¡æœ‰åœ¨ FireFox ä¸­å®ç°ã€‚ï¼‰ ä½¿ instanceof å¯æ‰©å±•ã€‚åœ¨ ES6 ä¸­ï¼Œobject instanceof constructor è¡¨è¾¾å¼è¢«æ ‡å‡†åŒ–ä¸ºæ„é€ å‡½æ•°çš„ä¸€ä¸ªæ–¹æ³•ï¼šconstructor[Symbol.hasInstance](object)ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯å¯æ‰©å±•çš„ã€‚ æ¶ˆé™¤æ–°ç‰¹æ€§å’Œæ—§ä»£ç ä¹‹é—´çš„å†²çªã€‚ æ”¯æŒæ–°ç±»å‹çš„å­—ç¬¦ä¸²åŒ¹é…ã€‚åœ¨ ES5 ä¸­ï¼Œè°ƒç”¨ str.match(myObject) æ—¶ï¼Œé¦–å…ˆä¼šå°è¯•å°† myObject è½¬æ¢ä¸º RegExp å¯¹è±¡ã€‚åœ¨ ES6 ä¸­ï¼Œé¦–å…ˆå°†æ£€æŸ¥ myObject ä¸­æ˜¯å¦æœ‰ myObject[Symbol.match](str) æ–¹æ³•ï¼Œåœ¨æ‰€æœ‰æ­£åˆ™è¡¨è¾¾å¼å·¥ä½œçš„åœ°æ–¹éƒ½å¯ä»¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„å­—ç¬¦ä¸²è§£ææ–¹æ³•ã€‚ ##symbolçš„11ä¸ªå†…ç½®å€¼ Symbol.hasInstanceæ–¹æ³•ï¼Œä¼šè¢«instanceofè¿ç®—ç¬¦è°ƒç”¨ã€‚æ„é€ å™¨å¯¹è±¡ç”¨æ¥è¯†åˆ«ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å…¶å®ä¾‹ã€‚ Symbol.isConcatSpreadableå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨Array.prototype.concatæ—¶ï¼Œè¿™ä¸ªå¯¹è±¡çš„æ•°ç»„å…ƒç´ æ˜¯å¦å¯å±•å¼€ã€‚ Symbol.iteratoræ–¹æ³•ï¼Œè¢«for-ofè¯­å¥è°ƒç”¨ã€‚è¿”å›å¯¹è±¡çš„é»˜è®¤è¿­ä»£å™¨ã€‚ Symbol.matchæ–¹æ³•ï¼Œè¢«String.prototype.matchè°ƒç”¨ã€‚æ­£åˆ™è¡¨è¾¾å¼ç”¨æ¥åŒ¹é…å­—ç¬¦ä¸²ã€‚ Symbol.replaceæ–¹æ³•ï¼Œè¢«String.prototype.replaceè°ƒç”¨ã€‚æ­£åˆ™è¡¨è¾¾å¼ç”¨æ¥æ›¿æ¢å­—ç¬¦ä¸²ä¸­åŒ¹é…çš„å­ä¸²ã€‚ Symbol.searchæ–¹æ³•ï¼Œè¢«String.prototype.searchè°ƒç”¨ã€‚æ­£åˆ™è¡¨è¾¾å¼è¿”å›è¢«åŒ¹é…éƒ¨åˆ†åœ¨å­—ç¬¦ä¸²ä¸­çš„ç´¢å¼•ã€‚ Symbol.specieså‡½æ•°å€¼ï¼Œä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ã€‚ç”¨æ¥åˆ›å»ºæ´¾ç”Ÿå¯¹è±¡ã€‚ Symbol.splitæ–¹æ³•ï¼Œè¢«String.prototype.splitè°ƒç”¨ã€‚æ­£åˆ™è¡¨è¾¾å¼æ¥ç”¨åˆ†å‰²å­—ç¬¦ä¸²ã€‚ Symbol.toPrimitiveæ–¹æ³•ï¼Œè¢«ToPrimitiveæŠ½è±¡æ“ä½œè°ƒç”¨ã€‚æŠŠå¯¹è±¡è½¬æ¢ä¸ºç›¸åº”çš„åŸå§‹å€¼ã€‚ Symbol.toStringTagæ–¹æ³•ï¼Œè¢«å†…ç½®æ–¹æ³•Object.prototype.toStringè°ƒç”¨ã€‚è¿”å›åˆ›å»ºå¯¹è±¡æ—¶é»˜è®¤çš„å­—ç¬¦ä¸²æè¿°ã€‚ Symbol.unscopableså¯¹è±¡ï¼Œå®ƒè‡ªå·±æ‹¥æœ‰çš„å±æ€§ä¼šè¢«withä½œç”¨åŸŸæ’é™¤åœ¨å¤–ã€‚ ï¼ˆè¯¦è§£å¯è§é˜®ä¸€å³°ES6å…¥é—¨http://es6.ruanyifeng.com/#docs/symbolï¼‰ æ¨¡æ‹Ÿå®ç°symbolå›é¡¾ç‰¹æ€§1. Symbol å€¼é€šè¿‡ Symbol å‡½æ•°ç”Ÿæˆï¼Œä½¿ç”¨ typeofï¼Œç»“æœä¸º â€œsymbolâ€ 12var s = Symbol();console.log(typeof s); // \"symbol\" 2. Symbol å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨ new å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„ Symbol æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¸æ˜¯å¯¹è±¡ã€‚ 3. instanceof çš„ç»“æœä¸º false 12var s = Symbol('foo');console.log(s instanceof Symbol); // false 4. Symbol å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå¯¹ Symbol å®ä¾‹çš„æè¿°ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºï¼Œæˆ–è€…è½¬ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚ 12var s1 = Symbol('foo');console.log(s1); // Symbol(foo) 5. å¦‚æœ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ toString æ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚ 1234567const obj = &#123; toString() &#123; return 'abc'; &#125;&#125;;const sym = Symbol(obj);console.log(sym); // Symbol(abc) 6. Symbol å‡½æ•°çš„å‚æ•°åªæ˜¯è¡¨ç¤ºå¯¹å½“å‰ Symbol å€¼çš„æè¿°ï¼Œç›¸åŒå‚æ•°çš„ Symbol å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸ç›¸ç­‰çš„ã€‚ 1234567891011// æ²¡æœ‰å‚æ•°çš„æƒ…å†µvar s1 = Symbol();var s2 = Symbol();console.log(s1 === s2); // false// æœ‰å‚æ•°çš„æƒ…å†µvar s1 = Symbol('foo');var s2 = Symbol('foo');console.log(s1 === s2); // false 7. Symbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚ 123var sym = Symbol('My symbol');console.log(\"your symbol is \" + sym); // TypeError: can't convert symbol to string 8. Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚ 1234var sym = Symbol('My symbol');console.log(String(sym)); // 'Symbol(My symbol)'console.log(sym.toString()); // 'Symbol(My symbol)' 9. Symbol å€¼å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå¯¹è±¡çš„å±æ€§åï¼Œå¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚ 1234567891011121314151617var mySymbol = Symbol();// ç¬¬ä¸€ç§å†™æ³•var a = &#123;&#125;;a[mySymbol] = 'Hello!';// ç¬¬äºŒç§å†™æ³•var a = &#123; [mySymbol]: 'Hello!'&#125;;// ç¬¬ä¸‰ç§å†™æ³•var a = &#123;&#125;;Object.defineProperty(a, mySymbol, &#123; value: 'Hello!' &#125;);// ä»¥ä¸Šå†™æ³•éƒ½å¾—åˆ°åŒæ ·ç»“æœconsole.log(a[mySymbol]); // \"Hello!\" 10. Symbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨ forâ€¦inã€forâ€¦of å¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢« Object.keys()ã€Object.getOwnPropertyNames()ã€JSON.stringify() è¿”å›ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ç§æœ‰å±æ€§ï¼Œæœ‰ä¸€ä¸ª Object.getOwnPropertySymbols æ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚ 1234567891011var obj = &#123;&#125;;var a = Symbol('a');var b = Symbol('b');obj[a] = 'Hello';obj[b] = 'World';var objectSymbols = Object.getOwnPropertySymbols(obj);console.log(objectSymbols);// [Symbol(a), Symbol(b)] 11. å¦‚æœæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨åŒä¸€ä¸ª Symbol å€¼ï¼Œå¯ä»¥ä½¿ç”¨ Symbol.forã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„ Symbol å€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ª Symbol å€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„ Symbol å€¼ã€‚ 1234var s1 = Symbol.for('foo');var s2 = Symbol.for('foo');console.log(s1 === s2); // true 12. Symbol.keyFor æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„ keyã€‚ 12345var s1 = Symbol.for(\"foo\");console.log(Symbol.keyFor(s1)); // \"foo\"var s2 = Symbol(\"foo\");console.log(Symbol.keyFor(s2) ); // undefined å½“è°ƒç”¨ Symbol çš„æ—¶å€™ï¼Œå‘ç”Ÿä»€ä¹ˆï¼Ÿå½“è°ƒç”¨ Symbol çš„æ—¶å€™ï¼Œä¼šé‡‡ç”¨ä»¥ä¸‹æ­¥éª¤ï¼š å¦‚æœä½¿ç”¨ new ï¼Œå°±æŠ¥é”™ å¦‚æœ description æ˜¯ undefinedï¼Œè®© descString ä¸º undefined å¦åˆ™ è®© descString ä¸º ToString(description) å¦‚æœæŠ¥é”™ï¼Œå°±è¿”å› è¿”å›ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„ Symbol å€¼ï¼Œå®ƒçš„å†…éƒ¨å±æ€§ [[Description]] å€¼ä¸º descString ç¬¬ä¸€ç‰ˆ1234567891011121314151617181920212223242526272829// ç¬¬ä¸€ç‰ˆ(function() &#123; var root = this; var SymbolPolyfill = function Symbol(description) &#123; // å®ç°ç¬¬2ç‚¹ç‰¹æ€§ï¼šSymbol å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨ new å‘½ä»¤ if (this instanceof SymbolPolyfill) throw new TypeError('Symbol is not a constructor'); // å®ç°ç¬¬ 5 ç‚¹ç‰¹æ€§ï¼šå¦‚æœ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ toString æ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚ var descString = description === undefined ? undefined : String(description) var symbol = Object.create(null) Object.defineProperties(symbol, &#123; '__Description__': &#123; value: descString, writable: false, enumerable: false, configurable: false &#125; &#125;); // å®ç°ç¬¬ 6 ç‚¹ç‰¹æ€§ï¼Œå› ä¸ºè°ƒç”¨è¯¥æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ï¼Œåªè¦å¼•ç”¨ä¸åŒï¼Œå°±ä¸ä¼šç›¸åŒ return symbol; &#125; root.SymbolPolyfill = SymbolPolyfill;&#125;)(); ç¬¬äºŒç‰ˆ1. ä½¿ç”¨ typeofï¼Œç»“æœä¸º â€œsymbolâ€ã€‚ åˆ©ç”¨ ES5ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ä¿®æ”¹ typeof æ“ä½œç¬¦çš„ç»“æœï¼Œæ‰€ä»¥è¿™ä¸ªæ— æ³•å®ç°ã€‚ 3. instanceof çš„ç»“æœä¸º false å› ä¸ºä¸æ˜¯é€šè¿‡ new çš„æ–¹å¼å®ç°çš„ï¼Œæ‰€ä»¥ instanceof çš„ç»“æœè‡ªç„¶æ˜¯ falseã€‚ 4.Symbol å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå¯¹ Symbol å®ä¾‹çš„æè¿°ã€‚ä¸»è¦æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºï¼Œæˆ–è€…è½¬ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚ å½“æˆ‘ä»¬æ‰“å°ä¸€ä¸ªåŸç”Ÿ Symbol å€¼çš„æ—¶å€™ï¼š 1console.log(Symbol(&apos;1&apos;)); // Symbol(1) å¯æ˜¯æˆ‘ä»¬æ¨¡æ‹Ÿå®ç°çš„æ—¶å€™è¿”å›çš„å´æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸ªä¹Ÿæ˜¯æ— æ³•å®ç°çš„ï¼Œå½“ç„¶ä½ ä¿®æ”¹ console.log è¿™ä¸ªæ–¹æ³•æ˜¯å¦è®²ã€‚ 8.Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚ 1234var sym = Symbol('My symbol');console.log(String(sym)); // 'Symbol(My symbol)'console.log(sym.toString()); // 'Symbol(My symbol)' å½“è°ƒç”¨ String æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœè¯¥å¯¹è±¡æœ‰ toString æ–¹æ³•ï¼Œå°±ä¼šè°ƒç”¨è¯¥ toString æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ç»™è¿”å›çš„å¯¹è±¡æ·»åŠ ä¸€ä¸ª toString æ–¹æ³•ï¼Œå³å¯å®ç°è¿™ä¸¤ä¸ªæ•ˆæœã€‚ 1234567891011// ç¬¬äºŒç‰ˆ// å‰é¢é¢ä»£ç ç›¸åŒ â€¦â€¦var symbol = Object.create(&#123; toString: function() &#123; return 'Symbol(' + this.__Description__ + ')'; &#125;,&#125;);// åé¢ä»£ç ç›¸åŒ â€¦â€¦ ç¬¬ä¸‰ç‰ˆSymbol å€¼å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå¯¹è±¡çš„å±æ€§åï¼Œå¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚ çœ‹ç€å¥½åƒæ²¡ä»€ä¹ˆï¼Œè¿™ç‚¹å…¶å®å’Œç¬¬ 8 ç‚¹æ˜¯å†²çªçš„ï¼Œè¿™æ˜¯å› ä¸ºå½“æˆ‘ä»¬æ¨¡æ‹Ÿçš„æ‰€è°“ Symbol å€¼å…¶å®æ˜¯ä¸€ä¸ªæœ‰ç€ toString æ–¹æ³•çš„ å¯¹è±¡ï¼Œå½“å¯¹è±¡ä½œä¸ºå¯¹è±¡çš„å±æ€§åçš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œéšå¼ç±»å‹è½¬æ¢ï¼Œè¿˜æ˜¯ä¼šè°ƒç”¨æˆ‘ä»¬æ·»åŠ çš„ toString æ–¹æ³•ï¼Œå¯¹äº Symbol(â€˜fooâ€™) å’Œ Symbol(â€˜fooâ€™)ä¸¤ä¸ª Symbol å€¼ï¼Œè™½ç„¶æè¿°ä¸€æ ·ï¼Œä½†æ˜¯å› ä¸ºæ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å¹¶ä¸ç›¸ç­‰ï¼Œä½†æ˜¯å½“ä½œä¸ºå¯¹è±¡çš„å±æ€§åçš„æ—¶å€™ï¼Œéƒ½ä¼šéšå¼è½¬æ¢ä¸º Symbol(foo) å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šé€ æˆåŒåçš„å±æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼š 12345678910var a = SymbolPolyfill('foo');var b = SymbolPolyfill('foo');console.log(a === b); // falsevar o = &#123;&#125;;o[a] = 'hello';o[b] = 'hi';console.log(o); // &#123;Symbol(foo): 'hi'&#125; ä¸ºäº†é˜²æ­¢ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œè¿«ä¸å¾—å·²ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ toString æ–¹æ³•ï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå”¯ä¸€å€¼ï¼Œæ‰€ä»¥ç¬¬ 8 ç‚¹å°±æ— æ³•å®ç°äº†ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜éœ€è¦å†å†™ä¸€ä¸ªç”¨æ¥ç”Ÿæˆ å”¯ä¸€å€¼çš„æ–¹æ³•ï¼Œå°±å‘½åä¸º generateNameï¼Œæˆ‘ä»¬å°†è¯¥å”¯ä¸€å€¼æ·»åŠ åˆ°è¿”å›å¯¹è±¡çš„ Name å±æ€§ä¸­ä¿å­˜ä¸‹æ¥ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// ç¬¬ä¸‰ç‰ˆ(function() &#123; var root = this; var generateName = (function()&#123; var postfix = 0; return function(descString)&#123; postfix++; return '@@' + descString + '_' + postfix &#125; &#125;)() var SymbolPolyfill = function Symbol(description) &#123; if (this instanceof SymbolPolyfill) throw new TypeError('Symbol is not a constructor'); var descString = description === undefined ? undefined : String(description) var symbol = Object.create(&#123; toString: function() &#123; return this.__Name__; &#125; &#125;) Object.defineProperties(symbol, &#123; '__Description__': &#123; value: descString, writable: false, enumerable: false, configurable: false &#125;, '__Name__': &#123; value: generateName(descString), writable: false, enumerable: false, configurable: false &#125; &#125;); return symbol; &#125; root.SymbolPolyfill = SymbolPolyfill;&#125;)() æ­¤æ—¶å†çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼š 12345678910var a = SymbolPolyfill('foo');var b = SymbolPolyfill('foo');console.log(a === b); // falsevar o = &#123;&#125;;o[a] = 'hello';o[b] = 'hi';console.log(o); // Object &#123; \"@@foo_1\": \"hello\", \"@@foo_2\": \"hi\" &#125; ç¬¬å››ç‰ˆ7.Symbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚ ä»¥ + æ“ä½œç¬¦ä¸ºä¾‹ï¼Œå½“è¿›è¡Œéšå¼ç±»å‹è½¬æ¢çš„æ—¶å€™ï¼Œä¼šå…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰è¿”å›åŸºæœ¬å€¼ï¼Œå°±ä¼šå†è°ƒç”¨ toString æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åœ¨ valueOf æ–¹æ³•ä¸­è¿›è¡ŒæŠ¥é”™ï¼Œæ¯”å¦‚ï¼š 1234567var symbol = Object.create(&#123; valueOf: function() &#123; throw new Error('Cannot convert a Symbol value') &#125;&#125;)console.log('1' + symbol); // æŠ¥é”™ çœ‹ç€å¾ˆç®€å•çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå¯æ˜¯å¦‚æœæˆ‘ä»¬æ˜¯æ˜¾å¼è°ƒç”¨ valueOf æ–¹æ³•å‘¢ï¼Ÿå¯¹äºä¸€ä¸ªåŸç”Ÿçš„ Symbol å€¼ï¼š 12var s1 = Symbol('foo')console.log(s1.valueOf()); // Symbol(foo) æ˜¯çš„ï¼Œå¯¹äºåŸç”Ÿ Symbolï¼Œæ˜¾å¼è°ƒç”¨ valueOf æ–¹æ³•ï¼Œä¼šç›´æ¥è¿”å›è¯¥ Symbol å€¼ï¼Œè€Œæˆ‘ä»¬åˆæ— æ³•åˆ¤æ–­æ˜¯æ˜¾å¼è¿˜æ˜¯éšå¼çš„è°ƒç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªæˆ‘ä»¬å°±åªèƒ½å®ç°ä¸€åŠï¼Œè¦ä¸ç„¶å®ç°éšå¼è°ƒç”¨æŠ¥é”™ï¼Œè¦ä¸ç„¶å®ç°æ˜¾å¼è°ƒç”¨è¿”å›è¯¥å€¼ï¼Œé‚£â€¦â€¦æˆ‘ä»¬é€‰æ‹©ä¸æŠ¥é”™çš„é‚£ä¸ªå§ï¼Œå³åè€…ã€‚ æˆ‘ä»¬è¿«ä¸å¾—å·²çš„ä¿®æ”¹ valueOf å‡½æ•°ï¼š 123456789101112// ç¬¬å››ç‰ˆ// å‰é¢é¢ä»£ç ç›¸åŒ â€¦â€¦var symbol = Object.create(&#123; toString: function() &#123; return this.__Name__; &#125;, valueOf: function() &#123; return this; &#125;&#125;);// åé¢ä»£ç ç›¸åŒ â€¦â€¦ ç¬¬äº”ç‰ˆ10. Symbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨ forâ€¦inã€forâ€¦of å¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢« Object.keys()ã€Object.getOwnPropertyNames()ã€JSON.stringify() è¿”å›ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ç§æœ‰å±æ€§ï¼Œæœ‰ä¸€ä¸ª Object.getOwnPropertySymbols æ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚ å—¯ï¼Œæ— æ³•å®ç°ã€‚ 11. æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é‡æ–°ä½¿ç”¨åŒä¸€ä¸ªSymbolå€¼ï¼ŒSymbol.foræ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„Symbolå€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ªSymbolå€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„Symbolå€¼ã€‚ è¿™ä¸ªå®ç°ç±»ä¼¼äºå‡½æ•°è®°å¿†ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å‚¨å­˜å·²ç»åˆ›å»ºçš„ Symbol å€¼å³å¯ã€‚ 12. Symbol.keyFor æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„ keyã€‚ éå† forMap,æŸ¥æ‰¾è¯¥å€¼å¯¹åº”çš„é”®å€¼å³å¯ã€‚ 12345678910111213141516171819202122232425262728// ç¬¬äº”ç‰ˆ// å‰é¢ä»£ç ç›¸åŒ â€¦â€¦var SymbolPolyfill = function() &#123; ... &#125;var forMap = &#123;&#125;;Object.defineProperties(SymbolPolyfill, &#123; 'for': &#123; value: function(description) &#123; var descString = description === undefined ? undefined : String(description) return forMap[descString] ? forMap[descString] : forMap[descString] = SymbolPolyfill(descString); &#125;, writable: true, enumerable: false, configurable: true &#125;, 'keyFor': &#123; value: function(symbol) &#123; for (var key in forMap) &#123; if (forMap[key] === symbol) return key; &#125; &#125;, writable: true, enumerable: false, configurable: true &#125;&#125;);// åé¢ä»£ç ç›¸åŒ â€¦â€¦ å®Œæ•´å®ç°ç»¼ä¸Šæ‰€è¿°ï¼š æ— æ³•å®ç°çš„ç‰¹æ€§æœ‰ï¼š1ã€4ã€7ã€8ã€10 å¯ä»¥å®ç°çš„ç‰¹æ€§æœ‰ï¼š2ã€3ã€5ã€6ã€9ã€11ã€12 æœ€åçš„å®ç°å¦‚ä¸‹: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071(function() &#123; var root = this; var generateName = (function()&#123; var postfix = 0; return function(descString)&#123; postfix++; return '@@' + descString + '_' + postfix &#125; &#125;)() var SymbolPolyfill = function Symbol(description) &#123; if (this instanceof SymbolPolyfill) throw new TypeError('Symbol is not a constructor'); var descString = description === undefined ? undefined : String(description) var symbol = Object.create(&#123; toString: function() &#123; return this.__Name__; &#125;, valueOf: function() &#123; return this; &#125; &#125;) Object.defineProperties(symbol, &#123; '__Description__': &#123; value: descString, writable: false, enumerable: false, configurable: false &#125;, '__Name__': &#123; value: generateName(descString), writable: false, enumerable: false, configurable: false &#125; &#125;); return symbol; &#125; var forMap = &#123;&#125;; Object.defineProperties(SymbolPolyfill, &#123; 'for': &#123; value: function(description) &#123; var descString = description === undefined ? undefined : String(description) return forMap[descString] ? forMap[descString] : forMap[descString] = SymbolPolyfill(descString); &#125;, writable: true, enumerable: false, configurable: true &#125;, 'keyFor': &#123; value: function(symbol) &#123; for (var key in forMap) &#123; if (forMap[key] === symbol) return key; &#125; &#125;, writable: true, enumerable: false, configurable: true &#125; &#125;); root.SymbolPolyfill = SymbolPolyfill;&#125;)()","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"ES6ç±»ä»¥åŠç»§æ‰¿çš„å®ç°åŸç†","slug":"ES6ç±»ä»¥åŠç»§æ‰¿çš„å®ç°åŸç†","date":"2020-01-17T15:46:51.000Z","updated":"2020-02-08T15:47:48.737Z","comments":true,"path":"2020/01/17/ES6ç±»ä»¥åŠç»§æ‰¿çš„å®ç°åŸç†/","link":"","permalink":"http://yoursite.com/2020/01/17/ES6ç±»ä»¥åŠç»§æ‰¿çš„å®ç°åŸç†/","excerpt":"","text":"ES6ç±»ä»¥åŠç»§æ‰¿çš„å®ç°åŸç†ES6åˆ›å»ºä¸€ä¸ªç±»çš„è¿‡ç¨‹ES6ä¸­é€šè¿‡classå…³é”®å­—ï¼Œå®šä¹‰ç±» 123456789class Parent &#123; constructor(name,age)&#123; this.name = name; this.age = age; &#125; speakSomething()&#123; console.log(\"I can speek chinese\"); &#125;&#125; ç»è¿‡babelè½¬ç ä¹‹å 12345678910111213141516171819202122232425262728293031323334353637383940414243\"use strict\";var _createClass = function () &#123; function defineProperties(target, props) &#123; for (var i = 0; i &lt; props.length; i++) &#123; var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); &#125; &#125; return function (Constructor, protoProps, staticProps) &#123; if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; &#125;;&#125;();function _classCallCheck(instance, Constructor) &#123; if (!(instance instanceof Constructor)) &#123; throw new TypeError(\"Cannot call a class as a function\"); &#125;&#125;var Parent = function () &#123; function Parent(name, age) &#123; _classCallCheck(this, Parent); this.name = name; this.age = age; &#125; _createClass(Parent, [&#123; key: \"speakSomething\", value: function speakSomething() &#123; console.log(\"I can speek chinese\"); &#125; &#125;]); return Parent;&#125;(); ES6ç±»çš„åº•å±‚è¿˜æ˜¯é€šè¿‡æ„é€ å‡½æ•°å»åˆ›å»ºçš„ å¯è§classçš„åº•å±‚ä¾ç„¶æ˜¯æ„é€ å‡½æ•°ï¼š è°ƒç”¨_classCallCheckæ–¹æ³•åˆ¤æ–­å½“å‰å‡½æ•°è°ƒç”¨å‰æ˜¯å¦æœ‰newå…³é”®å­—ã€‚ æ„é€ å‡½æ•°æ‰§è¡Œå‰æœ‰newå…³é”®å­—ï¼Œä¼šåœ¨æ„é€ å‡½æ•°å†…éƒ¨åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå°†æ„é€ å‡½æ•°çš„proptypeæŒ‡å‘è¿™ä¸ªç©ºå¯¹è±¡çš„proto,å¹¶å°†thisæŒ‡å‘è¿™ä¸ªç©ºå¯¹è±¡ã€‚å¦‚ä¸Šï¼Œ_classCallCheckä¸­ï¼šthis instanceof Parent è¿”å›trueã€‚ è‹¥æ„é€ å‡½æ•°å‰é¢æ²¡æœ‰newåˆ™æ„é€ å‡½æ•°çš„proptypeä¸ä¼šä¸å‡ºç°åœ¨thisçš„åŸå‹é“¾ä¸Šï¼Œè¿”å›falseã€‚ é€šè¿‡ES6åˆ›å»ºçš„ç±»ï¼Œæ˜¯ä¸å…è®¸ä½ ç›´æ¥è°ƒç”¨çš„ã€‚åœ¨ES5ä¸­ï¼Œæ„é€ å‡½æ•°æ˜¯å¯ä»¥ç›´æ¥è¿è¡Œçš„ï¼Œæ¯”å¦‚Parent()ã€‚ä½†æ˜¯åœ¨ES6å°±ä¸è¡Œã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è½¬ç çš„æ„é€ å‡½æ•°ä¸­æœ‰_classCallCheck(this, Parent)è¯­å¥,è¿™å¥è¯æ˜¯é˜²æ­¢ä½ é€šè¿‡æ„é€ å‡½æ•°ç›´æ¥è¿è¡Œçš„ã€‚ä½ ç›´æ¥åœ¨ES6è¿è¡ŒParent(),è¿™æ˜¯ä¸å…è®¸çš„,ES6ä¸­æŠ›å‡ºClass constructor Parent cannot be invoked without &#39;new&#39;é”™è¯¯ã€‚è½¬ç åçš„ä¼šæŠ›å‡ºCannot call a class as a function.æˆ‘è§‰å¾—è¿™æ ·çš„è§„èŒƒæŒºå¥½çš„ï¼Œèƒ½å¤Ÿè§„èŒƒåŒ–ç±»çš„ä½¿ç”¨æ–¹å¼ã€‚ å°†classå†…éƒ¨çš„å˜é‡å’Œå‡½æ•°èµ‹ç»™thisã€‚ è½¬ç ä¸­_createClassæ–¹æ³•ï¼Œå®ƒè°ƒç”¨Object.definePropertyæ–¹æ³•å»ç»™æ–°åˆ›å»ºçš„Parentæ·»åŠ å„ç§å±æ€§ã€‚defineProperties(Constructor.prototype, protoProps)æ˜¯ç»™åŸå‹æ·»åŠ å±æ€§ã€‚å¦‚æœä½ æœ‰é™æ€å±æ€§ï¼Œä¼šç›´æ¥æ·»åŠ åˆ°æ„é€ å‡½æ•°ä¸ŠdefineProperties(Constructor, staticProps)ã€‚ æ‰§è¡Œconstuctorå†…éƒ¨çš„é€»è¾‘ã€‚ return this (æ„é€ å‡½æ•°é»˜è®¤åœ¨æœ€åæˆ‘ä»¬åšäº†)ã€‚ ES6å®ç°ç»§æ‰¿1.è°ƒç”¨_inheritså‡½æ•°ç»§æ‰¿çˆ¶ç±»çš„proptypeã€‚ 2.ç”¨ä¸€ä¸ªé—­åŒ…ä¿å­˜çˆ¶ç±»å¼•ç”¨ï¼Œåœ¨é—­åŒ…å†…éƒ¨åšå­ç±»æ„é€ é€»è¾‘ã€‚ 3.newæ£€æŸ¥ã€‚ 4.ç”¨å½“å‰thisè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ã€‚ 5.å°†è¡Œå­ç±»classå†…éƒ¨çš„å˜é‡å’Œå‡½æ•°èµ‹ç»™thisã€‚ 6.æ‰§è¡Œå­ç±»constuctorå†…éƒ¨çš„é€»è¾‘ã€‚ es6å®é™…ä¸Šæ˜¯ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªâ€œç»„åˆå¯„ç”Ÿç»§æ‰¿â€çš„ç®€å•å†™æ³•ã€‚ 1234567891011121314151617181920212223242526class Parent &#123; static height = 12 constructor(name,age)&#123; this.name = name; this.age = age; &#125; speakSomething()&#123; console.log(\"I can speek chinese\"); &#125;&#125;Parent.prototype.color = 'yellow'//å®šä¹‰å­ç±»ï¼Œç»§æ‰¿çˆ¶ç±»class Child extends Parent &#123; static width = 18 constructor(name,age)&#123; super(name,age); &#125; coding()&#123; console.log(\"I can code JS\"); &#125;&#125;var c = new Child(\"job\",30);c.coding() è½¬ç ä¹‹åçš„ä»£ç å˜æˆäº†è¿™æ · 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100\"use strict\";var _createClass = function () &#123; function defineProperties(target, props) &#123; for (var i = 0; i &lt; props.length; i++) &#123; var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); &#125; &#125; return function (Constructor, protoProps, staticProps) &#123; if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; &#125;;&#125;();//æ ¡éªŒthisæ˜¯å¦è¢«åˆå§‹åŒ–ï¼Œsuperæ˜¯å¦è°ƒç”¨ï¼Œå¹¶è¿”å›çˆ¶ç±»å·²ç»èµ‹å€¼å®Œçš„thisã€‚function _possibleConstructorReturn(self, call) &#123; if (!self) &#123; throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); &#125; return call &amp;&amp; (typeof call === \"object\" || typeof call === \"function\") ? call : self;&#125;function _inherits(subClass, superClass) &#123; if (typeof superClass !== \"function\" &amp;&amp; superClass !== null) &#123; throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); &#125; subClass.prototype = Object.create(superClass &amp;&amp; superClass.prototype, &#123; constructor: &#123; value: subClass, enumerable: false, writable: true, configurable: true &#125; &#125;); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;&#125;function _classCallCheck(instance, Constructor) &#123; if (!(instance instanceof Constructor)) &#123; throw new TypeError(\"Cannot call a class as a function\"); &#125;&#125;var Parent = function () &#123; function Parent(name, age) &#123; _classCallCheck(this, Parent); this.name = name; this.age = age; &#125; _createClass(Parent, [&#123; key: \"speakSomething\", value: function speakSomething() &#123; console.log(\"I can speek chinese\"); &#125; &#125;]); return Parent;&#125;();Parent.height = 12;Parent.prototype.color = 'yellow';//å®šä¹‰å­ç±»ï¼Œç»§æ‰¿çˆ¶ç±»var Child = function (_Parent) &#123; _inherits(Child, _Parent); function Child(name, age) &#123; _classCallCheck(this, Child); /**ç”¨å½“å‰thisè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ã€‚ * è¿™é‡Œçš„Child.proto || Object.getPrototypeOf(Child)å®é™…ä¸Šæ˜¯çˆ¶æ„é€ å‡½æ•°(_inheritsæœ€åçš„æ“ä½œ)ï¼Œ * ç„¶åé€šè¿‡callå°†å…¶è°ƒç”¨æ–¹æ”¹ä¸ºå½“å‰thisï¼Œå¹¶ä¼ é€’å‚æ•°ã€‚ï¼ˆè¿™é‡Œæ„Ÿè§‰å¯ä»¥ç›´æ¥ç”¨å‚æ•°ä¼ è¿‡æ¥çš„Parentï¼‰*/ return _possibleConstructorReturn(this, (Child.__proto__ || Object.getPrototypeOf(Child)).call(this, name, age)); &#125; _createClass(Child, [&#123; key: \"coding\", value: function coding() &#123; console.log(\"I can code JS\"); &#125; &#125;]); return Child;&#125;(Parent);Child.width = 18;var c = new Child(\"job\", 30);c.coding(); æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ„é€ ç±»çš„æ–¹æ³•éƒ½æ²¡å˜ï¼Œåªæ˜¯æ·»åŠ äº†_inheritsæ ¸å¿ƒæ–¹æ³•æ¥å®ç°ç»§æ‰¿ _inheritsæ ¸å¿ƒæ–¹æ³•(1) æ ¡éªŒçˆ¶æ„é€ å‡½æ•°ã€‚ (2) å…¸å‹çš„å¯„ç”Ÿç»§æ‰¿ï¼šç”¨çˆ¶ç±»æ„é€ å‡½æ•°çš„proptypeåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶å°†è¿™ä¸ªå¯¹è±¡æŒ‡å‘å­ç±»æ„é€ å‡½æ•°çš„proptypeã€‚ (3) å°†çˆ¶æ„é€ å‡½æ•°æŒ‡å‘å­æ„é€ å‡½æ•°çš„_proto_ï¼ˆè¿™æ­¥æ˜¯åšä»€ä¹ˆçš„ä¸å¤ªæ˜ç¡®ï¼Œæ„Ÿè§‰æ²¡ä»€ä¹ˆæ„ä¹‰ã€‚ï¼‰ é¦–å…ˆæ˜¯åˆ¤æ–­çˆ¶ç±»çš„ç±»å‹ï¼Œç„¶å 12345678subClass.prototype = Object.create(superClass &amp;&amp; superClass.prototype, &#123; constructor: &#123; value: subClass, enumerable: false, writable: true, configurable: true &#125; &#125;); è¿™æ®µä»£ç ç¿»è¯‘ä¸‹æ¥å°±æ˜¯ 1234function F()&#123;&#125;F.prototype = superClass.prototypesubClass.prototype = new F()subClass.prototype.constructor = subClass æ¥ä¸‹æ¥subClass.__proto__ = superClass_inheritsæ ¸å¿ƒæ€æƒ³å°±æ˜¯ä¸‹é¢ä¸¤å¥ 12subClass.prototype.__proto__ = superClass.prototypesubClass.__proto__ = superClass é¦–å…ˆ subClass.prototype.__proto__ = superClass.prototypeä¿è¯äº†c instanceof Parentæ˜¯true,Childçš„å®ä¾‹å¯ä»¥è®¿é—®åˆ°çˆ¶ç±»çš„å±æ€§ï¼ŒåŒ…æ‹¬å†…éƒ¨å±æ€§ï¼Œä»¥åŠåŸå‹å±æ€§ã€‚å…¶æ¬¡ï¼ŒsubClass.__proto__ = superClassï¼Œä¿è¯äº†Child.heightä¹Ÿèƒ½è®¿é—®åˆ°ï¼Œä¹Ÿå°±æ˜¯é™æ€æ–¹æ³•ã€‚ supersuperä»£è¡¨çˆ¶ç±»æ„é€ å‡½æ•°ã€‚ super.fun1() ç­‰åŒäº Parent.fun1() æˆ– Parent.prototype.fun1()ã€‚ super() ç­‰åŒäºParent.prototype.construtor() é»˜è®¤çš„æ„é€ å‡½æ•°ä¸­ä¼šä¸»åŠ¨è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå¹¶é»˜è®¤æŠŠå½“å‰constructorä¼ é€’çš„å‚æ•°ä¼ ç»™äº†çˆ¶ç±»ã€‚ æ‰€ä»¥å½“æˆ‘ä»¬å£°æ˜äº†constructoråå¿…é¡»ä¸»åŠ¨è°ƒç”¨super(),å¦åˆ™æ— æ³•è°ƒç”¨çˆ¶æ„é€ å‡½æ•°ï¼Œæ— æ³•å®Œæˆç»§æ‰¿ã€‚ å…¸å‹çš„ä¾‹å­å°±æ˜¯Reatcçš„Componentä¸­ï¼Œæˆ‘ä»¬å£°æ˜constructoråå¿…é¡»è°ƒç”¨super(props)ï¼Œå› ä¸ºçˆ¶ç±»è¦åœ¨æ„é€ å‡½æ•°ä¸­å¯¹propsåšä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"yarn&npm","slug":"yarn&npm","date":"2020-01-07T03:40:41.000Z","updated":"2020-02-08T15:43:53.535Z","comments":true,"path":"2020/01/07/yarn&npm/","link":"","permalink":"http://yoursite.com/2020/01/07/yarn&npm/","excerpt":"","text":"yarn&amp;npmFacebookã€Googleã€Exponent å’Œ Tilde è”åˆæ¨å‡ºäº†ä¸€ä¸ªæ–°çš„ JS åŒ…ç®¡ç†å·¥å…· â€” Yarnï¼Œæ˜¯ä¸ºäº†å¼¥è¡¥ npm çš„ä¸€äº›ç¼ºé™·è€Œå‡ºç°çš„ï¼š npm å®‰è£…åŒ…ï¼ˆpackagesï¼‰çš„é€Ÿåº¦ä¸å¤Ÿå¿«ï¼Œæ‹‰å–çš„ packages å¯èƒ½ç‰ˆæœ¬ä¸åŒ npm å…è®¸åœ¨å®‰è£… packages æ—¶æ‰§è¡Œä»£ç ï¼Œè¿™å°±åŸ‹ä¸‹äº†å®‰å…¨éšæ‚£ Yarn æ²¡æƒ³è¦å®Œå…¨æ›¿ä»£ npmï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ–°çš„ CLI å·¥å…·ï¼Œæ‹‰å–çš„ packages ä¾ç„¶æ¥è‡ª npm ä»“åº“ã€‚ä»“åº“æœ¬èº«ä¸ä¼šå˜ï¼Œæ‰€ä»¥è·å–æˆ–è€…å‘å¸ƒæ¨¡å—çš„æ—¶å€™å’ŒåŸæ¥ä¸€æ ·ã€‚ yarn vs npmï¼šç‰¹æ€§å·®å¼‚yarn.lock æ–‡ä»¶npm å’Œ Yarn éƒ½æ˜¯é€šè¿‡ package.json è®°å½•é¡¹ç›®éœ€è¦æ‹‰å–çš„ä¾èµ–æ¨¡å—ï¼Œä¸è¿‡åœ¨ä½¿ç”¨æ—¶ï¼Œå¾€å¾€ package.json ä¸­æ¨¡å—çš„ç‰ˆæœ¬å·ä¸å¤ªä¼šå†™å¾—éå¸¸ç¡®åˆ‡ï¼Œé€šå¸¸æ˜¯å®šä¸ªç‰ˆæœ¬èŒƒå›´ã€‚è¿™æ ·ä½ å°±èƒ½è‡ªè¡Œé€‰æ‹©ä½¿ç”¨æ¨¡å—çš„å¤§ç‰ˆæœ¬æˆ–è€…å°ç‰ˆæœ¬ï¼Œä¹Ÿå…è®¸ npm æ‹‰å–æ¨¡å—æœ€æ–°çš„ä¿®å¤äº† bug çš„ç‰ˆæœ¬ã€‚ npmç»™å®šä¸€ä¸ªç‰ˆæœ¬å·ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.è¡¥ä¸ç‰ˆæœ¬å·ï¼Œ ä»¥ä¸‹è¿™ä¸‰ç§æƒ…å†µéœ€è¦å¢åŠ ç›¸åº”çš„ç‰ˆæœ¬å·: ä¸»ç‰ˆæœ¬å·ï¼š å½“APIå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸ä¹‹å‰çš„ç‰ˆæœ¬ä¸å…¼å®¹çš„æ—¶å€™ æ¬¡ç‰ˆæœ¬å·ï¼š å½“å¢åŠ äº†åŠŸèƒ½ï¼Œä½†æ˜¯å‘åå…¼å®¹çš„æ—¶å€™ è¡¥ä¸ç‰ˆæœ¬å·ï¼š å½“åšäº†å‘åå…¼å®¹çš„ç¼ºé™·ä¿®å¤çš„æ—¶å€™ 123\"dependencies\": &#123; \"lodash\": \"^4.17.4\"&#125; åœ¨ç‰ˆæœ¬å·lodashä¹‹å‰æœ‰ä¸ª^å­—ç¬¦ã€‚è¿™ä¸ªå­—ç¬¦å‘Šè¯‰npmï¼Œå®‰è£…ä¸»ç‰ˆæœ¬ç­‰äº4çš„ä»»æ„ä¸€ä¸ªç‰ˆæœ¬å³å¯ã€‚æ‰€ä»¥å¦‚æœæˆ‘ç°åœ¨è¿è¡Œnpmè¿›è¡Œå®‰è£…ï¼Œnpmå°†å®‰è£…lodashçš„ä¸»ç‰ˆæœ¬ä¸º4çš„æœ€æ–°ç‰ˆï¼Œå¯èƒ½æ˜¯ lodash@4.25.5ï¼ˆ@æ˜¯npmçº¦å®šç”¨æ¥ç¡®å®šåŒ…åçš„æŒ‡å®šç‰ˆæœ¬çš„ï¼‰ã€‚ åœ¨ç†æƒ³çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬ä¸–ç•Œä¸­ï¼Œæ–°ç‰ˆæ˜¯ä¸ä¼šæœ‰é¢ è¦†æ—§ç‰ˆæœ¬çš„æ”¹å˜ï¼Œç„¶è€Œç°å®å¹¶éå¦‚æ­¤ã€‚è¿™å°±å¯¼è‡´äº†ä½¿ç”¨ npm æ‹‰å–ä¾èµ–æ—¶ï¼Œå³ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„ package.jsonï¼Œåœ¨ä¸åŒçš„è®¾å¤‡ä¸Šæ‹‰åˆ°çš„ packages ç‰ˆæœ¬ä¸ä¸€ï¼Œè¿™å°±å¯èƒ½ä¸ºé¡¹ç›®å¼•å…¥ bugã€‚ yarnä¸ºäº†é˜²æ­¢æ‹‰å–åˆ°ä¸åŒçš„ç‰ˆæœ¬ï¼ŒYarn æœ‰ä¸€ä¸ªé”å®šæ–‡ä»¶ (lock file) è®°å½•äº†è¢«ç¡®åˆ‡å®‰è£…ä¸Šçš„æ¨¡å—çš„ç‰ˆæœ¬å·ã€‚æ¯æ¬¡åªè¦æ–°å¢äº†ä¸€ä¸ªæ¨¡å—ï¼ŒYarn å°±ä¼šåˆ›å»ºï¼ˆæˆ–æ›´æ–°ï¼‰yarn.lock è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ä¹ˆåšå°±ä¿è¯äº†ï¼Œæ¯ä¸€æ¬¡æ‹‰å–åŒä¸€ä¸ªé¡¹ç›®ä¾èµ–æ—¶ï¼Œä½¿ç”¨çš„éƒ½æ˜¯ä¸€æ ·çš„æ¨¡å—ç‰ˆæœ¬ã€‚ npm å…¶å®ä¹Ÿæœ‰åŠæ³•å®ç°å¤„å¤„ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ packagesï¼Œä½†éœ€è¦å¼€å‘è€…æ‰§è¡Œ npm shrinkwrap å‘½ä»¤ã€‚è¿™ä¸ªå‘½ä»¤å°†ä¼šç”Ÿæˆä¸€ä¸ªé”å®šæ–‡ä»¶ï¼Œåœ¨æ‰§è¡Œ npm install çš„æ—¶å€™ï¼Œè¯¥é”å®šæ–‡ä»¶ä¼šå…ˆè¢«è¯»å–ï¼Œå’Œ Yarn è¯»å– yarn.lock æ–‡ä»¶ä¸€ä¸ªé“ç†ã€‚npm å’Œ Yarn ä¸¤è€…çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒYarn é»˜è®¤ä¼šç”Ÿæˆè¿™æ ·çš„é”å®šæ–‡ä»¶ï¼Œè€Œ npm è¦é€šè¿‡ shrinkwrap å‘½ä»¤ç”Ÿæˆ npm-shrinkwrap.json æ–‡ä»¶ï¼Œåªæœ‰å½“è¿™ä¸ªæ–‡ä»¶å­˜åœ¨çš„æ—¶å€™ï¼Œpackages ç‰ˆæœ¬ä¿¡æ¯æ‰ä¼šè¢«è®°å½•å’Œæ›´æ–°ã€‚ å¹¶è¡Œå®‰è£…æ— è®º npm è¿˜æ˜¯ Yarn åœ¨æ‰§è¡ŒåŒ…çš„å®‰è£…æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€ç³»åˆ—ä»»åŠ¡ã€‚ npmnpm æ˜¯æŒ‰ç…§é˜Ÿåˆ—æ‰§è¡Œæ¯ä¸ª packageï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»è¦ç­‰åˆ°å½“å‰ package æˆåŠŸå®‰è£…ä¹‹åï¼Œæ‰èƒ½ç»§ç»­åé¢çš„å®‰è£…ã€‚ è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œnpmå¿…é¡»é¦–å…ˆéå†æ‰€æœ‰çš„é¡¹ç›®ä¾èµ–å…³ç³»ï¼Œç„¶åå†å†³å®šå¦‚ä½•ç”Ÿæˆæ‰å¹³çš„node_modulesç›®å½•ç»“æ„ã€‚npmå¿…é¡»ä¸ºæ‰€æœ‰ä½¿ç”¨åˆ°çš„æ¨¡å—æ„å»ºä¸€ä¸ªå®Œæ•´çš„ä¾èµ–å…³ç³»æ ‘ï¼Œè¿™æ˜¯ä¸€ä¸ªè€—æ—¶çš„æ“ä½œï¼Œæ˜¯npmå®‰è£…é€Ÿåº¦æ…¢çš„ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› ã€‚ yarnYarn æ˜¯åŒæ­¥æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ï¼Œæé«˜äº†æ€§èƒ½ã€‚ ç”±äºyarnæ˜¯å´­æ–°çš„ç»è¿‡é‡æ–°è®¾è®¡çš„npmå®¢æˆ·ç«¯ï¼Œå®ƒèƒ½è®©å¼€å‘äººå‘˜å¹¶è¡ŒåŒ–å¤„ç†æ‰€æœ‰å¿…é¡»çš„æ“ä½œï¼Œå¹¶æ·»åŠ äº†ä¸€äº›å…¶ä»–æ”¹è¿›ï¼Œè¿™ä½¿å¾—è¿è¡Œé€Ÿåº¦å¾—åˆ°äº†æ˜¾è‘—çš„æå‡ï¼Œæ•´ä¸ªå®‰è£…æ—¶é—´ä¹Ÿå˜å¾—æ›´å°‘ã€‚ æ¯”è¾ƒé€šè¿‡æ‹‰å– express ä¾èµ–ï¼Œæˆ‘æ¯”è¾ƒäº† npm å’Œ Yarn çš„æ•ˆç‡ï¼Œåœ¨æ²¡æœ‰ç”¨ä»»ä½•é”å®šæ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯æ²¡æœ‰ç¼“å­˜ï¼‰çš„å‰æä¸‹ï¼Œä¸€å…±å®‰è£… 42 ä¸ªä¾èµ–ï¼š npm è€—æ—¶ 9 ç§’ Yarn è€—æ—¶ 1.37 ç§’ è¿™è€—æ—¶â€¦â€¦æˆ‘æ²¡æ³•ç›¸ä¿¡è‡ªå·±çš„çœ¼ç›äº†ï¼Œåå¤å°è¯•å‡ æ¬¡ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿå·®ä¸å¤šã€‚äºæ˜¯æˆ‘åˆè¯•ç€å®‰è£…äº†æœ‰195ä¸ªä¾èµ–çš„ gulpï¼Œè¿™ä¸€æ¬¡ï¼š npm è€—æ—¶ 11 ç§’ Yarn è€—æ—¶ 7.81 ç§’ çœ‹æ¥ npm å’Œ Yarn åœ¨å®‰è£…åŒ…çš„é€Ÿåº¦å·®å¼‚å’Œè¦å®‰è£…çš„åŒ…ä¸ªæ•°å¼ºç›¸å…³ï¼Œä¸è¿‡ä¸ç®¡æ€ä¹ˆæ ·ï¼ŒYarn éƒ½æ¯” npm è¦å¿«ã€‚ æ›´ç®€æ´çš„è¾“å‡ºnpmnpm çš„è¾“å‡ºä¿¡æ¯æ¯”è¾ƒå†—é•¿ã€‚åœ¨æ‰§è¡Œ npm install çš„æ—¶å€™ï¼Œå‘½ä»¤è¡Œé‡Œä¼šä¸æ–­åœ°æ‰“å°å‡ºæ‰€æœ‰è¢«å®‰è£…ä¸Šçš„ä¾èµ–ã€‚ yarnç›¸æ¯”ä¹‹ä¸‹ï¼ŒYarn ç®€æ´å¤ªå¤šï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œç»“åˆäº† emoji ï¼ˆWindows ä¸Š emoji ä¸å¯è§ï¼‰ç›´è§‚ä¸”ç›´æ¥åœ°æ‰“å°å‡ºå¿…è¦çš„ä¿¡æ¯ï¼Œä¹Ÿæä¾›äº†ä¸€äº›å‘½ä»¤ä¾›å¼€å‘è€…æŸ¥è¯¢é¢å¤–çš„å®‰è£…ä¿¡æ¯ã€‚ å¤šæ³¨å†Œæ¥æºå¤„ç†æ‰€æœ‰çš„ä¾èµ–åŒ…ï¼Œä¸ç®¡ä»–è¢«ä¸åŒçš„åº“é—´æ¥å…³è”å¼•ç”¨å¤šå°‘æ¬¡ï¼Œå®‰è£…è¿™ä¸ªåŒ…æ—¶ï¼Œåªä¼šä»ä¸€ä¸ªæ³¨å†Œæ¥æºå»è£…ï¼Œè¦ä¹ˆæ˜¯ npm è¦ä¹ˆæ˜¯ bower, é˜²æ­¢å‡ºç°æ··ä¹±ä¸ä¸€è‡´ã€‚ æ›´å¥½çš„è¯­ä¹‰åŒ– yarnæ”¹å˜äº†ä¸€äº›npmå‘½ä»¤çš„åç§°ï¼Œæ¯”å¦‚ yarn add/removeï¼Œæ„Ÿè§‰ä¸Šæ¯” npm åŸæœ¬çš„ install/uninstall è¦æ›´æ¸…æ™°ã€‚ CLI åŒºåˆ«é™¤äº†ç‰¹æ€§ä¸Šçš„åŒºåˆ«ï¼Œç›¸æ¯”äº npm çš„å‘½ä»¤ï¼ŒYarn å‘½ä»¤æœ‰å¢æœ‰å‡è¿˜æœ‰ä¸€äº›æ›´æ”¹ã€‚ yarn globalnpm çš„å…¨å±€æ“ä½œå‘½ä»¤è¦åŠ ä¸Š -g æˆ–è€… â€“global å‚æ•°ï¼ŒYarn çš„å…¨å±€å‘½ä»¤åˆ™éœ€è¦åŠ ä¸Š globalã€‚å’Œ npm ç±»ä¼¼ï¼Œé¡¹ç›®ç‰¹å®šçš„ä¾èµ–ï¼Œå°±ä¸éœ€è¦å…¨å±€å®‰è£…äº†ã€‚ å½“æ‰§è¡Œ yarn addã€yarn binã€yarn ls å’Œ yarn remove æ—¶æ·»åŠ  global å‰ç¼€æ‰æ˜¯æœ‰å…¨å±€ä½œç”¨ã€‚é™¤äº† yarn add ä¹‹å¤–ï¼Œå…¶ä»–ä¸‰ä¸ªå‘½ä»¤å’Œ npm çš„ä¸€æ ·ã€‚ yarn global æ–‡æ¡£ yarn installnpm install å‘½ä»¤å®‰è£…çš„æ˜¯ package.json ä¸­çš„ä¾èµ–ï¼Œå¦‚æœå¼€å‘è€…åœ¨ package.json ä¸­æ·»åŠ äº†æ–°çš„ä¾èµ–ï¼Œnpm install ä¹Ÿä¸€æ ·å®‰è£…ã€‚ç„¶è€Œï¼Œyarn install ä¼šä¼˜å…ˆå®‰è£… yarn.lock ä¸­è®°å½•çš„ä¾èµ–ï¼Œæ²¡æœ‰è¿™æ ·çš„é”å®šæ–‡ä»¶æ—¶ï¼Œæ‰ä¼šå»å®‰è£… package.json ä¸­çš„ä¾èµ–ã€‚ yarn install æ–‡æ¡£ npm install æ–‡æ¡£ yarn add [â€“dev]å’Œ npm install ç±»ä¼¼ï¼Œyarn add å‘½ä»¤å…è®¸ä½ æ·»åŠ å¹¶å®‰è£…ä¾èµ–ã€‚é€šè¿‡è¿™ä¸ªå‘½ä»¤æ·»åŠ çš„ä¾èµ–éƒ½ä¼šè¢«è‡ªåŠ¨åŠ åˆ° package.json ä¸­ï¼Œå’Œæˆ‘ä»¬åœ¨ npm å‘½ä»¤ä¸­ä½¿ç”¨ â€“save å‚æ•°ä¸€æ ·ã€‚Yarn çš„-dev åˆ™ç­‰åŒäº npm çš„ â€“save-devã€‚ yarn add æ–‡æ¡£ npm install æ–‡æ¡£ yarn licenses [ls|generate-disclaimer]åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œnpm æ²¡æœ‰ç­‰åŒçš„å‘½ä»¤ã€‚yarn licenses ls ç”¨äºç½—åˆ—å‡ºæ‰€æœ‰è¢«å®‰è£…çš„ package æ‰€æŒæœ‰çš„æ‰§ç…§æƒ…å†µã€‚yarn licenses generate-disclaimer å°†ç”Ÿæˆä¸€ä¸ªå¯¹æ‰€æœ‰ä¾èµ–çš„å…è´£å£°æ˜ã€‚æœ‰äº›æ‰§ç…§è¦æ±‚å¼€å‘è€…ä¸€å®šè¦åœ¨é¡¹ç›®ä¸­åŒ…å«è¿™äº›å®ƒä»¬ï¼Œè¿™ä¸ªå‘½ä»¤å°±æ˜¯ä¸ºè¿™æ ·çš„åœºæ™¯å­˜åœ¨çš„ã€‚ yarn licenses æ–‡æ¡£ yarn whyè¿™æ¡å‘½ä»¤èƒ½å¸®åŠ©å¼€å‘è€…ç†æ¸…å®‰è£…çš„ package ä¹‹é—´çš„å…³ç³»ã€‚æ‹‰å–äº†å„ç§ä¾èµ–ä»¥åï¼Œæœ‰äº› package æ˜¯ä½ æ˜¾å¼å®‰è£…çš„ï¼Œæœ‰äº›åŒ…åˆ™æ˜¯é€’å½’ä¾èµ–çš„ã€‚ yarn why æ–‡æ¡£ yarn upgrade [package]è¿™æ¡å‘½ä»¤å°†æ ¹æ® package.json å°† package å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶æ›´æ–° yarn.lockï¼Œå’Œ npm update ç›¸ä¼¼ã€‚ æœ‰æ„æ€çš„æ˜¯ï¼Œå¦‚æœæŒ‡å®šäº† [package] å‚æ•°ï¼ŒYarn ä¼šå°† package å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶æ›´æ–° package.json ä¸­è¯¥ package çš„ç‰ˆæœ¬å·å­—æ®µã€‚ yarn upgrade æ–‡æ¡£ yarn generate-lock-entryè¿™æ¡å‘½ä»¤å°†ä¼šç”Ÿæˆä¸€ä»½åŸºäº package.json çš„ yarn.lock æ–‡ä»¶ï¼Œä½œç”¨å’Œ npm shrinkwrap ç±»ä¼¼ã€‚ä¸è¿‡ç”±äºæ‰§è¡Œ yarn add andyarn upgrade æ—¶éƒ½ä¼šæ›´æ–° yarn.lock æ–‡ä»¶ï¼Œæ‰€ä»¥è¦æ…é‡æ‰§è¡Œ yarn generate-lock-entry å‘½ä»¤ yarn generate-lock-entry æ–‡æ¡£ npm shrinkwrap æ–‡æ¡£ yarnå’Œnpmå‘½ä»¤å¯¹æ¯”12345npm install === yarn npm install taco --save === yarn add taconpm uninstall taco --save === yarn remove taconpm install taco --save-dev === yarn add taco --devnpm update --save === yarn upgrade npmçš„æœªæ¥ï¼šnpm5.0æœ‰äº†yarnçš„å‹åŠ›ä¹‹åï¼Œnpmåšäº†ä¸€äº›ç±»ä¼¼çš„æ”¹è¿›ã€‚ é»˜è®¤æ–°å¢äº†ç±»ä¼¼yarn.lockçš„ package-lock.jsonï¼› git ä¾èµ–æ”¯æŒä¼˜åŒ–ï¼šè¿™ä¸ªç‰¹æ€§åœ¨éœ€è¦å®‰è£…å¤§é‡å†…éƒ¨é¡¹ç›®ï¼ˆä¾‹å¦‚åœ¨æ²¡æœ‰è‡ªå»ºæºçš„å†…ç½‘å¼€å‘ï¼‰ï¼Œæˆ–éœ€è¦ä½¿ç”¨æŸäº›ä¾èµ–çš„æœªå‘å¸ƒç‰ˆæœ¬æ—¶å¾ˆæœ‰ç”¨ã€‚åœ¨è¿™ä¹‹å‰å¯èƒ½éœ€è¦ä½¿ç”¨æŒ‡å®š commitid çš„æ–¹å¼æ¥æ§åˆ¶ç‰ˆæœ¬ã€‚ æ–‡ä»¶ä¾èµ–ä¼˜åŒ–ï¼šåœ¨ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¦‚æœå°†æœ¬åœ°ç›®å½•ä½œä¸ºä¾èµ–æ¥å®‰è£…ï¼Œå°†ä¼šæŠŠæ–‡ä»¶ç›®å½•ä½œä¸ºå‰¯æœ¬æ‹·è´åˆ° nodemodules ä¸­ã€‚è€Œåœ¨ npm5 ä¸­ï¼Œå°†æ”¹ä¸ºä½¿ç”¨åˆ›å»º symlinks çš„æ–¹å¼æ¥å®ç°ï¼ˆä½¿ç”¨æœ¬åœ° tarball åŒ…é™¤å¤–ï¼‰ï¼Œè€Œä¸å†æ‰§è¡Œæ–‡ä»¶æ‹·è´ã€‚è¿™å°†ä¼šæå‡å®‰è£…é€Ÿåº¦ã€‚ç›®å‰yarnè¿˜ä¸æ”¯æŒã€‚","categories":[{"name":"git","slug":"git","permalink":"http://yoursite.com/categories/git/"}],"tags":[{"name":"yarn","slug":"yarn","permalink":"http://yoursite.com/tags/yarn/"},{"name":"npm","slug":"npm","permalink":"http://yoursite.com/tags/npm/"}]},{"title":"å…³äº01çš„2019","slug":"å…³äº01çš„2019","date":"2019-12-31T15:59:59.000Z","updated":"2019-12-29T14:31:07.329Z","comments":true,"path":"2019/12/31/å…³äº01çš„2019/","link":"","permalink":"http://yoursite.com/2019/12/31/å…³äº01çš„2019/","excerpt":"","text":"å…³äº01çš„2019è¿™æ˜¯ 01 ç¬¬ä¸€ç¯‡éæŠ€æœ¯çš„åšå®¢ï¼Œæƒ³è®°å½•ä¸€ä¸‹æˆ‘çš„ 2019 å¹´ï¼Œå› ä¸ºè¿™ä¸€å¹´å¯¹æˆ‘æ¥è¯´ï¼ŒçœŸçš„æ„ä¹‰éå‡¡ã€ä¸ä¼—ä¸åŒã€‚è¿™ç¯‡åšå®¢ï¼Œå¯èƒ½çµ®çµ®å¨å¨ï¼Œå¯èƒ½æ€è·¯ä¸æ¸…ã€‚æ²¡æœ‰æœŸå¾…çœ‹åˆ°çš„ä½ ä¼šç”Ÿå‡ºä»€ä¹ˆæ ·çš„æƒ…ç»ªï¼Œåªæ˜¯å¯¹è‡ªå·±çš„ä¸€ä¸ªå°å°äº¤ä»£ï¼Œå¸Œæœ›è‡ªå·±å¯ä»¥è®°å¾—è¿™ä¸€å¹´æ¥çš„æ¬¢ç¬‘ä¸è‰°éš¾ã€‚ ä¸ºä»€ä¹ˆè¯´ 2019 å¹´ï¼Œå¯¹æˆ‘æ¥è¯´æ„ä¹‰éå‡¡ä¸ä¼—ä¸åŒå‘¢ï¼Ÿé¦–å…ˆï¼Œè¿™ä¸€å¹´ï¼Œæ˜¯æˆ‘ 24 å²çš„æœ¬å‘½å¹´ã€‚ä¸åŒäºä¸Šä¸€æ¬¡ 12 å²çš„é‚£ä¸€å¹´ï¼Œ24 å²ï¼Œæˆ‘æ‹¥æœ‰äº†æ›´æ¸…æ™°çš„å¯¹ä¸–ç•Œå’Œå‘¨é­çš„è®¤è¯†ï¼Œæœ‰äº†å±äºè‡ªå·±ç‹¬ç«‹çš„çœ‹æ³•ä¸è§è§£ï¼Œä¹Ÿå˜å¾—åœ¨ä¸€äº›æ—¶å€™å¼€å§‹å°å»ºè¿·ä¿¡ï¼Œå•Šå“ˆå“ˆå“ˆå“ˆã€‚æ¯”å¦‚ï¼Œè€è€å®å®å¸¦èµ·äº†ä¿å‘½çº¢ç»³ï¼Œè®¤è®¤çœŸçœŸä¹°äº†ç«çº¢çš„å†…è¡£ï¼Œæ¢ä¸Šäº†ã€ŒçŒªäº‹é¡ºåˆ©ã€çš„çº¢è‰²æ‰‹æœºå£³ï¼Œç–¯ç‹‚çš„ä¸ºå„ç§äº‹å„¿è½¬å‘äº†å„ç§åŠŸèƒ½æ€§é”¦é²¤ã€‚å½“ç„¶ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œ2019 å¹´é‡Œï¼ŒçœŸçš„å‘ç”Ÿäº†å¾ˆå¤šå¤§äº‹å„¿ã€‚æœ‰çš„æ˜¯æˆ‘ä»æœªæƒ³åˆ°ä¹Ÿä¸æ•¢æƒ³è±¡çš„äº‹å„¿ï¼Œæœ‰çš„æ˜¯å³å°†æ”¹å˜æˆ‘äººç”Ÿè½¨è¿¹çš„äº‹å„¿ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸€ä»¶ä¸€ä»¶ç¼“ç¼“é“æ¥ã€‚ æœ€é‡è¦çš„ï¼Œæ”¾åœ¨ç¬¬ä¸€ä¸ªæ¥è¯´ã€‚è¿™ä»¶äº‹å„¿ï¼Œå«åšã€Œçˆ¸çˆ¸ã€ã€‚æˆ‘ä¸çŸ¥é“è¯¥æ€ä¹ˆå¼€å§‹å†™è¿™ä»¶äº‹å„¿ï¼Œé‚£å°±ç›´æ¥ä¸€ç‚¹ã€‚2019 å¹´ 3 æœˆ 3 æ—¥ï¼Œæˆ‘çˆ¸çˆ¸å»ä¸–äº†ã€‚é‚£æ˜¯ä¸€ä¸ªå¹³å¸¸çš„æ˜ŸæœŸå¤©ï¼Œå‰ä¸€å¤©ï¼Œæˆ‘åˆšæŸ“äº†è“è‰²çš„å¤´å‘ï¼Œæ—©ä¸Šæˆ‘åœ¨å•æ‰€é‡Œæ‹äº†ç¬¬ä¸€å¼ è“å¤´å‘çš„è‡ªæ‹ï¼Œæ´—è„¸åˆ·ç‰™ï¼ŒåŒ–å¦†ï¼Œä¸­åˆå’Œå¥½æœ‹å‹çº¦äº†ä¸€é¡¿æµ·åº•æï¼Œç‚¹äº†å¾ˆå¤šèœï¼Œç­‰ç€ç«é”…å¼€æ¶®ï¼Œä¸€ä¸ªé™Œç”Ÿçš„å·ç æ‰“è¿›äº†æˆ‘çš„æ‰‹æœºï¼Œæ˜¯ä¸€ä¸ªå¸¦ç€å“­è…”çš„å£°éŸ³ï¼Œå¾ˆåƒæˆ‘å°å§‘ã€‚æµ·åº•æé‡Œå¾ˆåµï¼Œå¬ä¸æ¸…ç”µè¯é‚£å¤´éƒ½è¯´äº†äº›ä»€ä¹ˆï¼Œå°±å¬æ¸…ä¸€å¥ï¼Œâ€œä½ çˆ¸æ­»äº†ï¼Œä½ èµ¶å¿«å›æ¥â€ã€‚å—¯ï¼Œæˆ‘æ˜¯æ‡µçš„ï¼Œæœ¬èƒ½çš„è§‰å¾—ï¼Œåº”è¯¥æ˜¯ä¸ªè¯ˆéª—ç”µè¯å§ã€‚èµ°å‡ºæµ·åº•æï¼Œç»™å¥¶å¥¶å®¶çš„åº§æœºæ‰“äº†ä¸ªç”µè¯ï¼Œæ¥ç”µè¯çš„äººä¸æ˜¯å¥¶å¥¶æ˜¯æˆ‘å¤§å§‘çˆ¶ï¼Œæˆ‘å¿ƒé‡Œæƒ³ï¼ŒçœŸçš„å‡ºäº‹å„¿äº†ã€‚æŒ‚äº†ç”µè¯ä¹°äº†ä¸€å¼ æ™šä¸Šçš„æœºç¥¨å›å®¶ã€‚é‚£æ—¶å€™çš„æˆ‘ï¼ŒçœŸçš„ååº”ä¸è¿‡æ¥å‘ç”Ÿäº†ä»€ä¹ˆï¼Œç”šè‡³è¿˜å®‰é™çš„åƒå®Œäº†é‚£é¡¿æµ·åº•æã€‚ æˆ‘å…¶å®ä¸èƒ½æ¥å—è¿™ä»¶äº‹å„¿ï¼Œä¸€ç›´åˆ°ç°åœ¨ã€‚ å›åˆ°å®¶ï¼Œå¥¶å¥¶æŠ±ç€æˆ‘å“­äº†ï¼Œæˆ‘æ²¡æœ‰å“­ã€‚å°å§‘å“­çš„æ³£ä¸æˆå£°ï¼Œæˆ‘æ²¡æœ‰å“­ã€‚çƒ§çº¸çš„æ—¶å€™ï¼Œæˆ‘å¦ˆè¯´ï¼Œä½ è¦å–Šä½ çˆ¸æ¥æ‹¾é’±ï¼Œæˆ‘å–Šä¸å‡ºæ¥ï¼Œæˆ‘ä¸€å¥è¯ä¹Ÿè¯´ä¸å‡ºæ¥ï¼Œæˆ‘å°±æ²‰é»˜çš„è·ªåœ¨é‚£å„¿ã€‚èº«è¾¹çŸ¥é“è¿™ä»¶äº‹å„¿çš„æœ‹å‹é—®æˆ‘ï¼Œæˆ‘éƒ½æ˜¯ç¬‘ç€è¯´ä¸€å¥æ²¡äº‹å„¿å•Šï¼Œä½ çœ‹æˆ‘ä¸æ˜¯å¥½å¥½çš„å—ã€‚åœ¨ç«è‘¬åœºï¼Œæˆ‘çœ‹è§æˆ‘çˆ¸ç©¿æˆ´æ•´é½çš„èººåœ¨é‚£å„¿ï¼Œè¥¿è£…çš®é‹ï¼Œæ˜¯æˆ‘ä¸ç†Ÿæ‚‰çš„æ ·å­ï¼Œå¾ˆå®‰è¯¦ï¼Œå´ä¸€ç‚¹ä¹Ÿä¸åƒç¡ç€äº†ï¼Œæˆ‘çˆ¸ç¡è§‰æ‰ä¸ä¼šè¿™ä¹ˆè§„çŸ©ï¼Œæ˜æ˜å‘¼å™œéœ‡å¤©å“ã€‚æˆ‘è¯´äº†æ‚¼è¯ï¼Œè¯´çš„ä¹±ä¸ƒå…«ç³Ÿï¼Œæ¯•ç«Ÿè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è¯´æ‚¼è¯ï¼Œéƒ½ä¸çŸ¥é“è¦è¯´äº›ä»€ä¹ˆå†…å®¹ï¼Œç”šè‡³è¿˜åœ¨æ§è¯‰ä»–ä¸€ç‚¹éƒ½ä¸æ˜¯ä¸€ä¸ªè´Ÿè´£ä»»çš„å¥½çˆ¸çˆ¸ã€‚æˆ‘æŠ±ç€æˆ‘çˆ¸çš„éª¨ç°ç›’ï¼ŒçœŸçš„å¾ˆæ²‰ï¼Œå¾—ç”¨æ‰‹æŒ‡æ­»æ­»æŠ ç€æ‰èƒ½ä¿è¯åœ¨èµ°åˆ°å¢“åœ°å‰çš„è¿™æ®µè·¯ä¸Šï¼Œæˆ‘ä¸ä¼šæŠŠä»–æ‘”ä¸‹å»ã€‚ æˆ‘ä»¥ä¸ºæˆ‘æ²¡ä»€ä¹ˆäº‹å„¿ï¼Œæˆ‘ä»¥ä¸ºæˆ‘æ¶ˆåŒ–çš„äº†ï¼Œæ¯•ç«Ÿæˆ‘ä¹‹å‰ 23 å¹´çš„äººç”Ÿï¼Œä¹Ÿä¸æ€ä¹ˆå¹³å¦ã€‚å¤„ç†å®Œä¸§äº‹å„¿å›åˆ°å­¦æ ¡ï¼Œåœ¨æ“åœºä¸Šï¼Œæ˜¯æˆ‘ç¬¬ä¸€æ¬¡å´©æºƒçš„æ”¾å£°å¤§å“­ã€‚ä¸€è¾¹å“­ä¸€è¾¹ç¬‘ï¼Œç¬‘å®Œå“­çš„æ›´å¤§å£°ï¼Œæƒ³å°æ—¶å€™ï¼Œä¹Ÿæƒ³ï¼Œæˆ‘çœŸçš„æ²¡æœ‰çˆ¸çˆ¸äº†ã€‚çœŸçš„å°±åƒè¿‡ç”µå½±ä¸€æ ·ï¼Œè®°å¿†åœ¨è¿™ä»¶äº‹å„¿ä¹‹åå˜å¾—å¼‚å¸¸é²œæ´»ï¼Œå¾ˆå¤šä»¥å‰æƒ³ä¸èµ·æ¥çš„å°ç»†èŠ‚éƒ½å˜å¾—ååˆ†æ¸…æ™°ã€‚æˆ‘è®°å¾—æˆ‘æ„Ÿå†’å‘çƒ§å’³å—½åˆ°è¯ä¹Ÿè¯´ä¸å‡ºæ¥ï¼Œå´ä»»æ€§çš„è¦çˆ¸çˆ¸å»ç»™æˆ‘ä¹°é»„æ¡ƒç½å¤´ã€‚æˆ‘è®°å¾—å°æ—¶å€™æˆ‘çˆ¸å¼€å‡ºç§Ÿæˆ‘ååœ¨å‰¯é©¾é©¶ç©è€ç¡è§‰ã€‚æˆ‘è®°å¾—æ¯æ¬¡çˆ¸çˆ¸è®©æˆ‘å¸®ä»–è·‘è…¿ä¸‹æ¥¼ä¹°åŒ…é†‹çš„æ—¶å€™éƒ½ä¼šå¤šç»™æˆ‘äº”æ¯›é’±çš„è·‘è…¿è´¹ã€‚æˆ‘ä¹Ÿè®°å¾—å»å¹´å’Œçˆ¸çˆ¸å¥¶å¥¶ä¸€èµ·ååœ¨åºŠä¸Šç©æ¿€èŒçš„æ—¶å€™ä»–çœ‹ç€é‚£äº›å¯çˆ±çš„è¡¨æƒ…åŠ åœ¨ä»–è„¸ä¸Šæ—¶ç¬‘çš„æœ‰å¤šæ†¨åšã€‚å¤ªå¤šå¤ªå¤šï¼Œéƒ½åªæœ‰å›å¿†äº†ã€‚å†ä¹Ÿæ²¡æœ‰äººåœ¨ç«è½¦ç«™å¤–æœŸç›¼æ”¾å‡å›å®¶çš„æˆ‘ï¼Œå¸¦ç€åˆšä¸‹ç«è½¦çš„æˆ‘å»åƒä¸€ç¢—ç‰›è‚‰æ‹‰é¢ã€‚å†ä¹Ÿæ²¡æœ‰äººå«æˆ‘è‡­å°å­ï¼Œæ‰“æ¥ç”µè¯ååˆ†è…¼è…†çš„è¯´å¥â€œè€çˆ¸æƒ³ä½ äº†â€ã€‚ä¹Ÿä¸ä¼šæœ‰äººæ˜æ˜å¨è‰ºå¾ˆå¥½ï¼Œå´è¦åœ¨æ¯æ¬¡åšé¥­çš„æ—¶å€™ä¸åœçš„å‘¼å–Šæˆ‘å»å¨æˆ¿ç»™ä»–è¯•èœï¼Œæƒ³è¦å¬æˆ‘çš„é‚£å¥â€œå†åŠ ç‚¹é†‹â€æˆ–è€…â€œåˆšåˆšå¥½ã€å®Œç¾ï¼â€ã€‚æˆ‘ä¸€ç›´æƒ³è¦å¸¦ä»–å»çœ‹åœºç”µå½±ï¼Œimaxæˆ–è€…3Dçš„ï¼Œæƒ³è¦æŒ£é’±ç»™ä»–ä¹°è¾†å¥½è½¦ï¼Œä¹Ÿæƒ³è¿‡ä»–è€äº†æˆ‘æ¨ç€ä»–æ™’å¤ªé˜³çš„åœºæ™¯ã€‚ä»å°åˆ°å¤§ï¼Œæˆ‘çˆ¸ï¼Œéƒ½æ˜¯é‚£ä¸ªæœ€æƒ¯ç€æˆ‘çš„äººã€‚ä»–è¿˜è¯´ï¼Œä»–åœ¨ç½‘ä¸Šå­¦äº†å¥½å¤šèœï¼Œè¦åšç»™æˆ‘åƒã€‚å¯æ˜¯ï¼Œæˆ‘è¿˜æ²¡æ”¾å‡å›å®¶ï¼Œçˆ¸çˆ¸ï¼Œä½ å»å“ªå„¿äº†å‘¢ï¼Ÿ æˆ‘ä»¥ä¸ºï¼Œå“­è¿‡è¿™ä¸€åœºä¹‹åï¼Œæˆ‘è¿˜æ˜¯é‚£ä¸ªç§¯æåšå¼ºçš„ 01ï¼Œç”Ÿæ´»è¿˜æ˜¯å¦‚å¸¸ã€‚ä½†æ˜¯è¿™ä¸€æ¬¡ï¼Œå¥½åƒçœŸçš„æœ‰äº›éš¾ã€‚ æœ¬å‘½å¹´ç¬¬äºŒä»¶äº‹å„¿ï¼Œå½»åº•å’Œè¿‡å»çš„æ„Ÿæƒ…è¯´å†è§ã€‚å…¶å®è¿™æ˜¯ä¸ªå¼€å¿ƒçš„äº‹å„¿ï¼Œåªä¸è¿‡ç»å†çš„è¿‡ç¨‹æƒ¨ç—›äº†äº›ã€‚æ„Ÿæƒ…ä¸Šçš„äº‹å„¿å˜›ï¼Œæ€»æ˜¯å‰ªä¸æ–­ç†è¿˜ä¹±ï¼Œæ›´ä½•å†µæˆ‘è¿˜æ˜¯ä¸€ä¸ªå¿µæ—§åˆçƒ‚å¥½å¿ƒçš„äººã€‚æˆ‘æœ‰ä¸ªå¼‚å›½çš„å‰ç”·å‹ï¼Œæˆ‘ä»¬ä¹‹é—´æœ‰å¾ˆå¤šæ•…äº‹ï¼Œå¾ˆå¤šæŠ˜ç£¨æˆ‘çš„æ•…äº‹ã€‚ä¹‹æ‰€ä»¥æ˜¯æŠ˜ç£¨æˆ‘çš„æ•…äº‹ï¼Œæ˜¾ç„¶æ˜¯ä¸‰ä¸ªäººçš„æ•…äº‹ï¼Œä¹‹æ‰€ä»¥æœ‰å¾ˆå¤šï¼Œæ˜¾ç„¶æ˜¯æˆ‘çš„ä¸ç”˜å¿ƒå’Œæ³›æ»¥çš„åŒæƒ…å¿ƒåœ¨ä½œç¥Ÿã€‚å¾ˆè€å¥—çš„æƒ…èŠ‚ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæ”¾ä¸ä¸‹çš„åªæ˜¯è‡ªå·±åœ¨è¿™ä»½æ„Ÿæƒ…é‡Œçš„ä»˜å‡ºåŠ ä¸Šä¸€å¼ ä¼šéª—äººçš„æ¸£ç”·çš„å˜´ã€‚å³ä¾¿åˆ†æ‰‹äº†ã€‚ æˆ‘ä¸å¾—ä¸æ‰¿è®¤ï¼Œæˆ‘è¿™ä¸ªå‰ç”·å‹å¯¹æˆ‘çš„å½±å“æœ‰å¤šå¤§ã€‚ä»–è®©æˆ‘å˜å¾—å°å¿ƒç¿¼ç¿¼ï¼Œå˜å¾—æ›´åŠ æ²¡æœ‰å®‰å…¨æ„Ÿã€‚å¯¹äºä¸€äº›æƒ…ä¾£é—´çš„å°äº‹å„¿ï¼Œå´æçš„å°å¿ƒè°¨æ…ï¼Œæ€»æ˜¯æœç€æœ€ä¸åˆ©çš„æ–¹å‘å»æƒ³ã€‚æ¢æƒ…ä¾£å¤´åƒæˆ–è€…åœ¨ç¤¾äº¤å¹³å°ä¸Šç§€æ©çˆ±ï¼Œä¸å†æ˜¯ä¸ºæ‰€æ¬²ä¸ºå‡­è‡ªå·±å¼€å¿ƒï¼Œè€Œæ˜¯è°¨å°æ…å¾®çš„è¯•æ¢å¯¹æ–¹çš„å¿ƒæ€ï¼Œå› ä¸ºä¸€æ¡å¾®åšæ¢æ¥çš„å¯èƒ½æ˜¯äº‰åµåˆ°å¿ƒå¯’ã€‚å¯¹äºèŠ‚æ—¥æˆ–è€…çºªå¿µæ—¥çš„ä»ªå¼æ„Ÿè€¿è€¿äºæ€€ï¼Œæˆ‘å–œæ¬¢ï¼Œä»–å´ä¸åœ¨æ„ï¼ŒOKï¼Œé‚£æˆ‘ä¸€å®šè¦è¿‡çš„éš†é‡ï¼Œåªæ˜¯ä¸æ˜¯å’Œä»–ã€‚å¯¹äºå‘èº«è¾¹çš„äººå¤§æ–¹å…¬å¼€æˆ‘åœ¨è°ˆæ‹çˆ±ï¼Œä¸å¯èƒ½ï¼Œå› ä¸ºä»–åªä¼šæŠŠæˆ‘è—èµ·æ¥è°ˆåœ°ä¸‹æƒ…ï¼Œé‚£ä¹ˆæˆ‘åªèƒ½è¿½æ±‚å˜æ€çš„å…¬å¹³ã€‚åˆ†æ‰‹åçš„çƒ‚å¥½å¿ƒï¼Œåˆè®©æˆ‘ç»§ç»­æ²¦ä¸ºä¸€ä¸ªè¢«æ¬ºéª—çš„â€œæœ‹å‹â€ï¼Œæ‹–æ‹–æ‹‰æ‹‰æ²¡ä¸ªå®Œã€‚å¯¹äºæ„Ÿæƒ…ï¼Œæˆ‘æœŸå¾…çš„å¾ˆå°‘ï¼Œç”šè‡³åªå¸Œæœ›ï¼Œå¯¹æ–¹èƒ½æ˜¯ä¸ªå¥½äººï¼Œæˆ‘ä»¬èƒ½åšåˆ°å–„å¾…å½¼æ­¤ï¼Œå°±å¥½äº†ã€‚æˆ‘åŸ‹è—è‡ªå·±çš„æƒ³æ³•ï¼Œç”¨â€œå–„è§£äººæ„â€æ¥å¯¹å¾…æ¯ä¸€ä¸ªäººã€‚æˆ‘çŸ¥é“æˆ‘å˜å¾—è¶Šæ¥è¶Šæ‰­æ›²ï¼Œè¶Šæ¥è¶Šä¸æ˜¯è‡ªå·±å–œæ¬¢çš„ 01ã€‚ åœ¨æ„Ÿæƒ…é‡Œæ—¥æ¸æ‰­æ›²æŠŠè‡ªå·±å¾€è§’è½é‡Œé€¼çš„æˆ‘ï¼Œåœ¨å®¶é‡Œå‘ç”Ÿå¤§å˜æ•…ä¸‹ç»ˆäºæ„è¯†åˆ°æˆ‘å½»åº•å¤±å»äº†çˆ±æˆ‘çš„çˆ¸çˆ¸çš„æˆ‘ï¼Œåœ¨æ˜¥æ‹›å¦‚ç«å¦‚è¼è¿›è¡Œå´æ‰æ„è¯†åˆ°æˆ‘è¯¥å¼€å§‹å­¦ä¹ äº†è¿˜ä»€ä¹ˆéƒ½ä¸ä¼šçš„æˆ‘ï¼Œå½»åº•å´©æºƒäº†ã€‚ 2019 å¹´ 3 æœˆ 3 æ—¥åˆ° 2019 å¹´ 8 æœˆ 3 æ—¥ã€‚æˆ‘å…¶å®è®°ä¸æ¸…æˆ‘è¿™äº”ä¸ªæœˆå…·ä½“éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘è¿˜æ˜¯æ­£å¸¸çš„å®ä¹ ä¸Šç­ã€ä¸ºç§‹æ‹›å­¦ä¹ ã€è·Ÿæœ‹å‹æ‰¯æ·¡é€—é€¼ã€‚ä½†æ˜¯æˆ‘çŸ¥é“ï¼Œæˆ‘ä¸å¤ªæ­£å¸¸ã€‚æˆ‘è®°å¾—æˆ‘èµ°ç€èµ°ç€è·¯å°±å´©æºƒåˆ°è¹²åœ¨é©¬è·¯è¾¹å¤§å“­ã€‚æˆ‘è®°å¾—æˆ‘åœ¨å…¬äº¤è½¦ä¸Šçœ‹åˆ°å¯¹é¢çš„ä¸­å¹´ç”·äººç©¿ç€å’Œæˆ‘çˆ¸çˆ¸ä¸€æ ·çš„ polo è¡«çœ¼æ³ªå°±æ­¢ä¸ä½è€Œå¼•èµ·äº†æ—è¾¹äººçš„å¥‡æ€ªçš„çœ¼ç¥ã€‚æˆ‘è®°å¾—æˆ‘æ¯éš”ä¸€å¤©å°±ä¼šåšæ¢¦æ¢¦åˆ°çˆ¸çˆ¸ï¼Œå‹æŠ‘çš„å–˜ä¸è¿‡æ°”éš¾å—çš„å“­é†’ã€‚æˆ‘è®°å¾—æˆ‘ä¸‹ç­ä¸æƒ³å›å®¿èˆåœ¨æ“åœºæ”¾ç©ºä¸€åœˆä¸€åœˆçš„èµ°ç€ã€‚æ¯ä¸€æ¬¡å“­å®Œæˆ‘éƒ½ä»¥ä¸ºï¼Œè¿™æ¬¡å“­å®Œå°±å¥½äº†ï¼Œå¯æ˜¯æ²¡æœ‰ã€‚æˆ‘æ¶è¯­æ€¼ç€èº«è¾¹å…³å¿ƒæˆ‘çš„äººï¼Œä¹Ÿåœ¨å¶å°”æ¸…é—²çš„å·¥ä½œæ—¥ä¸‹åˆéå¸¸ä¸§çš„æƒ³ç€å·¥ä½œçš„æ— è¶£ã€ç”Ÿæ´»çš„æ— èŠã€‚æˆ‘åšäº†å¾ˆå¤šä»½ç½‘ä¸ŠæŠ‘éƒç—‡çš„æµ‹è¯•ï¼Œéå¸¸çœŸå®çš„å¡«äº†ç­”æ¡ˆï¼Œçœ‹ç€æœ€åæŠ‘éƒçš„ç»“æœã€‚çœŸçš„æ—¶åˆ»éƒ½åœ¨å¹æ°”ï¼Œéšæ—¶é™·å…¥å¯¹äººç”Ÿçš„å¤§æ€è€ƒã€‚æˆ‘ç–¯ç‹‚çš„æ‰¾å„ç§äººèŠå¤©è¯‰è¯´ï¼Œä½†æ˜¯æ²¡æœ‰ç¼“è§£ã€‚æˆ‘å‡ºå»æ—…è¡Œï¼Œåœ¨å¾®åšä¸Šå¼€äº†ä¸€ä¸ªç©¿æ­è¯é¢˜ï¼Œå¸Œæœ›è‡ªå·±æ¯å¤©è‡³å°‘èƒ½æœ‰ä¸€ç‚¹å¼€å¿ƒå’Œå¯„æ‰˜ã€‚æ¯æ¬¡ç»™å®¶é‡Œæ‰“ç”µè¯ï¼Œéƒ½è¦åšå¾ˆä¹…çš„å¿ƒé‡Œå‡†å¤‡ï¼Œå› ä¸ºæ¯æ¬¡æ‰“å®Œç”µè¯ï¼Œæˆ‘éƒ½ä¼šæ›´ä¸§ä¸€äº›ï¼Œæˆ‘èƒ½å¬åˆ°å¥¶å¥¶åœ¨ç”µè¯é‡Œæ¯ä¸€å¥è¯ä¸­é—´éƒ½å¤¹æ‚ç€çš„å¹æ°”ï¼Œæˆ‘èƒ½å¬åˆ°å¥¹çš„å­¤å•ï¼Œå¥¹ä¸€ééå¼ºè°ƒçš„â€œä»¥åä½ åªèƒ½é ç€ä½ è‡ªå·±äº†ï¼Œå®¶é‡Œä¹Ÿæ²¡äººèƒ½å¸®ä½ äº†â€ï¼Œæˆ‘è¿˜èƒ½æ„Ÿå—åˆ°æ¥è‡ªå¾ˆå¤šå…³å¿ƒæˆ‘çš„äººçš„å¿ƒç–¼ä¸å¯æ€œã€‚è¯´å®è¯ï¼Œè¿™äº›ï¼Œéƒ½æŒºä»¤æˆ‘çª’æ¯çš„ã€‚å¯èƒ½æ˜¯æˆ‘çŸ«æƒ…ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘å°±æ˜¯æ‰§æ‹—çš„æƒ³ç€ï¼Œæˆ‘æ‰ 24 å²ï¼Œè¿˜æ²¡æœ‰åˆ°å¤§å¤šæ•°äººé¢å¯¹çˆ¶æ¯ç¦»å»çš„å¹´çºªï¼Œä¸ºä»€ä¹ˆï¼Œæˆ‘å°±æ²¡æœ‰çˆ¸çˆ¸äº†ã€‚ å¯¹ä¸èµ·ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘éƒ½åªå†™äº†ä¸å¥½çš„äº‹å„¿ä¸çŸ«æƒ…çš„å‹æŠ‘ã€‚åœ¨è¿™å„¿ï¼Œæˆ‘è¿˜æ˜¯æƒ³è¯´å¥ï¼ŒFuck youï¼æˆ‘çš„æœ¬å‘½å¹´ï¼ŒçœŸçš„å¾ˆä¸§ã€‚ ä½†æ˜¯æˆ‘æƒ³è¯´çš„ç¬¬ä¸‰ä»¶äº‹å„¿ï¼Œæ˜¯ä»¶å¹¸ç¦çš„å°äº‹å„¿ã€‚æˆ‘ä¸æƒ³åå•¬æˆ‘èƒ½æƒ³åˆ°çš„ä»»ä½•è¯­è¨€æ¥è¡¨è¾¾æˆ‘çš„å¼€å¿ƒä¸å¹¸ç¦ï¼Œè¿˜æœ‰å¯¹è¿™è¶´ä¸»è§’çš„æ„Ÿè°¢ã€‚ä»–å«æç…Šã€‚å­˜åœ¨äºæˆ‘åšå®¢ã€Œå…³äºã€ä¸­çš„ç”·å­©å­ã€‚ä»–æ˜¯æˆ‘çš„è€å‹ï¼Œä»¥å‰ã€‚æ˜¯ä¸€ä¸ªæˆ‘å¯ä»¥éšæ„è·Ÿä»–è¯´ç”Ÿæ´»ä¸‰ä¸¤äº‹å„¿çš„è€å‹ã€‚æˆ‘è®¤è¯†ä»–å¤šä¹…å‘¢ï¼Ÿä¸¤ä¸‰å¹´ã€‚è§è¿‡å‡ æ¬¡é¢ï¼Ÿçº¦è¿‡å‡ æ¬¡é¥­ï¼Ÿå•Šå“ˆå“ˆå“ˆå“ˆï¼Œæˆ‘å°è±¡ä¸­çœŸçš„æ²¡å‡ æ¬¡ã€‚ä½†æ˜¯ä½ è¦é—®æˆ‘ä»–åœ¨æˆ‘çš„æœ‹å‹ä¸­æ’åå‡ ä½•ï¼Œæˆ‘çœŸçš„ä¼šè¯´ï¼Œæ˜¯åœ¨å¥½å‹æ¦œçš„å‰å‡ ä½ã€‚æˆ‘å¯¹ä»–çš„è¯„ä»·å¾ˆé«˜ï¼Œä¸€ä¸ªç›¸å¤„èˆ’æœï¼Œæ¸©æŸ”ç»…å£«ä¸”ä¼˜ç§€çš„ç”·å­©å­ã€‚2019 å¹´ 8 æœˆ 3 å·ï¼Œä¸€ä¸ªå¹³å¸¸çš„å‘¨äº”ï¼Œåˆè·Ÿä»–åœ¨å¾®ä¿¡ä¸Šé€¼é€¼äº†ä¸€å¤©ã€‚ç„¶åï¼Œä»–è¡¨ç™½äº†ï¼Œæ‰€ä»¥ï¼Œç°åœ¨ï¼Œä»–æ˜¯æˆ‘çš„ç”·æœ‹å‹ã€‚ ä»–å¥½åƒæ˜¯å¼€ç©ç¬‘çš„è¡¨ç™½ï¼Œéšå£è¯´äº†å¥ï¼Œè¦ä¸ä½ ç›´æ¥å½“æˆ‘å¥³æœ‹å‹ç®—äº†ã€‚æˆ‘çš„å›ç­”ä¹Ÿæ˜¯å•Šå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ æˆ‘æ‡µé€¼äº†ã€‚ç„¶åï¼Œæˆ‘å¼€å§‹å¼€å¿ƒï¼Œå¼€å§‹èµ°å¿ƒï¼Œå¼€å§‹è®¤è®¤çœŸçœŸåŠ¨äº†å¿ƒã€‚å¾®åšé‡Œï¼Œæˆ‘ç§€äº†æ©çˆ±ï¼Œè¯´äº†å¾ˆå¤šæˆ‘å–œæ¬¢ä»–çš„æ•…äº‹ï¼Œç©ä»–å–œæ¬¢çš„æ¸¸æˆï¼Œå¬ä»–å–œæ¬¢çš„ç”µå°å’Œæ­Œæ›²ï¼Œå°è¯•ä»–å–œæ¬¢çš„é…’ã€‚ä½†åœ¨è¿™é‡Œï¼Œæˆ‘æƒ³è¯´è¯´æˆ‘æ„Ÿå—åˆ°çš„ä»–çš„å–œæ¬¢å’Œæ¸©æŸ”ã€‚åœ¨ç½‘æ˜“äº‘ï¼Œæˆ‘å»ºäº†ä¸€ä¸ªæ­Œå•ï¼Œå«ã€Œç»™ç…Šå®çš„ã€ï¼Œé‡Œé¢æ”¶è—äº†ä¸€äº›æˆ‘å¬åˆ°çš„ç”œç”œçš„æ­Œï¼Œæˆ‘æ²¡å‘Šè¯‰ä»–ï¼Œä½†æ˜¯ä»–è‡ªå·±çœ‹åˆ°äº†ï¼Œå°±é»˜é»˜çš„æ·»åŠ äº†æ”¶è—ã€‚ä»–ä¼šåœ¨èŠå¤©ä¸­ä¸ç»æ„çš„è¡¨è¾¾çˆ±æ„ä¸å–œæ¬¢ï¼Œè¯´ä¸€äº›å½©è™¹å±ï¼Œå¤¸æˆ‘çš„ç…§éª—å¥½çœ‹çš„ä¸€åŒ¹ï¼Œè¯´è¡£æœä¸€èˆ¬ä½†ä¸»è¦è¿˜æ˜¯çœ‹è°ç©¿ã€‚åœ¨æˆ‘ç£¨å½ä»–çš„æ—¶å€™çªç„¶çš„è¯­æ°”æ¸©æŸ”ï¼Œè¯´â€œåˆ«é—¹äº†ï½ä¹–ï½â€ã€‚ä»–ä¼šåœ¨æˆ‘è·Ÿä»–è¯´å¯èƒ½è¿˜æœ‰ä¸¤ä¸ªæœˆæ‰èƒ½è§é¢çš„æ—¶å€™è¯­æ°”å¤±è½ã€‚ä¹Ÿä¼šåœ¨è¢«å·¥ä½œæŠ˜ç£¨çš„è‹¦é€¼ä¸å ªçš„æ—¶å€™ç»™æˆ‘æ‰“ç”µè¯ç–¯ç‹‚åæ§½ä¸‰ä¸‡å­—ã€‚ä¼šè®¤çœŸæŠŠæˆ‘è„±ä¸‹æ¥ä¹±æ”¾çš„é‹æ•´é½çš„æ‘†åœ¨é‹æŸœå‰ã€‚ä¼šæ¸©æŸ”çš„å»æˆ‘æŠ±ç´§æˆ‘ç¬‘ç€ææˆ‘èº«ä¸Šçš„è‚‰è‚‰æŒ æˆ‘çš„ç—’ç—’ã€‚ä¼šåœ¨æˆ‘è¿½æ˜Ÿå¤§å–Šåƒçºè€å…¬çš„æ—¶å€™ç»™äºˆæˆ‘ä¸€å¥åŒ…å®¹çš„â€œå°å‚»å­â€ã€‚ä¹Ÿä¼šåœ¨æˆ‘å› ä¸ºè¯¯è§£ä»–çš„è¯é—¹åˆ«æ‰­çš„æ—¶å€™ä¸€å¥å¥çš„è®¤çœŸè§£é‡Šï¼Œå‘Šè¯‰æˆ‘ä»–æƒ³è®©æˆ‘åœ¨å»æ‰¾ä»–çš„æ—¶å€™ä½çš„èˆ’æœï¼Œè¿‡å¾—å¼€å¿ƒï¼Œä»–ç„¦è™‘ç€å› ä¸ºå·¥ä½œå¤ªå¿™è€Œé™ªä¼´æˆ‘çš„æ—¶é—´å¤ªå°‘ã€‚ä¼šé»˜é»˜çš„è®°ä½æˆ‘å®³æ€•èŸ‘è‚ï¼Œåœ¨å¸®æˆ‘æ‰¾æˆ¿å­çœ‹æˆ¿å­çš„æ—¶å€™ä»”ç»†ç”„é€‰ã€‚ä¼šç”¨å¿ƒçš„ç»™æˆ‘å‡†å¤‡èŠ‚æ—¥ç¤¼ç‰©ã€‚ä¼šåœ¨ç¹å¿™çš„å·¥ä½œä¸­å°½å¯èƒ½çš„æŠ½æ—¶é—´é™ªæˆ‘ã€‚ä»–çš„æ¸©æŸ”å¾ˆå¤šï¼Œæˆ‘ï¼Œåœ¨æ…¢æ…¢æ„Ÿå—ã€‚æˆ‘ä»¬ä»æœªè®¤çœŸè®¨è®ºè¿‡ä»¥åï¼Œæ‰¿è¯ºè¿‡è‡³æ­»ä¸æ¸ï¼Œä½†æ˜¯åœ¨æˆ‘ä¸ºä¸çŸ¥é“èƒ½ä¸èƒ½å»ä»–çš„åŸå¸‚å·¥ä½œç»“æŸå¼‚åœ°è€Œä¸å®‰çš„æ—¶å€™ï¼Œä»–çœ‹ä¼¼éšä¾¿çš„å‘Šè¯‰æˆ‘ï¼Œå¦‚æœæˆ‘ä¸èƒ½å»ï¼Œä»–å°±æ¥ã€‚ä»–è®©æˆ‘æ„Ÿå—åˆ°è¸å®ä¸å®‰å®šã€‚æˆ‘ä»æœªé‡åˆ°è¿‡ä¸€ä¸ªç”·äººå¯ä»¥å¦‚æ­¤æ¸©æŸ”ã€‚è™½ç„¶æˆ‘æ˜¯ä¸€ä¸ªéå…¸å‹å·¥ç§‘å¥³ï¼Œä¹Ÿä¼šè¯´çŸ«æƒ…çš„è¯ï¼Œå¯æ˜¯æˆ‘çœŸçš„æƒ³ä¸åˆ°è¿˜æœ‰ä»€ä¹ˆæ¯”ä¸€å¥æˆ‘çˆ±ä½ æ›´åŠ æ·±æƒ…çš„è¡¨è¾¾ã€‚çœ‹ç€ä»–çš„çœ¼ç›ï¼Œä¸‰ç§’æˆ‘å°±è´¥ä¸‹é˜µæ¥ï¼Œå¿ä¸ä½ç¬‘å¼€äº†èŠ±ã€‚å¬ç€ä»–çš„å£°éŸ³ï¼Œæˆ‘å¸Œæœ›ä¸è¦åœä¸‹æ¥ï¼Œæˆ‘è¦å¬ä»–è¯´å¥½å¤šå¥½å¤šè¯ï¼Œæƒ…è¯å’ŒåºŸè¯ã€‚ æˆ‘è¯´ä»–æ˜¯æˆ‘çš„å¹¸è¿æ˜Ÿï¼Œæ˜¯æ¥å¸®æˆ‘ã€Œå†²å–œã€çš„ã€‚å•Šå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚æ˜¯å› ä¸ºï¼Œä»ä»–è¡¨ç™½ä¹‹åï¼Œæˆ‘çš„ç”Ÿæ´»çœŸçš„åœ¨ä¸€ç‚¹ç‚¹å˜å¥½ã€‚ä»–è§£æ•‘äº†æˆ‘ä¸§æ°”çš„å¿ƒæƒ…ã€‚è€Œä¸”ï¼Œ2019 å¹´ç¬¬å››ä»¶äº‹å„¿ï¼Œä¸€ä¸ªå†³å®šäº†æˆ‘ç¦»å¼€å­¦æ ¡æ­¥å…¥ç¤¾ä¼šçš„ç”Ÿæ´»è½¨è¿¹çš„äº‹å„¿ï¼Œæ¥äº†ã€‚ç§‹æ‹›ï¼Œofferï¼Œå·¥ä½œã€‚å¾ˆæƒ³éª„å‚²çš„è¯´ï¼Œåšä¸€ä¸ªå°å°çš„ offer æ”¶å‰²æœºï¼ŒçœŸå¥½ã€‚é™¤äº†å­—èŠ‚æ— ç¼˜ï¼Œé¢è¯•è¿‡çš„å…¬å¸ï¼Œç™¾åº¦ã€äº¬ä¸œã€æ»´æ»´ã€ç¾å›¢ã€é¡ºä¸°ã€åä¸ºã€å¿«æ‰‹ï¼Œè¿˜æœ‰æˆ‘çš„ç§‹æ‹›åˆå¿ƒï¼Œè…¾è®¯ï¼Œå…¨éƒ½å‘äº† offerã€‚æ²¡é”™ï¼Œè¿™é‡Œï¼Œæˆ‘å°±æ˜¯æ¥ç§€çš„ã€‚åœ¨ 2019 å¹´çš„æ„¿æœ›æ¸…å•é‡Œï¼Œæˆ‘æœ‰å†™åˆ°ï¼Œæƒ³è¦åœ¨æ·±åœ³æ‰¾åˆ°ä¸€ä»½æ»¡æ„çš„å·¥ä½œã€‚ç°åœ¨å¹´åº¦æ€»ç»“é‡Œï¼Œæˆ‘æƒ³è¯´ï¼Œæˆ‘åšåˆ°äº†ã€‚æ‹¿åˆ°äº†è‡ªå·±å¿ƒä»ªçš„ offerï¼Œå»è‡ªå·±å–œæ¬¢çš„åŸå¸‚ï¼Œè¿˜æœ‰ï¼Œé‚£åº§åŸå¸‚é‡Œï¼Œæœ‰ä»–ï½çœŸçš„å¾ˆå¼€å¿ƒã€‚ ç°åœ¨çš„ 01ï¼Œå¾ˆå¥½ã€‚åœ¨åŠªåŠ›çš„æ¶ˆåŒ–ç€çˆ¸çˆ¸çš„ç¦»å»ï¼Œä¹Ÿåœ¨è®¤çœŸçš„æœç€è‡ªå·±æƒ³è¦çš„ç”Ÿæ´»åŠªåŠ›ã€‚æˆ‘çˆ±æˆ‘äº²çˆ±çš„å®¶äººï¼Œä¹ŸçœŸå¿ƒçš„è°¢è°¢é‚£äº›ä¸€ç›´é™ªä¼´ç€æˆ‘çš„å¥½æœ‹å‹ä»¬ï½æˆ‘çš„é¹­å®å®ï¼Œæˆ‘çš„ç¾¤ç¾¤è„‘å©†ï¼Œæˆ‘çš„å¤§å–µï¼Œæˆ‘çš„é¾™é¾™åŒ—åŒ—ï¼Œ3308 çš„å°ä»™å¥³ä»¬ï¼Œæ¢è‰¯ï¼Œæ™“å®‡ï¼Œå¿—å¼ºï¼Œæœ±é›ªï¼Œè¿˜æœ‰æˆ‘æ´‹è‘±çš„å°ä¼™ä¼´ä»¬å’Œç¾å›¢çš„å¼Ÿå¼Ÿã€è€å“¥ä»¬ã€‚01 ä¸€ç›´éƒ½å¾ˆå¹¸è¿ï¼Œä¸€è·¯éƒ½æœ‰å¾ˆå¤šäººé™ªï¼Œä¸ç®¡æ˜¯ç›¸ä¼´åˆ°å¦‚ä»Šçš„æŒšå‹ï¼Œè¿˜æ˜¯åŒè¡Œä¸€æ®µè·¯çš„æ›¾ç»çš„æœ‹å‹ã€‚ æˆ‘è¿˜æ˜¯å¾ˆçˆ±è‡ªå·±ï¼Œçˆ±è¿™ä¸ªçˆ±ç¬‘çš„ 01ã€‚ 2019 å¹´åº¦æ€»ç»“çš„æœ€åï¼Œæ˜¯ 2020 å¹´çš„æ„¿æœ›æ¸…å•ï¼š é¡ºåˆ©å®Œæˆè®ºæ–‡ï¼Œé¡ºåˆ©æ¯•ä¸š æ‹å¥½çœ‹çš„æ¯•ä¸šç…§ å»æ—¥æœ¬æ¯•ä¸šæ—…è¡Œ åœ¨æ·±åœ³ç§Ÿä¸ªä¸é”™çš„æˆ¿å­ï¼Œå®¤å‹ nice å…»ä¸€åªçŒ« å¥èº«æ˜¯æ°¸æ’çš„ä¸»é¢˜ å¤šçœ‹äº›ä¹¦ 2020å¹´ï¼Œç¥é¡ºåˆ©ã€‚","categories":[{"name":"01çš„å°ç”Ÿæ´»","slug":"01çš„å°ç”Ÿæ´»","permalink":"http://yoursite.com/categories/01çš„å°ç”Ÿæ´»/"}],"tags":[{"name":"å¹´åº¦æ€»ç»“","slug":"å¹´åº¦æ€»ç»“","permalink":"http://yoursite.com/tags/å¹´åº¦æ€»ç»“/"}]},{"title":"Vueè®¡ç®—å±æ€§(computed)å’Œä¾¦å¬å±æ€§(watch)","slug":"Vueè®¡ç®—å±æ€§(computed)å’Œä¾¦å¬å±æ€§(watch)","date":"2019-12-29T01:52:21.000Z","updated":"2019-12-29T07:18:55.892Z","comments":true,"path":"2019/12/29/Vueè®¡ç®—å±æ€§(computed)å’Œä¾¦å¬å±æ€§(watch)/","link":"","permalink":"http://yoursite.com/2019/12/29/Vueè®¡ç®—å±æ€§(computed)å’Œä¾¦å¬å±æ€§(watch)/","excerpt":"","text":"Vueè®¡ç®—å±æ€§(computed)å’Œä¾¦å¬å±æ€§(watch)è®¡ç®—å±æ€§ä»‹ç»è®¡ç®—å±æ€§æ˜¯è‡ªåŠ¨ç›‘å¬ä¾èµ–å€¼çš„å˜åŒ–ï¼Œä»è€ŒåŠ¨æ€è¿”å›å†…å®¹ï¼Œç›‘å¬æ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œåœ¨ç›‘å¬çš„å€¼å˜åŒ–æ—¶ï¼Œå¯ä»¥è§¦å‘ä¸€ä¸ªå›è°ƒï¼Œå¹¶åšä¸€äº›äº‹æƒ…ã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š æ•°æ®å¯ä»¥è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œå‡å°‘æ¨¡æ¿ä¸­è®¡ç®—é€»è¾‘ã€‚ å¯¹è®¡ç®—å±æ€§ä¸­çš„æ•°æ®è¿›è¡Œç›‘è§† ä¾èµ–å›ºå®šçš„æ•°æ®ç±»å‹ï¼ˆå“åº”å¼æ•°æ®ï¼‰ è®¡ç®—å±æ€§ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šgetå’Œsetï¼Œåˆ†åˆ«ç”¨æ¥è·å–è®¡ç®—å±æ€§å’Œè®¾ç½®è®¡ç®—å±æ€§ã€‚é»˜è®¤åªæœ‰getï¼Œå¦‚æœéœ€è¦setï¼Œè¦è‡ªå·±æ·»åŠ ã€‚å¦å¤–setè®¾ç½®å±æ€§ï¼Œå¹¶ä¸æ˜¯ç›´æ¥ä¿®æ”¹è®¡ç®—å±æ€§ï¼Œè€Œæ˜¯ä¿®æ”¹å®ƒçš„ä¾èµ–ã€‚ 123456789101112131415computed: &#123; fullName: &#123; // getter get: function () &#123; return this.firstName + ' ' + this.lastName &#125;, // setter set: function (newValue) &#123; //this.fullName = newValue è¿™ç§å†™æ³•ä¼šæŠ¥é”™ var names = newValue.split(' ') this.firstName = names[0]//å¯¹å®ƒçš„ä¾èµ–è¿›è¡Œèµ‹å€¼ this.lastName = names[names.length - 1] &#125; &#125;&#125; è®¡ç®—å±æ€§ vs æ™®é€šå±æ€§å¯ä»¥åƒç»‘å®šæ™®é€šå±æ€§ä¸€æ ·åœ¨æ¨¡æ¿ä¸­ç»‘å®šè®¡ç®—å±æ€§ï¼Œåœ¨å®šä¹‰ä¸Šæœ‰åŒºåˆ«ï¼šè®¡ç®—å±æ€§çš„å±æ€§å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ 1234567891011data:&#123; //æ™®é€šå±æ€§ msg:'æµªé‡Œè¡ŒèˆŸ',&#125;,computed:&#123; //è®¡ç®—å±æ€§ msg2:function()&#123; //è¯¥å‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ï¼Œç”¨æ¥è·å–å±æ€§ï¼Œç§°ä¸ºgetå‡½æ•° return 'æµªé‡Œè¡ŒèˆŸ'; &#125;, reverseMsg:function()&#123; //å¯ä»¥åŒ…å«é€»è¾‘å¤„ç†æ“ä½œï¼ŒåŒæ—¶reverseMsgä¾èµ–äºmsg,ä¸€æ—¦msgå‘ç”Ÿå˜åŒ–ï¼ŒreverseMsgä¹Ÿä¼šè·Ÿç€å˜åŒ– return this.msg.split(' ').reverse().join(' '); &#125; è®¡ç®—å±æ€§ vs æ–¹æ³•ä¸¤è€…æœ€ä¸»è¦çš„åŒºåˆ«ï¼šcomputed æ˜¯å¯ä»¥ç¼“å­˜çš„ï¼Œmethods ä¸èƒ½ç¼“å­˜ï¼› åªè¦ç›¸å…³ä¾èµ–æ²¡æœ‰æ”¹å˜ï¼Œå¤šæ¬¡è®¿é—®è®¡ç®—å±æ€§å¾—åˆ°çš„å€¼æ˜¯ä¹‹å‰ç¼“å­˜çš„è®¡ç®—ç»“æœï¼Œä¸ä¼šå¤šæ¬¡æ‰§è¡Œã€‚ç½‘ä¸Šæœ‰ç§è¯´æ³•å°±æ˜¯æ–¹æ³•å¯ä»¥ä¼ å‚ï¼Œè€Œè®¡ç®—å±æ€§ä¸èƒ½ï¼Œå…¶å®å¹¶ä¸å‡†ç¡®ï¼Œè®¡ç®—å±æ€§å¯ä»¥é€šè¿‡é—­åŒ…æ¥å®ç°ä¼ å‚ï¼š 123456789:data=\"closure(item, itemName, blablaParams)\"computed: &#123; closure () &#123; return function (a, b, c) &#123; /** do something */ return data &#125; &#125;&#125; ä¾¦å¬å±æ€§Vue æä¾›äº†ä¸€ç§æ›´é€šç”¨çš„æ–¹å¼æ¥è§‚å¯Ÿå’Œå“åº” Vue å®ä¾‹ä¸Šçš„æ•°æ®å˜åŠ¨ï¼šä¾¦å¬å±æ€§watchã€‚watchä¸­å¯ä»¥æ‰§è¡Œä»»ä½•é€»è¾‘ï¼Œå¦‚å‡½æ•°èŠ‚æµï¼ŒAjaxå¼‚æ­¥è·å–æ•°æ®ï¼Œç”šè‡³æ“ä½œ DOMï¼ˆä¸å»ºè®®ï¼‰ã€‚ å¸¸è§„ç”¨æ³•12345678910111213141516171819202122232425262728293031323334353637383940&lt;template&gt; &lt;div class=&quot;attr&quot;&gt; &lt;h1&gt;watchå±æ€§&lt;/h1&gt; &lt;h2&gt;&#123;&#123; $data &#125;&#125;&lt;/h2&gt; &lt;button @click=&quot;() =&gt; (a += 1)&quot;&gt;ä¿®æ”¹açš„å€¼&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data() &#123; return &#123; a: 1, b: &#123; c: 2, d: 3 &#125;, e: &#123; f: &#123; g: 4 &#125; &#125;, h: [] &#125;; &#125;, watch: &#123; a: function(val, oldVal) &#123; this.b.c += 1; &#125;, &quot;b.c&quot;: function(val, oldVal) &#123; this.b.d += 1; &#125;, &quot;b.d&quot;: function(val, oldVal) &#123; this.e.f.g += 1; &#125;, e: &#123; handler: function(val, oldVal) &#123; this.h.push(&quot;æµªé‡Œè¡ŒèˆŸ&quot;); &#125;, deep: true //ç”¨äºç›‘å¬eå¯¹è±¡å†…éƒ¨å€¼çš„å˜åŒ– &#125; &#125;&#125;;&lt;/script&gt; ä½¿ç”¨ watch çš„æ·±åº¦éå†å’Œç«‹å³è°ƒç”¨åŠŸèƒ½ä½¿ç”¨ watch æ¥ç›‘å¬æ•°æ®å˜åŒ–çš„æ—¶å€™é™¤äº†å¸¸ç”¨åˆ° handler å›è°ƒï¼Œå…¶å®å…¶è¿˜æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¾¿æ˜¯ï¼š deep è®¾ç½®ä¸º true ç”¨äºç›‘å¬å¯¹è±¡å†…éƒ¨å€¼çš„å˜åŒ– immediate è®¾ç½®ä¸º true å°†ç«‹å³ä»¥è¡¨è¾¾å¼çš„å½“å‰å€¼è§¦å‘å›è°ƒ 1234567891011121314151617181920212223&lt;template&gt; &lt;button @click=&quot;obj.a = 2&quot;&gt;ä¿®æ”¹&lt;/button&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data() &#123; return &#123; obj: &#123; a: 1, &#125; &#125; &#125;, watch: &#123; obj: &#123; handler: function(newVal, oldVal) &#123; console.log(newVal); &#125;, deep: true, immediate: true &#125; &#125;&#125;&lt;/script&gt; ä»¥ä¸Šä»£ç æˆ‘ä»¬ä¿®æ”¹äº† obj å¯¹è±¡ä¸­ a å±æ€§çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è§¦å‘å…¶ watch ä¸­çš„ handler å›è°ƒè¾“å‡ºæ–°çš„å¯¹è±¡ï¼Œè€Œå¦‚æœä¸åŠ  deep: trueï¼Œæˆ‘ä»¬åªèƒ½ç›‘å¬ obj çš„æ”¹å˜ï¼Œå¹¶ä¸ä¼šè§¦å‘å›è°ƒã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿæ·»åŠ äº† immediate: true é…ç½®ï¼Œå…¶ä¼šç«‹å³ä»¥ obj çš„å½“å‰å€¼è§¦å‘å›è°ƒã€‚ computedå’Œwatchä¸¤è€…ä¹‹é—´å¯¹æ¯” ä»ä¸Šé¢æµç¨‹å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼š watchï¼šç›‘æµ‹çš„æ˜¯å±æ€§å€¼ï¼Œ åªè¦å±æ€§å€¼å‘ç”Ÿå˜åŒ–ï¼Œå…¶éƒ½ä¼šè§¦å‘æ‰§è¡Œå›è°ƒå‡½æ•°æ¥æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œã€‚ computedï¼šç›‘æµ‹çš„æ˜¯ä¾èµ–å€¼ï¼Œä¾èµ–å€¼ä¸å˜çš„æƒ…å†µä¸‹å…¶ä¼šç›´æ¥è¯»å–ç¼“å­˜è¿›è¡Œå¤ç”¨ï¼Œå˜åŒ–çš„æƒ…å†µä¸‹æ‰ä¼šé‡æ–°è®¡ç®—ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæœ‰ç‚¹å¾ˆé‡è¦çš„åŒºåˆ«æ˜¯ï¼šè®¡ç®—å±æ€§ä¸èƒ½æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œè®¡ç®—å±æ€§å¿…é¡»åŒæ­¥æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´è®¡ç®—å±æ€§ä¸èƒ½å‘æœåŠ¡å™¨è¯·æ±‚æˆ–è€…æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚å¦‚æœé‡åˆ°å¼‚æ­¥ä»»åŠ¡ï¼Œå°±äº¤ç»™ä¾¦å¬å±æ€§ã€‚watchä¹Ÿå¯ä»¥æ£€æµ‹computedå±æ€§ã€‚ è®¡ç®—å±æ€§é€‚åˆç”¨åœ¨æ¨¡æ¿æ¸²æŸ“ä¸­ï¼ŒæŸä¸ªå€¼æ˜¯ä¾èµ–äº†å…¶å®ƒçš„å“åº”å¼å¯¹è±¡ç”šè‡³æ˜¯è®¡ç®—å±æ€§è®¡ç®—è€Œæ¥ï¼›è€Œä¾¦å¬å±æ€§é€‚ç”¨äºè§‚æµ‹æŸä¸ªå€¼çš„å˜åŒ–å»å®Œæˆä¸€æ®µå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚ computedèƒ½åšçš„ï¼Œwatchéƒ½èƒ½åšï¼Œåä¹‹åˆ™ä¸è¡Œ èƒ½ç”¨computedçš„å°½é‡ç”¨computed","categories":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/categories/VUE/"}],"tags":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/tags/VUE/"}]},{"title":"æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰","slug":"æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰","date":"2019-12-19T09:25:43.000Z","updated":"2019-12-29T07:15:07.580Z","comments":true,"path":"2019/12/19/æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰/","link":"","permalink":"http://yoursite.com/2019/12/19/æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰/","excerpt":"","text":"æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰ç¬¬å››ç«  å¼‚æ­¥ç¼–ç¨‹å‡½æ•°å¼ç¼–ç¨‹é«˜é˜¶å‡½æ•°é«˜é˜¶å‡½æ•°æ˜¯å¯ä»¥æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–æ˜¯å°†å‡½æ•°ä½œä¸ºè¿”å›å€¼çš„å‡½æ•° 12345function foo(x) &#123; return function () &#123; return x; &#125;;&#125; åç»­ä¼ é€’é£æ ¼(Continuation Passing Style)çš„ç»“æœæ¥æ”¶ æ–¹å¼ï¼Œè€Œéå•ä¸€çš„è¿”å›å€¼å½¢å¼ã€‚åç»­ä¼ é€’é£æ ¼çš„ç¨‹åºç¼–å†™å°†å‡½æ•°çš„ä¸šåŠ¡é‡ç‚¹ä»è¿”å›å€¼è½¬ç§»åˆ°äº†å›è°ƒå‡½æ•°ä¸­ã€‚ ä¾‹å­ECMAScript5ä¸­æä¾›çš„ä¸€äº›æ•°ç»„æ–¹æ³•(sort()ã€forEach()ã€ map()ã€reduce()ã€reduceRight()ã€filter()ã€every()ã€some())ååˆ†å…¸å‹ åå‡½æ•°ç”¨æ³•åå‡½æ•°ç”¨æ³•æ˜¯æŒ‡åˆ›å»ºä¸€ä¸ªè°ƒç”¨å¦å¤–ä¸€ä¸ªéƒ¨åˆ†â€”â€”å‚æ•°æˆ–å˜é‡å·²ç»é¢„ç½®çš„å‡½æ•°â€”â€”çš„å‡½æ•°çš„ç”¨æ³• 1234567var toString = Object.prototype.toString;var isString = function (obj) &#123; return toString.call(obj) == '[object String]';&#125;;var isFunction = function (obj) &#123; return toString.call(obj) == '[object Function]'; &#125;; æˆ‘ä»¬éœ€è¦é‡å¤å»å®šä¹‰ä¸€äº›ç›¸ä¼¼çš„å‡½æ•°ï¼Œå¦‚æœæœ‰æ›´å¤šçš„isXXX()ï¼Œå°±ä¼šå‡ºç°æ›´å¤šçš„å†—ä½™ä»£ç . 1234567var isType = function (type) &#123; return function (obj) &#123; return toString.call(obj) == '[object ' + type + ']'; &#125;;&#125;;var isString = isType('String');var isFunction = isType('Function'); è¿™ ç§é€šè¿‡æŒ‡å®šéƒ¨åˆ†å‚æ•°æ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å®šåˆ¶å‡½æ•°çš„å½¢å¼å°±æ˜¯åå‡½æ•° å¼‚æ­¥ç¼–ç¨‹çš„ä¼˜åŠ¿ä¸éš¾ç‚¹ä¼˜åŠ¿æœ€å¤§çš„ç‰¹æ€§ï¼šåŸºäºäº‹ä»¶é©±åŠ¨çš„éé˜»å¡I/Oæ¨¡å‹ éé˜»å¡I/Oå¯ä»¥ä½¿CPUä¸I/Oå¹¶ä¸ç›¸äº’ä¾èµ–ç­‰å¾…ï¼Œè®©èµ„æºå¾—åˆ°æ›´å¥½çš„åˆ©ç”¨ å¹¶è¡Œå¸¦æ¥çš„æƒ³è±¡ç©ºé—´æ›´å¤§ï¼Œå»¶å±•è€Œå¼€çš„æ˜¯åˆ†å¸ƒå¼å’Œäº‘ã€‚å¹¶è¡Œä½¿å¾—å„ä¸ªå•ç‚¹ä¹‹é—´èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°ç»„ç»‡èµ·æ¥ éš¾ç‚¹éš¾ç‚¹1:å¼‚å¸¸å¤„ç†å¼‚æ­¥I/Oçš„å®ç°ä¸»è¦åŒ…å«ä¸¤ä¸ªé˜¶æ®µ:æäº¤è¯·æ±‚å’Œå¤„ç†ç»“æœã€‚è¿™ä¸¤ä¸ªé˜¶æ®µä¸­é—´æœ‰äº‹ä»¶å¾ªç¯çš„è°ƒåº¦ï¼Œä¸¤è€…å½¼æ­¤ä¸å…³è”ã€‚å¼‚æ­¥æ–¹æ³•åˆ™é€šå¸¸åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µæäº¤è¯·æ±‚åç«‹å³è¿”å›ï¼Œå› ä¸ºå¼‚å¸¸å¹¶ä¸ä¸€å®šå‘ç”Ÿåœ¨è¿™ä¸ªé˜¶æ®µï¼Œtry/catchçš„åŠŸæ•ˆåœ¨æ­¤å¤„ä¸ä¼šå‘æŒ¥ä»»ä½•ä½œç”¨ã€‚ 123var async = function (callback) &#123; process.nextTick(callback);&#125;; 12345try &#123; async(callback); &#125; catch (e) &#123; // TODO&#125; è°ƒç”¨async()æ–¹æ³•åï¼Œcallbackè¢«å­˜æ”¾èµ·æ¥ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯(Tick)æ‰ä¼šå–å‡ºæ¥æ‰§è¡Œã€‚å°è¯•å¯¹å¼‚æ­¥æ–¹æ³•è¿›è¡Œtry/catchæ“ä½œåªèƒ½æ•è·å½“æ¬¡äº‹ä»¶å¾ªç¯å†…çš„å¼‚å¸¸ï¼Œå¯¹callbackæ‰§è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸å°†æ— èƒ½ä¸ºåŠ›ã€‚ Nodeåœ¨å¤„ç†å¼‚å¸¸ä¸Šå½¢æˆäº†ä¸€ç§çº¦å®šï¼Œå°†å¼‚å¸¸ä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå®å‚ä¼ å›ï¼Œå¦‚æœä¸ºç©ºå€¼ï¼Œåˆ™è¡¨æ˜å¼‚æ­¥è°ƒç”¨æ²¡æœ‰å¼‚å¸¸æŠ›å‡ºï¼š 123async(function (err, results) &#123; // TODO&#125;); è‡ªè¡Œç¼–å†™çš„å¼‚æ­¥æ–¹æ³•ä¸Šï¼Œéœ€è¦å»éµå¾ªè¿™æ ·ä¸€äº›åŸåˆ™: åŸåˆ™ä¸€:å¿…é¡»æ‰§è¡Œè°ƒç”¨è€…ä¼ å…¥çš„å›è°ƒå‡½æ•°; åŸåˆ™äºŒ:æ­£ç¡®ä¼ é€’å›å¼‚å¸¸ä¾›è°ƒç”¨è€…åˆ¤æ–­ã€‚ éš¾ç‚¹2:å‡½æ•°åµŒå¥—è¿‡æ·±éš¾ç‚¹3:é˜»å¡ä»£ç æ²¡æœ‰sleep()è¿™æ ·çš„çº¿ç¨‹æ²‰ç¡åŠŸèƒ½ setInterval()å’ŒsetTimeout()å¹¶ä¸èƒ½é˜»å¡åç»­ä»£ç çš„æŒç»­æ‰§è¡Œ éš¾ç‚¹4:å¤šçº¿ç¨‹ç¼–ç¨‹å¯¹äºæœåŠ¡å™¨ç«¯è€Œè¨€ï¼Œå¦‚æœæœåŠ¡å™¨æ˜¯å¤šæ ¸CPUï¼Œå•ä¸ªNodeè¿›ç¨‹å®è´¨ä¸Šæ˜¯æ²¡æœ‰å……åˆ†åˆ©ç”¨å¤šæ ¸CPUçš„ã€‚ Nodeå€Ÿé‰´äº†è¿™ä¸ªæ¨¡å¼ï¼Œchild_processæ˜¯å…¶åŸºç¡€APIï¼Œclusteræ¨¡å—æ˜¯æ›´æ·±å±‚æ¬¡çš„åº”ç”¨ã€‚å€ŸåŠ©Web Workersçš„æ¨¡å¼ï¼Œå¼€å‘äººå‘˜è¦æ›´å¤šåœ°å»é¢ä¸´è·¨çº¿ç¨‹çš„ç¼–ç¨‹ï¼Œè¿™å¯¹äºä»¥å¾€çš„JavaScriptç¼–ç¨‹ç»éªŒæ˜¯è¾ƒå°‘è€ƒè™‘çš„ã€‚ éš¾ç‚¹5:å¼‚æ­¥è½¬åŒæ­¥Nodeä¸­è¯•å›¾åŒæ­¥å¼ç¼–ç¨‹ï¼Œä½†å¹¶ä¸èƒ½å¾—åˆ°åŸç”Ÿæ”¯æŒï¼Œéœ€è¦å€ŸåŠ©åº“æˆ–è€…ç¼–è¯‘ç­‰æ‰‹æ®µæ¥å®ç° å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆäº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼æ˜¯ä¸€ç§å¹¿æ³›ç”¨äºå¼‚æ­¥ç¼–ç¨‹çš„æ¨¡å¼ï¼Œæ˜¯å›è°ƒå‡½æ•°çš„äº‹ä»¶åŒ–ï¼Œåˆç§°å‘å¸ƒ/è®¢é˜…æ¨¡å¼ 123456// è®¢é˜…emitter.on(\"event1\", function (message) &#123; console.log(message); &#125;);// å‘å¸ƒemitter.emit('event1', \"I am message!\"); äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¨¡å¼å¯ä»¥å®ç°ä¸€ä¸ªäº‹ä»¶ä¸å¤š ä¸ªå›è°ƒå‡½æ•°çš„å…³è”ï¼Œè¿™äº›å›è°ƒå‡½æ•°åˆç§°ä¸ºäº‹ä»¶ä¾¦å¬å™¨ã€‚é€šè¿‡emit()å‘å¸ƒäº‹ä»¶åï¼Œæ¶ˆæ¯ä¼šç«‹å³ä¼ é€’ç»™å½“å‰äº‹ä»¶çš„æ‰€æœ‰ä¾¦å¬å™¨æ‰§è¡Œã€‚ä¾¦å¬å™¨å¯ä»¥å¾ˆçµæ´»åœ°æ·»åŠ å’Œåˆ é™¤ï¼Œä½¿å¾—äº‹ä»¶å’Œå…·ä½“å¤„ç†é€»è¾‘ä¹‹é—´å¯ä»¥å¾ˆè½»æ¾åœ°å…³è”å’Œè§£è€¦ã€‚ Nodeå¯¹äº‹ä»¶å‘å¸ƒ/è®¢é˜…çš„æœºåˆ¶åšäº†ä¸€äº›é¢å¤–çš„å¤„ç†ï¼Œè¿™å¤§å¤šæ˜¯åŸºäºå¥å£®æ€§è€Œè€ƒè™‘çš„: å¦‚æœå¯¹ä¸€ä¸ªäº‹ä»¶æ·»åŠ äº†è¶…è¿‡10ä¸ªä¾¦å¬å™¨ï¼Œå°†ä¼šå¾—åˆ°ä¸€æ¡è­¦å‘Šã€‚è¿™ä¸€å¤„è®¾è®¡ä¸Nodeè‡ªèº«å•çº¿ç¨‹è¿è¡Œæœ‰å…³ï¼Œè®¾è®¡è€…è®¤ä¸ºä¾¦å¬å™¨å¤ªå¤šå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼Œæ‰€ä»¥å­˜åœ¨è¿™æ ·ä¸€æ¡è­¦å‘Šã€‚è°ƒç”¨emitter.setMaxListeners(0);å¯ä»¥å°†è¿™ä¸ªé™åˆ¶å»æ‰ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºäº‹ä»¶å‘å¸ƒä¼šå¼•èµ·ä¸€ç³»åˆ—ä¾¦å¬å™¨æ‰§è¡Œï¼Œå¦‚æœäº‹ä»¶ç›¸å…³çš„ä¾¦å¬å™¨è¿‡å¤šï¼Œå¯èƒ½å­˜åœ¨è¿‡å¤šå ç”¨CPUçš„æƒ…æ™¯ã€‚ ä¸ºäº†å¤„ç†å¼‚å¸¸ï¼ŒEventEmitterå¯¹è±¡å¯¹erroräº‹ä»¶è¿›è¡Œäº†ç‰¹æ®Šå¯¹å¾…ã€‚å¦‚æœè¿è¡ŒæœŸé—´çš„é”™è¯¯è§¦å‘äº†erroräº‹ä»¶ï¼ŒEventEmitterä¼šæ£€æŸ¥æ˜¯å¦æœ‰å¯¹erroräº‹ä»¶æ·»åŠ è¿‡ä¾¦å¬å™¨ã€‚å¦‚æœæ·»åŠ äº†ï¼Œè¿™ä¸ªé”™è¯¯å°†ä¼šäº¤ç”±è¯¥ä¾¦å¬å™¨å¤„ç†ï¼Œå¦åˆ™è¿™ä¸ªé”™è¯¯å°†ä¼šä½œä¸ºå¼‚å¸¸æŠ›å‡ºã€‚å¦‚æœå¤–éƒ¨æ²¡æœ‰æ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œå°†ä¼šå¼•èµ·çº¿ç¨‹é€€å‡ºã€‚ä¸€ä¸ªå¥å£®çš„EventEmitterå®ä¾‹åº”è¯¥å¯¹erroräº‹ä»¶åšå¤„ç†ã€‚ 1. ç»§æ‰¿eventsæ¨¡å—12345var events = require('events');function Stream() &#123; events.EventEmitter.call(this);&#125;util.inherits(Stream, events.EventEmitter); Nodeåœ¨utilæ¨¡å—ä¸­å°è£…äº†ç»§æ‰¿çš„æ–¹æ³•ï¼Œæ‰€ä»¥æ­¤å¤„å¯ä»¥å¾ˆä¾¿åˆ©åœ°è°ƒç”¨ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼è½»æ¾ç»§æ‰¿EventEmitterç±»ï¼Œåˆ©ç”¨äº‹ä»¶æœºåˆ¶è§£å†³ä¸šåŠ¡é—®é¢˜ã€‚åœ¨Nodeæä¾›çš„æ ¸å¿ƒæ¨¡å—ä¸­ï¼Œæœ‰è¿‘åŠæ•°éƒ½ç»§æ‰¿è‡ªEventEmitterã€‚ 2. åˆ©ç”¨äº‹ä»¶é˜Ÿåˆ—è§£å†³é›ªå´©é—®é¢˜é›ªå´©é—®é¢˜ï¼Œå°±æ˜¯åœ¨é«˜è®¿é—®é‡ã€å¤§å¹¶å‘é‡çš„æƒ…å†µä¸‹ç¼“å­˜å¤±æ•ˆçš„æƒ…æ™¯ï¼Œæ­¤æ—¶å¤§é‡çš„è¯·æ±‚åŒæ—¶æ¶Œå…¥æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“æ— æ³•åŒæ—¶æ‰¿å—å¦‚æ­¤å¤§çš„æŸ¥è¯¢è¯·æ±‚ï¼Œè¿›è€Œå¾€å‰å½±å“åˆ°ç½‘ç«™æ•´ä½“çš„å“åº”é€Ÿåº¦ 123456789101112var proxy = new events.EventEmitter();var status = \"ready\";var select = function (callback) &#123; proxy.once(\"selected\", callback); if (status === \"ready\") &#123; status = \"pending\"; db.select(\"SQL\", function (results) &#123; proxy.emit(\"selected\", results); status = \"ready\"; &#125;); &#125; &#125;; åˆ©ç”¨äº†once()æ–¹æ³•ï¼Œå°†æ‰€æœ‰è¯·æ±‚çš„å›è°ƒéƒ½å‹å…¥äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œåˆ©ç”¨å…¶æ‰§è¡Œä¸€æ¬¡å°±ä¼šå°†ç›‘è§†å™¨ç§»é™¤çš„ç‰¹ç‚¹ï¼Œä¿è¯æ¯ä¸€ä¸ªå›è°ƒåªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ã€‚å¯¹äºç›¸åŒçš„SQLè¯­å¥ï¼Œä¿è¯åœ¨åŒä¸€ä¸ªæŸ¥è¯¢å¼€å§‹åˆ°ç»“æŸçš„è¿‡ç¨‹ä¸­æ°¸è¿œåªæœ‰ä¸€æ¬¡ã€‚ 3. å¤šå¼‚æ­¥ä¹‹é—´çš„åä½œæ–¹æ¡ˆç”±äºå¤šä¸ªå¼‚æ­¥åœºæ™¯ä¸­å›è°ƒå‡½æ•°çš„æ‰§è¡Œå¹¶ä¸èƒ½ä¿è¯é¡ºåºï¼Œä¸”å›è°ƒå‡½æ•°ä¹‹é—´äº’ç›¸æ²¡æœ‰ä»»ä½•äº¤é›†ï¼Œæ‰€ä»¥éœ€è¦å€ŸåŠ©ä¸€ä¸ªç¬¬ä¸‰æ–¹å‡½æ•°å’Œç¬¬ä¸‰æ–¹å˜é‡æ¥å¤„ç†å¼‚æ­¥åä½œçš„ç»“æœã€‚é€šå¸¸ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªç”¨äºæ£€æµ‹æ¬¡æ•°çš„å˜é‡å«åšå“¨å…µå˜é‡ 4. EventProxyçš„åŸç†EventProxyæ¥è‡ªäºBackboneçš„äº‹ä»¶æ¨¡å—ï¼ŒBackboneçš„äº‹ä»¶æ¨¡å—æ˜¯Modelã€Viewæ¨¡å—çš„åŸºç¡€åŠŸèƒ½ï¼Œåœ¨å‰ç«¯æœ‰å¹¿æ³›çš„ä½¿ç”¨ã€‚å®ƒåœ¨æ¯ä¸ªéalläº‹ä»¶è§¦å‘æ—¶éƒ½ä¼šè§¦å‘ä¸€æ¬¡alläº‹ä»¶ 1234567891011121314151617181920212223// Trigger an event, firing all bound callbacks. Callbacks are passed the // same arguments as `trigger` is, apart from the event name.// Listening for `\"all\"` passes the true event name as the first argument trigger : function(eventName) &#123; var list, calls, ev, callback, args; var both = 2; if (!(calls = this._callbacks)) return this; while (both--) &#123; ev = both ? eventName : 'all'; if (list = calls[ev]) &#123; for (var i = 0, l = list.length; i &lt; l; i++) &#123; if (!(callback = list[i])) &#123; list.splice(i, 1); i--; l--; &#125; else &#123; args = both ? Array.prototype.slice.call(arguments, 1) : arguments; callback[0].apply(callback[1] || this, args); &#125; &#125; &#125; &#125; return this; &#125; EventProxyåˆ™æ˜¯å°†allå½“åšä¸€ä¸ªäº‹ä»¶æµçš„æ‹¦æˆªå±‚ï¼Œåœ¨å…¶ä¸­æ³¨å…¥ä¸€äº›ä¸šåŠ¡æ¥å¤„ç†å•ä¸€äº‹ä»¶æ— æ³•è§£å†³çš„å¼‚æ­¥å¤„ç†é—®é¢˜ã€‚ç±»ä¼¼çš„æ‰©å±•æ–¹æ³•è¿˜æœ‰all()ã€tail()ã€after()ã€not()å’Œany()ç­‰ã€‚ 5. EventProxyçš„å¼‚å¸¸å¤„ç†1234567891011121314exports.getContent = function (callback) &#123; var ep = new EventProxy(); ep.all('tpl', 'data', function (tpl, data) &#123; // æˆåŠŸå›è°ƒ callback(null, &#123; template: tpl, data: data &#125;);&#125;); //ç»‘å®šé”™è¯¯å¤„ç†å‡½æ•° ep.fail(callback); fs.readFile('template.tpl', 'utf-8', ep.done('tpl')); db.get('some sql', ep.done('data')); &#125;; EventProxyæä¾›äº†fail()å’Œdone()è¿™ä¸¤ä¸ªå®ä¾‹æ–¹æ³•æ¥ä¼˜åŒ–å¼‚å¸¸å¤„ç†ï¼Œä½¿å¾—å¼€å‘è€…å°†ç²¾åŠ›å…³æ³¨åœ¨ä¸šåŠ¡éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯åœ¨å¼‚å¸¸æ•è·ä¸Šã€‚ fail()æ–¹æ³•çš„å®ç°1ep.fail(callback); ç­‰ä»·äºï¼š 123ep.fail(function (err) &#123; callback(err);&#125;); åˆç­‰ä»·äº: 123456ep.bind('error', function (err) &#123; // å¸è½½æ‰æ‰€æœ‰å¤„ç†å‡½æ•° ep.unbind(); // å¼‚å¸¸å›è°ƒ callback(err); &#125;); done()æ–¹æ³•çš„å®ç°1ep.done('tpl'); ç­‰ä»·äº: 1234567function (err, content) &#123; if (err) &#123; // ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼Œä¸€å¾‹äº¤ç»™erroräº‹ä»¶å¤„ç†å‡½æ•°å¤„ç† return ep.emit('error', err); &#125; ep.emit('tpl', content); &#125; Promise/Deferredæ¨¡å¼å…ˆæ‰§è¡Œå¼‚æ­¥è°ƒç”¨ï¼Œå»¶è¿Ÿä¼ é€’å¤„ç†çš„æ–¹å¼ 1234$.get('/api') .success(onSuccess) .error(onError) .complete(onComplete); è¿™ä½¿å¾—å³ä½¿ä¸è°ƒç”¨success()ã€error()ç­‰æ–¹æ³•ï¼ŒAjaxä¹Ÿä¼šæ‰§è¡Œï¼Œè¿™æ ·çš„è°ƒç”¨æ–¹å¼æ¯”é¢„å…ˆä¼ å…¥å›è°ƒè®©äººè§‰å¾—èˆ’é€‚ä¸€äº›ã€‚ åœ¨åŸå§‹çš„APIä¸­ï¼Œä¸€ä¸ªäº‹ä»¶åªèƒ½å¤„ç†ä¸€ä¸ªå›è°ƒï¼Œè€Œé€šè¿‡Deferredå¯¹è±¡ï¼Œå¯ä»¥å¯¹äº‹ä»¶åŠ å…¥ä»»æ„çš„ä¸šåŠ¡å¤„ç†é€»è¾‘ã€‚ 123$.get('/api') .success(onSuccess1) .success(onSuccess2); CommonJSè‰æ¡ˆç›®å‰å·²ç»æŠ½è±¡å‡ºäº†Promises/Aã€ Promises/Bã€Promises/Dè¿™æ ·å…¸å‹çš„å¼‚æ­¥Promise/Deferredæ¨¡å‹ï¼Œè¿™ä½¿å¾—å¼‚æ­¥æ“ä½œå¯ä»¥ä»¥ä¸€ç§ä¼˜é›…çš„æ–¹å¼å‡ºç°ã€‚ Promises/A Promiseæ“ä½œåªä¼šå¤„åœ¨3ç§çŠ¶æ€çš„ä¸€ç§:æœªå®Œæˆæ€ã€å®Œæˆæ€å’Œå¤±è´¥æ€ã€‚ Promiseçš„çŠ¶æ€åªä¼šå‡ºç°ä»æœªå®Œæˆæ€å‘å®Œæˆæ€æˆ–å¤±è´¥æ€è½¬åŒ–ï¼Œä¸èƒ½é€†åã€‚å®Œæˆæ€å’Œå¤±è´¥æ€ä¸èƒ½äº’ç›¸è½¬åŒ–ã€‚ Promiseçš„çŠ¶æ€ä¸€æ—¦è½¬åŒ–ï¼Œå°†ä¸èƒ½è¢«æ›´æ”¹ã€‚ Promiseå¯¹è±¡çš„then()ä¸€ä¸ªPromiseå¯¹è±¡åªè¦å…·å¤‡then()æ–¹æ³•å³å¯ æ¥å—å®Œæˆæ€ã€é”™è¯¯æ€çš„å›è°ƒæ–¹æ³•ã€‚åœ¨æ“ä½œå®Œæˆæˆ–å‡ºç°é”™è¯¯æ—¶ï¼Œå°†ä¼šè°ƒç”¨å¯¹åº”æ–¹æ³•ã€‚ å¯é€‰åœ°æ”¯æŒprogressäº‹ä»¶å›è°ƒä½œä¸ºç¬¬ä¸‰ä¸ªæ–¹æ³•ã€‚ then()æ–¹æ³•åªæ¥å—functionå¯¹è±¡ï¼Œå…¶ä½™å¯¹è±¡å°†è¢«å¿½ç•¥ã€‚ then()æ–¹æ³•ç»§ç»­è¿”å›Promiseå¯¹è±¡ï¼Œä»¥å®ç°é“¾å¼è°ƒç”¨ã€‚ Deferredï¼Œå»¶è¿Ÿå¯¹è±¡è§¦å‘æ‰§è¡Œè¿™äº›å›è°ƒå‡½æ•°çš„åœ°æ–¹ï¼Œå®ç°è¿™äº›åŠŸèƒ½çš„å¯¹è±¡é€šå¸¸è¢«ç§°ä¸ºDeferredï¼Œå³å»¶è¿Ÿå¯¹è±¡ Promiseå’ŒDeferredçš„å·®åˆ«Deferredä¸»è¦æ˜¯ç”¨äºå†…éƒ¨ï¼Œ ç”¨äºç»´æŠ¤å¼‚æ­¥æ¨¡å‹çš„çŠ¶æ€;Promiseåˆ™ä½œç”¨äºå¤–éƒ¨ï¼Œé€šè¿‡then()æ–¹æ³•æš´éœ²ç»™å¤–éƒ¨ä»¥æ·»åŠ è‡ªå®šä¹‰é€»è¾‘ã€‚ Promiseä¸­çš„å¤šå¼‚æ­¥åä½œé€šè¿‡all()æ–¹æ³•æŠ½è±¡å¤šä¸ªå¼‚æ­¥æ“ä½œã€‚åªæœ‰æ‰€æœ‰å¼‚æ­¥æ“ä½œæˆåŠŸï¼Œè¿™ä¸ªå¼‚æ­¥æ“ä½œæ‰ç®—æˆåŠŸï¼Œ ä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå¼‚æ­¥æ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªå¼‚æ­¥æ“ä½œå°±å¤±è´¥ã€‚ Promiseçš„è¿›é˜¶çŸ¥è¯† æ”¯æŒåºåˆ—æ‰§è¡Œçš„Promise 1234567891011promise() .then(obj.api1) .then(obj.api2) .then(obj.api3) .then(obj.api4) .then(function (value4) &#123; // Do something with value4 &#125;, function (error) &#123; // Handle any error from step1 through step4 &#125;) .done(); æ”¹é€ ä¸€ä¸‹ä»£ç ä»¥å®ç°é“¾å¼è°ƒç”¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364var Deferred = function () &#123; this.promise = new Promise();&#125;;// å®Œæˆæ€Deferred.prototype.resolve = function (obj) &#123; var promise = this.promise; var handler; while ((handler = promise.queue.shift())) &#123; if (handler &amp;&amp; handler.fulfilled) &#123; var ret = handler.fulfilled(obj); if (ret &amp;&amp; ret.isPromise) &#123; ret.queue = promise.queue; this.promise = ret; return; &#125; &#125; &#125; &#125;;// å¤±è´¥æ€Deferred.prototype.reject = function (err) &#123; var promise = this.promise; var handler; while ((handler = promise.queue.shift())) &#123; if (handler &amp;&amp; handler.error) &#123; var ret = handler.error(err); if (ret &amp;&amp; ret.isPromise) &#123; ret.queue = promise.queue; this.promise = ret; return; &#125; &#125; &#125;&#125;; // ç”Ÿæˆå›è°ƒå‡½æ•° Deferred.prototype.callback = function () &#123; var that = this; return function (err, file) &#123; if (err) &#123; return that.reject(err); &#125; that.resolve(file); &#125;;&#125;;var Promise = function () &#123; // é˜Ÿåˆ—ç”¨äºå­˜å‚¨å¾…æ‰§è¡Œçš„å›è°ƒå‡½æ•° this.queue = []; this.isPromise = true;&#125;;Promise.prototype.then = function (fulfilledHandler, errorHandler, progressHandler) &#123; var handler = &#123;&#125;; if (typeof fulfilledHandler === 'function') &#123; handler.fulfilled = fulfilledHandler; &#125; if (typeof errorHandler === 'function') &#123; handler.error = errorHandler; &#125; this.queue.push(handler); return this;&#125;; è¯»å–ç¬¬äºŒä¸ªæ–‡ä»¶æ˜¯ä¾ èµ–äºç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹çš„ 123456789101112131415var readFile1 = function (file, encoding) &#123; var deferred = new Deferred(); fs.readFile(file, encoding, deferred.callback()); return deferred.promise;&#125;;var readFile2 = function (file, encoding) &#123; var deferred = new Deferred(); fs.readFile(file, encoding, deferred.callback()); return deferred.promise;&#125;;readFile1('file1.txt', 'utf8').then(function (file1) &#123; return readFile2(file1.trim(), 'utf8');&#125;).then(function (file2) &#123; console.log(file2);&#125;); è¦è®©Promiseæ”¯æŒé“¾å¼æ‰§è¡Œï¼Œä¸»è¦é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ã€‚ (1) å°†æ‰€æœ‰çš„å›è°ƒéƒ½å­˜åˆ°é˜Ÿåˆ—ä¸­ã€‚ (2) Promiseå®Œæˆæ—¶ï¼Œé€ä¸ªæ‰§è¡Œå›è°ƒï¼Œä¸€æ—¦æ£€æµ‹åˆ°è¿”å›äº†æ–°çš„Promiseå¯¹è±¡ï¼Œåœæ­¢æ‰§è¡Œï¼Œç„¶åå°†å½“å‰Deferredå¯¹è±¡çš„promiseå¼•ç”¨æ”¹å˜ä¸ºæ–°çš„Promiseå¯¹è±¡ï¼Œå¹¶å°†é˜Ÿåˆ—ä¸­ä½™ä¸‹çš„å›è°ƒè½¬äº¤ç»™å®ƒã€‚ å°†API PromiseåŒ– å¯ä»¥ æ‰¹é‡å°†æ–¹æ³•PromiseåŒ– 12345678910// smooth(fs.readFile);var smooth = function (method) &#123; return function () &#123; var deferred = new Deferred(); var args = Array.prototype.slice.call(arguments, 0); args.push(deferred.callback()); method.apply(null, args); return deferred.promise; &#125;; &#125;; äºæ˜¯å‰é¢çš„ä¸¤æ¬¡æ–‡ä»¶è¯»å–çš„æ„é€ å¯ä»¥ç®€åŒ–ä¸º: 1var readFile = smooth(fs.readFile); äºæ˜¯ä»£ç é”å‡åˆ°ï¼š 12345var readFile = smooth(fs.readFile); readFile('file1.txt', 'utf8').then(function (file1) &#123; return readFile(file1.trim(), 'utf8'); &#125;).then(function (file2) &#123; // file2 =&gt; I am file2 console.log(file2); &#125;); æµç¨‹æ§åˆ¶åº“1. å°¾è§¦å‘ä¸Nextéœ€è¦æ‰‹å·¥è°ƒç”¨æ‰èƒ½æŒç»­æ‰§è¡Œåç»­è°ƒç”¨çš„ ä¸­é—´ä»¶æœºåˆ¶ä½¿å¾—åœ¨å¤„ç†ç½‘ç»œè¯·æ±‚æ—¶ï¼Œå¯ä»¥åƒé¢å‘åˆ‡é¢ç¼–ç¨‹ä¸€æ ·è¿›è¡Œè¿‡æ»¤ã€éªŒè¯ã€æ—¥å¿—ç­‰åŠŸèƒ½ï¼Œ è€Œä¸ä¸å…·ä½“ä¸šåŠ¡é€»è¾‘äº§ç”Ÿå…³è”ï¼Œä»¥è‡´äº§ç”Ÿè€¦åˆ å°½ç®¡ä¸­é—´ä»¶è¿™ç§å°¾è§¦å‘æ¨¡å¼å¹¶ä¸è¦æ±‚æ¯ä¸ªä¸­é—´æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯å¦‚æœæ¯ ä¸ªæ­¥éª¤éƒ½é‡‡ç”¨å¼‚æ­¥æ¥å®Œæˆï¼Œå®é™…ä¸Šåªæ˜¯ä¸²è¡ŒåŒ–çš„å¤„ç†ï¼Œæ²¡åŠæ³•é€šè¿‡å¹¶è¡Œçš„å¼‚æ­¥è°ƒç”¨æ¥æå‡ä¸šåŠ¡çš„ å¤„ç†æ•ˆç‡ã€‚æµå¼å¤„ç†å¯ä»¥å°†ä¸€äº›ä¸²è¡Œçš„é€»è¾‘æ‰å¹³åŒ–ï¼Œä½†æ˜¯å¹¶è¡Œé€»è¾‘å¤„ç†è¿˜æ˜¯éœ€è¦æ­é…äº‹ä»¶æˆ–è€… Promiseå®Œæˆçš„ï¼Œè¿™æ ·ä¸šåŠ¡åœ¨çºµå‘å’Œæ¨ªå‘éƒ½èƒ½å¤Ÿå„è‡ªæ¸…æ™°ã€‚ åœ¨Connectä¸­ï¼Œå°¾è§¦å‘ååˆ†é€‚åˆå¤„ç†ç½‘ç»œè¯·æ±‚çš„åœºæ™¯ã€‚å°†å¤æ‚çš„å¤„ç†é€»è¾‘æ‹†è§£ä¸ºç®€æ´ã€å•ä¸€ çš„å¤„ç†å•å…ƒï¼Œé€å±‚æ¬¡åœ°å¤„ç†è¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡ã€‚ 2. asyncå¼‚æ­¥çš„ä¸²è¡Œæ‰§è¡Œ12345678910async.series([ function (callback) &#123; fs.readFile('file1.txt', 'utf-8', callback); &#125;, function (callback) &#123; fs.readFile('file2.txt', 'utf-8', callback); &#125;], function (err, results) &#123; // results =&gt; [file1.txt, file2.txt] &#125;); è¿™æ®µä»£ç ç­‰ä»·äº: 1234567891011fs.readFile('file1.txt', 'utf-8', function (err, content) &#123; if (err) &#123; return callback(err); &#125; fs.readFile('file2.txt ', 'utf-8', function (err, data) &#123; if (err) &#123; return callback(err); &#125; callback(null, [content, data]); &#125;);&#125;); series()æ–¹æ³•ä¸­ä¼ å…¥çš„å‡½æ•°callback()å¹¶éç”±ä½¿ç”¨è€…æŒ‡å®šã€‚äº‹å®ä¸Šï¼Œæ­¤å¤„çš„å›è°ƒå‡½æ•°ç”±asyncé€šè¿‡é«˜é˜¶å‡½æ•°çš„æ–¹å¼æ³¨å…¥ï¼Œè¿™é‡Œéšå«äº†ç‰¹æ®Šçš„é€» è¾‘ã€‚æ¯ä¸ªcallback()æ‰§è¡Œæ—¶ä¼šå°†ç»“æœä¿å­˜èµ·æ¥ï¼Œç„¶åæ‰§è¡Œä¸‹ä¸€ä¸ªè°ƒç”¨ï¼Œç›´åˆ°ç»“æŸæ‰€æœ‰è°ƒç”¨ã€‚æœ€ç»ˆçš„å›è°ƒå‡½æ•°æ‰§è¡Œæ—¶ï¼Œé˜Ÿåˆ—é‡Œçš„å¼‚æ­¥è°ƒç”¨ä¿å­˜çš„ç»“æœä»¥æ•°ç»„çš„æ–¹å¼ä¼ å…¥ã€‚è¿™é‡Œçš„å¼‚å¸¸å¤„ç†è§„åˆ™æ˜¯ä¸€ æ—¦å‡ºç°å¼‚å¸¸ï¼Œå°±ç»“æŸæ‰€æœ‰è°ƒç”¨ï¼Œå¹¶å°†å¼‚å¸¸ä¼ é€’ç»™æœ€ç»ˆå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ å¼‚æ­¥çš„å¹¶è¡Œæ‰§è¡Œå½“æˆ‘ä»¬éœ€è¦é€šè¿‡å¹¶è¡Œæ¥æå‡æ€§èƒ½æ—¶ï¼Œasyncæä¾›äº†parallel()æ–¹æ³•ï¼Œç”¨ä»¥å¹¶è¡Œæ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œã€‚ 12345678910async.parallel([ function (callback) &#123; fs.readFile('file1.txt', 'utf-8', callback); &#125;, function (callback) &#123; fs.readFile('file2.txt', 'utf-8', callback); &#125;], function (err, results) &#123; // results =&gt; [file1.txt, file2.txt] &#125;); ä¸Šé¢è¿™æ®µä»£ç ç­‰ä»·äºä¸‹é¢çš„ä»£ç : 123456789101112131415161718192021222324252627282930var counter = 2;var results = [];var done = function (index, value) &#123; results[index] = value; counter--; if (counter === 0) &#123; callback(null, results); &#125;&#125;;// åªä¼ é€’ç¬¬ä¸€ä¸ªå¼‚å¸¸var hasErr = false;var fail = function (err) &#123; if (!hasErr) &#123; hasErr = true; callback(err); &#125; &#125;;fs.readFile('file1.txt', 'utf-8', function (err, content) &#123; if (err) &#123; return fail(err); &#125; done(0, content); &#125;);fs.readFile('file2.txt', 'utf-8', function (err, data) &#123; if (err) &#123; return fail(err); &#125; done(1, data); &#125;); é€šè¿‡asyncç¼–å†™çš„ä»£ç æ—¢æ²¡æœ‰æ·±åº¦çš„åµŒå¥—ï¼Œä¹Ÿæ²¡æœ‰å¤æ‚çš„çŠ¶æ€åˆ¤æ–­ï¼Œå®ƒçš„è¯€çªä¾ç„¶æ¥ è‡ªäºæ³¨å…¥çš„å›è°ƒå‡½æ•° parallel()æ–¹æ³•å¯¹äºå¼‚å¸¸çš„åˆ¤æ–­ä¾ç„¶æ˜¯ä¸€æ—¦æŸä¸ªå¼‚æ­¥è°ƒç”¨äº§ç”Ÿäº†å¼‚å¸¸ï¼Œå°± ä¼šå°†å¼‚å¸¸ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ç»™æœ€ç»ˆçš„å›è°ƒå‡½æ•°ã€‚åªæœ‰æ‰€æœ‰å¼‚æ­¥è°ƒç”¨éƒ½æ­£å¸¸å®Œæˆæ—¶ï¼Œæ‰ä¼šå°†ç»“æœ ä»¥æ•°ç»„çš„æ–¹å¼ä¼ å…¥ã€‚ å¼‚æ­¥è°ƒç”¨çš„ä¾èµ–å¤„ç†series()é€‚åˆæ— ä¾èµ–çš„å¼‚æ­¥ä¸²è¡Œæ‰§è¡Œï¼Œä½†å½“å‰ä¸€ä¸ªçš„ç»“æœæ˜¯åä¸€ä¸ªè°ƒç”¨çš„è¾“å…¥æ—¶ï¼Œseries()æ–¹æ³•å°±æ— æ³•æ»¡è¶³éœ€æ±‚äº† asyncæä¾›äº†waterfall()æ–¹æ³•æ¥æ»¡è¶³ 123456789101112131415161718192021async.waterfall([ function (callback) &#123; fs.readFile('file1.txt', 'utf-8', function (err, content) &#123; callback(err, content); &#125;); &#125;, function (arg1, callback) &#123; // arg1 =&gt; file2.txt fs.readFile(arg1, 'utf-8', function (err, content) &#123; callback(err, content); &#125;); &#125;, function(arg1, callback)&#123; // arg1 =&gt; file3.txt fs.readFile(arg1, 'utf-8', function (err, content) &#123; callback(err, content); &#125;); &#125;], function (err, result) &#123; // result =&gt; file4.txt &#125;); è‡ªåŠ¨ä¾èµ–å¤„ç† auto()æ–¹æ³•èƒ½æ ¹æ®ä¾èµ–å…³ç³»è‡ªåŠ¨åˆ†æï¼Œä»¥æœ€ä½³çš„é¡ºåºæ‰§è¡Œä¸šåŠ¡ 1async.auto(deps); 3. Step1Step(task1, task2, task3); Stepæ¥å—ä»»æ„æ•°é‡çš„ä»»åŠ¡ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½å°†ä¼šä¸²è¡Œä¾æ¬¡æ‰§è¡Œã€‚ 1234567891011Step( function readFile1() &#123; fs.readFile('file1.txt', 'utf-8', this); &#125;, function readFile2(err, content) &#123; fs.readFile('file2.txt', 'utf-8', this); &#125;, function done(err, content) &#123; console.log(content); &#125;); Stepç”¨åˆ°äº†thiså…³é”®å­—ã€‚äº‹å®ä¸Šï¼Œå®ƒæ˜¯Stepå†…éƒ¨çš„ä¸€ä¸ªnext()æ–¹æ³•ï¼Œå°†å¼‚æ­¥è°ƒç”¨çš„ç»“æœä¼ é€’ç»™ä¸‹ä¸€ä¸ªä»»åŠ¡ä½œä¸ºå‚ æ•°ï¼Œå¹¶è°ƒç”¨æ‰§è¡Œã€‚ å¹¶è¡Œä»»åŠ¡æ‰§è¡Œ thiså…·æœ‰ä¸€ä¸ªparallel()æ–¹æ³•ï¼Œå®ƒå‘Šè¯‰Stepï¼Œéœ€è¦ç­‰æ‰€æœ‰ä»»åŠ¡å®Œæˆæ—¶æ‰è¿›è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ 1234567891011Step( function readFile1() &#123; fs.readFile('file1.txt', 'utf-8', this.parallel()); fs.readFile('file2.txt', 'utf-8', this.parallel()); &#125;, function done(err, content1, content2) &#123; // content1 =&gt; file1 // content2 =&gt; file2 console.log(arguments); &#125; ); ä½¿ç”¨parallel()çš„æ—¶å€™éœ€è¦å°å¿ƒçš„æ˜¯ï¼Œå¦‚æœå¼‚æ­¥æ–¹æ³•çš„ç»“æœä¼ å›çš„æ˜¯å¤šä¸ªå‚æ•°ï¼ŒStepå°†åªä¼šå–å‰ä¸¤ä¸ªå‚æ•° Stepçš„parallel()æ–¹æ³•çš„åŸç†æ˜¯æ¯æ¬¡æ‰§è¡Œæ—¶å°†å†…éƒ¨çš„è®¡æ•°å™¨åŠ 1ï¼Œç„¶åè¿”å›ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°åœ¨å¼‚æ­¥è°ƒç”¨ç»“æŸæ—¶æ‰æ‰§è¡Œã€‚å½“å›è°ƒå‡½æ•°æ‰§è¡Œæ—¶ï¼Œå°†è®¡æ•°å™¨å‡1ã€‚å½“è®¡æ•°å™¨ä¸º0çš„æ—¶å€™ï¼Œ å‘ŠçŸ¥Stepæ‰€æœ‰å¼‚æ­¥è°ƒç”¨ç»“æŸäº†ï¼ŒStepä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªæ–¹æ³•ã€‚ Stepä¸asyncç›¸åŒçš„æ˜¯å¼‚å¸¸å¤„ç†ï¼Œä¸€æ—¦æœ‰ä¸€ä¸ªå¼‚å¸¸äº§ç”Ÿï¼Œè¿™ä¸ªå¼‚å¸¸ä¼šä½œä¸ºä¸‹ä¸€ä¸ªæ–¹æ³•çš„ç¬¬ä¸€ä¸ª å‚æ•°ä¼ å…¥ ç»“æœåˆ†ç»„ 12345678910111213141516171819Step( function readDir() &#123; fs.readdir(__dirname, this); &#125;, function readFiles(err, results) &#123; if (err) throw err; // Create a new group var group = this.group(); results.forEach(function (filename) &#123; if (/\\.js$/.test(filename)) &#123; fs.readFile(__dirname + \"/\" + filename, 'utf8', group()); &#125; &#125;); &#125;, function showAll(err, files) &#123; if (err) throw err; console.dir(files); &#125;); æˆ‘ä»¬æ³¨æ„åˆ°æœ‰ä¸¤æ¬¡group()çš„è°ƒç”¨ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯å‘ŠçŸ¥Stepè¦å¹¶è¡Œæ‰§è¡Œï¼Œç¬¬äºŒæ¬¡è°ƒç”¨çš„ç»“æœå°†ä¼šç”Ÿæˆä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè€Œå›è°ƒå‡½æ•°æ¥å—çš„è¿”å›å€¼å°†ä¼šæŒ‰ç»„å­˜å‚¨ã€‚ parallel()ä¼ é€’ç»™ä¸‹ä¸€ä¸ªä»»åŠ¡çš„ ç»“æœæ˜¯å¦‚ä¸‹å½¢å¼: 1function (err, result1, result2, ...); group()ä¼ é€’çš„ç»“æœæ˜¯: 1function (err, results); è¿™ä¸ªå‡½æ•°è¿”å›çš„æ•°æ®ä¿å­˜åœ¨æ•°ç»„ä¸­ã€‚ 4. wind å¼‚æ­¥ä»»åŠ¡å®šä¹‰ 12eval(Wind.compile(\"async\", function() &#123;&#125;));Wind.Async.sleep(20); Wind.compile()ä¼šå°†æ™®é€šçš„å‡½æ•°è¿›è¡Œç¼–è¯‘ï¼Œç„¶åäº¤ç»™eval()æ‰§è¡Œã€‚ eval(Wind.compile(â€œasyncâ€, function () {}));å®šä¹‰äº†å¼‚æ­¥ä»»åŠ¡ã€‚Wind.Async.sleep();å†…ç½®äº†å¯¹setTimeout()çš„å°è£…ã€‚ é™¤äº†é€šè¿‡eval(Wind.compile(â€œasyncâ€, function () {}));å®šä¹‰ä»»åŠ¡å¤–ï¼Œæ­£å¼çš„ä»»åŠ¡åˆ›å»ºæ–¹æ³•ä¸ºTask.create()ã€‚ $await()ä¸ä»»åŠ¡æ¨¡å‹ 1$await() äº‹å®ä¸Šï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿä¸å­˜åœ¨äºä¸Šä¸‹æ–‡ä¸­ï¼Œåªæ˜¯ä¸€ä¸ªç­‰å¾…çš„å ä½ç¬¦ï¼Œå‘Šä¹‹ç¼–è¯‘å™¨è¿™é‡Œéœ€è¦ç­‰å¾…ã€‚ $await()æ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ªä»»åŠ¡å¯¹è±¡ï¼Œè¡¨ç¤ºç­‰å¾…ä»»åŠ¡ç»“æŸåæ‰ä¼šæ‰§è¡Œåç»­æ“ä½œã€‚æ¯ä¸€ä¸ªå¼‚æ­¥ æ“ä½œéƒ½å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªä»»åŠ¡ï¼Œwindæ­£æ˜¯åŸºäºä»»åŠ¡æ¨¡å‹å®ç°çš„ã€‚ windæä¾›äº†whenAll()æ¥å¤„ç†å¹¶å‘ï¼Œé€šè¿‡$awaitå…³é”®å­—å°†ç­‰å¾…é…ç½®çš„æ‰€æœ‰ä»»åŠ¡å®Œæˆåæ‰å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚ 1234567891011var parallel = eval(Wind.compile(\"async\", function () &#123; var result = $await(Task.whenAll(&#123; file1: readFileAsync('file1.txt', 'utf-8'), file2: readFileAsync('file2.txt', 'utf-8') &#125;)); console.log(result.file1); console.log(result.file2); &#125;));parallel().start();//å¾—åˆ°è¾“å‡º:file1 file2 å¼‚æ­¥æ–¹æ³•è½¬æ¢è¾…åŠ©å‡½æ•° è¿™ç§è¿‘åŒæ­¥ç¼–ç¨‹çš„ä½“éªŒéœ€è¦æˆ‘ä»¬é¢å¤– æˆ–è€…æå‰å®Œæˆçš„äº‹æƒ…æ˜¯:å°†å¼‚æ­¥æ–¹æ³•ä»»åŠ¡åŒ–ã€‚ windæä¾›äº†ä¸¤ä¸ª æ–¹æ³•æ¥è¾…åŠ©è½¬æ¢: Wind.Async.Binding.fromCallback ç”¨äºè½¬æ¢è¿™ç±»æ— å¼‚å¸¸çš„å¼‚æ­¥è°ƒç”¨ä¸ºwindä¸­çš„ä»»åŠ¡ Wind.Async.Binding.fromStandard ç”¨äºè½¬æ¢è¿™ç±»å¸¦å¼‚å¸¸çš„å¼‚æ­¥è°ƒç”¨åˆ°windä¸­çš„ä»»åŠ¡ã€‚ å¼‚æ­¥å¹¶å‘æ§åˆ¶åŒæ­¥I/Oå› ä¸ºæ¯ä¸ªI/Oéƒ½æ˜¯å½¼æ­¤é˜»å¡çš„ï¼Œåœ¨å¾ªç¯ä½“ ä¸­ï¼Œæ€»æ˜¯ä¸€ä¸ªæ¥ç€ä¸€ä¸ªè°ƒç”¨ï¼Œä¸ä¼šå‡ºç°è€—ç”¨æ–‡ä»¶æè¿°ç¬¦å¤ªå¤šçš„æƒ…å†µï¼ŒåŒæ—¶æ€§èƒ½ä¹Ÿæ˜¯ä½ä¸‹çš„;å¯¹äº å¼‚æ­¥I/Oï¼Œè™½ç„¶å¹¶å‘å®¹æ˜“å®ç°ï¼Œä½†æ˜¯ç”±äºå¤ªå®¹æ˜“å®ç°ï¼Œä¾ç„¶éœ€è¦æ§åˆ¶ã€‚æ¢è¨€ä¹‹ï¼Œå°½ç®¡æ˜¯è¦å‹æ¦¨åº• å±‚ç³»ç»Ÿçš„æ€§èƒ½ï¼Œä½†è¿˜æ˜¯éœ€è¦ç»™äºˆä¸€å®šçš„è¿‡è½½ä¿æŠ¤ï¼Œä»¥é˜²æ­¢è¿‡çŠ¹ä¸åŠã€‚ bagpipeçš„è§£å†³æ–¹æ¡ˆ é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—æ¥æ§åˆ¶å¹¶å‘é‡ã€‚ å¦‚æœå½“å‰æ´»è·ƒ(æŒ‡è°ƒç”¨å‘èµ·ä½†æœªæ‰§è¡Œå›è°ƒ)çš„å¼‚æ­¥è°ƒç”¨é‡å°äºé™å®šå€¼ï¼Œä»é˜Ÿåˆ—ä¸­å–å‡ºæ‰§è¡Œã€‚ å¦‚æœæ´»è·ƒè°ƒç”¨è¾¾åˆ°é™å®šå€¼ï¼Œè°ƒç”¨æš‚æ—¶å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚ æ¯ä¸ªå¼‚æ­¥è°ƒç”¨ç»“æŸæ—¶ï¼Œä»é˜Ÿåˆ—ä¸­å–å‡ºæ–°çš„å¼‚æ­¥è°ƒç”¨æ‰§è¡Œ ç”¨æˆ·ä¼ å…¥çš„å›è°ƒå‡½æ•°è¢«çœŸæ­£æ‰§è¡Œå‰ï¼Œè¢«å°è£…æ›¿æ¢è¿‡ã€‚è¿™ä¸ªå°è£…çš„å›è°ƒå‡½æ•°å†…éƒ¨çš„é€»è¾‘å°†æ´»è·ƒ å€¼çš„è®¡æ•°å™¨å‡1åï¼Œä¸»åŠ¨è°ƒç”¨next()æ‰§è¡Œåç»­ç­‰å¾…çš„å¼‚æ­¥è°ƒç”¨ã€‚ bagpipeç±»ä¼¼äºæ‰“å¼€äº†ä¸€é“çª—å£ï¼Œå…è®¸å¼‚æ­¥è°ƒç”¨å¹¶è¡Œè¿›è¡Œï¼Œä½†æ˜¯ä¸¥æ ¼é™å®šä¸Šé™ã€‚ä»…ä»…åœ¨è°ƒç”¨ push()æ—¶åˆ†å¼€ä¼ é€’ï¼Œå¹¶ä¸å¯¹åŸæœ‰APIæœ‰ä»»ä½•ä¾µå…¥ã€‚ æ‹’ç»æ¨¡å¼1234// è®¾å®šæœ€å¤§å¹¶å‘æ•°ä¸º10var bagpipe = new Bagpipe(10, &#123; refuse: true &#125;); åœ¨æ‹’ç»æ¨¡å¼ä¸‹ï¼Œå¦‚æœç­‰å¾…çš„è°ƒç”¨é˜Ÿåˆ—ä¹Ÿæ»¡äº†ä¹‹åï¼Œæ–°æ¥çš„è°ƒç”¨å°±ç›´æ¥è¿”ç»™å®ƒä¸€ä¸ªé˜Ÿåˆ—å¤ªå¿™çš„ æ‹’ç»å¼‚å¸¸ã€‚ è¶…æ—¶æ§åˆ¶é€ æˆé˜Ÿåˆ—æ‹¥å¡çš„ä¸»è¦åŸå› æ˜¯å¼‚æ­¥è°ƒç”¨è€—æ—¶å¤ªä¹…ï¼Œè°ƒç”¨äº§ç”Ÿçš„é€Ÿåº¦è¿œè¿œé«˜äºæ‰§è¡Œçš„é€Ÿåº¦ã€‚ä¸ºäº†é˜²æ­¢æŸäº›å¼‚æ­¥è°ƒç”¨ä½¿ç”¨äº†å¤ªå¤šçš„æ—¶é—´ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªæ—¶é—´åŸºçº¿ï¼Œå°†é‚£äº›æ‰§è¡Œæ—¶é—´å¤ªä¹…çš„å¼‚æ­¥è°ƒç”¨ æ¸…ç†å‡ºæ´»è·ƒé˜Ÿåˆ—ï¼Œè®©æ’é˜Ÿä¸­çš„å¼‚æ­¥è°ƒç”¨å°½å¿«æ‰§è¡Œã€‚å¦åˆ™åœ¨æ‹’ç»æ¨¡å¼ä¸‹ï¼Œä¼šæœ‰å¤ªå¤šçš„è°ƒç”¨å› ä¸ºæŸä¸ªæ‰§ è¡Œå¾—æ…¢ï¼Œå¯¼è‡´å¾—åˆ°æ‹’ç»å¼‚å¸¸ã€‚ è¶…æ—¶æ§åˆ¶æ˜¯ä¸ºå¼‚æ­¥è°ƒç”¨è®¾ç½®ä¸€ä¸ªæ—¶é—´é˜ˆå€¼ï¼Œå¦‚æœå¼‚æ­¥è°ƒç”¨ æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…å®Œæˆï¼Œæˆ‘ä»¬å…ˆæ‰§è¡Œç”¨æˆ·ä¼ å…¥çš„å›è°ƒå‡½æ•°ï¼Œè®©ç”¨æˆ·å¾—åˆ°ä¸€ä¸ªè¶…æ—¶å¼‚å¸¸ï¼Œä»¥å°½æ—©è¿” å›ã€‚ç„¶åè®©ä¸‹ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ä¸­çš„è°ƒç”¨æ‰§è¡Œã€‚ 1234// è®¾å®šæœ€å¤§å¹¶å‘æ•°ä¸º10var bagpipe = new Bagpipe(10, &#123; timeout: 3000 &#125;); asyncçš„è§£å†³æ–¹æ¡ˆasyncä¹Ÿæä¾›äº†ä¸€ä¸ªæ–¹æ³•ç”¨äºå¤„ç†å¼‚æ­¥è°ƒç”¨çš„é™åˆ¶:parallelLimit() 12345678910async.parallelLimit([ function (callback) &#123; fs.readFile('file1.txt', 'utf-8', callback); &#125;, function (callback) &#123; fs.readFile('file2.txt', 'utf-8', callback); &#125;], 1, function (err, results) &#123; // TODO &#125;); parallelLimit()ä¸parallel()ç±»ä¼¼ï¼Œä½†å¤šäº†ä¸€ä¸ªç”¨äºé™åˆ¶å¹¶å‘æ•°é‡çš„å‚æ•°ï¼Œä½¿å¾—ä»»åŠ¡åªèƒ½åŒ æ—¶å¹¶å‘ä¸€å®šæ•°é‡ï¼Œè€Œä¸æ˜¯æ— é™åˆ¶å¹¶å‘ã€‚ parallelLimit()æ–¹æ³•çš„ç¼ºé™·åœ¨äºæ— æ³•åŠ¨æ€åœ°å¢åŠ å¹¶è¡Œä»»åŠ¡ã€‚asyncæä¾›äº†queue()æ–¹æ³• æ¥æ»¡è¶³è¯¥éœ€æ±‚. 1234567891011var q = async.queue(function (file, callback) &#123; fs.readFile(file, 'utf-8', callback);&#125;,2);q.drain=function()&#123; // å®Œæˆäº†é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡ &#125;;fs.readdirSync('.').forEach(function (file) &#123; q.push(file, function (err, data) &#123; // TODO &#125;);&#125;); å°½ç®¡queue()å®ç°äº†åŠ¨æ€æ·»åŠ å¹¶è¡Œä»»åŠ¡ï¼Œä½†æ˜¯ç›¸æ¯”parallelLimit()ï¼Œç”±äºqueue()æ¥æ”¶çš„å‚æ•°æ˜¯å›ºå®šçš„ï¼Œå®ƒä¸¢å¤±äº†parallelLimit()çš„å¤šæ ·æ€§ ç¬¬äº”ç«  å†…å­˜æ§åˆ¶V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸å†…å­˜é™åˆ¶V8 çš„å†…å­˜é™åˆ¶åœ¨Nodeä¸­é€šè¿‡JavaScript ä½¿ç”¨å†…å­˜æ—¶å°±ä¼šå‘ç°åªèƒ½ä½¿ç”¨éƒ¨åˆ†å†…å­˜(64ä½ç³»ç»Ÿä¸‹çº¦ä¸º1.4 GBï¼Œ32ä½ç³»ç»Ÿä¸‹çº¦ä¸º0.7 GB)ã€‚åœ¨ è¿™æ ·çš„é™åˆ¶ä¸‹ï¼Œå°†ä¼šå¯¼è‡´Nodeæ— æ³•ç›´æ¥æ“ä½œå¤§å†…å­˜å¯¹è±¡ã€‚ é€ æˆè¿™ä¸ªé—®é¢˜çš„ä¸»è¦åŸå› åœ¨äºNodeåŸºäºV8æ„å»ºï¼Œæ‰€ä»¥åœ¨Nodeä¸­ä½¿ç”¨çš„JavaScriptå¯¹è±¡åŸºæœ¬ä¸Š éƒ½æ˜¯é€šè¿‡V8è‡ªå·±çš„æ–¹å¼æ¥è¿›è¡Œåˆ†é…å’Œç®¡ç†çš„ã€‚V8çš„è¿™å¥—å†…å­˜ç®¡ç†æœºåˆ¶åœ¨æµè§ˆå™¨çš„åº”ç”¨åœºæ™¯ä¸‹ä½¿ ç”¨èµ·æ¥ç»°ç»°æœ‰ä½™ï¼Œè¶³ä»¥èƒœä»»å‰ç«¯é¡µé¢ä¸­çš„æ‰€æœ‰éœ€æ±‚ã€‚ä½†åœ¨Nodeä¸­ï¼Œè¿™å´é™åˆ¶äº†å¼€å‘è€…éšå¿ƒæ‰€æ¬²ä½¿ ç”¨å¤§å†…å­˜çš„æƒ³æ³•ã€‚ V8 çš„å¯¹è±¡åˆ†é…å†…å­˜ä½¿ç”¨é‡çš„æŸ¥çœ‹åœ¨V8ä¸­ï¼Œæ‰€æœ‰çš„JavaScriptå¯¹è±¡éƒ½æ˜¯é€šè¿‡å †æ¥è¿›è¡Œåˆ†é…çš„ã€‚Nodeæä¾›äº†V8ä¸­å†…å­˜ä½¿ç”¨é‡çš„æŸ¥ çœ‹æ–¹å¼ï¼Œæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå°†å¾—åˆ°è¾“å‡ºçš„å†…å­˜ä¿¡æ¯: 123456$ node&gt; process.memoryUsage(); &#123; rss: 14958592, heapTotal: 7195904, heapUsed: 2821496 &#125; heapTotalå’ŒheapUsedæ˜¯V8çš„å †å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå‰è€…æ˜¯å·²ç”³è¯·åˆ°çš„å †å†…å­˜ï¼Œåè€…æ˜¯å½“å‰ä½¿ç”¨çš„é‡ã€‚ å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­å£°æ˜å˜é‡å¹¶èµ‹å€¼æ—¶ï¼Œæ‰€ä½¿ç”¨å¯¹è±¡çš„å†…å­˜å°±åˆ†é…åœ¨å †ä¸­ã€‚å¦‚æœå·²ç”³è¯·çš„å †ç©ºé—² å†…å­˜ä¸å¤Ÿåˆ†é…æ–°çš„å¯¹è±¡ï¼Œå°†ç»§ç»­ç”³è¯·å †å†…å­˜ï¼Œç›´åˆ°å †çš„å¤§å°è¶…è¿‡V8çš„é™åˆ¶ä¸ºæ­¢ã€‚ V8é™åˆ¶å †å¤§å°çš„åŸå› ä»¥1.5 GBçš„åƒåœ¾å›æ”¶å †å†…å­˜ä¸ºä¾‹ï¼ŒV8åšä¸€æ¬¡å°çš„åƒåœ¾å›æ”¶éœ€è¦50æ¯«ç§’ä»¥ä¸Šï¼Œåšä¸€ æ¬¡éå¢é‡å¼çš„åƒåœ¾å›æ”¶ç”šè‡³è¦1ç§’ä»¥ä¸Šã€‚è¿™æ˜¯åƒåœ¾å›æ”¶ä¸­å¼•èµ·JavaScriptçº¿ç¨‹æš‚åœæ‰§è¡Œçš„æ—¶é—´ï¼Œåœ¨ è¿™æ ·çš„æ—¶é—´èŠ±é”€ä¸‹ï¼Œåº”ç”¨çš„æ€§èƒ½å’Œå“åº”èƒ½åŠ›éƒ½ä¼šç›´çº¿ä¸‹é™ã€‚è¿™æ ·çš„æƒ…å†µä¸ä»…ä»…åç«¯æœåŠ¡æ— æ³•æ¥å—ï¼Œ å‰ç«¯æµè§ˆå™¨ä¹Ÿæ— æ³•æ¥å—ã€‚å› æ­¤ï¼Œåœ¨å½“æ—¶çš„è€ƒè™‘ä¸‹ç›´æ¥é™åˆ¶å †å†…å­˜æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚ è°ƒæ•´å†…å­˜é™åˆ¶çš„å¤§å°123node --max-old-space-size=1700 test.js // å•ä½ä¸ºMB // æˆ–è€…node --max-new-space-size=1024 test.js // å•ä½ä¸ºKB V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶V8ä¸»è¦çš„åƒåœ¾å›æ”¶ç®—æ³•V8çš„åƒåœ¾å›æ”¶ç­–ç•¥ä¸»è¦åŸºäºåˆ†ä»£å¼åƒåœ¾å›æ”¶æœºåˆ¶ V8çš„å†…å­˜åˆ†ä»£ åœ¨V8ä¸­ï¼Œä¸»è¦å°†å†…å­˜åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ä¸¤ä»£ã€‚æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸ºå­˜æ´»æ—¶é—´è¾ƒçŸ­çš„å¯¹è±¡ï¼Œè€ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸ºå­˜æ´»æ—¶é—´è¾ƒé•¿æˆ–å¸¸é©»å†…å­˜çš„å¯¹è±¡ã€‚ V8å †çš„æ•´ä½“å¤§å°å°±æ˜¯æ–°ç”Ÿä»£æ‰€ç”¨å†…å­˜ç©ºé—´åŠ ä¸Šè€ç”Ÿä»£çš„å†…å­˜ç©ºé—´ã€‚å‰é¢æˆ‘ä»¬æåŠçš„ â€“max-old-space-sizeå‘½ä»¤è¡Œå‚æ•°å¯ä»¥ç”¨äºè®¾ç½®è€ç”Ÿä»£å†…å­˜ç©ºé—´çš„æœ€å¤§å€¼ï¼Œâ€“max-new-space-size å‘½ä»¤è¡Œå‚æ•°åˆ™ç”¨äºè®¾ç½®æ–°ç”Ÿä»£å†…å­˜ç©ºé—´çš„å¤§å°çš„ã€‚æ¯”è¾ƒé—æ†¾çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªæœ€å¤§å€¼éœ€è¦åœ¨å¯åŠ¨æ—¶å°± æŒ‡å®šã€‚è¿™æ„å‘³ç€V8ä½¿ç”¨çš„å†…å­˜æ²¡æœ‰åŠæ³•æ ¹æ®ä½¿ç”¨æƒ…å†µè‡ªåŠ¨æ‰©å……ï¼Œå½“å†…å­˜åˆ†é…è¿‡ç¨‹ä¸­è¶…è¿‡æé™å€¼ æ—¶ï¼Œå°±ä¼šå¼•èµ·è¿›ç¨‹å‡ºé”™ã€‚ å¯¹äºæ–°ç”Ÿä»£å†…å­˜ï¼Œå®ƒç”±ä¸¤ä¸ªreserved_semispace_size_æ‰€æ„æˆ.æŒ‰æœºå™¨ä½æ•°ä¸åŒï¼Œreserved_semispace_size_åœ¨64ä½ç³»ç»Ÿå’Œ32ä½ç³»ç»Ÿä¸Šåˆ†åˆ«ä¸º16 MBå’Œ8 MBã€‚æ‰€ä»¥æ–°ç”Ÿ ä»£å†…å­˜çš„æœ€å¤§å€¼åœ¨64ä½ç³»ç»Ÿå’Œ32ä½ç³»ç»Ÿä¸Šåˆ†åˆ«ä¸º32 MBå’Œ16 MBã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒV8å †å†…å­˜çš„æœ€å¤§å€¼åœ¨64ä½ç³»ç»Ÿä¸Šä¸º1464 MBï¼Œ32ä½ç³»ç»Ÿä¸Šåˆ™ä¸º732 MBã€‚ è¿™ä¸ªæ•°å€¼å¯ä»¥è§£é‡Šä¸ºä½•åœ¨64ä½ç³»ç»Ÿä¸‹åªèƒ½ä½¿ç”¨çº¦1.4 GBå†…å­˜å’Œåœ¨32ä½ç³»ç»Ÿä¸‹åªèƒ½ä½¿ç”¨çº¦0.7 GB å†…å­˜ã€‚ Scavengeç®—æ³• æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸»è¦é€šè¿‡Scavengeç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ã€‚åœ¨Scavengeçš„å…·ä½“å®ç°ä¸­ï¼Œä¸»è¦é‡‡ç”¨äº†Cheneyç®—æ³•ã€‚ Cheneyç®—æ³•æ˜¯ä¸€ç§é‡‡ç”¨å¤åˆ¶çš„æ–¹å¼å®ç°çš„åƒåœ¾å›æ”¶ç®—æ³•ã€‚å®ƒå°†å †å†…å­˜ä¸€åˆ†ä¸ºäºŒï¼Œæ¯ä¸€éƒ¨åˆ†ç©ºé—´ç§°ä¸ºsemispaceã€‚åœ¨è¿™ä¸¤ä¸ªsemispaceç©ºé—´ä¸­ï¼Œåªæœ‰ä¸€ä¸ªå¤„äºä½¿ç”¨ä¸­ï¼Œå¦ä¸€ä¸ªå¤„äºé—²ç½®çŠ¶æ€ã€‚å¤„ äºä½¿ç”¨çŠ¶æ€çš„semispaceç©ºé—´ç§°ä¸ºFromç©ºé—´ï¼Œå¤„äºé—²ç½®çŠ¶æ€çš„ç©ºé—´ç§°ä¸ºToç©ºé—´ã€‚å½“æˆ‘ä»¬åˆ†é…å¯¹è±¡ æ—¶ï¼Œå…ˆæ˜¯åœ¨Fromç©ºé—´ä¸­è¿›è¡Œåˆ†é…ã€‚å½“å¼€å§‹è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¼šæ£€æŸ¥Fromç©ºé—´ä¸­çš„å­˜æ´»å¯¹è±¡ï¼Œè¿™ äº›å­˜æ´»å¯¹è±¡å°†è¢«å¤åˆ¶åˆ°Toç©ºé—´ä¸­ï¼Œè€Œéå­˜æ´»å¯¹è±¡å ç”¨çš„ç©ºé—´å°†ä¼šè¢«é‡Šæ”¾ã€‚å®Œæˆå¤åˆ¶åï¼ŒFromç©º é—´å’ŒToç©ºé—´çš„è§’è‰²å‘ç”Ÿå¯¹æ¢ã€‚ç®€è€Œè¨€ä¹‹ï¼Œåœ¨åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå°±æ˜¯é€šè¿‡å°†å­˜æ´»å¯¹è±¡åœ¨ä¸¤ä¸ª semispaceç©ºé—´ä¹‹é—´è¿›è¡Œå¤åˆ¶ã€‚ Scavengeçš„ç¼ºç‚¹æ˜¯åªèƒ½ä½¿ç”¨å †å†…å­˜ä¸­çš„ä¸€åŠï¼Œè¿™æ˜¯ç”±åˆ’åˆ†ç©ºé—´å’Œå¤åˆ¶æœºåˆ¶æ‰€å†³å®šçš„ã€‚ä½† Scavengeç”±äºåªå¤åˆ¶å­˜æ´»çš„å¯¹è±¡ï¼Œå¹¶ä¸”å¯¹äºç”Ÿå‘½å‘¨æœŸçŸ­çš„åœºæ™¯å­˜æ´»å¯¹è±¡åªå å°‘éƒ¨åˆ†ï¼Œæ‰€ä»¥å®ƒåœ¨æ—¶ é—´æ•ˆç‡ä¸Šæœ‰ä¼˜å¼‚çš„è¡¨ç°ã€‚ å½“ä¸€ä¸ªå¯¹è±¡ç»è¿‡å¤šæ¬¡å¤åˆ¶ä¾ç„¶å­˜æ´»æ—¶ï¼Œå®ƒå°†ä¼šè¢«è®¤ä¸ºæ˜¯ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡ã€‚è¿™ç§è¾ƒé•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡éšåä¼šè¢«ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­ï¼Œé‡‡ç”¨æ–°çš„ç®—æ³•è¿›è¡Œç®¡ç†ã€‚å¯¹è±¡ä»æ–°ç”Ÿä»£ä¸­ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­ çš„è¿‡ç¨‹ç§°ä¸ºæ™‹å‡ã€‚ åœ¨åˆ†ä»£å¼åƒåœ¾å›æ”¶çš„å‰æä¸‹ï¼ŒFromç©ºé—´ä¸­çš„å­˜æ´»å¯¹ è±¡åœ¨å¤åˆ¶åˆ°Toç©ºé—´ä¹‹å‰éœ€è¦è¿›è¡Œæ£€æŸ¥ã€‚åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œéœ€è¦å°†å­˜æ´»å‘¨æœŸé•¿çš„å¯¹è±¡ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­ï¼Œ ä¹Ÿå°±æ˜¯å®Œæˆå¯¹è±¡æ™‹å‡ã€‚ å¯¹è±¡æ™‹å‡çš„æ¡ä»¶ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å¯¹è±¡æ˜¯å¦ç»å†è¿‡Scavengeå›æ”¶ï¼Œä¸€ä¸ªæ˜¯Toç©ºé—´çš„å†…å­˜å ç”¨æ¯”è¶…è¿‡é™åˆ¶ã€‚å½“è¦ä»Fromç©ºé—´å¤åˆ¶ä¸€ä¸ªå¯¹è±¡åˆ°Toç©ºé—´æ—¶ï¼Œå¦‚æœ Toç©ºé—´å·²ç»ä½¿ç”¨äº†è¶…è¿‡25%ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡ç›´æ¥æ™‹å‡åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ ï¼ˆè®¾ç½®25%è¿™ä¸ªé™åˆ¶å€¼çš„åŸå› æ˜¯å½“è¿™æ¬¡Scavengeå›æ”¶å®Œæˆåï¼Œè¿™ä¸ªToç©ºé—´å°†å˜æˆFromç©ºé—´ï¼Œæ¥ ä¸‹æ¥çš„å†…å­˜åˆ†é…å°†åœ¨è¿™ä¸ªç©ºé—´ä¸­è¿›è¡Œã€‚å¦‚æœå æ¯”è¿‡é«˜ï¼Œä¼šå½±å“åç»­çš„å†…å­˜åˆ†é…ã€‚ï¼‰ Mark-Sweep &amp; Mark-Compact Mark-Sweepåœ¨æ ‡è®°é˜¶æ®µéå†å †ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œå¹¶æ ‡è®°æ´»ç€çš„å¯¹è±¡ï¼Œåœ¨éšåçš„æ¸…é™¤é˜¶æ®µä¸­ï¼Œåªæ¸…é™¤æ²¡æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚Scavengeä¸­åªå¤åˆ¶æ´»ç€çš„å¯¹è±¡ï¼Œè€ŒMark-Sweepåªæ¸…ç†æ­»äº¡å¯¹è±¡ã€‚ Mark-Sweepæœ€å¤§çš„é—®é¢˜æ˜¯åœ¨è¿›è¡Œä¸€æ¬¡æ ‡è®°æ¸…é™¤å›æ”¶åï¼Œå†…å­˜ç©ºé—´ä¼šå‡ºç°ä¸è¿ç»­çš„çŠ¶æ€ã€‚è¿™ç§ å†…å­˜ç¢ç‰‡ä¼šå¯¹åç»­çš„å†…å­˜åˆ†é…é€ æˆé—®é¢˜ï¼Œå› ä¸ºå¾ˆå¯èƒ½å‡ºç°éœ€è¦åˆ†é…ä¸€ä¸ªå¤§å¯¹è±¡çš„æƒ…å†µï¼Œè¿™æ—¶æ‰€æœ‰ çš„ç¢ç‰‡ç©ºé—´éƒ½æ— æ³•å®Œæˆæ­¤æ¬¡åˆ†é…ï¼Œå°±ä¼šæå‰è§¦å‘åƒåœ¾å›æ”¶ï¼Œè€Œè¿™æ¬¡å›æ”¶æ˜¯ä¸å¿…è¦çš„ã€‚ åœ¨æ•´ç†çš„ è¿‡ç¨‹ä¸­ï¼Œå°†æ´»ç€çš„å¯¹è±¡å¾€ä¸€ç«¯ç§»åŠ¨ï¼Œç§»åŠ¨å®Œæˆåï¼Œç›´æ¥æ¸…ç†æ‰è¾¹ç•Œå¤–çš„å†…å­˜ã€‚ V8ä¸»è¦ä½¿ç”¨Mark-Sweepï¼Œåœ¨ç©ºé—´ä¸è¶³ä»¥å¯¹ä»æ–° ç”Ÿä»£ä¸­æ™‹å‡è¿‡æ¥çš„å¯¹è±¡è¿›è¡Œåˆ†é…æ—¶æ‰ä½¿ç”¨Mark-Compactã€‚ Incremental Marking ä¸ºäº†é¿å…å‡ºç°JavaScriptåº”ç”¨é€»è¾‘ä¸åƒåœ¾å›æ”¶å™¨çœ‹åˆ°çš„ä¸ä¸€è‡´çš„æƒ…å†µï¼Œåƒåœ¾å›æ”¶çš„3ç§åŸºæœ¬ç®—æ³•éƒ½éœ€è¦å°†åº”ç”¨é€»è¾‘æš‚åœä¸‹æ¥ï¼Œå¾…æ‰§è¡Œå®Œåƒåœ¾å›æ”¶åå†æ¢å¤æ‰§è¡Œåº”ç”¨é€»è¾‘ï¼Œè¿™ç§è¡Œä¸ºè¢«ç§°ä¸ºâ€œå…¨ åœé¡¿â€(stop-the-world)ã€‚ ä¸ºäº†é™ä½å…¨å †åƒåœ¾å›æ”¶å¸¦æ¥çš„åœé¡¿æ—¶é—´ï¼ŒV8å…ˆä»æ ‡è®°é˜¶æ®µå…¥æ‰‹ï¼Œå°†åŸæœ¬è¦ä¸€å£æ°”åœé¡¿å®Œæˆ çš„åŠ¨ä½œæ”¹ä¸ºå¢é‡æ ‡è®°(incremental marking)ï¼Œä¹Ÿå°±æ˜¯æ‹†åˆ†ä¸ºè®¸å¤šå°â€œæ­¥è¿›â€ï¼Œæ¯åšå®Œä¸€â€œæ­¥è¿›â€ å°±è®©JavaScriptåº”ç”¨é€»è¾‘æ‰§è¡Œä¸€å°ä¼šå„¿ï¼Œåƒåœ¾å›æ”¶ä¸åº”ç”¨é€»è¾‘äº¤æ›¿æ‰§è¡Œç›´åˆ°æ ‡è®°é˜¶æ®µå®Œæˆã€‚ V8åœ¨ç»è¿‡å¢é‡æ ‡è®°çš„æ”¹è¿›åï¼Œåƒåœ¾å›æ”¶çš„æœ€å¤§åœé¡¿æ—¶é—´å¯ä»¥å‡å°‘åˆ°åŸæœ¬çš„1/6å·¦å³ã€‚ V8åç»­è¿˜å¼•å…¥äº†å»¶è¿Ÿæ¸…ç†(lazy sweeping)ä¸å¢é‡å¼æ•´ç†(incremental compaction)ï¼Œè®©æ¸… ç†ä¸æ•´ç†åŠ¨ä½œä¹Ÿå˜æˆå¢é‡å¼çš„ã€‚åŒæ—¶è¿˜è®¡åˆ’å¼•å…¥å¹¶è¡Œæ ‡è®°ä¸å¹¶è¡Œæ¸…ç†ï¼Œè¿›ä¸€æ­¥åˆ©ç”¨å¤šæ ¸æ€§èƒ½é™ä½ æ¯æ¬¡åœé¡¿çš„æ—¶é—´ã€‚ æŸ¥çœ‹åƒåœ¾å›æ”¶æ—¥å¿—æŸ¥çœ‹åƒåœ¾å›æ”¶æ—¥å¿—çš„æ–¹å¼ä¸»è¦æ˜¯åœ¨å¯åŠ¨æ—¶æ·»åŠ â€“trace_gcå‚æ•°ã€‚åœ¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œå°†ä¼šä» æ ‡å‡†è¾“å‡ºä¸­æ‰“å°åƒåœ¾å›æ”¶çš„æ—¥å¿—ä¿¡æ¯ã€‚é€šè¿‡åˆ†æåƒåœ¾å›æ”¶æ—¥å¿—ï¼Œå¯ä»¥äº†è§£åƒåœ¾å›æ”¶çš„è¿è¡ŒçŠ¶å†µï¼Œæ‰¾å‡ºåƒåœ¾å›æ”¶çš„å“ªäº›é˜¶æ®µæ¯”è¾ƒè€—æ—¶ï¼Œ è§¦å‘çš„åŸå› æ˜¯ä»€ä¹ˆã€‚ é€šè¿‡åœ¨Nodeå¯åŠ¨æ—¶ä½¿ç”¨â€“profå‚æ•°ï¼Œå¯ä»¥å¾—åˆ°V8æ‰§è¡Œæ—¶çš„æ€§èƒ½åˆ†ææ•°æ®ï¼Œå…¶ä¸­åŒ…å«äº†åƒåœ¾ å›æ”¶æ‰§è¡Œæ—¶å ç”¨çš„æ—¶é—´ã€‚ ï¼ˆV8æä¾›äº†linux-tick-processorå·¥å…·ç”¨äºç»Ÿè®¡æ—¥å¿—ä¿¡æ¯ã€‚è¯¥å·¥å…·å¯ä»¥ä»Nodeæºç çš„ deps/v8/toolsç›®å½•ä¸‹æ‰¾åˆ°ï¼ŒWindowsä¸‹çš„å¯¹åº”å‘½ä»¤æ–‡ä»¶ä¸ºwindows-tick-processor.batã€‚å°†è¯¥ç›®å½•æ·» åŠ åˆ°ç¯å¢ƒå˜é‡PATHä¸­ï¼Œå³å¯ç›´æ¥è°ƒç”¨ï¼‰ é«˜æ•ˆä½¿ç”¨å†…å­˜ä½œç”¨åŸŸ1. æ ‡è¯†ç¬¦æŸ¥æ‰¾æ ‡è¯†ç¬¦ï¼Œå¯ä»¥ç†è§£ä¸ºå˜é‡åã€‚ 2. ä½œç”¨åŸŸé“¾JavaScriptåœ¨æ‰§è¡Œæ—¶ä¼šå»æŸ¥æ‰¾è¯¥å˜é‡å®šä¹‰åœ¨å“ªé‡Œã€‚å®ƒæœ€å…ˆæŸ¥æ‰¾çš„æ˜¯å½“å‰ä½œç”¨åŸŸï¼Œå¦‚æœåœ¨å½“å‰ä½œ ç”¨åŸŸä¸­æ— æ³•æ‰¾åˆ°è¯¥å˜é‡çš„å£°æ˜ï¼Œå°†ä¼šå‘ä¸Šçº§çš„ä½œç”¨åŸŸé‡ŒæŸ¥æ‰¾ï¼Œç›´åˆ°æŸ¥åˆ°ä¸ºæ­¢ã€‚è¿™æ ·çš„æŸ¥æ‰¾æ–¹å¼ä½¿å¾—ä½œ ç”¨åŸŸåƒä¸€ä¸ªé“¾æ¡ã€‚ç”±äºæ ‡è¯†ç¬¦çš„æŸ¥æ‰¾æ–¹å‘æ˜¯å‘ä¸Šçš„ï¼Œæ‰€ä»¥å˜é‡åªèƒ½å‘å¤–è®¿é—®ï¼Œè€Œä¸èƒ½å‘å†…è®¿é—®ã€‚ 3. å˜é‡çš„ä¸»åŠ¨é‡Šæ”¾ å¦‚æœå˜é‡æ˜¯å…¨å±€å˜é‡(ä¸é€šè¿‡varå£°æ˜æˆ–å®šä¹‰åœ¨globalå˜é‡ä¸Š)ï¼Œç”±äºå…¨å±€ä½œç”¨åŸŸéœ€è¦ç›´åˆ° è¿›ç¨‹é€€å‡ºæ‰èƒ½é‡Šæ”¾ï¼Œæ­¤æ—¶å°†å¯¼è‡´å¼•ç”¨çš„å¯¹è±¡å¸¸é©»å†…å­˜(å¸¸é©»åœ¨è€ç”Ÿä»£ä¸­)ã€‚å¦‚æœéœ€è¦é‡Šæ”¾å¸¸é©»å†… å­˜çš„å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡deleteæ“ä½œæ¥åˆ é™¤å¼•ç”¨å…³ç³»ã€‚æˆ–è€…å°†å˜é‡é‡æ–°èµ‹å€¼ï¼Œè®©æ—§çš„å¯¹è±¡è„±ç¦»å¼•ç”¨å…³ç³»ã€‚åœ¨æ¥ä¸‹æ¥çš„è€ç”Ÿä»£å†…å­˜æ¸…é™¤å’Œæ•´ç†çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè¢«å›æ”¶é‡Šæ”¾ã€‚ åœ¨éå…¨å±€ä½œç”¨åŸŸä¸­ï¼Œæƒ³ä¸»åŠ¨é‡Šæ”¾å˜é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼ã€‚ è™½ç„¶ deleteæ“ä½œå’Œé‡æ–°èµ‹å€¼å…·æœ‰ç›¸åŒçš„æ•ˆæœï¼Œä½†æ˜¯åœ¨V8ä¸­é€šè¿‡deleteåˆ é™¤å¯¹è±¡çš„å±æ€§æœ‰å¯èƒ½å¹²æ‰°V8 çš„ä¼˜åŒ–ï¼Œæ‰€ä»¥é€šè¿‡èµ‹å€¼æ–¹å¼è§£é™¤å¼•ç”¨æ›´å¥½ã€‚ é—­åŒ…å®ç°å¤–éƒ¨ä½œç”¨åŸŸè®¿é—®å†…éƒ¨ä½œç”¨åŸŸä¸­å˜é‡çš„æ–¹æ³•å«åšé—­åŒ…(closure) è¿™å¾—ç›Š äºé«˜é˜¶å‡½æ•°çš„ç‰¹æ€§:å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼ã€‚ ä¸€æ—¦æœ‰å˜é‡å¼•ç”¨è¿™ä¸ªä¸­é—´å‡½æ•°ï¼Œè¿™ä¸ªä¸­é—´å‡½æ•°å°†ä¸ä¼šé‡Šæ”¾ï¼ŒåŒæ—¶ä¹Ÿä¼šä½¿åŸå§‹çš„ä½œç”¨åŸŸä¸ä¼šå¾—åˆ°é‡Šæ”¾ï¼Œä½œç”¨åŸŸ ä¸­äº§ç”Ÿçš„å†…å­˜å ç”¨ä¹Ÿä¸ä¼šå¾—åˆ°é‡Šæ”¾ã€‚é™¤éä¸å†æœ‰å¼•ç”¨ï¼Œæ‰ä¼šé€æ­¥é‡Šæ”¾ã€‚ å†…å­˜æŒ‡æ ‡osæ¨¡å—ä¸­çš„ totalmem()å’Œfreemem()æ–¹æ³•ä¹Ÿå¯ä»¥æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ1. æŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜å ç”¨è°ƒç”¨process.memoryUsage()å¯ä»¥çœ‹åˆ°Nodeè¿›ç¨‹çš„å†…å­˜å ç”¨æƒ…å†µ 123456$ node&gt; process.memoryUsage() &#123; rss: 13852672, heapTotal: 6131200, heapUsed: 2757120 &#125; rssæ˜¯resident set sizeçš„ç¼©å†™ï¼Œå³è¿›ç¨‹çš„å¸¸é©»å†…å­˜éƒ¨åˆ†ã€‚è¿›ç¨‹çš„å†…å­˜æ€»å…±æœ‰å‡ éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ rssï¼Œå…¶ä½™éƒ¨åˆ†åœ¨äº¤æ¢åŒº(swap)æˆ–è€…æ–‡ä»¶ç³»ç»Ÿ(filesystem)ä¸­ã€‚ é™¤äº†rsså¤–ï¼ŒheapTotalå’ŒheapUsedå¯¹åº”çš„æ˜¯V8çš„å †å†…å­˜ä¿¡æ¯ã€‚heapTotalæ˜¯å †ä¸­æ€»å…±ç”³è¯·çš„å†… å­˜é‡ï¼ŒheapUsedè¡¨ç¤ºç›®å‰å †ä¸­ä½¿ç”¨ä¸­çš„å†…å­˜é‡ã€‚è¿™3ä¸ªå€¼çš„å•ä½éƒ½æ˜¯å­—èŠ‚ã€‚ 2. æŸ¥çœ‹ç³»ç»Ÿçš„å†…å­˜å ç”¨osæ¨¡å—ä¸­çš„totalmem()å’Œfreemem()è¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºæŸ¥çœ‹æ“ä½œç³»ç»Ÿçš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå®ƒä»¬åˆ†åˆ«è¿”å›ç³»ç»Ÿçš„æ€»å†…å­˜å’Œé—²ç½®å†…å­˜ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ 123456$ node&gt; os.totalmem() 8589934592&gt; os.freemem() 4527833088&gt; å †å¤–å†…å­˜å †ä¸­çš„å†…å­˜ç”¨é‡æ€»æ˜¯å°äºè¿›ç¨‹çš„å¸¸é©»å†…å­˜ç”¨ é‡ï¼Œè¿™æ„å‘³ç€Nodeä¸­çš„å†…å­˜ä½¿ç”¨å¹¶ééƒ½æ˜¯é€šè¿‡V8è¿›è¡Œåˆ†é…çš„ã€‚æˆ‘ä»¬å°†é‚£äº›ä¸æ˜¯é€šè¿‡V8åˆ†é…çš„å†…å­˜ç§°ä¸ºå †å¤–å†…å­˜ã€‚ Bufferå¯¹è±¡ä¸åŒäºå…¶ä»–å¯¹è±¡ï¼Œå®ƒä¸ç»è¿‡V8çš„å†…å­˜åˆ†é…æœºåˆ¶ï¼Œæ‰€ä»¥ä¹Ÿä¸ ä¼šæœ‰å †å†…å­˜çš„å¤§å°é™åˆ¶ã€‚ åˆ©ç”¨å †å¤–å†…å­˜å¯ä»¥çªç ´å†…å­˜é™åˆ¶çš„é—®é¢˜ã€‚ Nodeçš„å†…å­˜æ„æˆä¸»è¦ç”±é€šè¿‡V8è¿›è¡Œåˆ†é…çš„éƒ¨åˆ†å’ŒNodeè‡ªè¡Œåˆ†é…çš„ éƒ¨åˆ†ã€‚å—V8çš„åƒåœ¾å›æ”¶é™åˆ¶çš„ä¸»è¦æ˜¯V8çš„å †å†…å­˜ã€‚ å†…å­˜æ³„æ¼é€ æˆå†…å­˜æ³„æ¼çš„åŸå› ï¼š ç¼“å­˜ã€‚ é˜Ÿåˆ—æ¶ˆè´¹ä¸åŠæ—¶ã€‚ ä½œç”¨åŸŸæœªé‡Šæ”¾ã€‚ æ…å°†å†…å­˜å½“åšç¼“å­˜ åœ¨Nodeä¸­ï¼Œç¼“å­˜å¹¶éç‰©ç¾ä»·å»‰ã€‚ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡è¢«å½“åšç¼“å­˜æ¥ä½¿ç”¨ï¼Œé‚£å°±æ„å‘³ç€å®ƒå°†ä¼šå¸¸ é©»åœ¨è€ç”Ÿä»£ä¸­ã€‚ç¼“å­˜ä¸­å­˜å‚¨çš„é”®è¶Šå¤šï¼Œé•¿æœŸå­˜æ´»çš„å¯¹è±¡ä¹Ÿå°±è¶Šå¤šï¼Œè¿™å°†å¯¼è‡´åƒåœ¾å›æ”¶åœ¨è¿›è¡Œæ‰«æ 10 å’Œæ•´ç†æ—¶ï¼Œå¯¹è¿™äº›å¯¹è±¡åšæ— ç”¨åŠŸ JavaScriptå¼€å‘è€…é€šå¸¸å–œæ¬¢ç”¨å¯¹è±¡çš„é”®å€¼å¯¹æ¥ç¼“å­˜ä¸œè¥¿ï¼Œä½†è¿™ä¸ä¸¥æ ¼æ„ä¹‰ä¸Š çš„ç¼“å­˜åˆæœ‰ç€åŒºåˆ«ï¼Œä¸¥æ ¼æ„ä¹‰çš„ç¼“å­˜æœ‰ç€å®Œå–„çš„è¿‡æœŸç­–ç•¥ï¼Œè€Œæ™®é€šå¯¹è±¡çš„é”®å€¼å¯¹å¹¶æ²¡æœ‰ã€‚ 1. ç¼“å­˜é™åˆ¶ç­–ç•¥ä¸ºäº†è§£å†³ç¼“å­˜ä¸­çš„å¯¹è±¡æ°¸è¿œæ— æ³•é‡Šæ”¾çš„é—®é¢˜ï¼Œéœ€è¦åŠ å…¥ä¸€ç§ç­–ç•¥æ¥é™åˆ¶ç¼“å­˜çš„æ— é™å¢é•¿ã€‚ æ¨¡å—æœºåˆ¶ï¼šä¸ºäº†åŠ é€Ÿæ¨¡å—çš„å¼•å…¥ï¼Œæ‰€æœ‰æ¨¡å—éƒ½ä¼šé€š è¿‡ç¼–è¯‘æ‰§è¡Œï¼Œç„¶åè¢«ç¼“å­˜èµ·æ¥ã€‚ç”±äºé€šè¿‡exportså¯¼å‡ºçš„å‡½æ•°ï¼Œå¯ä»¥è®¿é—®æ–‡ä»¶æ¨¡å—ä¸­çš„ç§æœ‰å˜é‡ï¼Œ è¿™æ ·æ¯ä¸ªæ–‡ä»¶æ¨¡å—åœ¨ç¼–è¯‘æ‰§è¡Œåå½¢æˆçš„ä½œç”¨åŸŸå› ä¸ºæ¨¡å—ç¼“å­˜çš„åŸå› ï¼Œä¸ä¼šè¢«é‡Šæ”¾ã€‚ 2. ç¼“å­˜çš„è§£å†³æ–¹æ¡ˆè¿› ç¨‹ä¹‹é—´æ— æ³•å…±äº«å†…å­˜ã€‚å¦‚æœåœ¨è¿›ç¨‹å†…ä½¿ç”¨ç¼“å­˜ï¼Œè¿™äº›ç¼“å­˜ä¸å¯é¿å…åœ°æœ‰é‡å¤ï¼Œå¯¹ç‰©ç†å†…å­˜çš„ä½¿ç”¨ æ˜¯ä¸€ç§æµªè´¹ã€‚ é‡‡ç”¨è¿›ç¨‹å¤–çš„ç¼“å­˜ï¼Œè¿›ç¨‹è‡ªèº«ä¸å­˜å‚¨çŠ¶æ€ã€‚å¤– éƒ¨çš„ç¼“å­˜è½¯ä»¶æœ‰ç€è‰¯å¥½çš„ç¼“å­˜è¿‡æœŸæ·˜æ±°ç­–ç•¥ä»¥åŠè‡ªæœ‰çš„å†…å­˜ç®¡ç†ï¼Œä¸å½±å“Nodeè¿›ç¨‹çš„æ€§èƒ½ã€‚ åœ¨Nodeä¸­ä¸»è¦å¯ä»¥è§£å†³ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ã€‚ (1) å°†ç¼“å­˜è½¬ç§»åˆ°å¤–éƒ¨ï¼Œå‡å°‘å¸¸é©»å†…å­˜çš„å¯¹è±¡çš„æ•°é‡ï¼Œè®©åƒåœ¾å›æ”¶æ›´é«˜æ•ˆã€‚ (2) è¿›ç¨‹ä¹‹é—´å¯ä»¥å…±äº«ç¼“å­˜ã€‚ å¸‚é¢ä¸Šè¾ƒå¥½çš„ç¼“å­˜æœ‰Rediså’ŒMemcached å…³æ³¨é˜Ÿåˆ—çŠ¶æ€é˜Ÿåˆ—åœ¨æ¶ˆè´¹è€…-ç”Ÿäº§è€…æ¨¡å‹ä¸­ç»å¸¸å……å½“ä¸­é—´äº§ç‰©ã€‚ä¸€æ—¦æ¶ˆè´¹é€Ÿåº¦ä½äºç”Ÿäº§é€Ÿåº¦ï¼Œ å°†ä¼šå½¢æˆå †ç§¯ã€‚ æ·±åº¦çš„è§£å†³æ–¹æ¡ˆåº”è¯¥æ˜¯ç›‘æ§é˜Ÿåˆ—çš„é•¿åº¦ï¼Œä¸€æ—¦å †ç§¯ï¼Œåº”å½“é€šè¿‡ç›‘æ§ç³»ç»Ÿäº§ç”ŸæŠ¥è­¦å¹¶é€šçŸ¥ç›¸å…³ äººå‘˜ã€‚å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä»»æ„å¼‚æ­¥è°ƒç”¨éƒ½åº”è¯¥åŒ…å«è¶…æ—¶æœºåˆ¶ï¼Œä¸€æ—¦åœ¨é™å®šçš„æ—¶é—´å†…æœªå®Œæˆå“åº”ï¼Œ é€šè¿‡å›è°ƒå‡½æ•°ä¼ é€’è¶…æ—¶å¼‚å¸¸ï¼Œä½¿å¾—ä»»æ„å¼‚æ­¥è°ƒç”¨çš„å›è°ƒéƒ½å…·å¤‡å¯æ§çš„å“åº”æ—¶é—´ï¼Œç»™æ¶ˆè´¹é€Ÿåº¦ä¸€ä¸ª ä¸‹é™å€¼ã€‚ å†…å­˜æ³„æ¼æ’æŸ¥å¸¸è§çš„å®šä½Nodeåº”ç”¨çš„å†…å­˜æ³„æ¼çš„å·¥å…·ï¼š v8-profilerã€‚ç”±Danny Coatesæä¾›ï¼Œå®ƒå¯ä»¥ç”¨äºå¯¹V8å †å†…å­˜æŠ“å–å¿«ç…§å’Œå¯¹CPUè¿›è¡Œåˆ†æï¼Œä½†è¯¥é¡¹ç›®å·²ç»æœ‰3å¹´æ²¡æœ‰ç»´æŠ¤äº†ã€‚ node-heapdumpã€‚è¿™æ˜¯Nodeæ ¸å¿ƒè´¡çŒ®è€…ä¹‹ä¸€Ben Noordhuisç¼–å†™çš„æ¨¡å—ï¼Œå®ƒå…è®¸å¯¹V8å †å†…å­˜æŠ“å–å¿«ç…§ï¼Œç”¨äºäº‹ååˆ†æã€‚ node-mtraceã€‚ç”±Jimb Esseræä¾›ï¼Œå®ƒä½¿ç”¨äº†GCCçš„mtraceå·¥å…·æ¥åˆ†æå †çš„ä½¿ç”¨ã€‚ dtraceã€‚åœ¨Joyentçš„SmartOSç³»ç»Ÿä¸Šï¼Œæœ‰å®Œå–„çš„dtraceå·¥å…·ç”¨æ¥åˆ†æå†…å­˜æ³„æ¼ã€‚ node-memwatchã€‚æ¥è‡ªMozillaçš„Lloyd Hilaielè´¡çŒ®çš„æ¨¡å—ï¼Œé‡‡ç”¨WTFPLè®¸å¯å‘å¸ƒã€‚ node-heapdumpå…ˆæ„é€ å¦‚ä¸‹ä¸€ä»½åŒ…å«å†…å­˜æ³„ æ¼çš„ä»£ç ç¤ºä¾‹ï¼Œå¹¶å°†å…¶å­˜ä¸ºserver.jsæ–‡ä»¶ï¼š 12345678910var leakArray = [];var leak = function () &#123; leakArray.push(\"leak\" + Math.random()); &#125;;http.createServer(function (req, res) &#123; leak(); res.writeHead(200, &#123;'Content-Type': 'text/plain'&#125;); res.end('Hello World\\n'); &#125;).listen(1337); console.log('Server running at http://127.0.0.1:1337/'); åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œæ¯æ¬¡è®¿é—®æœåŠ¡è¿›ç¨‹éƒ½å°†å¼•èµ·leakArrayæ•°ç»„ä¸­çš„å…ƒç´ å¢åŠ ï¼Œè€Œä¸”å¾—ä¸åˆ°å›æ”¶ã€‚æˆ‘ä»¬å¯ä»¥ç”¨curlå·¥å…·è¾“å…¥http://127.0.0.1:1337/å‘½ä»¤æ¥æ¨¡æ‹Ÿç”¨æˆ·è®¿é—®ã€‚ å®‰è£…node-heapdump1$ npm install heapdump å®‰è£…node-heapdumpåï¼Œåœ¨ä»£ç çš„ç¬¬ä¸€è¡Œæ·»åŠ å¦‚ä¸‹ä»£ç å°†å…¶å¼•å…¥: 1var heapdump = require(&apos;heapdump&apos;); å¼•å…¥node-heapdumpåï¼Œå°±å¯ä»¥å¯åŠ¨æœåŠ¡è¿›ç¨‹ï¼Œå¹¶æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚è®¿é—®å¤šæ¬¡ä¹‹åï¼Œ leakArrayä¸­å°±ä¼šå…·å¤‡å¤§é‡çš„å…ƒç´ ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬é€šè¿‡å‘æœåŠ¡è¿›ç¨‹å‘é€SIGUSR2ä¿¡å·ï¼Œè®© 10 node-heapdumpæŠ“æ‹ä¸€ä»½å †å†…å­˜çš„å¿«ç…§ã€‚å‘é€ä¿¡å·çš„å‘½ä»¤å¦‚ä¸‹: 1$ kill -USR2 &lt;pid&gt; è¿™ä»½æŠ“å–çš„å¿«ç…§å°†ä¼šåœ¨æ–‡ä»¶ç›®å½•ä¸‹ä»¥heapdump-..heapsnapshotçš„æ ¼å¼å­˜æ”¾ã€‚è¿™æ˜¯ä¸€ä»½è¾ƒå¤§çš„JSONæ–‡ä»¶ï¼Œéœ€è¦é€šè¿‡Chromeçš„å¼€å‘è€…å·¥å…·æ‰“å¼€æŸ¥çœ‹ã€‚ å¯ä»¥çœ‹åˆ°æœ‰å¤§é‡çš„leakå­—ç¬¦ä¸²å­˜åœ¨ï¼Œè¿™äº›å­—ç¬¦ä¸²å°±æ˜¯ä¸€ç›´æœªèƒ½å¾—åˆ°å›æ”¶çš„æ•°æ®ã€‚ é€šè¿‡åœ¨å¼€å‘è€…å·¥å…·çš„é¢æ¿ä¸­æŸ¥çœ‹å†…å­˜åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ³„æ¼çš„æ•°æ®ï¼Œç„¶åæ ¹æ®è¿™äº›ä¿¡æ¯æ‰¾åˆ°é€  æˆæ³„æ¼çš„ä»£ç ã€‚ node-memwatch12345678910111213141516171819var memwatch = require('memwatch'); memwatch.on('leak', function (info) &#123; console.log('leak:'); console.log(info); &#125;);memwatch.on('stats', function (stats) &#123; console.log('stats:') console.log(stats);&#125;);var http = require('http');var leakArray = [];var leak = function () &#123; leakArray.push(\"leak\" + Math.random()); &#125;;http.createServer(function (req, res) &#123; leak(); res.writeHead(200, &#123;'Content-Type': 'text/plain'&#125;); res.end('Hello World\\n'); &#125;).listen(1337);console.log('Server running at http://127.0.0.1:1337/'); 1. statsäº‹ä»¶åœ¨è¿›ç¨‹ä¸­ä½¿ç”¨node-memwatchä¹‹åï¼Œæ¯æ¬¡è¿›è¡Œå…¨å †åƒåœ¾å›æ”¶æ—¶ï¼Œå°†ä¼šè§¦å‘ä¸€æ¬¡statsäº‹ä»¶ï¼Œè¿™ 4 ä¸ªäº‹ä»¶å°†ä¼šä¼ é€’å†…å­˜çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ num_full_gcå’Œnum_inc_gcæ¯”è¾ƒç›´è§‚åœ°ååº”äº†åƒåœ¾å›æ”¶çš„æƒ…å†µ 2. leakäº‹ä»¶å¦‚æœç»è¿‡è¿ç»­5æ¬¡åƒåœ¾å›æ”¶åï¼Œå†…å­˜ä»ç„¶æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œè¿™æ„å‘³ç€æœ‰å†…å­˜æ³„æ¼çš„äº§ç”Ÿï¼Œnode-memwatchä¼šå‡ºå‘ä¸€ä¸ªleakäº‹ä»¶ã€‚ è¿™ä¸ªæ•°æ®èƒ½æ˜¾ç¤º5æ¬¡åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­å†…å­˜å¢é•¿äº†å¤šå°‘ã€‚ 3. å †å†…å­˜æ¯”è¾ƒæœ€ç»ˆå¾—åˆ°çš„leakäº‹ä»¶çš„ä¿¡æ¯åªèƒ½å‘ŠçŸ¥æˆ‘ä»¬åº”ç”¨ä¸­å­˜åœ¨å†…å­˜æ³„æ¼ï¼Œå…·ä½“é—®é¢˜äº§ç”Ÿåœ¨ä½•å¤„è¿˜éœ€è¦ä»V8çš„å †å†…å­˜ä¸Šå®šä½ã€‚node-memwatchæä¾›äº†æŠ“å–å¿«ç…§å’Œæ¯”è¾ƒå¿«ç…§çš„åŠŸèƒ½ï¼Œå®ƒèƒ½å¤Ÿæ¯”è¾ƒå †ä¸Šå¯¹è±¡ çš„åç§°å’Œåˆ†é…æ•°é‡ï¼Œä»è€Œæ‰¾å‡ºå¯¼è‡´å†…å­˜æ³„æ¼çš„å…ƒå‡¶ã€‚ 1234567891011121314var memwatch = require('memwatch');var leakArray = [];var leak = function () &#123; leakArray.push(\"leak\" + Math.random());&#125;;// Take first snapshotvar hd = new memwatch.HeapDiff();for (var i = 0; i &lt; 10000; i++) &#123; leak();&#125;// Take the second snapshot and compute the diff var diff = hd.end(); console.log(JSON.stringify(diff, null, 2)); æ‰§è¡Œä¸Šé¢è¿™æ®µä»£ç ï¼Œå¾—åˆ°çš„è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤º: 1234567891011121314151617181920212223242526272829303132333435363738394041424344$ node diff.js &#123; \"before\": &#123; \"nodes\": 11719, \"time\": \"2013-10-07T06:32:07.000Z\", \"size_bytes\": 1493304, \"size\": \"1.42 mb\" &#125;, \"after\": &#123; \"nodes\": 31618, \"time\": \"2013-10-07T06:32:07.000Z\", \"size_bytes\": 2684864, \"size\": \"2.56 mb\" &#125;, \"change\": &#123; \"size_bytes\": 1191560, \"size\": \"1.14 mb\", \"freed_nodes\": 129, \"allocated_nodes\": 20028, \"details\": [ &#123; \"what\": \"Array\", \"size_bytes\": 323720, \"size\": \"316.13 kb\", \"+\": 15, \"-\": 65 &#125;, &#123; \"what\": \"Code\", \"size_bytes\": -10944, \"size\": \"-10.69 kb\", \"+\": 8, \"-\": 28 &#125;, &#123; \"what\": \"String\", \"size_bytes\": 879424, \"size\": \"858.81 kb\", \"+\": 20001, \"-\": 1 &#125; ] &#125;&#125; changeèŠ‚ç‚¹ä¸‹çš„freed_nodeså’Œallocated_nodesï¼Œå®ƒä»¬è®°å½•äº† é‡Šæ”¾çš„èŠ‚ç‚¹æ•°é‡å’Œåˆ†é…çš„èŠ‚ç‚¹æ•°é‡ã€‚è¿™é‡Œç”±äºæœ‰å†…å­˜æ³„æ¼ï¼Œåˆ†é…çš„èŠ‚ç‚¹æ•°é‡è¿œè¿œå¤šä½™é‡Šæ”¾çš„èŠ‚ç‚¹ æ•°é‡ã€‚åœ¨detailsä¸‹å¯ä»¥çœ‹åˆ°å…·ä½“æ¯ç§ç±»å‹çš„åˆ†é…å’Œé‡Šæ”¾æ•°é‡ã€‚ åŠ å·å’Œå‡å·åˆ†åˆ«è¡¨ç¤ºåˆ†é…å’Œé‡Šæ”¾çš„å­—ç¬¦ä¸²å¯¹è±¡æ•°é‡ã€‚ å¤§å†…å­˜åº”ç”¨Nodeæä¾›äº†streamæ¨¡å—ç”¨äºå¤„ç†å¤§æ–‡ä»¶ streamæ¨¡å—æ˜¯Nodeçš„åŸç”Ÿæ¨¡å—ï¼Œç›´æ¥å¼•ç”¨å³å¯ã€‚streamç»§æ‰¿è‡ªEventEmitterï¼Œå…·å¤‡åŸºæœ¬çš„è‡ª å®šä¹‰äº‹ä»¶åŠŸèƒ½ï¼ŒåŒæ—¶æŠ½è±¡å‡ºæ ‡å‡†çš„äº‹ä»¶å’Œæ–¹æ³•ã€‚å®ƒåˆ†å¯è¯»å’Œå¯å†™ä¸¤ç§ã€‚Nodeä¸­çš„å¤§å¤šæ•°æ¨¡å—éƒ½æœ‰ streamçš„åº”ç”¨ï¼Œæ¯”å¦‚fsçš„createReadStream()å’ŒcreateWriteStream()æ–¹æ³•å¯ä»¥åˆ†åˆ«ç”¨äºåˆ›å»ºæ–‡ä»¶ çš„å¯è¯»æµå’Œå¯å†™æµï¼Œprocessæ¨¡å—ä¸­çš„stdinå’Œstdoutåˆ™åˆ†åˆ«æ˜¯å¯è¯»æµå’Œå¯å†™æµçš„ç¤ºä¾‹ã€‚ ç¬¬å…­ç«  ç†è§£BufferBuffer ç»“æ„Bufferæ˜¯ä¸€ä¸ªåƒArrayçš„å¯¹è±¡ï¼Œä½†å®ƒä¸»è¦ç”¨äºæ“ä½œå­—èŠ‚ã€‚ æ¨¡å—ç»“æ„Bufferæ˜¯ä¸€ä¸ªå…¸å‹çš„JavaScriptä¸C++ç»“åˆçš„æ¨¡å—ï¼Œå®ƒå°†æ€§èƒ½ç›¸å…³éƒ¨åˆ†ç”¨C++å®ç°ï¼Œå°†éæ€§èƒ½ç›¸å…³çš„éƒ¨åˆ†ç”¨JavaScriptå®ç° Nodeåœ¨è¿›ç¨‹å¯åŠ¨æ—¶å°±å·²ç»åŠ è½½äº†å®ƒï¼Œå¹¶å°†å…¶æ”¾åœ¨å…¨å±€å¯¹è±¡(global) ä¸Šã€‚æ‰€ä»¥åœ¨ä½¿ç”¨Bufferæ—¶ï¼Œæ— é¡»é€šè¿‡require()å³å¯ç›´æ¥ä½¿ç”¨ Buffer å¯¹è±¡Bufferå¯¹è±¡ç±»ä¼¼äºæ•°ç»„ï¼Œå®ƒçš„å…ƒç´ ä¸º16è¿›åˆ¶çš„ä¸¤ä½æ•°ï¼Œå³0åˆ°255çš„æ•°å€¼ã€‚ 1234var str = \"æ·±å…¥æµ…å‡ºnode.js\";var buf = new Buffer(str, 'utf-8');console.log(buf);// =&gt; &lt;Buffer e6 b7 b1 e5 85 a5 e6 b5 85 e5 87 ba 6e 6f 64 65 2e 6a 73&gt; ä¸åŒç¼–ç çš„å­—ç¬¦ä¸²å ç”¨çš„å…ƒç´ ä¸ªæ•°å„ä¸ç›¸åŒï¼Œä¸Šé¢ä»£ç ä¸­çš„ä¸­æ–‡å­—åœ¨ UTF-8ç¼–ç ä¸‹å ç”¨3ä¸ªå…ƒç´ ï¼Œå­—æ¯å’ŒåŠè§’æ ‡ç‚¹ç¬¦å·å ç”¨1ä¸ªå…ƒç´ ã€‚ Bufferå¯ä»¥è®¿é—®lengthå±æ€§å¾—åˆ°é•¿åº¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ ï¼Œåœ¨æ„é€ å¯¹è±¡æ—¶ä¹Ÿä¸Arrayç›¸ä¼¼ã€‚ 123var buf = new Buffer(100); console.log(buf.length); // =&gt; 100console.log(buf[10]);//ä¼šå¾—åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥‡æ€ªçš„ç»“æœï¼Œå®ƒçš„å…ƒç´ å€¼æ˜¯ä¸€ä¸ª0åˆ°255çš„éšæœºå€¼ã€‚ å¦‚æœç»™å…ƒç´ èµ‹å€¼ä¸æ˜¯0åˆ°255çš„æ•´æ•°è€Œæ˜¯å°æ•°æ—¶ä¼šæ€æ ·å‘¢? 123456buf[20] = -100;console.log(buf[20]); // 156 buf[21] = 300; console.log(buf[21]); // 44 buf[22] = 3.1415; console.log(buf[22]); // 3 ç»™å…ƒç´ çš„èµ‹å€¼å¦‚æœå°äº0ï¼Œå°±å°†è¯¥å€¼é€æ¬¡åŠ 256ï¼Œç›´åˆ°å¾—åˆ°ä¸€ä¸ª0åˆ°255ä¹‹é—´çš„æ•´æ•°ã€‚å¦‚æœå¾—åˆ° çš„æ•°å€¼å¤§äº255ï¼Œå°±é€æ¬¡å‡256ï¼Œç›´åˆ°å¾—åˆ°0~255åŒºé—´å†…çš„æ•°å€¼ã€‚å¦‚æœæ˜¯å°æ•°ï¼Œèˆå¼ƒå°æ•°éƒ¨åˆ†ï¼Œåª ä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚ Buffer å†…å­˜åˆ†é…Bufferå¯¹è±¡çš„å†…å­˜åˆ†é…ä¸æ˜¯åœ¨V8çš„å †å†…å­˜ä¸­ï¼Œè€Œæ˜¯åœ¨Nodeçš„C++å±‚é¢å®ç°å†…å­˜çš„ç”³è¯·çš„ã€‚å›  ä¸ºå¤„ç†å¤§é‡çš„å­—èŠ‚æ•°æ®ä¸èƒ½é‡‡ç”¨éœ€è¦ä¸€ç‚¹å†…å­˜å°±å‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€ç‚¹å†…å­˜çš„æ–¹å¼ï¼Œè¿™å¯èƒ½é€ æˆå¤§ é‡çš„å†…å­˜ç”³è¯·çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹æ“ä½œç³»ç»Ÿæœ‰ä¸€å®šå‹åŠ›ã€‚ä¸ºæ­¤Nodeåœ¨å†…å­˜çš„ä½¿ç”¨ä¸Šåº”ç”¨çš„æ˜¯åœ¨C++ å±‚é¢ç”³è¯·å†…å­˜ã€åœ¨JavaScriptä¸­åˆ†é…å†…å­˜çš„ç­–ç•¥ã€‚ Nodeé‡‡ç”¨äº†slabåˆ†é…æœºåˆ¶ï¼Œslabæ˜¯ä¸€ç§åŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶ã€‚slabå°±æ˜¯ä¸€å—ç”³è¯·å¥½çš„å›ºå®šå¤§å°çš„å†…å­˜åŒºåŸŸã€‚slabå…·æœ‰å¦‚ä¸‹3ç§çŠ¶æ€ã€‚ full:å®Œå…¨åˆ†é…çŠ¶æ€ã€‚ partial:éƒ¨åˆ†åˆ†é…çŠ¶æ€ã€‚ empty:æ²¡æœ‰è¢«åˆ†é…çŠ¶æ€ã€‚ 1new Buffer(size); Nodeä»¥8 KBä¸ºç•Œé™æ¥åŒºåˆ†Bufferæ˜¯å¤§å¯¹è±¡è¿˜æ˜¯å°å¯¹è±¡ã€‚8 KBçš„å€¼ä¹Ÿå°±æ˜¯æ¯ä¸ªslabçš„å¤§å°å€¼ï¼Œåœ¨JavaScriptå±‚é¢ï¼Œä»¥å®ƒä½œä¸ºå•ä½å•å…ƒè¿›è¡Œå†…å­˜çš„åˆ†é…ã€‚ 1. åˆ†é…å°Bufferå¯¹è±¡å¦‚æœæŒ‡å®šBufferçš„å¤§å°å°‘äº8 KBï¼ŒNodeä¼šæŒ‰ç…§å°å¯¹è±¡çš„æ–¹å¼è¿›è¡Œåˆ†é…ã€‚Bufferçš„åˆ†é…è¿‡ç¨‹ä¸­ä¸»è¦ä½¿ç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡poolä½œä¸ºä¸­é—´å¤„ç†å¯¹è±¡ï¼Œå¤„äºåˆ†é…çŠ¶æ€çš„slabå•å…ƒéƒ½æŒ‡å‘å®ƒ 12345var pool;function allocPool() &#123; pool = new SlowBuffer(Buffer.poolSize); pool.used = 0;&#125; slabå¤„äºemptyçŠ¶æ€ã€‚ 1new Buffer(1024); è¿™æ¬¡æ„é€ å°†ä¼šå»æ£€æŸ¥poolå¯¹è±¡ï¼Œå¦‚æœpoolæ²¡æœ‰è¢«åˆ›å»ºï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„slabå•å…ƒæŒ‡å‘å®ƒ: 1if (!pool || pool.length - pool.used &lt; this.length) allocPool(); åŒæ—¶å½“å‰Bufferå¯¹è±¡çš„parentå±æ€§æŒ‡å‘è¯¥slabï¼Œå¹¶è®°å½•ä¸‹æ˜¯ä»è¿™ä¸ªslabçš„å“ªä¸ªä½ç½®(offset) å¼€å§‹ä½¿ç”¨çš„ï¼Œslabå¯¹è±¡è‡ªèº«ä¹Ÿè®°å½•è¢«ä½¿ç”¨äº†å¤šå°‘å­—èŠ‚ 1234this.parent = pool;this.offset = pool.used;pool.used += this.length;if (pool.used &amp; 7) pool.used = (pool.used + 8) &amp; ~7; è¿™æ—¶å€™çš„slabçŠ¶æ€ä¸ºpartialã€‚ å½“å†æ¬¡åˆ›å»ºä¸€ä¸ªBufferå¯¹è±¡æ—¶ï¼Œæ„é€ è¿‡ç¨‹ä¸­å°†ä¼šåˆ¤æ–­è¿™ä¸ªslabçš„å‰©ä½™ç©ºé—´æ˜¯å¦è¶³å¤Ÿã€‚å¦‚æœè¶³ å¤Ÿï¼Œä½¿ç”¨å‰©ä½™ç©ºé—´ï¼Œå¹¶æ›´æ–°slabçš„åˆ†é…çŠ¶æ€ã€‚å¦‚æœslabå‰©ä½™çš„ç©ºé—´ä¸å¤Ÿï¼Œå°†ä¼šæ„é€ æ–°çš„slabï¼ŒåŸslabä¸­å‰©ä½™çš„ç©ºé—´ä¼šé€ æˆæµªè´¹ã€‚ ç”±äºåŒä¸€ä¸ªslabå¯èƒ½åˆ†é…ç»™å¤šä¸ªBufferå¯¹è±¡ä½¿ç”¨ï¼Œåªæœ‰è¿™äº›å°Bufferå¯¹ è±¡åœ¨ä½œç”¨åŸŸé‡Šæ”¾å¹¶éƒ½å¯ä»¥å›æ”¶æ—¶ï¼Œslabçš„8 KBç©ºé—´æ‰ä¼šè¢«å›æ”¶ã€‚å°½ç®¡åˆ›å»ºäº†1ä¸ªå­—èŠ‚çš„Bufferå¯¹è±¡ï¼Œ ä½†æ˜¯å¦‚æœä¸é‡Šæ”¾å®ƒï¼Œå®é™…å¯èƒ½æ˜¯8 KBçš„å†…å­˜æ²¡æœ‰é‡Šæ”¾ã€‚ 2. åˆ†é…å¤§Bufferå¯¹è±¡å¦‚æœéœ€è¦è¶…è¿‡8 KBçš„Bufferå¯¹è±¡ï¼Œå°†ä¼šç›´æ¥åˆ†é…ä¸€ä¸ªSlowBufferå¯¹è±¡ä½œä¸ºslabå•å…ƒï¼Œè¿™ä¸ªslab å•å…ƒå°†ä¼šè¢«è¿™ä¸ªå¤§Bufferå¯¹è±¡ç‹¬å ã€‚ 12// Big buffer, just alloc onethis.parent = new SlowBuffer(this.length); this.offset = 0; Buffer çš„è½¬æ¢Bufferå¯¹è±¡å¯ä»¥ä¸å­—ç¬¦ä¸²ä¹‹é—´ç›¸äº’è½¬æ¢ã€‚ç›®å‰æ”¯æŒçš„å­—ç¬¦ä¸²ç¼–ç ç±»å‹æœ‰å¦‚ä¸‹è¿™å‡ ç§ã€‚ ASCII UTF-8 UTF-16LE/UCS-2 Base64 Binary Hex å­—ç¬¦ä¸²è½¬Bufferå­—ç¬¦ä¸²è½¬Bufferå¯¹è±¡ä¸»è¦æ˜¯é€šè¿‡æ„é€ å‡½æ•°å®Œæˆçš„ 1new Buffer(str, [encoding]); é€šè¿‡æ„é€ å‡½æ•°è½¬æ¢çš„Bufferå¯¹è±¡ï¼Œå­˜å‚¨çš„åªèƒ½æ˜¯ä¸€ç§ç¼–ç ç±»å‹ã€‚encodingå‚æ•°ä¸ä¼ é€’æ—¶ï¼Œé»˜è®¤æŒ‰UTF-8ç¼–ç è¿›è¡Œè½¬ç å’Œå­˜å‚¨ã€‚ ä¸€ä¸ªBufferå¯¹è±¡å¯ä»¥å­˜å‚¨ä¸åŒç¼–ç ç±»å‹çš„å­—ç¬¦ä¸²è½¬ç çš„å€¼ï¼Œè°ƒç”¨write()æ–¹æ³•å¯ä»¥å®ç°è¯¥ç›®çš„ 1buf.write(string, [offset], [length], [encoding]) ç”±äºå¯ä»¥ä¸æ–­å†™å…¥å†…å®¹åˆ°Bufferå¯¹è±¡ä¸­ï¼Œå¹¶ä¸”æ¯æ¬¡å†™å…¥å¯ä»¥æŒ‡å®šç¼–ç ï¼Œæ‰€ä»¥Bufferå¯¹è±¡ä¸­å¯ ä»¥å­˜åœ¨å¤šç§ç¼–ç è½¬åŒ–åçš„å†…å®¹ã€‚éœ€è¦å°å¿ƒçš„æ˜¯ï¼Œæ¯ç§ç¼–ç æ‰€ç”¨çš„å­—èŠ‚é•¿åº¦ä¸åŒï¼Œå°†Bufferåè½¬å› å­—ç¬¦ä¸²æ—¶éœ€è¦è°¨æ…å¤„ç†ã€‚ Buffer è½¬å­—ç¬¦ä¸²Bufferå¯¹è±¡çš„toString()å¯ä»¥å°†Bufferå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸² 1buf.toString([encoding], [start], [end]) å¯ä»¥è®¾ç½®encoding(é»˜è®¤ä¸ºUTF-8)ã€startã€endè¿™3ä¸ªå‚æ•°å®ç°æ•´ä½“æˆ–å±€éƒ¨çš„è½¬æ¢ã€‚å¦‚æœBufferå¯¹è±¡ç”±å¤šç§ç¼–ç å†™å…¥ï¼Œå°±éœ€è¦åœ¨å±€éƒ¨æŒ‡å®šä¸åŒçš„ç¼–ç ï¼Œæ‰èƒ½è½¬æ¢å›æ­£å¸¸çš„ç¼–ç ã€‚ Buffer ä¸æ”¯æŒçš„ç¼–ç ç±»å‹Bufferæä¾›äº†ä¸€ä¸ªisEncoding()å‡½æ•°æ¥åˆ¤æ–­ç¼–ç æ˜¯å¦æ”¯æŒè½¬æ¢ 1Buffer.isEncoding(encoding) å°†ç¼–ç ç±»å‹ä½œä¸ºå‚æ•°ä¼ å…¥ä¸Šé¢çš„å‡½æ•°ï¼Œå¦‚æœæ”¯æŒè½¬æ¢è¿”å›å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚ Buffer çš„æ‹¼æ¥Bufferåœ¨ä½¿ç”¨åœºæ™¯ä¸­ï¼Œé€šå¸¸æ˜¯ä»¥ä¸€æ®µä¸€æ®µçš„æ–¹å¼ä¼ è¾“ã€‚ ä¹±ç æ˜¯å¦‚ä½•äº§ç”Ÿçš„12345678var fs = require('fs');var rs = fs.createReadStream('test.md');var data = '';rs.on(\"data\", function (chunk)&#123; data += chunk; &#125;);rs.on(\"end\", function () &#123; console.log(data);&#125;); data += chunk;è¿™å¥ä»£ç é‡Œéšè—äº†toString()æ“ä½œï¼Œç­‰ä»·äºdata = data.toString() + chunk.toString(); 1var rs = fs.createReadStream('test.md', &#123;highWaterMark: 11&#125;); æ­é…è¯¥ä»£ç çš„æµ‹è¯•æ•°æ®ä¸ºæç™½çš„ã€Šé™å¤œæ€ã€‹ã€‚æ‰§è¡Œè¯¥ç¨‹åºï¼Œå°†ä¼šå¾—åˆ°ä»¥ä¸‹è¾“å‡º: 1åºŠå‰æ˜ï¿½ï¿½ï¿½å…‰ï¼Œç–‘ï¿½ï¿½ï¿½åœ°ä¸Šéœœ;ä¸¾å¤´ï¿½ï¿½ï¿½æ˜æœˆï¼Œï¿½ï¿½ï¿½å¤´æ€æ•…ä¹¡ã€‚ äº§ç”Ÿè¿™ä¸ªè¾“å‡ºç»“æœçš„åŸå› åœ¨äºæ–‡ä»¶å¯è¯»æµåœ¨è¯»å–æ—¶ä¼šé€ä¸ªè¯»å–Bufferã€‚è¿™é¦–è¯—çš„åŸå§‹Bufferåº”å­˜å‚¨ä¸º: 1&lt;Buffer e5 ba 8a e5 89 8d e6 98 8e e6 9c 88 e5 85 89 ef bc 8c e7 96 91 e6 98 af e5 9c b0 e4 b8 8a e9 9c 9c ef bc 9b e4 b8 be e5 a4 b4 e6 9c 9b e6 98 8e e6 9c 88 ...&gt; ç”±äºæˆ‘ä»¬é™å®šäº†Bufferå¯¹è±¡çš„é•¿åº¦ä¸º11ï¼Œå› æ­¤åªè¯»æµéœ€è¦è¯»å–7æ¬¡æ‰èƒ½å®Œæˆå®Œæ•´çš„è¯»å–ï¼Œç»“æœ æ˜¯ä»¥ä¸‹å‡ ä¸ªBufferå¯¹è±¡ä¾æ¬¡è¾“å‡º: 123&lt;Buffer e5 ba 8a e5 89 8d e6 98 8e e6 9c&gt; &lt;Buffer 88 e5 85 89 ef bc 8c e7 96 91 e6&gt; ... buf.toString()æ–¹æ³•é»˜è®¤ä»¥UTF-8ä¸ºç¼–ç ï¼Œä¸­æ–‡å­—åœ¨UTF-8ä¸‹å 3ä¸ªå­—èŠ‚ã€‚æ‰€ä»¥ç¬¬ ä¸€ä¸ªBufferå¯¹è±¡åœ¨è¾“å‡ºæ—¶ï¼Œåªèƒ½æ˜¾ç¤º3ä¸ªå­—ç¬¦ï¼ŒBufferä¸­å‰©ä¸‹çš„2ä¸ªå­—èŠ‚(e6 9c)å°†ä¼šä»¥ä¹±ç çš„å½¢ å¼æ˜¾ç¤ºã€‚ç¬¬äºŒä¸ªBufferå¯¹è±¡çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¹Ÿä¸èƒ½å½¢æˆæ–‡å­—ï¼Œåªèƒ½æ˜¾ç¤ºä¹±ç ã€‚äºæ˜¯å½¢æˆä¸€äº›æ–‡å­—æ—  æ³•æ­£å¸¸æ˜¾ç¤ºçš„é—®é¢˜ã€‚ åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­æˆ‘ä»¬æ„é€ äº†11è¿™ä¸ªé™åˆ¶ï¼Œä½†æ˜¯å¯¹äºä»»æ„é•¿åº¦çš„Bufferè€Œè¨€ï¼Œå®½å­—èŠ‚å­—ç¬¦ä¸²éƒ½æœ‰ å¯èƒ½å­˜åœ¨è¢«æˆªæ–­çš„æƒ…å†µï¼Œåªä¸è¿‡Bufferçš„é•¿åº¦è¶Šå¤§å‡ºç°çš„æ¦‚ç‡è¶Šä½è€Œå·²ï¼Œä½†è¯¥é—®é¢˜ä¾ç„¶ä¸å¯å¿½è§†ã€‚ setEncoding()ä¸ string_decoder()å¯è¯»æµè¿˜æœ‰ä¸€ä¸ªè®¾ç½®ç¼–ç çš„æ–¹æ³•setEncoding()ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯è®©dataäº‹ä»¶ä¸­ä¼ é€’çš„ä¸å†æ˜¯ä¸€ä¸ªBufferå¯¹è±¡ï¼Œè€Œæ˜¯ç¼–ç åçš„å­—ç¬¦ä¸²ã€‚ 1readable.setEncoding(encoding) 12var rs = fs.createReadStream('test.md', &#123; highWaterMark: 11&#125;);rs.setEncoding('utf8'); é‡æ–°æ‰§è¡Œç¨‹åºï¼Œå¾—åˆ°è¾“å‡º: åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœ;ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚ è®¾ç½®ç¼–ç å¹¶æœªæ”¹å˜æŒ‰ æ®µè¯»å–çš„åŸºæœ¬æ–¹å¼ã€‚åœ¨è°ƒç”¨setEncoding()æ—¶ï¼Œå¯è¯»æµå¯¹è±¡åœ¨å†…éƒ¨è®¾ç½®äº†ä¸€ä¸ªdecoderå¯¹è±¡ã€‚æ¯æ¬¡dataäº‹ ä»¶éƒ½é€šè¿‡è¯¥decoderå¯¹è±¡è¿›è¡ŒBufferåˆ°å­—ç¬¦ä¸²çš„è§£ç ï¼Œç„¶åä¼ é€’ç»™è°ƒç”¨è€…ã€‚ç½®ç¼–ç åï¼Œdata ä¸å†æ”¶åˆ°åŸå§‹çš„Bufferå¯¹è±¡ã€‚ decoderå¯¹è±¡æ¥è‡ªäºstring_decoder æ¨¡å—StringDecoderçš„å®ä¾‹å¯¹è±¡ã€‚StringDecoderåœ¨å¾—åˆ°ç¼–ç åï¼ŒçŸ¥é“å®½å­—èŠ‚å­—ç¬¦ä¸²åœ¨UTF-8ç¼–ç ä¸‹æ˜¯ ä»¥3ä¸ªå­—èŠ‚çš„æ–¹å¼å­˜å‚¨çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡write()æ—¶ï¼Œåªè¾“å‡ºå‰9ä¸ªå­—èŠ‚è½¬ç å½¢æˆçš„å­—ç¬¦ï¼Œâ€œæœˆâ€å­—çš„ å‰ä¸¤ä¸ªå­—èŠ‚è¢«ä¿ç•™åœ¨StringDecoderå®ä¾‹å†…éƒ¨ã€‚ç¬¬äºŒæ¬¡write()æ—¶ï¼Œä¼šå°†è¿™2ä¸ªå‰©ä½™å­—èŠ‚å’Œåç»­11 ä¸ªå­—èŠ‚ç»„åˆåœ¨ä¸€èµ·ï¼Œå†æ¬¡ç”¨3çš„æ•´æ•°å€å­—èŠ‚è¿›è¡Œè½¬ç ã€‚äºæ˜¯ä¹±ç é—®é¢˜é€šè¿‡è¿™ç§ä¸­é—´å½¢å¼è¢«è§£å†³äº†ã€‚ string_decoderç›®å‰åªèƒ½å¤„ç†UTF-8ã€Base64å’Œ UCS-2/UTF-16LEè¿™3ç§ç¼–ç ã€‚ æ­£ç¡®æ‹¼æ¥Buffer1234567891011var chunks = [];var size = 0;res.on('data', function (chunk) &#123; chunks.push(chunk); size += chunk.length;&#125;)res.on('end', function()&#123; var buf = Buffer.concat(chunks, size); var str = iconv.decode(buf, 'utf8'); console.log(str);&#125;) æ­£ç¡®çš„æ‹¼æ¥æ–¹å¼æ˜¯ç”¨ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨æ¥æ”¶åˆ°çš„æ‰€æœ‰Bufferç‰‡æ®µå¹¶è®°å½•ä¸‹æ‰€æœ‰ç‰‡æ®µçš„æ€»é•¿åº¦ï¼Œ ç„¶åè°ƒç”¨Buffer.concat()æ–¹æ³•ç”Ÿæˆä¸€ä¸ªåˆå¹¶çš„Bufferå¯¹è±¡ã€‚Buffer.concat()æ–¹æ³•å°è£…äº†ä»å° Bufferå¯¹è±¡å‘å¤§Bufferå¯¹è±¡çš„å¤åˆ¶è¿‡ç¨‹ï¼Œå®ç°ååˆ†ç»†è…» 12345678910111213141516171819202122232425Buffer.concat = function(list, length) &#123; if (!Array.isArray(list)) &#123; throw new Error('Usage: Buffer.concat(list, [length])'); &#125; if (list.length === 0) &#123; return new Buffer(0); &#125; else if (list.length === 1) &#123; return list[0]; &#125; if (typeof length !== 'number') &#123; length = 0; for (var i = 0; i &lt; list.length; i++) &#123; var buf = list[i]; length += buf.length; &#125; &#125; var buffer = new Buffer(length); var pos = 0; for (var i = 0; i &lt; list.length; i++) &#123; var buf = list[i]; buf.copy(buffer, pos); pos += buf.length; &#125; return buffer; &#125;; Buffer ä¸æ€§èƒ½ä¸€æ—¦åœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼Œéƒ½éœ€è¦è½¬æ¢ä¸ºBufferï¼Œä»¥è¿›è¡ŒäºŒè¿›åˆ¶æ•°æ®ä¼ è¾“ã€‚ é€šè¿‡é¢„å…ˆè½¬æ¢é™æ€å†…å®¹ä¸ºBufferå¯¹è±¡ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å‡å°‘CPUçš„é‡å¤ä½¿ç”¨ï¼ŒèŠ‚çœæœåŠ¡å™¨èµ„æºã€‚ åœ¨Nodeæ„å»ºçš„Webåº”ç”¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©å°†é¡µé¢ä¸­çš„åŠ¨æ€å†…å®¹å’Œé™æ€å†…å®¹åˆ†ç¦»ï¼Œé™æ€å†…å®¹éƒ¨åˆ†å¯ä»¥é€š è¿‡é¢„å…ˆè½¬æ¢ä¸ºBufferçš„æ–¹å¼ï¼Œä½¿æ€§èƒ½å¾—åˆ°æå‡ã€‚ç”±äºæ–‡ä»¶è‡ªèº«æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥åœ¨ä¸éœ€è¦æ”¹å˜ å†…å®¹çš„åœºæ™¯ä¸‹ï¼Œå°½é‡åªè¯»å–Bufferï¼Œç„¶åç›´æ¥ä¼ è¾“ï¼Œä¸åšé¢å¤–çš„è½¬æ¢ï¼Œé¿å…æŸè€—ã€‚ æ–‡ä»¶è¯»å–åœ¨æ–‡ä»¶çš„è¯»å–æ—¶ï¼Œæœ‰ä¸€ä¸ªhighWaterMarkè®¾ç½®å¯¹æ€§èƒ½çš„å½±å“è‡³å…³é‡è¦ã€‚ åœ¨fs.createReadStream(path, opts)æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€äº›å‚æ•° 1234567&#123; flags: 'r', encoding: null, fd: null, mode: 0666, highWaterMark: 64 * 1024&#125; è¿˜å¯ä»¥ä¼ é€’startå’Œendæ¥æŒ‡å®šè¯»å–æ–‡ä»¶çš„ä½ç½®èŒƒå›´ 1&#123;start: 90, end: 99&#125; fs.createReadStream()çš„å·¥ä½œæ–¹å¼æ˜¯åœ¨å†…å­˜ä¸­å‡†å¤‡ä¸€æ®µBufferï¼Œç„¶ååœ¨fs.read()è¯»å–æ—¶é€æ­¥ ä»ç£ç›˜ä¸­å°†å­—èŠ‚å¤åˆ¶åˆ°Bufferä¸­ã€‚å®Œæˆä¸€æ¬¡è¯»å–æ—¶ï¼Œåˆ™ä»è¿™ä¸ªBufferä¸­é€šè¿‡slice()æ–¹æ³•å–å‡ºéƒ¨åˆ† æ•°æ®ä½œä¸ºä¸€ä¸ªå°Bufferå¯¹è±¡ï¼Œå†é€šè¿‡dataäº‹ä»¶ä¼ é€’ç»™è°ƒç”¨æ–¹ã€‚å¦‚æœBufferç”¨å®Œï¼Œåˆ™é‡æ–°åˆ†é…ä¸€ä¸ª; å¦‚æœè¿˜æœ‰å‰©ä½™ï¼Œåˆ™ç»§ç»­ä½¿ç”¨ã€‚ åˆ†é…ä¸€ä¸ªæ–°çš„Bufferå¯¹è±¡çš„æ“ä½œ: 12345var pool;function allocNewPool(poolSize) &#123; pool = new Buffer(poolSize); pool.used = 0;&#125; åœ¨ç†æƒ³çš„çŠ¶å†µä¸‹ï¼Œæ¯æ¬¡è¯»å–çš„é•¿åº¦å°±æ˜¯ç”¨æˆ·æŒ‡å®šçš„highWaterMarkã€‚ä½†æ˜¯æœ‰å¯èƒ½è¯»åˆ°äº†æ–‡ä»¶ç»“å°¾ï¼Œæˆ–è€…æ–‡ä»¶æœ¬èº«å°±æ²¡æœ‰æŒ‡å®šçš„highWaterMarké‚£ä¹ˆå¤§ï¼Œè¿™ä¸ªé¢„å…ˆæŒ‡å®šçš„Bufferå¯¹è±¡å°†ä¼šæœ‰éƒ¨åˆ† å‰©ä½™ï¼Œä¸è¿‡å¥½åœ¨è¿™é‡Œçš„å†…å­˜å¯ä»¥åˆ†é…ç»™ä¸‹æ¬¡è¯»å–æ—¶ä½¿ç”¨ã€‚poolæ˜¯å¸¸é©»å†…å­˜çš„ï¼Œåªæœ‰å½“poolå•å…ƒå‰© ä½™æ•°é‡å°äº128(kMinPoolSpace)å­—èŠ‚æ—¶ï¼Œæ‰ä¼šé‡æ–°åˆ†é…ä¸€ä¸ªæ–°çš„Bufferå¯¹è±¡ã€‚ highWaterMarkçš„å¤§å°å¯¹æ€§èƒ½æœ‰ä¸¤ä¸ªå½±å“çš„ç‚¹ highWaterMarkè®¾ç½®å¯¹Bufferå†…å­˜çš„åˆ†é…å’Œä½¿ç”¨æœ‰ä¸€å®šå½±å“ã€‚ highWaterMarkè®¾ç½®è¿‡å°ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°è¿‡å¤šã€‚ æ–‡ä»¶æµè¯»å–åŸºäºBufferåˆ†é…ï¼ŒBufferåˆ™åŸºäºSlowBufferåˆ†é… ç”±äºfs.createReadStream()å†…éƒ¨é‡‡ç”¨fs.read()å®ç°ï¼Œå°†ä¼šå¼•èµ·å¯¹ç£ç›˜çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹äºå¤§ æ–‡ä»¶è€Œè¨€ï¼ŒhighWaterMarkçš„å¤§å°å†³å®šä¼šè§¦å‘ç³»ç»Ÿè°ƒç”¨å’Œdataäº‹ä»¶çš„æ¬¡æ•°ã€‚ è¯»å–ä¸€ä¸ªç›¸åŒçš„å¤§æ–‡ä»¶æ—¶ï¼ŒhighWaterMarkå€¼çš„å¤§å°ä¸è¯»å–é€Ÿ åº¦çš„å…³ç³»:è¯¥å€¼è¶Šå¤§ï¼Œè¯»å–é€Ÿåº¦è¶Šå¿«ã€‚","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://yoursite.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://yoursite.com/tags/Node-js/"}]},{"title":"æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰","slug":"æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰","date":"2019-12-13T07:04:52.000Z","updated":"2019-12-29T07:11:37.454Z","comments":true,"path":"2019/12/13/æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰/","link":"","permalink":"http://yoursite.com/2019/12/13/æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰/","excerpt":"","text":"æ·±å…¥æµ…å‡ºNode.jså­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰é«˜å¹¶å‘ã€é«˜æ€§èƒ½ ç¬¬ä¸€ç«  Nodeç®€ä»‹ é«˜æ€§èƒ½ã€ç¬¦åˆäº‹ä»¶é©±åŠ¨ã€æ²¡æœ‰å†å²åŒ…è¢±è¿™3ä¸ªä¸»è¦åŸå› ï¼ŒJavaScriptæˆä¸ºäº†Nodeçš„å®ç°è¯­è¨€ã€‚ Nodeå‘å±•ä¸ºä¸€ä¸ªå¼ºåˆ¶ä¸å…±äº«ä»»ä½•èµ„æºçš„ å•çº¿ç¨‹ã€å•è¿›ç¨‹ç³»ç»Ÿï¼ŒåŒ…å«ååˆ†é€‚å®œç½‘ç»œçš„åº“ï¼Œä¸ºæ„å»ºå¤§å‹åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºæä¾›åŸºç¡€è®¾æ–½ï¼Œå…¶ç›® æ ‡ä¹Ÿæ˜¯æˆä¸ºä¸€ä¸ªæ„å»ºå¿«é€Ÿã€å¯ä¼¸ç¼©çš„ç½‘ç»œåº”ç”¨å¹³å°ã€‚å®ƒè‡ªèº«éå¸¸ç®€å•ï¼Œé€šè¿‡é€šä¿¡åè®®æ¥ç»„ç»‡è®¸å¤š Nodeï¼Œéå¸¸å®¹æ˜“é€šè¿‡æ‰©å±•æ¥è¾¾æˆæ„å»ºå¤§å‹ç½‘ç»œåº”ç”¨çš„ç›®çš„ã€‚æ¯ä¸€ä¸ªNodeè¿›ç¨‹éƒ½æ„æˆè¿™ä¸ªç½‘ç»œåº” ç”¨ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ˜¯å®ƒåå­—æ‰€å«æ„ä¹‰çš„çœŸè°›ã€‚ å®ƒä»¬éƒ½æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥æ¶æ„ï¼Œæµè§ˆå™¨é€šè¿‡äº‹ä»¶é©±åŠ¨æ¥æœåŠ¡ç•Œé¢ä¸Šçš„äº¤äº’ï¼ŒNodeé€šè¿‡äº‹ä»¶é©± åŠ¨æ¥æœåŠ¡I/O Nodeçš„ç‰¹ç‚¹å¼‚æ­¥I/O åœ¨Nodeä¸­ï¼Œç»å¤§å¤šæ•°çš„æ“ä½œéƒ½ä»¥å¼‚æ­¥çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ã€‚ åœ¨Nodeä¸­ï¼Œæˆ‘ä»¬å¯ ä»¥ä»è¯­è¨€å±‚é¢å¾ˆè‡ªç„¶åœ°è¿›è¡Œå¹¶è¡ŒI/Oæ“ä½œã€‚æ¯ä¸ªè°ƒç”¨ä¹‹é—´æ— é¡»ç­‰å¾…ä¹‹å‰çš„I/Oè°ƒç”¨ç»“æŸã€‚ äº‹ä»¶ä¸å›è°ƒå‡½æ•° äº‹ä»¶çš„ç¼–ç¨‹æ–¹å¼å…·æœ‰è½»é‡çº§ã€æ¾è€¦åˆã€åªå…³æ³¨äº‹åŠ¡ç‚¹ç­‰ä¼˜åŠ¿ï¼Œä½†æ˜¯åœ¨å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„åœºæ™¯ä¸‹ï¼Œ äº‹ä»¶ä¸äº‹ä»¶ä¹‹é—´å„è‡ªç‹¬ç«‹ï¼Œå¦‚ä½•åä½œæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ å›è°ƒå‡½æ•°æ— å¤„ä¸åœ¨ã€‚å›è°ƒå‡½æ•°æ˜¯æœ€å¥½çš„æ¥å—å¼‚æ­¥è°ƒç”¨è¿”å›æ•°æ®çš„æ–¹å¼ å•çº¿ç¨‹Nodeä¿æŒäº†JavaScriptåœ¨æµè§ˆå™¨ä¸­å•çº¿ç¨‹çš„ç‰¹ç‚¹ã€‚ åœ¨Nodeä¸­ï¼ŒJavaScriptä¸å…¶ä½™çº¿ç¨‹æ˜¯æ—  æ³•å…±äº«ä»»ä½•çŠ¶æ€çš„ã€‚ï¼ˆå•çº¿ç¨‹çš„æœ€å¤§å¥½å¤„æ˜¯ä¸ç”¨åƒå¤šçº¿ç¨‹ç¼–ç¨‹é‚£æ ·å¤„å¤„åœ¨æ„çŠ¶æ€çš„åŒæ­¥é—®é¢˜ï¼Œè¿™é‡Œ æ²¡æœ‰æ­»é”çš„å­˜åœ¨ï¼Œä¹Ÿæ²¡æœ‰çº¿ç¨‹ä¸Šä¸‹æ–‡äº¤æ¢æ‰€å¸¦æ¥çš„æ€§èƒ½ä¸Šçš„å¼€é”€ã€‚ï¼‰ å•çº¿ç¨‹çš„å¼±ç‚¹ï¼š æ— æ³•åˆ©ç”¨å¤šæ ¸CPU é”™è¯¯ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨é€€å‡ºï¼Œåº”ç”¨çš„å¥å£®æ€§å€¼å¾—è€ƒéªŒ å¤§é‡è®¡ç®—å ç”¨CPUå¯¼è‡´æ— æ³•ç»§ç»­è°ƒç”¨å¼‚æ­¥I/O åœ¨Nodeä¸­ï¼Œé•¿æ—¶é—´çš„CPUå ç”¨ä¹Ÿä¼šå¯¼è‡´åç»­çš„å¼‚æ­¥I/Oå‘ä¸å‡ºè°ƒç”¨ï¼Œå·²å®Œæˆçš„å¼‚æ­¥I/Oçš„ å›è°ƒå‡½æ•°ä¹Ÿä¼šå¾—ä¸åˆ°åŠæ—¶æ‰§è¡Œã€‚è§£å†³å•çº¿ç¨‹ä¸­å¤§è®¡ç®—é‡çš„é—®é¢˜â€”â€”child_process å­è¿›ç¨‹çš„å‡ºç°ï¼Œæ„å‘³ç€Nodeå¯ä»¥ä»å®¹åœ°åº”å¯¹å•çº¿ç¨‹åœ¨å¥å£®æ€§å’Œæ— æ³•åˆ©ç”¨å¤šæ ¸CPUæ–¹é¢çš„é—® é¢˜ã€‚é€šè¿‡å°†è®¡ç®—åˆ†å‘åˆ°å„ä¸ªå­è¿›ç¨‹ï¼Œå¯ä»¥å°†å¤§é‡è®¡ç®—åˆ†è§£æ‰ï¼Œç„¶åå†é€šè¿‡è¿›ç¨‹ä¹‹é—´çš„äº‹ä»¶æ¶ˆæ¯æ¥ ä¼ é€’ç»“æœï¼Œè¿™å¯ä»¥å¾ˆå¥½åœ°ä¿æŒåº”ç”¨æ¨¡å‹çš„ç®€å•å’Œä½ä¾èµ–ã€‚é€šè¿‡Master-Workerçš„ç®¡ç†æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ å¾ˆå¥½åœ°ç®¡ç†å„ä¸ªå·¥ä½œè¿›ç¨‹ï¼Œä»¥è¾¾åˆ°æ›´é«˜çš„å¥å£®æ€§ã€‚ è·¨å¹³å° å®ƒåœ¨æ“ä½œç³»ç»Ÿä¸Nodeä¸Šå±‚æ¨¡å— ç³»ç»Ÿä¹‹é—´æ„å»ºäº†ä¸€å±‚å¹³å°å±‚æ¶æ„ï¼Œå³libuvã€‚ï¼ˆlibuvå·²ç»æˆä¸ºè®¸å¤šç³»ç»Ÿå®ç°è·¨å¹³å°çš„åŸºç¡€ç»„ä»¶ï¼‰ Node çš„åº”ç”¨åœºæ™¯I/O å¯†é›†å‹Nodeæ“…é•¿I/Oå¯†é›†å‹çš„åº”ç”¨åœºæ™¯ã€‚Nodeé¢å‘ç½‘ç»œä¸”æ“…é•¿å¹¶è¡ŒI/Oï¼Œèƒ½å¤Ÿæœ‰æ•ˆ åœ°ç»„ç»‡èµ·æ›´å¤šçš„ç¡¬ä»¶èµ„æºï¼Œä»è€Œæä¾›æ›´å¤šå¥½çš„æœåŠ¡ã€‚ I/Oå¯†é›†çš„ä¼˜åŠ¿ä¸»è¦åœ¨äºNodeåˆ©ç”¨äº‹ä»¶å¾ªç¯çš„å¤„ç†èƒ½åŠ›ï¼Œè€Œä¸æ˜¯å¯åŠ¨æ¯ä¸€ä¸ªçº¿ç¨‹ä¸ºæ¯ä¸€ä¸ªè¯· æ±‚æœåŠ¡ï¼Œèµ„æºå ç”¨æå°‘ã€‚ CPUå¯†é›†å‹CPUå¯†é›†å‹åº”ç”¨ç»™Node å¸¦æ¥çš„æŒ‘æˆ˜ä¸»è¦æ˜¯:ç”±äºJavaScriptå•çº¿ç¨‹çš„åŸå› ï¼Œå¦‚æœæœ‰é•¿æ—¶é—´è¿è¡Œçš„è®¡ç®—(æ¯”å¦‚å¤§å¾ªç¯)ï¼Œå°† ä¼šå¯¼è‡´CPUæ—¶é—´ç‰‡ä¸èƒ½é‡Šæ”¾ï¼Œä½¿å¾—åç»­I/Oæ— æ³•å‘èµ·ã€‚ä½†æ˜¯é€‚å½“è°ƒæ•´å’Œåˆ†è§£å¤§å‹è¿ç®—ä»»åŠ¡ä¸ºå¤šä¸ª å°ä»»åŠ¡ï¼Œä½¿å¾—è¿ç®—èƒ½å¤Ÿé€‚æ—¶é‡Šæ”¾ï¼Œä¸é˜»å¡I/Oè°ƒç”¨çš„å‘èµ·ï¼Œè¿™æ ·æ—¢å¯åŒæ—¶äº«å—åˆ°å¹¶è¡Œå¼‚æ­¥I/Oçš„å¥½ å¤„ï¼Œåˆèƒ½å……åˆ†åˆ©ç”¨CPUã€‚ Nodeå¯ä»¥é€šè¿‡ç¼–å†™C/C++æ‰©å±•çš„æ–¹å¼æ›´é«˜æ•ˆåœ°åˆ©ç”¨CPUï¼Œå°†ä¸€äº›V8ä¸èƒ½åšåˆ°æ€§èƒ½æè‡´çš„åœ°æ–¹é€šè¿‡C/C++æ¥å®ç°ã€‚ç”±ä¸Šé¢çš„æµ‹è¯•ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡C/C++æ‰©å±•çš„æ–¹å¼å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—ï¼Œé€Ÿåº¦æ¯”Javaè¿˜å¿«ã€‚ å¦‚æœå•çº¿ç¨‹çš„Nodeä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œç”šè‡³ç”¨äº†C/C++æ‰©å±•åè¿˜è§‰å¾—ä¸å¤Ÿï¼Œé‚£ä¹ˆé€šè¿‡å­è¿›ç¨‹çš„æ–¹å¼ï¼Œå°†ä¸€éƒ¨åˆ†Nodeè¿›ç¨‹å½“åšå¸¸é©»æœåŠ¡è¿›ç¨‹ç”¨äºè®¡ç®—ï¼Œç„¶ååˆ©ç”¨è¿›ç¨‹é—´çš„æ¶ˆæ¯æ¥ä¼ é€’ç»“æœï¼Œå°†è®¡ç®—ä¸I/Oåˆ†ç¦»ï¼Œè¿™æ ·è¿˜èƒ½å……åˆ†åˆ©ç”¨å¤šCPUã€‚ CPUå¯†é›†ä¸å¯æ€•ï¼Œå¦‚ä½•åˆç†è°ƒåº¦æ˜¯è¯€çªã€‚ åˆ†å¸ƒå¼åº”ç”¨Nodeé«˜æ•ˆåˆ©ç”¨å¹¶è¡ŒI/Oçš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯é«˜æ•ˆä½¿ç”¨æ•° æ®åº“çš„è¿‡ç¨‹ ç¬¬äºŒç«  æ¨¡å—æœºåˆ¶CommonJSJavaScriptç¼ºé™· æ²¡æœ‰æ¨¡å—ç³»ç»Ÿ æ ‡å‡†åº“è¾ƒå°‘ æ²¡æœ‰æ ‡å‡†æ¥å£ ç¼ºä¹åŒ…ç®¡ç†ç³»ç»Ÿ CommonJSè§„èŒƒçš„æå‡ºï¼Œä¸»è¦æ˜¯ä¸ºäº†å¼¥è¡¥å½“å‰JavaScriptæ²¡æœ‰æ ‡å‡†çš„ç¼ºé™· CommonJS çš„æ¨¡å—è§„èŒƒ æ¨¡å—å¼•ç”¨ 1var math = require('math'); æ¨¡å—å®šä¹‰ ä¸Šä¸‹æ–‡æä¾›äº† exportså¯¹è±¡ç”¨äºå¯¼å‡ºå½“å‰æ¨¡å—çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå¹¶ä¸”å®ƒæ˜¯å”¯ä¸€å¯¼å‡ºçš„å‡ºå£ã€‚ åœ¨æ¨¡å—ä¸­ï¼Œè¿˜å­˜åœ¨ ä¸€ä¸ªmoduleå¯¹è±¡ï¼Œå®ƒä»£è¡¨æ¨¡å—è‡ªèº«ï¼Œè€Œexportsæ˜¯moduleçš„å±æ€§ã€‚ åœ¨Nodeä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ª æ¨¡å—ï¼Œå°†æ–¹æ³•æŒ‚è½½åœ¨exportså¯¹è±¡ä¸Šä½œä¸ºå±æ€§å³å¯å®šä¹‰å¯¼å‡ºçš„æ–¹å¼ã€‚ 1234567891011// math.jsexports.add = function () &#123; var sum = 0, i = 0, args = arguments, l = args.length; while (i &lt; l) &#123; sum += args[i++]; &#125; return sum; &#125;; æ¨¡å—æ ‡è¯† æ¨¡å—æ ‡è¯†å…¶å®å°±æ˜¯ä¼ é€’ç»™require()æ–¹æ³•çš„å‚æ•°ï¼Œå®ƒå¿…é¡»æ˜¯ç¬¦åˆå°é©¼å³°å‘½åçš„å­—ç¬¦ä¸²ï¼Œæˆ–è€… ä»¥.ã€..å¼€å¤´çš„ç›¸å¯¹è·¯å¾„ï¼Œæˆ–è€…ç»å¯¹è·¯å¾„ã€‚å®ƒå¯ä»¥æ²¡æœ‰æ–‡ä»¶ååç¼€.jsã€‚ å®ƒçš„æ„ä¹‰åœ¨äºå°†ç±»èšçš„æ–¹æ³•å’Œå˜é‡ç­‰é™å®šåœ¨ç§æœ‰çš„ ä½œç”¨åŸŸä¸­ï¼ŒåŒæ—¶æ”¯æŒå¼•å…¥å’Œå¯¼å‡ºåŠŸèƒ½ä»¥é¡ºç•…åœ°è¿æ¥ä¸Šä¸‹æ¸¸ä¾èµ–ã€‚ Node çš„æ¨¡å—å®ç°åœ¨Nodeä¸­å¼•å…¥æ¨¡å—ï¼Œéœ€è¦ç»å†å¦‚ä¸‹3ä¸ªæ­¥éª¤ã€‚ è·¯å¾„åˆ†æ æ–‡ä»¶å®šä½ ç¼–è¯‘æ‰§è¡Œ åœ¨Nodeä¸­ï¼Œæ¨¡å—åˆ†ä¸ºä¸¤ç±»:ä¸€ç±»æ˜¯Nodeæä¾›çš„æ¨¡å—ï¼Œç§°ä¸ºæ ¸å¿ƒæ¨¡å—;å¦ä¸€ç±»æ˜¯ç”¨æˆ·ç¼–å†™çš„æ¨¡å—ï¼Œç§°ä¸ºæ–‡ä»¶æ¨¡å—ã€‚ æ ¸å¿ƒæ¨¡å—éƒ¨åˆ†åœ¨Nodeæºä»£ç çš„ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œç¼–è¯‘è¿›äº†äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶ã€‚åœ¨Nodeè¿›ç¨‹å¯åŠ¨ æ—¶ï¼Œéƒ¨åˆ†æ ¸å¿ƒæ¨¡å—å°±è¢«ç›´æ¥åŠ è½½è¿›å†…å­˜ä¸­ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†æ ¸å¿ƒæ¨¡å—å¼•å…¥æ—¶ï¼Œæ–‡ä»¶å®šä½å’Œç¼– è¯‘æ‰§è¡Œè¿™ä¸¤ä¸ªæ­¥éª¤å¯ä»¥çœç•¥æ‰ï¼Œå¹¶ä¸”åœ¨è·¯å¾„åˆ†æä¸­ä¼˜å…ˆåˆ¤æ–­ï¼Œæ‰€ä»¥å®ƒçš„åŠ è½½é€Ÿåº¦æ˜¯æœ€ å¿«çš„ã€‚ æ–‡ä»¶æ¨¡å—åˆ™æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ï¼Œéœ€è¦å®Œæ•´çš„è·¯å¾„åˆ†æã€æ–‡ä»¶å®šä½ã€ç¼–è¯‘æ‰§è¡Œè¿‡ç¨‹ï¼Œé€Ÿ åº¦æ¯”æ ¸å¿ƒæ¨¡å—æ…¢ã€‚ ä¼˜å…ˆä»ç¼“å­˜åŠ è½½Nodeå¯¹å¼•å…¥è¿‡çš„æ¨¡å—éƒ½ä¼šè¿›è¡Œç¼“å­˜ï¼Œä»¥å‡å°‘äºŒæ¬¡å¼•å…¥æ—¶çš„å¼€é”€ã€‚Nodeç¼“å­˜çš„äº‹ç¼–è¯‘å’Œæ‰§è¡Œä¹‹åçš„å¯¹è±¡ã€‚ ä¸è®ºæ˜¯æ ¸å¿ƒæ¨¡å—è¿˜æ˜¯æ–‡ä»¶æ¨¡å—ï¼Œrequire()æ–¹æ³•å¯¹ç›¸åŒæ¨¡å—çš„äºŒæ¬¡åŠ è½½éƒ½ä¸€å¾‹é‡‡ç”¨ç¼“å­˜ä¼˜å…ˆçš„ æ–¹å¼ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§çš„ã€‚ä¸åŒä¹‹å¤„åœ¨äºæ ¸å¿ƒæ¨¡å—çš„ç¼“å­˜æ£€æŸ¥å…ˆäºæ–‡ä»¶æ¨¡å—çš„ç¼“å­˜æ£€æŸ¥ã€‚ è·¯å¾„åˆ†æå’Œæ–‡ä»¶å®šä½æ¨¡å—è·¯å¾„æ¨¡å—è·¯å¾„æ˜¯Nodeåœ¨å®šä½æ–‡ä»¶æ¨¡å—çš„å…·ä½“æ–‡ä»¶æ—¶åˆ¶å®šçš„æŸ¥æ‰¾ç­–ç•¥ï¼Œå…·ä½“è¡¨ç°ä¸ºä¸€ä¸ªè·¯å¾„ç»„æˆçš„æ•°ç»„ã€‚ æ¨¡å—è·¯å¾„çš„ç”Ÿæˆè§„åˆ™ï¼š å½“å‰æ–‡ä»¶ç›®å½•ä¸‹çš„node_modulesç›®å½•ã€‚ çˆ¶ç›®å½•ä¸‹çš„node_modulesç›®å½•ã€‚ çˆ¶ç›®å½•çš„çˆ¶ç›®å½•ä¸‹çš„node_modulesç›®å½•ã€‚ æ²¿è·¯å¾„å‘ä¸Šé€çº§é€’å½’ï¼Œç›´åˆ°æ ¹ç›®å½•ä¸‹çš„node_modulesç›®å½•ã€‚ æ¨¡å—æ ‡è¯†ç¬¦åˆ†ææ¨¡å—æ ‡è¯†ç¬¦åœ¨Nodeä¸­ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ã€‚ æ ¸å¿ƒæ¨¡å—ï¼Œå¦‚httpã€fsã€pathç­‰ã€‚ .æˆ–..å¼€å§‹çš„ç›¸å¯¹è·¯å¾„æ–‡ä»¶æ¨¡å—ã€‚ ä»¥/å¼€å§‹çš„ç»å¯¹è·¯å¾„æ–‡ä»¶æ¨¡å—ã€‚ éè·¯å¾„å½¢å¼çš„æ–‡ä»¶æ¨¡å—ï¼Œå¦‚è‡ªå®šä¹‰çš„connectæ¨¡å—ã€‚ æ ¸å¿ƒæ¨¡å— æ ¸å¿ƒæ¨¡å—çš„ä¼˜å…ˆçº§ä»…æ¬¡äºç¼“å­˜åŠ è½½ï¼Œå®ƒåœ¨Nodeçš„æºä»£ç ç¼–è¯‘è¿‡ç¨‹ä¸­å·²ç»ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶ä»£ç ï¼Œ å…¶åŠ è½½è¿‡ç¨‹æœ€å¿«ã€‚ ï¼ˆå¦‚æœåŠ è½½ä¸€ä¸ªä¸æ ¸å¿ƒæ¨¡å—æ ‡è¯†ç¬¦ç›¸åŒçš„è‡ªå®šä¹‰æ¨¡å—ï¼Œä¸ä¼šæˆåŠŸã€‚å¦‚æœè‡ªå·±ç¼–å†™äº†ä¸€ä¸ªhttpç”¨æˆ·æ¨¡å—ï¼Œæƒ³è¦åŠ è½½æˆåŠŸï¼Œå¿…é¡»é€‰æ‹©ä¸åŒçš„æ ‡è¯†ç¬¦æˆ–æ¢ç”¨è·¯å¾„æ–¹å¼ï¼‰ è·¯å¾„å½¢å¼çš„æ–‡ä»¶æ¨¡å— åœ¨åˆ†ææ–‡ä»¶æ¨¡å—æ—¶ï¼Œrequire()æ–¹æ³•ä¼šå°†è·¯å¾„è½¬ä¸ºçœŸå®è·¯å¾„ï¼Œå¹¶ä»¥çœŸå®è·¯å¾„ä½œä¸ºç´¢å¼•ï¼Œå°†ç¼–è¯‘æ‰§è¡Œåçš„ç»“æœå­˜æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œä»¥ä½¿äºŒ æ¬¡åŠ è½½æ—¶æ›´å¿«ã€‚ ï¼ˆæ–‡ä»¶æ¨¡å—æŒ‡æ˜äº†ç¡®åˆ‡çš„æ–‡ä»¶ä½ç½®ï¼Œåœ¨æŸ¥æ‰¾ä¸­ä¼šèŠ‚çº¦æ—¶é—´ï¼ŒåŠ è½½é€Ÿåº¦æ…¢äºæ ¸å¿ƒæ¨¡å—ï¼‰ è‡ªå®šä¹‰æ¨¡å— å®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶æ¨¡å—ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶æˆ–è€…åŒ…çš„å½¢å¼ã€‚è¿™ç±»æ¨¡å—çš„æŸ¥æ‰¾æ˜¯æœ€è´¹æ—¶çš„ï¼Œä¹Ÿæ˜¯æ‰€æœ‰æ–¹å¼ä¸­æœ€æ…¢çš„ä¸€ç§ã€‚ åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼ŒNode ä¼šé€ä¸ªå°è¯•æ¨¡å—è·¯å¾„ä¸­çš„è·¯å¾„ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ä¸ºæ­¢ã€‚å¯ä»¥çœ‹å‡ºï¼Œå½“å‰æ–‡ä»¶çš„è·¯å¾„è¶Šæ·±ï¼Œæ¨¡å—æŸ¥æ‰¾è€—æ—¶ä¼šè¶Šå¤šï¼Œè¿™æ˜¯è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½é€Ÿåº¦æ˜¯æœ€æ…¢çš„åŸå› ã€‚ æ–‡ä»¶å®šä½ æ–‡ä»¶æ‰©å±•ååˆ†æï¼š require()åœ¨åˆ†ææ ‡è¯†ç¬¦çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå‡ºç°æ ‡è¯†ç¬¦ä¸­ä¸åŒ…å«æ–‡ä»¶æ‰©å±•åçš„æƒ…å†µã€‚CommonJSæ¨¡å—è§„èŒƒä¹Ÿå…è®¸åœ¨æ ‡è¯†ç¬¦ä¸­ä¸åŒ…å«æ–‡ä»¶æ‰©å±•åï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒNodeä¼šæŒ‰.jsã€.jsonã€.nodeçš„æ¬¡åºè¡¥ è¶³æ‰©å±•åï¼Œä¾æ¬¡å°è¯•ã€‚ åœ¨å°è¯•çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è°ƒç”¨fsæ¨¡å—åŒæ­¥é˜»å¡å¼åœ°åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚å› ä¸ºNodeæ˜¯å•çº¿ç¨‹çš„ï¼Œ æ‰€ä»¥è¿™é‡Œæ˜¯ä¸€ä¸ªä¼šå¼•èµ·æ€§èƒ½é—®é¢˜çš„åœ°æ–¹ã€‚ ï¼ˆå¦‚æœæ˜¯.nodeå’Œ.jsonæ–‡ä»¶ï¼Œåœ¨ä¼ é€’ç»™require() çš„æ ‡è¯†ç¬¦ä¸­å¸¦ä¸Šæ‰©å±•åï¼Œä¼šåŠ å¿«ä¸€ç‚¹é€Ÿåº¦ã€‚åŒæ­¥é…åˆç¼“å­˜ï¼Œå¯ä»¥å¤§å¹…åº¦ç¼“è§£Node å•çº¿ç¨‹ä¸­é˜»å¡å¼è°ƒç”¨çš„ç¼ºé™·ã€‚ï¼‰ ç›®å½•åˆ†æå’ŒåŒ… åœ¨åˆ†ææ ‡è¯†ç¬¦çš„è¿‡ç¨‹ä¸­ï¼Œrequire()é€šè¿‡åˆ†ææ–‡ä»¶æ‰©å±•åä¹‹åï¼Œå¯èƒ½æ²¡æœ‰æŸ¥æ‰¾åˆ°å¯¹åº”æ–‡ä»¶ï¼Œä½†å´å¾—åˆ°ä¸€ä¸ªç›®å½•ï¼Œè¿™åœ¨å¼•å…¥è‡ªå®šä¹‰æ¨¡å—å’Œé€ä¸ªæ¨¡å—è·¯å¾„è¿›è¡ŒæŸ¥æ‰¾æ—¶ç»å¸¸ä¼šå‡ºç°ï¼Œæ­¤æ—¶Nodeä¼šå°†ç›®å½•å½“åšä¸€ä¸ªåŒ…æ¥å¤„ç†ã€‚ Nodeåœ¨å½“å‰ç›®å½•ä¸‹ æŸ¥æ‰¾package.json(CommonJSåŒ…è§„èŒƒå®šä¹‰çš„åŒ…æè¿°æ–‡ä»¶)ï¼Œé€šè¿‡JSON.parse()è§£æå‡ºåŒ…æè¿°å¯¹è±¡ï¼Œ ä»ä¸­å–å‡ºmainå±æ€§æŒ‡å®šçš„æ–‡ä»¶åè¿›è¡Œå®šä½ã€‚å¦‚æœæ–‡ä»¶åç¼ºå°‘æ‰©å±•åï¼Œå°†ä¼šè¿›å…¥æ‰©å±•ååˆ†æçš„æ­¥éª¤ã€‚ è€Œå¦‚æœmainå±æ€§æŒ‡å®šçš„æ–‡ä»¶åé”™è¯¯ï¼Œæˆ–è€…å‹æ ¹æ²¡æœ‰package.jsonæ–‡ä»¶ï¼ŒNodeä¼šå°†indexå½“åšé»˜ è®¤æ–‡ä»¶åï¼Œç„¶åä¾æ¬¡æŸ¥æ‰¾index.jsã€index.jsonã€index.nodeã€‚ å¦‚æœåœ¨ç›®å½•åˆ†æçš„è¿‡ç¨‹ä¸­æ²¡æœ‰å®šä½æˆåŠŸä»»ä½•æ–‡ä»¶ï¼Œåˆ™è‡ªå®šä¹‰æ¨¡å—è¿›å…¥ä¸‹ä¸€ä¸ªæ¨¡å—è·¯å¾„è¿›è¡ŒæŸ¥ æ‰¾ã€‚ å¦‚æœæ¨¡å—è·¯å¾„æ•°ç»„éƒ½è¢«éå†å®Œæ¯•ï¼Œä¾ç„¶æ²¡æœ‰æŸ¥æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œåˆ™ä¼šæŠ›å‡ºæŸ¥æ‰¾å¤±è´¥çš„å¼‚å¸¸ã€‚ æ¨¡å—ç¼–è¯‘åœ¨Nodeä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶æ¨¡å—éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ å®šä½åˆ°å…·ä½“çš„æ–‡ä»¶åï¼ŒNodeä¼šæ–°å»ºä¸€ä¸ªæ¨¡å—å¯¹ è±¡ï¼Œç„¶åæ ¹æ®è·¯å¾„è½½å…¥å¹¶ç¼–è¯‘ã€‚å¯¹äºä¸åŒçš„æ–‡ä»¶æ‰©å±•åï¼Œå…¶è½½å…¥æ–¹æ³•æœ‰æ‰€ä¸åŒ .jsæ–‡ä»¶ã€‚é€šè¿‡fsæ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åç¼–è¯‘æ‰§è¡Œã€‚ .nodeæ–‡ä»¶ã€‚è¿™æ˜¯ç”¨C/C++ç¼–å†™çš„æ‰©å±•æ–‡ä»¶ï¼Œé€šè¿‡dlopen()æ–¹æ³•åŠ è½½æœ€åç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ã€‚ .jsonæ–‡ä»¶ã€‚é€šè¿‡fsæ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åï¼Œç”¨JSON.parse()è§£æè¿”å›ç»“æœã€‚ å…¶ä½™æ‰©å±•åæ–‡ä»¶ã€‚å®ƒä»¬éƒ½è¢«å½“åš.jsæ–‡ä»¶è½½å…¥ã€‚ æ¯ä¸€ä¸ªç¼–è¯‘æˆåŠŸçš„æ¨¡å—éƒ½ä¼šå°†å…¶æ–‡ä»¶è·¯å¾„ä½œä¸ºç´¢å¼•ç¼“å­˜åœ¨Module._cacheå¯¹è±¡ä¸Šï¼Œä»¥æé«˜äºŒ æ¬¡å¼•å…¥çš„æ€§èƒ½ã€‚ åœ¨ç¡®å®šæ–‡ä»¶çš„æ‰©å±•åä¹‹åï¼ŒNodeå°†è°ƒç”¨å…·ä½“çš„ç¼–è¯‘æ–¹å¼æ¥å°†æ–‡ä»¶æ‰§è¡Œåè¿”å›ç»™è°ƒç”¨è€…ã€‚ JavaScriptæ¨¡å—çš„ç¼–è¯‘åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼ŒNodeå¯¹è·å–çš„JavaScriptæ–‡ä»¶å†…å®¹è¿›è¡Œäº†å¤´å°¾åŒ…è£…ã€‚ åœ¨å¤´éƒ¨æ·»åŠ  äº†(function (exports, require, module, __filename, __dirname) {\\nï¼Œåœ¨å°¾éƒ¨æ·»åŠ äº†\\n});ã€‚ 123456(function (exports, require, module, __filename, __dirname) &#123; var math = require('math'); exports.area = function (radius) &#123; return Math.PI * radius * radius; &#125;; &#125;); è¿™æ ·æ¯ä¸ªæ¨¡å—æ–‡ä»¶ä¹‹é—´éƒ½è¿›è¡Œäº†ä½œç”¨åŸŸéš”ç¦»ã€‚ åŒ…è£…ä¹‹åçš„ä»£ç ä¼šé€šè¿‡vmåŸç”Ÿæ¨¡å—çš„runInThisContext()æ–¹æ³•æ‰§è¡Œ(ç±»ä¼¼evalï¼Œåªæ˜¯å…·æœ‰æ˜ç¡®ä¸Šä¸‹æ–‡ï¼Œä¸æ±¡æŸ“å…¨å±€)ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“çš„ functionå¯¹è±¡ã€‚ å°†å½“å‰æ¨¡å—å¯¹è±¡çš„exportså±æ€§ã€require()æ–¹æ³•ã€module(æ¨¡å—å¯¹è±¡è‡ªèº«)ï¼Œ ä»¥åŠåœ¨æ–‡ä»¶å®šä½ä¸­å¾—åˆ°çš„å®Œæ•´æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶ç›®å½•ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªfunction()æ‰§è¡Œã€‚ exportså¯¹è±¡æ˜¯é€šè¿‡å½¢å‚çš„æ–¹å¼ä¼ å…¥çš„ï¼Œç›´æ¥èµ‹å€¼å½¢å‚ä¼šæ”¹å˜å½¢å‚çš„å¼•ç”¨ï¼Œä½†å¹¶ä¸èƒ½æ”¹å˜ä½œç”¨åŸŸå¤–çš„å€¼ã€‚(å¦‚æœè¦è¾¾åˆ°requireå¼•å…¥ä¸€ä¸ªç±»çš„æ•ˆæœï¼Œè¯·èµ‹å€¼ç»™module.exportså¯¹è±¡ã€‚) C/C++æ¨¡å—çš„ç¼–è¯‘Nodeè°ƒç”¨process.dlopen()æ–¹æ³•è¿›è¡ŒåŠ è½½å’Œæ‰§è¡Œã€‚åœ¨Nodeçš„æ¶æ„ä¸‹ï¼Œdlopen()æ–¹æ³•åœ¨Windows å’Œ*nixå¹³å°ä¸‹åˆ†åˆ«æœ‰ä¸åŒçš„å®ç°ï¼Œé€šè¿‡libuvå…¼å®¹å±‚è¿›è¡Œäº†å°è£…ã€‚ å®ƒæ˜¯ç¼–å†™C/C++æ¨¡å—ä¹‹åç¼–è¯‘ç”Ÿæˆçš„ï¼Œæ‰€ä»¥è¿™ é‡Œåªæœ‰åŠ è½½å’Œæ‰§è¡Œçš„è¿‡ç¨‹ã€‚åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å—çš„exportså¯¹è±¡ä¸.nodeæ¨¡å—äº§ç”Ÿè”ç³»ï¼Œç„¶åè¿” å›ç»™è°ƒç”¨è€…ã€‚ ä¼˜åŠ¿ï¼šæ‰§è¡Œæ•ˆç‡ åŠ£åŠ¿ï¼šç¼–å†™é—¨æ§›é«˜ JSONæ–‡ä»¶çš„ç¼–è¯‘Nodeåˆ©ç”¨fsæ¨¡å—åŒæ­¥è¯»å–JSONæ–‡ä»¶çš„å†…å®¹ä¹‹ åï¼Œè°ƒç”¨JSON.parse()æ–¹æ³•å¾—åˆ°å¯¹è±¡ï¼Œç„¶åå°†å®ƒèµ‹ç»™æ¨¡å—å¯¹è±¡çš„exportsï¼Œä»¥ä¾›å¤–éƒ¨è°ƒç”¨ã€‚ ï¼ˆå®šä¹‰äº†ä¸€ä¸ªJSONæ–‡ä»¶ä½œä¸ºé…ç½®ï¼Œé‚£å°± ä¸å¿…è°ƒç”¨fsæ¨¡å—å»å¼‚æ­¥è¯»å–å’Œè§£æï¼Œç›´æ¥è°ƒç”¨require()å¼•å…¥å³å¯ï¼‰ æ ¸å¿ƒæ¨¡å—æ ¸å¿ƒæ¨¡å—C/C++æ–‡ä»¶å­˜æ”¾åœ¨Nodeé¡¹ç›®çš„srcç›®å½•ä¸‹ï¼Œ JavaScriptæ–‡ä»¶å­˜æ”¾åœ¨libç›®å½•ä¸‹ã€‚ JavaScript æ ¸å¿ƒæ¨¡å—çš„ç¼–è¯‘è¿‡ç¨‹è½¬å­˜ä¸ºC/C++ä»£ç Nodeé‡‡ç”¨äº†V8é™„å¸¦çš„js2c.pyå·¥å…·ï¼Œå°†æ‰€æœ‰å†…ç½®çš„JavaScriptä»£ç (src/node.jså’Œlib/*.js)è½¬æ¢ æˆC++é‡Œçš„æ•°ç»„ï¼Œç”Ÿæˆnode_natives.hå¤´æ–‡ä»¶ JavaScriptä»£ç ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨åœ¨nodeå‘½åç©ºé—´ä¸­ï¼Œæ˜¯ä¸å¯ç›´æ¥æ‰§è¡Œçš„ã€‚ åœ¨å¯åŠ¨Nodeè¿›ç¨‹æ—¶ï¼ŒJavaScriptä»£ç ç›´æ¥åŠ è½½è¿›å†…å­˜ä¸­ã€‚åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼ŒJavaScriptæ ¸å¿ƒæ¨¡å—ç» å†æ ‡è¯†ç¬¦åˆ†æåç›´æ¥å®šä½åˆ°å†…å­˜ä¸­ï¼Œæ¯”æ™®é€šçš„æ–‡ä»¶æ¨¡å—ä»ç£ç›˜ä¸­ä¸€å¤„ä¸€å¤„æŸ¥æ‰¾è¦å¿«å¾ˆå¤šã€‚ ç¼–è¯‘JavaScriptæ ¸å¿ƒæ¨¡å—libç›®å½•ä¸‹çš„æ‰€æœ‰æ¨¡å—æ–‡ä»¶ä¹Ÿæ²¡æœ‰å®šä¹‰requireã€moduleã€exportsè¿™äº›å˜é‡ã€‚åœ¨å¼•å…¥JavaScript æ ¸å¿ƒæ¨¡å—çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿç»å†äº†å¤´å°¾åŒ…è£…çš„è¿‡ç¨‹ï¼Œç„¶åæ‰æ‰§è¡Œå’Œå¯¼å‡ºäº†exportså¯¹è±¡ã€‚ä¸æ–‡ä»¶æ¨¡å—æœ‰åŒºåˆ«çš„åœ°æ–¹åœ¨äº:è·å–æºä»£ç çš„æ–¹å¼(æ ¸å¿ƒæ¨¡å—æ˜¯ä»å†…å­˜ä¸­åŠ è½½çš„)ä»¥åŠç¼“å­˜æ‰§è¡Œç»“æœçš„ä½ç½®ã€‚ æºæ–‡ä»¶é€šè¿‡process.binding(â€˜nativesâ€™)å–å‡ºï¼Œ ç¼–è¯‘æˆåŠŸçš„æ¨¡å—ç¼“å­˜åˆ°NativeModule._cacheå¯¹è±¡ä¸Šï¼Œæ–‡ä»¶æ¨¡å—åˆ™ç¼“å­˜åˆ°Module._cacheå¯¹è±¡ä¸Š C/C++æ ¸å¿ƒæ¨¡å—çš„ç¼–è¯‘è¿‡ç¨‹C++æ¨¡å—ä¸»å†…å®Œæˆæ ¸å¿ƒï¼ŒJavaScript ä¸»å¤–å®ç°å°è£…çš„æ¨¡å¼æ˜¯Nodeèƒ½å¤Ÿæé«˜æ€§èƒ½çš„å¸¸è§æ–¹å¼ã€‚ ç”±çº¯C/C++ç¼–å†™çš„éƒ¨åˆ†ç»Ÿä¸€ç§°ä¸ºå†…å»ºæ¨¡å—ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä¸è¢«ç”¨æˆ·ç›´æ¥è°ƒ ç”¨ã€‚ å†…å»ºæ¨¡å—Nodeæä¾›äº†get_builtin_module()æ–¹æ³•ä»node_module_list æ•°ç»„ä¸­å–å‡ºè¿™äº›æ¨¡å— å†…å»ºæ¨¡å—çš„ä¼˜åŠ¿åœ¨äºï¼š å®ƒä»¬æœ¬èº«ç”±C/C++ç¼–å†™ï¼Œæ€§èƒ½ä¸Šä¼˜äºè„šæœ¬è¯­è¨€ åœ¨è¿›è¡Œæ–‡ä»¶ç¼–è¯‘æ—¶ï¼Œå®ƒä»¬è¢«ç¼–è¯‘è¿›äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä¸€æ—¦Nodeå¼€å§‹æ‰§è¡Œï¼Œå®ƒä»¬è¢«ç›´æ¥åŠ è½½è¿›å†…å­˜ä¸­ï¼Œæ— é¡»å† æ¬¡åšæ ‡è¯†ç¬¦å®šä½ã€æ–‡ä»¶å®šä½ã€ç¼–è¯‘ç­‰è¿‡ç¨‹ï¼Œç›´æ¥å°±å¯æ‰§è¡Œã€‚ åœ¨Nodeçš„æ‰€æœ‰æ¨¡å—ç±»å‹ä¸­ï¼Œå­˜åœ¨ç€å¦‚å›¾2-4æ‰€ç¤ºçš„ä¸€ç§ä¾èµ–å±‚çº§å…³ç³»ï¼Œå³æ–‡ä»¶æ¨¡å—å¯èƒ½ä¼šä¾ èµ–æ ¸å¿ƒæ¨¡å—ï¼Œæ ¸å¿ƒæ¨¡å—å¯èƒ½ä¼šä¾èµ–å†…å»ºæ¨¡å—ã€‚ åŠ è½½å†…å»ºæ¨¡å—ï¼š åœ¨åŠ è½½å†…å»ºæ¨¡å—æ—¶ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªexportsç©ºå¯¹è±¡ ç„¶åè°ƒç”¨get_builtin_module()æ–¹æ³•å– å‡ºå†…å»ºæ¨¡å—å¯¹è±¡ï¼Œé€šè¿‡æ‰§è¡Œregister_func()å¡«å……exportså¯¹è±¡ æœ€åå°†exportså¯¹è±¡æŒ‰æ¨¡å—åç¼“å­˜ï¼Œå¹¶è¿”å›ç»™è°ƒç”¨æ–¹å®Œæˆå¯¼å‡ºã€‚ æ ¸å¿ƒæ¨¡å—çš„å¼•å…¥æµç¨‹ ç¼–å†™æ ¸å¿ƒæ¨¡å— ç¼–å†™å¤´æ–‡ä»¶ ç¼–å†™C/C++æ–‡ä»¶ C/C++æ‰©å±•æ¨¡å—C/C++æ‰©å±•æ¨¡å—å±äºæ–‡ä»¶æ¨¡å—ä¸­çš„ä¸€ç±»ã€‚ ä¸ºäº†å®ç°è·¨å¹³å°ï¼Œdlopen()æ–¹æ³•åœ¨å†…éƒ¨å®ç°æ—¶åŒº åˆ†äº†å¹³å°ï¼Œåˆ†åˆ«ç”¨çš„æ˜¯åŠ è½½.soå’Œ.dllçš„æ–¹å¼ã€‚ï¼ˆä¸€ä¸ªå¹³å°ä¸‹çš„.nodeæ–‡ä»¶åœ¨å¦ä¸€ä¸ªå¹³å°ä¸‹æ˜¯æ— æ³•åŠ è½½æ‰§è¡Œçš„ï¼Œå¿…é¡»é‡æ–°ç”¨å„ è‡ªå¹³å°ä¸‹çš„ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºæ­£ç¡®çš„.nodeæ–‡ä»¶ã€‚ï¼‰ require()åœ¨å¼•å…¥.nodeæ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼š è°ƒç”¨uv_dlopen()æ–¹æ³•å»æ‰“å¼€åŠ¨æ€é“¾æ¥åº“ è°ƒç”¨uv_dlsym()æ–¹æ³•æ‰¾åˆ°åŠ¨æ€é“¾æ¥åº“ä¸­é€šè¿‡NODE_MODULEå®å®šä¹‰çš„æ–¹æ³•åœ°å€ è¿™ ä¸¤ä¸ªè¿‡ç¨‹éƒ½æ˜¯é€šè¿‡libuvåº“è¿›è¡Œå°è£…çš„:åœ¨*nixå¹³å°ä¸‹å®é™…ä¸Šè°ƒç”¨çš„æ˜¯dlfcn.hå¤´æ–‡ä»¶ä¸­å®šä¹‰çš„ dlopen()å’Œdlsym()ä¸¤ä¸ªæ–¹æ³•;åœ¨Windowså¹³å°åˆ™æ˜¯é€šè¿‡LoadLibraryExW()å’ŒGetProcAddress()è¿™ä¸¤ ä¸ªæ–¹æ³•å®ç°çš„ï¼Œå®ƒä»¬åˆ†åˆ«åŠ è½½.soå’Œ.dllæ–‡ä»¶(å®é™…ä¸º.nodeæ–‡ä»¶)ã€‚ æ¨¡å—è°ƒç”¨æ ˆ C/C++å†…å»ºæ¨¡å—å±äºæœ€åº•å±‚çš„æ¨¡å—ï¼Œå®ƒå±äºæ ¸å¿ƒæ¨¡å—ï¼Œä¸»è¦æä¾›APIç»™JavaScriptæ ¸å¿ƒæ¨¡å—å’Œ ç¬¬ä¸‰æ–¹JavaScriptæ–‡ä»¶æ¨¡å—è°ƒç”¨ã€‚ JavaScriptæ ¸å¿ƒæ¨¡å—ä¸»è¦æ‰®æ¼”çš„èŒè´£æœ‰ä¸¤ç±»: ä¸€ç±»æ˜¯ä½œä¸ºC/C++å†…å»ºæ¨¡å—çš„å°è£…å±‚å’Œæ¡¥æ¥å±‚ï¼Œ ä¾›æ–‡ä»¶æ¨¡å—è°ƒç”¨; ä¸€ç±»æ˜¯çº¯ç²¹çš„åŠŸèƒ½æ¨¡å— æ–‡ä»¶æ¨¡å—é€šå¸¸ç”±ç¬¬ä¸‰æ–¹ç¼–å†™ï¼ŒåŒ…æ‹¬æ™®é€šJavaScriptæ¨¡å—å’ŒC/C++æ‰©å±•æ¨¡å—ï¼Œä¸»è¦è°ƒç”¨æ–¹å‘ä¸ºæ™®é€šJavaScriptæ¨¡å—è°ƒç”¨æ‰©å±•æ¨¡å—ã€‚ åŒ…ä¸NPM ç”±åŒ…ç»“æ„å’ŒåŒ…æè¿°æ–‡ä»¶ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå‰è€…ç”¨äºç»„ç»‡åŒ…ä¸­çš„å„ç§æ–‡ä»¶ï¼Œåè€…åˆ™ç”¨äºæè¿°åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼Œä»¥ä¾›å¤–éƒ¨è¯»å–åˆ†æã€‚ åŒ…ç»“æ„åŒ…å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­˜æ¡£æ–‡ä»¶ï¼Œå³ä¸€ä¸ªç›®å½•ç›´æ¥æ‰“åŒ…ä¸º.zipæˆ–tar.gzæ ¼å¼çš„æ–‡ä»¶ï¼Œå®‰è£…åè§£å‹è¿˜åŸä¸ºç›®å½•ã€‚ å®Œå…¨ç¬¦åˆCommonJSè§„èŒƒçš„åŒ…ç›®å½•åº”è¯¥åŒ…å«å¦‚ä¸‹è¿™äº›æ–‡ä»¶ï¼š package.json:åŒ…æè¿°æ–‡ä»¶ã€‚ bin:ç”¨äºå­˜æ”¾å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½•ã€‚ lib:ç”¨äºå­˜æ”¾JavaScriptä»£ç çš„ç›®å½•ã€‚ doc:ç”¨äºå­˜æ”¾æ–‡æ¡£çš„ç›®å½•ã€‚ test:ç”¨äºå­˜æ”¾å•å…ƒæµ‹è¯•ç”¨ä¾‹çš„ä»£ç ã€‚ åŒ…æè¿°æ–‡ä»¶ä¸NPMåŒ…æè¿°æ–‡ä»¶ç”¨äºè¡¨è¾¾éä»£ç ç›¸å…³çš„ä¿¡æ¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªJSONæ ¼å¼çš„æ–‡ä»¶â€”â€”package.jsonï¼Œä½äº åŒ…çš„æ ¹ç›®å½•ä¸‹ï¼Œæ˜¯åŒ…çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ å¿…éœ€å­—æ®µï¼š nameã€‚åŒ…åã€‚è§„èŒƒå®šä¹‰å®ƒéœ€è¦ç”±å°å†™çš„å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œå¯ä»¥åŒ…å«.ã€_å’Œ-ï¼Œä½†ä¸å…è®¸å‡ºç°ç©ºæ ¼ã€‚åŒ…åå¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä»¥å…å¯¹å¤–å…¬å¸ƒæ—¶äº§ç”Ÿé‡åå†²çªçš„è¯¯è§£ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒNPMè¿˜å»ºè®®ä¸è¦åœ¨åŒ…åä¸­é™„å¸¦ä¸Šnodeæˆ–jsæ¥é‡å¤æ ‡è¯†å®ƒæ˜¯JavaScriptæˆ–Nodeæ¨¡å—ã€‚ descriptionã€‚åŒ…ç®€ä»‹ã€‚ versionã€‚ç‰ˆæœ¬å·ã€‚ä¸€ä¸ªè¯­ä¹‰åŒ–çš„ç‰ˆæœ¬å·ï¼Œè¯¥ç‰ˆæœ¬å·ååˆ†é‡è¦ï¼Œå¸¸å¸¸ç”¨äºä¸€äº›ç‰ˆæœ¬æ§åˆ¶çš„åœºåˆã€‚ keywordsã€‚å…³é”®è¯æ•°ç»„ï¼ŒNPMä¸­ä¸»è¦ç”¨æ¥åšåˆ†ç±»æœç´¢ã€‚ä¸€ä¸ªå¥½çš„å…³é”®è¯æ•°ç»„æœ‰åˆ©äºç”¨æˆ·å¿«é€Ÿæ‰¾åˆ°ä½ ç¼–å†™çš„åŒ…ã€‚ maintainersã€‚åŒ…ç»´æŠ¤è€…åˆ—è¡¨ã€‚æ¯ä¸ªç»´æŠ¤è€…ç”±nameã€emailå’Œwebè¿™3ä¸ªå±æ€§ç»„æˆã€‚NPMé€šè¿‡è¯¥å±æ€§è¿›è¡Œæƒé™è®¤è¯ã€‚ contributorsã€‚è´¡çŒ®è€…åˆ—è¡¨ã€‚åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªè´¡çŒ®åº”å½“æ˜¯åŒ…çš„ä½œè€…æœ¬äººã€‚å®ƒçš„æ ¼å¼ä¸ç»´æŠ¤è€…åˆ—è¡¨ç›¸åŒã€‚ bugsã€‚ä¸€ä¸ªå¯ä»¥åé¦ˆbugçš„ç½‘é¡µåœ°å€æˆ–é‚®ä»¶åœ°å€ã€‚ licensesã€‚å½“å‰åŒ…æ‰€ä½¿ç”¨çš„è®¸å¯è¯åˆ—è¡¨ï¼Œè¡¨ç¤ºè¿™ä¸ªåŒ…å¯ä»¥åœ¨å“ªäº›è®¸å¯è¯ä¸‹ä½¿ç”¨ã€‚ repositoriesã€‚æ‰˜ç®¡æºä»£ç çš„ä½ç½®åˆ—è¡¨ï¼Œè¡¨æ˜å¯ä»¥é€šè¿‡å“ªäº›æ–¹å¼å’Œåœ°å€è®¿é—®åŒ…çš„æºä»£ç ã€‚ dependenciesã€‚ä½¿ç”¨å½“å‰åŒ…æ‰€éœ€è¦ä¾èµ–çš„åŒ…åˆ—è¡¨ã€‚è¿™ä¸ªå±æ€§ååˆ†é‡è¦ï¼ŒNPMä¼šé€šè¿‡è¿™ä¸ªå±æ€§å¸®åŠ©è‡ªåŠ¨åŠ è½½ä¾èµ–çš„åŒ…ã€‚ å¯é€‰å­—æ®µï¼š homepageã€‚å½“å‰åŒ…çš„ç½‘ç«™åœ°å€ã€‚ osã€‚æ“ä½œç³»ç»Ÿæ”¯æŒåˆ—è¡¨ã€‚è¿™äº›æ“ä½œç³»ç»Ÿçš„å–å€¼åŒ…æ‹¬aixã€freebsdã€linuxã€macosã€solarisã€vxworksã€windowsã€‚å¦‚æœè®¾ç½®äº†åˆ—è¡¨ä¸ºç©ºï¼Œåˆ™ä¸å¯¹æ“ä½œç³»ç»Ÿåšä»»ä½•å‡è®¾ã€‚ cpuã€‚CPUæ¶æ„çš„æ”¯æŒåˆ—è¡¨ï¼Œæœ‰æ•ˆçš„æ¶æ„åç§°æœ‰armã€mipsã€ppcã€sparcã€x86å’Œx86_64ã€‚åŒosä¸€æ ·ï¼Œå¦‚æœåˆ—è¡¨ä¸ºç©ºï¼Œåˆ™ä¸å¯¹CPUæ¶æ„åšä»»ä½•å‡è®¾ã€‚ engineã€‚æ”¯æŒçš„JavaScriptå¼•æ“åˆ—è¡¨ï¼Œæœ‰æ•ˆçš„å¼•æ“å–å€¼åŒ…æ‹¬ejsã€flusspferdã€gpseeã€jscã€spidermonkeyã€narwhalã€nodeå’Œv8ã€‚ builtinã€‚æ ‡å¿—å½“å‰åŒ…æ˜¯å¦æ˜¯å†…å»ºåœ¨åº•å±‚ç³»ç»Ÿçš„æ ‡å‡†ç»„ä»¶ã€‚ directoriesã€‚åŒ…ç›®å½•è¯´æ˜ã€‚ implementsã€‚å®ç°è§„èŒƒçš„åˆ—è¡¨ã€‚æ ‡å¿—å½“å‰åŒ…å®ç°äº†CommonJSçš„å“ªäº›è§„èŒƒã€‚ scriptsã€‚è„šæœ¬è¯´æ˜å¯¹è±¡ã€‚å®ƒä¸»è¦è¢«åŒ…ç®¡ç†å™¨ç”¨æ¥å®‰è£…ã€ç¼–è¯‘ã€æµ‹è¯•å’Œå¸è½½åŒ…ã€‚ åœ¨åŒ…æè¿°æ–‡ä»¶çš„è§„èŒƒä¸­ï¼ŒNPMå®é™…éœ€è¦çš„å­—æ®µä¸»è¦æœ‰nameã€versionã€descriptionã€keywordsã€ repositoriesã€authorã€binã€mainã€scriptsã€enginesã€dependenciesã€devDependenciesã€‚ authorã€‚åŒ…ä½œè€…ã€‚ binã€‚ä¸€äº›åŒ…ä½œè€…å¸Œæœ›åŒ…å¯ä»¥ä½œä¸ºå‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨ã€‚é…ç½®å¥½binå­—æ®µåï¼Œé€šè¿‡npm install package_name -gå‘½ä»¤å¯ä»¥å°†è„šæœ¬æ·»åŠ åˆ°æ‰§è¡Œè·¯å¾„ä¸­ï¼Œä¹‹åå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ç›´æ¥æ‰§è¡Œã€‚å‰é¢çš„node-gypå³æ˜¯è¿™æ ·å®‰è£…çš„ã€‚é€šè¿‡-gå‘½ä»¤å®‰è£…çš„æ¨¡å—åŒ…ç§°ä¸ºå…¨å±€æ¨¡å¼ã€‚ mainã€‚æ¨¡å—å¼•å…¥æ–¹æ³•require()åœ¨å¼•å…¥åŒ…æ—¶ï¼Œä¼šä¼˜å…ˆæ£€æŸ¥è¿™ä¸ªå­—æ®µï¼Œå¹¶å°†å…¶ä½œä¸ºåŒ…ä¸­å…¶ä½™ æ¨¡å—çš„å…¥å£ã€‚å¦‚æœä¸å­˜åœ¨è¿™ä¸ªå­—æ®µï¼Œrequire()æ–¹æ³•ä¼šæŸ¥æ‰¾åŒ…ç›®å½•ä¸‹çš„index.jsã€index.nodeã€index.jsonæ–‡ä»¶ä½œä¸ºé»˜è®¤å…¥å£ã€‚ devDependenciesã€‚ä¸€äº›æ¨¡å—åªåœ¨å¼€å‘æ—¶éœ€è¦ä¾èµ–ã€‚é…ç½®è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥æç¤ºåŒ…çš„åç»­å¼€å‘è€…å®‰è£…ä¾èµ–åŒ…ã€‚ å‰åç«¯å…±ç”¨æ¨¡å—AMD è§„èŒƒAMDè§„èŒƒæ˜¯CommonJSæ¨¡å—è§„èŒƒçš„ä¸€ä¸ªå»¶ä¼¸ 1define(id?, dependencies?, factory); å®ƒçš„æ¨¡å—idå’Œä¾èµ–æ˜¯å¯é€‰çš„ï¼Œä¸Nodeæ¨¡å—ç›¸ä¼¼çš„åœ°æ–¹åœ¨äºfactoryçš„å†…å®¹å°±æ˜¯å®é™…ä»£ç çš„å†…å®¹ã€‚ 123456define(function() &#123; var exports = &#123;&#125;; exports.sayHello = function() &#123; alert('Hello from module: ' + module.id); &#125;; return exports; &#125;); ä¸åŒä¹‹å¤„åœ¨äºAMDæ¨¡å—éœ€è¦ç”¨defineæ¥æ˜ç¡®å®šä¹‰ä¸€ä¸ªæ¨¡å—ï¼Œè€Œåœ¨Nodeå®ç°ä¸­æ˜¯éšå¼åŒ…è£…çš„ï¼Œ å®ƒä»¬çš„ç›®çš„æ˜¯è¿›è¡Œä½œç”¨åŸŸéš”ç¦»ï¼Œä»…åœ¨éœ€è¦çš„æ—¶å€™è¢«å¼•å…¥ï¼Œé¿å…æ‰è¿‡å»é‚£ç§é€šè¿‡å…¨å±€å˜é‡æˆ–è€…å…¨å±€ å‘½åç©ºé—´çš„æ–¹å¼ï¼Œä»¥å…å˜é‡æ±¡æŸ“å’Œä¸å°å¿ƒè¢«ä¿®æ”¹ã€‚å¦ä¸€ä¸ªåŒºåˆ«åˆ™æ˜¯å†…å®¹éœ€è¦é€šè¿‡è¿”å›çš„æ–¹å¼å®ç° å¯¼å‡ºã€‚ CMD è§„èŒƒä¸AMDè§„èŒƒçš„ä¸»è¦åŒºåˆ«åœ¨äºå®šä¹‰æ¨¡å—å’Œä¾èµ–å¼•å…¥çš„éƒ¨åˆ†ã€‚ AMDéœ€è¦åœ¨å£°æ˜æ¨¡å—çš„æ—¶å€™æŒ‡å®šæ‰€æœ‰çš„ä¾èµ–ï¼Œé€šè¿‡å½¢å‚ä¼ é€’ä¾èµ–åˆ°æ¨¡å—å†…å®¹ä¸­ã€‚ åœ¨ä¾èµ–éƒ¨åˆ†ï¼ŒCMDæ”¯æŒåŠ¨æ€å¼•å…¥ã€‚ ç¬¬ä¸‰ç«  å¼‚æ­¥I/Oä¸ºä»€ä¹ˆè¦å¼‚æ­¥I/Oç”¨æˆ·ä½“éªŒ å‰ç«¯é€šè¿‡å¼‚æ­¥å¯ä»¥æ¶ˆé™¤æ‰UIé˜»å¡çš„ç°è±¡ã€‚ä½†æ˜¯å‰ç«¯è·å–èµ„æºçš„é€Ÿåº¦ä¹Ÿå–å†³äºåç«¯çš„å“åº”é€Ÿåº¦ã€‚é‡‡ç”¨å¼‚æ­¥æ–¹å¼ï¼Œç¬¬ä¸€ä¸ªèµ„æºçš„è·å–å¹¶ä¸ä¼šé˜»å¡ç¬¬äºŒä¸ªèµ„æºã€‚ éšç€ç½‘ç«™æˆ–åº”ç”¨ä¸æ–­è†¨èƒ€ï¼Œæ•°æ®å°†ä¼šåˆ†å¸ƒåˆ°å¤šå°æœåŠ¡å™¨ä¸Šï¼Œåˆ†å¸ƒå¼å°†ä¼šæ˜¯å¸¸æ€ã€‚åˆ†å¸ƒä¹Ÿæ„å‘³ç€Mä¸Nçš„å€¼ï¼ˆM/Nåˆ†åˆ«ä¸ºä¸¤ä¸ªè¯·æ±‚æ¶ˆè€—çš„æ—¶é—´ï¼‰ä¼šçº¿æ€§å¢é•¿ï¼Œè¿™ä¹Ÿä¼šæ”¾å¤§å¼‚æ­¥å’ŒåŒæ­¥åœ¨æ€§èƒ½æ–¹é¢çš„å·®å¼‚ã€‚ åªæœ‰åç«¯èƒ½å¤Ÿå¿«é€Ÿå“åº”èµ„æºï¼Œæ‰èƒ½è®©å‰ç«¯çš„ä½“éªŒå˜å¥½ã€‚ èµ„æºåˆ†é…åˆ©ç”¨å•çº¿ç¨‹ï¼Œè¿œç¦»å¤šçº¿ç¨‹æ­»é”ã€çŠ¶æ€åŒæ­¥ç­‰é—®é¢˜;åˆ©ç”¨å¼‚ æ­¥I/Oï¼Œè®©å•çº¿ç¨‹è¿œç¦»é˜»å¡ï¼Œä»¥æ›´å¥½åœ°ä½¿ç”¨CPUã€‚ Nodeæä¾›äº†ç±»ä¼¼å‰ç«¯æµè§ˆå™¨ä¸­Web Workersçš„å­ è¿›ç¨‹ï¼Œè¯¥å­è¿›ç¨‹å¯ä»¥é€šè¿‡å·¥ä½œè¿›ç¨‹é«˜æ•ˆåœ°åˆ©ç”¨CPUå’ŒI/O å¼‚æ­¥I/Oå®ç°ç°çŠ¶å¼‚æ­¥I/Oä¸éé˜»å¡I/Oå¼‚æ­¥/åŒæ­¥å’Œé˜»å¡/éé˜»å¡å®é™…ä¸Šæ˜¯ä¸¤å›äº‹ æ“ä½œç³»ç»Ÿå†…æ ¸å¯¹äºI/Oåªæœ‰ä¸¤ç§æ–¹å¼:é˜»å¡ä¸éé˜»å¡ã€‚ é˜»å¡ï¼šåœ¨è°ƒç”¨é˜»å¡I/Oæ—¶ï¼Œåº”ç”¨ç¨‹åºéœ€è¦ç­‰å¾… I/Oå®Œæˆæ‰è¿”å›ç»“æœ ç‰¹ç‚¹ï¼šè°ƒç”¨ä¹‹åä¸€å®šè¦ç­‰åˆ°ç³»ç»Ÿå†…æ ¸å±‚é¢å®Œæˆæ‰€æœ‰æ“ä½œåï¼Œè°ƒç”¨æ‰ç»“æŸã€‚ é˜»å¡I/Oé€ æˆCPUç­‰å¾…I/Oï¼Œæµªè´¹ç­‰å¾…æ—¶é—´ï¼ŒCPUçš„å¤„ç†èƒ½åŠ›ä¸èƒ½å¾—åˆ°å……åˆ†åˆ©ç”¨ éé˜»å¡ï¼šéé˜»å¡I/Oè·Ÿé˜»å¡I/Oçš„å·®åˆ«ä¸ºè°ƒç”¨ä¹‹åä¼šç«‹å³è¿”å› éé˜»å¡I/Oè¿”å›ä¹‹åï¼ŒCPUçš„æ—¶é—´ç‰‡å¯ä»¥ç”¨æ¥å¤„ç†å…¶ä»–äº‹åŠ¡ï¼Œæ­¤æ—¶çš„æ€§èƒ½æå‡æ˜¯æ˜æ˜¾çš„ã€‚ é—®é¢˜ï¼šç”±äºå®Œæ•´çš„I/Oå¹¶æ²¡æœ‰å®Œæˆï¼Œç«‹å³è¿”å›çš„å¹¶ä¸æ˜¯ä¸šåŠ¡å±‚æœŸæœ›çš„ æ•°æ®ï¼Œè€Œä»…ä»…æ˜¯å½“å‰è°ƒç”¨çš„çŠ¶æ€ã€‚ä¸ºäº†è·å–å®Œæ•´çš„æ•°æ®ï¼Œåº”ç”¨ç¨‹åºéœ€è¦é‡å¤è°ƒç”¨I/Oæ“ä½œæ¥ç¡®è®¤ æ˜¯å¦å®Œæˆã€‚è¿™ç§é‡å¤è°ƒç”¨åˆ¤æ–­æ“ä½œæ˜¯å¦å®Œæˆçš„æŠ€æœ¯å«åšè½®è¯¢ã€‚ è½®è¯¢æŠ€æœ¯ï¼š readã€‚å®ƒæ˜¯æœ€åŸå§‹ã€æ€§èƒ½æœ€ä½çš„ä¸€ç§ï¼Œé€šè¿‡é‡å¤è°ƒç”¨æ¥æ£€æŸ¥I/Oçš„çŠ¶æ€æ¥å®Œæˆå®Œæ•´æ•°æ®çš„è¯»å–ã€‚åœ¨å¾—åˆ°æœ€ç»ˆæ•°æ®å‰ï¼ŒCPUä¸€ç›´è€—ç”¨åœ¨ç­‰å¾…ä¸Šã€‚ selectã€‚å®ƒæ˜¯åœ¨readçš„åŸºç¡€ä¸Šæ”¹è¿›çš„ä¸€ç§æ–¹æ¡ˆï¼Œé€šè¿‡å¯¹æ–‡ä»¶æè¿°ç¬¦ä¸Šçš„äº‹ä»¶çŠ¶æ€æ¥è¿›è¡Œåˆ¤æ–­ã€‚ selectè½®è¯¢å…·æœ‰ä¸€ä¸ªè¾ƒå¼±çš„é™åˆ¶ï¼Œé‚£å°±æ˜¯ç”±äºå®ƒé‡‡ç”¨ä¸€ä¸ª1024é•¿åº¦çš„æ•°ç»„æ¥å­˜å‚¨çŠ¶æ€ï¼Œ æ‰€ä»¥å®ƒæœ€å¤šå¯ä»¥åŒæ—¶æ£€æŸ¥1024ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚ pollã€‚è¯¥æ–¹æ¡ˆè¾ƒselectæœ‰æ‰€æ”¹è¿›ï¼Œé‡‡ç”¨é“¾è¡¨çš„æ–¹å¼é¿å…æ•°ç»„é•¿åº¦çš„é™åˆ¶ï¼Œå…¶æ¬¡å®ƒèƒ½é¿å…ä¸éœ€è¦çš„æ£€æŸ¥ã€‚ä½†æ˜¯å½“æ–‡ä»¶æè¿°ç¬¦è¾ƒå¤šçš„æ—¶å€™ï¼Œå®ƒçš„æ€§èƒ½è¿˜æ˜¯ååˆ†ä½ä¸‹çš„ã€‚ epollã€‚è¯¥æ–¹æ¡ˆæ˜¯Linuxä¸‹æ•ˆç‡æœ€é«˜çš„I/Oäº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œåœ¨è¿›å…¥è½®è¯¢çš„æ—¶å€™å¦‚æœæ²¡æœ‰æ£€æŸ¥åˆ° I/Oäº‹ä»¶ï¼Œå°†ä¼šè¿›è¡Œä¼‘çœ ï¼Œç›´åˆ°äº‹ä»¶å‘ç”Ÿå°†å®ƒå”¤é†’ã€‚å®ƒæ˜¯çœŸå®åˆ©ç”¨äº†äº‹ä»¶é€šçŸ¥ã€æ‰§è¡Œå›è°ƒ çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯éå†æŸ¥è¯¢ï¼Œæ‰€ä»¥ä¸ä¼šæµªè´¹CPUï¼Œæ‰§è¡Œæ•ˆç‡è¾ƒé«˜ kqueueã€‚è¯¥æ–¹æ¡ˆçš„å®ç°æ–¹å¼ä¸epollç±»ä¼¼ï¼Œä¸è¿‡å®ƒä»…åœ¨FreeBSDç³»ç»Ÿä¸‹å­˜åœ¨ã€‚ ç°å®çš„å¼‚æ­¥I/Oé€šè¿‡è®©éƒ¨åˆ†çº¿ç¨‹è¿›è¡Œé˜»å¡I/Oæˆ–è€…éé˜»å¡I/OåŠ  è½®è¯¢æŠ€æœ¯æ¥å®Œæˆæ•°æ®è·å–ï¼Œè®©ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè®¡ç®—å¤„ç†ï¼Œé€šè¿‡çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡å°†I/Oå¾—åˆ°çš„æ•°æ®è¿› è¡Œä¼ é€’ï¼Œè¿™å°±è½»æ¾å®ç°äº†å¼‚æ­¥I/O ibeio å®è´¨ä¸Šä¾ç„¶æ˜¯é‡‡ç”¨çº¿ç¨‹æ± ä¸é˜»å¡I/Oæ¨¡æ‹Ÿå¼‚æ­¥I/O IOCPï¼šè°ƒç”¨å¼‚æ­¥æ–¹æ³•ï¼Œç­‰å¾…I/Oå®Œæˆä¹‹åçš„é€šçŸ¥ï¼Œæ‰§è¡Œå›è°ƒï¼Œç”¨æˆ·æ— é¡»è€ƒè™‘è½®è¯¢ã€‚ä½†æ˜¯å®ƒçš„ å†…éƒ¨å…¶å®ä»ç„¶æ˜¯çº¿ç¨‹æ± åŸç†ï¼Œä¸åŒä¹‹å¤„åœ¨äºè¿™äº›çº¿ç¨‹æ± ç”±ç³»ç»Ÿå†…æ ¸æ¥æ‰‹ç®¡ç†ã€‚ Nodeæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™é‡Œçš„å•çº¿ç¨‹ä»…ä»…åªæ˜¯ JavaScriptæ‰§è¡Œåœ¨å•çº¿ç¨‹ä¸­ç½¢äº†ã€‚åœ¨Nodeä¸­ï¼Œæ— è®ºæ˜¯*nixè¿˜æ˜¯Windowså¹³å°ï¼Œå†…éƒ¨å®ŒæˆI/Oä»»åŠ¡çš„ å¦æœ‰çº¿ç¨‹æ± ã€‚ Node çš„å¼‚æ­¥ I/Oäº‹ä»¶å¾ªç¯ã€è§‚å¯Ÿè€…ã€è¯·æ±‚å¯¹è±¡ã€I/Oçº¿ç¨‹æ± è¿™å››è€…å…±åŒæ„æˆäº†Nodeå¼‚æ­¥I/Oæ¨¡å‹çš„åŸºæœ¬è¦ç´ ã€‚ Windowsä¸‹ä¸»è¦é€šè¿‡IOCPæ¥å‘ç³»ç»Ÿå†…æ ¸å‘é€I/Oè°ƒç”¨å’Œä»å†…æ ¸è·å–å·²å®Œæˆçš„I/Oæ“ä½œï¼Œé…ä»¥äº‹ ä»¶å¾ªç¯ï¼Œä»¥æ­¤å®Œæˆå¼‚æ­¥I/Oçš„è¿‡ç¨‹ã€‚åœ¨Linuxä¸‹é€šè¿‡epollå®ç°è¿™ä¸ªè¿‡ç¨‹ï¼ŒFreeBSDä¸‹é€šè¿‡kqueueå® ç°ï¼ŒSolarisä¸‹é€šè¿‡Event portså®ç°ã€‚ä¸åŒçš„æ˜¯çº¿ç¨‹æ± åœ¨Windowsä¸‹ç”±å†…æ ¸(IOCP)ç›´æ¥æä¾›ï¼Œ*nix ç³»åˆ—ä¸‹ç”±libuvè‡ªè¡Œå®ç°ã€‚ äº‹ä»¶å¾ªç¯Nodeè‡ªèº«çš„æ‰§è¡Œæ¨¡å‹â€”â€”äº‹ä»¶å¾ªç¯ æ¯æ‰§è¡Œä¸€æ¬¡å¾ªç¯ä½“çš„è¿‡ç¨‹æˆ‘ ä»¬ç§°ä¸ºTickã€‚æ¯ä¸ªTickçš„è¿‡ç¨‹å°±æ˜¯æŸ¥çœ‹æ˜¯å¦æœ‰äº‹ä»¶å¾…å¤„ç†ï¼Œå¦‚æœæœ‰ï¼Œå°±å–å‡ºäº‹ä»¶åŠå…¶ç›¸å…³çš„å›è°ƒ å‡½æ•°ã€‚å¦‚æœå­˜åœ¨å…³è”çš„å›è°ƒå‡½æ•°ï¼Œå°±æ‰§è¡Œå®ƒä»¬ã€‚ç„¶åè¿›å…¥ä¸‹ä¸ªå¾ªç¯ï¼Œå¦‚æœä¸å†æœ‰äº‹ä»¶å¤„ç†ï¼Œå°±é€€å‡ºè¿›ç¨‹ã€‚ è§‚å¯Ÿè€…æ¯ä¸ªäº‹ä»¶å¾ªç¯ä¸­æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªè§‚å¯Ÿè€…ï¼Œè€Œåˆ¤æ–­æ˜¯å¦æœ‰äº‹ä»¶è¦å¤„ç†çš„è¿‡ç¨‹å°±æ˜¯å‘è¿™äº›è§‚å¯Ÿè€…è¯¢é—® æ˜¯å¦æœ‰è¦å¤„ç†çš„äº‹ä»¶ã€‚ è§‚å¯Ÿè€…å°†äº‹ä»¶è¿›è¡Œåˆ†ç±»ã€‚åœ¨Nodeä¸­ï¼Œäº‹ä»¶ä¸»è¦æ¥æºäºç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶I/Oç­‰ï¼Œè¿™äº›äº‹ä»¶å¯¹åº”çš„ è§‚å¯Ÿè€…æœ‰æ–‡ä»¶I/Oè§‚å¯Ÿè€…ã€ç½‘ç»œI/Oè§‚å¯Ÿè€…ç­‰ã€‚ åœ¨Windowsä¸‹ï¼Œè¿™ä¸ªå¾ªç¯åŸºäºIOCPåˆ›å»ºï¼Œè€Œåœ¨*nixä¸‹åˆ™åŸºäºå¤šçº¿ç¨‹åˆ›å»ºã€‚ è¯·æ±‚å¯¹è±¡ä»JavaScriptå‘èµ·è°ƒç”¨åˆ°å†…æ ¸æ‰§è¡Œå®ŒI/Oæ“ä½œçš„ è¿‡æ¸¡è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨ä¸€ç§ä¸­é—´äº§ç‰©ï¼Œå®ƒå«åšè¯·æ±‚å¯¹è±¡ã€‚ 1234fs.open = function(path, flags, mode, callback) &#123; // ... binding.open(pathModule._makeLong(path), stringToFlags(flags),mode,callback); &#125;; ä»JavaScriptè°ƒç”¨Nodeçš„æ ¸å¿ƒæ¨¡å—ï¼Œæ ¸å¿ƒæ¨¡å—è°ƒç”¨C++å†…å»ºæ¨¡å—ï¼Œå†…å»ºæ¨¡å—é€šè¿‡libuvè¿›è¡Œç³»ç»Ÿè°ƒç”¨ è¿™é‡Œlibuvä½œä¸ºå°è£…å±‚ï¼Œæœ‰ä¸¤ä¸ªå¹³å°çš„å®ç°ï¼Œå®è´¨ä¸Šæ˜¯è°ƒ ç”¨äº†uv_fs_open()æ–¹æ³•ã€‚åœ¨uv_fs_open()çš„è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªFSReqWrapè¯·æ±‚å¯¹è±¡ å›è°ƒå‡½æ•°åˆ™ è¢«è®¾ç½®åœ¨è¿™ä¸ªå¯¹è±¡çš„oncomplete_symå±æ€§ä¸Š 1req_wrap-&gt;object_-&gt;Set(oncomplete_sym, callback); å¯¹è±¡åŒ…è£…å®Œæ¯•åï¼Œåœ¨Windowsä¸‹ï¼Œåˆ™è°ƒç”¨QueueUserWorkItem()æ–¹æ³•å°†è¿™ä¸ªFSReqWrapå¯¹è±¡æ¨å…¥çº¿ç¨‹æ± ä¸­ç­‰å¾…æ‰§è¡Œ QueueUserWorkItem()æ–¹æ³•æ¥å—3ä¸ªå‚æ•°:ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å°†è¦æ‰§è¡Œçš„æ–¹æ³•çš„å¼•ç”¨ï¼Œè¿™é‡Œå¼•ç”¨çš„æ˜¯uv_fs_thread_procï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯uv_fs_thread_procæ–¹æ³•è¿è¡Œæ—¶æ‰€éœ€è¦çš„å‚æ•°;ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ æ‰§è¡Œçš„æ ‡å¿—ã€‚ å½“çº¿ç¨‹æ± ä¸­æœ‰å¯ç”¨çº¿ç¨‹æ—¶ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨uv_fs_thread_proc()æ–¹æ³•ã€‚uv_fs_thread_ proc()æ–¹æ³•ä¼šæ ¹æ®ä¼ å…¥å‚æ•°çš„ç±»å‹è°ƒç”¨ç›¸åº”çš„åº•å±‚å‡½æ•° è‡³æ­¤ï¼ŒJavaScriptè°ƒç”¨ç«‹å³è¿”å›ï¼Œç”±JavaScriptå±‚é¢å‘èµ·çš„å¼‚æ­¥è°ƒç”¨çš„ç¬¬ä¸€é˜¶æ®µå°±æ­¤ç»“æŸã€‚ JavaScriptçº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œå½“å‰ä»»åŠ¡çš„åç»­æ“ä½œã€‚å½“å‰çš„I/Oæ“ä½œåœ¨çº¿ç¨‹æ± ä¸­ç­‰å¾…æ‰§è¡Œï¼Œä¸ç®¡å®ƒ æ˜¯å¦é˜»å¡I/Oï¼Œéƒ½ä¸ä¼šå½±å“åˆ°JavaScriptçº¿ç¨‹çš„åç»­æ‰§è¡Œï¼Œå¦‚æ­¤å°±è¾¾åˆ°äº†å¼‚æ­¥çš„ç›®çš„ã€‚ è¯·æ±‚å¯¹è±¡æ˜¯å¼‚æ­¥I/Oè¿‡ç¨‹ä¸­çš„é‡è¦ä¸­é—´äº§ç‰©ï¼Œæ‰€æœ‰çš„çŠ¶æ€éƒ½ä¿å­˜åœ¨è¿™ä¸ªå¯¹è±¡ä¸­ï¼ŒåŒ…æ‹¬é€å…¥çº¿ç¨‹æ± ç­‰å¾…æ‰§è¡Œä»¥åŠI/Oæ“ä½œå®Œæ¯•åçš„å›è°ƒå¤„ç† æ‰§è¡Œå›è°ƒ çº¿ç¨‹æ± ä¸­çš„I/Oæ“ä½œè°ƒç”¨å®Œæ¯•ä¹‹åï¼Œä¼šå°†è·å–çš„ç»“æœå‚¨å­˜åœ¨req-&gt;resultå±æ€§ä¸Šï¼Œç„¶åè°ƒç”¨ PostQueuedCompletionStatus()é€šçŸ¥IOCPï¼Œå‘ŠçŸ¥å½“å‰å¯¹è±¡æ“ä½œå·²ç»å®Œæˆ 1PostQueuedCompletionStatus((loop)-&gt;iocp, 0, 0, &amp;((req)-&gt;overlapped)) PostQueuedCompletionStatus()æ–¹æ³•çš„ä½œç”¨æ˜¯å‘IOCPæäº¤æ‰§è¡ŒçŠ¶æ€ï¼Œå¹¶å°†çº¿ç¨‹å½’è¿˜çº¿ç¨‹æ± ã€‚é€šè¿‡PostQueuedCompletionStatus()æ–¹æ³•æäº¤çš„çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡GetQueuedCompletionStatus()æå–ã€‚ åœ¨æ¯æ¬¡Tickçš„æ‰§è¡Œä¸­ï¼Œå®ƒä¼šè°ƒç”¨ IOCPç›¸å…³çš„GetQueuedCompletionStatus()æ–¹æ³•æ£€æŸ¥çº¿ç¨‹æ± ä¸­æ˜¯å¦æœ‰æ‰§è¡Œå®Œçš„è¯·æ±‚ï¼Œå¦‚æœå­˜åœ¨ï¼Œä¼šå°†è¯·æ±‚å¯¹è±¡åŠ å…¥åˆ°I/Oè§‚å¯Ÿè€…çš„é˜Ÿåˆ—ä¸­ï¼Œç„¶åå°†å…¶å½“åšäº‹ä»¶å¤„ç†ã€‚ I/Oè§‚å¯Ÿè€…å›è°ƒå‡½æ•°çš„è¡Œä¸ºå°±æ˜¯å–å‡ºè¯·æ±‚å¯¹è±¡çš„resultå±æ€§ä½œä¸ºå‚æ•°ï¼Œå–å‡ºoncomplete_symå±æ€§ä½œä¸ºæ–¹æ³•ï¼Œç„¶åè°ƒç”¨æ‰§è¡Œï¼Œä»¥æ­¤è¾¾åˆ°è°ƒç”¨JavaScriptä¸­ä¼ å…¥çš„å›è°ƒå‡½æ•°çš„ç›®çš„ éI/Oçš„å¼‚æ­¥APII/Oæ— å…³çš„å¼‚æ­¥API:setTimeout()ã€setInterval()ã€ setImmediate()å’Œprocess.nextTick() å®šæ—¶å™¨setTimeout()å’ŒsetInterval() å®ƒä»¬çš„å®ç°åŸç†ä¸å¼‚æ­¥I/Oæ¯”è¾ƒç±»ä¼¼ï¼Œåªæ˜¯ä¸éœ€è¦I/Oçº¿ç¨‹æ± çš„å‚ä¸ã€‚ è°ƒç”¨setTimeout()æˆ–è€… setInterval()åˆ›å»ºçš„å®šæ—¶å™¨ä¼šè¢«æ’å…¥åˆ°å®šæ—¶å™¨è§‚å¯Ÿè€…å†…éƒ¨çš„ä¸€ä¸ªçº¢é»‘æ ‘ä¸­ã€‚æ¯æ¬¡Tickæ‰§è¡Œæ—¶ï¼Œä¼š ä»è¯¥çº¢é»‘æ ‘ä¸­è¿­ä»£å–å‡ºå®šæ—¶å™¨å¯¹è±¡ï¼Œæ£€æŸ¥æ˜¯å¦è¶…è¿‡å®šæ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡ï¼Œå°±å½¢æˆä¸€ä¸ªäº‹ä»¶ï¼Œå®ƒçš„ å›è°ƒå‡½æ•°å°†ç«‹å³æ‰§è¡Œã€‚ process.nextTick()123456789101112131415process.nextTick = function(callback) &#123; // on the way out, don't bother. // it won't get fired anyway if (process._exiting) return; if (tickDepth &gt;= process.maxTickDepth) maxTickWarn(); var tock = &#123; callback: callback &#125;; if (process.domain) tock.domain = process.domain; nextTickQueue.push(tock); if (nextTickQueue.length) &#123; process._needTickCallback(); &#125;&#125;; æ¯æ¬¡è°ƒç”¨process.nextTick()æ–¹æ³•ï¼Œåªä¼šå°†å›è°ƒå‡½æ•°æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œåœ¨ä¸‹ä¸€è½®Tickæ—¶å–å‡ºæ‰§è¡Œã€‚ å®šæ—¶å™¨ä¸­é‡‡ç”¨çº¢é»‘æ ‘çš„æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸ºO(lg(n))ï¼ŒnextTick()çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚ç›¸è¾ƒä¹‹ä¸‹ï¼Œprocess.nextTick()æ›´é«˜æ•ˆã€‚ setImmediate()1234567process.nextTick(function () &#123; console.log('nextTickå»¶è¿Ÿæ‰§è¡Œ');&#125;);setImmediate(function () &#123; console.log('setImmediateå»¶è¿Ÿæ‰§è¡Œ'); &#125;);console.log('æ­£å¸¸æ‰§è¡Œ'); å…¶æ‰§è¡Œç»“æœå¦‚ä¸‹: 123æ­£å¸¸æ‰§è¡Œ nextTickå»¶è¿Ÿæ‰§è¡Œ setImmediateå»¶è¿Ÿæ‰§è¡Œ process.nextTick()ä¸­çš„å›è°ƒå‡½æ•°æ‰§è¡Œçš„ä¼˜å…ˆçº§è¦é«˜äºsetImmediate()ã€‚ åŸå› åœ¨äºäº‹ä»¶å¾ªç¯å¯¹è§‚å¯Ÿè€…çš„æ£€æŸ¥æ˜¯æœ‰å…ˆåé¡ºåºçš„ï¼Œprocess.nextTick()å±äºidleè§‚å¯Ÿè€…ï¼Œ setImmediate()å±äºcheckè§‚å¯Ÿè€…ã€‚åœ¨æ¯ä¸€ä¸ªè½®å¾ªç¯æ£€æŸ¥ä¸­ï¼Œidleè§‚å¯Ÿè€…å…ˆäºI/Oè§‚å¯Ÿè€…ï¼ŒI/Oè§‚å¯Ÿè€…å…ˆäºcheckè§‚å¯Ÿè€…ã€‚ process.nextTick()çš„å›è°ƒå‡½æ•°ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼ŒsetImmediate()çš„ç»“æœ åˆ™æ˜¯ä¿å­˜åœ¨é“¾è¡¨ä¸­ åœ¨è¡Œä¸ºä¸Šï¼Œprocess.nextTick()åœ¨æ¯è½®å¾ªç¯ä¸­ä¼šå°†æ•°ç»„ä¸­çš„å›è°ƒå‡½æ•°å…¨éƒ¨æ‰§è¡Œå®Œï¼Œè€ŒsetImmediate()åœ¨æ¯è½®å¾ªç¯ä¸­æ‰§è¡Œé“¾è¡¨ä¸­çš„ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚ ä¹‹æ‰€ä»¥è¿™æ ·è®¾è®¡ï¼Œæ˜¯ä¸ºäº†ä¿è¯æ¯è½®å¾ªç¯èƒ½å¤Ÿè¾ƒå¿«åœ°æ‰§è¡Œç»“æŸï¼Œé˜²æ­¢CPUå ç”¨è¿‡å¤šè€Œé˜»å¡åç»­I/O è°ƒç”¨çš„æƒ…å†µã€‚ äº‹ä»¶é©±åŠ¨ä¸é«˜æ€§èƒ½æœåŠ¡å™¨äº‹ä»¶é©±åŠ¨çš„å®è´¨ï¼š é€šè¿‡ä¸»å¾ªç¯åŠ äº‹ä»¶è§¦å‘çš„æ–¹å¼æ¥è¿è¡Œç¨‹åºã€‚ å‡ ç§ç»å…¸çš„æœåŠ¡å™¨æ¨¡å‹ï¼Œå¯¹æ¯”ä¼˜ç¼ºç‚¹ åŒæ­¥å¼ã€‚å¯¹äºåŒæ­¥å¼çš„æœåŠ¡ï¼Œä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å…¶ä½™è¯·æ±‚éƒ½å¤„äºç­‰å¾…çŠ¶æ€ã€‚ æ¯è¿›ç¨‹/æ¯è¯·æ±‚ã€‚ä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ ·å¯ä»¥å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œä½†æ˜¯å®ƒä¸å…·å¤‡æ‰©å±•æ€§ï¼Œå› ä¸ºç³»ç»Ÿèµ„æºåªæœ‰é‚£ä¹ˆå¤šã€‚ æ¯çº¿ç¨‹/æ¯è¯·æ±‚ã€‚ä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ã€‚å°½ç®¡çº¿ç¨‹æ¯”è¿›ç¨‹è¦è½»é‡ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ªçº¿ç¨‹éƒ½å ç”¨ä¸€å®šå†…å­˜ï¼Œå½“å¤§å¹¶å‘è¯·æ±‚åˆ°æ¥æ—¶ï¼Œå†…å­˜å°†ä¼šå¾ˆå¿«ç”¨å…‰ï¼Œå¯¼è‡´æœåŠ¡å™¨ç¼“æ…¢ã€‚ é«˜æ€§èƒ½ï¼šNodeé€šè¿‡äº‹ä»¶é©±åŠ¨çš„æ–¹å¼å¤„ç†è¯·æ±‚ï¼Œæ— é¡»ä¸º æ¯ä¸€ä¸ªè¯·æ±‚åˆ›å»ºé¢å¤–çš„å¯¹åº”çº¿ç¨‹ï¼Œå¯ä»¥çœæ‰åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ï¼ŒåŒæ—¶æ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦ä»» åŠ¡æ—¶å› ä¸ºçº¿ç¨‹è¾ƒå°‘ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä»£ä»·å¾ˆä½ã€‚è¿™ä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿæœ‰æ¡ä¸ç´Šåœ°å¤„ç†è¯·æ±‚ï¼Œå³ä½¿åœ¨å¤§é‡è¿æ¥çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸å—çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€çš„å½±å“ï¼Œè¿™æ˜¯Nodeé«˜æ€§èƒ½çš„ä¸€ä¸ªåŸå› ã€‚","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://yoursite.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://yoursite.com/tags/Node-js/"}]},{"title":"scrollWidth,clientWidth,offsetWidthçš„åŒºåˆ«","slug":"scrollWidth,clientWidth,offsetWidthçš„åŒºåˆ«","date":"2019-12-07T14:01:34.000Z","updated":"2019-12-29T07:11:43.885Z","comments":true,"path":"2019/12/07/scrollWidth,clientWidth,offsetWidthçš„åŒºåˆ«/","link":"","permalink":"http://yoursite.com/2019/12/07/scrollWidth,clientWidth,offsetWidthçš„åŒºåˆ«/","excerpt":"","text":"scrollWidth,clientWidth,offsetWidthçš„åŒºåˆ«æ€»ä½“è¯´æ˜å…ƒç´ å¯¹è±¡ï¼š offsetLeftã€offsetTopå±æ€§ï¼šè·å–å…ƒç´ ç›¸å¯¹äºæ–‡æ¡£å·¦ä¸Šè§’çš„åæ ‡ä½ç½®ã€‚ scrollWidthï¼šå¯¹è±¡çš„å®é™…å†…å®¹çš„å®½åº¦ï¼Œä¸åŒ…æ‹¬è¾¹çº¿å®½åº¦ï¼Œä¼šéšå¯¹è±¡ä¸­å†…å®¹è¶…è¿‡å¯è§†åŒºåè€Œå˜å¤§ã€‚ scrollWidth=å…ƒç´ çš„width+padding clientWidthï¼šå¯¹è±¡å†…å®¹çš„å¯è§†åŒºçš„å®½åº¦ï¼Œä¸åŒ…æ‹¬æ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼Œä¼šéšå¯¹è±¡æ˜¾ç¤ºå¤§å°çš„å˜åŒ–è€Œæ”¹å˜ã€‚ clientWidth=å…ƒç´ çš„width+padding offsetWidthï¼šå¯¹è±¡æ•´ä½“çš„å®é™…å®½åº¦ï¼ŒåŒ…æ‹¬æ»šåŠ¨æ¡ç­‰è¾¹çº¿ï¼Œä¼šéšå¯¹è±¡æ˜¾ç¤ºå¤§å°çš„å˜åŒ–è€Œæ”¹å˜ã€‚ offsetWidth=å…ƒç´ çš„width+padding+border ###windowå¯¹è±¡ï¼š innerWidthï¼šçª—å£ä¸­æ–‡æ¡£æ˜¾ç¤ºåŒºåŸŸçš„å®½åº¦ï¼Œä¸åŒ…æ‹¬èœå•æ ã€å·¥å…·æ ç­‰éƒ¨åˆ†ã€‚è¯¥å±æ€§å¯è¯»å¯å†™ã€‚æµè§ˆå™¨çª—å£çš„å†…éƒ¨å®½åº¦ï¼ˆå¯¹äºIE9+ã€Chromeã€Firefoxã€Opera ä»¥åŠ Safariï¼‰ pageXOffsetï¼šæ•´æ•°åªè¯»å±æ€§ï¼Œè¡¨ç¤ºæ–‡æ¡£å‘å³æ»šåŠ¨è¿‡çš„åƒç´ æ•°ã€‚IEä¸æ”¯æŒè¯¥å±æ€§ï¼Œä½¿ç”¨bodyå…ƒç´ çš„scrollLeftå±æ€§æ›¿ä»£ã€‚ ##æƒ…å†µä¸€ å…ƒç´ å†…æ— å†…å®¹æˆ–è€…å†…å®¹ä¸è¶…è¿‡å¯è§†åŒºï¼Œæ»šåŠ¨ä¸å‡ºç°æˆ–ä¸å¯ç”¨çš„æƒ…å†µä¸‹ã€‚ scrollWidth=clientWidthï¼Œä¸¤è€…çš†ä¸ºå†…å®¹å¯è§†åŒºçš„å®½åº¦ã€‚ offsetWidthä¸ºå…ƒç´ çš„å®é™…å®½åº¦ã€‚ ##æƒ…å†µäºŒ å…ƒç´ çš„å†…å®¹è¶…è¿‡å¯è§†åŒºï¼Œæ»šåŠ¨æ¡å‡ºç°å’Œå¯ç”¨çš„æƒ…å†µä¸‹ã€‚ scrollWidth&gt;clientWidthã€‚ scrollWidthä¸ºå®é™…å†…å®¹çš„å®½åº¦ã€‚ clientWidthæ˜¯å†…å®¹å¯è§†åŒºçš„å®½åº¦ã€‚ offsetWidthæ˜¯å…ƒç´ çš„å®é™…å®½åº¦ã€‚ é’ˆå¯¹æ–‡æ¡£(document)çš„å„ä¸ªheightã€widthã€topã€leftçš„è¯´æ˜ é’ˆå¯¹ç½‘é¡µä¸­ä¸€ä¸ªdivçš„å„ä¸ªå±æ€§å€¼çš„è¯´æ˜","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"}]},{"title":"å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“","slug":"JSäº‹ä»¶æœºåˆ¶ copy","date":"2019-11-26T05:29:24.000Z","updated":"2019-11-26T05:36:52.906Z","comments":true,"path":"2019/11/26/JSäº‹ä»¶æœºåˆ¶ copy/","link":"","permalink":"http://yoursite.com/2019/11/26/JSäº‹ä»¶æœºåˆ¶ copy/","excerpt":"","text":"å¾ªç¯ä¸­çš„å¼‚æ­¥æ“ä½œé—®é¢˜å°ç»“å¾ªç¯çš„å¼‚æ­¥æ“ä½œä¸»è¦æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š å¦‚ä½•ç¡®ä¿å¾ªç¯çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åæ‰§è¡ŒæŸä¸ªå…¶ä»–æ“ä½œ å¾ªç¯ä¸­çš„ä¸‹ä¸€æ­¥æ“ä½œä¾èµ–äºå‰ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚ä½•è§£å†³ ä¸éœ€ç­‰å¾…ç»“æœè¦å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªåŒ¿åå‡½æ•°å®šä¹‰ä¸ºå¼‚æ­¥çš„ï¼š 123456async function processArray(array)&#123; array.forEach(async (item)=&gt;&#123; await delayedLog(item) &#125;) console.log('Done!')&#125; ä½†æ˜¯è¿™æ ·çš„è¯ forEach æ–¹æ³•å°±ç›¸å½“äºå¼‚æ­¥çš„äº†ï¼Œä¸ä¼šç­‰å¾…éå†å®Œæ‰€æœ‰çš„ item å°†ä¼šè¾“å‡ºï¼š 1234Done!123 å¦‚æœä½ ä¸éœ€è¦ç­‰å¾…è¿™ä¸ªå¾ªç¯å®Œæˆï¼Œè¿™æ ·å°±å·²ç»å¯ä»¥äº†ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ç­‰å¾…è¿™ä¸ªå¾ªç¯å®Œæˆæ‰è¿›è¡Œä¹‹åçš„æ“ä½œã€‚ å¦‚ä½•ç¡®ä¿å¾ªç¯çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åæ‰§è¡ŒæŸä¸ªå…¶ä»–æ“ä½œæ–¹æ³•ä¸€ï¼šè®¾ç½®ä¸€ä¸ªflagï¼Œåœ¨æ¯ä¸ªå¼‚æ­¥æ“ä½œä¸­å¯¹flagè¿›è¡Œæ£€æµ‹123456789let flag = 0;for(let i = 0; i &lt; len; i++) &#123; flag++; Database.save_method().exec().then((data) =&gt; &#123; if(flag === len) &#123; // your code &#125; &#125;)&#125; æ–¹æ³•äºŒï¼šå°†æ‰€æœ‰çš„å¾ªç¯æ”¾åœ¨ä¸€ä¸ªpromiseä¸­ï¼Œä½¿ç”¨thenå¤„ç†123456789 new Promise(function(resolve)&#123; resolve() &#125;).then(()=&gt; &#123; for(let i = 0; i &lt; len; i++) &#123; Database.save_method().exec() &#125;&#125;).then(() =&gt; &#123; // your code&#125;) æ–¹æ³•ä¸‰ï¼šä¸²è¡Œéå†è¦ç­‰å¾…æ‰€æœ‰çš„ç»“æœè¿”å›ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å›åˆ°è€å¼çš„ for å¾ªç¯å†™æ³•ï¼š 123456async function processArray(array)&#123; for(const item of array)&#123; await delayedLog(item) &#125; console.log('Done!')&#125; æœ€åçš„ç»“æœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼š 1234123Done! æ–¹æ³•å››ï¼šå¹¶è¡Œéå† 123456async function processArray(array)&#123; //map array to promise const promises=array.map(delayedLog) await Promise.all(promises) console.log('Done!')&#125; ï¼ˆæ³¨æ„ï¼šå¯¹äºç‰¹åˆ«å¤§çš„æ•°ç»„ä¸å»ºè®®ä½¿ç”¨è¿™ç§å†™æ³•ï¼Œå¤ªå¤šçš„å¹¶è¡Œä»»åŠ¡ä¼šåŠ é‡ CPU å’Œå†…å­˜çš„è´Ÿè·ï¼‰ å¾ªç¯ä¸­çš„ä¸‹ä¸€æ­¥æ“ä½œä¾èµ–äºå‰ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚ä½•è§£å†³æ–¹æ³•ä¸€ï¼šä½¿ç”¨é€’å½’ï¼Œåœ¨å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åè°ƒç”¨ä¸‹ä¸€æ¬¡å¼‚æ­¥æ“ä½œ123456function loop(i)&#123; i++; Database.save_method().exec().then(() =&gt; &#123; loop(i) &#125;)&#125; æ–¹æ³•äºŒï¼šä½¿ç”¨asyncå’Œawaitï¼ˆä¸²è¡Œéå†ï¼‰12345async function loop() &#123; for(let i = 0; i &lt; len; i++) &#123; await Database.save_method().exec(); &#125;&#125; å¦‚ä½•ä¼˜é›…åœ°å†™jså¼‚æ­¥å¾ªç¯å¾ªç¯çš„æ–¹å¼å‡è®¾æˆ‘ä»¬æœ‰ä¸ªæ•°ç»„ï¼ŒåŒ…å« 5 ä¸ªæ•°å­—ï¼šlet times = [100, 150, 200, 250, 300]ï¼›è¿˜æœ‰ä¸€ä¸ªå¼‚æ­¥çš„ç¡è§‰æ–¹æ³•ï¼šsleep(time, cb)ã€‚ 123456789101112import Promise from 'bluebird';// å½“æ²¡æœ‰ cb æ—¶ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡export default function sleep(time, cb) &#123; if (cb) &#123; setTimeout(cb, time); &#125; else &#123; return new Promise(resolve =&gt; &#123; setTimeout(resolve, time); &#125;); &#125;&#125;; ç°åœ¨è¦å»å¾ªç¯ç¡è¿™å‡ ä¸ªæ•°å­—ï¼Œé—®ä½ æœ‰å“ªäº›ç¡æ³•ï¼ŸğŸ¤” ä¸ºäº†æ–¹ä¾¿äº¤æµï¼Œæˆ‘å°±ç»™è¿™å‡ ä¸ªç¡æ³•èµ·ä¸ªåå­—ï¼š All inï¼šä½ å¦‚æœèµ¶æ—¶é—´åˆä¸æ‹…å¿ƒæ¶ˆè€—è¿‡åº¦ï¼Œä½ å¯ä»¥ä¸€æ¬¡æ€§éƒ½ç¡äº†ï¼› One by oneï¼šä½ æƒ³ç»†æ°´é•¿æµï¼Œä½ å¯ä»¥ä¸€ä¸ªä¸€ä¸ªç¡ï¼› With concurrencyï¼šä½ å®³ç¾åœ°ä½ä¸‹å¤´ï¼Œè¯´ä¸€æ¬¡èƒ½ä¸èƒ½ç¡ä¸¤ä¸ªã€‚ ä½œä¸ºä¸€æ®µæœ‰èŠ‚æ“çš„ä»£ç ï¼Œè‚¯å®šè¦å‘Šè¯‰å…¶ä»–äººä½ ç¡å®Œäº†ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»æœ‰å…¨éƒ¨å®Œæˆçš„å›è°ƒï¼Œå¦åˆ™æˆ‘ä»¬æ¥ä¸‹æ¥çš„äº¤æµä¼šæ¯«æ— æ„ä¹‰ã€‚ æœ¬æ–‡ç›®çš„æ˜¯å’Œå¤§å®¶æ¢è®¨å¦‚ä½•å†™å‡ºä¼˜é›…çš„å¼‚æ­¥å¾ªç¯ä»£ç ï¼Œå¹¶ä¸æ˜¯å»å®ç°è¿™äº›å¾ªç¯æ§åˆ¶çš„é€»è¾‘ï¼›è€Œä¿æŒä»£ç ä¼˜é›…ï¼Œä¸ªäººä»¥ä¸ºæœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨è¾ƒæ–°çš„è¯­è¨€ç‰¹æ€§ï¼Œå…¶æ¬¡æ˜¯ä½¿ç”¨ä¼˜ç§€çš„å¼€æºé¡¹ç›®ï¼Œæœ€åæ‰æ˜¯è‡ªå·±æ’¸ã€‚ä¸‹é¢ä¼šä½¿ç”¨ Asyncã€Promise(bluebird) å’Œ ES7 ä¸­çš„ async/await å¯¹æ¯”ä¸‹å®ç°è¿™å‡ ç§å¾ªç¯çš„åŒºåˆ«ã€‚ All in è¿™ç§æ–¹å¼æ•ˆç‡æ˜¯æœ€é«˜çš„ï¼Œè€—æ—¶å–å†³äºå¾ªç¯ä¸­æœ€æ…¢çš„é‚£ä¸ªå¼‚æ­¥æ–¹æ³•ã€‚å¯¹èµ„æºçš„æ¶ˆè€—ä¹Ÿæ˜¯æœ€å¤§çš„ï¼Œå¦‚æœå¤§é‡å¾ªç¯è¯·æ±‚åç«¯æœåŠ¡ï¼Œå¾ˆæœ‰å¯èƒ½é€ æˆç¬æ—¶æ‹¥å µçš„æƒ…å†µã€‚ å¦‚æœè‡ªå·±å®ç°ï¼Œè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„åœºæ™¯ï¼ŒåŠ ä¸€ä¸ªå®Œæˆè®¡æ•°å™¨ï¼Œæ¯ä¸ªå¼‚æ­¥æ–¹æ³•å®Œå°±ç»™è¿™ä¸ªå®Œæˆè®¡æ•°å™¨åŠ  1ï¼Œç„¶åæ£€æŸ¥å®Œæˆæ•°æ˜¯ä¸æ˜¯ç­‰äºæ•°ç»„é•¿åº¦ï¼Œä¸€æ—¦ç›¸ç­‰å°±è¡¨ç¤ºæ‰€æœ‰çš„å¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œé€šçŸ¥å…¨éƒ¨å®Œæˆçš„å›è°ƒã€‚ ä½¿ç”¨ async.eachï¼š1234567891011121314import &#123; each &#125; from 'async'; import sleep from './sleep';let times = [100, 150, 200, 250, 300];console.log('sleep start'); console.time('async all in'); each(times, sleep, (err) =&gt; &#123; console.timeEnd('async all in'); console.log('sleep complete');&#125;);// sleep start// async all in: 304.627ms// sleep complete ä½¿ç”¨ Promise.allï¼š1234567891011121314import Promise from 'bluebird'; import sleep from './sleep';let times = [100, 150, 200, 250, 300];console.log('sleep start'); console.time('promise all in'); Promise.all(times.map(time =&gt; sleep(time))).then(() =&gt; &#123; console.timeEnd('promise all in'); console.log('sleep complete');&#125;);// sleep start// promise all in: 305.509ms// sleep complete ä½¿ç”¨ES7 async/awaitï¼š1234567891011121314import sleep from './sleep';let times = [100, 150, 200, 250, 300];(async function() &#123; console.log('sleep start'); console.time('es7 all in'); for await (let i of times.map(time =&gt; sleep(time))) &#123;&#125; console.timeEnd('es7 all in'); console.log('sleep complete');&#125;());// sleep start// es7 all in: 305.986ms// sleep complete One by one è¿™ç§æ–¹å¼æ•ˆç‡æœ€ä½ï¼Œæœ‰ç‚¹ç±»ä¼¼äºåŒæ­¥è¯­è¨€ä¸­çš„å¾ªç¯ï¼Œä¸€ä¸ªæ¥ç€ä¸€ä¸ªæ‰§è¡Œï¼Œè€—æ—¶è‡ªç„¶ä¹Ÿå°±æ˜¯æ‰€æœ‰å¼‚æ­¥æ–¹æ³•è€—æ—¶çš„æ€»å’Œã€‚å¯¹èµ„æºçš„æ¶ˆè€—æœ€å°ã€‚ è¿™ä¸ªå®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼ŒæŠŠæ•°ç»„çœ‹åšä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡ä»é˜Ÿåˆ—shiftå‡ºä¸€ä¸ªä»£å…¥å¼‚æ­¥æ–¹æ³•æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæˆå°±å¼€å§‹é€’å½’è°ƒç”¨è¿™ä¸ªè¿‡ç¨‹ï¼Œå½“é˜Ÿåˆ—é•¿åº¦ä¸ºç©ºå°±è¡¨ç¤ºæ‰€æœ‰çš„å¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œç»“æŸé€’å½’ï¼Œé€šçŸ¥å…¨éƒ¨å®Œæˆçš„å›è°ƒã€‚ ä½¿ç”¨ async.eachSeriesï¼š1234567891011121314import &#123; eachSeries &#125; from 'async'; import sleep from './sleep';let times = [100, 150, 200, 250, 300];console.log('sleep start'); console.time('async one by one'); eachSeries(times, sleep, (err) =&gt; &#123; console.timeEnd('async one by one'); console.log('sleep complete');&#125;);// sleep start// async one by one: 1020.078ms// sleep complete ä½¿ç”¨ Promise.reduceï¼š12345678910111213141516import Promise from 'bluebird'; import sleep from './sleep';let times = [100, 150, 200, 250, 300];console.log('sleep start'); console.time('promise one by one'); Promise.reduce(times, (last, curr) =&gt; &#123; return sleep(curr);&#125;, 0).then(() =&gt; &#123; console.timeEnd('promise one by one'); console.log('sleep complete');&#125;);// sleep start// promise one by one: 1023.014ms// sleep complete ä½¿ç”¨ES7 async/awaitï¼š12345678910111213141516import sleep from './sleep';let times = [100, 150, 200, 250, 300];(async function() &#123; console.log('sleep start'); console.time('es7 one by one'); for (let time of times) &#123; await sleep(time); &#125; console.timeEnd('es7 one by one'); console.log('sleep complete');&#125;());// sleep start// es7 one by one: 1025.513ms// sleep complete With concurrencyè¿™ç§æ–¹å¼ç¨å¾®å¤æ‚äº›ï¼Œä½†ä¹Ÿæ˜¯æœ€çµæ´»çš„æ–¹å¼ï¼Œå¯ä»¥éšå¿ƒæ§åˆ¶å¹¶å‘æ•°ã€‚æ•ˆç‡å’Œè€—æ—¶å–å†³äºé­”æ³•æ•°å­— concurrencyï¼Œå½“ concurrency å¤§äºæˆ–ç­‰äºæ•°ç»„é•¿åº¦æ—¶ï¼Œå®ƒå°±ç­‰åŒäº All in æ–¹å¼ï¼›å½“ concurrency ä¸º 1 æ—¶ï¼Œå®ƒå°±ç­‰åŒäº One by one æ–¹å¼ã€‚æ‰€ä»¥è€—æ—¶å’Œå¯¹èµ„æºçš„æ¶ˆè€—éƒ½ä¼šä»‹äºä»¥ä¸Šä¸¤ç§æ–¹å¼ä¹‹é—´ã€‚ With concurrency æœ¬èº«åœ¨å®ç°ä¸Šä¹Ÿä¼šæœ‰ä¸åŒçš„æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯é¢„åˆ†ç»„å’Œä»»åŠ¡æ± ã€‚ é¢„åˆ†ç»„ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æå‰å°†æ•°ç»„å†…å®¹æŒ‰ concurrency åˆ†å¥½ç»„ï¼Œç»„å†…æ˜¯ä»¥ All in æ–¹å¼æ‰§è¡Œï¼Œç»„ä¹‹é—´åˆ™æ˜¯ä»¥ One by one çš„æ–¹å¼æ‰§è¡Œã€‚ å°±ä»¥ä¸Šæ–‡çš„ä¾‹å­ï¼Œå‡å¦‚ concurrency ä¸º 2ï¼Œtimes é¢„å…ˆåˆ†ç»„æˆï¼š[[100, 150], [200, 250], [300]]ï¼Œè¿™æ ·è€—æ—¶ä¼šæ˜¯ 700ï¼ˆ150 + 250 + 300ï¼‰ã€‚ è¿™ä¸ªå®ç°æ–¹å¼å¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶å¹¶å‘æ•°ï¼Œä¼˜ç‚¹å°±æ˜¯ç®€å•ï¼Œç¼ºç‚¹æ˜¯å¹¶ä¸èƒ½è¾¾åˆ°æ•ˆç‡æœ€å¤§åŒ–ã€‚ ä»»åŠ¡æ±  ä»»åŠ¡æ± çš„æ–¹å¼å°±æ˜¯è®¾ç½®ä¸€ä¸ªå®¹é‡ä¸º concurrency çš„æ± å­ï¼Œæ¯”å¦‚å®¹é‡ä¸º 2ï¼Œåˆå§‹åŒ–æ”¾å…¥ä¸¤ä¸ªä»»åŠ¡ï¼Œæ¯å½“æœ‰ä»»åŠ¡å®Œæˆï¼Œå°±ç»§ç»­å¾€æ± å­æ·»åŠ æ–°çš„ä»»åŠ¡ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆã€‚ä¸Šæ–‡çš„ä¾‹å­æ‰§è¡Œè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š time = 0; pool = [100, 150]ï¼šæ”¾å…¥ 100 å’Œ 150 time = 100; pool = [150, 200]ï¼š100 ç»“æŸï¼Œæ”¾å…¥ 200 time = 150; pool = [200, 250]ï¼š150 ç»“æŸï¼Œæ”¾å…¥ 250 time = 300; pool = [250, 300]ï¼š200 ç»“æŸï¼Œæ”¾å…¥ 300 time = 400; pool = [300]ï¼š250 ç»“æŸï¼Œæ²¡æœ‰æ›´å¤šä»»åŠ¡ time = 600; pool = []ï¼š300 ç»“æŸï¼Œå¾ªç¯å®Œæ¯• å¾—å‡ºæ¥çš„è€—æ—¶æ˜¯ 600ï¼Œæ¯”é¢„åˆ†ç»„çš„æ–¹å¼æ•ˆç‡æ›´é«˜ï¼Œè€Œä¸”åŒæ ·èƒ½æœ‰æ•ˆæ§åˆ¶å¹¶å‘ä¸ªæ•°ã€‚async å’Œ bluebird ä¹Ÿæœ‰ç›¸å…³çš„æ–¹æ³•ä¾›ç›´æ¥ä½¿ç”¨ã€‚ ä½¿ç”¨ async.eachLimitï¼š1234567891011121314import &#123; eachLimit &#125; from 'async'; import sleep from './sleep';let times = [100, 150, 200, 250, 300];console.log('sleep start'); console.time('async with concurrency'); eachLimit(times, 2, sleep, (err) =&gt; &#123; console.timeEnd('async with concurrency'); console.log('sleep complete');&#125;);// sleep start// async with concurrency: 611.498ms// sleep complete ä½¿ç”¨ Promise.mapï¼ˆbluebird ç‰¹æœ‰ apiï¼‰ï¼š123456789101112131415161718import Promise from 'bluebird'; import sleep from './sleep';let times = [100, 150, 200, 250, 300];console.log('sleep start'); console.time('promise one by one'); Promise.map(times, (time) =&gt; &#123; return sleep(time);&#125;, &#123; concurrency: 2&#125;).then(() =&gt; &#123; console.timeEnd('promise one by one'); console.log('sleep complete');&#125;);// sleep start// promise with concurrency: 616.601ms// sleep complete ä½¿ç”¨ES7 async/awaitï¼š pool æ–¹æ³•æ¥è‡ªdavetemplin/async-parallel 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import sleep from './sleep';let times = [100, 150, 200, 250, 300];(async function() &#123; console.log('sleep start'); console.time('es7 with concurrency'); await pool(2, async () =&gt; &#123; await sleep(times.shift()); return times.length &gt; 0; &#125;); console.timeEnd('es7 with concurrency'); console.log('sleep complete');&#125;());async function pool(size, task) &#123; var active = 0; var done = false; var errors = []; return new Promise((resolve, reject) =&gt; &#123; next(); function next() &#123; while (active &lt; size &amp;&amp; !done) &#123; active += 1; task() .then(more =&gt; &#123; if (--active === 0 &amp;&amp; (done || !more)) errors.length === 0 ? resolve() : reject(errors); else if (more) next(); else done = true; &#125;) .catch(err =&gt; &#123; errors.push(err); done = true; if (--active === 0) reject(errors); &#125;); &#125; &#125; &#125;);&#125;// sleep start// es7 with concurrency: 612.197ms// sleep complete æ€»ç»“å¥½äº†ï¼Œåˆ°è¿™åº”è¯¥å¯ä»¥ç»™è¿™ä¸‰ç§å¾ªç¯æ–¹å¼æ‰“ä¸‹åˆ†äº†ï¼š å¾ªç¯æ–¹å¼ æ•ˆç‡ æ¶ˆè€— çµæ´»åº¦ å¤æ‚åº¦ All in é«˜ é«˜ ä½ ä½ One by one ä½ ä½ ä½ ä½ With concurrency ä¸­ ä¸­ é«˜ é«˜ ä¹ä¸€çœ‹ With concurrency æ˜¯å®Œèƒœï¼Œå…¶å®å¹¶æ²¡æœ‰ã€‚All in å’Œ One by one è™½ç„¶çµæ´»åº¦ä½ï¼Œä½†æ˜¯åº”ç”¨çš„åœºæ™¯è¿˜æ˜¯éå¸¸å¹¿æ³›çš„ã€‚è¦æ±‚æ•ˆç‡ä¼˜å…ˆå°±ä½¿ç”¨ All inï¼›å¦‚æœæœ‰ä¸‹ä¸€æ¬¡å¾ªç¯ä¾èµ–ä¸Šä¸€æ¬¡å¾ªç¯ç»“æœçš„åœºæ™¯ï¼Œå°±å¿…é¡»ä½¿ç”¨ One by Oneã€‚ å†è¯´ä¸‹ä¸Šé¢ asyncã€bluebirdã€ES7 å¯¹è¿™ä¸‰ç§å¾ªç¯æ–¹å¼çš„å®ç°ã€‚éœ€æ±‚ä¸€ç›´åœ¨å˜ï¼Œasync éœ€è¦ä¿®æ”¹çš„ä»£ç éå¸¸å°‘ï¼Œç”šè‡³åªè¦æ”¹ä¸‹æ–¹æ³•åå°±å¯ä»¥ï¼Œæ–¹æ³•å®šä¹‰ç®€å•ä¼˜é›…ï¼Œè¿™å¯èƒ½ä¹Ÿæ˜¯ async æ˜“ä¸Šæ‰‹çš„åŸå› ï¼›bluebird åœ¨ Promise æ ‡å‡†åŸºç¡€ä¸Šæ·»åŠ çš„æ–¹æ³•éå¸¸å®ç”¨ï¼Œå¦‚ï¼šmapã€joinâ€¦ï¼Œä»¥è‡³äºæˆ‘å‡ ä¹æ˜¯æ²¡æœ‰ä½¿ç”¨è¿‡åŸç”Ÿ Promise ğŸ˜‚ï¼›ES7 æ–°å¢çš„ async/await è¯­æ³•ç‰¹æ€§ç¡®å®å‡è½»äº†ç¼–å†™å¼‚æ­¥ä»£ç çš„ç—›è‹¦ï¼ŒåŒæ—¶è¿˜å¢å¼ºäº†ä»£ç çš„å¯è¯»æ€§ã€‚","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"ä¼ªç±»å’Œä¼ªå…ƒç´ ","slug":"ä¼ªç±»å’Œä¼ªå…ƒç´ ","date":"2019-11-16T11:40:32.000Z","updated":"2019-11-16T11:49:57.412Z","comments":true,"path":"2019/11/16/ä¼ªç±»å’Œä¼ªå…ƒç´ /","link":"","permalink":"http://yoursite.com/2019/11/16/ä¼ªç±»å’Œä¼ªå…ƒç´ /","excerpt":"","text":"ä¼ªç±»å’Œä¼ªå…ƒç´ csså¼•å…¥ä¼ªç±»å’Œä¼ªå…ƒç´ æ¦‚å¿µæ˜¯ä¸ºäº†æ ¼å¼åŒ–æ–‡æ¡£æ ‘ä»¥å¤–çš„ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ªç±»å’Œä¼ªå…ƒç´ æ˜¯ç”¨æ¥ä¿®é¥°ä¸åœ¨æ–‡æ¡£æ ‘ä¸­çš„éƒ¨åˆ†ã€‚ ä¼ªç±»ç”¨äºå½“å·²æœ‰å…ƒç´ å¤„äºçš„æŸä¸ªçŠ¶æ€æ—¶ï¼Œä¸ºå…¶æ·»åŠ å¯¹åº”çš„æ ·å¼ï¼Œè¿™ä¸ªçŠ¶æ€æ˜¯æ ¹æ®ç”¨æˆ·è¡Œä¸ºè€ŒåŠ¨æ€å˜åŒ–çš„ã€‚æ¯”å¦‚è¯´ï¼Œå½“ç”¨æˆ·æ‚¬åœåœ¨æŒ‡å®šçš„å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡:hoveræ¥æè¿°è¿™ä¸ªå…ƒç´ çš„çŠ¶æ€ã€‚è™½ç„¶å®ƒå’Œæ™®é€šçš„cssç±»ç›¸ä¼¼ï¼Œå¯ä»¥ä¸ºå·²æœ‰çš„å…ƒç´ æ·»åŠ æ ·å¼ï¼Œä½†æ˜¯å®ƒåªæœ‰å¤„äºdomæ ‘æ— æ³•æè¿°çš„çŠ¶æ€ä¸‹æ‰èƒ½ä¸ºå…ƒç´ æ·»åŠ æ ·å¼ï¼Œæ‰€ä»¥å°†å…¶ç§°ä¸ºä¼ªç±»ã€‚ ä¼ªå…ƒç´ ç”¨äºåˆ›å»ºä¸€äº›ä¸åœ¨æ–‡æ¡£æ ‘ä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸ºå…¶æ·»åŠ æ ·å¼ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡:beforeæ¥åœ¨ä¸€ä¸ªå…ƒç´ å‰å¢åŠ ä¸€äº›æ–‡æœ¬ï¼Œå¹¶ä¸ºè¿™äº›æ–‡æœ¬æ·»åŠ æ ·å¼ã€‚è™½ç„¶ç”¨æˆ·å¯ä»¥çœ‹åˆ°è¿™äº›æ–‡æœ¬ï¼Œä½†æ˜¯è¿™äº›æ–‡æœ¬å®é™…ä¸Šä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚ ä¼ªç±»çš„æ•ˆæœå¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ªå®é™…çš„ç±»æ¥è¾¾åˆ°ï¼Œè€Œä¼ªå…ƒç´ çš„æ•ˆæœåˆ™éœ€è¦é€šè¿‡æ·»åŠ ä¸€ä¸ªå®é™…çš„å…ƒç´ æ‰èƒ½è¾¾åˆ°ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä»–ä»¬ä¸€ä¸ªç§°ä¸ºä¼ªç±»ï¼Œä¸€ä¸ªç§°ä¸ºä¼ªå…ƒç´ çš„åŸå› ã€‚ ä¼ªç±»å’Œä¼ªå…ƒç´ çš„æ ¹æœ¬åŒºåˆ«åœ¨äºï¼šå®ƒä»¬æ˜¯å¦åˆ›é€ äº†æ–°çš„å…ƒç´ ,, è¿™ä¸ªæ–°åˆ›é€ çš„å…ƒç´ å°±å« â€œä¼ªæ— ç´ â€ ã€‚ ##ä¼ªç±» ä¼ªç±»å‰é¢æ˜¯ä¸€ä¸ªå†’å·ï¼ŒE:first-childä¼šå¯¹ç°æœ‰çš„å…ƒç´ è¿›è¡Œç­›é€‰ :link:é€‰æ‹©æœªè®¿é—®çš„é“¾æ¥ :visited:é€‰æ‹©å·²è®¿é—®çš„é“¾æ¥ :hover:é€‰æ‹©é¼ æ ‡æŒ‡é’ˆæµ®åŠ¨åœ¨å…¶ä¸Šçš„å…ƒç´  :active:é€‰æ‹©æ´»åŠ¨çš„é“¾æ¥ :focus:é€‰æ‹©è·å–ç„¦ç‚¹çš„è¾“å…¥å­—æ®µ :not():ä¸€ä¸ªå¦å®šä¼ªç±»ï¼Œç”¨äºåŒ¹é…ä¸ç¬¦åˆå‚æ•°é€‰æ‹©å™¨çš„å…ƒç´ ã€‚ :first-child:åŒ¹é…å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ã€‚ :last-child:åŒ¹é…å…ƒç´ çš„æœ€åä¸€ä¸ªå­å…ƒç´ ã€‚ :first-of-type:åŒ¹é…å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ªç‰¹å®šç±»å‹çš„å­å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚ :last-of-type:åŒ¹é…å±äºå…¶çˆ¶å…ƒç´ çš„æœ€åä¸€ä¸ªç‰¹å®šç±»å‹çš„å­å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚ :nth-child::nth-childæ ¹æ®å…ƒç´ çš„ä½ç½®åŒ¹é…ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ï¼Œå®ƒæ¥å—ä¸€ä¸ª an+b å½¢å¼çš„å‚æ•°ï¼Œan+b åŒ¹é…åˆ°çš„å…ƒç´  :nth-last-child::nth-last-child ä¸:nth-childç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯ä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°çš„ã€‚ :nth-of-type::nth-of-type ä¸ nth-childç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯åªåŒ¹é…ç‰¹å®šç±»å‹çš„å…ƒç´ ã€‚ :nth-last-type::nth-last-of-type ä¸ nth-of-typeç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯ä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°çš„ã€‚ :only-child :å½“å…ƒç´ æ˜¯å…¶çˆ¶å…ƒç´ ä¸­å”¯ä¸€ä¸€ä¸ªç‰¹å®šç±»å‹çš„å­å…ƒç´ æ—¶ï¼Œ:only-childåŒ¹é…è¯¥å…ƒç´ ã€‚ :target :å½“URLå¸¦æœ‰é”šåç§°ï¼ŒæŒ‡å‘æ–‡æ¡£å†…æŸä¸ªå…·ä½“çš„å…ƒç´ æ—¶ï¼Œ:targetåŒ¹é…è¯¥å…ƒç´ ã€‚ :checked::checkedåŒ¹é…è¢«é€‰ä¸­çš„ input å…ƒç´ ï¼Œè¿™ä¸ª input å…ƒç´ åŒ…æ‹¬ radio å’Œ checkboxã€‚ :default: åŒ¹é…é»˜è®¤é€‰ä¸­çš„å…ƒç´  :disabled: åŒ¹é…ç¦ç”¨çš„è¡¨å•å…ƒç´ ã€‚ :empty :åŒ¹é…æ²¡æœ‰å­å…ƒç´ çš„å…ƒç´  :enabled: åŒ¹é…æ²¡æœ‰è®¾ç½® disabled å±æ€§çš„è¡¨å•å…ƒç´ ã€‚ :in-range: åŒ¹é…åœ¨æŒ‡å®šåŒºåŸŸå†…å…ƒç´ ã€‚ :out-of-range: ä¸:in-rangeç›¸åï¼Œå®ƒåŒ¹é…ä¸åœ¨æŒ‡å®šåŒºåŸŸå†…çš„å…ƒç´ ã€‚ :indeterminate:indeterminate çš„è‹±æ–‡æ„æ€æ˜¯â€œ ä¸ç¡®å®šçš„â€ã€‚å½“æŸç»„ä¸­çš„å•é€‰æ¡†æˆ–å¤é€‰æ¡†è¿˜æ²¡æœ‰é€‰å–çŠ¶æ€æ—¶ï¼Œ:indeterminate åŒ¹é…è¯¥ç»„ä¸­æ‰€æœ‰çš„å•é€‰æ¡†æˆ–å¤é€‰æ¡†ã€‚ :valid :åŒ¹é…æ¡ä»¶éªŒè¯æ­£ç¡®çš„è¡¨å•å…ƒç´ ã€‚ :invalid: ä¸:valid ç›¸åï¼ŒåŒ¹é…æ¡ä»¶éªŒè¯é”™è¯¯çš„è¡¨å•å…ƒç´ ã€‚ :optional:åŒ¹é…æ˜¯å…·æœ‰ optional å±æ€§çš„è¡¨å•å…ƒç´ ã€‚å½“è¡¨å•å…ƒç´ æ²¡æœ‰è®¾ç½®ä¸º required æ—¶ï¼Œå³ä¸º optional å±æ€§ã€‚ :required: ä¸:optionalç›¸ååŒ¹é…è®¾ç½®äº† required å±æ€§çš„è¡¨å•å…ƒç´ ã€‚ :read-only: åŒ¹é…è®¾ç½®äº†åªè¯»å±æ€§çš„å…ƒç´ ï¼Œè¡¨å•å…ƒç´ å¯ä»¥é€šè¿‡è®¾ç½®â€œreadonlyâ€ å±æ€§æ¥å®šä¹‰å…ƒç´ åªè¯»ã€‚ :read-write: åŒ¹é…å¤„äºç¼–è¾‘çŠ¶æ€çš„å…ƒç´ ã€‚inputï¼Œtextarea å’Œè®¾ç½®äº† contenteditable çš„ HTML å…ƒç´ è·å–ç„¦ç‚¹æ—¶å³å¤„äºç¼–è¾‘çŠ¶æ€ã€‚ :scope: åŒ¹é…å¤„äº style ä½œç”¨åŸŸä¸‹çš„å…ƒç´ ã€‚å½“ style æ²¡æœ‰è®¾ç½® scope å±æ€§æ—¶ï¼Œstyle å†…çš„æ ·å¼ä¼šå¯¹æ•´ä¸ª html èµ·ä½œç”¨ã€‚ :dir:åŒ¹é…æŒ‡å®šé˜…è¯»æ–¹å‘çš„å…ƒç´ ï¼Œå½“ HTML å…ƒç´ ä¸­è®¾ç½®äº† dir å±æ€§æ—¶è¯¥ä¼ªç±»æ‰èƒ½ç”Ÿæ•ˆã€‚ç°æ—¶æ”¯æŒçš„é˜…è¯»æ–¹å‘æœ‰ä¸¤ç§ï¼šltrï¼ˆä»å·¦å¾€å³ï¼‰å’Œ rtlï¼ˆä»å³å¾€å·¦ï¼‰ã€‚ç›®å‰ï¼Œåªæœ‰ç«ç‹æµè§ˆå™¨æ”¯æŒ:dir ä¼ªç±»ï¼Œå¹¶åœ¨ç«ç‹æµè§ˆå™¨ä¸­ä½¿ç”¨æ—¶éœ€è¦æ·»åŠ å‰ç¼€ ( -moz-dir() )ã€‚ :lang:åŒ¹é…è®¾ç½®äº†ç‰¹å®šè¯­è¨€çš„å…ƒç´ ï¼Œè®¾ç½®ç‰¹å®šè¯­è¨€å¯ä»¥é€šè¿‡ä¸ºäº† HTML å…ƒç´ è®¾ç½® lang=â€â€ å±æ€§ï¼Œè®¾ç½® meta å…ƒç´ çš„ charset=â€â€ å±æ€§ï¼Œæˆ–è€…æ˜¯åœ¨ http å¤´éƒ¨ä¸Šè®¾ç½®è¯­è¨€å±æ€§ã€‚ å®é™…ä¸Šï¼Œlang=â€â€ å±æ€§ä¸åªå¯ä»¥åœ¨ html æ ‡ç­¾ä¸Šè®¾ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶ä»–çš„å…ƒç´ ä¸Šè®¾ç½®ã€‚ :root:åŒ¹é…æ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚ä¸€èˆ¬çš„ html æ–‡ä»¶çš„æ ¹å…ƒç´ æ˜¯ html å…ƒç´ ï¼Œè€Œ SVG æˆ– XML æ–‡ä»¶çš„æ ¹å…ƒç´ åˆ™å¯èƒ½æ˜¯å…¶ä»–å…ƒç´ ã€‚ :fullscreen: åŒ¹é…å¤„äºå…¨å±æ¨¡å¼ä¸‹çš„å…ƒç´ ã€‚å…¨å±æ¨¡å¼ä¸æ˜¯é€šè¿‡æŒ‰ F11 æ¥æ‰“å¼€çš„å…¨å±æ¨¡å¼ï¼Œè€Œæ˜¯é€šè¿‡ Javascript çš„ Fullscreen API æ¥æ‰“å¼€çš„ï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„ Fullscreen APIã€‚ç›®å‰ï¼Œ:fullscreen éœ€è¦æ·»åŠ å‰ç¼€æ‰èƒ½ä½¿ç”¨ã€‚ ##ä¼ªå…ƒç´  ä¼ªå…ƒç´ å‰é¢æ˜¯ä¸¤ä¸ªå†’å·ï¼ŒE::first-lineä¼šåˆ›é€ å‡ºä¸å­˜åœ¨çš„æ–°å…ƒç´ ï¼Œç”±äºcsså¯¹å•å†’å·çš„ä¼ªå…ƒç´ ä¹Ÿæ”¯æŒï¼Œæ‰€ä»¥è¿™æ ·å¾ˆå®¹æ˜“è®©æ–°å­¦è€…æ··æ·†ã€‚ä½†å®é™…ä¸Šç°åœ¨css3å·²ç»æ˜ç¡®è§„å®šäº†ä¼ªç±»å•å†’å·ï¼Œä¼ªå…ƒç´ åŒå†’å·çš„è§„åˆ™ã€‚ ::before/:beforeåœ¨è¢«é€‰å…ƒç´ å‰æ’å…¥å†…å®¹ã€‚éœ€è¦ä½¿ç”¨ content å±æ€§æ¥æŒ‡å®šè¦æ’å…¥çš„å†…å®¹ã€‚è¢«æ’å…¥çš„å†…å®¹å®é™…ä¸Šä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚ ::after/:after åœ¨è¢«å…ƒç´ åæ’å…¥å†…å®¹ï¼Œå…¶ç”¨æ³•å’Œç‰¹æ€§ä¸:beforeç›¸ä¼¼ã€‚ å¯¹äºä¼ªå…ƒç´  :before å’Œ :after è€Œè¨€ï¼Œå±æ€§ content æ˜¯å¿…é¡»è®¾ç½®çš„ï¼Œæˆ‘ä»¬çŸ¥é“å±æ€§çš„å€¼å¯ä»¥ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æœ‰å…¶å®ƒå½¢å¼ï¼Œæ¯”å¦‚æŒ‡å‘ä¸€å¼ å›¾ç‰‡çš„ URL: content: url(&#39;img/icon.png&#39;) ::first-letter/:first-letter åŒ¹é…å…ƒç´ ä¸­æ–‡æœ¬çš„é¦–å­—æ¯ã€‚è¢«ä¿®é¥°çš„é¦–å­—æ¯ä¸åœ¨æ–‡æ¡£æ ‘ä¸­ ::first-line/:first-line åŒ¹é…å…ƒç´ ä¸­ç¬¬ä¸€è¡Œçš„æ–‡æœ¬ã€‚è¿™ä¸ªä¼ªå…ƒç´ åªèƒ½ç”¨åœ¨å—å…ƒç´ ä¸­ï¼Œä¸èƒ½ç”¨åœ¨å†…è”å…ƒç´ ä¸­ã€‚ ::selection åŒ¹é…ç”¨æˆ·è¢«ç”¨æˆ·é€‰ä¸­æˆ–è€…å¤„äºé«˜äº®çŠ¶æ€çš„éƒ¨åˆ†ã€‚åœ¨ç«ç‹æµè§ˆå™¨ä½¿ç”¨æ—¶éœ€è¦æ·»åŠ -mozå‰ç¼€ã€‚è¯¥ä¼ªå…ƒç´ åªæ”¯æŒåŒå†’å·çš„å½¢å¼ã€‚ ::placeholder åŒ¹é…å ä½ç¬¦çš„æ–‡æœ¬ï¼Œåªæœ‰å…ƒç´ è®¾ç½®äº†placeholderå±æ€§æ—¶ï¼Œè¯¥ä¼ªå…ƒç´ æ‰èƒ½ç”Ÿæ•ˆã€‚ ä¼ªå…ƒç´ ä¸æ˜¯CSSçš„æ ‡å‡†ï¼Œå®ƒçš„å®ç°å¯èƒ½åœ¨å°†æ¥ä¼šæœ‰æ‰€æ”¹å˜ï¼Œæ‰€ä»¥è¦å†³å®šä½¿ç”¨æ—¶å¿…é¡»è°¨æ…ã€‚åœ¨ä¸€äº›æµè§ˆå™¨ä¸­ï¼ˆIE10å’ŒFirefox18åŠå…¶ä»¥ä¸‹ç‰ˆæœ¬ï¼‰ä¼šä½¿ç”¨å•å†’å·çš„å½¢å¼ã€‚ ::backdrop ç”¨äºæ”¹å˜å…¨å±æ¨¡å¼ä¸‹çš„èƒŒæ™¯é¢œè‰²ï¼Œå…¨å±æ¨¡å¼çš„é»˜è®¤é¢œè‰²ä¸ºé»‘è‰²ã€‚è¯¥ä¼ªå…ƒç´ åªæ”¯æŒåŒå†’å·çš„å½¢å¼ æ³¨æ„ï¼š é…åˆä¼ªç±»ä½¿ç”¨ ä¼ªå…ƒç´  :before è¿˜å¯ä»¥é…åˆä¼ªç±»ä½¿ç”¨ï¼Œè¿™é‡Œä¸¾ç»å¸¸ä¸ :before é…åˆä½¿ç”¨çš„ä¼ªç±» :hover ä¸ºä¾‹ï¼š 12.before:hover:before&#123;content:'you before'; color:red;&#125;&lt;div class=\"before\"&gt; me&lt;/div&gt; é…åˆå–å€¼å‡½æ•° attr() ä½¿ç”¨ 12345a::before&#123;content: attr(title)&#125;&lt;a href=\"https://blog.ihoey.com\" title=\"æ¢¦é­‡å°æ ˆ\"&gt;&lt;/a&gt;æ•ˆæœ&lt;a href=\"https://blog.ihoey.com\" title=\"æ¢¦é­‡å°æ ˆ\"&gt;æ¢¦é­‡å°æ ˆ&lt;/a&gt;","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"ä¼ªå…ƒç´ ","slug":"ä¼ªå…ƒç´ ","permalink":"http://yoursite.com/tags/ä¼ªå…ƒç´ /"},{"name":"ä¼ªç±»","slug":"ä¼ªç±»","permalink":"http://yoursite.com/tags/ä¼ªç±»/"}]},{"title":"sass&lesså¯¹æ¯”","slug":"sass&lesså¯¹æ¯”","date":"2019-11-11T06:09:00.000Z","updated":"2019-11-10T15:36:08.788Z","comments":true,"path":"2019/11/11/sass&lesså¯¹æ¯”/","link":"","permalink":"http://yoursite.com/2019/11/11/sass&lesså¯¹æ¯”/","excerpt":"","text":"sass&amp;less##ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ CSS é¢„å¤„ç†å™¨ï¼Ÿ ä½œä¸ºå‰ç«¯å¼€å‘äººå‘˜ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼ŒJs ä¸­å¯ä»¥è‡ªå®šä¹‰å˜é‡ï¼Œè€Œ CSS ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è®°è¯­è¨€ï¼Œä¸æ˜¯ç¼–ç¨‹è¯­è¨€ï¼Œå› æ­¤ä¸å¯ä»¥è‡ªå®šä¹‰å˜é‡ï¼Œä¸å¯ä»¥å¼•ç”¨ç­‰ç­‰ã€‚ CSS æœ‰å…·ä½“ä»¥ä¸‹å‡ ä¸ªç¼ºç‚¹ï¼š è¯­æ³•ä¸å¤Ÿå¼ºå¤§ï¼Œæ¯”å¦‚æ— æ³•åµŒå¥—ä¹¦å†™ï¼Œå¯¼è‡´æ¨¡å—åŒ–å¼€å‘ä¸­éœ€è¦ä¹¦å†™å¾ˆå¤šé‡å¤çš„é€‰æ‹©å™¨ï¼› æ²¡æœ‰å˜é‡å’Œåˆç†çš„æ ·å¼å¤ç”¨æœºåˆ¶ï¼Œä½¿å¾—é€»è¾‘ä¸Šç›¸å…³çš„å±æ€§å€¼å¿…é¡»ä»¥å­—é¢é‡çš„å½¢å¼é‡å¤è¾“å‡ºï¼Œå¯¼è‡´éš¾ä»¥ç»´æŠ¤ã€‚ è¿™å°±å¯¼è‡´äº†æˆ‘ä»¬åœ¨å·¥ä½œä¸­æ— ç«¯å¢åŠ äº†è®¸å¤šå·¥ä½œé‡ã€‚è€Œä½¿ç”¨ CSS é¢„å¤„ç†å™¨ï¼Œæä¾› CSS ç¼ºå¤±çš„æ ·å¼å±‚å¤ç”¨æœºåˆ¶ã€å‡å°‘å†—ä½™ä»£ç ï¼Œæé«˜æ ·å¼ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚å¤§å¤§æé«˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚ ä½†æ˜¯ï¼ŒCSS é¢„å¤„ç†å™¨ä¹Ÿä¸æ˜¯ä¸‡é‡‘æ²¹ï¼ŒCSS çš„å¥½å¤„åœ¨äºç®€ä¾¿ã€éšæ—¶éšåœ°è¢«ä½¿ç”¨å’Œè°ƒè¯•ã€‚é¢„ç¼–è¯‘ CSS æ­¥éª¤çš„åŠ å…¥ï¼Œè®©æˆ‘ä»¬å¼€å‘å·¥ä½œæµä¸­å¤šäº†ä¸€ä¸ªç¯èŠ‚ï¼Œè°ƒè¯•ä¹Ÿå˜å¾—æ›´éº»çƒ¦äº†ã€‚æ›´å¤§çš„é—®é¢˜åœ¨äºï¼Œé¢„ç¼–è¯‘å¾ˆå®¹æ˜“é€ æˆåä»£é€‰æ‹©å™¨çš„æ»¥ç”¨ã€‚ æ‰€ä»¥æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­è¡¡é‡é¢„ç¼–è¯‘æ–¹æ¡ˆæ—¶ï¼Œè¿˜æ˜¯å¾—æƒ³æƒ³ï¼Œæ¯”èµ·å¸¦æ¥çš„é¢å¤–ç»´æŠ¤å¼€é”€ï¼ŒCSS é¢„å¤„ç†å™¨æœ‰æ²¡æœ‰è§£å†³æ›´å¤§çš„éº»çƒ¦ã€‚ ä¸»è¦åŒºåˆ«ï¼šé¦–å…ˆ sass å’Œ less éƒ½æ˜¯ css çš„é¢„ç¼–è¯‘å¤„ç†è¯­è¨€ï¼Œä»–ä»¬å¼•å…¥äº† mixinsï¼Œå‚æ•°ï¼ŒåµŒå¥—è§„åˆ™ï¼Œè¿ç®—ï¼Œé¢œè‰²ï¼Œåå­—ç©ºé—´ï¼Œä½œç”¨åŸŸï¼ŒJavaScript èµ‹å€¼ç­‰ åŠ å¿«äº† css å¼€å‘æ•ˆç‡,å½“ç„¶è¿™ä¸¤è€…éƒ½å¯ä»¥é…åˆ gulp å’Œ grunt ç­‰å‰ç«¯æ„å»ºå·¥å…·ä½¿ç”¨ sass å’Œ lessä¸»è¦åŒºåˆ«:åœ¨äºå®ç°æ–¹å¼ less æ˜¯åŸºäº JavaScript çš„åœ¨å®¢æˆ·ç«¯å¤„ç† æ‰€ä»¥å®‰è£…çš„æ—¶å€™ç”¨ npmï¼Œsass æ˜¯åŸºäº ruby æ‰€ä»¥åœ¨æœåŠ¡å™¨å¤„ç†ã€‚ SASS ä»‹ç»Sass æ˜¯ Ruby å¼€å‘è€…ä¸ºå‰ç«¯å¼€å‘æä¾›çš„å¤„ç† CSS çš„å·¥å…·ã€‚å®ƒä¸º CSS æä¾›æ›´åŠ¨æ€çš„è®¾å®šæ–¹å¼ï¼Œå…è®¸ç¼–è¯‘ã€å˜é‡ã€å‡½æ•°â€¦â€¦æ€»ä¹‹ï¼Œä½¿ CSS æ›´åŠ¨æ€ï¼Œä¹Ÿæ›´åƒä¸€é—¨çœŸæ­£çš„å¯ç¼–ç¨‹è¯­è¨€ã€‚ Sass æ˜¯åŸºäº Ruby å¼€å‘çš„ï¼Œæ‰€ä»¥å¼€å‘ç¯å¢ƒé¦–å…ˆéœ€è¦å®‰è£… Rubyã€‚ æµè§ˆå™¨ä¸­æ— æ³•ç¼–è¯‘ Sassï¼Œæ‰€ä»¥è¦å…ˆç¼–è¯‘å¥½ css æ–‡ä»¶ï¼Œå†äº¤ç»™æµè§ˆå™¨ã€‚Sassä¸èƒ½åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ç›´æ¥è¿è¡Œã€‚ ##Less ä»‹ç» Less æ˜¯æ™šäº›äº§ç”Ÿçš„è¯­è¨€ï¼ŒåŸºäº JS è¿›è¡Œå¼€å‘ï¼Œåœ¨ Node ä¸­è¿›è¡Œç¼–è¯‘ã€‚æ‰€ä»¥ä½¿ç”¨æ—¶ä¸éœ€è¦å®‰è£…å…¶ä»–è¯­è¨€ï¼Œä¸è¿‡è¦è®°å¾—å…ˆå¯¼å…¥ less æ–‡ä»¶ï¼Œç„¶åå¯¼å…¥ less.jsã€‚æä¾› CDN åœ°å€åœ¨è¿™é‡Œï¼š 12&lt;script src=\"https://cdn.bootcss.com/less.js/3.0.4/less.js\"&gt;&lt;/script&gt;&lt;script src=\"https://cdn.bootcss.com/less.js/3.0.4/less.min.js\"&gt;&lt;/script&gt; å½“ç„¶ Less ä¹Ÿæä¾›æœåŠ¡å™¨ç«¯çš„ç¼–è¯‘åŠŸèƒ½ã€‚ Stylus ä»‹ç»Stylusç›¸å¯¹å‰ä¸¤è€…è¾ƒæ–°ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ä»‹ç»çš„åŠŸèƒ½ã€‚ 1.æ¥è‡ª NodeJS ç¤¾åŒºï¼Œæ‰€ä»¥å’Œ NodeJS èµ°å¾—å¾ˆè¿‘ï¼Œä¸ JavaScript è”ç³»éå¸¸ç´§å¯†ã€‚è¿˜æœ‰ä¸“é—¨ JavaScript APIï¼šlearnboost.github.io/stylus/docsâ€¦ 2.æ”¯æŒ Ruby ä¹‹ç±»ç­‰ç­‰æ¡†æ¶ 3.æ›´å¤šæ›´å¼ºå¤§çš„æ”¯æŒå’ŒåŠŸèƒ½ ä»¥ stylus çš„è§’åº¦æ¥è¯´,stylus æ›´åŠ æ³¨é‡å¯¹ javascript( learnboost.github.io/stylus/docsâ€¦ ) çš„åˆ©ç”¨ã€‚ å½“ç”¨æˆ·è§‰å¾—å†™ stylus å‡½æ•°é‡åˆ°äº†è¿‡äºå¤æ‚æˆ–è€…æ— æ³•æµ‹è¯•ï¼Œstylus è¯­æ³•ä¸æ”¯æŒç­‰éœ€æ±‚æ—¶ï¼Œ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ js æ¥å®ç°è¿™ä¸ªå‡½æ•°å¹¶ä¸”åœ¨ stylus ä¸­è°ƒç”¨ã€‚ å…¶æ¬¡ä»ç¼–è¯‘å™¨æºç ä¸Šæ¥çœ‹ï¼šstylus åº”è¯¥æ¯” less.js æ›´æœ‰æ¡ç†ï¼Œ æ„Ÿè§‰å¦‚æœæœªæ¥ç¤¾åŒºæ·»åŠ åŠŸèƒ½çš„è¯ï¼Œstylus çš„æºç æ·»åŠ èµ·åŠŸèƒ½æ¥ä¼šæ›´ç®€å•ï¼ŒåŒæ ·ï¼Œç›®å‰ stylus çš„åŠŸèƒ½ä¹Ÿæ›´å¤æ‚ã€‚ stylus å’Œ sass å¦ä¸€ä¸ªåŒºåˆ«åœ¨äº sass æœ¬èº«ä¼šå»ºè®®ï¼Œä»¥ä¸‹åˆ’çº¿(_) æ‰“å¤´çš„æ–‡ä»¶åœ¨é™æ€èµ„æºæ‰“åŒ…çš„æ—¶å€™ä¸ä¼šè¢«ç¼–è¯‘æˆ .css æ–‡ä»¶ã€åªæ˜¯ä½œä¸ºä¸€ç§ import å­˜åœ¨ã€‘ã€‚è€Œ stylus æ²¡æœ‰è¿™æ–¹é¢çš„è§„èŒƒã€‚ åŒæ—¶å†™è¿‡ stylus å’Œ sassï¼Œ å°±è¯­æ³•ç®€æ´æ¥çœ‹ï¼Œ stylus åœ¨è¿™æ–¹é¢å äº†å¾ˆå¤§çš„ä¾¿å®œã€‚ ä¸‰è€…å¯¹æ¯” å˜é‡ Sass: $varLess: @varä¸¤ç§è¯­è¨€éƒ½ä¼šæœ‰ä½œç”¨åŸŸçš„é—®é¢˜ã€‚ä¸€ä¸ªå˜é‡åªèƒ½åœ¨å®ƒè¢«å®šä¹‰çš„ä»£ç å—ä¸­ä½¿ç”¨ã€‚é‡å¤å®šä¹‰çš„å˜é‡ä¼šæŠ¥é”™ã€‚ Stylus å¯¹å˜é‡åæ²¡æœ‰ä»»ä½•é™å®šï¼Œä½ å¯ä»¥æ˜¯ $ å¼€å§‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»»æ„çš„å­—ç¬¦ï¼Œè€Œä¸”ä¸å˜é‡å€¼ä¹‹é—´å¯ä»¥ç”¨å†’å·ã€ç©ºæ ¼éš”å¼€ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ Stylus (0.22.4) å°†ä¼šç¼–è¯‘ @ å¼€å§‹çš„å˜é‡ï¼Œä½†å…¶å¯¹åº”çš„å€¼å¹¶ä¸ä¼šèµ‹äºˆè¯¥å˜é‡ï¼Œæ¢å¥è¯è¯´ï¼Œåœ¨ Stylus çš„å˜é‡åä¸è¦ç”¨ @ å¼€å¤´ã€‚ è¿ç®—èµ‹å€¼ï¼š åªè¦ä¿æŒå•ä½ç»Ÿä¸€æˆ–å¯ç›¸äº’è½¬æ¢ï¼Œå°±å¯ä»¥è¿›è¡Œè¿ç®—ï¼ŒåŒ…æ‹¬é¢œè‰²åœ¨å†…ï¼šSass: 12345678910111213p &#123; cursor: e + -resize;&#125;// ç¼–è¯‘ä¸º// p &#123;// cursor: e-resize;// &#125;body &#123; margin: (14px/2); top: 50px + 100px; right: $var * 10%;&#125; Less: 12345678910111213@base: 5%;@filler: @base * 2;@other: @base + @filler;color: #888 / 4;background-color: @base-color + #111;height: 100% / 2 + @filler;@var: 1px + 5;width: (@var + 5) * 2;border: (@width * 2) solid black; åµŒå¥— Sass å’Œ Less å‡å…è®¸å…ƒç´ åµŒå¥—ã€‚å¦‚æœçˆ¶å­é€‰æ‹©å™¨å‡ç”¨é€—å·åˆ†å¼€ï¼Œé‚£ä¹ˆç¼–è¯‘æ—¶ä¼šæŒ‰ç»“åˆå¾‹æ‹†å¼€ç¼–è¯‘ã€‚Sass å’Œ Less æŒ‡ä»£ä¸Šå±‚å…ƒç´ å‡ä½¿ç”¨&amp;ç¬¦å·ã€‚ ç»§æ‰¿ Sass ä¸­ï¼Œå†™å¥½çš„é€‰æ‹©å™¨è¿›è¡Œé›†æˆï¼Œéœ€è¦@extendå…³é”®å­—ã€‚ï¼ˆsytlus ä¸ sass ç›¸åŒï¼‰Less ä¸­ï¼Œç›´æ¥å†™å…¥å³å¯ï¼š.be-extend-class; Mixin Sass ä¸­ï¼Œéœ€è¦è¿›è¡Œ Mixin æ“ä½œçš„é€‰æ‹©å™¨éœ€è¦@mixinå…³é”®å­—ï¼Œé€‰æ‹©å™¨åå¯ä»¥ä¼ å…¥å˜é‡å’Œé»˜è®¤å€¼ã€‚ 1@mixin left($value: 10px) padding: $value; ä½¿ç”¨æ—¶ä½¿ç”¨@includeå…³é”®å­—ï¼Œå¹¶å¯ä»¥æ›´æ–°å˜é‡ï¼š 1@include left @include left(20px); Less ä¸­ Mixin å’Œç»§æ‰¿æ„Ÿè§‰æ›´ç›¸ä¼¼ï¼Œé€‰æ‹©å™¨åœ¨ä¹¦å†™æ—¶å°±ç•™å¥½äº†å˜é‡ï¼Œç›´æ¥ç»§æ‰¿æˆ–æ›´æ–°å˜é‡å³å¯ï¼š 123456.be-extend-class(@width: 10px) &#123; padding: @width;&#125;// ä½¿ç”¨.be-extend-class;.be-extend-class(20px); sassï¼šåœ¨ sass å®šä¹‰ Mixins å’Œ lessã€stylus æœ‰æ‰€ä¸åŒï¼Œåœ¨å£°æ˜ Mixins æ—¶éœ€è¦ä½¿ç”¨â€œ@mixinâ€,ç„¶ååé¢ç´§è·Ÿ Mixins çš„åï¼Œä»–ä¹Ÿå¯ä»¥å®šä¹‰å‚æ•°ï¼ŒåŒæ—¶å¯ä»¥ç»™è¿™ä¸ªå‚æ•°è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œä½†å‚æ•°åæ˜¯ä½¿ç”¨â€œ$â€ç¬¦å·å¼€å§‹ï¼Œè€Œä¸”å’Œå‚æ•°å€¼ä¹‹é—´éœ€è¦ä½¿ç”¨å†’å·ï¼ˆï¼šï¼‰åˆ†å¼€ã€‚å¦å¤–åœ¨ sass ä¸­è°ƒç”¨ Mixins éœ€è¦ä½¿ç”¨â€œ@includeâ€ï¼Œç„¶ååœ¨å…¶åç´§è·Ÿä½ è¦è°ƒç”¨çš„ Mixins åã€‚ lessï¼šless ä¸­å£°æ˜ Mixins å’Œ CSS å®šä¹‰æ ·å¼éå¸¸ç±»ä¼¼ï¼Œå¯ä»¥å°† Mixins çœ‹æˆæ˜¯ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œå½“ç„¶ Mixins ä¹Ÿå¯ä»¥è®¾ç½®å‚æ•°ï¼Œå¹¶ç»™å‚æ•°è®¾ç½®é»˜è®¤å€¼ã€‚ä¸è¿‡è®¾ç½®å‚æ•°çš„å˜é‡åæ˜¯ä½¿ç”¨â€œ@â€å¼€å§‹ï¼ŒåŒæ ·å‚æ•°å’Œé»˜è®¤å‚æ•°å€¼ä¹‹é—´éœ€è¦ä½¿ç”¨å†’å·ï¼ˆï¼šï¼‰åˆ†å¼€ã€‚ stylusï¼šstylus å’Œå‰ä¸¤è€…ä¹Ÿç•¥æœ‰ä¸åŒï¼Œä»–å¯ä»¥ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ï¼Œå°±æ˜¯ç›´æ¥å®šä¹‰ Mixins åï¼Œç„¶ååœ¨å®šä¹‰å‚æ•°å’Œé»˜è®¤å€¼ä¹‹é—´ç”¨ç­‰å·ï¼ˆ=ï¼‰æ¥è¿æ¥ã€‚ æ³¨é‡Š ä¸¤ç§è¯­è¨€ç›¸åŒï¼šå¤šè¡Œæ³¨é‡Šæ ¼å¼å¯ä¿ç•™ï¼Œå•è¡Œæ³¨é‡Šæ ¼å¼ä¼šåœ¨ç¼–è¯‘æ—¶è¢«åˆ é™¤ã€‚ 12/* ä¼šè¢«ä¿ç•™çš„æ³¨é‡Šæ ¼å¼ */// ä¸ä¿å­˜çš„æ³¨é‡Šæ ¼å¼ é¢œè‰²è¿ç®—ï¼š CSS é¢„å¤„ç†å™¨æä¾›ä¸€ç³»åˆ—é¢œè‰²å‡½æ•°å¸®åŠ©ç”Ÿæˆä¸»é¢˜ç³»åˆ—é¢œè‰²ï¼šSassï¼š 1234lighten(#cc3, 10%) // #d6d65cdarken(#cc3, 10%) // #a3a329grayscale(#cc3) // #808080 ç°åº¦complement(#cc3) // #33c Lessï¼š 1234567891011121314lighten(@color, 10%); // return a color which is 10% *lighter* than @colordarken(@color, 10%); // return a color which is 10% *darker* than @colorsaturate(@color, 10%); // return a color 10% *more* saturated than @colordesaturate(@color, 10%); // return a color 10% *less* saturated than @colorfadein(@color, 10%); // return a color 10% *less* transparent than @colorfadeout(@color, 10%); // return a color 10% *more* transparent than @colorfade(@color, 50%); // return @color with 50% transparencyspin(@color, 10); // return a color with a 10 degree larger in hue than @colorspin(@color, -10); // return a color with a 10 degree smaller hue than @colormix(@color1, @color2); // return a mix of @color1 and @color2 stylusï¼š 1234lighten(color, 10%); /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šå˜äº®10% */darken(color, 10%); /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šå˜æš—10% */saturate(color, 10%); /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šé¥±å’Œåº¦å¢åŠ 10% */desaturate(color, 10%); /* è¿”å›çš„é¢œè‰²åœ¨'color'åŸºç¡€ä¸Šé¥±å’Œåº¦é™ä½10% */ æ’å…¥æ–‡ä»¶ ä¸¤ç§è¯­è¨€ç›¸åŒï¼Œä½¿ç”¨@import å…³é”®å­—å¼•å…¥ã€‚æ³¨æ„åç¼€åï¼Œå¯ä»¥ç›´æ¥å¯¼å…¥ css æ–‡ä»¶ã€‚åç¼€åä¸º css çš„æ–‡ä»¶ä¸ä¼šè¢«é¢„å¤„ç†å™¨å¤„ç†ã€‚ 1234@import \"path/filename.scss\";@import \"lib.less\";@import \"lib.css\"; ==é«˜çº§è¯­æ³•ï¼š== SASSåœ¨ Sass ä¸­ï¼Œéœ€è¦ç”¨ Sass è‡ªå·±çš„ä¸€å¥—è¯­è¨€ç¼–ç¨‹ï¼š æ¡ä»¶ if-else 12345@if lightness($color) &gt; 30% &#123; background-color: #000;&#125; @else &#123; background-color: #fff;&#125; å¾ªç¯ for: 12345@for $i from 1 to 10 &#123; .border-#&#123;$i&#125; &#123; border: #&#123;$i&#125;px solid blue; &#125;&#125; while: 1234567$i: 6;@while $i &gt; 0 &#123; .item-#&#123;$i&#125; &#123; width: 2em * $i; &#125; $i: $i - 2;&#125; each: 12345@each $member in a, b, c, d &#123; .#&#123;$member&#125; &#123; background-image: url(\"/image/#&#123;$member&#125;.jpg\"); &#125;&#125; è‡ªå®šä¹‰å‡½æ•° éœ€è¦@functionã€@returnå…³é”®å­—ã€‚ 1234567@function double($n) &#123; @return $n * 2;&#125;#sidebar &#123; width: double(5px);&#125; LessLess æ˜¯ä½¿ç”¨ JS ä½œä¸ºç¼–è¯‘ç¯å¢ƒçš„ï¼Œæ‰€ä»¥å®ƒæ”¯æŒ JS è¯­æ³•ã€‚ å­—ç¬¦ä¸²æ’å€¼ 12@base-url: \"http://assets.fnord.com\";background-image: url(\"@&#123;base-url&#125;/images/bg.png\"); ç”¨åå¼•å·ä½¿ç”¨ JS è¯­æ³•ï¼š 1@var: ` \"hello\" .toUpperCase() + \"!\" `; ç›´æ¥è®¿é—® JS ç¯å¢ƒ 1@height: `document.body.clientHeight`;","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"SASS","slug":"SASS","permalink":"http://yoursite.com/tags/SASS/"},{"name":"LESS","slug":"LESS","permalink":"http://yoursite.com/tags/LESS/"}]},{"title":"oh-my-zsh git å‘½ä»¤ç¼©å†™","slug":"oh-my-zsh git å‘½ä»¤ç¼©å†™","date":"2019-11-05T13:08:23.000Z","updated":"2019-11-10T14:37:39.026Z","comments":true,"path":"2019/11/05/oh-my-zsh git å‘½ä»¤ç¼©å†™/","link":"","permalink":"http://yoursite.com/2019/11/05/oh-my-zsh git å‘½ä»¤ç¼©å†™/","excerpt":"","text":"#oh-my-zsh git å‘½ä»¤ç¼©å†™ å–œæ¬¢ç”¨ git å‘½ä»¤è¡Œï¼Œå¹³æ—¶èƒ½å°‘æ‰“å‡ ä¸ªå­—è¿˜æ˜¯ä¼šèŠ‚çœä¸å°‘æ—¶é—´çš„ã€‚ å¸¸ç”¨123456789101112131415161718alias ga='git add'alias gb='git branch'alias gba='git branch -a'alias gbd='git branch -d'alias gcam='git commit -a -m'alias gcb='git checkout -b'alias gco='git checkout'alias gcp='git cherry-pick'alias gd='git diff'alias gfo='git fetch origin'alias ggpush='git push origin $(git_current_branch)'alias ggsup='git branch --set-upstream-to=origin/$(git_current_branch)'alias glgp='git log --stat -p'alias gm='git merge'alias gp='git push'alias gst='git status'alias gsta='git stash save'alias gstp='git stash pop' å…¨éƒ¨å‚è€ƒï¼šhttps://github.com/robbyrussell/oh-my-zsh/blob/master/plugins/git/git.plugin.zsh 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201alias g='git'alias ga='git add'alias gaa='git add --all'alias gapa='git add --patch'alias gau='git add --update'alias gb='git branch'alias gba='git branch -a'alias gbd='git branch -d'alias gbda='git branch --no-color --merged | command grep -vE \"^(\\*|\\s*(master|develop|dev)\\s*$)\" | command xargs -n 1 git branch -d'alias gbl='git blame -b -w'alias gbnm='git branch --no-merged'alias gbr='git branch --remote'alias gbs='git bisect'alias gbsb='git bisect bad'alias gbsg='git bisect good'alias gbsr='git bisect reset'alias gbss='git bisect start'alias gc='git commit -v'alias gc!='git commit -v --amend'alias gcn!='git commit -v --no-edit --amend'alias gca='git commit -v -a'alias gca!='git commit -v -a --amend'alias gcan!='git commit -v -a --no-edit --amend'alias gcans!='git commit -v -a -s --no-edit --amend'alias gcam='git commit -a -m'alias gcsm='git commit -s -m'alias gcb='git checkout -b'alias gcf='git config --list'alias gcl='git clone --recursive'alias gclean='git clean -fd'alias gpristine='git reset --hard &amp;&amp; git clean -dfx'alias gcm='git checkout master'alias gcd='git checkout develop'alias gcmsg='git commit -m'alias gco='git checkout'alias gcount='git shortlog -sn'compdef _git gcountalias gcp='git cherry-pick'alias gcpa='git cherry-pick --abort'alias gcpc='git cherry-pick --continue'alias gcs='git commit -S'alias gd='git diff'alias gdca='git diff --cached'alias gdct='git describe --tags `git rev-list --tags --max-count=1`'alias gdt='git diff-tree --no-commit-id --name-only -r'alias gdw='git diff --word-diff'gdv() &#123; git diff -w \"$@\" | view - &#125;compdef _git gdv=git-diffalias gf='git fetch'alias gfa='git fetch --all --prune'alias gfo='git fetch origin'function gfg() &#123; git ls-files | grep $@ &#125;compdef _grep gfgalias gg='git gui citool'alias gga='git gui citool --amend'ggf() &#123; [[ \"$#\" != 1 ]] &amp;&amp; local b=\"$(git_current_branch)\" git push --force origin \"$&#123;b:=$1&#125;\"&#125;compdef _git ggf=git-checkoutggl() &#123; if [[ \"$#\" != 0 ]] &amp;&amp; [[ \"$#\" != 1 ]]; then git pull origin \"$&#123;*&#125;\" else [[ \"$#\" == 0 ]] &amp;&amp; local b=\"$(git_current_branch)\" git pull origin \"$&#123;b:=$1&#125;\" fi&#125;compdef _git ggl=git-checkoutggp() &#123; if [[ \"$#\" != 0 ]] &amp;&amp; [[ \"$#\" != 1 ]]; then git push origin \"$&#123;*&#125;\" else [[ \"$#\" == 0 ]] &amp;&amp; local b=\"$(git_current_branch)\" git push origin \"$&#123;b:=$1&#125;\" fi&#125;compdef _git ggp=git-checkoutggpnp() &#123; if [[ \"$#\" == 0 ]]; then ggl &amp;&amp; ggp else ggl \"$&#123;*&#125;\" &amp;&amp; ggp \"$&#123;*&#125;\" fi&#125;compdef _git ggpnp=git-checkoutggu() &#123; [[ \"$#\" != 1 ]] &amp;&amp; local b=\"$(git_current_branch)\" git pull --rebase origin \"$&#123;b:=$1&#125;\"&#125;compdef _git ggu=git-checkoutalias ggpur='ggu'compdef _git ggpur=git-checkoutalias ggpull='git pull origin $(git_current_branch)'compdef _git ggpull=git-checkoutalias ggpush='git push origin $(git_current_branch)'compdef _git ggpush=git-checkoutalias ggsup='git branch --set-upstream-to=origin/$(git_current_branch)'alias gpsup='git push --set-upstream origin $(git_current_branch)'alias ghh='git help'alias gignore='git update-index --assume-unchanged'alias gignored='git ls-files -v | grep \"^[[:lower:]]\"'alias git-svn-dcommit-push='git svn dcommit &amp;&amp; git push github master:svntrunk'compdef _git git-svn-dcommit-push=gitalias gk='\\gitk --all --branches'compdef _git gk='gitk'alias gke='\\gitk --all $(git log -g --pretty=%h)'compdef _git gke='gitk'alias gl='git pull'alias glg='git log --stat'alias glgp='git log --stat -p'alias glgg='git log --graph'alias glgga='git log --graph --decorate --all'alias glgm='git log --graph --max-count=10'alias glo='git log --oneline --decorate'alias glol=\"git log --graph --pretty='%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit\"alias glola=\"git log --graph --pretty='%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit --all\"alias glog='git log --oneline --decorate --graph'alias gloga='git log --oneline --decorate --graph --all'alias glp=\"_git_log_prettily\"compdef _git glp=git-logalias gm='git merge'alias gmom='git merge origin/master'alias gmt='git mergetool --no-prompt'alias gmtvim='git mergetool --no-prompt --tool=vimdiff'alias gmum='git merge upstream/master'alias gp='git push'alias gpd='git push --dry-run'alias gpoat='git push origin --all &amp;&amp; git push origin --tags'compdef _git gpoat=git-pushalias gpu='git push upstream'alias gpv='git push -v'alias gr='git remote'alias gra='git remote add'alias grb='git rebase'alias grba='git rebase --abort'alias grbc='git rebase --continue'alias grbi='git rebase -i'alias grbm='git rebase master'alias grbs='git rebase --skip'alias grh='git reset HEAD'alias grhh='git reset HEAD --hard'alias grmv='git remote rename'alias grrm='git remote remove'alias grset='git remote set-url'alias grt='cd $(git rev-parse --show-toplevel || echo \".\")'alias gru='git reset --'alias grup='git remote update'alias grv='git remote -v'alias gsb='git status -sb'alias gsd='git svn dcommit'alias gsi='git submodule init'alias gsps='git show --pretty=short --show-signature'alias gsr='git svn rebase'alias gss='git status -s'alias gst='git status'alias gsta='git stash save'alias gstaa='git stash apply'alias gstc='git stash clear'alias gstd='git stash drop'alias gstl='git stash list'alias gstp='git stash pop'alias gsts='git stash show --text'alias gsu='git submodule update'alias gts='git tag -s'alias gtv='git tag | sort -V'alias gunignore='git update-index --no-assume-unchanged'alias gunwip='git log -n 1 | grep -q -c \"\\-\\-wip\\-\\-\" &amp;&amp; git reset HEAD~1'alias gup='git pull --rebase'alias gupv='git pull --rebase -v'alias glum='git pull upstream master'alias gwch='git whatchanged -p --abbrev-commit --pretty=medium'alias gwip='git add -A; git rm $(git ls-files --deleted) 2&gt; /dev/null; git commit --no-verify -m \"--wip-- [skip ci]\"'","categories":[{"name":"git","slug":"git","permalink":"http://yoursite.com/categories/git/"}],"tags":[{"name":"git","slug":"git","permalink":"http://yoursite.com/tags/git/"}]},{"title":"Object.prototype.toStringæ–¹æ³•çš„åŸç†","slug":"Object.prototype.toStringæ–¹æ³•çš„åŸç†","date":"2019-10-28T04:33:37.000Z","updated":"2019-11-10T14:37:39.020Z","comments":true,"path":"2019/10/28/Object.prototype.toStringæ–¹æ³•çš„åŸç†/","link":"","permalink":"http://yoursite.com/2019/10/28/Object.prototype.toStringæ–¹æ³•çš„åŸç†/","excerpt":"","text":"Object.prototype.toString æ–¹æ³•çš„åŸç†ECMAScript 3Object.prototype.toString æ–¹æ³•çš„è§„èŒƒåœ¨toStringæ–¹æ³•è¢«è°ƒç”¨æ—¶,ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œæ­¥éª¤: è·å– this å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼. è®¡ç®—å‡ºä¸‰ä¸ªå­—ç¬¦ä¸²â€œ[object â€œ,ç¬¬ä¸€æ­¥çš„æ“ä½œç»“æœ Result(1), ä»¥åŠ â€œ]â€è¿æ¥åçš„æ–°å­—ç¬¦ä¸². è¿”å›ç¬¬äºŒæ­¥çš„æ“ä½œç»“æœ Result(2). [[Class]][[Class]]æ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§,æ‰€æœ‰çš„å¯¹è±¡(åŸç”Ÿå¯¹è±¡å’Œå®¿ä¸»å¯¹è±¡)éƒ½æ‹¥æœ‰è¯¥å±æ€§.åœ¨è§„èŒƒä¸­,[[Class]]æ˜¯è¿™ä¹ˆå®šä¹‰çš„ å†…éƒ¨å±æ€§ æè¿° [[Class]] ä¸€ä¸ªå­—ç¬¦ä¸²å€¼,è¡¨æ˜äº†è¯¥å¯¹è±¡çš„ç±»å‹. ç„¶åç»™äº†ä¸€æ®µè§£é‡Š: æ‰€æœ‰å†…ç½®å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼æ˜¯ç”±æœ¬è§„èŒƒå®šä¹‰çš„.æ‰€æœ‰å®¿ä¸»å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»æ„å€¼,ç”šè‡³å¯ä»¥æ˜¯å†…ç½®å¯¹è±¡ä½¿ç”¨è¿‡çš„[[Class]]å±æ€§çš„å€¼.[[Class]]å±æ€§çš„å€¼å¯ä»¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªåŸç”Ÿå¯¹è±¡å±äºå“ªç§å†…ç½®ç±»å‹.éœ€è¦æ³¨æ„çš„æ˜¯,é™¤äº†é€šè¿‡Object.prototype.toStringæ–¹æ³•ä¹‹å¤–,æœ¬è§„èŒƒæ²¡æœ‰æä¾›ä»»ä½•å…¶ä»–æ–¹å¼æ¥è®©ç¨‹åºè®¿é—®è¯¥å±æ€§çš„å€¼ ä¹Ÿå°±æ˜¯è¯´,æŠŠ Object.prototype.toString æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²,å»æ‰å‰é¢å›ºå®šçš„â€œ[object â€œå’Œåé¢å›ºå®šçš„â€œ]â€,å°±æ˜¯å†…éƒ¨å±æ€§[[class]]çš„å€¼,ä¹Ÿå°±è¾¾åˆ°äº†åˆ¤æ–­å¯¹è±¡ç±»å‹çš„ç›®çš„ã€‚ [[Class]]çš„å€¼åœ¨ ES3 ä¸­,è§„èŒƒæ–‡æ¡£å¹¶æ²¡æœ‰æ€»ç»“å‡º[[class]]å†…éƒ¨å±æ€§ä¸€å…±æœ‰å‡ ç§,ä¸è¿‡æˆ‘ä»¬å¯ä»¥è‡ªå·±ç»Ÿè®¡ä¸€ä¸‹,åŸç”Ÿå¯¹è±¡çš„[[class]]å†…éƒ¨å±æ€§çš„å€¼ä¸€å…±æœ‰ 10 ç§.åˆ†åˆ«æ˜¯:&quot;Array&quot;, &quot;Boolean&quot;, &quot;Date&quot;, &quot;Error&quot;, &quot;Function&quot;, &quot;Math&quot;, &quot;Number&quot;, &quot;Object&quot;, &quot;RegExp&quot;, &quot;String&quot;. ECMAScript 5Object.prototype.toString æ–¹æ³•çš„è§„èŒƒåœ¨toStringæ–¹æ³•è¢«è°ƒç”¨æ—¶,ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œæ­¥éª¤: å¦‚æœthisçš„å€¼ä¸ºundefined,åˆ™è¿”å›&quot;[object Undefined]&quot;. å¦‚æœthisçš„å€¼ä¸ºnull,åˆ™è¿”å›&quot;[object Null]&quot;. è®©Oæˆä¸ºè°ƒç”¨ ToObject(this)çš„ç»“æœ. è®©classæˆä¸ºOçš„å†…éƒ¨å±æ€§[[Class]]çš„å€¼. è¿”å›ä¸‰ä¸ªå­—ç¬¦ä¸²â€œ[object â€œ, class, ä»¥åŠ â€œ]â€è¿æ¥åçš„æ–°å­—ç¬¦ä¸². å¯ä»¥çœ‹å‡º,ES5 æ¯” ES3 å¤šäº† 1,2,3 æ­¥.ç¬¬ 1,2 æ­¥å±äºæ–°è§„åˆ™,æ¯”è¾ƒç‰¹æ®Š,å› ä¸ºâ€Undefined&quot;å’Œâ€Null&quot;å¹¶ä¸å±äº[[class]]å±æ€§çš„å€¼,éœ€è¦æ³¨æ„çš„æ˜¯,è¿™é‡Œå’Œä¸¥æ ¼æ¨¡å¼æ— å…³(å¤§éƒ¨åˆ†å‡½æ•°åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹,this çš„å€¼æ‰ä¼šä¿æŒ undefined æˆ– null,éä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šè‡ªåŠ¨æˆä¸ºå…¨å±€å¯¹è±¡).ç¬¬ 3 æ­¥å¹¶ä¸ç®—æ˜¯æ–°è§„åˆ™,å› ä¸ºåœ¨ ES3 çš„å¼•æ“ä¸­,ä¹Ÿéƒ½ä¼šåœ¨è¿™ä¸€æ­¥å°†ä¸‰ç§åŸå§‹å€¼ç±»å‹è½¬æ¢æˆå¯¹åº”çš„åŒ…è£…å¯¹è±¡,åªæ˜¯è§„èŒƒä¸­æ²¡å†™å‡ºæ¥. [[Class]]ES5 ä¸­,[[Class]]å±æ€§çš„è§£é‡Šæ›´åŠ è¯¦ç»†: æ‰€æœ‰å†…ç½®å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼æ˜¯ç”±æœ¬è§„èŒƒå®šä¹‰çš„.æ‰€æœ‰å®¿ä¸»å¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼å¯ä»¥æ˜¯é™¤äº†â€Argumentsâ€, â€œArrayâ€, â€œBooleanâ€, â€œDateâ€, â€œErrorâ€, â€œFunctionâ€, â€œJSONâ€, â€œMathâ€, â€œNumberâ€, â€œObjectâ€, â€œRegExpâ€, â€œStringâ€ä¹‹å¤–çš„çš„ä»»ä½•å­—ç¬¦ä¸².[[Class]]å†…éƒ¨å±æ€§æ˜¯å¼•æ“å†…éƒ¨ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å±äºå“ªç§ç±»å‹çš„å€¼çš„.éœ€è¦æ³¨æ„çš„æ˜¯,é™¤äº†é€šè¿‡Object.prototype.toStringæ–¹æ³•ä¹‹å¤–,æœ¬è§„èŒƒæ²¡æœ‰æä¾›ä»»ä½•å…¶ä»–æ–¹å¼æ¥è®©ç¨‹åºè®¿é—®è¯¥å±æ€§çš„å€¼ å¯¹æ¯” ES3 ç¬¬ä¸€ä¸ªå·®åˆ«å°±æ˜¯[[class]]å†…éƒ¨å±æ€§çš„å€¼å¤šäº†ä¸¤ç§,æˆäº† 12 ç§ ä¸€ç§æ˜¯ arguments å¯¹è±¡çš„[[class]]æˆäº†â€Argumentsâ€,è€Œä¸æ˜¯ä»¥å‰çš„â€Objectâ€ å¤šä¸ªäº†å…¨å±€å¯¹è±¡ JSON,å®ƒçš„[[class]]å€¼ä¸ºâ€JSONâ€. ç¬¬äºŒä¸ªå·®åˆ«å°±æ˜¯,å®¿ä¸»å¯¹è±¡çš„[[class]]å†…éƒ¨å±æ€§çš„å€¼,ä¸èƒ½å’Œè¿™ 12 ç§å€¼å†²çªï¼ˆä¸è¿‡åœ¨æ”¯æŒ ES3 çš„æµè§ˆå™¨ä¸­,è²Œä¼¼ä¹Ÿæ²¡æœ‰å‘ç°å“ªäº›å®¿ä¸»å¯¹è±¡æ•…æ„ä½¿ç”¨é‚£ 10 ä¸ªå€¼ï¼‰ ECMAScript 6[[class]]å†…éƒ¨å±æ€§æ²¡æœ‰äº†,å–è€Œä»£ä¹‹çš„æ˜¯å¦å¤–ä¸€ä¸ªå†…éƒ¨å±æ€§[[NativeBrand]].[[NativeBrand]]å±æ€§æ˜¯è¿™ä¹ˆå®šä¹‰çš„: å†…éƒ¨å±æ€§ å±æ€§å€¼ æè¿° [[NativeBrand]] æšä¸¾ NativeBrand çš„ä¸€ä¸ªæˆå‘˜. è¯¥å±æ€§çš„å€¼å¯¹åº”ä¸€ä¸ªæ ‡å¿—å€¼(tag value),å¯ä»¥ç”¨æ¥åŒºåˆ†åŸç”Ÿå¯¹è±¡çš„ç±»å‹. [[NativeBrand]]å±æ€§ï¼ˆinternal slotï¼‰[[NativeBrand]]å†…éƒ¨å±æ€§ç”¨æ¥è¯†åˆ«æŸä¸ªåŸç”Ÿå¯¹è±¡æ˜¯å¦ä¸ºç¬¦åˆæœ¬è§„èŒƒçš„æŸä¸€ç§ç‰¹å®šç±»å‹çš„å¯¹è±¡.[[NativeBrand]]å†…éƒ¨å±æ€§çš„å€¼ä¸ºä¸‹é¢è¿™äº›æšä¸¾ç±»å‹çš„å€¼ä¸­çš„ä¸€ä¸ª:NativeFunction, NativeArray, StringWrapper, BooleanWrapper, NumberWrapper, NativeMath, NativeDate, NativeRegExp, NativeError, NativeJSON, NativeArguments, NativePrivateName.[[NativeBrand]]å†…éƒ¨å±æ€§ä»…ç”¨æ¥åŒºåˆ†åŒºåˆ†ç‰¹å®šç±»å‹çš„ ECMAScript åŸç”Ÿå¯¹è±¡.åªæœ‰åœ¨è¡¨ 10 ä¸­æ˜ç¡®æŒ‡å‡ºçš„å¯¹è±¡ç±»å‹æ‰æœ‰[[NativeBrand]]å†…éƒ¨å±æ€§. å±æ€§å€¼ å¯¹åº”ç±»å‹ NativeFunction Function objects NativeArray Array objects StringWrapper String objects BooleanWrapper Boolean objects NumberWrapper Number objects NativeMath The Math object NativeDate Date objects NativeRegExp RegExp objects NativeError Error objects NativeJSON The JSON object NativeArguments Arguments objects NativePrivateName Private Name objects å¯è§,å’Œ[[class]]ä¸åŒçš„æ˜¯,å¹¶ä¸æ˜¯æ¯ä¸ªå¯¹è±¡éƒ½æ‹¥æœ‰[[NativeBrand]]. Object.prototype.toString æ–¹æ³•çš„è§„èŒƒ:åœ¨toStringæ–¹æ³•è¢«è°ƒç”¨æ—¶,ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œæ­¥éª¤: å¦‚æœthisçš„å€¼ä¸ºundefined,åˆ™è¿”å›&quot;[object Undefined]&quot;. å¦‚æœthisçš„å€¼ä¸ºnull,åˆ™è¿”å›&quot;[object Null]&quot;. è®©Oæˆä¸ºè°ƒç”¨ ToObject(this)çš„ç»“æœ. å¦‚æœOæœ‰[[NativeBrand]]å†…éƒ¨å±æ€§,è®©tagæˆä¸ºè¡¨ 29 ä¸­å¯¹åº”çš„å€¼. å¦åˆ™ è®©hasTagæˆä¸ºè°ƒç”¨Oçš„[[HasProperty]]å†…éƒ¨æ–¹æ³•åçš„ç»“æœ,å‚æ•°ä¸º@@toStringTag. å¦‚æœhasTagä¸ºfalse,åˆ™è®©tagä¸º&quot;Object&quot;. å¦åˆ™, è®©tagæˆä¸ºè°ƒç”¨Oçš„[[Get]]å†…éƒ¨æ–¹æ³•åçš„ç»“æœ,å‚æ•°ä¸º@@toStringTag. å¦‚æœtagæ˜¯ä¸€ä¸ª abrupt completion,åˆ™è®©tagæˆä¸º NormalCompletion(&quot;???&quot;). è®©tagæˆä¸ºtag.[[value]]. å¦‚æœ Type(tag)ä¸æ˜¯å­—ç¬¦ä¸²,åˆ™è®©tag æˆä¸º&quot;???&quot;. å¦‚æœtagçš„å€¼ä¸º&quot;Arguments&quot;, &quot;Array&quot;, &quot;Boolean&quot;, &quot;Date&quot;, &quot;Error&quot;, &quot;Function&quot;, &quot;JSON&quot;, &quot;Math&quot;, &quot;Number&quot;, &quot;Object&quot;, &quot;RegExp&quot;,æˆ–è€…&quot;String&quot;ä¸­çš„ä»»ä¸€ä¸ª,åˆ™è®©tagæˆä¸ºå­—ç¬¦ä¸²&quot;~&quot;å’Œtagå½“å‰çš„å€¼è¿æ¥åçš„ç»“æœ. è¿”å›ä¸‰ä¸ªå­—ç¬¦ä¸²â€[object â€œ, tag, and â€œ]â€è¿æ¥åçš„æ–°å­—ç¬¦ä¸². ES6 é‡Œçš„æ–°ç±»å‹ Map,SetES6 é‡Œçš„æ–°ç±»å‹ Map,Set ç­‰,éƒ½æ²¡æœ‰åœ¨è¡¨ 29 ä¸­.å®ƒä»¬åœ¨æ‰§è¡Œ toString æ–¹æ³•çš„æ—¶å€™è¿”å›çš„æ˜¯ä»€ä¹ˆ? 12console.log(Object.prototype.toString.call(Map())); //\"[object Map]\"console.log(Object.prototype.toString.call(Set())); //\"[object Set]\" Map.prototype.@@toStringTag @@toStringTag å±æ€§çš„åˆå§‹å€¼ä¸ºå­—ç¬¦ä¸²â€œMapâ€.","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","date":"2019-10-21T03:15:12.000Z","updated":"2019-11-10T14:37:39.029Z","comments":true,"path":"2019/10/21/å‡½æ•°å¼ç¼–ç¨‹/","link":"","permalink":"http://yoursite.com/2019/10/21/å‡½æ•°å¼ç¼–ç¨‹/","excerpt":"","text":"å‡½æ•°å¼ç¼–ç¨‹ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹å®šä¹‰ï¼šå‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œä¸»è¦æ˜¯åˆ©ç”¨å‡½æ•°æŠŠè¿ç®—è¿‡ç¨‹å°è£…èµ·æ¥ï¼Œé€šè¿‡ç»„åˆå„ç§å‡½æ•°æ¥è®¡ç®—ç»“æœã€‚å‡½æ•°å¼ç¼–ç¨‹æ„å‘³ç€ä½ å¯ä»¥åœ¨æ›´çŸ­çš„æ—¶é—´å†…ç¼–å†™å…·æœ‰æ›´å°‘é”™è¯¯çš„ä»£ç ã€‚ ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦æŠŠå­—ç¬¦ä¸² functional programming is great å˜æˆæ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š 12345var string = \"functional programming is great\";var result = string .split(\" \") .map(v =&gt; v.slice(0, 1).toUpperCase() + v.slice(1)) .join(\" \"); ä¸Šé¢çš„ä¾‹å­å…ˆç”¨ split æŠŠå­—ç¬¦ä¸²è½¬æ¢æ•°ç»„ï¼Œç„¶åå†é€šè¿‡ map æŠŠå„å…ƒç´ çš„é¦–å­—æ¯è½¬æ¢æˆå¤§å†™ï¼Œæœ€åé€šè¿‡ join æŠŠæ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚ æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ join(map(split(str))),ä½“ç°äº†å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ï¼š é€šè¿‡å‡½æ•°å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ã€‚ ç‰¹ç‚¹ï¼šç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼Œå‡½æ•°å¼ç¼–ç¨‹æœ‰ä¸¤ä¸ªåŸºæœ¬ç‰¹ç‚¹ï¼š é€šè¿‡å‡½æ•°æ¥å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ é€šè¿‡ä¸²è”å¤šä¸ªå‡½æ•°æ¥æ±‚ç»“æœ å¯¹æ¯”å£°æ˜å¼ä¸å‘½ä»¤å¼ å‘½ä»¤å¼ï¼šæˆ‘ä»¬é€šè¿‡ç¼–å†™ä¸€æ¡åˆä¸€æ¡æŒ‡ä»¤å»è®©è®¡ç®—æœºæ‰§è¡Œä¸€äº›åŠ¨ä½œï¼Œè¿™å…¶ä¸­ä¸€èˆ¬éƒ½ä¼šæ¶‰åŠåˆ°å¾ˆå¤šç¹æ‚çš„ç»†èŠ‚ã€‚å‘½ä»¤å¼ä»£ç ä¸­é¢‘ç¹ä½¿ç”¨è¯­å¥,æ¥å®ŒæˆæŸä¸ªè¡Œä¸ºã€‚æ¯”å¦‚ forã€ifã€switchã€throw ç­‰è¿™äº›è¯­å¥ã€‚ å£°æ˜å¼ï¼šæˆ‘ä»¬é€šè¿‡å†™è¡¨è¾¾å¼çš„æ–¹å¼æ¥å£°æ˜æˆ‘ä»¬æƒ³å¹²ä»€ä¹ˆï¼Œè€Œä¸æ˜¯é€šè¿‡ä¸€æ­¥ä¸€æ­¥çš„æŒ‡ç¤ºã€‚è¡¨è¾¾å¼é€šå¸¸æ˜¯æŸäº›å‡½æ•°è°ƒç”¨çš„å¤åˆã€ä¸€äº›å€¼å’Œæ“ä½œç¬¦ï¼Œç”¨æ¥è®¡ç®—å‡ºç»“æœå€¼ã€‚ 12345678//å‘½ä»¤å¼var CEOs = [];for (var i = 0; i &lt; companies.length; i++) &#123; CEOs.push(companies[i].CEO);&#125;//å£°æ˜å¼var CEOs = companies.map(c =&gt; c.CEO); ä»ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å£°æ˜å¼çš„å†™æ³•æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ— éœ€å…³å¿ƒå¦‚ä½•è¿›è¡Œè®¡æ•°å™¨è¿­ä»£ï¼Œè¿”å›çš„æ•°ç»„å¦‚ä½•æ”¶é›†ï¼Œå®ƒæŒ‡æ˜çš„æ˜¯åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ€ä¹ˆåšã€‚å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªæ˜æ˜¾çš„å¥½å¤„å°±æ˜¯è¿™ç§å£°æ˜å¼çš„ä»£ç ï¼Œå¯¹äºæ— å‰¯ä½œç”¨çš„çº¯å‡½æ•°ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸è€ƒè™‘å‡½æ•°å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä¸“æ³¨äºç¼–å†™ä¸šåŠ¡ä»£ç ã€‚ å¸¸è§ç‰¹æ€§æ— å‰¯ä½œç”¨æŒ‡è°ƒç”¨å‡½æ•°æ—¶ä¸ä¼šä¿®æ”¹å¤–éƒ¨çŠ¶æ€ï¼Œå³ä¸€ä¸ªå‡½æ•°è°ƒç”¨ n æ¬¡åä¾ç„¶è¿”å›åŒæ ·çš„ç»“æœã€‚ 12345678910111213var a = 1;// å«æœ‰å‰¯ä½œç”¨ï¼Œå®ƒä¿®æ”¹äº†å¤–éƒ¨å˜é‡ a// å¤šæ¬¡è°ƒç”¨ç»“æœä¸ä¸€æ ·function test1() &#123; a++; return a;&#125;// æ— å‰¯ä½œç”¨ï¼Œæ²¡æœ‰ä¿®æ”¹å¤–éƒ¨çŠ¶æ€// å¤šæ¬¡è°ƒç”¨ç»“æœä¸€æ ·function test2(a) &#123; return a + 1;&#125; é€æ˜å¼•ç”¨æŒ‡ä¸€ä¸ªå‡½æ•°åªä¼šç”¨åˆ°ä¼ é€’ç»™å®ƒçš„å˜é‡ä»¥åŠè‡ªå·±å†…éƒ¨åˆ›å»ºçš„å˜é‡ï¼Œä¸ä¼šä½¿ç”¨åˆ°å…¶ä»–å˜é‡ã€‚ 12345678910var a = 1;var b = 2;// å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„å˜é‡å¹¶ä¸å±äºå®ƒçš„ä½œç”¨åŸŸfunction test1() &#123; return a + b;&#125;// å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„å˜é‡æ˜¯æ˜¾å¼ä¼ é€’è¿›å»çš„function test2(a, b) &#123; return a + b;&#125; ä¸å¯å˜å˜é‡æŒ‡çš„æ˜¯ä¸€ä¸ªå˜é‡ä¸€æ—¦åˆ›å»ºåï¼Œå°±ä¸èƒ½å†è¿›è¡Œä¿®æ”¹ï¼Œä»»ä½•ä¿®æ”¹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å˜é‡ã€‚ä½¿ç”¨ä¸å¯å˜å˜é‡æœ€å¤§çš„å¥½å¤„æ˜¯çº¿ç¨‹å®‰å…¨ã€‚å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®åŒä¸€ä¸ªä¸å¯å˜å˜é‡ï¼Œè®©å¹¶è¡Œå˜å¾—æ›´å®¹æ˜“å®ç°ã€‚ ç”±äº JavaScript åŸç”Ÿä¸æ”¯æŒä¸å¯å˜å˜é‡ï¼Œéœ€è¦é€šè¿‡ç¬¬ä¸‰æ–¹åº“æ¥å®ç°ã€‚ (å¦‚ Immutable.jsï¼ŒMori ç­‰ç­‰) 1234var obj = Immutable(&#123; a: 1 &#125;);var obj2 = obj.set(\"a\", 2);console.log(obj); // Immutable(&#123; a: 1 &#125;)console.log(obj2); // Immutable(&#123; a: 2 &#125;) å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘æˆ‘ä»¬å¸¸è¯´å‡½æ•°æ˜¯ JavaScript çš„â€ç¬¬ä¸€ç­‰å…¬æ°‘â€ï¼ŒæŒ‡çš„æ˜¯å‡½æ•°ä¸å…¶ä»–æ•°æ®ç±»å‹ä¸€æ ·ï¼Œå¤„äºå¹³ç­‰åœ°ä½ï¼Œå¯ä»¥èµ‹å€¼ç»™å…¶ä»–å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…ä½œä¸ºåˆ«çš„å‡½æ•°çš„è¿”å›å€¼ã€‚ä¸‹æ–‡å°†è¦ä»‹ç»çš„é—­åŒ…ã€é«˜é˜¶å‡½æ•°ã€å‡½æ•°æŸ¯é‡ŒåŒ–å’Œå‡½æ•°ç»„åˆéƒ½æ˜¯å›´ç»•è¿™ä¸€ç‰¹æ€§çš„åº”ç”¨ å¸¸è§çš„å‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹1.é—­åŒ…ï¼ˆClosureï¼‰å¦‚æœä¸€ä¸ªå‡½æ•°å¼•ç”¨äº†è‡ªç”±å˜é‡ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚ä½•è°“è‡ªç”±å˜é‡ï¼Ÿè‡ªç”±å˜é‡æ˜¯æŒ‡ä¸å±äºè¯¥å‡½æ•°ä½œç”¨åŸŸçš„å˜é‡(æ‰€æœ‰å…¨å±€å˜é‡éƒ½æ˜¯è‡ªç”±å˜é‡ï¼Œä¸¥æ ¼æ¥è¯´å¼•ç”¨äº†å…¨å±€å˜é‡çš„å‡½æ•°éƒ½æ˜¯é—­åŒ…ï¼Œä½†è¿™ç§é—­åŒ…å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬è¯´çš„é—­åŒ…æ˜¯æŒ‡å‡½æ•°å†…éƒ¨çš„å‡½æ•°)ã€‚ é—­åŒ…çš„å½¢æˆæ¡ä»¶ï¼š å­˜åœ¨å†…ã€å¤–ä¸¤å±‚å‡½æ•° å†…å±‚å‡½æ•°å¯¹å¤–å±‚å‡½æ•°çš„å±€éƒ¨å˜é‡è¿›è¡Œäº†å¼•ç”¨ é—­åŒ…çš„ç”¨é€”:å¯ä»¥å®šä¹‰ä¸€äº›ä½œç”¨åŸŸå±€é™çš„æŒä¹…åŒ–å˜é‡ï¼Œè¿™äº›å˜é‡å¯ä»¥ç”¨æ¥åšç¼“å­˜æˆ–è€…è®¡ç®—çš„ä¸­é—´é‡ç­‰ã€‚ 1234567891011121314151617// ç®€å•çš„ç¼“å­˜å·¥å…·// åŒ¿åå‡½æ•°åˆ›é€ äº†ä¸€ä¸ªé—­åŒ…const cache = (function() &#123; const store = &#123;&#125;; return &#123; get(key) &#123; return store[key]; &#125;, set(key, val) &#123; store[key] = val; &#125; &#125;;&#125;)();console.log(cache); //&#123;get: Æ’, set: Æ’&#125;cache.set(\"a\", 1);cache.get(\"a\"); // 1 ä¸Šé¢ä¾‹å­æ˜¯ä¸€ä¸ªç®€å•çš„ç¼“å­˜å·¥å…·çš„å®ç°ï¼ŒåŒ¿åå‡½æ•°åˆ›é€ äº†ä¸€ä¸ªé—­åŒ…ï¼Œä½¿å¾— store å¯¹è±¡ ï¼Œä¸€ç›´å¯ä»¥è¢«å¼•ç”¨ï¼Œä¸ä¼šè¢«å›æ”¶ã€‚ é—­åŒ…çš„å¼Šç«¯:æŒä¹…åŒ–å˜é‡ä¸ä¼šè¢«æ­£å¸¸é‡Šæ”¾ï¼ŒæŒç»­å ç”¨å†…å­˜ç©ºé—´ï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æµªè´¹ï¼Œæ‰€ä»¥ä¸€èˆ¬éœ€è¦ä¸€äº›é¢å¤–æ‰‹åŠ¨çš„æ¸…ç†æœºåˆ¶ã€‚ 2.é«˜é˜¶å‡½æ•°å‡½æ•°å¼ç¼–ç¨‹å€¾å‘äºå¤ç”¨ä¸€ç»„é€šç”¨çš„å‡½æ•°åŠŸèƒ½æ¥å¤„ç†æ•°æ®ï¼Œå®ƒé€šè¿‡ä½¿ç”¨é«˜é˜¶å‡½æ•°æ¥å®ç°ã€‚é«˜é˜¶å‡½æ•°æŒ‡çš„æ˜¯ä¸€ä¸ªå‡½æ•°ä»¥å‡½æ•°ä¸ºå‚æ•°ï¼Œæˆ–ä»¥å‡½æ•°ä¸ºè¿”å›å€¼ï¼Œæˆ–è€…æ—¢ä»¥å‡½æ•°ä¸ºå‚æ•°åˆä»¥å‡½æ•°ä¸ºè¿”å›å€¼ã€‚ é«˜é˜¶å‡½æ•°ç»å¸¸ç”¨äºï¼š æŠ½è±¡æˆ–éš”ç¦»è¡Œä¸ºã€ä½œç”¨ï¼Œå¼‚æ­¥æ§åˆ¶æµç¨‹ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œpromisesï¼Œmonads ç­‰ åˆ›å»ºå¯ä»¥æ³›ç”¨äºå„ç§æ•°æ®ç±»å‹çš„åŠŸèƒ½ éƒ¨åˆ†åº”ç”¨äºå‡½æ•°å‚æ•°ï¼ˆåå‡½æ•°åº”ç”¨ï¼‰æˆ–åˆ›å»ºä¸€ä¸ªæŸ¯é‡ŒåŒ–çš„å‡½æ•°ï¼Œç”¨äºå¤ç”¨æˆ–å‡½æ•°å¤åˆã€‚ æ¥å—ä¸€ä¸ªå‡½æ•°åˆ—è¡¨å¹¶è¿”å›ä¸€äº›ç”±è¿™ä¸ªåˆ—è¡¨ä¸­çš„å‡½æ•°ç»„æˆçš„å¤åˆå‡½æ•°ã€‚ JavaScript è¯­è¨€æ˜¯åŸç”Ÿæ”¯æŒé«˜é˜¶å‡½æ•°çš„, ä¾‹å¦‚ Array.prototype.mapï¼ŒArray.prototype.filter å’Œ Array.prototype.reduce æ˜¯ JavaScript ä¸­å†…ç½®çš„ä¸€äº›é«˜é˜¶å‡½æ•°ï¼Œä½¿ç”¨é«˜é˜¶å‡½æ•°ä¼šè®©æˆ‘ä»¬çš„ä»£ç æ›´æ¸…æ™°ç®€æ´ã€‚ mapmap() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ä¸€ä¸ªæä¾›çš„å‡½æ•°åè¿”å›çš„ç»“æœã€‚map ä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«åç§°å’Œç§ç±»å±æ€§çš„å¯¹è±¡æ•°ç»„ï¼Œæˆ‘ä»¬æƒ³è¦è¿™ä¸ªæ•°ç»„ä¸­æ‰€æœ‰åç§°å±æ€§æ”¾åœ¨ä¸€ä¸ªæ–°æ•°ç»„ä¸­ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ 12345678910111213141516171819202122232425// ä¸ä½¿ç”¨é«˜é˜¶å‡½æ•°var animals = [ &#123; name: \"Fluffykins\", species: \"rabbit\" &#125;, &#123; name: \"Caro\", species: \"dog\" &#125;, &#123; name: \"Hamilton\", species: \"dog\" &#125;, &#123; name: \"Harold\", species: \"fish\" &#125;, &#123; name: \"Ursula\", species: \"cat\" &#125;, &#123; name: \"Jimmy\", species: \"fish\" &#125;];var names = [];for (let i = 0; i &lt; animals.length; i++) &#123; names.push(animals[i].name);&#125;console.log(names); //[\"Fluffykins\", \"Caro\", \"Hamilton\", \"Harold\", \"Ursula\", \"Jimmy\"]// ä½¿ç”¨é«˜é˜¶å‡½æ•°var animals = [ &#123; name: \"Fluffykins\", species: \"rabbit\" &#125;, &#123; name: \"Caro\", species: \"dog\" &#125;, &#123; name: \"Hamilton\", species: \"dog\" &#125;, &#123; name: \"Harold\", species: \"fish\" &#125;, &#123; name: \"Ursula\", species: \"cat\" &#125;, &#123; name: \"Jimmy\", species: \"fish\" &#125;];var names = animals.map(x =&gt; x.name);console.log(names); //[\"Fluffykins\", \"Caro\", \"Hamilton\", \"Harold\", \"Ursula\", \"Jimmy\"] filterfilter() æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰é€šè¿‡å›è°ƒå‡½æ•°æµ‹è¯•çš„å…ƒç´ ã€‚filter ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ callback å‡½æ•°ï¼Œ callback å‡½æ•°è¿”å› true è¡¨ç¤ºè¯¥å…ƒç´ é€šè¿‡æµ‹è¯•ï¼Œä¿ç•™è¯¥å…ƒç´ ï¼Œfalse åˆ™ä¸ä¿ç•™ã€‚filter ä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼Œå®ƒè¿”å›è¿‡æ»¤åçš„æ–°æ•°ç»„ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«åç§°å’Œç§ç±»å±æ€§çš„å¯¹è±¡æ•°ç»„ã€‚ æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªåªåŒ…å«ç‹—ï¼ˆspecies: â€œdogâ€ï¼‰çš„æ•°ç»„ã€‚å¦‚ä½•å®ç°å‘¢ï¼Ÿ 1234567891011121314151617181920212223242526// ä¸ä½¿ç”¨é«˜é˜¶å‡½æ•°var animals = [ &#123; name: \"Fluffykins\", species: \"rabbit\" &#125;, &#123; name: \"Caro\", species: \"dog\" &#125;, &#123; name: \"Hamilton\", species: \"dog\" &#125;, &#123; name: \"Harold\", species: \"fish\" &#125;, &#123; name: \"Ursula\", species: \"cat\" &#125;, &#123; name: \"Jimmy\", species: \"fish\" &#125;];var dogs = [];for (var i = 0; i &lt; animals.length; i++) &#123; if (animals[i].species === \"dog\") dogs.push(animals[i]);&#125;console.log(dogs);// ä½¿ç”¨é«˜é˜¶å‡½æ•°var animals = [ &#123; name: \"Fluffykins\", species: \"rabbit\" &#125;, &#123; name: \"Caro\", species: \"dog\" &#125;, &#123; name: \"Hamilton\", species: \"dog\" &#125;, &#123; name: \"Harold\", species: \"fish\" &#125;, &#123; name: \"Ursula\", species: \"cat\" &#125;, &#123; name: \"Jimmy\", species: \"fish\" &#125;];var dogs = animals.filter(x =&gt; x.species === \"dog\");console.log(dogs); // &#123;name: \"Caro\", species: \"dog\"&#125;// &#123; name: \"Hamilton\", species: \"dog\" &#125; reducereduce æ–¹æ³•å¯¹è°ƒç”¨æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œæœ€åç”Ÿæˆä¸€ä¸ªå•ä¸€çš„å€¼å¹¶è¿”å›ã€‚ reduce æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š1ï¼‰reducer å‡½æ•°ï¼ˆå›è°ƒï¼‰ï¼Œ2ï¼‰ä¸€ä¸ªå¯é€‰çš„ initialValueã€‚ å‡è®¾æˆ‘ä»¬è¦å¯¹ä¸€ä¸ªæ•°ç»„çš„æ±‚å’Œï¼š 1234567891011121314// ä¸ä½¿ç”¨é«˜é˜¶å‡½æ•°const arr = [5, 7, 1, 8, 4];let sum = 0;for (let i = 0; i &lt; arr.length; i++) &#123; sum = sum + arr[i];&#125;console.log(sum); //25// ä½¿ç”¨é«˜é˜¶å‡½æ•°const arr = [5, 7, 1, 8, 4];const sum = arr.reduce( (accumulator, currentValue) =&gt; accumulator + currentValue, 0);console.log(sum); //25 æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹å›¾ï¼Œå½¢è±¡ç”ŸåŠ¨å±•ç¤ºä¸‰è€…çš„åŒºåˆ«ï¼š 3.å‡½æ•°æŸ¯é‡ŒåŒ–æŸ¯é‡ŒåŒ–åˆç§°éƒ¨åˆ†æ±‚å€¼ï¼ŒæŸ¯é‡ŒåŒ–å‡½æ•°ä¼šæ¥æ”¶ä¸€äº›å‚æ•°ï¼Œç„¶åä¸ä¼šç«‹å³æ±‚å€¼ï¼Œè€Œæ˜¯ç»§ç»­è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå°†ä¼ å…¥çš„å‚æ•°é€šè¿‡é—­åŒ…çš„å½¢å¼ä¿å­˜ï¼Œç­‰åˆ°è¢«çœŸæ­£æ±‚å€¼çš„æ—¶å€™ï¼Œå†ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ±‚å€¼ã€‚ 12345678910111213// æ™®é€šå‡½æ•°function add(x, y) &#123; return x + y;&#125;add(1, 2); // 3// å‡½æ•°æŸ¯é‡ŒåŒ–var add = function(x) &#123; return function(y) &#123; return x + y; &#125;;&#125;;var increment = add(1);increment(2); // 3 è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª add å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚è°ƒç”¨ add ä¹‹åï¼Œè¿”å›çš„å‡½æ•°å°±é€šè¿‡é—­åŒ…çš„æ–¹å¼è®°ä½äº† add çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•æ¥å®ç°ä¸€ä¸ªç®€æ˜“çš„æŸ¯é‡ŒåŒ–å‡½æ•°å‘¢ï¼Ÿ 123456789101112131415161718192021function curryIt(fn) &#123; // å‚æ•°fnå‡½æ•°çš„å‚æ•°ä¸ªæ•° var n = fn.length; var args = []; return function(arg) &#123; args.push(arg); if (args.length &lt; n) &#123; return arguments.callee; // è¿”å›è¿™ä¸ªå‡½æ•°çš„å¼•ç”¨ &#125; else &#123; return fn.apply(this, args); &#125; &#125;;&#125;function add(a, b, c) &#123; return [a, b, c];&#125;var c = curryIt(add);var c1 = c(1);var c2 = c1(2);var c3 = c2(3);console.log(c3); //[1, 2, 3] ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒæŸ¯é‡ŒåŒ–æ˜¯ä¸€ç§â€œé¢„åŠ è½½â€å‡½æ•°çš„æ–¹æ³•ï¼Œé€šè¿‡ä¼ é€’è¾ƒå°‘çš„å‚æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªå·²ç»è®°ä½äº†è¿™äº›å‚æ•°çš„æ–°å‡½æ•°ï¼ŒæŸç§æ„ä¹‰ä¸Šè®²ï¼Œè¿™æ˜¯ä¸€ç§å¯¹å‚æ•°çš„â€œç¼“å­˜â€ï¼Œæ˜¯ä¸€ç§éå¸¸é«˜æ•ˆçš„ç¼–å†™å‡½æ•°çš„æ–¹æ³•ï¼ 4.å‡½æ•°ç»„åˆ (Composition)å‰é¢æåˆ°è¿‡ï¼Œå‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯é€šè¿‡ä¸²è”å‡½æ•°æ¥æ±‚å€¼ã€‚ç„¶è€Œï¼Œéšç€ä¸²è”å‡½æ•°æ•°é‡çš„å¢å¤šï¼Œä»£ç çš„å¯è¯»æ€§å°±ä¼šä¸æ–­ä¸‹é™ã€‚å‡½æ•°ç»„åˆå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚å‡è®¾æœ‰ä¸€ä¸ª compose å‡½æ•°ï¼Œå®ƒå¯ä»¥æ¥å—å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚å½“æˆ‘ä»¬ä¸ºè¿™ä¸ªæ–°å‡½æ•°ä¼ é€’å‚æ•°æ—¶ï¼Œè¯¥å‚æ•°å°±ä¼šã€Œæµã€è¿‡å…¶ä¸­çš„å‡½æ•°ï¼Œæœ€åè¿”å›ç»“æœã€‚ 123456789101112131415//ä¸¤ä¸ªå‡½æ•°çš„ç»„åˆvar compose = function(f, g) &#123; return function(x) &#123; return f(g(x)); &#125;;&#125;;//æˆ–è€…var compose = (f, g) =&gt; x =&gt; f(g(x));var add1 = x =&gt; x + 1;var mul5 = x =&gt; x * 5;compose( mul5, add1)(2); // =&gt;15","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"IP","slug":"IP","date":"2019-10-13T07:41:22.000Z","updated":"2019-11-10T14:37:39.018Z","comments":true,"path":"2019/10/13/IP/","link":"","permalink":"http://yoursite.com/2019/10/13/IP/","excerpt":"","text":"IPIPï¼ˆIPv4ã€IPv6ï¼‰ç›¸å½“äº OSI å‚è€ƒæ¨¡å‹ä¸­çš„ç¬¬ 3 å±‚â€”â€”ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚çš„ä¸»è¦ä½œç”¨æ˜¯â€œå®ç°ç»ˆç«¯èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡â€ã€‚è¿™ç§ç»ˆç«¯èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡ä¹Ÿå«â€œç‚¹å¯¹ç‚¹é€šä¿¡â€ã€‚ ç½‘ç»œçš„ä¸‹ä¸€å±‚â€”â€”æ•°æ®é“¾è·¯å±‚çš„ä¸»è¦ä½œç”¨æ˜¯åœ¨äº’è¿åŒä¸€ç§æ•°æ®é“¾è·¯çš„èŠ‚ç‚¹ä¹‹é—´è¿›è¡ŒåŒ…ä¼ é€’ã€‚è€Œä¸€æ—¦è·¨è¶Šå¤šç§æ•°æ®é“¾è·¯ï¼Œå°±éœ€è¦å€ŸåŠ©ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚å¯ä»¥è·¨è¶Šä¸åŒçš„æ•°æ®é“¾è·¯ï¼Œå³ä½¿æ˜¯åœ¨ä¸åŒçš„æ•°æ®é“¾è·¯ä¸Šä¹Ÿèƒ½å®ç°ä¸¤ç«¯èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®åŒ…ä¼ è¾“ã€‚ IP å¤§è‡´åˆ†ä¸ºä¸‰å¤§ä½œç”¨æ¨¡å—ï¼Œå®ƒä»¬æ˜¯ IP å¯»å€ã€è·¯ç”±ï¼ˆæœ€ç»ˆèŠ‚ç‚¹ä¸ºæ­¢çš„è½¬å‘ï¼‰ä»¥åŠ IP åˆ†åŒ…ä¸ç»„åŒ…ã€‚ TCP/IP åŸºç¡€äº’è”ç½‘è¿›è¡Œé€šä¿¡æ—¶ï¼Œéœ€è¦ç›¸åº”çš„ç½‘ç»œåè®®ï¼ŒTCP/IP åŸæœ¬å°±æ˜¯ä¸ºä½¿ç”¨äº’è”ç½‘è€Œå¼€å‘åˆ¶å®šçš„åè®®æ—ã€‚å› æ­¤ï¼Œäº’è”ç½‘çš„åè®®å°±æ˜¯ TCP/IPï¼ŒTCP/IP å°±æ˜¯äº’è”ç½‘çš„åè®®ã€‚ æ¯ä¸ªåˆ†å±‚ä¸­ï¼Œéƒ½ä¼šå¯¹æ‰€å‘é€çš„æ•°æ®é™„åŠ ä¸€ä¸ªé¦–éƒ¨ï¼Œåœ¨è¿™ä¸ªé¦–éƒ¨ä¸­åŒ…å«äº†è¯¥å±‚å¿…è¦çš„ä¿¡æ¯ï¼Œå¦‚å‘é€çš„ç›®æ ‡åœ°å€ä»¥åŠåè®®ç›¸å…³ä¿¡æ¯ã€‚é€šå¸¸ï¼Œä¸ºåè®®æä¾›çš„ä¿¡æ¯ä¸ºåŒ…é¦–éƒ¨ï¼Œæ‰€è¦å‘é€çš„å†…å®¹ä¸ºæ•°æ®ã€‚åœ¨ä¸‹ä¸€å±‚çš„è§’åº¦çœ‹ï¼Œä»ä¸Šä¸€å±‚æ”¶åˆ°çš„åŒ…å…¨éƒ¨éƒ½è¢«è®¤ä¸ºæ˜¯æœ¬å±‚çš„æ•°æ®ã€‚ ç½‘ç»œä¸­ä¼ è¾“çš„æ•°æ®åŒ…ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€éƒ¨åˆ†æ˜¯åè®®æ‰€è¦ç”¨åˆ°çš„é¦–éƒ¨ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ä¸Šä¸€å±‚ä¼ è¿‡æ¥çš„æ•°æ®ã€‚é¦–éƒ¨çš„ç»“æ„ç”±åè®®çš„å…·ä½“è§„èŒƒè¯¦ç»†å®šä¹‰ã€‚åœ¨æ•°æ®åŒ…çš„é¦–éƒ¨ï¼Œæ˜ç¡®æ ‡æ˜äº†åè®®åº”è¯¥å¦‚ä½•è¯»å–æ•°æ®ã€‚åè¿‡æ¥è¯´ï¼Œçœ‹åˆ°é¦–éƒ¨ï¼Œä¹Ÿå°±èƒ½å¤Ÿäº†è§£è¯¥åè®®å¿…è¦çš„ä¿¡æ¯ä»¥åŠæ‰€è¦å¤„ç†çš„æ•°æ®ã€‚åŒ…é¦–éƒ¨å°±åƒåè®®çš„è„¸ã€‚ æ•°æ®å¤„ç†æµç¨‹ åº”ç”¨ç¨‹åºå¤„ç†é¦–å…ˆåº”ç”¨ç¨‹åºä¼šè¿›è¡Œç¼–ç å¤„ç†ï¼Œè¿™äº›ç¼–ç ç›¸å½“äº OSI çš„è¡¨ç¤ºå±‚åŠŸèƒ½ï¼›ç¼–ç è½¬åŒ–åï¼Œé‚®ä»¶ä¸ä¸€å®šé©¬ä¸Šè¢«å‘é€å‡ºå»ï¼Œè¿™ç§ä½•æ—¶å»ºç«‹é€šä¿¡è¿æ¥ä½•æ—¶å‘é€æ•°æ®çš„ç®¡ç†åŠŸèƒ½ï¼Œç›¸å½“äº OSI çš„ä¼šè¯å±‚åŠŸèƒ½ã€‚ TCP æ¨¡å—çš„å¤„ç†TCP æ ¹æ®åº”ç”¨çš„æŒ‡ç¤ºï¼Œè´Ÿè´£å»ºç«‹è¿æ¥ã€å‘é€æ•°æ®ä»¥åŠæ–­å¼€è¿æ¥ã€‚TCP æä¾›å°†åº”ç”¨å±‚å‘æ¥çš„æ•°æ®é¡ºåˆ©å‘é€è‡³å¯¹ç«¯çš„å¯é ä¼ è¾“ã€‚ä¸ºäº†å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œéœ€è¦åœ¨åº”ç”¨å±‚æ•°æ®çš„å‰ç«¯é™„åŠ ä¸€ä¸ª TCP é¦–éƒ¨ã€‚ IP æ¨¡å—çš„å¤„ç†IP å°† TCP ä¼ è¿‡æ¥çš„ TCP é¦–éƒ¨å’Œ TCP æ•°æ®åˆèµ·æ¥å½“åšè‡ªå·±çš„æ•°æ®ï¼Œå¹¶åœ¨ TCP é¦–éƒ¨çš„å‰ç«¯åŠ ä¸Šè‡ªå·±çš„ IP é¦–éƒ¨ã€‚IP åŒ…ç”Ÿæˆåï¼Œå‚è€ƒè·¯ç”±æ§åˆ¶è¡¨å†³å®šæ¥å—æ­¤ IP åŒ…çš„è·¯ç”±æˆ–ä¸»æœºã€‚ ç½‘ç»œæ¥å£ï¼ˆä»¥å¤ªç½‘é©±åŠ¨ï¼‰çš„å¤„ç†ä» IP ä¼ è¿‡æ¥çš„ IP åŒ…å¯¹äºä»¥å¤ªç½‘æ¥è¯´å°±æ˜¯æ•°æ®ã€‚ç»™è¿™äº›æ•°æ®é™„åŠ ä¸Šä»¥å¤ªç½‘é¦–éƒ¨å¹¶è¿›è¡Œå‘é€å¤„ç†ï¼Œç”Ÿæˆçš„ä»¥å¤ªç½‘æ•°æ®åŒ…å°†é€šè¿‡ç‰©ç†å±‚ä¼ è¾“ç»™æ¥æ”¶ç«¯ã€‚ ç½‘ç»œæ¥å£ï¼ˆä»¥å¤ªç½‘é©±åŠ¨ï¼‰çš„å¤„ç†ä¸»æœºæ”¶åˆ°ä»¥å¤ªç½‘åŒ…åï¼Œé¦–å…ˆä»ä»¥å¤ªç½‘åŒ…é¦–éƒ¨æ‰¾åˆ° MAC åœ°å€åˆ¤æ–­æ˜¯å¦ä¸ºå‘é€ç»™è‡ªå·±çš„åŒ…ï¼Œè‹¥ä¸æ˜¯åˆ™ä¸¢å¼ƒæ•°æ®ã€‚å¦‚æœæ˜¯å‘é€ç»™è‡ªå·±çš„åŒ…ï¼Œåˆ™ä»ä»¥å¤ªç½‘åŒ…é¦–éƒ¨ä¸­çš„ç±»å‹ç¡®å®šæ•°æ®ç±»å‹ï¼Œå†ä¼ ç»™ç›¸åº”çš„æ¨¡å—ï¼Œå¦‚ IPã€ARP ç­‰ã€‚è¿™é‡Œçš„ä¾‹å­åˆ™æ˜¯ IP ã€‚ IP æ¨¡å—çš„å¤„ç†IP æ¨¡å—æ¥æ”¶åˆ° æ•°æ®åä¹Ÿåšç±»ä¼¼çš„å¤„ç†ã€‚ä»åŒ…é¦–éƒ¨ä¸­åˆ¤æ–­æ­¤ IP åœ°å€æ˜¯å¦ä¸è‡ªå·±çš„ IP åœ°å€åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ™æ ¹æ®é¦–éƒ¨çš„åè®®ç±»å‹å°†æ•°æ®å‘é€ç»™å¯¹åº”çš„æ¨¡å—ï¼Œå¦‚ TCPã€UDPã€‚è¿™é‡Œçš„ä¾‹å­åˆ™æ˜¯ TCPã€‚å¦å¤–å—ï¼Œå¯¹äºæœ‰è·¯ç”±å™¨çš„æƒ…å†µï¼Œæ¥æ”¶ç«¯åœ°å€å¾€å¾€ä¸æ˜¯è‡ªå·±çš„åœ°å€ï¼Œæ­¤æ—¶ï¼Œéœ€è¦å€ŸåŠ©è·¯ç”±æ§åˆ¶è¡¨ï¼Œåœ¨è°ƒæŸ¥åº”è¯¥é€å¾€çš„ä¸»æœºæˆ–è·¯ç”±å™¨ä¹‹åå†è¿›è¡Œè½¬å‘æ•°æ®ã€‚ TCP æ¨¡å—çš„å¤„ç†åœ¨ TCP æ¨¡å—ä¸­ï¼Œé¦–å…ˆä¼šè®¡ç®—ä¸€ä¸‹æ ¡éªŒå’Œï¼Œåˆ¤æ–­æ•°æ®æ˜¯å¦è¢«ç ´åã€‚ç„¶åæ£€æŸ¥æ˜¯å¦åœ¨æŒ‰ç…§åºå·æ¥æ”¶æ•°æ®ã€‚æœ€åæ£€æŸ¥ç«¯å£å·ï¼Œç¡®å®šå…·ä½“çš„åº”ç”¨ç¨‹åºã€‚æ•°æ®è¢«å®Œæ•´åœ°æ¥æ”¶ä»¥åï¼Œä¼šä¼ ç»™ç”±ç«¯å£å·è¯†åˆ«çš„åº”ç”¨ç¨‹åºã€‚ åº”ç”¨ç¨‹åºçš„å¤„ç†æ¥æ”¶ç«¯åº”ç”¨ç¨‹åºä¼šç›´æ¥æ¥æ”¶å‘é€ç«¯å‘é€çš„æ•°æ®ã€‚é€šè¿‡è§£ææ•°æ®ï¼Œå±•ç¤ºç›¸åº”çš„å†…å®¹ã€‚ IP æœåŠ¡çš„ä¸»è¦ç‰¹ç‚¹IP åè®®ä¸ºä¸Šå±‚åè®®æä¾›æ— çŠ¶æ€ã€æ— è¿æ¥ã€ä¸å¯é çš„æœåŠ¡ã€‚ æ— çŠ¶æ€ æ— çŠ¶æ€æ˜¯æŒ‡ IP é€šä¿¡åŒæ–¹ä¸åŒæ­¥ä¼ è¾“æ•°æ®çš„çŠ¶æ€ä¿¡æ¯ï¼Œæ‰€æœ‰ IP æ•°æ®æŠ¥çš„å‘é€ã€ä¼ è¾“ã€æ¥å—éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹ã€æ²¡æœ‰ä¸Šä¸‹æ–‡å…³ç³»çš„ã€‚è¿™ç§æœåŠ¡ä¼˜ç‚¹åœ¨äºç®€å•ã€é«˜æ•ˆã€‚æœ€å¤§çš„ç¼ºç‚¹æ˜¯æ— æ³•å¤„ç†ä¹±åºå’Œé‡å¤çš„ IP æ•°æ®æŠ¥ï¼Œç¡®ä¿ IP æ•°æ®æŠ¥å®Œæ•´çš„å·¥ä½œåªèƒ½äº¤ç»™ä¸Šå±‚åè®®æ¥å®Œæˆã€‚ æ— è¿æ¥ æ— è¿æ¥æ˜¯æŒ‡ IP é€šä¿¡åŒæ–¹éƒ½ä¸é•¿ä¹…åœ°ç»´æŒå¯¹æ–¹çš„ä»»ä½•ä¿¡æ¯ã€‚ä¸Šå±‚åè®®æ¯æ¬¡å‘é€æ•°æ®çš„æ—¶å€™ï¼Œéƒ½éœ€è¦æ˜ç¡®æŒ‡å‡ºå¯¹æ–¹çš„ IP åœ°å€ã€‚ ä¸å¯é  ä¸å¯é æ˜¯æŒ‡ IP åè®®ä¸èƒ½ä¿è¯ IP æ•°æ®æŠ¥å‡†ç¡®åˆ°è¾¾æ¥æ”¶ç«¯ï¼Œå®ƒæŒ‡æ‰¿è¯ºå°½æœ€å¤§åŠªåŠ›äº¤ä»˜ã€‚IP æ¨¡å—ä¸€æ—¦æ£€æµ‹åˆ°æ•°æ®æŠ¥å‘é€å¤±è´¥ï¼Œå°±é€šçŸ¥ä¸Šå±‚åè®®ï¼Œè€Œä¸ä¼šè¯•å›¾é‡ä¼ ã€‚ IP åœ°å€IP åœ°å€æ¦‚è¿° åœ¨è®¡ç®—æœºé€šä¿¡ä¸­ï¼Œä¸ºäº†è¯†åˆ«é€šä¿¡å¯¹ç«¯ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªç±»ä¼¼äºåœ°å€çš„è¯†åˆ«ç è¿›è¡Œæ ‡è¯†ã€‚åœ¨æ•°æ®é“¾è·¯ä¸­çš„ MAC åœ°å€æ­£æ˜¯ç”¨æ¥æ ‡è¯†åŒä¸€ä¸ªé“¾è·¯ä¸­ä¸åŒè®¡ç®—æœºçš„ä¸€ç§è¯†åˆ«ç ã€‚ ä½œä¸ºç½‘ç»œå±‚çš„ IP ,ä¹Ÿæœ‰è¿™ç§åœ°å€ä¿¡æ¯ï¼Œä¸€èˆ¬å«åš IP åœ°å€ã€‚IP åœ°å€ç”¨äºåœ¨â€œè¿æ¥åˆ°ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºä¸­è¯†åˆ«å‡ºè¿›è¡Œé€šä¿¡çš„ç›®æ ‡åœ°å€â€ã€‚å› æ­¤ï¼Œåœ¨ TCP/IP é€šä¿¡ä¸­æ‰€æœ‰ä¸»æœºæˆ–è·¯ç”±å™¨å¿…é¡»è®¾å®šè‡ªå·±çš„ IP åœ°å€ã€‚ ä¸è®ºä¸€å°ä¸»æœºä¸å“ªç§æ•°æ®é“¾è·¯è¿æ¥ï¼Œå…¶ IP åœ°å€çš„å½¢å¼éƒ½ä¿æŒä¸å˜ã€‚ IP åœ°å€ï¼ˆIPv4 åœ°å€ï¼‰ç”± 32 ä½æ­£æ•´æ•°æ¥è¡¨ç¤ºã€‚IP åœ°å€åœ¨è®¡ç®—æœºå†…éƒ¨ä»¥äºŒè¿›åˆ¶æ–¹å¼è¢«å¤„ç†ã€‚ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬å¹¶ä¸ä¹ æƒ¯äºé‡‡ç”¨äºŒè¿›åˆ¶æ–¹å¼ï¼Œæˆ‘ä»¬å°† 32 ä½çš„ IP åœ°å€ä»¥æ¯ 8 ä½ä¸ºä¸€ç»„ï¼Œåˆ†æˆ 4 ç»„ï¼Œæ¯ç»„ä»¥ â€œ.â€ éš”å¼€ï¼Œå†å°†æ¯ç»„æ•°è½¬æ¢æˆåè¿›åˆ¶æ•°ã€‚å¦‚ä¸‹ï¼š 2^8 2^8 2^8 2^8 10101100 00010100 00000001 00000001 ï¼ˆ2 è¿›åˆ¶ï¼‰ 172. 20. 1. 1 ï¼ˆ10 è¿›åˆ¶ï¼‰ IP åœ°å€ç”±ç½‘ç»œå’Œä¸»æœºä¸¤éƒ¨åˆ†æ ‡è¯†ç»„æˆ å¦‚ä¸‹å›¾ï¼Œç½‘ç»œæ ‡è¯†åœ¨æ•°æ®é“¾è·¯çš„æ¯ä¸ªæ®µé…ç½®ä¸åŒçš„å€¼ã€‚ç½‘ç»œæ ‡è¯†å¿…é¡»ä¿è¯ç›¸äº’è¿æ¥çš„æ¯ä¸ªæ®µçš„åœ°å€ä¸ç›¸é‡å¤ã€‚è€Œç›¸åŒæ®µå†…ç›¸è¿çš„ä¸»æœºå¿…é¡»æœ‰ç›¸åŒçš„ç½‘ç»œåœ°å€ã€‚IP åœ°å€çš„â€œä¸»æœºæ ‡è¯†â€åˆ™ä¸å…è®¸åœ¨åŒä¸€ä¸ªç½‘æ®µå†…é‡å¤å‡ºç°ã€‚ç”±æ­¤ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œåœ¨ç›¸äº’è¿æ¥çš„æ•´ä¸ªç½‘ç»œä¸­ä¿è¯æ¯å°ä¸»æœºçš„ IP åœ°å€éƒ½ä¸ä¼šç›¸äº’é‡å ã€‚å³ IP åœ°å€å…·æœ‰äº†å”¯ä¸€æ€§ã€‚ å¦‚ä¸‹å›¾ï¼ŒIP åŒ…è¢«è½¬å‘åˆ°é€”ä¸­æŸä¸ªè·¯ç”±å™¨æ—¶ï¼Œæ­£æ˜¯åˆ©ç”¨ç›®æ ‡ IP åœ°å€çš„ç½‘ç»œæ ‡è¯†è¿›è¡Œè·¯ç”±ã€‚å› ä¸ºå³ä½¿ä¸çœ‹ä¸»æœºæ ‡è¯†ï¼Œåªè¦ä¸€è§åˆ°ç½‘ç»œæ ‡è¯†å°±èƒ½åˆ¤æ–­å‡ºæ˜¯å¦ä¸ºè¯¥ç½‘æ®µå†…çš„ä¸»æœºã€‚ IP åœ°å€çš„åˆ†ç±»IP åœ°å€åˆ†ä¸ºå››ä¸ªçº§åˆ«ï¼Œåˆ†åˆ«ä¸º A ç±»ã€B ç±»ã€C ç±»ã€D ç±»ã€‚å®ƒæ ¹æ® IP åœ°å€ä¸­ä»ç¬¬ 1 ä½åˆ°ç¬¬ 4 ä½çš„æ¯”ç‰¹åˆ—å¯¹å…¶ç½‘ç»œæ ‡è¯†å’Œä¸»æœºæ ‡è¯†è¿›è¡ŒåŒºåˆ†ã€‚ A ç±» IP åœ°å€æ˜¯é¦–ä½ä»¥ â€œ0â€ å¼€å¤´çš„åœ°å€ã€‚ä»ç¬¬ 1 ä½åˆ°ç¬¬ 8 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ0.0.0.0~127.0.0.0 æ˜¯ A ç±»çš„ç½‘ç»œåœ°å€ã€‚A ç±»åœ°å€çš„å 24 ä½ç›¸å½“äºä¸»æœºæ ‡è¯†ã€‚å› æ­¤ï¼Œä¸€ä¸ªç½‘æ®µå†…å¯å®¹çº³çš„ä¸»æœºåœ°å€ä¸Šé™ä¸º 16,777,214 ä¸ªã€‚ B ç±» IP åœ°å€æ˜¯å‰ä¸¤ä½ â€œ10â€ çš„åœ°å€ã€‚ä»ç¬¬ 1 ä½åˆ°ç¬¬ 16 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ128.0.0.0~191.255.0.0 æ˜¯ B ç±»çš„ç½‘ç»œåœ°å€ã€‚B ç±»åœ°å€çš„å 16 ä½ç›¸å½“äºä¸»æœºæ ‡è¯†ã€‚å› æ­¤ï¼Œä¸€ä¸ªç½‘æ®µå†…å¯å®¹çº³çš„ä¸»æœºåœ°å€ä¸Šé™ä¸º 65,534 ä¸ªã€‚ C ç±» IP åœ°å€æ˜¯å‰ä¸‰ä½ä¸º â€œ110â€ çš„åœ°å€ã€‚ä»ç¬¬ 1 ä½åˆ°ç¬¬ 24 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ192.0.0.0~223.255.255.0 æ˜¯ C ç±»çš„ç½‘ç»œåœ°å€ã€‚C ç±»åœ°å€çš„å 8 ä½ç›¸å½“äºä¸»æœºæ ‡è¯†ã€‚å› æ­¤ï¼Œä¸€ä¸ªç½‘æ®µå†…å¯å®¹çº³çš„ä¸»æœºåœ°å€ä¸Šé™ä¸º 254 ä¸ªã€‚ D ç±» IP åœ°å€æ˜¯å‰å››ä½ä¸º â€œ1110â€ çš„åœ°å€ã€‚ä»ç¬¬ 1 ä½åˆ°ç¬¬ 32 ä½æ˜¯å®ƒçš„ç½‘ç»œæ ‡è¯†ã€‚ç”¨åè¿›åˆ¶è¡¨ç¤ºçš„è¯ï¼Œ224.0.0.0~239.255.255.255 æ˜¯ D ç±»çš„ç½‘ç»œåœ°å€ã€‚D ç±»åœ°å€æ²¡æœ‰ä¸»æœºæ ‡è¯†ï¼Œå¸¸ç”¨äºå¤šæ’­ã€‚ åœ¨åˆ†é… IP åœ°å€æ—¶å…³äºä¸»æœºæ ‡è¯†æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ã€‚å³è¦ç”¨æ¯”ç‰¹ä½è¡¨ç¤ºä¸»æœºåœ°å€æ—¶ï¼Œä¸å¯ä»¥å…¨éƒ¨ä¸º 0 æˆ–å…¨éƒ¨ä¸º 1ã€‚å› ä¸ºå…¨éƒ¨ä¸º 0 åªæœ‰åœ¨è¡¨ç¤ºå¯¹åº”çš„ç½‘ç»œåœ°å€æˆ– IP åœ°å€ä¸å¯ä»¥è·çŸ¥çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ã€‚è€Œå…¨éƒ¨ä¸º 1 çš„ä¸»æœºé€šå¸¸ä½œä¸ºå¹¿æ’­åœ°å€ã€‚å› æ­¤ï¼Œåœ¨åˆ†é…è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥å»æ‰è¿™ä¸¤ç§æƒ…å†µã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ C ç±»åœ°å€æ¯ä¸ªç½‘æ®µæœ€å¤šåªèƒ½æœ‰ 254ï¼ˆ 28 - 2 = 254ï¼‰ä¸ªä¸»æœºåœ°å€çš„åŸå› ã€‚ å¹¿æ’­åœ°å€ å¹¿æ’­åœ°å€ç”¨äºåœ¨åŒä¸€ä¸ªé“¾è·¯ä¸­ç›¸äº’è¿æ¥çš„ä¸»æœºä¹‹é—´å‘é€æ•°æ®åŒ…ã€‚å°† IP åœ°å€ä¸­çš„ä¸»æœºåœ°å€éƒ¨åˆ†å…¨éƒ¨è®¾ç½®ä¸º 1ï¼Œå°±æˆäº†å¹¿æ’­åœ°å€ã€‚ å¹¿æ’­åˆ†ä¸ºæœ¬åœ°å¹¿æ’­å’Œç›´æ¥å¹¿æ’­ä¸¤ç§ã€‚åœ¨æœ¬ç½‘ç»œå†…çš„å¹¿æ’­å«åšæœ¬åœ°å¹¿æ’­ï¼›åœ¨ä¸åŒç½‘ç»œä¹‹é—´çš„å¹¿æ’­å«åšç›´æ¥å¹¿æ’­ã€‚ IP å¤šæ’­ å¤šæ’­ç”¨äºå°†åŒ…å‘é€ç»™ç‰¹å®šç»„å†…çš„æ‰€æœ‰ä¸»æœºã€‚ç”±äºå…¶ç›´æ¥ä½¿ç”¨ IP åœ°å€ï¼Œå› æ­¤ä¹Ÿä¸å­˜åœ¨å¯é ä¼ è¾“ã€‚ ç›¸æ¯”äºå¹¿æ’­ï¼Œå¤šæ’­æ—¢å¯ä»¥ç©¿é€è·¯ç”±å™¨ï¼Œåˆå¯ä»¥å®ç°åªç»™é‚£äº›å¿…è¦çš„ç»„å‘é€æ•°æ®åŒ…ã€‚è¯·çœ‹ä¸‹å›¾ï¼š å¤šæ’­ä½¿ç”¨ D ç±»åœ°å€ã€‚å› æ­¤ï¼Œå¦‚æœä»é¦–ä½å¼€å§‹åˆ°ç¬¬ 4 ä½æ˜¯ â€œ1110â€ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯å¤šæ’­åœ°å€ã€‚è€Œå‰©ä¸‹çš„ 28 ä½å¯ä»¥æˆä¸ºå¤šæ’­çš„ç»„ç¼–å·ã€‚ æ­¤å¤–ï¼Œ å¯¹äºå¤šæ’­ï¼Œæ‰€æœ‰çš„ä¸»æœºï¼ˆè·¯ç”±å™¨ä»¥å¤–çš„ä¸»æœºå’Œç»ˆç«¯ä¸»æœºï¼‰å¿…é¡»å±äº 224.0.0.1 çš„ç»„ï¼Œæ‰€æœ‰çš„è·¯ç”±å™¨å¿…é¡»å±äº 224.0.0.2 çš„ç»„ã€‚ å­ç½‘æ©ç  ç°åœ¨ä¸€ä¸ª IP åœ°å€çš„ç½‘ç»œæ ‡è¯†å’Œä¸»æœºæ ‡è¯†å·²ä¸å†å—é™äºè¯¥åœ°å€çš„ç±»åˆ«ï¼Œè€Œæ˜¯ç”±ä¸€ä¸ªå«åšâ€œå­ç½‘æ©ç â€çš„è¯†åˆ«ç é€šè¿‡å­ç½‘ç½‘ç»œåœ°å€ç»†åˆ†å‡ºæ¯” A ç±»ã€B ç±»ã€C ç±»æ›´å°ç²’åº¦çš„ç½‘ç»œã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šå°±æ˜¯å°†åŸæ¥ A ç±»ã€B ç±»ã€C ç±»ç­‰åˆ†ç±»ä¸­çš„ä¸»æœºåœ°å€éƒ¨åˆ†ç”¨ä½œå­ç½‘åœ°å€ï¼Œå¯ä»¥å°†åŸç½‘ç»œåˆ†ä¸ºå¤šä¸ªç‰©ç†ç½‘ç»œçš„ä¸€ç§æœºåˆ¶ã€‚ å­ç½‘æ©ç ç”¨äºŒè¿›åˆ¶æ–¹å¼è¡¨ç¤ºçš„è¯ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª 32 ä½çš„æ•°å­—ã€‚å®ƒå¯¹åº” IP åœ°å€ç½‘ç»œæ ‡è¯†éƒ¨åˆ†çš„ä½å…¨éƒ¨ä¸º â€œ1â€ï¼Œå¯¹åº” IP åœ°å€ä¸»æœºæ ‡è¯†çš„éƒ¨åˆ†åˆ™å…¨éƒ¨ä¸º â€œ0â€ã€‚ç”±æ­¤ï¼Œä¸€ä¸ª IP åœ°å€å¯ä»¥ä¸å†å—é™äºè‡ªå·±çš„ç±»åˆ«ï¼Œè€Œæ˜¯å¯ä»¥ç”¨è¿™æ ·çš„å­ç½‘æ©ç è‡ªç”±åœ°å®šä½è‡ªå·±çš„ç½‘ç»œæ ‡è¯†é•¿åº¦ã€‚å½“ç„¶ï¼Œå­ç½‘æ©ç å¿…é¡»æ˜¯ IP åœ°å€çš„é¦–ä½å¼€å§‹è¿ç»­çš„ â€œ1â€ã€‚ å¯¹äºå­ç½‘æ©ç ï¼Œç›®å‰æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯ï¼Œå°† IP åœ°å€ä¸å­ç½‘æ©ç çš„åœ°å€åˆ†åˆ«ç”¨ä¸¤è¡Œæ¥è¡¨ç¤ºã€‚ä»¥ 172.20.100.52 çš„å‰ 26 ä½æ˜¯ç½‘ç»œåœ°å€çš„æƒ…å†µä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š IP åœ°å€ 172. 20. 100. 52 å­ç½‘æ©ç  255. 255. 255. 192 ç½‘ç»œåœ°å€ 172. 20. 100. 0 å­ç½‘æ©ç  255. 255. 255. 192 å¹¿æ’­åœ°å€ 172. 20. 100. 63 å­ç½‘æ©ç  255. 255. 255. 192 ç¬¬äºŒç§è¡¨ç¤ºæ–¹å¼æ˜¯ï¼Œåœ¨æ¯ä¸ª IP åœ°å€åé¢è¿½åŠ ç½‘ç»œåœ°å€çš„ä½æ•°ç”¨ â€œ/ â€ éš”å¼€ï¼Œå¦‚ä¸‹ï¼š IP åœ°å€ 172. 20. 100. 52 / 26 ç½‘ç»œåœ°å€ 172. 20. 100. 0 / 26 å¹¿æ’­åœ°å€ 172. 20. 100. 63 / 26 å¦å¤–ï¼Œåœ¨ç¬¬äºŒç§æ–¹å¼ä¸‹è®°è¿°ç½‘ç»œåœ°å€æ—¶å¯ä»¥çœç•¥åé¢çš„ â€œ0â€ ã€‚ä¾‹å¦‚ï¼š172.20.0.0/26 è·Ÿ 172.20/26 å…¶å®æ˜¯ä¸€ä¸ªæ„æ€ã€‚ è·¯ç”± å‘é€æ•°æ®åŒ…æ—¶æ‰€ä½¿ç”¨çš„åœ°å€æ˜¯ç½‘ç»œå±‚çš„åœ°å€ï¼Œå³ IP åœ°å€ã€‚ç„¶è€Œä»…ä»…æœ‰ IP åœ°å€è¿˜ä¸è¶³ä»¥å®ç°å°†æ•°æ®åŒ…å‘é€åˆ°å¯¹ç«¯ç›®æ ‡åœ°å€ï¼Œåœ¨æ•°æ®å‘é€è¿‡ç¨‹ä¸­è¿˜éœ€è¦ç±»ä¼¼äºâ€œæŒ‡æ˜è·¯ç”±å™¨æˆ–ä¸»æœºâ€çš„ä¿¡æ¯ï¼Œä»¥ä¾¿çœŸæ­£å‘å¾€ç›®æ ‡åœ°å€ã€‚ä¿å­˜è¿™ç§ä¿¡æ¯çš„å°±æ˜¯è·¯ç”±æ§åˆ¶è¡¨ã€‚ è¯¥è·¯ç”±æ§åˆ¶è¡¨çš„å½¢æˆæ–¹å¼æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯ç®¡ç†å‘˜æ‰‹åŠ¨è®¾ç½®ï¼Œå¦ä¸€ç§æ˜¯è·¯ç”±å™¨ä¸å…¶ä»–è·¯ç”±å™¨ç›¸äº’äº¤æ¢ä¿¡æ¯æ—¶è‡ªåŠ¨åˆ·æ–°ã€‚å‰è€…ä¹Ÿå«åšé™æ€è·¯ç”±æ§åˆ¶ï¼Œè€Œåè€…å«åšåŠ¨æ€è·¯ç”±æ§åˆ¶ã€‚ IP åè®®å§‹ç»ˆè®¤ä¸ºè·¯ç”±è¡¨æ˜¯æ­£ç¡®çš„ã€‚ç„¶åï¼ŒIP æœ¬èº«å¹¶æ²¡æœ‰å®šä¹‰åˆ¶ä½œè·¯ç”±æ§åˆ¶è¡¨çš„åè®®ã€‚å³ IP æ²¡æœ‰åˆ¶ä½œè·¯ç”±æ§åˆ¶è¡¨çš„æœºåˆ¶ã€‚è¯¥è¡¨ç¤ºç”±ä¸€ä¸ªå«åšâ€œè·¯ç”±åè®®â€çš„åè®®åˆ¶ä½œè€Œæˆã€‚ IP åœ°å€ä¸è·¯ç”±æ§åˆ¶ IP åœ°å€çš„ç½‘ç»œåœ°å€éƒ¨åˆ†ç”¨äºè¿›è¡Œè·¯ç”±æ§åˆ¶ã€‚ è·¯ç”±æ§åˆ¶è¡¨ä¸­è®°å½•ç€ç½‘ç»œåœ°å€ä¸ä¸‹ä¸€æ­¥åº”è¯¥å‘é€è‡³è·¯ç”±å™¨çš„åœ°å€ã€‚ åœ¨å‘é€ IP åŒ…æ—¶ï¼Œé¦–å…ˆè¦ç¡®å®š IP åŒ…é¦–éƒ¨ä¸­çš„ç›®æ ‡åœ°å€ï¼Œå†ä»è·¯ç”±æ§åˆ¶è¡¨ä¸­æ‰¾åˆ°ä¸è¯¥åœ°å€å…·æœ‰ç›¸åŒç½‘ç»œåœ°å€çš„è®°å½•ï¼Œæ ¹æ®è¯¥è®°å½•å°† IP åŒ…è½¬å‘ç»™ç›¸åº”çš„ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚å¦‚æœè·¯ç”±æ§åˆ¶è¡¨ä¸­å­˜åœ¨å¤šæ¡ç›¸åŒç½‘ç»œåœ°å€çš„è®°å½•ï¼Œå°±é€‰æ‹©ä¸€ä¸ªæœ€ä¸ºå»åˆçš„ç½‘ç»œåœ°å€ã€‚ è·¯ç”±åŒ¹é…è·¯ç”±åŒ¹é…é¡ºåºï¼š1ï¼‰ ç›´æ¥åŒ¹é…ï¼ŒæŸ¥æ‰¾è·¯ç”±è¡¨ä¸­æ˜¯å¦ç”±ä¸ç›®æ ‡ IP åœ°å€å®Œå…¨åŒ¹é…çš„ä¸»æœº IP åœ°å€ï¼Œæ‰¾åˆ°åˆ™åŒ¹é…æˆåŠŸï¼Œæ²¡æœ‰çš„è¯è½¬ 2ï¼›2ï¼‰æŸ¥æ‰¾æ˜¯å¦æœ‰ä¸ç›®æ ‡ IP åœ°å€å…·æœ‰ç›¸åŒç½‘ç»œ ID çš„ IP åœ°å€ï¼Œæ‰¾åˆ°åˆ™åŒ¹é…æˆåŠŸï¼Œæ²¡æœ‰çš„è¯è½¬ 3ï¼›3ï¼‰æŸ¥çœ‹æ˜¯å¦æœ‰é»˜è®¤ç½‘å…³ï¼Œæœ‰åˆ™è½¬å‘ç»™å®ƒï¼Œæ²¡æœ‰çš„è¯ï¼Œè·¯ç”±æŸ¥æ‰¾å¤±è´¥ï¼Œç”± ICMP è¿”å›é”™è¯¯ä¿¡æ¯ã€‚ è·¯ç”±æ›´æ–°é€šè¿‡ route å‘½ä»¤æˆ–å…¶ä»–å·¥å…·å¯ä»¥æ‰‹å·¥ä¿®æ”¹è·¯ç”±è¡¨ï¼Œæ˜¯é™æ€è·¯ç”±æ›´æ–°æ–¹å¼ã€‚å¯¹äºå¤§å‹è·¯ç”±å™¨ï¼Œå®ƒä»¬é€šå¸¸é€šè¿‡ BGPã€RIPã€OSPF ç­‰åè®®è¿›è¡ŒåŠ¨æ€è·¯ç”±æ›´æ–°ã€‚ IP åˆ†åŒ…ä¸ç»„åŒ… æ¯ç§æ•°æ®é“¾è·¯çš„æœ€å¤§ä¼ è¾“å•å…ƒï¼ˆMTUï¼‰éƒ½ä¸å°½ç›¸åŒï¼Œå› ä¸ºæ¯ä¸ªä¸åŒç±»å‹çš„æ•°æ®é“¾è·¯çš„ä½¿ç”¨ç›®çš„ä¸åŒã€‚ä½¿ç”¨ç›®çš„ä¸åŒï¼Œå¯æ‰¿è½½çš„ MTU ä¹Ÿå°±ä¸åŒã€‚ ä»»ä½•ä¸€å°ä¸»æœºéƒ½æœ‰å¿…è¦å¯¹ IP åˆ†ç‰‡è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚åˆ†ç‰‡å¾€å¾€åœ¨ç½‘ç»œä¸Šé‡åˆ°æ¯”è¾ƒå¤§çš„æŠ¥æ–‡æ— æ³•ä¸€ä¸‹å­å‘é€å‡ºå»æ—¶æ‰ä¼šè¿›è¡Œå¤„ç†ã€‚ ç»è¿‡åˆ†ç‰‡ä¹‹åçš„ IP æ•°æ®æŠ¥åœ¨è¢«é‡ç»„çš„æ—¶å€™ï¼Œåªèƒ½ç”±ç›®æ ‡ä¸»æœºè¿›è¡Œã€‚è·¯ç”±å™¨è™½ç„¶åšåˆ†ç‰‡ä½†ä¸ä¼šè¿›è¡Œé‡ç»„ã€‚ è·¯å¾„ MTU å‘ç° åˆ†ç‰‡æœºåˆ¶ä¹Ÿæœ‰å®ƒçš„ä¸è¶³ã€‚å¦‚è·¯ç”±å™¨çš„å¤„ç†è´Ÿè·åŠ é‡ä¹‹ç±»ã€‚å› æ­¤ï¼Œåªè¦å…è®¸ï¼Œæ˜¯ä¸å¸Œæœ›ç”±è·¯ç”±å™¨è¿›è¡Œ IP æ•°æ®åŒ…çš„åˆ†ç‰‡å¤„ç†çš„ã€‚ ä¸ºäº†åº”å¯¹åˆ†ç‰‡æœºåˆ¶çš„ä¸è¶³ï¼Œâ€œè·¯å¾„ MTU å‘ç°â€ æŠ€æœ¯åº”è¿è€Œç”Ÿã€‚è·¯å¾„ MTU æŒ‡çš„æ˜¯ï¼Œä»å‘é€ç«¯ä¸»æœºåˆ°æ¥æ”¶ç«¯ä¸»æœºä¹‹é—´ä¸éœ€è¦åˆ†ç‰‡æ˜¯æœ€å¤§ MTU çš„å¤§å°ã€‚å³è·¯å¾„ä¸­å­˜åœ¨çš„æ‰€æœ‰æ•°æ®é“¾è·¯ä¸­æœ€å°çš„ MTU ã€‚ è¿›è¡Œè·¯å¾„ MTU å‘ç°ï¼Œå°±å¯ä»¥é¿å…åœ¨ä¸­é€”çš„è·¯ç”±å™¨ä¸Šè¿›è¡Œåˆ†ç‰‡å¤„ç†ï¼Œä¹Ÿå¯ä»¥åœ¨ TCP ä¸­å‘é€æ›´å¤§çš„åŒ…ã€‚ IPv4IPv4 å¤´éƒ¨ å¤´éƒ¨é•¿åº¦ æ ‡è¯†è¯¥ IP å¤´éƒ¨æœ‰å¤šå°‘ä¸ª 32 ä½ bit å­—ï¼ˆ4 å­—èŠ‚ï¼‰ï¼Œç”±äº 4 ä½æœ€å¤§æè¿° 15ï¼Œæ‰€ä»¥ IP å¤´éƒ¨æœ€å¤§é•¿åº¦ä¸º 60 å­—èŠ‚ã€‚ 8 ä¸ºæœåŠ¡ä½ åŒ…æ‹¬ 3 ä½ä¼˜å…ˆæƒä½ï¼Œ4 ä¸º TOS å­—æ®µå’Œ 1 ä½ä¿ç•™å­—æ®µã€‚4 ä¸º TOS å­—æ®µåˆ†åˆ«è¡¨ç¤ºï¼šæœ€å°å»¶æ—¶ï¼Œæœ€å¤§ååé‡ã€æœ€é«˜å¯é æ€§å’Œæœ€å°è´¹ç”¨ã€‚å…¶ä¸­æœ€å¤šèƒ½é€‰æ‹©ä¸€ä½ç½® 1ï¼Œåº”ç”¨ç¨‹åºæ ¹æ®å®é™…éœ€è¦æ¥è®¾ç½®æœåŠ¡ç±»å‹ã€‚ 16 ä½æ ‡è¯† å”¯ä¸€æ ‡è¯†ä¸»æœºå‘é€çš„æ¯ä¸€ä¸ªæ•°æ®æŠ¥ã€‚å…¶åˆå§‹å€¼ç”±ç³»ç»Ÿéšæœºç”Ÿæˆï¼›æ¯å‘ä¸€ä¸ªæ•°æ®æŠ¥å°±åŠ  1ã€‚æ¯ä¸ªåˆ†ç‰‡ä¸­å…·æœ‰ç›¸åŒçš„æ ‡è¯†å€¼ã€‚ åˆ†ç‰‡åç§» æœ‰ 3 ä½ç”¨äºæ ‡è¯†åç§»ï¼Œç¬¬ä¸€ä½ä¿ç•™ï¼Œç¬¬äºŒä½ DF å­—æ®µï¼ˆç¦æ­¢åˆ†ç‰‡æ ‡è¯†ï¼‰ï¼Œç¬¬ä¸‰ä½ MF å­—æ®µï¼ˆæ›´å¤šåˆ†ç‰‡æ ‡è¯†ï¼Œæœ€åä¸€ä¸ªåˆ†ç‰‡ä¸º 0ï¼Œå…¶ä»–åˆ†ç‰‡ç½® 1ï¼‰ã€‚13 ä½åç§»æ˜¯å‹‡æ•¢å°†å®é™…å€¼å·¦ç§»ä¸‰ä½å¾—åˆ°çš„ï¼Œå› æ­¤è¦æ±‚æ•°æ®éƒ¨åˆ†çš„é•¿åº¦æ˜¯ 8 çš„å€æ•°ã€‚ 8 ä½åè®® æ ‡è¯†ä¸Šå±‚åè®®ï¼Œ1 æ˜¯ ICMPï¼Œ6 æ˜¯ TCPï¼Œ17 æ˜¯ UDPã€‚ 16 ä½å¤´éƒ¨æ ¡éªŒå’Œ IP æ¨¡å—æ¥å—æ•°æ®åï¼Œé¦–å…ˆå¯¹æ•°æ®æŠ¥å¤´éƒ¨åš CRC æ ¡éªŒï¼Œç¡®ä¿ IP å¤´éƒ¨åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ— æŸååï¼Œå†åˆ†æå…¶å¤´éƒ¨å…·ä½“ä¿¡æ¯ã€‚ IPv6IPv6ï¼ˆIP version 6ï¼‰æ˜¯ä¸ºäº†æ ¹æœ¬è§£å†³ IPv4 åœ°å€è€—å°½çš„é—®é¢˜è€Œè¢«æ ‡å‡†åŒ–çš„ç½‘é™…åè®®ã€‚IPv4 çš„åœ°å€é•¿åº¦ä¸º 4 ä¸ª 8 ä½å­—èŠ‚ï¼Œå³ 32 æ¯”ç‰¹ã€‚è€Œ IPv6 çš„åœ°å€é•¿åº¦åˆ™æ˜¯åŸæ¥çš„ 4 å€ï¼Œå³ 128 æ¯”ç‰¹ï¼Œä¸€èˆ¬å†™æˆ 8 ä¸ª 16 ä½å­—èŠ‚ã€‚ IPv6 åè®®å¹¶ä¸æ˜¯ IPv4 çš„ç®€å•æ‰©å±•ï¼Œè€Œæ˜¯å®Œå…¨ç‹¬ç«‹çš„åè®®ã€‚ä»ä»¥å¤ªç½‘å¸§å°è£…çš„æ•°æ®ç±»å‹æ¥çœ‹ï¼Œå‰è€…ç±»å‹æ˜¯ 0X86ddï¼Œåè€…æ˜¯ 0x8600ï¼Œæ˜¯å®Œå…¨ä¸åŒçš„ç±»å‹ã€‚ IPv6 è§£å†³äº†ç½‘ç»œåœ°å€ä¸è¶³çš„é—®é¢˜ï¼Œå…¶å¤´éƒ¨å¢åŠ äº†å¤šæ’­å’Œæµçš„åŠŸèƒ½ï¼Œå¼•å…¥äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼Œè¿˜å¢åŠ äº†ç½‘ç»œå®‰å…¨çš„åŠŸèƒ½ã€‚ IPv6 å¤´éƒ¨å›ºå®šéƒ¨åˆ† æµæ ‡ç­¾ æ˜¯ IPv6 æ–°å¢åŠ çš„å­—æ®µï¼Œç”¨äºå¯¹æŸäº›è¿æ¥çš„æœåŠ¡è´¨é‡æœ‰ç‰¹æ®Šè¦æ±‚çš„é€šä¿¡ï¼Œæ¯”å¦‚éŸ³é¢‘æˆ–è€…è§†é¢‘ç­‰å®æ—¶æ•°æ®ä¼ é€’ã€‚ ä¸‹ä¸€ä¸ªåŒ…å¤´ æŒ‡å‡ºç´§è·Ÿ IPv6 å›ºå®šå¤´éƒ¨åçš„åŒ…å¤´ç±»å‹ï¼Œå¦‚æ‹“å±•å¤´ï¼Œæˆ–è€…æŸä¸ªä¸Šå±‚åè®®å¤´ï¼ˆICMPï¼ŒTCPï¼ŒUDPï¼‰ï¼Œå®ƒç±»ä¼¼ IPv4 ä¸­çš„åè®®å­—æ®µï¼Œä¸”ç›¸åŒçš„å–å€¼å…·æœ‰ç›¸åŒçš„å«ä¹‰ã€‚ IPv6 çš„ç‰¹ç‚¹ IP å¾—çŸ¥çš„æ‰©å¤§ä¸è·¯ç”±æ§åˆ¶è¡¨çš„èšåˆã€‚ æ€§èƒ½æå‡ã€‚åŒ…é¦–éƒ¨é•¿åº¦é‡‡ç”¨å›ºå®šçš„å€¼ï¼ˆ40 å­—èŠ‚ï¼‰ï¼Œä¸å†é‡‡ç”¨é¦–éƒ¨æ£€éªŒç ã€‚ç®€åŒ–é¦–éƒ¨ç»“æ„ï¼Œå‡è½»è·¯ç”±å™¨è´Ÿæ‹…ã€‚è·¯ç”±å™¨ä¸å†åšåˆ†ç‰‡å¤„ç†ã€‚ æ”¯æŒå³æ’å³ç”¨åŠŸèƒ½ã€‚å³ä½¿æ²¡æœ‰ DHCP æœåŠ¡å™¨ä¹Ÿå¯ä»¥å®ç°è‡ªåŠ¨åˆ†é… IP åœ°å€ã€‚ é‡‡ç”¨è®¤è¯ä¸åŠ å¯†åŠŸèƒ½ã€‚åº”å¯¹ä¼ªé€  IP åœ°å€çš„ç½‘ç»œå®‰å…¨åŠŸèƒ½ä»¥åŠé˜²æ­¢çº¿è·¯çªƒå¬çš„åŠŸèƒ½ã€‚ å¤šæ’­ã€Mobile IP æˆä¸ºæ‰©å±•åŠŸèƒ½ã€‚ IPv6 ä¸­ IP åœ°å€çš„æ ‡è®°æ–¹æ³• ä¸€èˆ¬äººä»¬å°† 128 æ¯”ç‰¹ IP åœ°å€ä»¥æ¯ 16 æ¯”ç‰¹ä¸ºä¸€ç»„ï¼Œæ¯ç»„ç”¨å†’å·ï¼ˆâ€œï¼šâ€ï¼‰éš”å¼€è¿›è¡Œæ ‡è®°ã€‚ è€Œä¸”å¦‚æœå‡ºç°è¿ç»­çš„ 0 æ—¶è¿˜å¯ä»¥å°†è¿™äº› 0 çœç•¥ï¼Œå¹¶ç”¨ä¸¤ä¸ªå†’å·ï¼ˆâ€œï¼šï¼šâ€ï¼‰éš”å¼€ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ª IP åœ°å€ä¸­åªå…è®¸å‡ºç°ä¸€æ¬¡ä¸¤ä¸ªè¿ç»­çš„å†’å·ã€‚ IPv6 åœ°å€çš„ç»“æ„ IPv6 ç±»ä¼¼ IPv4ï¼Œä¹Ÿæ˜¯é€šè¿‡ IP åœ°å€çš„å‰å‡ ä½æ ‡è¯† IP åœ°å€çš„ç§ç±»ã€‚ åœ¨äº’è”ç½‘é€šä¿¡ä¸­ï¼Œä½¿ç”¨ä¸€ç§å…¨å±€çš„å•æ’­åœ°å€ã€‚å®ƒæ˜¯äº’è”ç½‘ä¸­å”¯ä¸€çš„ä¸€ä¸ªåœ°å€ï¼Œä¸éœ€è¦æ­£å¼åˆ†é… IP åœ°å€ã€‚ æœªå®šä¹‰ 0000 â€¦ 0000ï¼ˆ128 æ¯”ç‰¹ï¼‰ ï¼šï¼š/ 128 ç¯å›åœ°å€ 0000 â€¦ 0001ï¼ˆ128 æ¯”ç‰¹ï¼‰ ï¼šï¼š1 / 128 å”¯ä¸€æœ¬åœ°åœ°å€ 1111 110 FC00ï¼š/ 7 é“¾è·¯æœ¬åœ°å•æ’­åœ°å€ 1111 1110 10 FE80ï¼šï¼š/ 10 å¤šæ’­åœ°å€ 1111 1111 FF00ï¼šï¼š/ 8 å…¨å±€å•æ’­åœ°å€ ï¼ˆå…¶ä»–ï¼‰ å…¨å±€å•æ’­åœ°å€ å…¨å±€å•æ’­åœ°å€æ˜¯æŒ‡ä¸–ç•Œä¸Šå”¯ä¸€çš„ä¸€ä¸ªåœ°å€ã€‚å®ƒæ˜¯äº’è”ç½‘é€šä¿¡ä»¥åŠå„ä¸ªåŸŸå†…éƒ¨é€šä¿¡ä¸­æœ€ä¸ºå¸¸ç”¨çš„ä¸€ä¸ª IPv6 åœ°å€ã€‚ æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç°åœ¨ IPv6 çš„ç½‘ç»œä¸­æ‰€ä½¿ç”¨çš„æ ¼å¼ä¸ºï¼Œn = 48ï¼Œm = 16 ä»¥åŠ 128 - n - m = 64ã€‚å³å‰ 64 æ¯”ç‰¹ä¸ºç½‘ç»œæ ‡è¯†ï¼Œå 64 æ¯”ç‰¹ä¸ºä¸»æœºæ ‡è¯†ã€‚ é“¾è·¯æœ¬åœ°å•æ’­åœ°å€é“¾è·¯æœ¬åœ°å•æ’­åœ°å€æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªæ•°æ®é“¾è·¯å†…å”¯ä¸€çš„åœ°å€ã€‚å®ƒç”¨äºä¸ç»è¿‡è·¯ç”±å™¨ï¼Œåœ¨åŒä¸€ä¸ªé“¾è·¯ä¸­çš„é€šä¿¡ã€‚é€šå¸¸æ¥å£ ID ä¿å­˜ 64 æ¯”ç‰¹ç‰ˆçš„ MAC åœ°å€ã€‚ å”¯ä¸€æœ¬åœ°åœ°å€ å”¯ä¸€æœ¬åœ°åœ°å€æ˜¯ä¸è¿›è¡Œäº’è”ç½‘é€šä¿¡æ—¶æ‰€ç”¨çš„åœ°å€ã€‚ å”¯ä¸€æœ¬åœ°åœ°å€è™½ç„¶ä¸ä¼šä¸äº’è”ç½‘è¿æ¥ï¼Œä½†æ˜¯ä¹Ÿä¼šå°½å¯èƒ½åœ°éšæœºç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„å…¨å±€ IDã€‚ L é€šå¸¸è¢«ç½®ä¸º 1 å…¨å±€ ID çš„å€¼éšæœºå†³å®š å­ç½‘ ID æ˜¯æŒ‡è¯¥åŸŸå­ç½‘åœ°å€ æ¥å£ ID å³ä¸ºæ¥å£çš„ ID IPv6 åˆ†æ®µå¤„ç† IPv6 çš„åˆ†ç‰‡å¤„ç†åªåœ¨ä½œä¸ºèµ·ç‚¹çš„å‘é€ç«¯ä¸»æœºä¸Šè¿›è¡Œï¼Œè·¯ç”±å™¨ä¸å‚ä¸åˆ†ç‰‡ã€‚ IPv6 ä¸­æœ€å° MTU ä¸º 1280 å­—èŠ‚ï¼Œå› æ­¤ï¼Œåœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­å¯¹äºé‚£äº›æœ‰ä¸€å®šç³»ç»Ÿèµ„æºé™åˆ¶çš„è®¾å¤‡æ¥è¯´ï¼Œä¸éœ€è¦è¿›è¡Œâ€œè·¯å¾„ MTU å‘ç°â€ï¼Œè€Œæ˜¯åœ¨å‘é€ IP åŒ…æ—¶ç›´æ¥ä»¥ 1280 å­—èŠ‚ä¸ºå•ä½åˆ†ç‰‡é€å‡ºã€‚ IP é¦–éƒ¨ï¼ˆæš‚ç•¥ï¼‰IP åè®®ç›¸å…³æŠ€æœ¯IP æ—¨åœ¨è®©æœ€ç»ˆç›®æ ‡ä¸»æœºæ”¶åˆ°æ•°æ®åŒ…ï¼Œä½†æ˜¯åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ä»…ä»…æœ‰ IP æ˜¯æ— æ³•å®ç°é€šä¿¡çš„ã€‚å¿…é¡»è¿˜æœ‰èƒ½å¤Ÿè§£æä¸»æœºåç§°å’Œ MAC åœ°å€çš„åŠŸèƒ½ï¼Œä»¥åŠæ•°æ®åŒ…åœ¨å‘é€è¿‡ç¨‹ä¸­å¼‚å¸¸æƒ…å†µå¤„ç†çš„åŠŸèƒ½ã€‚ DNS æˆ‘ä»¬å¹³å¸¸åœ¨è®¿é—®æŸä¸ªç½‘ç«™æ—¶ä¸é€‚ç”¨ IP åœ°å€ï¼Œè€Œæ˜¯ç”¨ä¸€ä¸²ç”±ç½—é©¬å­—å’Œç‚¹å·ç»„æˆçš„å­—ç¬¦ä¸²ã€‚è€Œä¸€èˆ¬ç”¨æˆ·åœ¨ä½¿ç”¨ TCP/IP è¿›è¡Œé€šä¿¡æ—¶ä¹Ÿä¸ä½¿ç”¨ IP åœ°å€ã€‚èƒ½å¤Ÿè¿™æ ·åšæ˜¯å› ä¸ºæœ‰äº† DNS ï¼ˆDomain Name Systemï¼‰åŠŸèƒ½çš„æ”¯æŒã€‚DNS å¯ä»¥å°†é‚£ä¸²å­—ç¬¦ä¸²è‡ªåŠ¨è½¬æ¢ä¸ºå…·ä½“çš„ IP åœ°å€ã€‚ è¿™ç§ DNS ä¸ä»…é€‚ç”¨äº IPv4ï¼Œè¿˜é€‚ç”¨äº IPv6ã€‚ ARP åªè¦ç¡®å®šäº† IP åœ°å€ï¼Œå°±å¯ä»¥å‘è¿™ä¸ªç›®æ ‡åœ°å€å‘é€ IP æ•°æ®æŠ¥ã€‚ç„¶è€Œï¼Œåœ¨åº•å±‚æ•°æ®é“¾è·¯å±‚ï¼Œè¿›è¡Œå®é™…é€šä¿¡æ—¶å´æœ‰å¿…è¦äº†è§£æ¯ä¸ª IP åœ°å€æ‰€å¯¹åº”çš„ MAC åœ°å€ã€‚ ARP æ˜¯ä¸€ç§è§£å†³åœ°å€é—®é¢˜çš„åè®®ã€‚ä»¥ç›®æ ‡ IP åœ°å€ä¸ºçº¿ç´¢ï¼Œç”¨æ¥å®šä½ä¸‹ä¸€ä¸ªåº”è¯¥æ¥æ”¶æ•°æ®åˆ†åŒ…çš„ç½‘ç»œè®¾å¤‡å¯¹åº”çš„ MAC åœ°å€ã€‚ä¸è¿‡ ARP åªé€‚ç”¨äº IPv4ï¼Œä¸èƒ½ç”¨äº IPv6ã€‚IPv6 ä¸­å¯ä»¥ç”¨ ICMPv6 æ›¿ä»£ ARP å‘é€é‚»å±…æ¢ç´¢æ¶ˆæ¯ã€‚ RARP æ˜¯å°† ARP åè¿‡æ¥ï¼Œä» MAC åœ°å€å®šä½ IP åœ°å€çš„ä¸€ç§åè®®ã€‚ ICMP ICMP çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼Œç¡®è®¤ IP åŒ…æ˜¯å¦æˆåŠŸé€è¾¾ç›®æ ‡åœ°å€ï¼Œé€šçŸ¥åœ¨å‘é€è¿‡ç¨‹å½“ä¸­ IP åŒ…è¢«åºŸå¼ƒçš„å…·ä½“åŸå› ï¼Œæ”¹å–„ç½‘ç»œè®¾ç½®ç­‰ã€‚ IPv4 ä¸­ ICMP ä»…ä½œä¸ºä¸€ä¸ªè¾…åŠ©ä½œç”¨æ”¯æŒ IPv4ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ IPv4 æ—¶æœŸï¼Œå³ä½¿æ²¡æœ‰ ICMPï¼Œä»ç„¶å¯ä»¥å®ç° IP é€šä¿¡ã€‚ç„¶è€Œï¼Œåœ¨ IPv6 ä¸­ï¼ŒICMP çš„ä½œç”¨è¢«æ‰©å¤§ï¼Œå¦‚æœæ²¡æœ‰ ICMPv6ï¼ŒIPv6 å°±æ— æ³•è¿›è¡Œæ­£å¸¸é€šä¿¡ã€‚ DHCP å¦‚æœé€ä¸€ä¸ºæ¯ä¸€å°ä¸»æœºè®¾ç½® IP åœ°å€ä¼šæ˜¯éå¸¸ç¹ççš„äº‹æƒ…ã€‚ç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ä½¿ç”¨ç¬”è®°æœ¬ç”µè„‘ã€åªèƒ½ç»ˆç«¯ä»¥åŠå¹³æ¿ç”µè„‘ç­‰è®¾å¤‡æ—¶ï¼Œæ¯ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„åœ°æ–¹ï¼Œéƒ½è¦é‡æ–°è®¾ç½® IP åœ°å€ã€‚ äºæ˜¯ï¼Œä¸ºäº†å®ç°è‡ªåŠ¨è®¾ç½® IP åœ°å€ã€ç»Ÿä¸€ç®¡ç† IP åœ°å€åˆ†é…ï¼Œå°±äº§ç”Ÿäº† DHCPï¼ˆDynamic Host Configuration Protocolï¼‰åè®®ã€‚æœ‰äº† DHCPï¼Œè®¡ç®—æœºåªè¦è¿æ¥åˆ°ç½‘ç»œï¼Œå°±å¯ä»¥è¿›è¡Œ TCP/IP é€šä¿¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒDHCP è®©å³æ’å³ç”¨å˜å¾—å¯èƒ½ã€‚ DHCP ä¸ä»…åœ¨ IPv4 ä¸­ï¼Œåœ¨ IPv6 ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚ NAT NATï¼ˆNetwork Address Translatorï¼‰æ˜¯ç”¨äºåœ¨æœ¬åœ°ç½‘ç»œä¸­ä½¿ç”¨ç§æœ‰åœ°å€ï¼Œåœ¨è¿æ¥äº’è”ç½‘æ—¶è½¬è€Œä½¿ç”¨å…¨å±€ IP åœ°å€çš„æŠ€æœ¯ã€‚ é™¤è½¬æ¢ IP åœ°å€å¤–ï¼Œè¿˜å‡ºç°äº†å¯ä»¥è½¬æ¢ TCPã€UDP ç«¯å£å·çš„ NAPTï¼ˆNetwork Address Ports Translatorï¼‰æŠ€æœ¯ï¼Œç”±æ­¤å¯ä»¥å®ç°ç”¨ä¸€ä¸ªå…¨å±€ IP åœ°å€ä¸å¤šä¸ªä¸»æœºçš„é€šä¿¡ã€‚ NATï¼ˆNAPTï¼‰å®é™…ä¸Šæ˜¯ä¸ºæ­£åœ¨é¢ä¸´åœ°å€æ¯ç«­çš„ IPv4 è€Œå¼€å‘çš„æŠ€æœ¯ã€‚ä¸è¿‡ï¼Œåœ¨ IPv6 ä¸­ä¸ºäº†æé«˜ç½‘ç»œå®‰å…¨ä¹Ÿåœ¨ä½¿ç”¨ NATï¼Œåœ¨ IPv4 å’Œ IPv6 ä¹‹é—´çš„ç›¸äº’é€šä¿¡å½“ä¸­å¸¸å¸¸ä½¿ç”¨ NAT-PTã€‚ IP éš§é“ å¦‚ä¸Šå›¾çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œç½‘ç»œ A ä¸ç½‘ç»œ B ä¹‹é—´æ— æ³•ç›´æ¥è¿›è¡Œé€šä¿¡ï¼Œä¸ºäº†è®©å®ƒä»¬ä¹‹é—´æ­£å¸¸é€šä¿¡ï¼Œè¿™æ—¶å¿…é¡»å¾—é‡‡ç”¨ IP éš§é“çš„åŠŸèƒ½ã€‚ IP éš§é“å¯ä»¥å°†é‚£äº›ä»ç½‘ç»œ A å‘è¿‡æ¥çš„ IPv6 çš„åŒ…ç»Ÿåˆä¸ºä¸€ä¸ªæ•°æ®ï¼Œå†ä¸ºä¹‹è¿½åŠ ä¸€ä¸ª IPv4 çš„é¦–éƒ¨ä»¥åè½¬å‘ç»™ç½‘ç»œ Cã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç´§æ¥ç€ IP é¦–éƒ¨çš„æ˜¯ TCP æˆ– UDP çš„é¦–éƒ¨ã€‚ç„¶è€Œï¼Œç°åœ¨çš„åº”ç”¨å½“ä¸­â€œ IP é¦–éƒ¨çš„åé¢è¿˜æ˜¯ IP é¦–éƒ¨â€æˆ–è€…â€œ IP é¦–éƒ¨çš„åé¢æ˜¯ IPv6 çš„é¦–éƒ¨â€ç­‰æƒ…å†µä¸æ—¥ä¿±å¢ã€‚è¿™ç§åœ¨ç½‘ç»œå±‚çš„é¦–éƒ¨åé¢è¿½åŠ ç½‘ç»œå±‚é¦–éƒ¨çš„é€šä¿¡æ–¹æ³•å°±å«åšâ€œ IP éš§é“â€ã€‚","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"},{"name":"TCP/IP","slug":"TCP-IP","permalink":"http://yoursite.com/tags/TCP-IP/"}]},{"title":"Http/1.0çš„Keep-Aliveå’ŒHttp/2.0çš„å¤šè·¯å¤ç”¨å¯¹æ¯”","slug":"Http1.0çš„Keep-Aliveå’ŒHttp2.0çš„å¤šè·¯å¤ç”¨å¯¹æ¯” copy","date":"2019-10-04T08:14:38.000Z","updated":"2019-11-10T14:37:39.018Z","comments":true,"path":"2019/10/04/Http1.0çš„Keep-Aliveå’ŒHttp2.0çš„å¤šè·¯å¤ç”¨å¯¹æ¯” copy/","link":"","permalink":"http://yoursite.com/2019/10/04/Http1.0çš„Keep-Aliveå’ŒHttp2.0çš„å¤šè·¯å¤ç”¨å¯¹æ¯” copy/","excerpt":"","text":"Http/1.0 çš„ Keep-Alive å’Œ Http/2.0 çš„å¤šè·¯å¤ç”¨å¯¹æ¯”Http/1.0 çš„ Keep-Aliveåœ¨æ²¡æœ‰Keep-Aliveå‰ï¼Œæˆ‘ä»¬ä¸æœåŠ¡å™¨è¯·æ±‚æ•°æ®çš„æµç¨‹æ˜¯è¿™æ ·ï¼š æµè§ˆå™¨è¯·æ±‚//static.mtime.cn/a.jsâ€“&gt;è§£æåŸŸåâ€“&gt;HTTP è¿æ¥â€“&gt;æœåŠ¡å™¨å¤„ç†æ–‡ä»¶â€“&gt;è¿”å›æ•°æ®â€“&gt;æµè§ˆå™¨è§£æã€æ¸²æŸ“æ–‡ä»¶ æµè§ˆå™¨è¯·æ±‚//static.mtime.cn/b.jsâ€“&gt;è§£æåŸŸåâ€“&gt;HTTP è¿æ¥â€“&gt;æœåŠ¡å™¨å¤„ç†æ–‡ä»¶â€“&gt;è¿”å›æ•°æ®â€“&gt;æµè§ˆå™¨è§£æã€æ¸²æŸ“æ–‡ä»¶ â€¦ è¿™æ ·å¾ªç¯ä¸‹å»ï¼Œç›´è‡³å…¨éƒ¨æ–‡ä»¶ä¸‹è½½å®Œæˆã€‚ è¿™ä¸ªæµç¨‹æœ€å¤§çš„é—®é¢˜å°±æ˜¯ï¼šæ¯æ¬¡è¯·æ±‚éƒ½ä¼šå»ºç«‹ä¸€æ¬¡ HTTP è¿æ¥ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ 3 æ¬¡æ¡æ‰‹ 4 æ¬¡æŒ¥æ‰‹ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨ä¸€æ¬¡è¯·æ±‚è¿‡ç¨‹ä¸­å ç”¨äº†ç›¸å½“é•¿çš„æ—¶é—´ï¼Œè€Œä¸”é€»è¾‘ä¸Šæ˜¯éå¿…éœ€çš„ï¼Œå› ä¸ºä¸é—´æ–­çš„è¯·æ±‚æ•°æ®ï¼Œç¬¬ä¸€æ¬¡å»ºç«‹è¿æ¥æ˜¯æ­£å¸¸çš„ï¼Œä»¥åå°±å ç”¨è¿™ä¸ªé€šé“ï¼Œä¸‹è½½å…¶ä»–æ–‡ä»¶ï¼Œè¿™æ ·æ•ˆç‡å¤šé«˜å•Šï¼ä½ çŒœå¯¹äº†ï¼Œè¿™å°±æ˜¯Keep-Aliveã€‚ Keep-Aliveè§£å†³çš„é—®é¢˜Keep-Aliveè§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼šä¸€å®šæ—¶é—´å†…ï¼ŒåŒä¸€åŸŸåå¤šæ¬¡è¯·æ±‚æ•°æ®ï¼Œåªå»ºç«‹ä¸€æ¬¡ HTTP è¯·æ±‚ï¼Œå…¶ä»–è¯·æ±‚å¯å¤ç”¨æ¯ä¸€æ¬¡å»ºç«‹çš„è¿æ¥é€šé“ï¼Œä»¥è¾¾åˆ°æé«˜è¯·æ±‚æ•ˆç‡çš„é—®é¢˜ã€‚è¿™é‡Œé¢æ‰€è¯´çš„ä¸€å®šæ—¶é—´æ˜¯å¯ä»¥é…ç½®çš„ï¼Œä¸ç®¡ä½ ç”¨çš„æ˜¯Apacheè¿˜æ˜¯nginxã€‚ HTTP1.1è¿˜æ˜¯å­˜åœ¨æ•ˆç‡é—®é¢˜å¦‚ä¸Šé¢æ‰€è¯´ï¼Œåœ¨HTTP1.1ä¸­æ˜¯é»˜è®¤å¼€å¯äº†Keep-Aliveï¼Œä»–è§£å†³äº†å¤šæ¬¡è¿æ¥çš„é—®é¢˜ï¼Œä½†æ˜¯ä¾ç„¶æœ‰ä¸¤ä¸ªæ•ˆç‡ä¸Šçš„é—®é¢˜ï¼š ç¬¬ä¸€ä¸ªï¼šä¸²è¡Œçš„æ–‡ä»¶ä¼ è¾“ã€‚å½“è¯·æ±‚ a æ–‡ä»¶æ—¶ï¼Œb æ–‡ä»¶åªèƒ½ç­‰å¾…ï¼Œç­‰å¾… a è¿æ¥åˆ°æœåŠ¡å™¨ã€æœåŠ¡å™¨å¤„ç†æ–‡ä»¶ã€æœåŠ¡å™¨è¿”å›æ–‡ä»¶ï¼Œè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚æˆ‘ä»¬å‡è®¾è¿™ä¸‰æ­¥ç”¨æ—¶éƒ½æ˜¯ 1 ç§’ï¼Œé‚£ä¹ˆ a æ–‡ä»¶ç”¨æ—¶ä¸º 3 ç§’ï¼Œb æ–‡ä»¶ä¼ è¾“å®Œæˆç”¨æ—¶ä¸º 6 ç§’ï¼Œä¾æ­¤ç±»æ¨ã€‚ï¼ˆæ³¨ï¼šæ­¤é¡¹è®¡ç®—æœ‰ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œå°±æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨æ˜¯å•é€šé“ä¼ è¾“ï¼‰ ç¬¬äºŒä¸ªï¼šè¿æ¥æ•°è¿‡å¤šã€‚æˆ‘ä»¬å‡è®¾Apacheè®¾ç½®äº†æœ€å¤§å¹¶å‘æ•°ä¸º 300ï¼Œå› ä¸ºæµè§ˆå™¨é™åˆ¶ï¼Œæµè§ˆå™¨å‘èµ·çš„æœ€å¤§è¯·æ±‚æ•°ä¸º 6ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨èƒ½æ‰¿è½½çš„æœ€é«˜å¹¶å‘ä¸º 50ï¼Œå½“ç¬¬ 51 ä¸ªäººè®¿é—®æ—¶ï¼Œå°±éœ€è¦ç­‰å¾…å‰é¢æŸä¸ªè¯·æ±‚å¤„ç†å®Œæˆã€‚ HTTP/2 çš„å¤šè·¯å¤ç”¨HTTP/2 çš„å¤šè·¯å¤ç”¨å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°çš„ä¸¤ä¸ªæ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œä»–æ˜¯å¦‚ä½•è§£å†³çš„ã€‚ è§£å†³ç¬¬ä¸€ä¸ªï¼šåœ¨HTTP1.1çš„åè®®ä¸­ï¼Œæˆ‘ä»¬ä¼ è¾“çš„requestå’Œresponseéƒ½æ˜¯åŸºæœ¬äºæ–‡æœ¬çš„ï¼Œè¿™æ ·å°±ä¼šå¼•å‘ä¸€ä¸ªé—®é¢˜ï¼šæ‰€æœ‰çš„æ•°æ®å¿…é¡»æŒ‰é¡ºåºä¼ è¾“ï¼Œæ¯”å¦‚éœ€è¦ä¼ è¾“ï¼šhello worldï¼Œåªèƒ½ä»håˆ°dä¸€ä¸ªä¸€ä¸ªçš„ä¼ è¾“ï¼Œä¸èƒ½å¹¶è¡Œä¼ è¾“ï¼Œå› ä¸ºæ¥æ”¶ç«¯å¹¶ä¸çŸ¥é“è¿™äº›å­—ç¬¦çš„é¡ºåºï¼Œæ‰€ä»¥å¹¶è¡Œä¼ è¾“åœ¨HTTP1.1æ˜¯ä¸èƒ½å®ç°çš„ã€‚ HTTP/2å¼•å…¥äºŒè¿›åˆ¶æ•°æ®å¸§å’Œæµçš„æ¦‚å¿µï¼Œå…¶ä¸­å¸§å¯¹æ•°æ®è¿›è¡Œé¡ºåºæ ‡è¯†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ ·æµè§ˆå™¨æ”¶åˆ°æ•°æ®ä¹‹åï¼Œå°±å¯ä»¥æŒ‰ç…§åºåˆ—å¯¹æ•°æ®è¿›è¡Œåˆå¹¶ï¼Œè€Œä¸ä¼šå‡ºç°åˆå¹¶åæ•°æ®é”™ä¹±çš„æƒ…å†µã€‚åŒæ ·æ˜¯å› ä¸ºæœ‰äº†åºåˆ—ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥å¹¶è¡Œçš„ä¼ è¾“æ•°æ®ï¼Œè¿™å°±æ˜¯æµæ‰€åšçš„äº‹æƒ…ã€‚ è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼šHTTP/2å¯¹åŒä¸€åŸŸåä¸‹æ‰€æœ‰è¯·æ±‚éƒ½æ˜¯åŸºäºæµï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€åŸŸåä¸ç®¡è®¿é—®å¤šå°‘æ–‡ä»¶ï¼Œä¹Ÿåªå»ºç«‹ä¸€è·¯è¿æ¥ã€‚åŒæ ·Apacheçš„æœ€å¤§è¿æ¥æ•°ä¸º 300ï¼Œå› ä¸ºæœ‰äº†è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œæœ€å¤§çš„å¹¶å‘å°±å¯ä»¥æå‡åˆ° 300ï¼Œæ¯”åŸæ¥æå‡äº† 6 å€ï¼ å¤šè·¯å¤ç”¨å’Œ keep alive åŒºåˆ«ï¼Ÿ 1ï¼‰çº¿å¤´é˜»å¡ï¼ˆHead-of-Line Blockingï¼‰ï¼ŒHTTP1.X è™½ç„¶å¯ä»¥é‡‡ç”¨ keep alive æ¥è§£å†³å¤ç”¨ TCP çš„é—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•è§£å†³è¯·æ±‚é˜»å¡é—®é¢˜ã€‚ 2ï¼‰æ‰€è°“è¯·æ±‚é˜»å¡æ„æ€å°±æ˜¯ä¸€æ¡ TCP çš„ connection åœ¨åŒä¸€æ—¶é—´åªèƒ½å…è®¸ä¸€ä¸ªè¯·æ±‚ç»è¿‡ï¼Œè¿™æ ·å‡å¦‚åç»­è¯·æ±‚æƒ³è¦å¤ç”¨è¿™ä¸ªé“¾æ¥å°±å¿…é¡»ç­‰åˆ°å‰ä¸€ä¸ªå®Œæˆæ‰è¡Œï¼Œæ­£å¦‚ä¸Šå›¾å·¦è¾¹è¡¨ç¤ºçš„ã€‚ 3ï¼‰ä¹‹æ‰€ä»¥æœ‰è¿™ä¸ªé—®é¢˜å°±æ˜¯å› ä¸º HTTP1.x éœ€è¦æ¯æ¡è¯·æ±‚éƒ½æ˜¯å¯æ˜¯è¯†åˆ«ï¼ŒæŒ‰é¡ºåºå‘é€ï¼Œå¦åˆ™ server å°±æ— æ³•åˆ¤æ–­è¯¥ç›¸åº”å“ªä¸ªå…·ä½“çš„è¯·æ±‚ã€‚ 4ï¼‰HTTP2 é‡‡ç”¨å¤šè·¯å¤ç”¨æ˜¯æŒ‡ï¼Œåœ¨åŒä¸€ä¸ªåŸŸåä¸‹ï¼Œå¼€å¯ä¸€ä¸ª TCP çš„ connectionï¼Œæ¯ä¸ªè¯·æ±‚ä»¥ stream çš„æ–¹å¼ä¼ è¾“ï¼Œæ¯ä¸ª stream æœ‰å”¯ä¸€æ ‡è¯†ï¼Œconnection ä¸€æ—¦å»ºç«‹ï¼Œåç»­çš„è¯·æ±‚éƒ½å¯ä»¥å¤ç”¨è¿™ä¸ª connection å¹¶ä¸”å¯ä»¥åŒæ—¶å‘é€ï¼Œserver ç«¯å¯ä»¥æ ¹æ® stream çš„å”¯ä¸€æ ‡è¯†æ¥ç›¸åº”å¯¹åº”çš„è¯·æ±‚ã€‚","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"http://yoursite.com/tags/HTTP/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"}]},{"title":"CSS æ¸…é™¤æµ®åŠ¨","slug":"CSS æ¸…é™¤æµ®åŠ¨","date":"2019-09-29T07:26:33.000Z","updated":"2019-11-10T14:37:39.013Z","comments":true,"path":"2019/09/29/CSS æ¸…é™¤æµ®åŠ¨/","link":"","permalink":"http://yoursite.com/2019/09/29/CSS æ¸…é™¤æµ®åŠ¨/","excerpt":"","text":"CSS æ¸…é™¤æµ®åŠ¨ æµ®åŠ¨æ˜¯ä»€ä¹ˆï¼ŸW3school ä¸­ç»™å‡ºçš„æµ®åŠ¨å®šä¹‰ä¸ºæµ®åŠ¨çš„æ¡†å¯ä»¥å‘å·¦æˆ–å‘å³ç§»åŠ¨ï¼Œç›´åˆ°å®ƒçš„å¤–è¾¹ç¼˜ç¢°åˆ°åŒ…å«æ¡†æˆ–å¦ä¸€ä¸ªæµ®åŠ¨æ¡†çš„è¾¹æ¡†ä¸ºæ­¢ã€‚ç”±äºæµ®åŠ¨æ¡†è„±ç¦»æ–‡æ¡£çš„æ™®é€šæµä¸­ï¼Œæ‰€ä»¥æ–‡æ¡£çš„æ™®é€šæµä¸­çš„å—æ¡†è¡¨ç°å¾—å°±åƒæµ®åŠ¨æ¡†ä¸å­˜åœ¨ä¸€æ ·ã€‚ æµ®åŠ¨çš„ç‰¹ç‚¹æµ®åŠ¨çš„ç‰¹ç‚¹ï¼Œå¯ä»¥ç”¨å…«ä¸ªå­—æ€»ç»“ï¼šè„±æ ‡ã€è´´è¾¹ã€å­—å›´å’Œæ”¶ç¼©ã€‚ ä¸ºäº†æ›´å¥½è¯´æ˜ï¼Œè¯·çœ‹ä¸‹å›¾ï¼šå½“æ¡† 1 å‘å·¦æµ®åŠ¨æ—¶ï¼Œå®ƒè„±ç¦»æ–‡æ¡£æµï¼ˆè„±æ ‡ï¼‰å¹¶ä¸”å‘å·¦ç§»åŠ¨ï¼ˆè´´è¾¹ï¼‰ï¼Œç›´åˆ°å®ƒçš„å·¦è¾¹ç¼˜ç¢°åˆ°åŒ…å«æ¡†çš„å·¦è¾¹ç¼˜ã€‚å› ä¸ºå®ƒä¸å†å¤„äºæ–‡æ¡£æµä¸­ï¼Œæ‰€ä»¥å®ƒä¸å æ®ç©ºé—´ï¼Œå®é™…ä¸Šè¦†ç›–ä½äº†æ¡† 2ï¼Œä½¿æ¡† 2 ä»è§†å›¾ä¸­æ¶ˆå¤±ã€‚å¦‚æœæ¡† 2 ä¸­æœ‰æ–‡å­—ï¼Œå°±ä¼šå›´ç€æ¡† 1 æ’å¼€ï¼ˆå­—å›´ï¼‰ã€‚ å¦‚æœæŠŠæ‰€æœ‰ä¸‰ä¸ªæ¡†éƒ½å‘å·¦æµ®åŠ¨ï¼Œé‚£ä¹ˆæ¡† 1 å‘å·¦æµ®åŠ¨ç›´åˆ°ç¢°åˆ°åŒ…å«æ¡†ï¼Œå¦å¤–ä¸¤ä¸ªæ¡†å‘å·¦æµ®åŠ¨ç›´åˆ°ç¢°åˆ°å‰ä¸€ä¸ªæµ®åŠ¨æ¡†ã€‚ä¸‹é¢ç€é‡è®²è§£ä¸‹ç¬¬å››ä¸ªç‰¹ç‚¹â€“æ”¶ç¼© ä¸€ä¸ªæµ®åŠ¨çš„å†…è”å…ƒç´ ï¼ˆæ¯”å¦‚ span img æ ‡ç­¾ï¼‰ä¸éœ€è¦è®¾ç½® displayï¼šblock å°±å¯ä»¥è®¾ç½®å®½åº¦ã€‚ 12345678910111213&lt;head&gt; &lt;style&gt; div &#123; float: left; background-color: greenyellow; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt; è¿™æ˜¯ä¸€æ®µæ–‡å­— &lt;/div&gt;&lt;/body&gt; å¾—åˆ°ä»¥ä¸‹çš„æ•ˆæœï¼š æˆ‘ä»¬éƒ½çŸ¥é“ div æ ‡ç­¾æ˜¯å—çº§å…ƒç´ ï¼Œä¼šç‹¬å ä¸€è¡Œï¼Œç„¶è€Œä¸Šé¢çš„ä¾‹å­ä¸­å°† div è®¾ç½®ä¸ºå·¦æµ®åï¼Œå…¶å®½åº¦ä¸å†æ˜¯å æ»¡ä¸€è¡Œï¼Œè€Œæ˜¯æ”¶ç´§ä¸ºå†…éƒ¨å…ƒç´ çš„å®½åº¦ï¼Œè¿™å°±æ˜¯æµ®åŠ¨ç¬¬å››ä¸ªç‰¹å¾çš„å«ä¹‰ã€‚ æµ®åŠ¨çš„ç¼ºç‚¹å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233&lt;head&gt; &lt;style&gt; .parent &#123; border: solid 5px; width: 300px; &#125; .child:nth-child(1) &#123; height: 100px; width: 100px; background-color: yellow; float: left; &#125; .child:nth-child(2) &#123; height: 100px; width: 100px; background-color: red; float: left; &#125; .child:nth-child(3) &#123; height: 100px; width: 100px; background-color: greenyellow; float: left; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;&lt;/div&gt; &lt;div class=\"child\"&gt;&lt;/div&gt; &lt;div class=\"child\"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt; æˆ‘ä»¬æƒ³è®©çˆ¶å®¹å™¨åŒ…è£¹ç€ä¸‰ä¸ªæµ®åŠ¨å…ƒç´ ï¼Œç„¶è€Œäº‹ä¸æ„¿è¿ï¼Œå¾—åˆ°å´æ˜¯è¿™æ ·çš„ç»“æœï¼šè¿™å°±æ˜¯æµ®åŠ¨å¸¦æ¥å‰¯ä½œç”¨â€”-çˆ¶å®¹å™¨é«˜åº¦å¡Œé™·ï¼Œäºæ˜¯æ¸…ç†æµ®åŠ¨å°±æ˜¾ç€è‡³å…³é‡è¦ã€‚ æ¸…ç†æµ®åŠ¨æ¸…é™¤æµ®åŠ¨ä¸æ˜¯ä¸ç”¨æµ®åŠ¨ï¼Œæ˜¯æ¸…é™¤æµ®åŠ¨äº§ç”Ÿçš„çˆ¶å®¹å™¨é«˜åº¦å¡Œé™·ã€‚ å¥—è·¯ 1ï¼šç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ æ·»åŠ é«˜åº¦ï¼ˆæ‰©å±•æ€§ä¸å¥½ï¼‰å¦‚æœä¸€ä¸ªå…ƒç´ è¦æµ®åŠ¨ï¼Œé‚£ä¹ˆå®ƒçš„çˆ¶å…ƒç´ ä¸€å®šè¦æœ‰é«˜åº¦ã€‚é«˜åº¦çš„ç›’å­ï¼Œæ‰èƒ½å…³ä½æµ®åŠ¨ã€‚å¯ä»¥é€šè¿‡ç›´æ¥ç»™çˆ¶å…ƒç´ è®¾ç½® heightï¼Œå®é™…åº”ç”¨ä¸­æˆ‘ä»¬ä¸å¤§å¯èƒ½ç»™æ‰€æœ‰çš„ç›’å­åŠ é«˜åº¦ï¼Œä¸ä»…éº»çƒ¦ï¼Œå¹¶ä¸”ä¸èƒ½é€‚åº”é¡µé¢çš„å¿«é€Ÿå˜åŒ–ï¼›å¦å¤–ä¸€ç§ï¼Œçˆ¶å®¹å™¨çš„é«˜åº¦å¯ä»¥é€šè¿‡å†…å®¹æ’‘å¼€ï¼ˆæ¯”å¦‚ img å›¾ç‰‡ï¼‰ï¼Œå®é™…å½“ä¸­æ­¤æ–¹æ³•ç”¨çš„æ¯”è¾ƒå¤šã€‚ å¥—è·¯ 2ï¼šclear:both;åœ¨æœ€åä¸€ä¸ªå­å…ƒç´ åæ–°æ·»åŠ ä¸€ä¸ªå†—ä½™å…ƒç´ ï¼Œç„¶åå°†å…¶è®¾ç½® clear:both,è¿™æ ·å°±å¯ä»¥æ¸…é™¤æµ®åŠ¨ã€‚è¿™é‡Œå¼ºè°ƒä¸€ç‚¹ï¼Œå³åœ¨çˆ¶çº§å…ƒç´ æœ«å°¾æ·»åŠ çš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå—çº§å…ƒç´ ï¼Œå¦åˆ™æ— æ³•æ’‘èµ·çˆ¶çº§å…ƒç´ é«˜åº¦ã€‚ 1234&lt;div id=\"wrap\"&gt; &lt;div id=\"inner\"&gt;&lt;/div&gt; &lt;div style=\"clear: both;\"&gt;&lt;/div&gt;&lt;/div&gt; 123456789#wrap &#123; border: 1px solid;&#125;#inner &#123; float: left; width: 200px; height: 200px; background: pink;&#125; å¥—è·¯ 3ï¼šä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨ä¸Šé¢é‚£ç§åŠæ³•å›ºç„¶å¯ä»¥æ¸…é™¤æµ®åŠ¨ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³åœ¨é¡µé¢ä¸­æ·»åŠ è¿™äº›æ²¡æœ‰æ„ä¹‰çš„å†—ä½™å…ƒç´ ï¼Œæ­¤æ—¶å¦‚ä½•æ¸…é™¤æµ®åŠ¨å—ï¼Ÿç»“åˆ :after ä¼ªå…ƒç´ å’Œ IEhack ï¼Œå¯ä»¥å®Œç¾å…¼å®¹å½“å‰ä¸»æµçš„å„å¤§æµè§ˆå™¨ï¼Œè¿™é‡Œçš„ IEhack æŒ‡çš„æ˜¯è§¦å‘ hasLayoutã€‚ 123&lt;div id=\"wrap\" class=\"clearfix\"&gt; &lt;div id=\"inner\"&gt;&lt;/div&gt;&lt;/div&gt; 12345678910111213141516171819202122#wrap &#123; border: 1px solid;&#125;#inner &#123; float: left; width: 200px; height: 200px; background: pink;&#125;/*å¼€å¯haslayout*/.clearfix &#123; *zoom: 1;&#125;/*ie6 7ä¸æ”¯æŒä¼ªå…ƒç´ */.clearfix:after &#123; content: \"\"; display: block; clear: both; height: 0; line-height: 0; visibility: hidden; //å…è®¸æµè§ˆå™¨æ¸²æŸ“å®ƒï¼Œä½†æ˜¯ä¸æ˜¾ç¤ºå‡ºæ¥&#125; ç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å®¹å™¨æ·»åŠ ä¸€ä¸ª clearfix çš„ classï¼Œç„¶åç»™è¿™ä¸ª class æ·»åŠ ä¸€ä¸ª:after ä¼ªå…ƒç´ ï¼Œå®ç°å…ƒç´ æœ«å°¾æ·»åŠ ä¸€ä¸ªçœ‹ä¸è§çš„å—å…ƒç´ æ¥æ¸…ç†æµ®åŠ¨ã€‚è¿™æ˜¯é€šç”¨çš„æ¸…ç†æµ®åŠ¨æ–¹æ¡ˆï¼Œæ¨èä½¿ç”¨ å¥—è·¯ 4ï¼šç»™çˆ¶å…ƒç´ ä½¿ç”¨ overflow:hidden;è¿™ç§æ–¹æ¡ˆè®©çˆ¶å®¹å™¨å½¢æˆäº† BFCï¼ˆå—çº§æ ¼å¼ä¸Šä¸‹æ–‡ï¼‰ï¼Œè€Œ BFC å¯ä»¥åŒ…å«æµ®åŠ¨ï¼Œé€šå¸¸ç”¨æ¥è§£å†³æµ®åŠ¨çˆ¶å…ƒç´ é«˜åº¦åå¡Œçš„é—®é¢˜ã€‚ BFC çš„è§¦å‘æ–¹å¼ æˆ‘ä»¬å¯ä»¥ç»™çˆ¶å…ƒç´ æ·»åŠ ä»¥ä¸‹å±æ€§æ¥è§¦å‘ BFCï¼š float ä¸º left | right overflow ä¸º hidden | auto | scorll display ä¸º table-cell | table-caption | inline-block position ä¸º absolute | fixed è¿™é‡Œå¯ä»¥ç»™çˆ¶å…ƒç´ è®¾ç½® overflow:autoï¼Œä½†æ˜¯ä¸ºäº†å…¼å®¹ IE æœ€å¥½ä½¿ç”¨ overflow:hiddenã€‚ ä½†è¿™ç§åŠæ³•æœ‰ä¸ªç¼ºé™·ï¼šå¦‚æœæœ‰å†…å®¹å‡ºäº†ç›’å­ï¼Œç”¨è¿™ç§æ–¹æ³•å°±ä¼šæŠŠå¤šçš„éƒ¨åˆ†è£åˆ‡æ‰ï¼Œæ‰€ä»¥è¿™æ—¶å€™ä¸èƒ½ä½¿ç”¨ã€‚ BFC çš„ä¸»è¦ç‰¹å¾: BFC å®¹å™¨æ˜¯ä¸€ä¸ªéš”ç¦»çš„å®¹å™¨ï¼Œå’Œå…¶ä»–å…ƒç´ äº’ä¸å¹²æ‰°ï¼›æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨è§¦å‘ä¸¤ä¸ªå…ƒç´ çš„ BFC æ¥è§£å†³å‚ç›´è¾¹è·æŠ˜å é—®é¢˜ã€‚ BFC ä¸ä¼šé‡å æµ®åŠ¨å…ƒç´  BFC å¯ä»¥åŒ…å«æµ®åŠ¨,è¿™å¯ä»¥æ¸…é™¤æµ®åŠ¨ã€‚ å¥—è·¯ 5ï¼šbr æ ‡ç­¾æ¸…æµ®åŠ¨br æ ‡ç­¾å­˜åœ¨ä¸€ä¸ªå±æ€§ï¼šclearã€‚è¿™ä¸ªå±æ€§å°±æ˜¯èƒ½å¤Ÿæ¸…é™¤æµ®åŠ¨çš„åˆ©å™¨ï¼Œåœ¨ br æ ‡ç­¾ä¸­è®¾ç½®å±æ€§ clearï¼Œå¹¶èµ‹å€¼ allã€‚å³èƒ½æ¸…é™¤æ‰æµ®åŠ¨ã€‚ 1234&lt;div id=\"wrap\"&gt; &lt;div id=\"inner\"&gt;&lt;/div&gt; &lt;br clear=\"all\" /&gt;&lt;/div&gt; 123456789#wrap &#123; border: 1px solid;&#125;#inner &#123; float: left; width: 200px; height: 200px; background: pink;&#125;","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"æ¸…é™¤æµ®åŠ¨","slug":"æ¸…é™¤æµ®åŠ¨","permalink":"http://yoursite.com/tags/æ¸…é™¤æµ®åŠ¨/"}]},{"title":"git mergeå’Œgit rebaseçš„åŒºåˆ«","slug":"git mergeå’Œgit rebaseçš„åŒºåˆ«","date":"2019-09-21T14:53:17.000Z","updated":"2019-09-21T14:54:12.854Z","comments":true,"path":"2019/09/21/git mergeå’Œgit rebaseçš„åŒºåˆ«/","link":"","permalink":"http://yoursite.com/2019/09/21/git mergeå’Œgit rebaseçš„åŒºåˆ«/","excerpt":"","text":"git mergeå’Œgit rebaseçš„åŒºåˆ«git rebase å’Œ git merge ä¸€æ ·éƒ½æ˜¯ç”¨äºä»ä¸€ä¸ªåˆ†æ”¯è·å–å¹¶ä¸”åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ï¼Œä½†æ˜¯ä»–ä»¬é‡‡å–ä¸åŒçš„å·¥ä½œæ–¹å¼ã€‚ ä¸ºäº†å°†master ä¸Šæ–°çš„æäº¤åˆå¹¶åˆ°ä½ çš„featureåˆ†æ”¯ä¸Šï¼Œä½ æœ‰ä¸¤ç§é€‰æ‹©ï¼šmerging or rebase mergeæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 12git checkout featuregit merge master æˆ– 1git merge master feature é‚£ä¹ˆæ­¤æ—¶åœ¨featureä¸Šgit è‡ªåŠ¨ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„commit(merge commit) git merge æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š åªå¤„ç†ä¸€æ¬¡å†²çªï¼Œå¦‚æœåˆå¹¶çš„æ—¶å€™é‡åˆ°å†²çªï¼Œä»…éœ€è¦ä¿®æ”¹åé‡æ–°commit å¼•å…¥äº†ä¸€æ¬¡åˆå¹¶çš„å†å²è®°å½•ï¼Œåˆå¹¶åçš„æ‰€æœ‰ commit ä¼šæŒ‰ç…§æäº¤æ—¶é—´ä»æ—§åˆ°æ–°æ’åˆ— æ‰€æœ‰çš„è¿‡ç¨‹ä¿¡æ¯æ›´å¤šï¼Œå¯èƒ½ä¼šæé«˜ä¹‹åæŸ¥æ‰¾é—®é¢˜çš„éš¾åº¦ ä¼˜ç‚¹ï¼šè®°å½•äº†çœŸå®çš„commitæƒ…å†µï¼ŒåŒ…æ‹¬æ¯ä¸ªåˆ†æ”¯çš„è¯¦æƒ… ç¼ºç‚¹ï¼šå› ä¸ºæ¯æ¬¡mergeä¼šè‡ªåŠ¨äº§ç”Ÿä¸€ä¸ªmerge commitï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¸€äº›git çš„GUI toolsï¼Œç‰¹åˆ«æ˜¯commitæ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œçœ‹åˆ°åˆ†æ”¯å¾ˆæ‚ä¹±ã€‚ rebaseä¸ git merge ä¸€è‡´ï¼Œgit rebase çš„ç›®çš„ä¹Ÿæ˜¯å°†ä¸€ä¸ªåˆ†æ”¯çš„æ›´æ”¹å¹¶å…¥åˆ°å¦å¤–ä¸€ä¸ªåˆ†æ”¯ä¸­å»ã€‚ 12git checkout featuregit rebase master æœ¬è´¨æ˜¯å˜åŸº å˜åŸº å˜åŸº å˜åŸºæ˜¯ä»€ä¹ˆ? æ‰¾å…¬å…±ç¥–å…ˆ rebase ç‰¹ç‚¹ï¼š æ”¹å˜å½“å‰åˆ†æ”¯ä» masterä¸Šæ‹‰å‡ºåˆ†æ”¯çš„ä½ç½® æ²¡æœ‰å¤šä½™çš„åˆå¹¶å†å²çš„è®°å½•ï¼Œä¼šåˆå¹¶ä¹‹å‰çš„commitå†å²ï¼Œä¸”åˆå¹¶åçš„ commité¡ºåºä¸ä¸€å®šæŒ‰ç…§ commitçš„æäº¤æ—¶é—´æ’åˆ— å¯èƒ½ä¼šå¤šæ¬¡è§£å†³åŒä¸€ä¸ªåœ°æ–¹çš„å†²çªï¼ˆæœ‰ squashæ¥è§£å†³ï¼‰ æ›´æ¸…çˆ½ä¸€äº›ï¼Œmasteråˆ†æ”¯ä¸Šæ¯ä¸ª commitç‚¹éƒ½æ˜¯ç›¸å¯¹ç‹¬ç«‹å®Œæ•´çš„åŠŸèƒ½å•å…ƒ ä¼˜ç‚¹ï¼šå¾—åˆ°æ›´ç®€æ´çš„é¡¹ç›®å†å²ï¼Œå»æ‰äº†merge commit ç¼ºç‚¹ï¼šå¦‚æœåˆå¹¶å‡ºç°ä»£ç é—®é¢˜ä¸å®¹æ˜“å®šä½ï¼Œå› ä¸ºrewriteäº†history åˆå¹¶æ—¶é‡åˆ°å†²çªï¼šåˆå¹¶æ—¶å¦‚æœå‡ºç°å†²çªéœ€è¦æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤è§£å†³ ä¿®æ”¹å†²çªéƒ¨åˆ† git add git rebase --continue ï¼ˆå¦‚æœç¬¬ä¸‰æ­¥æ— æ•ˆå¯ä»¥æ‰§è¡Œ git rebase --skipï¼‰ ä¸è¦åœ¨git add ä¹‹åä¹ æƒ¯æ€§çš„æ‰§è¡Œ git commitå‘½ä»¤ git rebase çš„äº¤äº’æ¨¡å¼æ‰“å¼€å˜åŸºçš„äº¤äº’æ¨¡å¼åªéœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•° -i å³å¯ï¼ŒåŒæ—¶è¿˜éœ€è¦æŒ‡å®šå¯¹å“ªäº›æäº¤è¿›è¡Œå¤„ç† 1git rebase -i HEAD~4 ä¸Šè¿°å‘½ä»¤æŒ‡å®šäº†å¯¹å½“å‰åˆ†æ”¯çš„æœ€è¿‘å››æ¬¡æäº¤è¿›è¡Œæ“ä½œã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢è¿™è¡Œå‘½ä»¤å°† feature åˆ†æ”¯çš„æäº¤åˆå¹¶ã€‚ ä¸­é—´çº¢æ¡†å†…æœ‰ä¸€äº›å‘½ä»¤ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†æŸæ¬¡æäº¤çš„ æ€»ç»“ å¦‚æœä½ æƒ³è¦ä¸€ä¸ªå¹²å‡€çš„ï¼Œæ²¡æœ‰merge commitçš„çº¿æ€§å†å²æ ‘ï¼Œæˆ–è€…å½“å‘ç°è‡ªå·±ä¿®æ”¹æŸä¸ªåŠŸèƒ½æ—¶ï¼Œé¢‘ç¹è¿›è¡Œäº†git commitæäº¤æ—¶ï¼Œå‘ç°å…¶å®è¿‡å¤šçš„æäº¤ä¿¡æ¯æ²¡æœ‰å¿…è¦æ—¶ï¼Œé‚£ä¹ˆä½ åº”è¯¥é€‰æ‹©git rebase å½“éœ€è¦ä¿ç•™è¯¦ç»†çš„åˆå¹¶ä¿¡æ¯çš„æ—¶å€™å»ºè®®ä½¿ç”¨git mergeï¼Œç‰¹åˆ«æ˜¯éœ€è¦å°†åˆ†æ”¯åˆå¹¶è¿›å…¥masteråˆ†æ”¯æ—¶ï¼Œå¹¶ä¸”æƒ³è¦é¿å…é‡å†™commit historyçš„é£é™©ï¼Œä½ åº”è¯¥é€‰æ‹©ä½¿ç”¨git merge","categories":[{"name":"git","slug":"git","permalink":"http://yoursite.com/categories/git/"}],"tags":[{"name":"git","slug":"git","permalink":"http://yoursite.com/tags/git/"}]},{"title":"æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶","slug":"æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶","date":"2019-09-14T15:14:44.000Z","updated":"2019-11-10T14:37:39.038Z","comments":true,"path":"2019/09/14/æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶/","link":"","permalink":"http://yoursite.com/2019/09/14/æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶/","excerpt":"","text":"æµè§ˆå™¨åŒåŸŸåè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°é™åˆ¶å½“æˆ‘ä»¬åœ¨æµè§ˆç½‘é¡µçš„æ—¶å€™ï¼Œå¯¹æµè§ˆé€Ÿåº¦æœ‰ä¸€ä¸ªé‡è¦çš„å½±å“å› ç´ ï¼Œå°±æ˜¯æµè§ˆå™¨çš„å¹¶å‘æ•°é‡ã€‚å¹¶å‘æ•°é‡ç®€å•é€šä¿—çš„è®²å°±æ˜¯ï¼Œå½“æµè§ˆå™¨ç½‘é¡µçš„æ—¶å€™åŒæ—¶å·¥ä½œçš„è¿›è¡Œæ•°é‡ã€‚ å¦‚æœåŒæ—¶åªæœ‰ 2 ä¸ªå¹¶å‘è¿æ¥æ•°æ•°é‡ï¼Œé‚£ç½‘é¡µæ‰“å¼€çš„æ—¶å€™åªèƒ½ä¾èµ–äºè¿™ 2 æ¡çº¿ç¨‹ï¼Œå‰é¢å¦‚æœæœ‰æ‰“å¼€æ…¢çš„å†…å®¹ï¼Œå°±ä¼šç›´æ¥å½±å“åˆ°åé¢çš„å†…å®¹æ‰“å¼€ã€‚ä½†æ˜¯å¦‚æœåŒæ—¶æœ‰æ›´å¤šçš„å¹¶å‘è¿æ¥æ•°ï¼Œè¿™æ ·å°±ä¼šå¤§å¤§çš„æé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦ã€‚ä½†æ˜¯æµè§ˆå™¨çš„å¹¶å‘è¿æ¥æ•°ä¹Ÿå¹¶éè¶Šå¤§è¶Šå¥½ã€‚ HTTP å®¢æˆ·ç«¯ä¸€èˆ¬å¯¹åŒä¸€ä¸ªæœåŠ¡å™¨çš„å¹¶å‘è¿æ¥ä¸ªæ•°éƒ½æ˜¯æœ‰é™åˆ¶çš„ã€‚å®é™…ä¸Šï¼Œæµè§ˆå™¨ç¡®å®ä½¿ç”¨å¹¶è¡Œè¿æ¥ï¼Œä½†å®ƒä»¬å°†å¹¶è¡Œè¿æ¥çš„æ€»æ•°é™åˆ¶ä¸ºå°‘é‡ï¼ˆé€šå¸¸ä¸ºå››ä¸ªï¼‰ã€‚æœåŠ¡å™¨å¯ä»¥è‡ªç”±åœ°å…³é—­æ¥è‡ªç‰¹å®šå®¢æˆ·ç«¯çš„è¿‡å¤šè¿æ¥ã€‚ ä¸»æµæµè§ˆå™¨æœ€å¤§å¹¶å‘è¿æ¥æ•°ä¸€äº›ä¸»æµæµè§ˆå™¨å¯¹ HTTP 1.1 å’Œ HTTP 1.0 çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°ç›®ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹è¡¨æ ¼ï¼š æµè§ˆå™¨ HTTP / 1.1 HTTP / 1.0 IE 11 6 6 IE 10 6 6 IE 9 10 10 IE 8 6 6 IE 6,7 2 4 ç«ç‹ 6 6 Safari 3,4 4 4 Chrome 4+ 6 6 æ­Œå‰§ 9.63,10.00alpha 4 4 Opera 10.51+ 8 ï¼Ÿ iPhone 2 4 ï¼Ÿ iPhone 3 6 ï¼Ÿ iPhone 4 4 ï¼Ÿ iphone 5 6 ï¼Ÿ Android2-4 4 ï¼Ÿ Firefox æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°åœ¨ Firefox ä¸­çš„åœ°å€æ è¾“å…¥â€œaboutï¼šconfig ä¸­â€ï¼Œç„¶åæœç´¢å¹¶ä¿®æ”¹å¦‚ä¸‹ä¸¤ä¸ªé…ç½®é¡¹ç›®å³å¯ï¼š network.http.max-persistent-connections-per-server:6è¿æ¥åŒä¸€ä¸ªæœåŠ¡å™¨å…è®¸çš„æœ€å¤§æŒä¹…è¿æ¥æ•°ï¼Œé»˜è®¤ä¸º 6ï¼Œå¯ä»¥ä¸ç”¨æ›´æ”¹ã€‚ network.http.max-persistent-connections-per-proxy:8æ¯ä¸ªä»£ç†æœåŠ¡å™¨å…è®¸çš„æœ€å¤§æŒä¹…è¿æ¥æ•°,å…¬å¸ç”¨æˆ·ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œä½†æ˜¯å¤–é¢çš„å®¢æˆ·ä¸€èˆ¬ä¸ä½¿ç”¨ä»£ç†ï¼Œç«ç‹æ¨èçš„æ¯å°ä»£ç†æœåŠ¡å™¨è®¾ç½®ä¸ºï¼š&lt;= 10ã€‚ Firefox3.6 å’Œ IE8 çš„å‡ ä¹å®Œå…¨ä¸€æ ·ï¼š æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°ä¸º 6 ä¸ªï¼ˆå¯åœ¨ about:config ä¸­ä¿®æ”¹ï¼‰ã€‚ javascript æ–‡ä»¶ä¸ä¼šé˜»å¡å…¶ä»–èµ„æºçš„åŠ è½½ï¼Œå¤šä¸ª javascript æ–‡ä»¶å¯ä»¥ä¸€èµ·åŠ è½½ã€‚ ä¼šåˆ†æ HTML ç»“æ„ï¼Œä¼˜å…ˆä¸‹è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºã€‚ Firefox4 beta12 ä¸çŸ¥æ˜¯å› ä¸ºè®¾è®¡ç†å¿µä¸Šçš„ä¸åŒï¼Œè¿˜æ˜¯å› ä¸º beta ç‰ˆæœªç…§é¡¾åˆ°è¿™ä¸€å—ï¼ŒFirefox4 åè€Œé€€åŒ–äº†ï¼Œå’Œ Firefox3.6 çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å¯¹èµ„æºç±»å‹çš„å¤„ç†ä¸Šï¼ŒFirefox4 ä¸å†ä¸¥æ ¼åœ°ä¼˜å…ˆä¸‹è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºï¼Œè€Œæ˜¯æŒ‰ç…§ HTML ç»“æ„ä¸­å‡ºç°çš„é¡ºåºæ¥è¿›è¡ŒåŠ è½½ã€‚ IE æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°ç”¨â€œæ³¨å†Œè¡¨ç¼–è¾‘å™¨â€å‘½ä»¤æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼Œæ‰¾åˆ°ï¼š [HKEY_CURRRENT_USER \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings]ï¼Œå¯ä»¥çœ‹åˆ°MaxConnectionsPerServerå’ŒMaxConnectionsPer1_0Serverè¿™ä¸¤ä¸ªé”®ï¼ˆåˆ†åˆ«æ˜¯é’ˆå¯¹ HTTP 1.1 å’Œ HTTP 1.0 çš„è®¾ç½®ï¼‰ å¯¹äº IE 9 [HKEY_CURRRENT_USER \\ Software \\ Policies \\ Microsoft \\ Internet Exploer \\ Main \\ FeatureControlï¼Œå¯ä»¥çœ‹åˆ°FEATURE_MAXCONNECTIONSPER1_0SERVERå’ŒFEATURE_MAXCONNECTIONSPERSERVERè¿™ä¸¤ä¸ªé”®ï¼ˆåˆ†åˆ«æ˜¯é’ˆå¯¹ HTTP 1.1 å’Œ HTTP 1.0 çš„è®¾ç½®ï¼‰ IE8 å’Œ IE6 å®Œå…¨ä¸åŒçš„ç€‘å¸ƒå›¾ï¼Œå…¶ç‰¹ç‚¹æœ‰ï¼š æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°ä¸º 6 ä¸ªã€‚ javascript æ–‡ä»¶å·²ç»ä¸ä¼šé˜»å¡å…¶ä»–èµ„æºçš„åŠ è½½ï¼Œç”šè‡³å¤šä¸ª javascript æ–‡ä»¶å¯ä»¥ä¸€èµ·åŠ è½½ï¼Œå¹¶ä¸”ä¼šä¿è¯æ‰§è¡Œçš„é¡ºåºã€‚ ä¼šåˆ†æ HTML ç»“æ„ï¼Œä¼˜å…ˆä¸‹è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºã€‚ chrome æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°Chrome8 Chrome è‡ªå¸¦çš„å·¥å…·ä¸èƒ½å¾ˆæ¸…æ¥šåœ°è¡¨ç¤ºå„è¯·æ±‚çš„å¼€å§‹æ—¶é—´ï¼Œæ‰€ä»¥ä½¿ç”¨äº† Fiddler çš„ç€‘å¸ƒå›¾ï¼Œä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒChrome ä¹Ÿæ˜¯æ¯”è¾ƒç‰¹ç«‹ç‹¬è¡Œçš„ä¸€ä½ï¼Œå…¶ç‰¹ç‚¹æœ‰ï¼š æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°ä¸º 6ã€‚ head éƒ¨åˆ†çš„èµ„æºä¼šå•ç‹¬ä¸‹è½½ï¼Œä¸”é˜»å¡ body ä¸­çš„å…¶ä»–èµ„æºçš„åŠ è½½ã€‚ ä¼šä¼˜å…ˆåŠ è½½ script å’Œ link æ ‡ç­¾å®šä¹‰çš„èµ„æºã€‚ opera æµè§ˆå™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°Opera11 å…ˆæŠ¥æ€¨ä¸€ä¸‹ï¼ŒDragonfly ä¸æ€ä¹ˆå¥½ç”¨æ¥ç€â€¦â€¦Opera çš„èµ„æºåŠ è½½ä¹Ÿæ¯”è¾ƒæœ‰ç‰¹è‰²ï¼Œè€Œä¸”å¾ˆéš¾çœ‹å‡ºè§„å¾‹ï¼Œåªèƒ½å¤§è‡´æ€»ç»“ä¸€ä¸‹ï¼š Opera çš„æœ€å¤§å¹¶å‘ HTTP è¿æ¥æ•°é»˜è®¤ä¸º 16ï¼Œå¯åœ¨ opera:config - Performance - Max Connections Server æŸ¥çœ‹å’Œä¿®æ”¹ã€‚ javascript æ–‡ä»¶çš„åŠ è½½ä¼šé˜»å¡å…¶ä»– script å’Œ link æ ‡ç­¾å®šä¹‰çš„å¤–éƒ¨èµ„æºçš„åŠ è½½ï¼Œå¦‚å›¾ä¸­çš„ 2.jsã€‚ä½†ä¸ä¼šé˜»å¡å›¾ç‰‡ç­‰å…¶ä»–èµ„æºçš„åŠ è½½ï¼Œå¦‚å›¾ä¸­çš„ 3.jsã€‚ ä¼šä¸€å®šç¨‹åº¦ä¸Šå¯¹èµ„æºçš„ä¼˜å…ˆçº§è¿›è¡Œä¼˜åŒ–ï¼Œä½†ç”±äº javascript æ–‡ä»¶è¦é˜»æ­¢åç»­éƒ¨åˆ†èµ„æºçš„åŠ è½½ï¼Œåˆä¸ºäº†å……åˆ†åˆ©ç”¨æœ€å¤§ HTTP è¿æ¥æ•°ï¼Œå› æ­¤ä¸èƒ½ä¸¥æ ¼å…ˆåŠ è½½æ‰€æœ‰çš„ script å’Œ link æ ‡ç­¾å®šä¹‰çš„èµ„æºï¼Œå¯¼è‡´ç€‘å¸ƒå›¾ä¸Šå„ç±»å‹èµ„æºæœ‰ç›¸äº’ç©¿æ’ï¼Œéš¾å¯»è§„å¾‹ã€‚ HTTP è¿æ¥è¯·æ±‚ä¸çº¿ç¨‹HTTP è¿æ¥æ˜¯å¤æ‚ï¼Œæœ‰çŠ¶æ€çš„å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒå¿…é¡»è¢«å¦¥å–„ç®¡ç†ã€‚ä¸€ä¸ª HTTP è¿æ¥è¯·æ±‚åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚ HttpClient ä½¿ç”¨ä¸€ä¸ªå«åšçš„ Http è¿æ¥ç®¡ç†å™¨çš„ç‰¹æ®Šå®ä½“ç±»æ¥ç®¡ç†çš„ Http è¿æ¥ã€‚Http è¿æ¥ç®¡ç†å™¨åœ¨æ–°å»ºçš„ HTTP è¿æ¥æ—¶ï¼Œä½œä¸ºå·¥å‚ç±»ï¼›ç®¡ç†æŒä¹…çš„ http è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸï¼›åŒæ­¥æŒä¹…è¿æ¥ï¼ˆç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œå³ä¸€ä¸ª HTTP è¿æ¥åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼‰ã€‚ å¦‚æœä¸€ä¸ªçš„ Http è¿æ¥è¢«é‡Šæ”¾æˆ–è€…è¢«å®ƒçš„æ¶ˆè´¹è€…æ˜ç¡®è¡¨ç¤ºè¦å…³é—­ï¼Œé‚£ä¹ˆåº•å±‚çš„è¿æ¥å°±ä¼šå’Œå®ƒçš„ä»£ç†è¿›è¡Œåˆ†ç¦»ï¼Œå¹¶ä¸”è¯¥è¿æ¥ä¼šè¢«äº¤è¿˜ç»™è¿æ¥ç®¡ç†å™¨ã€‚è¿™æ˜¯ï¼Œå³ä½¿æœåŠ¡æ¶ˆè´¹è€…ä»ç„¶æŒæœ‰ä»£ç†çš„å¼•ç”¨ï¼Œå®ƒä¹Ÿä¸èƒ½å†æ‰§è¡Œ I / O æ“ä½œï¼Œæˆ–è€…æ›´æ”¹çš„ Http è¿æ¥çš„çŠ¶æ€ã€‚ è¿æ¥æ± ç®¡ç†å™¨è¿æ¥æ± ç®¡ç†å™¨æ˜¯ä¸ªå¤æ‚çš„ç±»ï¼Œå®ƒç®¡ç†ç€è¿æ¥æ± ï¼Œå¯ä»¥åŒæ—¶ä¸ºå¾ˆå¤šçº¿ç¨‹æä¾› HTTP è¿æ¥è¯·æ±‚ã€‚å½“è¯·æ±‚ä¸€ä¸ªæ–°çš„è¿æ¥æ—¶ï¼Œå¦‚æœè¿æ¥æ± æœ‰æœ‰å¯ç”¨çš„æŒä¹…è¿æ¥ï¼Œè¿æ¥ç®¡ç†å™¨å°±ä¼šä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªï¼Œè€Œä¸æ˜¯å†åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ã€‚ å½“ä½¿ç”¨äº†è¯·æ±‚è¿æ¥æ± ç®¡ç†å™¨åï¼ŒHttpClient çš„å°±å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªçº¿ç¨‹çš„è¯·æ±‚äº†ã€‚ è¿æ¥æ± ç®¡ç†å™¨ä¼šæ ¹æ®å®ƒçš„é…ç½®æ¥åˆ†é…è¯·æ±‚è¿æ¥ã€‚å¦‚æœè¿æ¥æ± ä¸­çš„æ‰€æœ‰è¿æ¥éƒ½è¢«å ç”¨äº†ï¼Œé‚£ä¹ˆåç»­çš„è¯·æ±‚å°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœ‰è¿æ¥è¢«é‡Šæ”¾å›è¿æ¥æ± ä¸­ã€‚ çº¿ç¨‹æ± çš„åŸç†çº¿ç¨‹æ± çš„åŸç†å¾ˆç®€å•ï¼Œç±»ä¼¼äºæ“ä½œç³»ç»Ÿä¸­çš„ç¼“å†²åŒºçš„æ¦‚å¿µï¼Œå®ƒçš„æµç¨‹å¦‚ä¸‹ï¼š çº¿ç¨‹æ± åœ¨è¿˜æ²¡æœ‰ä»»åŠ¡åˆ°æ¥ä¹‹å‰ï¼Œåˆ›å»ºä¸€å®šæ•°é‡çš„çº¿ç¨‹ï¼Œæ”¾å…¥ç©ºé—²é˜Ÿåˆ—ä¸­ã€‚è¿™äº›çº¿ç¨‹éƒ½æ˜¯å¤„äºç¡çœ çŠ¶æ€ï¼Œå³å‡ä¸ºå¯åŠ¨ï¼Œä¸æ¶ˆè€— CPUï¼Œè€Œåªæ˜¯å ç”¨è¾ƒå°çš„å†…å­˜ç©ºé—´ã€‚å½“å®¢æˆ·ç«¯æœ‰ä¸€ä¸ªæ–°è¯·æ±‚æ—¶ï¼Œå°±ä¼šå”¤é†’çº¿ç¨‹æ± ä¸­çš„æŸä¸€ä¸ªç¡çœ çº¿ç¨‹ï¼Œè®©å®ƒæ¥å¤„ç†å®¢æˆ·ç«¯çš„è¿™ä¸ªè¯·æ±‚ï¼Œå½“å¤„ç†å®Œè¿™ä¸ªè¯·æ±‚åï¼Œçº¿ç¨‹åˆå¤„äºç¡çœ çŠ¶æ€ã€‚ çº¿ç¨‹æ± èƒ½èŠ‚çº¦å¤§é‡çš„çš„ç³»ç»Ÿèµ„æºï¼Œä½¿å¾—æ›´å¤šçš„ CPU æ—¶é—´å’Œå†…å­˜ç”¨æ¥å¤„ç†å®é™…çš„å•†ä¸šåº”ç”¨ï¼Œè€Œä¸æ˜¯é¢‘ç¹çš„çº¿ç¨‹åˆ›å»ºä¸é”€æ¯ æ¯ä¸ªçº¿ç¨‹éœ€è¦å¤§çº¦ 1MB å†…å­˜ï¼Œçº¿ç¨‹å¼€çš„è¶Šå¤šï¼Œæ¶ˆè€—çš„å†…å­˜ä¹Ÿå°±è¶Šå¤§ã€‚ åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨çº¿ç¨‹æ± ï¼š å•ä¸ªä»»åŠ¡å¤„ç†çš„æ—¶é—´æ¯”è¾ƒçŸ­ å°†éœ€å¤„ç†çš„ä»»åŠ¡çš„æ•°é‡å¤§ æ•°æ®åº“è¿æ¥æ± æ•°æ®åº“è¿æ¥æ± çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å»ºç«‹è¶³å¤Ÿçš„æ•°æ®åº“è¿æ¥ï¼Œå¹¶è®²è¿™äº›è¿æ¥ç»„æˆä¸€ä¸ªè¿æ¥æ± ï¼ˆç®€å•è¯´ï¼šåœ¨ä¸€ä¸ªâ€œæ± â€é‡Œæ”¾äº†å¥½å¤šåŠæˆå“çš„æ•°æ®åº“è”æ¥å¯¹è±¡ï¼‰ï¼Œç”±åº”ç”¨ç¨‹åºåŠ¨æ€åœ°å¯¹æ± ä¸­çš„è¿æ¥è¿›è¡Œç”³è¯·ï¼Œä½¿ç”¨å’Œé‡Šæ”¾ã€‚å¯¹äºå¤šäºè¿æ¥æ± ä¸­è¿æ¥æ•°çš„å¹¶å‘è¯·æ±‚ï¼Œåº”è¯¥åœ¨è¯·æ±‚é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…ã€‚å¹¶ä¸”åº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®æ± ä¸­è¿æ¥çš„ä½¿ç”¨ç‡ï¼ŒåŠ¨æ€å¢åŠ æˆ–å‡å°‘æ± ä¸­çš„è¿æ¥æ•°ã€‚è¿æ¥æ± æŠ€æœ¯å°½å¯èƒ½å¤šåœ°é‡ç”¨äº†æ¶ˆè€—å†…å­˜åœ°èµ„æºï¼Œå¤§å¤§èŠ‚çœäº†å†…å­˜ï¼Œæé«˜äº†æœåŠ¡å™¨åœ°æœåŠ¡æ•ˆç‡ï¼Œèƒ½å¤Ÿæ”¯æŒæ›´å¤šçš„å®¢æˆ·æœåŠ¡ã€‚é€šè¿‡ä½¿ç”¨è¿æ¥æ± ï¼Œå°†å¤§å¤§æé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶è‡ªèº«çš„ç®¡ç†æœºåˆ¶æ¥ç›‘è§†æ•°æ®åº“è¿æ¥çš„æ•°é‡ï¼Œä½¿ç”¨æƒ…å†µç­‰ã€‚ 1ï¼‰æœ€å°è¿æ¥æ•°æ˜¯è¿æ¥æ± ä¸€ç›´ä¿æŒçš„æ•°æ®åº“è¿æ¥ï¼Œæ‰€ä»¥å¦‚æœåº”ç”¨ç¨‹åºå¯¹æ•°æ®åº“è¿æ¥çš„ä½¿ç”¨é‡ä¸å¤§ï¼Œå°†ä¼šæœ‰å¤§é‡çš„æ•°æ®åº“è¿æ¥èµ„æºè¢«æµªè´¹;2ï¼‰æœ€å¤§è¿æ¥æ•°æ˜¯è¿æ¥æ± èƒ½ç”³è¯·çš„æœ€å¤§è¿æ¥æ•°ï¼Œå¦‚æœæ•°æ®åº“è¿æ¥è¯·æ±‚è¶…è¿‡æ­¤æ•°ï¼Œåé¢çš„æ•°æ®åº“è¿æ¥è¯·æ±‚å°†è¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œè¿™ä¼šå½±å“ä¹‹åçš„æ•°æ®åº“æ“ä½œã€‚ æ•°æ®åº“è¿æ¥æ˜¯ä¸€ç§å…³é”®çš„æœ‰é™çš„æ˜‚è´µçš„èµ„æºï¼Œè¿™ä¸€ç‚¹åœ¨å¤šç”¨æˆ·çš„ç½‘é¡µåº”ç”¨ç¨‹åºä¸­ä½“ç°å¾—å°¤ä¸ºçªå‡ºã€‚ä¸€ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡å‡å¯¹åº”ä¸€ä¸ªç‰©ç†æ•°æ®åº“è¿æ¥ï¼Œæ¯æ¬¡æ“ä½œéƒ½æ‰“å¼€ä¸€ä¸ªç‰©ç†è¿æ¥ï¼Œä½¿ç”¨å®Œéƒ½å…³é—­è¿æ¥ï¼Œè¿™æ ·é€ æˆç³»ç»Ÿçš„æ€§èƒ½ä½ä¸‹ã€‚ WebSphere Application Server æ€§èƒ½http://websphere.sys-con.com/node/46514/print æ„å»ºæœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªè¿‡äºç®€å•çš„æ¨¡å‹æ˜¯ï¼šæ¯å½“ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾å°±åˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡å¯¹è±¡ï¼Œç„¶ååœ¨æ–°çš„æœåŠ¡å¯¹è±¡ä¸­ä¸ºæœåŠ¡è¯·æ±‚ï¼Œä½†å½“æœ‰å¤§é‡è¯·æ±‚å¹¶å‘è®¿é—®æ—¶ï¼ŒæœåŠ¡å™¨ä¸æ–­çš„åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„å¼€é”€å¾ˆå¤§ã€‚ åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆæµªè´¹èµ„æºçš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨ Java çš„ä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºè¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥ï¼Œæé«˜ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°ã€‚åˆ©ç”¨å·²æœ‰çš„å¯¹è±¡æ¥æœåŠ¡å°±æ˜¯â€œæ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚ HTTP ä¾¦å¬å™¨HTTP ä¾¦å¬å™¨è´Ÿè´£åœ¨ HTTP æœåŠ¡å™¨çº§åˆ«åˆ›å»ºçº¿ç¨‹ã€‚è¿™é‡Œå‘ç”Ÿçš„å¤§å¤šæ•°å¤„ç†æ˜¯é™æ€é¡µé¢æœåŠ¡ï¼Œæˆ– HTTP post / GET ä¼ é€’å‘½ä»¤åˆ°åç«¯ã€‚è¿™æ˜¯å¿…é¡»è€ƒè™‘çš„ç¬¬ä¸€çº§çº¿ç¨‹é…ç½®ã€‚ Web å®¹å™¨Web å®¹å™¨è´Ÿè´£åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨çº§åˆ«åˆ›å»ºçº¿ç¨‹æ± ã€‚æ­¤çº§åˆ«çš„å¤§å¤šæ•°å¤„ç†åŒ…æ‹¬ servletï¼ŒJSPï¼ŒEJBï¼ŒåŠ¨æ€é¡µé¢åˆ›å»ºå’Œåç«¯ä¼ é€’å¤„ç†ã€‚Web å®¹å™¨æ˜¯å¿…é¡»é…ç½®çš„ç¬¬äºŒçº§çº¿ç¨‹æ± é…ç½®ã€‚ ORB å®¹å™¨ ORB å®¹å™¨è´Ÿè´£åœ¨å¯¹è±¡çº§åˆ›å»ºçº¿ç¨‹æ± ã€‚è¿™é‡Œå‘ç”Ÿçš„å¤§éƒ¨åˆ†å¤„ç†åŒ…æ‹¬å¤„ç†åŸºäºé Web çš„å®¢æˆ·ç«¯ã€‚ORB å®¹å™¨æ˜¯å¿…é¡»é…ç½®çš„çº¿ç¨‹æ± é…ç½®çš„ç¬¬ä¸‰çº§ã€‚ æ•°æ®æºæ•°æ®æºçº§è´Ÿè´£åˆ›å»ºä»æ•°æ®åº“æˆ–â€œä¼ ç»Ÿâ€ç³»ç»Ÿè®¿é—®çš„è¿æ¥çº¿ç¨‹ã€‚è¿™äº›çº¿ç¨‹æ˜¯å¿…é¡»è§£å†³çš„ç¬¬å››çº§é…ç½® WAS çº¿ç¨‹æ± æ•°ä¸ IHS serverå‡å®šä¸€ä¸ªæµè§ˆå™¨çš„å¹¶å‘è¿æ¥è¯·æ±‚æ•°ä¸º 10ï¼Œé€šå¸¸åŒä¸€æ—¶é—´å†…ä¼šæœ‰å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®ç½‘ç«™ã€‚åˆè€ƒè™‘åˆ°ï¼Œä¸€ä¸ª Http è¿æ¥è¯·æ±‚åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚æ‰€ä»¥ï¼ŒIHS æœåŠ¡å™¨çš„ httpd.conf é‡Œçš„ maxclientsï¼ˆå…è®¸å»ºç«‹çš„æ€»çº¿ç¨‹æ•°ï¼‰è¦èƒ½å¤Ÿå¤„ç†å³°å€¼æ—¶åˆ»çš„æµè§ˆå™¨è¿æ¥è¯·æ±‚æ‰è¡Œã€‚åŒæ—¶ï¼Œè€ƒè™‘ä¸æ˜¯æ‰€æœ‰çš„è¿æ¥è¯·æ±‚éƒ½ä¼šåˆ° was serverï¼Œæœ‰çš„è¿æ¥åªæ˜¯ä¸ºäº†åœ¨ web æœåŠ¡å™¨ä¸Šå–é™æ€èµ„æºï¼Œæ‰€ä»¥ï¼Œwas ä¸Šçš„çº¿ç¨‹æ± æ•°ç›®ï¼ˆThread pools ï¼š50 ï¼‰ä¼šè¿œå°äº IHS server ä¸Šçš„ maxclients å€¼è­¬å¦‚ 400ï¼‰ã€‚","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"}]},{"title":"å‰ç«¯ä¼˜åŒ–","slug":"å‰ç«¯ä¼˜åŒ–","date":"2019-09-08T15:48:15.000Z","updated":"2019-11-10T14:37:39.031Z","comments":true,"path":"2019/09/08/å‰ç«¯ä¼˜åŒ–/","link":"","permalink":"http://yoursite.com/2019/09/08/å‰ç«¯ä¼˜åŒ–/","excerpt":"","text":"å‰ç«¯ä¼˜åŒ–å‰ç«¯æ€§èƒ½è¡¡é‡æŒ‡æ ‡ ç™½å±æ—¶é—´ è¯¥æ—¶é—´ç‚¹è¡¨ç¤ºæµè§ˆå™¨å¼€å§‹ç»˜åˆ¶é¡µé¢ï¼Œåœ¨æ­¤ä¹‹å‰é¡µé¢éƒ½æ˜¯ç™½å±ï¼Œä¹Ÿç§°ä¸ºå¼€å§‹æ¸²æŸ“æ—¶é—´ é¦–å±æ—¶é—´ è¯¥æ—¶é—´ç‚¹è¡¨ç¤ºç”¨æˆ·çœ‹åˆ°ç¬¬ä¸€å±é¡µé¢çš„æ—¶é—´ ç”¨æˆ·å¯äº¤äº’æ—¶é—´ ä¹Ÿå« DOM Ready,è¯¥æ—¶é—´ç‚¹è¡¨ç¤º DOM è§£æå®Œæˆï¼Œèµ„æºè¿˜æ²¡æœ‰å®Œæˆï¼Œè¿™ä¸ªæ—¶å€™ç”¨æˆ·ä¸é¡µé¢å¯ä»¥äº¤äº’äº† å®Œå…¨åŠ è½½æ—¶é—´ è¯¥æ—¶é—´ç‚¹æ˜¯ window.onload æ—¶é—´è§¦å‘çš„æ—¶é—´ï¼Œè¡¨ç¤ºåŸå§‹æ–‡æ¡£å’Œæ‰€ç”¨å¼•ç”¨çš„å†…å®¹å·²ç»åŠ è½½å®Œæˆï¼Œç”¨æˆ·æœ€æ˜æ˜¾çš„æ„Ÿè§‰å°±æ˜¯æµè§ˆå™¨ tab ä¸Š loading çŠ¶æ€ç»“æŸ é¦–å­—èŠ‚æ—¶é—´ï¼ˆTTFBï¼‰ ç¬¬ä¸€å­—èŠ‚å“åº”æ—¶é—´ï¼ˆTTFBï¼‰=å‘é€è¯·æ±‚åˆ° WEB æœåŠ¡å™¨çš„æ—¶é—´+WEB æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶ç”Ÿæˆå“åº”èŠ±è´¹çš„æ—¶é—´+WEB æœåŠ¡å™¨ç”Ÿæˆå“åº”åˆ°æµè§ˆå™¨èŠ±è´¹çš„æ—¶é—´ DNS è§£ææ—¶é—´ TCP è¿æ¥æ—¶é—´ HTTP è¯·æ±‚æ—¶é—´ HTTP å“åº”æ—¶é—´ ä¼˜åŒ–åŸåˆ™é›…è™ 14 æ¡ä¼˜åŒ–åŸåˆ™ï¼š å°½å¯èƒ½çš„å‡å°‘ HTTP çš„è¯·æ±‚æ•° content ä½¿ç”¨ CDNï¼ˆContent Delivery Networkï¼‰ server æ·»åŠ  Expires å¤´(æˆ–è€… Cache-control ) server Gzip ç»„ä»¶ server å°† CSS æ ·å¼æ”¾åœ¨é¡µé¢çš„ä¸Šæ–¹ css å°†è„šæœ¬ç§»åŠ¨åˆ°åº•éƒ¨ï¼ˆåŒ…æ‹¬å†…è”çš„ï¼‰ javascript é¿å…ä½¿ç”¨ CSS ä¸­çš„ Expressions css å°† JavaScript å’Œ CSS ç‹¬ç«‹æˆå¤–éƒ¨æ–‡ä»¶ javascript css å‡å°‘ DNS æŸ¥è¯¢ content å‹ç¼© JavaScript å’Œ CSS (åŒ…æ‹¬å†…è”çš„) javascript css é¿å…é‡å®šå‘ server ç§»é™¤é‡å¤çš„è„šæœ¬ javascript é…ç½®å®ä½“æ ‡ç­¾ï¼ˆETagsï¼‰ css ä½¿ AJAX ç¼“å­˜ ä¼˜åŒ–æ–¹å‘ ä¼˜åŒ–æ‰‹æ®µ è¯·æ±‚æ•°é‡ åˆå¹¶è„šæœ¬å’Œæ ·å¼è¡¨ï¼ŒCSS Spritesï¼Œæ‹†åˆ†åˆå§‹åŒ–è´Ÿè½½ï¼Œåˆ’åˆ†ä¸»åŸŸï¼Œå­—ä½“å›¾æ ‡ï¼Œé›ªç¢§å›¾ç‰‡ç­‰ è¯·æ±‚å¸¦å®½ å¼€å¯æœåŠ¡å™¨ GZipï¼Œç²¾ç®€ JavaScriptï¼Œç§»é™¤é‡å¤è„šæœ¬ï¼Œå›¾åƒä¼˜åŒ–ï¼ˆåŒ…æ‹¬å›¾ç‰‡å¤§å° kbï¼‰ ç¼“å­˜åˆ©ç”¨ ä½¿ç”¨ CDNï¼Œä½¿ç”¨å¤–éƒ¨ JavaScript å’Œ CSSï¼Œæ·»åŠ  Expires å¤´ï¼Œå‡å°‘ DNS æŸ¥æ‰¾ï¼Œé…ç½® ETagï¼Œä½¿ AjaX å¯ç¼“å­˜ é¡µé¢ç»“æ„ å°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ï¼Œå°†è„šæœ¬æ”¾åœ¨åº•éƒ¨ï¼Œå°½æ—©åˆ·æ–°æ–‡æ¡£çš„è¾“å‡º ä»£ç æ ¡éªŒ é¿å… CSS è¡¨è¾¾å¼ï¼Œé¿å…é‡å®šå‘ ç½‘ç»œç›¸å…³DNS é¢„è§£æDNS è§£æä¹Ÿæ˜¯éœ€è¦æ—¶é—´çš„ï¼Œå¯ä»¥é€šè¿‡é¢„è§£æçš„æ–¹å¼æ¥é¢„å…ˆè·å¾—åŸŸåæ‰€å¯¹åº”çš„ IPã€‚ 1&lt;link rel=\"dns-prefetch\" href=\"//yuchengkai.cn\" /&gt; åˆ©ç”¨ç¼“å­˜ç¼“å­˜å¯¹äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–æ¥è¯´æ˜¯ä¸ªå¾ˆé‡è¦çš„ç‚¹ï¼Œè‰¯å¥½çš„ç¼“å­˜ç­–ç•¥å¯ä»¥é™ä½èµ„æºçš„é‡å¤åŠ è½½æé«˜ç½‘é¡µçš„æ•´ä½“åŠ è½½é€Ÿåº¦ã€‚ é€šå¸¸æµè§ˆå™¨ç¼“å­˜ç­–ç•¥åˆ†ä¸ºä¸¤ç§ï¼šå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥å¯¹äºå¤§éƒ¨åˆ†çš„åœºæ™¯éƒ½å¯ä»¥ä½¿ç”¨å¼ºç¼“å­˜é…åˆåå•†ç¼“å­˜è§£å†³ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç‰¹æ®Šçš„åœ°æ–¹å¯èƒ½éœ€è¦é€‰æ‹©ç‰¹æ®Šçš„ç¼“å­˜ç­–ç•¥ å¯¹äºæŸäº›ä¸éœ€è¦ç¼“å­˜çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ Cache-control: no-store ï¼Œè¡¨ç¤ºè¯¥èµ„æºä¸éœ€è¦ç¼“å­˜ å¯¹äºé¢‘ç¹å˜åŠ¨çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ Cache-Control: no-cache å¹¶é…åˆ ETag ä½¿ç”¨ï¼Œè¡¨ç¤ºè¯¥èµ„æºå·²è¢«ç¼“å­˜ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½ä¼šå‘é€è¯·æ±‚è¯¢é—®èµ„æºæ˜¯å¦æ›´æ–°ã€‚ å¯¹äºä»£ç æ–‡ä»¶æ¥è¯´ï¼Œé€šå¸¸ä½¿ç”¨ Cache-Control: max-age=31536000 å¹¶é…åˆç­–ç•¥ç¼“å­˜ä½¿ç”¨ï¼Œç„¶åå¯¹æ–‡ä»¶è¿›è¡ŒæŒ‡çº¹å¤„ç†ï¼Œä¸€æ—¦æ–‡ä»¶åå˜åŠ¨å°±ä¼šç«‹åˆ»ä¸‹è½½æ–°çš„æ–‡ä»¶ã€‚ ä½¿ç”¨ HTTP / 2.0å› ä¸ºæµè§ˆå™¨ä¼šæœ‰å¹¶å‘è¯·æ±‚é™åˆ¶ï¼Œåœ¨ HTTP / 1.1 æ—¶ä»£ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦å»ºç«‹å’Œæ–­å¼€ï¼Œæ¶ˆè€—äº†å¥½å‡ ä¸ª RTT æ—¶é—´ï¼Œå¹¶ä¸”ç”±äº TCP æ…¢å¯åŠ¨çš„åŸå› ï¼ŒåŠ è½½ä½“ç§¯å¤§çš„æ–‡ä»¶ä¼šéœ€è¦æ›´å¤šçš„æ—¶é—´ã€‚ åœ¨ HTTP / 2.0 ä¸­å¼•å…¥äº†å¤šè·¯å¤ç”¨ï¼Œèƒ½å¤Ÿè®©å¤šä¸ªè¯·æ±‚ä½¿ç”¨åŒä¸€ä¸ª TCP é“¾æ¥ï¼Œæå¤§çš„åŠ å¿«äº†ç½‘é¡µçš„åŠ è½½é€Ÿåº¦ã€‚å¹¶ä¸”è¿˜æ”¯æŒ Header å‹ç¼©ï¼Œè¿›ä¸€æ­¥çš„å‡å°‘äº†è¯·æ±‚çš„æ•°æ®å¤§å°ã€‚ é¢„åŠ è½½&amp;æ‡’åŠ è½½é¢„åŠ è½½åœ¨å¼€å‘ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µã€‚æœ‰äº›èµ„æºä¸éœ€è¦é©¬ä¸Šç”¨åˆ°ï¼Œä½†æ˜¯å¸Œæœ›å°½æ—©è·å–ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨é¢„åŠ è½½ã€‚ é¢„åŠ è½½å…¶å®æ˜¯å£°æ˜å¼çš„ fetch ï¼Œå¼ºåˆ¶æµè§ˆå™¨è¯·æ±‚èµ„æºï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡ onload äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å¼€å¯é¢„åŠ è½½ 1&lt;link rel=\"preload\" href=\"http://example.com\" /&gt; é¢„åŠ è½½å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé™ä½é¦–å±çš„åŠ è½½æ—¶é—´ï¼Œå› ä¸ºå¯ä»¥å°†ä¸€äº›ä¸å½±å“é¦–å±ä½†é‡è¦çš„æ–‡ä»¶å»¶ååŠ è½½ï¼Œå”¯ä¸€ç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§ä¸å¥½ã€‚ é¢„æ¸²æŸ“å¯ä»¥é€šè¿‡é¢„æ¸²æŸ“å°†ä¸‹è½½çš„æ–‡ä»¶é¢„å…ˆåœ¨åå°æ¸²æŸ“ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å¼€å¯é¢„æ¸²æŸ“ 1&lt;link rel=\"prerender\" href=\"http://example.com\" /&gt; é¢„æ¸²æŸ“è™½ç„¶å¯ä»¥æé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä½†æ˜¯è¦ç¡®ä¿è¯¥é¡µé¢ç™¾åˆ†ç™¾ä¼šè¢«ç”¨æˆ·åœ¨ä¹‹åæ‰“å¼€ï¼Œå¦åˆ™å°±ç™½ç™½æµªè´¹èµ„æºå»æ¸²æŸ“ã€‚ æ‡’æ‰§è¡Œæ‡’æ‰§è¡Œå°±æ˜¯å°†æŸäº›é€»è¾‘å»¶è¿Ÿåˆ°ä½¿ç”¨æ—¶å†è®¡ç®—ã€‚è¯¥æŠ€æœ¯å¯ä»¥ç”¨äºé¦–å±ä¼˜åŒ–ï¼Œå¯¹äºæŸäº›è€—æ—¶é€»è¾‘å¹¶ä¸éœ€è¦åœ¨é¦–å±å°±ä½¿ç”¨çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨æ‡’æ‰§è¡Œã€‚æ‡’æ‰§è¡Œéœ€è¦å”¤é†’ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡å®šæ—¶å™¨æˆ–è€…äº‹ä»¶çš„è°ƒç”¨æ¥å”¤é†’ã€‚ æ‡’åŠ è½½æ‡’åŠ è½½å°±æ˜¯å°†ä¸å…³é”®çš„èµ„æºå»¶ååŠ è½½ã€‚ æ‡’åŠ è½½çš„åŸç†å°±æ˜¯åªåŠ è½½è‡ªå®šä¹‰åŒºåŸŸï¼ˆé€šå¸¸æ˜¯å¯è§†åŒºåŸŸï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å³å°†è¿›å…¥å¯è§†åŒºåŸŸï¼‰å†…éœ€è¦åŠ è½½çš„ä¸œè¥¿ã€‚å¯¹äºå›¾ç‰‡æ¥è¯´ï¼Œå…ˆè®¾ç½®å›¾ç‰‡æ ‡ç­¾çš„ src å±æ€§ä¸ºä¸€å¼ å ä½å›¾ï¼Œå°†çœŸå®çš„å›¾ç‰‡èµ„æºæ”¾å…¥ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ä¸­ï¼Œå½“è¿›å…¥è‡ªå®šä¹‰åŒºåŸŸæ—¶ï¼Œå°±å°†è‡ªå®šä¹‰å±æ€§æ›¿æ¢ä¸º src å±æ€§ï¼Œè¿™æ ·å›¾ç‰‡å°±ä¼šå»ä¸‹è½½èµ„æºï¼Œå®ç°äº†å›¾ç‰‡æ‡’åŠ è½½ã€‚ æ‡’åŠ è½½ä¸ä»…å¯ä»¥ç”¨äºå›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨åˆ«çš„èµ„æºä¸Šã€‚æ¯”å¦‚è¿›å…¥å¯è§†åŒºåŸŸæ‰å¼€å§‹æ’­æ”¾è§†é¢‘ç­‰ç­‰ã€‚ æ–‡ä»¶ä¼˜åŒ–å›¾ç‰‡ä¼˜åŒ–å›¾ç‰‡å¤§å°è®¡ç®—åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä¸€å¼ å›¾ç‰‡å¯èƒ½å¹¶ä¸éœ€è¦ä½¿ç”¨é‚£ä¹ˆå¤šé¢œè‰²å»æ˜¾ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡å°‘æ¯ä¸ªåƒç´ çš„è°ƒè‰²æ¿æ¥ç›¸åº”ç¼©å°å›¾ç‰‡çš„å¤§å°ã€‚ äº†è§£äº†å¦‚ä½•è®¡ç®—å›¾ç‰‡å¤§å°çš„çŸ¥è¯†ï¼Œé‚£ä¹ˆå¯¹äºå¦‚ä½•ä¼˜åŒ–å›¾ç‰‡ï¼Œæƒ³å¿…å¤§å®¶å·²ç»æœ‰ 2 ä¸ªæ€è·¯äº†ï¼š å‡å°‘åƒç´ ç‚¹ å‡å°‘æ¯ä¸ªåƒç´ ç‚¹èƒ½å¤Ÿæ˜¾ç¤ºçš„é¢œè‰² å›¾ç‰‡åŠ è½½ä¼˜åŒ– ä¸ç”¨å›¾ç‰‡ã€‚å¾ˆå¤šæ—¶å€™ä¼šä½¿ç”¨åˆ°å¾ˆå¤šä¿®é¥°ç±»å›¾ç‰‡ï¼Œå…¶å®è¿™ç±»ä¿®é¥°å›¾ç‰‡å®Œå…¨å¯ä»¥ç”¨ CSS å»ä»£æ›¿ã€‚ å¯¹äºç§»åŠ¨ç«¯æ¥è¯´ï¼Œå±å¹•å®½åº¦å°±é‚£ä¹ˆç‚¹ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦å»åŠ è½½åŸå›¾æµªè´¹å¸¦å®½ã€‚ä¸€èˆ¬å›¾ç‰‡éƒ½ç”¨ CDN åŠ è½½ï¼Œå¯ä»¥è®¡ç®—å‡ºé€‚é…å±å¹•çš„å®½åº¦ï¼Œç„¶åå»è¯·æ±‚ç›¸åº”è£å‰ªå¥½çš„å›¾ç‰‡ã€‚ å°å›¾ä½¿ç”¨ base64 æ ¼å¼ å°†å¤šä¸ªå›¾æ ‡æ–‡ä»¶æ•´åˆåˆ°ä¸€å¼ å›¾ç‰‡ä¸­ï¼ˆé›ªç¢§å›¾ï¼‰ é€‰æ‹©æ­£ç¡®çš„å›¾ç‰‡æ ¼å¼ï¼š å¯¹äºèƒ½å¤Ÿæ˜¾ç¤º WebP æ ¼å¼çš„æµè§ˆå™¨å°½é‡ä½¿ç”¨ WebP æ ¼å¼ã€‚å› ä¸º WebP æ ¼å¼å…·æœ‰æ›´å¥½çš„å›¾åƒæ•°æ®å‹ç¼©ç®—æ³•ï¼Œèƒ½å¸¦æ¥æ›´å°çš„å›¾ç‰‡ä½“ç§¯ï¼Œè€Œä¸”æ‹¥æœ‰è‚‰çœ¼è¯†åˆ«æ— å·®å¼‚çš„å›¾åƒè´¨é‡ï¼Œç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§å¹¶ä¸å¥½ å°å›¾ä½¿ç”¨ PNGï¼Œå…¶å®å¯¹äºå¤§éƒ¨åˆ†å›¾æ ‡è¿™ç±»å›¾ç‰‡ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ SVG ä»£æ›¿ ç…§ç‰‡ä½¿ç”¨ JPEG å…¶ä»–æ–‡ä»¶ä¼˜åŒ– CSS æ–‡ä»¶æ”¾åœ¨ head ä¸­ æœåŠ¡ç«¯å¼€å¯æ–‡ä»¶å‹ç¼©åŠŸèƒ½ å°† script æ ‡ç­¾æ”¾åœ¨ body åº•éƒ¨ï¼Œå› ä¸º JS æ–‡ä»¶æ‰§è¡Œä¼šé˜»å¡æ¸²æŸ“ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æŠŠ script æ ‡ç­¾æ”¾åœ¨ä»»æ„ä½ç½®ç„¶ååŠ ä¸Š defer ï¼Œè¡¨ç¤ºè¯¥æ–‡ä»¶ä¼šå¹¶è¡Œä¸‹è½½ï¼Œä½†æ˜¯ä¼šæ”¾åˆ° HTML è§£æå®Œæˆåé¡ºåºæ‰§è¡Œã€‚å¯¹äºæ²¡æœ‰ä»»ä½•ä¾èµ–çš„ JS æ–‡ä»¶å¯ä»¥åŠ ä¸Š async ï¼Œè¡¨ç¤ºåŠ è½½å’Œæ¸²æŸ“åç»­æ–‡æ¡£å…ƒç´ çš„è¿‡ç¨‹å°†å’Œ JS æ–‡ä»¶çš„åŠ è½½ä¸æ‰§è¡Œå¹¶è¡Œæ— åºè¿›è¡Œã€‚ æ‰§è¡Œ JS ä»£ç è¿‡é•¿ä¼šå¡ä½æ¸²æŸ“ï¼Œå¯¹äºéœ€è¦å¾ˆå¤šæ—¶é—´è®¡ç®—çš„ä»£ç å¯ä»¥è€ƒè™‘ä½¿ç”¨ Webworkerã€‚Webworker å¯ä»¥è®©æˆ‘ä»¬å¦å¼€ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè„šæœ¬è€Œä¸å½±å“æ¸²æŸ“ã€‚ CDN CDN çš„å…¨ç§°æ˜¯ Content Delivery Networkï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚CDN æ˜¯æ„å»ºåœ¨ç½‘ç»œä¹‹ä¸Šçš„å†…å®¹åˆ†å‘ç½‘ç»œï¼Œä¾é éƒ¨ç½²åœ¨å„åœ°çš„è¾¹ç¼˜æœåŠ¡å™¨ï¼Œé€šè¿‡ä¸­å¿ƒå¹³å°çš„è´Ÿè½½å‡è¡¡ã€å†…å®¹åˆ†å‘ã€è°ƒåº¦ç­‰åŠŸèƒ½æ¨¡å—ï¼Œä½¿ç”¨æˆ·å°±è¿‘è·å–æ‰€éœ€å†…å®¹ï¼Œé™ä½ç½‘ç»œæ‹¥å¡ï¼Œæé«˜ç”¨æˆ·è®¿é—®å“åº”é€Ÿåº¦å’Œå‘½ä¸­ç‡ã€‚CDN çš„å…³é”®æŠ€æœ¯ä¸»è¦æœ‰å†…å®¹å­˜å‚¨å’Œåˆ†å‘æŠ€æœ¯ã€‚â€”â€” ç§‘å­¦ç™¾ç§‘ CDN å­˜åœ¨çš„æ„ä¹‰ä¸ºäº†ä¸è®©ç½‘ç»œæ‹¥å¡æˆä¸ºäº’è”ç½‘å‘å±•çš„éšœç¢ã€‚ CDN çš„ä¼˜åŠ¿ CDN èŠ‚ç‚¹è§£å†³äº†è·¨è¿è¥å•†å’Œè·¨åœ°åŸŸè®¿é—®çš„é—®é¢˜ï¼Œè®¿é—®å»¶æ—¶å¤§å¤§é™ä½ï¼› å¤§éƒ¨åˆ†è¯·æ±‚åœ¨ CDN è¾¹ç¼˜èŠ‚ç‚¹å®Œæˆï¼ŒCDN èµ·åˆ°äº†åˆ†æµä½œç”¨ï¼Œå‡è½»äº†æºç«™çš„è´Ÿè½½ï¼› é™ä½â€œå¹¿æ’­é£æš´â€çš„å½±å“ï¼Œæé«˜ç½‘ç»œè®¿é—®çš„ç¨³å®šæ€§ï¼›èŠ‚çœéª¨å¹²ç½‘å¸¦å®½ï¼Œå‡å°‘å¸¦å®½éœ€æ±‚é‡ã€‚ CDN çš„æ ¸å¿ƒç‚¹ ç¼“å­˜ï¼šå°†ä»æ ¹æœåŠ¡å™¨è¯·æ±‚æ¥çš„èµ„æºæŒ‰è¦æ±‚ç¼“å­˜ã€‚ å›æºï¼šå½“æœ‰ç”¨æˆ·è®¿é—®æŸä¸ªèµ„æºçš„æ—¶å€™ï¼Œå¦‚æœè¢«è§£æåˆ°çš„é‚£ä¸ª CDN èŠ‚ç‚¹æ²¡æœ‰ç¼“å­˜å“åº”çš„å†…å®¹ï¼Œæˆ–è€…æ˜¯ç¼“å­˜å·²ç»åˆ°æœŸï¼Œå°±ä¼šå›æºç«™å»è·å–ã€‚æ²¡æœ‰äººè®¿é—®ï¼ŒCDN èŠ‚ç‚¹ä¸ä¼šä¸»åŠ¨å»æºç«™è¯·æ±‚èµ„æºã€‚ å…³é”®æŠ€æœ¯ å†…å®¹å‘å¸ƒï¼šå®ƒå€ŸåŠ©äºå»ºç«‹ç´¢å¼•ã€ç¼“å­˜ã€æµåˆ†è£‚ã€ç»„æ’­ï¼ˆMulticastï¼‰ç­‰æŠ€æœ¯ï¼Œå°†å†…å®¹å‘å¸ƒæˆ–æŠ•é€’åˆ°è·ç¦»ç”¨æˆ·æœ€è¿‘çš„è¿œç¨‹æœåŠ¡ç‚¹ï¼ˆPOPï¼‰å¤„ï¼› å†…å®¹è·¯ç”±ï¼šå®ƒæ˜¯æ•´ä½“æ€§çš„ç½‘ç»œè´Ÿè½½å‡è¡¡æŠ€æœ¯ï¼Œé€šè¿‡å†…å®¹è·¯ç”±å™¨ä¸­çš„é‡å®šå‘ï¼ˆDNSï¼‰æœºåˆ¶ï¼Œåœ¨å¤šä¸ªè¿œç¨‹ POP ä¸Šå‡è¡¡ç”¨æˆ·çš„è¯·æ±‚ï¼Œä»¥ä½¿ç”¨æˆ·è¯·æ±‚å¾—åˆ°æœ€è¿‘å†…å®¹æºçš„å“åº”ï¼› å†…å®¹äº¤æ¢ï¼šå®ƒæ ¹æ®å†…å®¹çš„å¯ç”¨æ€§ã€æœåŠ¡å™¨çš„å¯ç”¨æ€§ä»¥åŠç”¨æˆ·çš„èƒŒæ™¯ï¼Œåœ¨ POP çš„ç¼“å­˜æœåŠ¡å™¨ä¸Šï¼Œåˆ©ç”¨åº”ç”¨å±‚äº¤æ¢ã€æµåˆ†è£‚ã€é‡å®šå‘ï¼ˆICPã€WCCPï¼‰ç­‰æŠ€æœ¯ï¼Œæ™ºèƒ½åœ°å¹³è¡¡è´Ÿè½½æµé‡ï¼› æ€§èƒ½ç®¡ç†ï¼šå®ƒé€šè¿‡å†…éƒ¨å’Œå¤–éƒ¨ç›‘æ§ç³»ç»Ÿï¼Œè·å–ç½‘ç»œéƒ¨ä»¶çš„çŠ¶å†µä¿¡æ¯ï¼Œæµ‹é‡å†…å®¹å‘å¸ƒçš„ç«¯åˆ°ç«¯æ€§èƒ½ï¼ˆå¦‚åŒ…ä¸¢å¤±ã€å»¶æ—¶ã€å¹³å‡å¸¦å®½ã€å¯åŠ¨æ—¶é—´ã€å¸§é€Ÿç‡ç­‰ï¼‰ï¼Œä¿è¯ç½‘ç»œå¤„äºæœ€ä½³çš„è¿è¡ŒçŠ¶æ€ã€‚ CDN &amp; é™æ€èµ„æºé™æ€èµ„æºæœ¬èº«å…·æœ‰è®¿é—®é¢‘ç‡é«˜ã€æ‰¿æ¥æµé‡å¤§çš„ç‰¹ç‚¹ï¼Œå› æ­¤é™æ€èµ„æºåŠ è½½é€Ÿåº¦å§‹ç»ˆæ˜¯å‰ç«¯æ€§èƒ½çš„ä¸€ä¸ªéå¸¸å…³é”®çš„æŒ‡æ ‡ã€‚CDN æ˜¯é™æ€èµ„æºæé€Ÿçš„é‡è¦æ‰‹æ®µã€‚ é™æ€èµ„æºå°½é‡ä½¿ç”¨ CDN åŠ è½½ï¼Œç”±äºæµè§ˆå™¨å¯¹äºå•ä¸ªåŸŸåæœ‰å¹¶å‘è¯·æ±‚ä¸Šé™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤šä¸ª CDN åŸŸåã€‚å¯¹äº CDN åŠ è½½é™æ€èµ„æºéœ€è¦æ³¨æ„ CDN åŸŸåè¦ä¸ä¸»ç«™ä¸åŒï¼Œå¦åˆ™æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå¸¦ä¸Šä¸»ç«™çš„ Cookieã€‚ å…¶ä»–ä¼˜åŒ–ä½¿ç”¨ Webpack ä¼˜åŒ–é¡¹ç›® å¯¹äº Webpack4ï¼Œæ‰“åŒ…é¡¹ç›®ä½¿ç”¨ production æ¨¡å¼ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨å¼€å¯ä»£ç å‹ç¼© ä½¿ç”¨ ES6 æ¨¡å—æ¥å¼€å¯ tree shakingï¼Œè¿™ä¸ªæŠ€æœ¯å¯ä»¥ç§»é™¤æ²¡æœ‰ä½¿ç”¨çš„ä»£ç  ä¼˜åŒ–å›¾ç‰‡ï¼Œå¯¹äºå°å›¾å¯ä»¥ä½¿ç”¨ base64 çš„æ–¹å¼å†™å…¥æ–‡ä»¶ä¸­ æŒ‰ç…§è·¯ç”±æ‹†åˆ†ä»£ç ï¼Œå®ç°æŒ‰éœ€åŠ è½½ ç»™æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åæ·»åŠ å“ˆå¸Œï¼Œå®ç°æµè§ˆå™¨ç¼“å­˜æ–‡ä»¶ ç›‘æ§å¯¹äºä»£ç è¿è¡Œé”™è¯¯ï¼Œé€šå¸¸çš„åŠæ³•æ˜¯ä½¿ç”¨ window.onerror æ‹¦æˆªæŠ¥é”™ã€‚è¯¥æ–¹æ³•èƒ½æ‹¦æˆªåˆ°å¤§éƒ¨åˆ†çš„è¯¦ç»†æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤– å¯¹äºè·¨åŸŸçš„ä»£ç è¿è¡Œé”™è¯¯ä¼šæ˜¾ç¤º Script error. å¯¹äºè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦ç»™ script æ ‡ç­¾æ·»åŠ  crossorigin å±æ€§ å¯¹äºæŸäº›æµè§ˆå™¨å¯èƒ½ä¸ä¼šæ˜¾ç¤ºè°ƒç”¨æ ˆä¿¡æ¯ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡ arguments.callee.caller æ¥åšæ ˆé€’å½’ å¯¹äºå¼‚æ­¥ä»£ç æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ catch çš„æ–¹å¼æ•è·é”™è¯¯ã€‚æ¯”å¦‚ Promise å¯ä»¥ç›´æ¥ä½¿ç”¨ catch å‡½æ•°ï¼Œasync await å¯ä»¥ä½¿ç”¨ try catch ä½†æ˜¯è¦æ³¨æ„çº¿ä¸Šè¿è¡Œçš„ä»£ç éƒ½æ˜¯å‹ç¼©è¿‡çš„ï¼Œéœ€è¦åœ¨æ‰“åŒ…æ—¶ç”Ÿæˆ sourceMap æ–‡ä»¶ä¾¿äº debugã€‚ å¯¹äºæ•è·çš„é”™è¯¯éœ€è¦ä¸Šä¼ ç»™æœåŠ¡å™¨ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ img æ ‡ç­¾çš„ src å‘èµ·ä¸€ä¸ªè¯·æ±‚ã€‚ å¦‚ä½•ä¼˜åŒ–ç¬¬äºŒæ¬¡åŠ è½½é€Ÿåº¦ï¼Ÿï¼ˆå¢é‡åŠ è½½ï¼‰å‰ç«¯æ€§èƒ½ä¼˜åŒ–ä¸‰éƒ¨æ›²(åŠ è½½ç¯‡) ç§»åŠ¨ H5 é¦–å±ç§’å¼€ä¼˜åŒ–æ–¹æ¡ˆæ¢è®¨ é™ä½è¯·æ±‚é‡ï¼šåˆå¹¶èµ„æºï¼Œå‡å°‘ HTTP è¯·æ±‚æ•°ï¼Œminify / gzip å‹ç¼©ï¼ŒwebPï¼ŒlazyLoadã€‚ åŠ å¿«è¯·æ±‚é€Ÿåº¦ï¼šé¢„è§£æ DNSï¼Œå‡å°‘åŸŸåæ•°ï¼Œå¹¶è¡ŒåŠ è½½ï¼ŒCDN åˆ†å‘ã€‚ ç¼“å­˜ï¼šHTTP åè®®ç¼“å­˜è¯·æ±‚ï¼Œç¦»çº¿ç¼“å­˜ manifestï¼Œç¦»çº¿æ•°æ®ç¼“å­˜ localStorageã€‚ æ¸²æŸ“ï¼šJS/CSS ä¼˜åŒ–ï¼ŒåŠ è½½é¡ºåºï¼ŒæœåŠ¡ç«¯æ¸²æŸ“ï¼Œpipelineã€‚ å…¶ä¸­å¯¹é¦–å±å¯åŠ¨é€Ÿåº¦å½±å“æœ€å¤§çš„å°±æ˜¯ç½‘ç»œè¯·æ±‚ï¼Œæ‰€ä»¥ä¼˜åŒ–çš„é‡ç‚¹å°±æ˜¯ç¼“å­˜ å¢é‡å¼æ›´æ–°â€çš„è§£å†³æ–¹æ¡ˆï¼Œç®€å•åœ°è¯´å°±æ˜¯åœ¨ç‰ˆæœ¬æ›´æ–°çš„æ—¶å€™ä¸éœ€è¦é‡æ–°åŠ è½½èµ„æºï¼Œåªéœ€è¦åŠ è½½ä¸€æ®µå¾ˆå°çš„ diff ä¿¡æ¯ï¼Œç„¶ååˆå¹¶åˆ°å½“å‰èµ„æºä¸Šï¼Œç±»ä¼¼ git merge çš„æ•ˆæœã€‚ å¢é‡åŠ è½½çš„ä¸€ç§æ€è·¯ï¼š 1ã€ç”¨æˆ·ç«¯ä½¿ç”¨ LocalStorage æˆ–è€…å…¶å®ƒå‚¨å­˜æ–¹æ¡ˆï¼Œå­˜å‚¨ä¸€ä»½åŸå§‹ä»£ç +æ—¶é—´æˆ³ï¼š 1234&#123; timeStamp: &quot;20161026xxxxxx&quot;, data: &quot;aaabbbccc&quot;&#125; 2ã€æ¯æ¬¡åŠ è½½èµ„æºçš„æ—¶å€™å‘æœåŠ¡å™¨å‘é€è¿™ä¸ªæ—¶é—´æˆ³ï¼› 3ã€æœåŠ¡å™¨ä»æ¥å—åˆ°æ—¶é—´æˆ³ä¸­è¯†åˆ«å‡ºå®¢æˆ·ç«¯çš„ç‰ˆæœ¬ï¼Œå’Œæœ€æ–°çš„ç‰ˆæœ¬åšä¸€æ¬¡ diffï¼Œè¿”å›ä¸¤è€…çš„ diff ä¿¡æ¯ï¼š 123diff(\"aaabbbccc\", \"aaagggccc\");// å‡è®¾æˆ‘ä»¬çš„diffä¿¡æ¯è¿™æ ·è¡¨ç¤ºï¼š// [3, \"-3\", \"+ggg\", 3] 4ã€å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿™ä¸ª diff ä¿¡æ¯ä¹‹åï¼ŒæŠŠæœ¬åœ°èµ„æºå’Œæ—¶é—´æˆ³æ›´æ–°åˆ°æœ€æ–°ï¼Œå®ç°ä¸€æ¬¡å¢é‡æ›´æ–°ï¼š 12mergeDiff(\"aaabbbccc\", [3, \"-3\", \"+ggg\", 3]);//=&gt; \"aaagggccc\" é¢è¯•é¢˜ï¼ˆå¦‚ä½•æ¸²æŸ“å‡ ä¸‡æ¡æ•°æ®å¹¶ä¸å¡ä½ç•Œï¼‰è¿™é“é¢˜è€ƒå¯Ÿäº†å¦‚ä½•åœ¨ä¸å¡ä½é¡µé¢çš„æƒ…å†µä¸‹æ¸²æŸ“æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ä¸€æ¬¡æ€§å°†å‡ ä¸‡æ¡éƒ½æ¸²æŸ“å‡ºæ¥ï¼Œè€Œåº”è¯¥ä¸€æ¬¡æ¸²æŸ“éƒ¨åˆ† DOMï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ requestAnimationFrame æ¥æ¯ 16 ms åˆ·æ–°ä¸€æ¬¡ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\" /&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;ul&gt; æ§ä»¶ &lt;/ul&gt; &lt;script&gt; setTimeout(() =&gt; &#123; // æ’å…¥åä¸‡æ¡æ•°æ® const total = 100000; // ä¸€æ¬¡æ’å…¥ 20 æ¡ï¼Œå¦‚æœè§‰å¾—æ€§èƒ½ä¸å¥½å°±å‡å°‘ const once = 20; // æ¸²æŸ“æ•°æ®æ€»å…±éœ€è¦å‡ æ¬¡ const loopCount = total / once; let countOfRender = 0; let ul = document.querySelector(\"ul\"); function add() &#123; // ä¼˜åŒ–æ€§èƒ½ï¼Œæ’å…¥ä¸ä¼šé€ æˆå›æµ const fragment = document.createDocumentFragment(); for (let i = 0; i &lt; once; i++) &#123; const li = document.createElement(\"li\"); li.innerText = Math.floor(Math.random() * total); fragment.appendChild(li); &#125; ul.appendChild(fragment); countOfRender += 1; loop(); &#125; function loop() &#123; if (countOfRender &lt; loopCount) &#123; window.requestAnimationFrame(add); &#125; &#125; loop(); &#125;, 0); &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; æ‹“å±•çŸ¥è¯†ä¹‹ GzipåŸºæœ¬ä»‹ç»gzip æ˜¯ GNUzip çš„ç¼©å†™ï¼Œæœ€æ—©ç”¨äº UNIX ç³»ç»Ÿçš„æ–‡ä»¶å‹ç¼©ã€‚HTTP åè®®ä¸Šçš„ gzip ç¼–ç æ˜¯ä¸€ç§ç”¨æ¥æ”¹è¿› web åº”ç”¨ç¨‹åºæ€§èƒ½çš„æŠ€æœ¯ï¼Œweb æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å¿…é¡»å…±åŒæ”¯æŒ gzipã€‚ç›®å‰ä¸»æµçš„æµè§ˆå™¨ï¼ŒChrome,firefox,IE ç­‰éƒ½æ”¯æŒè¯¥åè®®ã€‚å¸¸è§çš„æœåŠ¡å™¨å¦‚ Apacheï¼ŒNginxï¼ŒIIS åŒæ ·æ”¯æŒ gzipã€‚ gzip å‹ç¼©æ¯”ç‡åœ¨ 3 åˆ° 10 å€å·¦å³ï¼Œå¯ä»¥å¤§å¤§èŠ‚çœæœåŠ¡å™¨çš„ç½‘ç»œå¸¦å®½ã€‚è€Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¹¶ä¸æ˜¯å¯¹æ‰€æœ‰æ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œé€šå¸¸åªæ˜¯å‹ç¼©é™æ€æ–‡ä»¶ã€‚ gzip å·¥ä½œåŸç†ï¼š æµè§ˆå™¨è¯·æ±‚ urlï¼Œå¹¶åœ¨ request header ä¸­è®¾ç½®å±æ€§ accept-encoding:gzipã€‚è¡¨æ˜æµè§ˆå™¨æ”¯æŒ gzipã€‚ æœåŠ¡å™¨æ”¶åˆ°æµè§ˆå™¨å‘é€çš„è¯·æ±‚ä¹‹åï¼Œåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒ gzipï¼Œå¦‚æœæ”¯æŒ gzipï¼Œåˆ™å‘æµè§ˆå™¨ä¼ é€å‹ç¼©è¿‡çš„å†…å®¹ï¼Œä¸æ”¯æŒåˆ™å‘æµè§ˆå™¨å‘é€æœªç»å‹ç¼©çš„å†…å®¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½æ”¯æŒ gzipï¼Œresponse headers è¿”å›åŒ…å« content-encoding:gzipã€‚ æµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨çš„å“åº”ä¹‹ååˆ¤æ–­å†…å®¹æ˜¯å¦è¢«å‹ç¼©ï¼Œå¦‚æœè¢«å‹ç¼©åˆ™è§£å‹ç¼©æ˜¾ç¤ºé¡µé¢å†…å®¹ã€‚ Nginx ä¸­å¼€å¯ gzipå¦‚æœæœåŠ¡ç«¯æ¥å£ä½¿ç”¨ nodejs å’Œ expressï¼Œé‚£ä¹ˆå¼€å¯ nginx éå¸¸ç®€å•ã€‚å¯ç”¨ compress() ä¸­é—´ä»¶å³å¯å¹¶åœ¨ nginx.conf ä¸­æ·»åŠ  gzip é…ç½®é¡¹å³å¯ï¼Œexpress.compress() gzip å‹ç¼©ä¸­é—´ä»¶ï¼Œé€šè¿‡ filter å‡½æ•°è®¾ç½®éœ€è¦å‹ç¼©çš„æ–‡ä»¶ç±»å‹ã€‚å‹ç¼©ç®—æ³•ä¸º gzip/deflateã€‚è¿™ä¸ªä¸­é—´ä»¶åº”è¯¥æ”¾ç½®åœ¨æ‰€æœ‰çš„ä¸­é—´ä»¶æœ€å‰é¢ä»¥ä¿è¯æ‰€æœ‰çš„è¿”å›éƒ½æ˜¯è¢«å‹ç¼©çš„ã€‚å¦‚æœä½¿ç”¨ java å¼€å‘ï¼Œéœ€è¦é…ç½® filterã€‚ æ·»åŠ å®Œå‚æ•°åï¼Œè¿è¡Œ nginx â€“t æ£€æŸ¥ä¸€ä¸‹è¯­æ³•ï¼Œè‹¥è¯­æ³•æ£€æµ‹é€šè¿‡ï¼Œåˆ™å¼€å§‹è®¿é—® url æ£€æµ‹ gzip æ˜¯å¦æ·»åŠ æˆåŠŸã€‚ gzip onï¼šå¼€å¯ gzipã€‚ gzip_comp_levelï¼šgzip å‹ç¼©æ¯”ã€‚ gzip_min_lengthï¼šå…è®¸è¢«å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ã€‚ gzip_typesï¼šåŒ¹é… MIME ç±»å‹è¿›è¡Œå‹ç¼©ï¼Œtext/html é»˜è®¤è¢«å‹ç¼©ã€‚ æ£€æµ‹ gzip æ˜¯å¦å¼€å¯å¦‚æœæ²¡æœ‰ç°æˆçš„é¡¹ç›®ä»£ç ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ£€æµ‹æ–¹å¼ã€‚é¦–å…ˆåœ¨æœ¬åœ°å®‰è£… nginxï¼Œåœ¨ nginx é»˜è®¤ç›®å½•ä¸‹é¢æ·»åŠ äº†ä¸¤ä¸ªé™æ€æ–‡ä»¶ bootstrap.cssã€bootstrap.jsã€‚ OS X ç³»ç»Ÿçš„é»˜è®¤è·¯å¾„ä¸ºï¼š/usr/local/Cellar/nginx/1.10.2_1/htmlï¼ŒWindows ç³»ç»Ÿç›´æ¥å¤åˆ¶æ–‡ä»¶åˆ°æ–‡ä»¶å¤¹ä¸‹é¢ã€‚ æ‹·è´æ–‡ä»¶æŒ‡ä»¤å¯å‚è€ƒï¼šcp -r bootstrap.js /usr/local/Cellar/nginx/1.10.2_1/htmlï¼Œåœ¨ nginx çš„é»˜è®¤æˆåŠŸè·³è½¬é¡µé¢ index.html å¼•å…¥è¿™ä¸¤ä¸ªé™æ€æ–‡ä»¶ã€‚index.html é¡µé¢å†…å®¹å¦‚å›¾æ‰€ç¤ºã€‚ åšå¥½è¿™ä¸€åˆ‡çš„å‡†å¤‡å·¥ä½œä¹‹åï¼Œæµè§ˆå™¨è¾“å…¥http://localhost:8080/ã€‚å‡ºç°å¦‚å›¾æ‰€ç¤ºé¡µé¢è¡¨æ˜ nginx å¯åŠ¨æˆåŠŸã€‚ nginx å¯åŠ¨æˆåŠŸç•Œé¢ã€‚ æ­¤æ—¶æ‰“å¼€ Chrome æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ° network ä¿¡æ¯ï¼Œresponse headers ä¸­è¿”å›äº† content-encoding:gzipï¼Œè¡¨æ˜ gzip å¼€å¯æˆåŠŸã€‚ gzip æœªå¼€å¯å‰ network ä¿¡æ¯å¦‚å›¾æ‰€ç¤ºï¼š å¼€å¯åè¿”å› network ä¿¡æ¯å¦‚å›¾æ‰€ç¤ºï¼š url è¯·æ±‚çš„ headers æŠ¥æ–‡å¦‚å›¾æ‰€ç¤ºï¼š å¯¹æ¯”ä»¥ä¸Šä¸‰å›¾å¯ä»¥çœ‹å‡º gzip å‹ç¼©æ•ˆç‡éå¸¸é«˜ï¼Œä¸”ç»è¿‡å‹ç¼©åé™æ€æ–‡ä»¶å¤§å°ä¸åˆ°åŸæ¥çš„äº”åˆ†ä¹‹ä¸€ã€‚è¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯é™æ€èµ„æºæ–‡ä»¶è¶Šå¤§ï¼Œgzip çš„å‹ç¼©æ•ˆç‡è¶Šé«˜ã€‚æ‰€ä»¥å¯¹äºé™æ€èµ„æºé‡éå¸¸å¤§çš„ç½‘ç«™ï¼Œå¼€å¯ gzip å¯èŠ‚çœå¤§é‡æµé‡ï¼Œè€ŒåŒæ—¶ gzip çš„åº”ç”¨è¿œä¸æ­¢æé«˜ web æ€§èƒ½,Androidï¼ŒIOS åº•å±‚ç½‘ç»œè¯·æ±‚åŒæ ·å¯ç”¨ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://yoursite.com/categories/å‰ç«¯/"}],"tags":[{"name":"æ€§èƒ½ä¼˜åŒ–","slug":"æ€§èƒ½ä¼˜åŒ–","permalink":"http://yoursite.com/tags/æ€§èƒ½ä¼˜åŒ–/"}]},{"title":"CSSçš„positionå±æ€§","slug":"CSSçš„positionå±æ€§","date":"2019-08-31T13:48:53.000Z","updated":"2019-11-10T14:37:39.015Z","comments":true,"path":"2019/08/31/CSSçš„positionå±æ€§/","link":"","permalink":"http://yoursite.com/2019/08/31/CSSçš„positionå±æ€§/","excerpt":"","text":"CSS çš„ position å±æ€§staticé»˜è®¤å€¼ã€‚è¯¥å…³é”®å­—æŒ‡å®šå…ƒç´ ä½¿ç”¨æ­£å¸¸çš„å¸ƒå±€è¡Œä¸ºï¼Œå³å…ƒç´ åœ¨æ–‡æ¡£å¸¸è§„æµä¸­å½“å‰çš„å¸ƒå±€ä½ç½®ã€‚æ­¤æ—¶ top, right, bottom, left å’Œ z-indexå±æ€§æ— æ•ˆã€‚ relativeå®šä½ç±»å‹ç›¸å¯¹å®šä½å…ƒç´ ï¼Œç›¸å¯¹å®šä½çš„å…ƒç´ æ˜¯åœ¨æ–‡æ¡£ä¸­çš„æ­£å¸¸ä½ç½®åç§»ç»™å®šçš„å€¼ï¼Œä½†æ˜¯ä¸å½±å“å…¶ä»–å…ƒç´ çš„åç§»ã€‚ å®šä½æ–¹å¼ç”Ÿæˆç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºå…¶æ­£å¸¸ä½ç½®è¿›è¡Œå®šä½ã€‚è¯¥å…³é”®å­—ä¸‹ï¼Œå…ƒç´ å…ˆæ”¾ç½®åœ¨æœªæ·»åŠ å®šä½æ—¶çš„ä½ç½®ï¼Œå†åœ¨ä¸æ”¹å˜é¡µé¢å¸ƒå±€çš„å‰æä¸‹è°ƒæ•´å…ƒç´ ä½ç½®ï¼ˆå› æ­¤ä¼šåœ¨æ­¤å…ƒç´ æœªæ·»åŠ å®šä½æ—¶æ‰€åœ¨ä½ç½®ç•™ä¸‹ç©ºç™½ï¼Œâ€left:20â€ ä¼šå‘å…ƒç´ çš„ LEFT ä½ç½®æ·»åŠ  20 åƒç´ ã€‚ï¼‰ã€‚position:relative å¯¹ table-group, table-row,table-column,table-cell,table-caption å…ƒç´ æ— æ•ˆã€‚ 1234&lt;div class=\"box\" id=\"one\"&gt;One&lt;/div&gt;&lt;div class=\"box\" id=\"two\"&gt;Two&lt;/div&gt;&lt;div class=\"box\" id=\"three\"&gt;Three&lt;/div&gt;&lt;div class=\"box\" id=\"four\"&gt;Four&lt;/div&gt; 1234567891011121314.box &#123; display: inline-block; width: 100px; height: 100px; background: red; color: white;&#125;#two &#123; position: relative; top: 20px; left: 20px; background: blue;&#125; absoluteå®šä½ç±»å‹ç»å¯¹å®šä½å…ƒç´ ï¼Œç›¸å¯¹å®šä½çš„å…ƒç´ å¹¶æœªè„±ç¦»æ–‡æ¡£æµï¼Œè€Œç»å¯¹å®šä½çš„å…ƒç´ åˆ™è„±ç¦»äº†æ–‡æ¡£æµã€‚åœ¨å¸ƒç½®æ–‡æ¡£æµä¸­å…¶å®ƒå…ƒç´ æ—¶ï¼Œç»å¯¹å®šä½å…ƒç´ ä¸å æ®ç©ºé—´ã€‚ç»å¯¹å®šä½å…ƒç´ ç›¸å¯¹äºæœ€è¿‘çš„é static ç¥–å…ˆå…ƒç´ å®šä½ã€‚å½“è¿™æ ·çš„ç¥–å…ˆå…ƒç´ ä¸å­˜åœ¨æ—¶ï¼Œåˆ™ç›¸å¯¹äº ICBï¼ˆinital container block, åˆå§‹åŒ…å«å—ï¼‰ã€‚ å®šä½æ–¹å¼ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´ï¼Œç›¸å¯¹äº static å®šä½ä»¥å¤–çš„ç¬¬ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡ â€œleftâ€, â€œtopâ€, â€œrightâ€ ä»¥åŠ â€œbottomâ€ å±æ€§è¿›è¡Œè§„å®šã€‚ç»å¯¹å®šä½çš„å…ƒç´ å¯ä»¥è®¾ç½®å¤–è¾¹è·ï¼ˆmarginsï¼‰ï¼Œä¸”ä¸ä¼šä¸å…¶ä»–è¾¹è·åˆå¹¶ã€‚ 1234&lt;div class=\"box\" id=\"one\"&gt;One&lt;/div&gt;&lt;div class=\"box\" id=\"two\"&gt;Two&lt;/div&gt;&lt;div class=\"box\" id=\"three\"&gt;Three&lt;/div&gt;&lt;div class=\"box\" id=\"four\"&gt;Four&lt;/div&gt; 123456789101112131415.box &#123; display: inline-block; background: red; width: 100px; height: 100px; float: left; margin: 20px; color: white;&#125;#three &#123; position: absolute; top: 20px; left: 20px;&#125; fixedå®šä½ç±»å‹ç»å¯¹å®šä½å…ƒç´ ï¼Œå›ºå®šå®šä½ä¸ç»å¯¹å®šä½ç›¸ä¼¼ï¼Œä½†å…ƒç´ çš„åŒ…å«å—ä¸º viewport è§†å£ã€‚è¯¥å®šä½æ–¹å¼å¸¸ç”¨äºåˆ›å»ºåœ¨æ»šåŠ¨å±å¹•æ—¶ä»å›ºå®šåœ¨ç›¸åŒä½ç½®çš„å…ƒç´ ã€‚ å®šä½æ–¹å¼ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´ï¼Œç›¸å¯¹äºæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡ â€œleftâ€, â€œtopâ€, â€œrightâ€ ä»¥åŠ â€œbottomâ€ å±æ€§è¿›è¡Œè§„å®šã€‚å…ƒç´ çš„ä½ç½®åœ¨å±å¹•æ»šåŠ¨æ—¶ä¸ä¼šæ”¹å˜ã€‚æ‰“å°æ—¶ï¼Œå…ƒç´ ä¼šå‡ºç°åœ¨çš„æ¯é¡µçš„å›ºå®šä½ç½®ã€‚fixed å±æ€§ä¼šåˆ›å»ºæ–°çš„å±‚å ä¸Šä¸‹æ–‡ã€‚ å½“å…ƒç´ ç¥–å…ˆçš„ transform å±æ€§é none æ—¶ï¼Œå®¹å™¨ç”±è§†å£æ”¹ä¸ºè¯¥ç¥–å…ˆã€‚ stickyå®šä½ç±»å‹ç²˜æ€§å®šä½å…ƒç´ ï¼Œç²˜æ€§å®šä½å¯ä»¥è¢«è®¤ä¸ºæ˜¯ç›¸å¯¹å®šä½å’Œå›ºå®šå®šä½çš„æ··åˆã€‚å…ƒç´ åœ¨è·¨è¶Šç‰¹å®šé˜ˆå€¼å‰ä¸ºç›¸å¯¹å®šä½ï¼Œä¹‹åä¸ºå›ºå®šå®šä½ã€‚ å®šä½æ–¹å¼ç›’ä½ç½®æ ¹æ®æ­£å¸¸æµè®¡ç®—(è¿™ç§°ä¸ºæ­£å¸¸æµåŠ¨ä¸­çš„ä½ç½®)ï¼Œç„¶åç›¸å¯¹äºè¯¥å…ƒç´ åœ¨æµä¸­çš„ flow rootï¼ˆBFCï¼‰å’Œ containing blockï¼ˆæœ€è¿‘çš„å—çº§ç¥–å…ˆå…ƒç´ ï¼‰å®šä½ã€‚åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼ˆå³ä¾¿è¢«å®šä½å…ƒç´ ä¸º table æ—¶ï¼‰ï¼Œè¯¥å…ƒç´ å®šä½å‡ä¸å¯¹åç»­å…ƒç´ é€ æˆå½±å“ã€‚å½“å…ƒç´  B è¢«ç²˜æ€§å®šä½æ—¶ï¼Œåç»­å…ƒç´ çš„ä½ç½®ä»æŒ‰ç…§ B æœªå®šä½æ—¶çš„ä½ç½®æ¥ç¡®å®šã€‚position: stickyå¯¹ table å…ƒç´ çš„æ•ˆæœä¸ position: relativeç›¸åŒã€‚ 1234#one &#123; position: sticky; top: 10px;&#125; åœ¨ viewport è§†å£æ»šåŠ¨åˆ°å…ƒç´  top è·ç¦»å°äº 10px ä¹‹å‰ï¼Œå…ƒç´ ä¸ºç›¸å¯¹å®šä½ã€‚ä¹‹åï¼Œå…ƒç´ å°†å›ºå®šåœ¨ä¸é¡¶éƒ¨è·ç¦» 10px çš„ä½ç½®ï¼Œç›´åˆ° viewport è§†å£å›æ»šåˆ°é˜ˆå€¼ä»¥ä¸‹ã€‚ ç²˜æ€§å®šä½å¸¸ç”¨äºå®šä½å­—æ¯åˆ—è¡¨çš„å¤´éƒ¨å…ƒç´ ã€‚æ ‡ç¤º B éƒ¨åˆ†å¼€å§‹çš„å¤´éƒ¨å…ƒç´ åœ¨æ»šåŠ¨ A éƒ¨åˆ†æ—¶ï¼Œå§‹ç»ˆå¤„äº A çš„ä¸‹æ–¹ã€‚è€Œåœ¨å¼€å§‹æ»šåŠ¨ B éƒ¨åˆ†æ—¶ï¼ŒB çš„å¤´éƒ¨ä¼šå›ºå®šåœ¨å±å¹•é¡¶éƒ¨ï¼Œç›´åˆ°æ‰€æœ‰ B çš„é¡¹å‡å®Œæˆæ»šåŠ¨åï¼Œæ‰è¢« C çš„å¤´éƒ¨æ›¿ä»£ã€‚ ä¾‹å­123456789101112131415161718192021222324252627282930&lt;div&gt; &lt;dl&gt; &lt;dt&gt;A&lt;/dt&gt; &lt;dd&gt;Andrew W.K.&lt;/dd&gt; &lt;dd&gt;Apparat&lt;/dd&gt; &lt;dd&gt;Arcade Fire&lt;/dd&gt; &lt;dd&gt;At The Drive-In&lt;/dd&gt; &lt;dd&gt;Aziz Ansari&lt;/dd&gt; &lt;/dl&gt; &lt;dl&gt; &lt;dt&gt;C&lt;/dt&gt; &lt;dd&gt;Chromeo&lt;/dd&gt; &lt;dd&gt;Common&lt;/dd&gt; &lt;dd&gt;Converge&lt;/dd&gt; &lt;dd&gt;Crystal Castles&lt;/dd&gt; &lt;dd&gt;Cursive&lt;/dd&gt; &lt;/dl&gt; &lt;dl&gt; &lt;dt&gt;E&lt;/dt&gt; &lt;dd&gt;Explosions In The Sky&lt;/dd&gt; &lt;/dl&gt; &lt;dl&gt; &lt;dt&gt;T&lt;/dt&gt; &lt;dd&gt;Ted Leo &amp; The Pharmacists&lt;/dd&gt; &lt;dd&gt;T-Pain&lt;/dd&gt; &lt;dd&gt;Thrice&lt;/dd&gt; &lt;dd&gt;TV On The Radio&lt;/dd&gt; &lt;dd&gt;Two Gallants&lt;/dd&gt; &lt;/dl&gt;&lt;/div&gt; 1234567891011121314151617181920212223242526272829303132* &#123; box-sizing: border-box;&#125;dl &#123; margin: 0; padding: 24px 0 0 0;&#125;dt &#123; background: #b8c1c8; border-bottom: 1px solid #989ea4; border-top: 1px solid #717d85; color: #fff; font: bold 18px/21px Helvetica, Arial, sans-serif; margin: 0; padding: 2px 0 0 12px; position: -webkit-sticky; position: sticky; top: -1px;&#125;dd &#123; font: bold 20px/45px Helvetica, Arial, sans-serif; margin: 0; padding: 0 0 0 12px; white-space: nowrap;&#125;dd + dd &#123; border-top: 1px solid #ccc;&#125; ç”Ÿæ•ˆè§„åˆ™position:sticky çš„ç”Ÿæ•ˆæ˜¯æœ‰ä¸€å®šçš„é™åˆ¶çš„ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š é¡»æŒ‡å®š top, right, bottom æˆ– left å››ä¸ªé˜ˆå€¼å…¶ä¸­ä¹‹ä¸€ï¼Œæ‰å¯ä½¿ç²˜æ€§å®šä½ç”Ÿæ•ˆã€‚å¦åˆ™å…¶è¡Œä¸ºä¸ç›¸å¯¹å®šä½ç›¸åŒã€‚ å¹¶ä¸” top å’Œ bottom åŒæ—¶è®¾ç½®æ—¶ï¼Œtop ç”Ÿæ•ˆçš„ä¼˜å…ˆçº§é«˜ï¼Œleft å’Œ right åŒæ—¶è®¾ç½®æ—¶ï¼Œleft çš„ä¼˜å…ˆçº§é«˜ã€‚ è®¾å®šä¸º position:sticky å…ƒç´ çš„ä»»æ„çˆ¶èŠ‚ç‚¹çš„ overflow å±æ€§å¿…é¡»æ˜¯ visibleï¼Œå¦åˆ™ position:sticky ä¸ä¼šç”Ÿæ•ˆã€‚è¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹ï¼š å¦‚æœ position:sticky å…ƒç´ çš„ä»»æ„çˆ¶èŠ‚ç‚¹å®šä½è®¾ç½®ä¸º overflow:hiddenï¼Œåˆ™çˆ¶å®¹å™¨æ— æ³•è¿›è¡Œæ»šåŠ¨ï¼Œæ‰€ä»¥ position:sticky å…ƒç´ ä¹Ÿä¸ä¼šæœ‰æ»šåŠ¨ç„¶åå›ºå®šçš„æƒ…å†µã€‚ å¦‚æœ position:sticky å…ƒç´ çš„ä»»æ„çˆ¶èŠ‚ç‚¹å®šä½è®¾ç½®ä¸º position:relative | absolute | fixedï¼Œåˆ™å…ƒç´ ç›¸å¯¹çˆ¶å…ƒç´ è¿›è¡Œå®šä½ï¼Œè€Œä¸ä¼šç›¸å¯¹ viewprot å®šä½ã€‚ è¾¾åˆ°è®¾å®šçš„é˜€å€¼ã€‚è¿™ä¸ªè¿˜ç®—å¥½ç†è§£ï¼Œä¹Ÿå°±æ˜¯è®¾å®šäº† position:sticky çš„å…ƒç´ è¡¨ç°ä¸º relative è¿˜æ˜¯ fixed æ˜¯æ ¹æ®å…ƒç´ æ˜¯å¦è¾¾åˆ°è®¾å®šäº†çš„é˜ˆå€¼å†³å®šçš„ã€‚ ç‰¹æ€§ åŒä¸€ä¸ªçˆ¶å®¹å™¨ä¸­çš„ sticky å…ƒç´ ï¼Œå¦‚æœå®šä½å€¼ç›¸ç­‰ï¼Œåˆ™ä¼šé‡å ï¼›å¦‚æœå±äºä¸åŒçˆ¶å…ƒç´ ï¼Œåˆ™ä¼šé¸ å é¹Šå·¢ï¼ŒæŒ¤å¼€åŸæ¥çš„å…ƒç´ ï¼Œå½¢æˆä¾æ¬¡å ä½çš„æ•ˆæœã€‚ initialinitial å…³é”®å­—ç”¨äºè®¾ç½® CSS å±æ€§ä¸ºå®ƒçš„é»˜è®¤å€¼ï¼Œå¯ä½œç”¨äºä»»ä½• CSS æ ·å¼ã€‚ï¼ˆIE ä¸æ”¯æŒè¯¥å…³é”®å­—ï¼‰ inheritï¼šè§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ position å±æ€§çš„å€¼ã€‚ æ¯ä¸€ä¸ª CSS å±æ€§éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯ï¼Œè¿™ä¸ªå±æ€§å¿…ç„¶æ˜¯é»˜è®¤ç»§æ‰¿çš„ (inherited: Yes) æˆ–è€…æ˜¯é»˜è®¤ä¸ç»§æ‰¿çš„ (inherited: no)å…¶ä¸­ä¹‹ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ MDN ä¸Šé€šè¿‡è¿™ä¸ªç´¢å¼•æŸ¥æ‰¾ï¼Œåˆ¤æ–­ä¸€ä¸ªå±æ€§çš„æ˜¯å¦ç»§æ‰¿ç‰¹æ€§ã€‚ å¯ç»§æ‰¿å±æ€§ æ‰€æœ‰å…ƒç´ å¯ç»§æ‰¿ï¼švisibility å’Œ cursor å†…è”å…ƒç´ å¯ç»§æ‰¿ï¼šletter-spacingã€word-spacingã€white-spaceã€line-heightã€colorã€fontã€ font-familyã€font-sizeã€font-styleã€font-variantã€font-weightã€text- decorationã€text-transformã€direction å—çŠ¶å…ƒç´ å¯ç»§æ‰¿ï¼štext-indent å’Œ text-align åˆ—è¡¨å…ƒç´ å¯ç»§æ‰¿ï¼šlist-styleã€list-style-typeã€list-style-positionã€list-style-image è¡¨æ ¼å…ƒç´ å¯ç»§æ‰¿ï¼šborder-collapse unsetunset å…³é”®å­—æˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºä¸è®¾ç½®ã€‚å…¶å®ï¼Œå®ƒæ˜¯å…³é”®å­— initial å’Œ inherit çš„ç»„åˆã€‚ ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬ç»™ä¸€ä¸ª CSS å±æ€§è®¾ç½®äº† unset çš„è¯ï¼š å¦‚æœè¯¥å±æ€§æ˜¯é»˜è®¤ç»§æ‰¿å±æ€§ï¼Œè¯¥å€¼ç­‰åŒäº inherit å¦‚æœè¯¥å±æ€§æ˜¯éç»§æ‰¿å±æ€§ï¼Œè¯¥å€¼ç­‰åŒäº initial ä¾‹å­1234567&lt;div class=\"father\"&gt; &lt;div class=\"children\"&gt;å­çº§å…ƒç´ ä¸€&lt;/div&gt; &lt;div class=\"children unset\"&gt;å­çº§å…ƒç´ äºŒ&lt;/div&gt;&lt;/div&gt;.father &#123; color: red; border: 1px solid black; &#125; .children &#123; color: green;border: 1px solid blue; &#125; .unset &#123; color: unset; border: unset; &#125; ç”±äº color æ˜¯å¯ç»§æ‰¿æ ·å¼ï¼Œè®¾ç½®äº† color: unset çš„å…ƒç´ ï¼Œæœ€ç»ˆè¡¨ç°ä¸ºäº†çˆ¶çº§çš„é¢œè‰² redã€‚ ç”±äº border æ˜¯ä¸å¯ç»§æ‰¿æ ·å¼ï¼Œè®¾ç½®äº† border: unset çš„å…ƒç´ ï¼Œæœ€ç»ˆè¡¨ç°ä¸º border: initial ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤ border æ ·å¼ï¼Œæ— è¾¹æ¡†ã€‚ revertrevert æœªåˆ—å…¥è§„èŒƒ","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"position","slug":"position","permalink":"http://yoursite.com/tags/position/"}]},{"title":"ES6 è£…é¥°å™¨","slug":"ES6 è£…é¥°å™¨","date":"2019-08-18T14:47:55.000Z","updated":"2019-11-10T14:37:39.018Z","comments":true,"path":"2019/08/18/ES6 è£…é¥°å™¨/","link":"","permalink":"http://yoursite.com/2019/08/18/ES6 è£…é¥°å™¨/","excerpt":"ES6 è£…é¥°å™¨è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ä¸€ç§ä¸ç±»ï¼ˆclassï¼‰ç›¸å…³çš„è¯­æ³•ï¼Œç”¨æ¥æ³¨é‡Šæˆ–ä¿®æ”¹ç±»å’Œç±»æ–¹æ³•ã€‚è£…é¥°å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå†™æˆ@ + å‡½æ•°åã€‚å®ƒå¯ä»¥æ”¾åœ¨ç±»å’Œç±»æ–¹æ³•çš„å®šä¹‰å‰é¢ã€‚","text":"ES6 è£…é¥°å™¨è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ä¸€ç§ä¸ç±»ï¼ˆclassï¼‰ç›¸å…³çš„è¯­æ³•ï¼Œç”¨æ¥æ³¨é‡Šæˆ–ä¿®æ”¹ç±»å’Œç±»æ–¹æ³•ã€‚è£…é¥°å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå†™æˆ@ + å‡½æ•°åã€‚å®ƒå¯ä»¥æ”¾åœ¨ç±»å’Œç±»æ–¹æ³•çš„å®šä¹‰å‰é¢ã€‚ 123456789@frozenclass Foo &#123; @configurable(false) @enumerable(true) method() &#123;&#125; @throttle(500) expensiveMethod() &#123;&#125;&#125; ä¸Šé¢ä»£ç ä¸€å…±ä½¿ç”¨äº†å››ä¸ªè£…é¥°å™¨ï¼Œä¸€ä¸ªç”¨åœ¨ç±»æœ¬èº«ï¼Œå¦å¤–ä¸‰ä¸ªç”¨åœ¨ç±»æ–¹æ³•ã€‚å®ƒä»¬ä¸ä»…å¢åŠ äº†ä»£ç çš„å¯è¯»æ€§ï¼Œæ¸…æ™°åœ°è¡¨è¾¾äº†æ„å›¾ï¼Œè€Œä¸”æä¾›ä¸€ç§æ–¹ä¾¿çš„æ‰‹æ®µï¼Œå¢åŠ æˆ–ä¿®æ”¹ç±»çš„åŠŸèƒ½ã€‚ Proxy çš„æ ¸å¿ƒä½œç”¨æ˜¯æ§åˆ¶å¤–ç•Œå¯¹è¢«ä»£ç†è€…å†…éƒ¨çš„è®¿é—®ï¼ŒDecorator çš„æ ¸å¿ƒä½œç”¨æ˜¯å¢å¼ºè¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚ ç±»çš„è£…é¥°è£…é¥°å™¨å¯ä»¥ç”¨æ¥è£…é¥°æ•´ä¸ªç±»ã€‚ ä¸ºç±»æ·»åŠ é™æ€å±æ€§12345678910@testableclass MyTestableClass &#123; // ...&#125;function testable(target) &#123; target.isTestable = true;&#125;MyTestableClass.isTestable; // true ä¸Šé¢ä»£ç ä¸­ï¼Œ@testableå°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨ã€‚å®ƒä¿®æ”¹äº†MyTestableClassè¿™ä¸ªç±»çš„è¡Œä¸ºï¼Œä¸ºå®ƒåŠ ä¸Šäº†é™æ€å±æ€§isTestableã€‚testableå‡½æ•°çš„å‚æ•°targetæ˜¯MyTestableClassç±»æœ¬èº«ã€‚ åŸºæœ¬ä¸Šï¼Œè£…é¥°å™¨çš„è¡Œä¸ºå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚ 1234567@decoratorclass A &#123;&#125;// ç­‰åŒäºclass A &#123;&#125;A = decorator(A) || A; ä¹Ÿå°±æ˜¯è¯´ï¼Œè£…é¥°å™¨æ˜¯ä¸€ä¸ªå¯¹ç±»è¿›è¡Œå¤„ç†çš„å‡½æ•°ã€‚è£…é¥°å™¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ‰€è¦è£…é¥°çš„ç›®æ ‡ç±»ã€‚ å¦‚æœè§‰å¾—ä¸€ä¸ªå‚æ•°ä¸å¤Ÿç”¨ï¼Œå¯ä»¥åœ¨è£…é¥°å™¨å¤–é¢å†å°è£…ä¸€å±‚å‡½æ•°ã€‚ 12345678910111213function testable(isTestable) &#123; return function(target) &#123; target.isTestable = isTestable; &#125;;&#125;@testable(true)class MyTestableClass &#123;&#125;MyTestableClass.isTestable; // true@testable(false)class MyClass &#123;&#125;MyClass.isTestable; // false ä¸Šé¢ä»£ç ä¸­ï¼Œè£…é¥°å™¨testableå¯ä»¥æ¥å—å‚æ•°ï¼Œè¿™å°±ç­‰äºå¯ä»¥ä¿®æ”¹è£…é¥°å™¨çš„è¡Œä¸ºã€‚ æ³¨æ„ï¼Œè£…é¥°å™¨å¯¹ç±»çš„è¡Œä¸ºçš„æ”¹å˜ï¼Œæ˜¯ä»£ç ç¼–è¯‘æ—¶å‘ç”Ÿçš„ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶ã€‚è¿™æ„å‘³ç€ï¼Œè£…é¥°å™¨èƒ½åœ¨ç¼–è¯‘é˜¶æ®µè¿è¡Œä»£ç ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè£…é¥°å™¨æœ¬è´¨å°±æ˜¯ç¼–è¯‘æ—¶æ‰§è¡Œçš„å‡½æ•°ã€‚ ä¸ºç±»æ·»åŠ å®ä¾‹å±æ€§å¦‚æœæƒ³æ·»åŠ å®ä¾‹å±æ€§ï¼Œå¯ä»¥é€šè¿‡ç›®æ ‡ç±»çš„prototypeå¯¹è±¡æ“ä½œã€‚ 123456789function testable(target) &#123; target.prototype.isTestable = true;&#125;@testableclass MyTestableClass &#123;&#125;let obj = new MyTestableClass();obj.isTestable; // true ä¸Šé¢ä»£ç ä¸­ï¼Œè£…é¥°å™¨å‡½æ•°testableæ˜¯åœ¨ç›®æ ‡ç±»çš„prototypeå¯¹è±¡ä¸Šæ·»åŠ å±æ€§ï¼Œå› æ­¤å°±å¯ä»¥åœ¨å®ä¾‹ä¸Šè°ƒç”¨ã€‚ ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚ 123456789101112131415161718192021// mixins.jsexport function mixins(...list) &#123; return function(target) &#123; Object.assign(target.prototype, ...list); &#125;;&#125;// main.jsimport &#123; mixins &#125; from \"./mixins\";const Foo = &#123; foo() &#123; console.log(\"foo\"); &#125;&#125;;@mixins(Foo)class MyClass &#123;&#125;let obj = new MyClass();obj.foo(); // 'foo' ä¸Šé¢ä»£ç é€šè¿‡è£…é¥°å™¨mixinsï¼ŒæŠŠFooå¯¹è±¡çš„æ–¹æ³•æ·»åŠ åˆ°äº†MyClassçš„å®ä¾‹ä¸Šé¢ã€‚å¯ä»¥ç”¨Object.assign()æ¨¡æ‹Ÿè¿™ä¸ªåŠŸèƒ½ã€‚ æ–¹æ³•çš„è£…é¥°è£…é¥°å™¨ä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡è£…é¥°å™¨ä¸ä»…å¯ä»¥è£…é¥°ç±»ï¼Œè¿˜å¯ä»¥è£…é¥°ç±»çš„å±æ€§ã€‚ 123456class Person &#123; @readonly name() &#123; return `$&#123;this.first&#125; $&#123;this.last&#125;`; &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œè£…é¥°å™¨readonlyç”¨æ¥è£…é¥°â€œç±»â€çš„nameæ–¹æ³•ã€‚ è£…é¥°å™¨å‡½æ•°readonlyä¸€å…±å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚ 123456789101112131415function readonly(target, name, descriptor) &#123; // descriptorå¯¹è±¡åŸæ¥çš„å€¼å¦‚ä¸‹ // &#123; // value: specifiedFunction, // enumerable: false, // configurable: true, // writable: true // &#125;; descriptor.writable = false; return descriptor;&#125;readonly(Person.prototype, \"name\", descriptor);// ç±»ä¼¼äºObject.defineProperty(Person.prototype, \"name\", descriptor); è£…é¥°å™¨ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»çš„åŸå‹å¯¹è±¡ï¼Œä¸Šä¾‹æ˜¯Person.prototypeï¼Œè£…é¥°å™¨çš„æœ¬æ„æ˜¯è¦â€œè£…é¥°â€ç±»çš„å®ä¾‹ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å®ä¾‹è¿˜æ²¡ç”Ÿæˆï¼Œæ‰€ä»¥åªèƒ½å»è£…é¥°åŸå‹ï¼ˆè¿™ä¸åŒäºç±»çš„è£…é¥°ï¼Œé‚£ç§æƒ…å†µæ—¶targetå‚æ•°æŒ‡çš„æ˜¯ç±»æœ¬èº«ï¼‰ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦è£…é¥°çš„å±æ€§åï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚ å¦å¤–ï¼Œä¸Šé¢ä»£ç è¯´æ˜ï¼Œè£…é¥°å™¨ï¼ˆreadonlyï¼‰ä¼šä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡ï¼ˆdescriptorï¼‰ï¼Œç„¶åè¢«ä¿®æ”¹çš„æè¿°å¯¹è±¡å†ç”¨æ¥å®šä¹‰å±æ€§ã€‚ ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œä¿®æ”¹å±æ€§æè¿°å¯¹è±¡çš„enumerableå±æ€§ï¼Œä½¿å¾—è¯¥å±æ€§ä¸å¯éå†ã€‚ 1234567891011class Person &#123; @nonenumerable get kidCount() &#123; return this.children.length; &#125;&#125;function nonenumerable(target, name, descriptor) &#123; descriptor.enumerable = false; return descriptor;&#125; ä¸‹é¢çš„@logè£…é¥°å™¨ï¼Œå¯ä»¥èµ·åˆ°è¾“å‡ºæ—¥å¿—çš„ä½œç”¨ã€‚ 12345678910111213141516171819202122class Math &#123; @log add(a, b) &#123; return a + b; &#125;&#125;function log(target, name, descriptor) &#123; var oldValue = descriptor.value; descriptor.value = function() &#123; console.log(`Calling $&#123;name&#125; with`, arguments); return oldValue.apply(this, arguments); &#125;; return descriptor;&#125;const math = new Math();// passed parameters should get logged nowmath.add(2, 4); ä¸Šé¢ä»£ç ä¸­ï¼Œ@logè£…é¥°å™¨çš„ä½œç”¨å°±æ˜¯åœ¨æ‰§è¡ŒåŸå§‹çš„æ“ä½œä¹‹å‰ï¼Œæ‰§è¡Œä¸€æ¬¡console.logï¼Œä»è€Œè¾¾åˆ°è¾“å‡ºæ—¥å¿—çš„ç›®çš„ã€‚ è£…é¥°å™¨çš„æ³¨é‡Šä½œç”¨12345678@testableclass Person &#123; @readonly @nonenumerable name() &#123; return `$&#123;this.first&#125; $&#123;this.last&#125;`; &#125;&#125; ä»ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼ŒPersonç±»æ˜¯å¯æµ‹è¯•çš„ï¼Œè€Œnameæ–¹æ³•æ˜¯åªè¯»å’Œä¸å¯æšä¸¾çš„ã€‚ ä¸‹é¢æ˜¯ä½¿ç”¨ Decorator å†™æ³•çš„ç»„ä»¶ï¼Œçœ‹ä¸Šå»ä¸€ç›®äº†ç„¶ã€‚ 1234567891011121314151617@Component(&#123; tag: \"my-component\", styleUrl: \"my-component.scss\"&#125;)export class MyComponent &#123; @Prop() first: string; @Prop() last: string; @State() isVisible: boolean = true; render() &#123; return ( &lt;p&gt; Hello, my name is &#123;this.first&#125; &#123;this.last&#125; &lt;/p&gt; ); &#125;&#125; å¤šä¸ªè£…é¥°å™¨å¦‚æœåŒä¸€ä¸ªæ–¹æ³•æœ‰å¤šä¸ªè£…é¥°å™¨ï¼Œä¼šåƒå‰¥æ´‹è‘±ä¸€æ ·ï¼Œå…ˆä»å¤–åˆ°å†…è¿›å…¥ï¼Œç„¶åç”±å†…å‘å¤–æ‰§è¡Œã€‚ 1234567891011121314function dec(id) &#123; console.log(\"evaluated\", id); return (target, property, descriptor) =&gt; console.log(\"executed\", id);&#125;class Example &#123; @dec(1) @dec(2) method() &#123;&#125;&#125;// evaluated 1// evaluated 2// executed 2// executed 1 ä¸Šé¢ä»£ç ä¸­ï¼Œå¤–å±‚è£…é¥°å™¨@dec(1)å…ˆè¿›å…¥ï¼Œä½†æ˜¯å†…å±‚è£…é¥°å™¨@dec(2)å…ˆæ‰§è¡Œã€‚ è£…é¥°å™¨å¯ç”¨ä½œç±»å‹æ£€æŸ¥é™¤äº†æ³¨é‡Šï¼Œè£…é¥°å™¨è¿˜èƒ½ç”¨æ¥ç±»å‹æ£€æŸ¥ã€‚æ‰€ä»¥ï¼Œå¯¹äºç±»æ¥è¯´ï¼Œè¿™é¡¹åŠŸèƒ½ç›¸å½“æœ‰ç”¨ã€‚ä»é•¿æœŸæ¥çœ‹ï¼Œå®ƒå°†æ˜¯ JavaScript ä»£ç é™æ€åˆ†æçš„é‡è¦å·¥å…·ã€‚ ä¸ºä»€ä¹ˆè£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°å‡½æ•°æå‡ï¼Œç±»æ²¡æœ‰æå‡è£…é¥°å™¨åªèƒ½ç”¨äºç±»å’Œç±»çš„æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºå‡½æ•°ï¼Œå› ä¸ºå­˜åœ¨å‡½æ•°æå‡ã€‚ 123456789var counter = 0;var add = function () &#123; counter++;&#125;;@addfunction foo() &#123;&#125; ä¸Šé¢çš„ä»£ç ï¼Œæ„å›¾æ˜¯æ‰§è¡Œåcounterç­‰äº 1ï¼Œä½†æ˜¯å®é™…ä¸Šç»“æœæ˜¯counterç­‰äº 0ã€‚å› ä¸ºå‡½æ•°æå‡ï¼Œä½¿å¾—å®é™…æ‰§è¡Œçš„ä»£ç æ˜¯ä¸‹é¢è¿™æ ·ã€‚ 123456789101112@addfunction foo() &#123;&#125;var counter;var add;counter = 0;add = function () &#123; counter++;&#125;; ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚ 12345var readOnly = require(\"some-decorator\");@readOnlyfunction foo() &#123;&#125; ä¸Šé¢ä»£ç ä¹Ÿæœ‰é—®é¢˜ï¼Œå› ä¸ºå®é™…æ‰§è¡Œæ˜¯ä¸‹é¢è¿™æ ·ã€‚ 1234567var readOnly;@readOnlyfunction foo() &#123;&#125;readOnly = require(\"some-decorator\"); æ€»ä¹‹ï¼Œç”±äºå­˜åœ¨å‡½æ•°æå‡ï¼Œä½¿å¾—è£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°ã€‚ç±»æ˜¯ä¸ä¼šæå‡çš„ï¼Œæ‰€ä»¥å°±æ²¡æœ‰è¿™æ–¹é¢çš„é—®é¢˜ã€‚ å‡½æ•°ä¸€å®šè¦ç”¨è£…é¥°å™¨å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä¸€å®šè¦è£…é¥°å‡½æ•°ï¼Œå¯ä»¥é‡‡ç”¨é«˜é˜¶å‡½æ•°çš„å½¢å¼ç›´æ¥æ‰§è¡Œã€‚ 1234567891011121314function doSomething(name) &#123; console.log(\"Hello, \" + name);&#125;function loggingDecorator(wrapped) &#123; return function() &#123; console.log(\"Starting\"); const result = wrapped.apply(this, arguments); console.log(\"Finished\"); return result; &#125;;&#125;const wrapped = loggingDecorator(doSomething); å¸¸è§è£…é¥°å™¨core-decorators.jsæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæä¾›äº†å‡ ä¸ªå¸¸è§çš„è£…é¥°å™¨ï¼Œé€šè¿‡å®ƒå¯ä»¥æ›´å¥½åœ°ç†è§£è£…é¥°å™¨ã€‚ 1. @autobindautobindè£…é¥°å™¨ä½¿å¾—æ–¹æ³•ä¸­çš„thiså¯¹è±¡ï¼Œç»‘å®šåŸå§‹å¯¹è±¡ã€‚ 1234567891011121314import &#123; autobind &#125; from \"core-decorators\";class Person &#123; @autobind getPerson() &#123; return this; &#125;&#125;let person = new Person();let getPerson = person.getPerson;getPerson() === person;// true 2. @readonlyreadonlyè£…é¥°å™¨ä½¿å¾—å±æ€§æˆ–æ–¹æ³•ä¸å¯å†™ã€‚ 12345678910import &#123; readonly &#125; from \"core-decorators\";class Meal &#123; @readonly entree = \"steak\";&#125;var dinner = new Meal();dinner.entree = \"salmon\";// Cannot assign to read only property 'entree' of [object Object] 3. @overrideoverrideè£…é¥°å™¨æ£€æŸ¥å­ç±»çš„æ–¹æ³•ï¼Œæ˜¯å¦æ­£ç¡®è¦†ç›–äº†çˆ¶ç±»çš„åŒåæ–¹æ³•ï¼Œå¦‚æœä¸æ­£ç¡®ä¼šæŠ¥é”™ã€‚ 123456789101112131415161718192021import &#123; override &#125; from \"core-decorators\";class Parent &#123; speak(first, second) &#123;&#125;&#125;class Child extends Parent &#123; @override speak() &#123;&#125; // SyntaxError: Child#speak() does not properly override Parent#speak(first, second)&#125;// orclass Child extends Parent &#123; @override speaks() &#123;&#125; // SyntaxError: No descriptor matching Child#speaks() was found on the prototype chain. // // Did you mean \"speak\"?&#125; 4. @deprecate (åˆ«å@deprecated)deprecateæˆ–deprecatedè£…é¥°å™¨åœ¨æ§åˆ¶å°æ˜¾ç¤ºä¸€æ¡è­¦å‘Šï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•å°†åºŸé™¤ã€‚ 12345678910111213141516171819202122232425262728import &#123; deprecate &#125; from \"core-decorators\";class Person &#123; @deprecate facepalm() &#123;&#125; @deprecate(\"We stopped facepalming\") facepalmHard() &#123;&#125; @deprecate(\"We stopped facepalming\", &#123; url: \"http://knowyourmeme.com/memes/facepalm\" &#125;) facepalmHarder() &#123;&#125;&#125;let person = new Person();person.facepalm();// DEPRECATION Person#facepalm: This function will be removed in future versions.person.facepalmHard();// DEPRECATION Person#facepalmHard: We stopped facepalmingperson.facepalmHarder();// DEPRECATION Person#facepalmHarder: We stopped facepalming//// See http://knowyourmeme.com/memes/facepalm for more details.// 5. @suppressWarningssuppressWarningsè£…é¥°å™¨æŠ‘åˆ¶deprecatedè£…é¥°å™¨å¯¼è‡´çš„console.warn()è°ƒç”¨ã€‚ä½†æ˜¯ï¼Œå¼‚æ­¥ä»£ç å‘å‡ºçš„è°ƒç”¨é™¤å¤–ã€‚ 12345678910111213141516import &#123; suppressWarnings &#125; from \"core-decorators\";class Person &#123; @deprecated facepalm() &#123;&#125; @suppressWarnings facepalmWithoutWarning() &#123; this.facepalm(); &#125;&#125;let person = new Person();person.facepalmWithoutWarning();// no warning is logged ä½¿ç”¨è£…é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è£…é¥°å™¨ï¼Œä½¿å¾—å¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚ 1234567891011121314151617181920const postal = require(\"postal/lib/postal.lodash\");export default function publish(topic, channel) &#123; const channelName = channel || \"/\"; const msgChannel = postal.channel(channelName); msgChannel.subscribe(topic, v =&gt; &#123; console.log(\"é¢‘é“: \", channelName); console.log(\"äº‹ä»¶: \", topic); console.log(\"æ•°æ®: \", v); &#125;); return function(target, name, descriptor) &#123; const fn = descriptor.value; descriptor.value = function() &#123; let value = fn.apply(this, arguments); msgChannel.publish(topic, value); &#125;; &#125;;&#125; ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸ºpublishçš„è£…é¥°å™¨ï¼Œå®ƒé€šè¿‡æ”¹å†™descriptor.valueï¼Œä½¿å¾—åŸæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚å®ƒä½¿ç”¨çš„äº‹ä»¶â€œå‘å¸ƒ/è®¢é˜…â€åº“æ˜¯Postal.jsã€‚ å®ƒçš„ç”¨æ³•å¦‚ä¸‹ã€‚ 123456789101112131415161718// index.jsimport publish from \"./publish\";class FooComponent &#123; @publish(\"foo.some.message\", \"component\") someMethod() &#123; return &#123; my: \"data\" &#125;; &#125; @publish(\"foo.some.other\") anotherMethod() &#123; // ... &#125;&#125;let foo = new FooComponent();foo.someMethod();foo.anotherMethod(); ä»¥åï¼Œåªè¦è°ƒç”¨someMethodæˆ–è€…anotherMethodï¼Œå°±ä¼šè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚ 12345678$ bash-node index.jsé¢‘é“: componentäº‹ä»¶: foo.some.messageæ•°æ®: &#123; my: 'data' &#125;é¢‘é“: /äº‹ä»¶: foo.some.otheræ•°æ®: undefined Mixinåœ¨è£…é¥°å™¨çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å®ç°Mixinæ¨¡å¼ã€‚æ‰€è°“Mixinæ¨¡å¼ï¼Œå°±æ˜¯å¯¹è±¡ç»§æ‰¿çš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆï¼Œä¸­æ–‡è¯‘ä¸ºâ€œæ··å…¥â€ï¼ˆmix inï¼‰ï¼Œæ„ä¸ºåœ¨ä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­æ··å…¥å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚ è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚ 123456789101112const Foo = &#123; foo() &#123; console.log(\"foo\"); &#125;&#125;;class MyClass &#123;&#125;Object.assign(MyClass.prototype, Foo);let obj = new MyClass();obj.foo(); // 'foo' ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œå¯¹è±¡Fooæœ‰ä¸€ä¸ªfooæ–¹æ³•ï¼Œé€šè¿‡Object.assignæ–¹æ³•ï¼Œå¯ä»¥å°†fooæ–¹æ³•â€œæ··å…¥â€MyClassç±»ï¼Œå¯¼è‡´MyClassçš„å®ä¾‹objå¯¹è±¡éƒ½å…·æœ‰fooæ–¹æ³•ã€‚è¿™å°±æ˜¯â€œæ··å…¥â€æ¨¡å¼çš„ä¸€ä¸ªç®€å•å®ç°ã€‚ ä¸‹é¢ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªé€šç”¨è„šæœ¬mixins.jsï¼Œå°† Mixin å†™æˆä¸€ä¸ªè£…é¥°å™¨ã€‚ 12345export function mixins(...list) &#123; return function(target) &#123; Object.assign(target.prototype, ...list); &#125;;&#125; ç„¶åï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸Šé¢è¿™ä¸ªè£…é¥°å™¨ï¼Œä¸ºç±»â€œæ··å…¥â€å„ç§æ–¹æ³•ã€‚ 12345678910111213import &#123; mixins &#125; from \"./mixins\";const Foo = &#123; foo() &#123; console.log(\"foo\"); &#125;&#125;;@mixins(Foo)class MyClass &#123;&#125;let obj = new MyClass();obj.foo(); // \"foo\" é€šè¿‡mixinsè¿™ä¸ªè£…é¥°å™¨ï¼Œå®ç°äº†åœ¨MyClassç±»ä¸Šé¢â€œæ··å…¥â€Fooå¯¹è±¡çš„fooæ–¹æ³•ã€‚ ä¸è¿‡ï¼Œä¸Šé¢çš„æ–¹æ³•ä¼šæ”¹å†™MyClassç±»çš„prototypeå¯¹è±¡ï¼Œå¦‚æœä¸å–œæ¬¢è¿™ä¸€ç‚¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç±»çš„ç»§æ‰¿å®ç° Mixinã€‚ 123class MyClass extends MyBaseClass &#123; /* ... */&#125; ä¸Šé¢ä»£ç ä¸­ï¼ŒMyClassç»§æ‰¿äº†MyBaseClassã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨MyClassé‡Œé¢â€œæ··å…¥â€ä¸€ä¸ªfooæ–¹æ³•ï¼Œä¸€ä¸ªåŠæ³•æ˜¯åœ¨MyClasså’ŒMyBaseClassä¹‹é—´æ’å…¥ä¸€ä¸ªæ··å…¥ç±»ï¼Œè¿™ä¸ªç±»å…·æœ‰fooæ–¹æ³•ï¼Œå¹¶ä¸”ç»§æ‰¿äº†MyBaseClassçš„æ‰€æœ‰æ–¹æ³•ï¼Œç„¶åMyClasså†ç»§æ‰¿è¿™ä¸ªç±»ã€‚ 123456let MyMixin = superclass =&gt; class extends superclass &#123; foo() &#123; console.log(\"foo from MyMixin\"); &#125; &#125;; ä¸Šé¢ä»£ç ä¸­ï¼ŒMyMixinæ˜¯ä¸€ä¸ªæ··å…¥ç±»ç”Ÿæˆå™¨ï¼Œæ¥å—superclassä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªç»§æ‰¿superclassçš„å­ç±»ï¼Œè¯¥å­ç±»åŒ…å«ä¸€ä¸ªfooæ–¹æ³•ã€‚ æ¥ç€ï¼Œç›®æ ‡ç±»å†å»ç»§æ‰¿è¿™ä¸ªæ··å…¥ç±»ï¼Œå°±è¾¾åˆ°äº†â€œæ··å…¥â€fooæ–¹æ³•çš„ç›®çš„ã€‚ 123456class MyClass extends MyMixin(MyBaseClass) &#123; /* ... */&#125;let c = new MyClass();c.foo(); // \"foo from MyMixin\" å¦‚æœéœ€è¦â€œæ··å…¥â€å¤šä¸ªæ–¹æ³•ï¼Œå°±ç”Ÿæˆå¤šä¸ªæ··å…¥ç±»ã€‚ 123class MyClass extends Mixin1(Mixin2(MyBaseClass)) &#123; /* ... */&#125; è¿™ç§å†™æ³•çš„ä¸€ä¸ªå¥½å¤„ï¼Œæ˜¯å¯ä»¥è°ƒç”¨superï¼Œå› æ­¤å¯ä»¥é¿å…åœ¨â€œæ··å…¥â€è¿‡ç¨‹ä¸­è¦†ç›–çˆ¶ç±»çš„åŒåæ–¹æ³•ã€‚ 12345678910111213141516171819202122232425262728let Mixin1 = superclass =&gt; class extends superclass &#123; foo() &#123; console.log(\"foo from Mixin1\"); if (super.foo) super.foo(); &#125; &#125;;let Mixin2 = superclass =&gt; class extends superclass &#123; foo() &#123; console.log(\"foo from Mixin2\"); if (super.foo) super.foo(); &#125; &#125;;class S &#123; foo() &#123; console.log(\"foo from S\"); &#125;&#125;class C extends Mixin1(Mixin2(S)) &#123; foo() &#123; console.log(\"foo from C\"); super.foo(); &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯ä¸€æ¬¡æ··å…¥å‘ç”Ÿæ—¶ï¼Œéƒ½è°ƒç”¨äº†çˆ¶ç±»çš„super.fooæ–¹æ³•ï¼Œå¯¼è‡´çˆ¶ç±»çš„åŒåæ–¹æ³•æ²¡æœ‰è¢«è¦†ç›–ï¼Œè¡Œä¸ºè¢«ä¿ç•™äº†ä¸‹æ¥ã€‚ 12345new C().foo();// foo from C// foo from Mixin1// foo from Mixin2// foo from S TraitTrait ä¹Ÿæ˜¯ä¸€ç§è£…é¥°å™¨ï¼Œæ•ˆæœä¸ Mixin ç±»ä¼¼ï¼Œä½†æ˜¯æä¾›æ›´å¤šåŠŸèƒ½ï¼Œæ¯”å¦‚é˜²æ­¢åŒåæ–¹æ³•çš„å†²çªã€æ’é™¤æ··å…¥æŸäº›æ–¹æ³•ã€ä¸ºæ··å…¥çš„æ–¹æ³•èµ·åˆ«åç­‰ç­‰ã€‚ ä¸‹é¢é‡‡ç”¨traits-decoratorè¿™ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ä½œä¸ºä¾‹å­ã€‚è¿™ä¸ªæ¨¡å—æä¾›çš„traitsè£…é¥°å™¨ï¼Œä¸ä»…å¯ä»¥æ¥å—å¯¹è±¡ï¼Œè¿˜å¯ä»¥æ¥å— ES6 ç±»ä½œä¸ºå‚æ•°ã€‚ 1234567891011121314151617181920import &#123; traits &#125; from \"traits-decorator\";class TFoo &#123; foo() &#123; console.log(\"foo\"); &#125;&#125;const TBar = &#123; bar() &#123; console.log(\"bar\"); &#125;&#125;;@traits(TFoo, TBar)class MyClass &#123;&#125;let obj = new MyClass();obj.foo(); // fooobj.bar(); // bar ä¸Šé¢ä»£ç ä¸­ï¼Œé€šè¿‡traitsè£…é¥°å™¨ï¼Œåœ¨MyClassç±»ä¸Šé¢â€œæ··å…¥â€äº†TFooç±»çš„fooæ–¹æ³•å’ŒTBarå¯¹è±¡çš„baræ–¹æ³•ã€‚ Trait ä¸å…è®¸â€œæ··å…¥â€åŒåæ–¹æ³•ã€‚ 1234567891011121314151617181920212223import &#123; traits &#125; from \"traits-decorator\";class TFoo &#123; foo() &#123; console.log(\"foo\"); &#125;&#125;const TBar = &#123; bar() &#123; console.log(\"bar\"); &#125;, foo() &#123; console.log(\"foo\"); &#125;&#125;;@traits(TFoo, TBar)class MyClass &#123;&#125;// æŠ¥é”™// throw new Error('Method named: ' + methodName + ' is defined twice.');// ^// Error: Method named: foo is defined twice. ä¸Šé¢ä»£ç ä¸­ï¼ŒTFooå’ŒTBaréƒ½æœ‰fooæ–¹æ³•ï¼Œç»“æœtraitsè£…é¥°å™¨æŠ¥é”™ã€‚ ä¸€ç§è§£å†³æ–¹æ³•æ˜¯æ’é™¤TBarçš„fooæ–¹æ³•ã€‚ 1234567891011121314151617181920212223import &#123; traits, excludes &#125; from \"traits-decorator\";class TFoo &#123; foo() &#123; console.log(\"foo\"); &#125;&#125;const TBar = &#123; bar() &#123; console.log(\"bar\"); &#125;, foo() &#123; console.log(\"foo\"); &#125;&#125;;@traits(TFoo, TBar::excludes(\"foo\"))class MyClass &#123;&#125;let obj = new MyClass();obj.foo(); // fooobj.bar(); // bar ä¸Šé¢ä»£ç ä½¿ç”¨ç»‘å®šè¿ç®—ç¬¦ï¼ˆ::ï¼‰åœ¨TBarä¸Šæ’é™¤fooæ–¹æ³•ï¼Œæ··å…¥æ—¶å°±ä¸ä¼šæŠ¥é”™äº†ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯ä¸ºTBarçš„fooæ–¹æ³•èµ·ä¸€ä¸ªåˆ«åã€‚ 123456789101112131415161718192021222324import &#123; traits, alias &#125; from \"traits-decorator\";class TFoo &#123; foo() &#123; console.log(\"foo\"); &#125;&#125;const TBar = &#123; bar() &#123; console.log(\"bar\"); &#125;, foo() &#123; console.log(\"foo\"); &#125;&#125;;@traits(TFoo, TBar::alias(&#123; foo: \"aliasFoo\" &#125;))class MyClass &#123;&#125;let obj = new MyClass();obj.foo(); // fooobj.aliasFoo(); // fooobj.bar(); // bar ä¸Šé¢ä»£ç ä¸ºTBarçš„fooæ–¹æ³•èµ·äº†åˆ«åaliasFooï¼Œäºæ˜¯MyClassä¹Ÿå¯ä»¥æ··å…¥TBarçš„fooæ–¹æ³•äº†ã€‚ aliaså’Œexcludesæ–¹æ³•ï¼Œå¯ä»¥ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ 12@traits(TExample::excludes(\"foo\", \"bar\")::alias(&#123; baz: \"exampleBaz\" &#125;))class MyClass &#123;&#125; ä¸Šé¢ä»£ç æ’é™¤äº†TExampleçš„fooæ–¹æ³•å’Œbaræ–¹æ³•ï¼Œä¸ºbazæ–¹æ³•èµ·äº†åˆ«åexampleBazã€‚ asæ–¹æ³•åˆ™ä¸ºä¸Šé¢çš„ä»£ç æä¾›äº†å¦ä¸€ç§å†™æ³•ã€‚ 1234@traits( TExample::as(&#123; excludes: [\"foo\", \"bar\"], alias: &#123; baz: \"exampleBaz\" &#125; &#125;))class MyClass &#123;&#125;","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"QUIC","slug":"QUIC","date":"2019-08-15T17:52:20.000Z","updated":"2019-11-10T14:37:39.022Z","comments":true,"path":"2019/08/16/QUIC/","link":"","permalink":"http://yoursite.com/2019/08/16/QUIC/","excerpt":"QUICQUIC æ¦‚è¿°Quic å…¨ç§° quick udp internet connection [1]ï¼Œâ€œå¿«é€Ÿ UDP äº’è”ç½‘è¿æ¥â€ï¼Œï¼ˆå’Œè‹±æ–‡ quick è°éŸ³ï¼Œç®€ç§°â€œå¿«â€ï¼‰æ˜¯ç”± google æå‡ºçš„ä½¿ç”¨ udp è¿›è¡Œå¤šè·¯å¹¶å‘ä¼ è¾“çš„åè®®ã€‚ QUIC åè®®å†…ç½®äº† TLS æ ˆï¼Œå®ç°äº†è‡ªå·±çš„ä¼ è¾“åŠ å¯†å±‚ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„ TLS 1.2ã€‚åŒæ—¶ QUIC è¿˜åŒ…å«äº†éƒ¨åˆ† HTTP/2 çš„å®ç°ï¼Œå› æ­¤ QUIC çš„åœ°ä½çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š","text":"QUICQUIC æ¦‚è¿°Quic å…¨ç§° quick udp internet connection [1]ï¼Œâ€œå¿«é€Ÿ UDP äº’è”ç½‘è¿æ¥â€ï¼Œï¼ˆå’Œè‹±æ–‡ quick è°éŸ³ï¼Œç®€ç§°â€œå¿«â€ï¼‰æ˜¯ç”± google æå‡ºçš„ä½¿ç”¨ udp è¿›è¡Œå¤šè·¯å¹¶å‘ä¼ è¾“çš„åè®®ã€‚ QUIC åè®®å†…ç½®äº† TLS æ ˆï¼Œå®ç°äº†è‡ªå·±çš„ä¼ è¾“åŠ å¯†å±‚ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„ TLS 1.2ã€‚åŒæ—¶ QUIC è¿˜åŒ…å«äº†éƒ¨åˆ† HTTP/2 çš„å®ç°ï¼Œå› æ­¤ QUIC çš„åœ°ä½çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒQUIC åº•å±‚é€šè¿‡ UDP åè®®æ›¿ä»£äº† TCPï¼Œä¸Šå±‚åªéœ€è¦ä¸€å±‚ç”¨äºå’Œè¿œç¨‹æœåŠ¡å™¨äº¤äº’çš„ HTTP/2 APIã€‚è¿™æ˜¯å› ä¸º QUIC åè®®å·²ç»åŒ…å«äº†å¤šè·¯å¤ç”¨å’Œè¿æ¥ç®¡ç†ï¼ŒHTTP API åªéœ€è¦å®Œæˆ HTTP åè®®çš„è§£æå³å¯ã€‚ QUIC ä¼˜åŠ¿ å‡å°‘äº† TCP ä¸‰æ¬¡æ¡æ‰‹åŠ TLS æ¡æ‰‹æ—¶é—´ã€‚ æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶ã€‚ é¿å…é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨ã€‚ è¿æ¥è¿ç§»ã€‚ å‰å‘å†—ä½™çº é”™ã€‚ï¼ˆç›®å‰é»˜è®¤çš„å†—ä½™é‡æ˜¯ 10%ï¼Œæ—¢æ¯å‘é€ 10 ä¸ªæ•°æ®åŒ…ï¼Œå…¶å†—ä½™æ•°æ®å°±å¯ä»¥é‡æ–°æ„å»ºä¸€ä¸ªä¸¢å¤±çš„æ•°æ®åŒ…ï¼‰ ä¸ºä»€ä¹ˆéœ€è¦ QUIC åè®®å†å²æ‚ ä¹…å¯¼è‡´ä¸­é—´è®¾å¤‡åƒµåŒ–ã€‚ TCP åè®®æœ¬æ¥æ˜¯æ”¯æŒç«¯å£ã€é€‰é¡¹åŠç‰¹æ€§çš„å¢åŠ å’Œä¿®æ”¹ã€‚ä½†æ˜¯ç”±äº TCP åè®®å’ŒçŸ¥åç«¯å£ï¼ˆ80ã€443ï¼‰åŠé€‰é¡¹ä½¿ç”¨çš„å†å²å¤ªæ‚ ä¹…ï¼Œä¸­é—´è®¾å¤‡å·²ç»ä¾èµ–äºè¿™äº›æ½œè§„åˆ™ï¼Œæ‰€ä»¥å¯¹è¿™äº›å†…å®¹çš„ä¿®æ”¹å¾ˆå®¹æ˜“é­åˆ°ä¸­é—´ç¯èŠ‚çš„å¹²æ‰°è€Œå¤±è´¥ã€‚ ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„å®ç°å¯¼è‡´åè®®æœ¬èº«åƒµåŒ–ã€‚ TCP æ˜¯ç”±æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸è¥¿æ–¹æ ˆå±‚é¢å®ç°çš„ï¼Œåº”ç”¨ç¨‹åºåªèƒ½ä½¿ç”¨ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚è™½ç„¶åº”ç”¨ç¨‹åºçš„æ›´æ–°è¿­ä»£éå¸¸å¿«é€Ÿå’Œç®€å•ã€‚ä½†æ˜¯ TCP çš„è¿­ä»£å´éå¸¸ç¼“æ…¢ï¼ŒåŸå› å°±æ˜¯æ“ä½œç³»ç»Ÿå‡çº§å¾ˆéº»çƒ¦ã€‚æœåŠ¡ç«¯ç³»ç»Ÿä¸ä¾èµ–ç”¨æˆ·å‡çº§ï¼Œä½†æ˜¯ç”±äºæ“ä½œç³»ç»Ÿå‡çº§æ¶‰åŠåˆ°åº•å±‚è½¯ä»¶å’Œè¿è¡Œåº“çš„æ›´æ–°ï¼Œæ‰€ä»¥ä¹Ÿæ¯”è¾ƒä¿å®ˆå’Œç¼“æ…¢ã€‚ å»ºç«‹è¿æ¥çš„æ¡æ‰‹å»¶è¿Ÿå¤§ã€‚ ä¸ç®¡æ˜¯ HTTP1.0/1.1 è¿˜æ˜¯ HTTPSï¼ŒHTTP2ï¼Œéƒ½ä½¿ç”¨äº† TCP è¿›è¡Œä¼ è¾“ã€‚HTTPS å’Œ HTTP2 è¿˜éœ€è¦ä½¿ç”¨ TLS åè®®æ¥è¿›è¡Œå®‰å…¨ä¼ è¾“ã€‚è¿™å°±å‡ºç°äº†ä¸¤ä¸ªæ¡æ‰‹å»¶è¿Ÿï¼š TCP ä¸‰æ¬¡æ¡æ‰‹å¯¼è‡´çš„ TCP è¿æ¥å»ºç«‹çš„å»¶è¿Ÿã€‚ TLS å®Œå…¨æ¡æ‰‹éœ€è¦è‡³å°‘ 2 ä¸ª RTT æ‰èƒ½å»ºç«‹ï¼Œç®€åŒ–æ¡æ‰‹éœ€è¦ 1 ä¸ª RTT çš„æ¡æ‰‹å»¶è¿Ÿã€‚ å¯¹äºå¾ˆå¤šçŸ­è¿æ¥åœºæ™¯ï¼Œè¿™æ ·çš„æ¡æ‰‹å»¶è¿Ÿå½±å“å¾ˆå¤§ï¼Œä¸”æ— æ³•æ¶ˆé™¤ã€‚ é˜Ÿå¤´é˜»å¡ã€‚ é˜Ÿå¤´é˜»å¡ä¸»è¦æ˜¯ TCP åè®®çš„å¯é æ€§æœºåˆ¶å¼•å…¥çš„ã€‚TCP ä½¿ç”¨åºåˆ—å·æ¥æ ‡è¯†æ•°æ®çš„é¡ºåºï¼Œæ•°æ®å¿…é¡»æŒ‰ç…§é¡ºåºå¤„ç†ï¼Œå¦‚æœå‰é¢çš„æ•°æ®ä¸¢å¤±ï¼Œåé¢çš„æ•°æ®å°±ç®—åˆ°è¾¾äº†ä¹Ÿä¸ä¼šé€šçŸ¥åº”ç”¨å±‚æ¥å¤„ç†ã€‚ å¦å¤– TLS åè®®å±‚é¢ä¹Ÿæœ‰ä¸€ä¸ªé˜Ÿå¤´é˜»å¡ï¼Œå› ä¸º TLS åè®®éƒ½æ˜¯æŒ‰ç…§ record æ¥å¤„ç†æ•°æ®çš„ï¼Œå¦‚æœä¸€ä¸ª record ä¸­ä¸¢å¤±äº†æ•°æ®ï¼Œä¹Ÿä¼šå¯¼è‡´æ•´ä¸ª record æ— æ³•æ­£ç¡®å¤„ç†ã€‚ QUIC åè®®é€‰æ‹©äº† UDPï¼Œå› ä¸º UDP æœ¬èº«æ²¡æœ‰è¿æ¥çš„æ¦‚å¿µï¼Œä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼˜åŒ–äº†è¿æ¥å»ºç«‹çš„æ¡æ‰‹å»¶è¿Ÿï¼ŒåŒæ—¶åœ¨åº”ç”¨ç¨‹åºå±‚é¢å®ç°äº† TCP çš„å¯é æ€§ï¼ŒTLS çš„å®‰å…¨æ€§å’Œ HTTP2 çš„å¹¶å‘æ€§ï¼Œåªéœ€è¦ç”¨æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åº”ç”¨ç¨‹åºæ”¯æŒ QUIC åè®®ï¼Œå®Œå…¨é¿å¼€äº†æ“ä½œç³»ç»Ÿå’Œä¸­é—´è®¾å¤‡çš„é™åˆ¶ã€‚ QUIC è¯¦è§£1. QUIC æ ¸å¿ƒç‰¹æ€§è¿æ¥å»ºç«‹å»¶æ—¶ä½0RTT å»ºè¿å¯ä»¥è¯´æ˜¯ QUIC ç›¸æ¯” HTTP2 æœ€å¤§çš„æ€§èƒ½ä¼˜åŠ¿ã€‚é‚£ä»€ä¹ˆæ˜¯ 0RTT å»ºè¿å‘¢ï¼Ÿè¿™é‡Œé¢æœ‰ä¸¤å±‚å«ä¹‰ã€‚ ä¼ è¾“å±‚ 0RTT å°±èƒ½å»ºç«‹è¿æ¥ã€‚ åŠ å¯†å±‚ 0RTT å°±èƒ½å»ºç«‹åŠ å¯†è¿æ¥ã€‚ æ¯”å¦‚ä¸Šå›¾å·¦è¾¹æ˜¯ HTTPS çš„ä¸€æ¬¡å®Œå…¨æ¡æ‰‹çš„å»ºè¿è¿‡ç¨‹ï¼Œéœ€è¦ 3 ä¸ª RTTã€‚å°±ç®—æ˜¯ Session Resumption[14]ï¼Œä¹Ÿéœ€è¦è‡³å°‘ 2 ä¸ª RTTã€‚ è€Œ QUIC å‘¢ï¼Ÿç”±äºå»ºç«‹åœ¨ UDP çš„åŸºç¡€ä¸Šï¼ŒåŒæ—¶åˆå®ç°äº† 0RTT çš„å®‰å…¨æ¡æ‰‹ï¼Œæ‰€ä»¥åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåªéœ€è¦ 0 ä¸ª RTT å°±èƒ½å®ç°æ•°æ®å‘é€ï¼Œåœ¨å®ç°å‰å‘åŠ å¯†çš„åŸºç¡€ä¸Šï¼Œå¹¶ä¸” 0RTT çš„æˆåŠŸç‡ç›¸æ¯” TLS çš„ Sesison Ticket[13] è¦é«˜å¾ˆå¤šã€‚ 2. æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶TCP çš„æ‹¥å¡æ§åˆ¶å®é™…ä¸ŠåŒ…å«äº†å››ä¸ªç®—æ³•ï¼šæ…¢å¯åŠ¨ï¼Œæ‹¥å¡é¿å…ï¼Œå¿«é€Ÿé‡ä¼ ï¼Œå¿«é€Ÿæ¢å¤ã€‚ QUIC åè®®å½“å‰é»˜è®¤ä½¿ç”¨äº† TCP åè®®çš„ Cubic æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒ CubicBytes, Reno, RenoBytes, BBR, PCC ç­‰æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚ ä»æ‹¥å¡ç®—æ³•æœ¬èº«æ¥çœ‹ï¼ŒQUIC åªæ˜¯æŒ‰ç…§ TCP åè®®é‡æ–°å®ç°äº†ä¸€éï¼Œé‚£ä¹ˆ QUIC åè®®åˆ°åº•æ”¹è¿›åœ¨å“ªäº›æ–¹é¢å‘¢ï¼Ÿä¸»è¦æœ‰å¦‚ä¸‹å‡ ç‚¹ï¼š å¯æ’æ‹” ä»€ä¹ˆå«å¯æ’æ‹”å‘¢ï¼Ÿå°±æ˜¯èƒ½å¤Ÿéå¸¸çµæ´»åœ°ç”Ÿæ•ˆï¼Œå˜æ›´å’Œåœæ­¢ã€‚ä½“ç°åœ¨å¦‚ä¸‹æ–¹é¢ï¼š åº”ç”¨ç¨‹åºå±‚é¢å°±èƒ½å®ç°ä¸åŒçš„æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œä¸éœ€è¦æ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦å†…æ ¸æ”¯æŒã€‚è¿™æ˜¯ä¸€ä¸ªé£è·ƒï¼Œå› ä¸ºä¼ ç»Ÿçš„ TCP æ‹¥å¡æ§åˆ¶ï¼Œå¿…é¡»è¦ç«¯åˆ°ç«¯çš„ç½‘ç»œåè®®æ ˆæ”¯æŒï¼Œæ‰èƒ½å®ç°æ§åˆ¶æ•ˆæœã€‚è€Œå†…æ ¸å’Œæ“ä½œç³»ç»Ÿçš„éƒ¨ç½²æˆæœ¬éå¸¸é«˜ï¼Œå‡çº§å‘¨æœŸå¾ˆé•¿ï¼Œè¿™åœ¨äº§å“å¿«é€Ÿè¿­ä»£ï¼Œç½‘ç»œçˆ†ç‚¸å¼å¢é•¿çš„ä»Šå¤©ï¼Œæ˜¾ç„¶æœ‰ç‚¹æ»¡è¶³ä¸äº†éœ€æ±‚ã€‚ å³ä½¿æ˜¯å•ä¸ªåº”ç”¨ç¨‹åºçš„ä¸åŒè¿æ¥ä¹Ÿèƒ½æ”¯æŒé…ç½®ä¸åŒçš„æ‹¥å¡æ§åˆ¶ã€‚å°±ç®—æ˜¯ä¸€å°æœåŠ¡å™¨ï¼Œæ¥å…¥çš„ç”¨æˆ·ç½‘ç»œç¯å¢ƒä¹Ÿåƒå·®ä¸‡åˆ«ï¼Œç»“åˆå¤§æ•°æ®åŠäººå·¥æ™ºèƒ½å¤„ç†ï¼Œæˆ‘ä»¬èƒ½ä¸ºå„ä¸ªç”¨æˆ·æä¾›ä¸åŒçš„ä½†åˆæ›´åŠ ç²¾å‡†æ›´åŠ æœ‰æ•ˆçš„æ‹¥å¡æ§åˆ¶ã€‚æ¯”å¦‚ BBR é€‚åˆï¼ŒCubic é€‚åˆã€‚ åº”ç”¨ç¨‹åºä¸éœ€è¦åœæœºå’Œå‡çº§å°±èƒ½å®ç°æ‹¥å¡æ§åˆ¶çš„å˜æ›´ï¼Œæˆ‘ä»¬åœ¨æœåŠ¡ç«¯åªéœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®ï¼Œreload ä¸€ä¸‹ï¼Œå®Œå…¨ä¸éœ€è¦åœæ­¢æœåŠ¡å°±èƒ½å®ç°æ‹¥å¡æ§åˆ¶çš„åˆ‡æ¢ã€‚ STGW åœ¨é…ç½®å±‚é¢è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸åŒä¸šåŠ¡ï¼Œä¸åŒç½‘ç»œåˆ¶å¼ï¼Œç”šè‡³ä¸åŒçš„ RTTï¼Œä½¿ç”¨ä¸åŒçš„æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚ å•è°ƒé€’å¢çš„ Packet Number TCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œä½¿ç”¨äº†åŸºäºå­—èŠ‚åºå·çš„ Sequence Number åŠ Ack æ¥ç¡®è®¤æ¶ˆæ¯çš„æœ‰åºåˆ°è¾¾ã€‚ QUIC åŒæ ·æ˜¯ä¸€ä¸ªå¯é çš„åè®®ï¼Œå®ƒä½¿ç”¨ Packet Number ä»£æ›¿äº† TCP çš„ sequence numberï¼Œå¹¶ä¸”æ¯ä¸ª Packet Number éƒ½ä¸¥æ ¼é€’å¢ï¼Œä¹Ÿå°±æ˜¯è¯´å°±ç®— Packet N ä¸¢å¤±äº†ï¼Œé‡ä¼ çš„ Packet N çš„ Packet Number å·²ç»ä¸æ˜¯ Nï¼Œè€Œæ˜¯ä¸€ä¸ªæ¯” N å¤§çš„å€¼ã€‚è€Œ TCP å‘¢ï¼Œé‡ä¼  segment çš„ sequence number å’ŒåŸå§‹çš„ segment çš„ Sequence Number ä¿æŒä¸å˜ï¼Œä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸ªç‰¹æ€§ï¼Œå¼•å…¥äº† Tcp é‡ä¼ çš„æ­§ä¹‰é—®é¢˜ã€‚ â€‹ å›¾ 2 Tcp é‡ä¼ æ­§ä¹‰æ€§ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¶…æ—¶äº‹ä»¶ RTO å‘ç”Ÿåï¼Œå®¢æˆ·ç«¯å‘èµ·é‡ä¼ ï¼Œç„¶åæ¥æ”¶åˆ°äº† Ack æ•°æ®ã€‚ç”±äºåºåˆ—å·ä¸€æ ·ï¼Œè¿™ä¸ª Ack æ•°æ®åˆ°åº•æ˜¯åŸå§‹è¯·æ±‚çš„å“åº”è¿˜æ˜¯é‡ä¼ è¯·æ±‚çš„å“åº”å‘¢ï¼Ÿä¸å¥½åˆ¤æ–­ã€‚ å¦‚æœç®—æˆåŸå§‹è¯·æ±‚çš„å“åº”ï¼Œä½†å®é™…ä¸Šæ˜¯é‡ä¼ è¯·æ±‚çš„å“åº”ï¼ˆä¸Šå›¾å·¦ï¼‰ï¼Œä¼šå¯¼è‡´é‡‡æ · RTT å˜å¤§ã€‚å¦‚æœç®—æˆé‡ä¼ è¯·æ±‚çš„å“åº”ï¼Œä½†å®é™…ä¸Šæ˜¯åŸå§‹è¯·æ±‚çš„å“åº”ï¼Œåˆå¾ˆå®¹æ˜“å¯¼è‡´é‡‡æ · RTT è¿‡å°ã€‚ ç”±äº Quic é‡ä¼ çš„ Packet å’ŒåŸå§‹ Packet çš„ Pakcet Number æ˜¯ä¸¥æ ¼é€’å¢çš„ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ â€‹ å›¾ 3 Quic é‡ä¼ æ²¡æœ‰æ­§ä¹‰æ€§ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒRTO å‘ç”Ÿåï¼Œæ ¹æ®é‡ä¼ çš„ Packet Number å°±èƒ½ç¡®å®šç²¾ç¡®çš„ RTT è®¡ç®—ã€‚å¦‚æœ Ack çš„ Packet Number æ˜¯ N+Mï¼Œå°±æ ¹æ®é‡ä¼ è¯·æ±‚è®¡ç®—é‡‡æ · RTTã€‚å¦‚æœ Ack çš„ Pakcet Number æ˜¯ Nï¼Œå°±æ ¹æ®åŸå§‹è¯·æ±‚çš„æ—¶é—´è®¡ç®—é‡‡æ · RTTï¼Œæ²¡æœ‰æ­§ä¹‰æ€§ã€‚ ä½†æ˜¯å•çº¯ä¾é ä¸¥æ ¼é€’å¢çš„ Packet Number è‚¯å®šæ˜¯æ— æ³•ä¿è¯æ•°æ®çš„é¡ºåºæ€§å’Œå¯é æ€§ã€‚QUIC åˆå¼•å…¥äº†ä¸€ä¸ª Stream Offset çš„æ¦‚å¿µã€‚ å³ä¸€ä¸ª Stream å¯ä»¥ç»è¿‡å¤šä¸ª Packet ä¼ è¾“ï¼ŒPacket Number ä¸¥æ ¼é€’å¢ï¼Œæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯ Packet é‡Œçš„ Payload å¦‚æœæ˜¯ Stream çš„è¯ï¼Œå°±éœ€è¦ä¾é  Stream çš„ Offset æ¥ä¿è¯åº”ç”¨æ•°æ®çš„é¡ºåºã€‚å¦‚é”™è¯¯! æœªæ‰¾åˆ°å¼•ç”¨æºã€‚æ‰€ç¤ºï¼Œå‘é€ç«¯å…ˆåå‘é€äº† Pakcet N å’Œ Pakcet N+1ï¼ŒStream çš„ Offset åˆ†åˆ«æ˜¯ x å’Œ x+yã€‚ å‡è®¾ Packet N ä¸¢å¤±äº†ï¼Œå‘èµ·é‡ä¼ ï¼Œé‡ä¼ çš„ Packet Number æ˜¯ N+2ï¼Œä½†æ˜¯å®ƒçš„ Stream çš„ Offset ä¾ç„¶æ˜¯ xï¼Œè¿™æ ·å°±ç®— Packet N + 2 æ˜¯ååˆ°çš„ï¼Œä¾ç„¶å¯ä»¥å°† Stream x å’Œ Stream x+y æŒ‰ç…§é¡ºåºç»„ç»‡èµ·æ¥ï¼Œäº¤ç»™åº”ç”¨ç¨‹åºå¤„ç†ã€‚ â€‹ å›¾ 4 Stream Offset ä¿è¯æœ‰åºæ€§ ä¸å…è®¸ Reneging ä»€ä¹ˆå« Reneging å‘¢ï¼Ÿå°±æ˜¯æ¥æ”¶æ–¹ä¸¢å¼ƒå·²ç»æ¥æ”¶å¹¶ä¸”ä¸ŠæŠ¥ç»™ SACK é€‰é¡¹çš„å†…å®¹ã€‚TCP åè®®ä¸é¼“åŠ±è¿™ç§è¡Œä¸ºï¼Œä½†æ˜¯åè®®å±‚é¢å…è®¸è¿™æ ·çš„è¡Œä¸ºã€‚ä¸»è¦æ˜¯è€ƒè™‘åˆ°æœåŠ¡å™¨èµ„æºæœ‰é™ï¼Œæ¯”å¦‚ Buffer æº¢å‡ºï¼Œå†…å­˜ä¸å¤Ÿç­‰æƒ…å†µã€‚ Reneging å¯¹æ•°æ®é‡ä¼ ä¼šäº§ç”Ÿå¾ˆå¤§çš„å¹²æ‰°ã€‚å› ä¸º Sack éƒ½å·²ç»è¡¨æ˜æ¥æ”¶åˆ°äº†ï¼Œä½†æ˜¯æ¥æ”¶ç«¯äº‹å®ä¸Šä¸¢å¼ƒäº†è¯¥æ•°æ®ã€‚ QUIC åœ¨åè®®å±‚é¢ç¦æ­¢ Renegingï¼Œä¸€ä¸ª Packet åªè¦è¢« Ackï¼Œå°±è®¤ä¸ºå®ƒä¸€å®šè¢«æ­£ç¡®æ¥æ”¶ï¼Œå‡å°‘äº†è¿™ç§å¹²æ‰°ã€‚ æ›´å¤šçš„ Ack å— TCP çš„ Sack é€‰é¡¹èƒ½å¤Ÿå‘Šè¯‰å‘é€æ–¹å·²ç»æ¥æ”¶åˆ°çš„è¿ç»­ Segment çš„èŒƒå›´ï¼Œæ–¹ä¾¿å‘é€æ–¹è¿›è¡Œé€‰æ‹©æ€§é‡ä¼ ã€‚ ç”±äº TCP å¤´éƒ¨æœ€å¤§åªæœ‰ 60 ä¸ªå­—èŠ‚ï¼Œæ ‡å‡†å¤´éƒ¨å ç”¨äº† 20 å­—èŠ‚ï¼Œæ‰€ä»¥ Tcp Option æœ€å¤§é•¿åº¦åªæœ‰ 40 å­—èŠ‚ï¼Œå†åŠ ä¸Š Tcp Timestamp option å ç”¨äº† 10 ä¸ªå­—èŠ‚ [25]ï¼Œæ‰€ä»¥ç•™ç»™ Sack é€‰é¡¹çš„åªæœ‰ 30 ä¸ªå­—èŠ‚ã€‚ æ¯ä¸€ä¸ª Sack Block çš„é•¿åº¦æ˜¯ 8 ä¸ªï¼ŒåŠ ä¸Š Sack Option å¤´éƒ¨ 2 ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ„å‘³ç€ Tcp Sack Option æœ€å¤§åªèƒ½æä¾› 3 ä¸ª Blockã€‚ ä½†æ˜¯ Quic Ack Frame å¯ä»¥åŒæ—¶æä¾› 256 ä¸ª Ack Blockï¼Œåœ¨ä¸¢åŒ…ç‡æ¯”è¾ƒé«˜çš„ç½‘ç»œä¸‹ï¼Œæ›´å¤šçš„ Sack Block å¯ä»¥æå‡ç½‘ç»œçš„æ¢å¤é€Ÿåº¦ï¼Œå‡å°‘é‡ä¼ é‡ã€‚ Ack Delay æ—¶é—´ Tcp çš„ Timestamp é€‰é¡¹å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒåªæ˜¯å›æ˜¾äº†å‘é€æ–¹çš„æ—¶é—´æˆ³ï¼Œä½†æ˜¯æ²¡æœ‰è®¡ç®—æ¥æ”¶ç«¯æ¥æ”¶åˆ° segment åˆ°å‘é€ Ack è¯¥ segment çš„æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´å¯ä»¥ç®€ç§°ä¸º Ack Delayã€‚ è¿™æ ·å°±ä¼šå¯¼è‡´ RTT è®¡ç®—è¯¯å·®ã€‚å¦‚ä¸‹å›¾ï¼š å¯ä»¥è®¤ä¸º TCP çš„ RTT è®¡ç®—ï¼š è€Œ Quic è®¡ç®—å¦‚ä¸‹ï¼š å½“ç„¶ RTT çš„å…·ä½“è®¡ç®—æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œéœ€è¦é‡‡æ ·ï¼Œå‚è€ƒå†å²æ•°å€¼è¿›è¡Œå¹³æ»‘è®¡ç®—ï¼Œå‚è€ƒå¦‚ä¸‹å…¬å¼ [9]ã€‚ 3.åŸºäº stream å’Œ connecton çº§åˆ«çš„æµé‡æ§åˆ¶QUIC çš„æµé‡æ§åˆ¶ç±»ä¼¼ HTTP2ï¼Œå³åœ¨ Connection å’Œ Stream çº§åˆ«æä¾›äº†ä¸¤ç§æµé‡æ§åˆ¶ã€‚ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç±»æµé‡æ§åˆ¶å‘¢ï¼Ÿä¸»è¦æ˜¯å› ä¸º QUIC æ”¯æŒå¤šè·¯å¤ç”¨ã€‚ Stream å¯ä»¥è®¤ä¸ºå°±æ˜¯ä¸€æ¡ HTTP è¯·æ±‚ã€‚ Connection å¯ä»¥ç±»æ¯”ä¸€æ¡ TCP è¿æ¥ã€‚å¤šè·¯å¤ç”¨æ„å‘³ç€åœ¨ä¸€æ¡ Connetion ä¸Šä¼šåŒæ—¶å­˜åœ¨å¤šæ¡ Streamã€‚æ—¢éœ€è¦å¯¹å•ä¸ª Stream è¿›è¡Œæ§åˆ¶ï¼Œåˆéœ€è¦é’ˆå¯¹æ‰€æœ‰ Stream è¿›è¡Œæ€»ä½“æ§åˆ¶ã€‚ QUIC å®ç°æµé‡æ§åˆ¶çš„åŸç†æ¯”è¾ƒç®€å•ï¼š é€šè¿‡ window_update å¸§å‘Šè¯‰å¯¹ç«¯è‡ªå·±å¯ä»¥æ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œè¿™æ ·å‘é€æ–¹å°±ä¸ä¼šå‘é€è¶…è¿‡è¿™ä¸ªæ•°é‡çš„æ•°æ®ã€‚ é€šè¿‡ BlockFrame å‘Šè¯‰å¯¹ç«¯ç”±äºæµé‡æ§åˆ¶è¢«é˜»å¡äº†ï¼Œæ— æ³•å‘é€æ•°æ®ã€‚ QUIC çš„æµé‡æ§åˆ¶å’Œ TCP æœ‰ç‚¹åŒºåˆ«ï¼ŒTCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œçª—å£å·¦è¾¹æ²¿å‘å³æ»‘åŠ¨æ—¶çš„é•¿åº¦å–å†³äºå·²ç»ç¡®è®¤çš„å­—èŠ‚æ•°ã€‚å¦‚æœä¸­é—´å‡ºç°ä¸¢åŒ…ï¼Œå°±ç®—æ¥æ”¶åˆ°äº†æ›´å¤§åºå·çš„ Segmentï¼Œçª—å£ä¹Ÿæ— æ³•è¶…è¿‡è¿™ä¸ªåºåˆ—å·ã€‚ ä½† QUIC ä¸åŒï¼Œå°±ç®—æ­¤å‰æœ‰äº› packet æ²¡æœ‰æ¥æ”¶åˆ°ï¼Œå®ƒçš„æ»‘åŠ¨åªå–å†³äºæ¥æ”¶åˆ°çš„æœ€å¤§åç§»å­—èŠ‚æ•°ã€‚ â€‹ å›¾ 5 Quic Flow Control é’ˆå¯¹ Streamï¼š é’ˆå¯¹ Connectionï¼š åŒæ ·åœ°ï¼ŒSTGW ä¹Ÿåœ¨è¿æ¥å’Œ Stream çº§åˆ«è®¾ç½®äº†ä¸åŒçš„çª—å£æ•°ã€‚ æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å†…å­˜ä¸è¶³æˆ–è€…ä¸Šæ¸¸å¤„ç†æ€§èƒ½å‡ºç°é—®é¢˜æ—¶ï¼Œé€šè¿‡æµé‡æ§åˆ¶æ¥é™åˆ¶ä¼ è¾“é€Ÿç‡ï¼Œä¿éšœæœåŠ¡å¯ç”¨æ€§ã€‚ 4.æ²¡æœ‰é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨QUIC çš„å¤šè·¯å¤ç”¨å’Œ HTTP2 ç±»ä¼¼ã€‚åœ¨ä¸€æ¡ QUIC è¿æ¥ä¸Šå¯ä»¥å¹¶å‘å‘é€å¤šä¸ª HTTP è¯·æ±‚ (stream)ã€‚ä½†æ˜¯ QUIC çš„å¤šè·¯å¤ç”¨ç›¸æ¯” HTTP2 æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŠ¿ã€‚ QUIC ä¸€ä¸ªè¿æ¥ä¸Šçš„å¤šä¸ª stream ä¹‹é—´æ²¡æœ‰ä¾èµ–ã€‚è¿™æ ·å‡å¦‚ stream2 ä¸¢äº†ä¸€ä¸ª udp packetï¼Œä¹Ÿåªä¼šå½±å“ stream2 çš„å¤„ç†ã€‚ä¸ä¼šå½±å“ stream2 ä¹‹å‰åŠä¹‹åçš„ stream çš„å¤„ç†ã€‚ è¿™ä¹Ÿå°±åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šç¼“è§£ç”šè‡³æ¶ˆé™¤äº†é˜Ÿå¤´é˜»å¡çš„å½±å“ã€‚ å¤šè·¯å¤ç”¨æ˜¯ HTTP2 æœ€å¼ºå¤§çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿå°†å¤šæ¡è¯·æ±‚åœ¨ä¸€æ¡ TCP è¿æ¥ä¸ŠåŒæ—¶å‘å‡ºå»ã€‚ä½†ä¹Ÿæ¶åŒ–äº† TCP çš„ä¸€ä¸ªé—®é¢˜ï¼Œé˜Ÿå¤´é˜»å¡ï¼Œå¦‚ä¸‹å›¾ç¤ºï¼š â€‹ å›¾ 6 HTTP2 é˜Ÿå¤´é˜»å¡ HTTP2 åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸ŠåŒæ—¶å‘é€ 4 ä¸ª Streamã€‚å…¶ä¸­ Stream1 å·²ç»æ­£ç¡®åˆ°è¾¾ï¼Œå¹¶è¢«åº”ç”¨å±‚è¯»å–ã€‚ä½†æ˜¯ Stream2 çš„ç¬¬ä¸‰ä¸ª tcp segment ä¸¢å¤±äº†ï¼ŒTCP ä¸ºäº†ä¿è¯æ•°æ®çš„å¯é æ€§ï¼Œéœ€è¦å‘é€ç«¯é‡ä¼ ç¬¬ 3 ä¸ª segment æ‰èƒ½é€šçŸ¥åº”ç”¨å±‚è¯»å–æ¥ä¸‹å»çš„æ•°æ®ï¼Œè™½ç„¶è¿™ä¸ªæ—¶å€™ Stream3 å’Œ Stream4 çš„å…¨éƒ¨æ•°æ®å·²ç»åˆ°è¾¾äº†æ¥æ”¶ç«¯ï¼Œä½†éƒ½è¢«é˜»å¡ä½äº†ã€‚ ä¸ä»…å¦‚æ­¤ï¼Œç”±äº HTTP2 å¼ºåˆ¶ä½¿ç”¨ TLSï¼Œè¿˜å­˜åœ¨ä¸€ä¸ª TLS åè®®å±‚é¢çš„é˜Ÿå¤´é˜»å¡ [12]ã€‚ â€‹ å›¾ 7 TLS é˜Ÿå¤´é˜»å¡ Record æ˜¯ TLS åè®®å¤„ç†çš„æœ€å°å•ä½ï¼Œæœ€å¤§ä¸èƒ½è¶…è¿‡ 16Kï¼Œä¸€äº›æœåŠ¡å™¨æ¯”å¦‚ Nginx é»˜è®¤çš„å¤§å°å°±æ˜¯ 16Kã€‚ç”±äºä¸€ä¸ª record å¿…é¡»ç»è¿‡æ•°æ®ä¸€è‡´æ€§æ ¡éªŒæ‰èƒ½è¿›è¡ŒåŠ è§£å¯†ï¼Œæ‰€ä»¥ä¸€ä¸ª 16K çš„ recordï¼Œå°±ç®—ä¸¢äº†ä¸€ä¸ªå­—èŠ‚ï¼Œä¹Ÿä¼šå¯¼è‡´å·²ç»æ¥æ”¶åˆ°çš„ 15.99K æ•°æ®æ— æ³•å¤„ç†ï¼Œå› ä¸ºå®ƒä¸å®Œæ•´ã€‚ é‚£ QUIC å¤šè·¯å¤ç”¨ä¸ºä»€ä¹ˆèƒ½é¿å…ä¸Šè¿°é—®é¢˜å‘¢ï¼Ÿ QUIC æœ€åŸºæœ¬çš„ä¼ è¾“å•å…ƒæ˜¯ Packetï¼Œä¸ä¼šè¶…è¿‡ MTU çš„å¤§å°ï¼Œæ•´ä¸ªåŠ å¯†å’Œè®¤è¯è¿‡ç¨‹éƒ½æ˜¯åŸºäº Packet çš„ï¼Œä¸ä¼šè·¨è¶Šå¤šä¸ª Packetã€‚è¿™æ ·å°±èƒ½é¿å… TLS åè®®å­˜åœ¨çš„é˜Ÿå¤´é˜»å¡ã€‚ Stream ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ¯”å¦‚ Stream2 ä¸¢äº†ä¸€ä¸ª Pakcetï¼Œä¸ä¼šå½±å“ Stream3 å’Œ Stream4ã€‚ä¸å­˜åœ¨ TCP é˜Ÿå¤´é˜»å¡ã€‚ï¼ˆQUIC åè®®ç›´æ¥é€šè¿‡åº•å±‚ä½¿ç”¨ UDP åè®®å¤©ç„¶çš„é¿å…äº†è¯¥é—®é¢˜ã€‚ç”±äº UDP åè®®æ²¡æœ‰ä¸¥æ ¼çš„é¡ºåºï¼Œå½“ä¸€ä¸ªæ•°æ®åŒ…é‡åˆ°é—®é¢˜éœ€è¦é‡ä¼ æ—¶ï¼Œåªä¼šå½±å“è¯¥æ•°æ®åŒ…å¯¹åº”çš„èµ„æºï¼Œå…¶ä»–ç‹¬ç«‹çš„èµ„æºï¼ˆå¦‚å…¶ä»– cssã€js æ–‡ä»¶ï¼‰ä¸ä¼šå—åˆ°å½±å“ï¼‰ â€‹ å›¾ 8 QUIC å¤šè·¯å¤ç”¨æ—¶æ²¡æœ‰é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ QUIC æ•°æ®éƒ½ä¸ä¼šå—åˆ°é˜Ÿå¤´é˜»å¡çš„å½±å“ï¼Œæ¯”å¦‚ QUIC å½“å‰ä¹Ÿæ˜¯ä½¿ç”¨ Hpack å‹ç¼©ç®—æ³• [10]ï¼Œç”±äºç®—æ³•çš„é™åˆ¶ï¼Œä¸¢å¤±ä¸€ä¸ªå¤´éƒ¨æ•°æ®æ—¶ï¼Œå¯èƒ½é‡åˆ°é˜Ÿå¤´é˜»å¡ã€‚ æ€»ä½“æ¥è¯´ï¼ŒQUIC åœ¨ä¼ è¾“å¤§é‡æ•°æ®æ—¶ï¼Œæ¯”å¦‚è§†é¢‘ï¼Œå—åˆ°é˜Ÿå¤´é˜»å¡çš„å½±å“å¾ˆå°ã€‚ 5.åŠ å¯†è®¤è¯çš„æŠ¥æ–‡TCP åè®®å¤´éƒ¨æ²¡æœ‰ç»è¿‡ä»»ä½•åŠ å¯†å’Œè®¤è¯ï¼Œæ‰€ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¾ˆå®¹æ˜“è¢«ä¸­é—´ç½‘ç»œè®¾å¤‡ç¯¡æ”¹ï¼Œæ³¨å…¥å’Œçªƒå¬ã€‚æ¯”å¦‚ä¿®æ”¹åºåˆ—å·ã€æ»‘åŠ¨çª—å£ã€‚è¿™äº›è¡Œä¸ºæœ‰å¯èƒ½æ˜¯å‡ºäºæ€§èƒ½ä¼˜åŒ–ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸»åŠ¨æ”»å‡»ã€‚ ä½†æ˜¯ QUIC çš„ packet å¯ä»¥è¯´æ˜¯æ­¦è£…åˆ°äº†ç‰™é½¿ã€‚é™¤äº†ä¸ªåˆ«æŠ¥æ–‡æ¯”å¦‚ PUBLIC_RESET å’Œ CHLOï¼Œæ‰€æœ‰æŠ¥æ–‡å¤´éƒ¨éƒ½æ˜¯ç»è¿‡è®¤è¯çš„ï¼ŒæŠ¥æ–‡ Body éƒ½æ˜¯ç»è¿‡åŠ å¯†çš„ã€‚ è¿™æ ·åªè¦å¯¹ QUIC æŠ¥æ–‡ä»»ä½•ä¿®æ”¹ï¼Œæ¥æ”¶ç«¯éƒ½èƒ½å¤ŸåŠæ—¶å‘ç°ï¼Œæœ‰æ•ˆåœ°é™ä½äº†å®‰å…¨é£é™©ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œçº¢è‰²éƒ¨åˆ†æ˜¯ Stream Frame çš„æŠ¥æ–‡å¤´éƒ¨ï¼Œæœ‰è®¤è¯ã€‚ç»¿è‰²éƒ¨åˆ†æ˜¯æŠ¥æ–‡å†…å®¹ï¼Œå…¨éƒ¨ç»è¿‡åŠ å¯†ã€‚ 6.è¿æ¥è¿ç§»ä¸€æ¡ TCP è¿æ¥æ˜¯ç”±å››å…ƒç»„æ ‡è¯†çš„ï¼ˆæº IPï¼Œæºç«¯å£ï¼Œç›®çš„ IPï¼Œç›®çš„ç«¯å£ï¼‰ã€‚ä»€ä¹ˆå«è¿æ¥è¿ç§»å‘¢ï¼Ÿå°±æ˜¯å½“å…¶ä¸­ä»»ä½•ä¸€ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™æ¡è¿æ¥ä¾ç„¶ç»´æŒç€ï¼Œèƒ½å¤Ÿä¿æŒä¸šåŠ¡é€»è¾‘ä¸ä¸­æ–­ã€‚å½“ç„¶è¿™é‡Œé¢ä¸»è¦å…³æ³¨çš„æ˜¯å®¢æˆ·ç«¯çš„å˜åŒ–ï¼Œå› ä¸ºå®¢æˆ·ç«¯ä¸å¯æ§å¹¶ä¸”ç½‘ç»œç¯å¢ƒç»å¸¸å‘ç”Ÿå˜åŒ–ï¼Œè€ŒæœåŠ¡ç«¯çš„ IP å’Œç«¯å£ä¸€èˆ¬éƒ½æ˜¯å›ºå®šçš„ã€‚ æ¯”å¦‚å¤§å®¶ä½¿ç”¨æ‰‹æœºåœ¨ WIFI å’Œ 4G ç§»åŠ¨ç½‘ç»œåˆ‡æ¢æ—¶ï¼Œå®¢æˆ·ç«¯çš„ IP è‚¯å®šä¼šå‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦é‡æ–°å»ºç«‹å’ŒæœåŠ¡ç«¯çš„ TCP è¿æ¥ã€‚ åˆæ¯”å¦‚å¤§å®¶ä½¿ç”¨å…¬å…± NAT å‡ºå£æ—¶ï¼Œæœ‰äº›è¿æ¥ç«äº‰æ—¶éœ€è¦é‡æ–°ç»‘å®šç«¯å£ï¼Œå¯¼è‡´å®¢æˆ·ç«¯çš„ç«¯å£å‘ç”Ÿå˜åŒ–ï¼ŒåŒæ ·éœ€è¦é‡æ–°å»ºç«‹ TCP è¿æ¥ã€‚ é’ˆå¯¹ TCP çš„è¿æ¥å˜åŒ–ï¼ŒMPTCP å…¶å®å·²ç»æœ‰äº†è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ç”±äº MPTCP éœ€è¦æ“ä½œç³»ç»ŸåŠç½‘ç»œåè®®æ ˆæ”¯æŒï¼Œéƒ¨ç½²é˜»åŠ›éå¸¸å¤§ï¼Œç›®å‰å¹¶ä¸é€‚ç”¨ã€‚ æ‰€ä»¥ä» TCP è¿æ¥çš„è§’åº¦æ¥è®²ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯æ— è§£çš„ã€‚ é‚£ QUIC æ˜¯å¦‚ä½•åšåˆ°è¿æ¥è¿ç§»å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä»»ä½•ä¸€æ¡ QUIC è¿æ¥ä¸å†ä»¥ IP åŠç«¯å£å››å…ƒç»„æ ‡è¯†ï¼Œè€Œæ˜¯ä»¥ä¸€ä¸ª 64 ä½çš„éšæœºæ•°ä½œä¸º ID æ¥æ ‡è¯†ï¼Œè¿™æ ·å°±ç®— IP æˆ–è€…ç«¯å£å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªè¦ ID ä¸å˜ï¼Œè¿™æ¡è¿æ¥ä¾ç„¶ç»´æŒç€ï¼Œä¸Šå±‚ä¸šåŠ¡é€»è¾‘æ„ŸçŸ¥ä¸åˆ°å˜åŒ–ï¼Œä¸ä¼šä¸­æ–­ï¼Œä¹Ÿå°±ä¸éœ€è¦é‡è¿ã€‚ ç”±äºè¿™ä¸ª ID æ˜¯å®¢æˆ·ç«¯éšæœºäº§ç”Ÿçš„ï¼Œå¹¶ä¸”é•¿åº¦æœ‰ 64 ä½ï¼Œæ‰€ä»¥å†²çªæ¦‚ç‡éå¸¸ä½ã€‚ 7.å…¶ä»–äº®ç‚¹æ­¤å¤–ï¼ŒQUIC è¿˜èƒ½å®ç°å‰å‘å†—ä½™çº é”™ï¼Œåœ¨é‡è¦çš„åŒ…æ¯”å¦‚æ¡æ‰‹æ¶ˆæ¯å‘ç”Ÿä¸¢å¤±æ—¶ï¼Œèƒ½å¤Ÿæ ¹æ®å†—ä½™ä¿¡æ¯è¿˜åŸå‡ºæ¡æ‰‹æ¶ˆæ¯ã€‚ QUIC è¿˜èƒ½å®ç°è¯ä¹¦å‹ç¼©ï¼Œå‡å°‘è¯ä¹¦ä¼ è¾“é‡ï¼Œé’ˆå¯¹åŒ…å¤´è¿›è¡ŒéªŒè¯ç­‰ã€‚ QUIC åè®®å®è·µChrome æµè§ˆå™¨ä» 2014 å¹´å¼€å§‹å·²ç»å®éªŒæ€§çš„æ”¯æŒäº† QUIC åè®®ã€‚å¯ä»¥é€šè¿‡åœ¨ Chrome æµè§ˆå™¨ä¸­è¾“å…¥chrome://net-internals/#quicæŸ¥çœ‹æ˜¯å¦å·²ç»æ”¯æŒ QUIC åè®®ã€‚å¦‚æœè¿˜æœªæ”¯æŒï¼Œå¯ä»¥åœ¨chrome://flags/#enable-quicä¸­è¿›è¡Œå¼€å¯ã€‚ å¼€å§‹ Chrome æµè§ˆå™¨å¯¹ QUIC åè®®çš„æ”¯æŒä¹‹åï¼Œå¯ä»¥åœ¨chrome://net-internals/#quicä¸­æŸ¥çœ‹åˆ°å½“å‰æµè§ˆå™¨çš„ QUIC ä¸€äº›è¿æ¥ã€‚å½“ç„¶ç›®å‰åªæœ‰ Google æœåŠ¡æ‰æ”¯æŒ QUIC åè®®ï¼ˆå¦‚ YouTubeã€ Google.comï¼‰ã€‚ 1. å…³äºé˜²ç«å¢™é€šå¸¸ç³»ç»Ÿç®¡ç†å‘˜ä¼šå…³æ³¨é˜²ç«å¢™çš„ TCP è§„åˆ™ï¼Œè€Œå¿½ç•¥ UDP è§„åˆ™ã€‚å¦‚æœè¦åœ¨é˜²ç«å¢™ä¹‹åä½¿ç”¨ QUIC åè®®ï¼Œé™¤äº†ä¼ ç»Ÿ web æœåŠ¡éœ€è¦å¼€æ”¾çš„80/TCPã€443/TCPä¹‹å¤–ï¼Œé’ˆå¯¹ QUIC è¿˜éœ€è¦å¼€æ”¾443/UDPçš„è®¿é—®ã€‚ 2.æœåŠ¡ç«¯ä½¿ç”¨ QUIC åè®®ç›®å‰æ”¯æŒ QUIC åè®®çš„ web æœåŠ¡åªæœ‰ 0.9 ç‰ˆæœ¬ä»¥åçš„Caddyã€‚å…¶ä»–å¸¸ç”¨ web æœåŠ¡å¦‚ nginxã€apache ç­‰éƒ½æœªå¼€å§‹æ”¯æŒã€‚curl è¡¨è¾¾äº†å¯¹ QUIC åè®®æ”¯æŒçš„å…´è¶£ã€‚","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"},{"name":"TCP/IP","slug":"TCP-IP","permalink":"http://yoursite.com/tags/TCP-IP/"}]},{"title":"TCP","slug":"TCP","date":"2019-08-11T13:15:33.000Z","updated":"2019-11-10T14:37:39.023Z","comments":true,"path":"2019/08/11/TCP/","link":"","permalink":"http://yoursite.com/2019/08/11/TCP/","excerpt":"TCP TCP åœ¨ç½‘ç»œ OSI çš„ä¸ƒå±‚æ¨¡å‹ä¸­çš„ç¬¬å››å±‚â€”â€”Transport å±‚ï¼ˆç¬¬å››å±‚çš„æ•°æ®å« Segmentï¼‰ IP åœ¨ç¬¬ä¸‰å±‚â€”â€”Network å±‚ï¼ˆåœ¨ç¬¬ä¸‰å±‚ä¸Šçš„æ•°æ®å« Packetï¼‰ ARP åœ¨ç¬¬äºŒå±‚â€”â€”Data Link å±‚ï¼ˆåœ¨ç¬¬äºŒå±‚ä¸Šçš„æ•°æ®å« Frameï¼‰ æˆ‘ä»¬ç¨‹åºçš„æ•°æ®é¦–å…ˆä¼šæ‰“åˆ° TCP çš„ Segment ä¸­ï¼Œç„¶å TCP çš„ Segment ä¼šæ‰“åˆ° IP çš„ Packet ä¸­ï¼Œç„¶åå†æ‰“åˆ°ä»¥å¤ªç½‘ Ethernet çš„ Frame ä¸­ï¼Œä¼ åˆ°å¯¹ç«¯åï¼Œå„ä¸ªå±‚è§£æè‡ªå·±çš„åè®®ï¼Œç„¶åæŠŠæ•°æ®äº¤ç»™æ›´é«˜å±‚çš„åè®®å¤„ç†ã€‚","text":"TCP TCP åœ¨ç½‘ç»œ OSI çš„ä¸ƒå±‚æ¨¡å‹ä¸­çš„ç¬¬å››å±‚â€”â€”Transport å±‚ï¼ˆç¬¬å››å±‚çš„æ•°æ®å« Segmentï¼‰ IP åœ¨ç¬¬ä¸‰å±‚â€”â€”Network å±‚ï¼ˆåœ¨ç¬¬ä¸‰å±‚ä¸Šçš„æ•°æ®å« Packetï¼‰ ARP åœ¨ç¬¬äºŒå±‚â€”â€”Data Link å±‚ï¼ˆåœ¨ç¬¬äºŒå±‚ä¸Šçš„æ•°æ®å« Frameï¼‰ æˆ‘ä»¬ç¨‹åºçš„æ•°æ®é¦–å…ˆä¼šæ‰“åˆ° TCP çš„ Segment ä¸­ï¼Œç„¶å TCP çš„ Segment ä¼šæ‰“åˆ° IP çš„ Packet ä¸­ï¼Œç„¶åå†æ‰“åˆ°ä»¥å¤ªç½‘ Ethernet çš„ Frame ä¸­ï¼Œä¼ åˆ°å¯¹ç«¯åï¼Œå„ä¸ªå±‚è§£æè‡ªå·±çš„åè®®ï¼Œç„¶åæŠŠæ•°æ®äº¤ç»™æ›´é«˜å±‚çš„åè®®å¤„ç†ã€‚ TCP å¤´æ ¼å¼ ä½ éœ€è¦æ³¨æ„è¿™ä¹ˆå‡ ç‚¹ï¼š TCP çš„åŒ…æ˜¯æ²¡æœ‰ IP åœ°å€çš„ï¼Œé‚£æ˜¯ IP å±‚ä¸Šçš„äº‹ã€‚ä½†æ˜¯æœ‰æºç«¯å£å’Œç›®æ ‡ç«¯å£ã€‚ ä¸€ä¸ª TCP è¿æ¥éœ€è¦å››ä¸ªå…ƒç»„æ¥è¡¨ç¤ºæ˜¯åŒä¸€ä¸ªè¿æ¥ï¼ˆsrc_ip, src_port, dst_ip, dst_portï¼‰å‡†ç¡®è¯´æ˜¯äº”å…ƒç»„ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯åè®®ã€‚ä½†å› ä¸ºè¿™é‡Œåªæ˜¯è¯´ TCP åè®®ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘åªè¯´å››å…ƒç»„ã€‚ æ³¨æ„ä¸Šå›¾ä¸­çš„å››ä¸ªéå¸¸é‡è¦çš„ä¸œè¥¿ï¼š Sequence Numberæ˜¯åŒ…çš„åºå·ï¼Œç”¨æ¥è§£å†³ç½‘ç»œåŒ…ä¹±åºï¼ˆreorderingï¼‰é—®é¢˜ã€‚ Acknowledgement Numberå°±æ˜¯ ACKâ€”â€”ç”¨äºç¡®è®¤æ”¶åˆ°ï¼Œç”¨æ¥è§£å†³ä¸ä¸¢åŒ…çš„é—®é¢˜ã€‚ Window åˆå« Advertised-Windowï¼Œä¹Ÿå°±æ˜¯è‘—åçš„æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰ï¼Œç”¨äºè§£å†³æµæ§çš„ã€‚ TCP Flag ï¼Œä¹Ÿå°±æ˜¯åŒ…çš„ç±»å‹ï¼Œä¸»è¦æ˜¯ç”¨äºæ“æ§ TCP çš„çŠ¶æ€æœºçš„ã€‚ TCP çŠ¶æ€æœºå…¶å®ï¼Œç½‘ç»œä¸Šçš„ä¼ è¾“æ˜¯æ²¡æœ‰è¿æ¥çš„ï¼ŒåŒ…æ‹¬ TCP ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚è€Œ TCP æ‰€è°“çš„â€œè¿æ¥â€ï¼Œå…¶å®åªä¸è¿‡æ˜¯åœ¨é€šè®¯çš„åŒæ–¹ç»´æŠ¤ä¸€ä¸ªâ€œè¿æ¥çŠ¶æ€â€ï¼Œè®©å®ƒçœ‹ä¸Šå»å¥½åƒæœ‰è¿æ¥ä¸€æ ·ã€‚æ‰€ä»¥ï¼ŒTCP çš„çŠ¶æ€å˜æ¢æ˜¯éå¸¸é‡è¦çš„ã€‚ â€œTCP åè®®çš„çŠ¶æ€æœºâ€å’Œ â€œTCP å»ºé“¾æ¥â€ã€â€œTCP æ–­é“¾æ¥â€ã€â€œä¼ æ•°æ®â€ çš„å¯¹ç…§å›¾ å¾ˆå¤šäººä¼šé—®ï¼Œä¸ºä»€ä¹ˆå»ºé“¾æ¥è¦ 3 æ¬¡æ¡æ‰‹ï¼Œæ–­é“¾æ¥éœ€è¦ 4 æ¬¡æŒ¥æ‰‹ï¼Ÿ å¯¹äºå»ºé“¾æ¥çš„ 3 æ¬¡æ¡æ‰‹ï¼Œä¸»è¦æ˜¯è¦åˆå§‹åŒ– Sequence Number çš„åˆå§‹å€¼ã€‚é€šä¿¡çš„åŒæ–¹è¦äº’ç›¸é€šçŸ¥å¯¹æ–¹è‡ªå·±çš„åˆå§‹åŒ–çš„ Sequence Numberï¼ˆç¼©å†™ä¸º ISNï¼šInital Sequence Numberï¼‰â€”â€”æ‰€ä»¥å« SYNï¼Œå…¨ç§° Synchronize Sequence Numbersã€‚ä¹Ÿå°±ä¸Šå›¾ä¸­çš„ x å’Œ yã€‚è¿™ä¸ªå·è¦ä½œä¸ºä»¥åçš„æ•°æ®é€šä¿¡çš„åºå·ï¼Œä»¥ä¿è¯åº”ç”¨å±‚æ¥æ”¶åˆ°çš„æ•°æ®ä¸ä¼šå› ä¸ºç½‘ç»œä¸Šçš„ä¼ è¾“çš„é—®é¢˜è€Œä¹±åºï¼ˆTCP ä¼šç”¨è¿™ä¸ªåºå·æ¥æ‹¼æ¥æ•°æ®ï¼‰ã€‚ å¯¹äº 4 æ¬¡æŒ¥æ‰‹ï¼Œå…¶å®ä½ ä»”ç»†çœ‹æ˜¯ 2 æ¬¡ï¼Œå› ä¸º TCP æ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹éƒ½éœ€è¦ Fin å’Œ Ackã€‚åªä¸è¿‡ï¼Œæœ‰ä¸€æ–¹æ˜¯è¢«åŠ¨çš„ï¼Œæ‰€ä»¥çœ‹ä¸Šå»å°±æˆäº†æ‰€è°“çš„ 4 æ¬¡æŒ¥æ‰‹ã€‚å¦‚æœä¸¤è¾¹åŒæ—¶æ–­è¿æ¥ï¼Œé‚£å°±ä¼šå°±è¿›å…¥åˆ° CLOSING çŠ¶æ€ï¼Œç„¶ååˆ°è¾¾ TIME_WAIT çŠ¶æ€ã€‚ä¸‹å›¾æ˜¯åŒæ–¹åŒæ—¶æ–­è¿æ¥çš„ç¤ºæ„å›¾ï¼ˆä½ åŒæ ·å¯ä»¥å¯¹ç…§ç€ TCP çŠ¶æ€æœºçœ‹ï¼‰ï¼š æ•°æ®ä¼ è¾“ä¸­çš„ Sequence Numberä¸‹å›¾æ˜¯ä» Wireshark ä¸­æˆªäº†ä¸ªæˆ‘åœ¨è®¿é—® coolshell.cn æ—¶çš„æœ‰æ•°æ®ä¼ è¾“çš„å›¾ç»™ä½ çœ‹ä¸€ä¸‹ï¼ŒSeqNum æ˜¯æ€ä¹ˆå˜çš„ã€‚ï¼ˆä½¿ç”¨ Wireshark èœå•ä¸­çš„ Statistics -&gt;Flow Graphâ€¦ ï¼‰ ä½ å¯ä»¥çœ‹åˆ°ï¼ŒSeqNum çš„å¢åŠ æ˜¯å’Œä¼ è¾“çš„å­—èŠ‚æ•°ç›¸å…³çš„ã€‚ä¸Šå›¾ä¸­ï¼Œä¸‰æ¬¡æ¡æ‰‹åï¼Œæ¥äº†ä¸¤ä¸ª Len:1440 çš„åŒ…ï¼Œè€Œç¬¬äºŒä¸ªåŒ…çš„ SeqNum å°±æˆäº† 1441ã€‚ç„¶åç¬¬ä¸€ä¸ª ACK å›çš„æ˜¯ 1441ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ª 1440 æ”¶åˆ°äº†ã€‚ æ³¨æ„ï¼šå¦‚æœä½ ç”¨ Wireshark æŠ“åŒ…ç¨‹åºçœ‹ 3 æ¬¡æ¡æ‰‹ï¼Œä½ ä¼šå‘ç° SeqNum æ€»æ˜¯ä¸º 0ï¼Œä¸æ˜¯è¿™æ ·çš„ï¼ŒWireshark ä¸ºäº†æ˜¾ç¤ºæ›´å‹å¥½ï¼Œä½¿ç”¨äº† Relative SeqNumâ€”â€”ç›¸å¯¹åºå·ï¼Œä½ åªè¦åœ¨å³é”®èœå•ä¸­çš„ protocol preference ä¸­å–æ¶ˆæ‰å°±å¯ä»¥çœ‹åˆ°â€œAbsolute SeqNumâ€äº† TCP é‡ä¼ æœºåˆ¶TCP è¦ä¿è¯æ‰€æœ‰çš„æ•°æ®åŒ…éƒ½å¯ä»¥åˆ°è¾¾ï¼Œæ‰€ä»¥ï¼Œå¿…éœ€è¦æœ‰é‡ä¼ æœºåˆ¶ã€‚ æ³¨æ„ï¼Œæ¥æ”¶ç«¯ç»™å‘é€ç«¯çš„ Ack ç¡®è®¤åªä¼šç¡®è®¤æœ€åä¸€ä¸ªè¿ç»­çš„åŒ…ï¼Œæ¯”å¦‚ï¼Œå‘é€ç«¯å‘äº† 1,2,3,4,5 ä¸€å…±äº”ä»½æ•°æ®ï¼Œæ¥æ”¶ç«¯æ”¶åˆ°äº† 1ï¼Œ2ï¼Œäºæ˜¯å› ack 3ï¼Œç„¶åæ”¶åˆ°äº† 4ï¼ˆæ³¨æ„æ­¤æ—¶ 3 æ²¡æ”¶åˆ°ï¼‰ï¼Œæ­¤æ—¶çš„ TCP ä¼šæ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬è¦çŸ¥é“ï¼Œå› ä¸ºæ­£å¦‚å‰é¢æ‰€è¯´çš„ï¼ŒSeqNum å’Œ Ack æ˜¯ä»¥å­—èŠ‚æ•°ä¸ºå•ä½ï¼Œæ‰€ä»¥ ack çš„æ—¶å€™ï¼Œä¸èƒ½è·³ç€ç¡®è®¤ï¼Œåªèƒ½ç¡®è®¤æœ€å¤§çš„è¿ç»­æ”¶åˆ°çš„åŒ…ï¼Œä¸ç„¶ï¼Œå‘é€ç«¯å°±ä»¥ä¸ºä¹‹å‰çš„éƒ½æ”¶åˆ°äº†ã€‚ è¶…æ—¶é‡ä¼ æœºåˆ¶ä¸€ç§æ˜¯ä¸å› ackï¼Œæ­»ç­‰ 3ï¼Œå½“å‘é€æ–¹å‘ç°æ”¶ä¸åˆ° 3 çš„ ack è¶…æ—¶åï¼Œä¼šé‡ä¼  3ã€‚ä¸€æ—¦æ¥æ”¶æ–¹æ”¶åˆ° 3 åï¼Œä¼š ack å› 4â€”â€”æ„å‘³ç€ 3 å’Œ 4 éƒ½æ”¶åˆ°äº†ã€‚ ä½†æ˜¯ï¼Œè¿™ç§æ–¹å¼ä¼šæœ‰æ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å› ä¸ºè¦æ­»ç­‰ 3ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ 4 å’Œ 5 å³ä¾¿å·²ç»æ”¶åˆ°äº†ï¼Œè€Œå‘é€æ–¹ä¹Ÿå®Œå…¨ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Œå› ä¸ºæ²¡æœ‰æ”¶åˆ° Ackï¼Œæ‰€ä»¥ï¼Œå‘é€æ–¹å¯èƒ½ä¼šæ‚²è§‚åœ°è®¤ä¸ºä¹Ÿä¸¢äº†ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¹Ÿä¼šå¯¼è‡´ 4 å’Œ 5 çš„é‡ä¼ ã€‚ å¯¹æ­¤æœ‰ä¸¤ç§é€‰æ‹©ï¼š ä¸€ç§æ˜¯ä»…é‡ä¼  timeout çš„åŒ…ã€‚ä¹Ÿå°±æ˜¯ç¬¬ 3 ä»½æ•°æ®ã€‚ å¦ä¸€ç§æ˜¯é‡ä¼  timeout åæ‰€æœ‰çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ç¬¬ 3ï¼Œ4ï¼Œ5 è¿™ä¸‰ä»½æ•°æ®ã€‚ è¿™ä¸¤ç§æ–¹å¼æœ‰å¥½ä¹Ÿæœ‰ä¸å¥½ã€‚ç¬¬ä¸€ç§ä¼šèŠ‚çœå¸¦å®½ï¼Œä½†æ˜¯æ…¢ï¼Œç¬¬äºŒç§ä¼šå¿«ä¸€ç‚¹ï¼Œä½†æ˜¯ä¼šæµªè´¹å¸¦å®½ï¼Œä¹Ÿå¯èƒ½ä¼šæœ‰æ— ç”¨åŠŸã€‚ä½†æ€»ä½“æ¥è¯´éƒ½ä¸å¥½ã€‚å› ä¸ºéƒ½åœ¨ç­‰ timeoutï¼Œtimeout å¯èƒ½ä¼šå¾ˆé•¿ï¼ˆåœ¨ä¸‹ç¯‡ä¼šè¯´ TCP æ˜¯æ€ä¹ˆåŠ¨æ€åœ°è®¡ç®—å‡º timeout çš„ï¼‰ å¿«é€Ÿé‡ä¼ æœºåˆ¶äºæ˜¯ï¼ŒTCP å¼•å…¥äº†ä¸€ç§å«Fast Retransmit çš„ç®—æ³•ï¼Œä¸ä»¥æ—¶é—´é©±åŠ¨ï¼Œè€Œä»¥æ•°æ®é©±åŠ¨é‡ä¼ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœï¼ŒåŒ…æ²¡æœ‰è¿ç»­åˆ°è¾¾ï¼Œå°± ack æœ€åé‚£ä¸ªå¯èƒ½è¢«ä¸¢äº†çš„åŒ…ï¼Œå¦‚æœå‘é€æ–¹è¿ç»­æ”¶åˆ° 3 æ¬¡ç›¸åŒçš„ ackï¼Œå°±é‡ä¼ ã€‚Fast Retransmit çš„å¥½å¤„æ˜¯ä¸ç”¨ç­‰ timeout äº†å†é‡ä¼ ã€‚ æ¯”å¦‚ï¼šå¦‚æœå‘é€æ–¹å‘å‡ºäº† 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5 ä»½æ•°æ®ï¼Œç¬¬ä¸€ä»½å…ˆåˆ°é€äº†ï¼Œäºæ˜¯å°± ack å› 2ï¼Œç»“æœ 2 å› ä¸ºæŸäº›åŸå› æ²¡æ”¶åˆ°ï¼Œ3 åˆ°è¾¾äº†ï¼Œäºæ˜¯è¿˜æ˜¯ ack å› 2ï¼Œåé¢çš„ 4 å’Œ 5 éƒ½åˆ°äº†ï¼Œä½†æ˜¯è¿˜æ˜¯ ack å› 2ï¼Œå› ä¸º 2 è¿˜æ˜¯æ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯å‘é€ç«¯æ”¶åˆ°äº†ä¸‰ä¸ª ack=2 çš„ç¡®è®¤ï¼ŒçŸ¥é“äº† 2 è¿˜æ²¡æœ‰åˆ°ï¼Œäºæ˜¯å°±é©¬ä¸Šé‡è½¬ 2ã€‚ç„¶åï¼Œæ¥æ”¶ç«¯æ”¶åˆ°äº† 2ï¼Œæ­¤æ—¶å› ä¸º 3ï¼Œ4ï¼Œ5 éƒ½æ”¶åˆ°äº†ï¼Œäºæ˜¯ ack å› 6ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š Fast Retransmit åªè§£å†³äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ timeout çš„é—®é¢˜ï¼Œå®ƒä¾ç„¶é¢ä¸´ä¸€ä¸ªè‰°éš¾çš„é€‰æ‹©ï¼Œå°±æ˜¯ï¼Œæ˜¯é‡ä¼ ä¹‹å‰çš„ä¸€ä¸ªè¿˜æ˜¯é‡ä¼ æ‰€æœ‰çš„é—®é¢˜ã€‚å¯¹äºä¸Šé¢çš„ç¤ºä¾‹æ¥è¯´ï¼Œæ˜¯é‡ä¼ #2 å‘¢è¿˜æ˜¯é‡ä¼ #2ï¼Œ#3ï¼Œ#4ï¼Œ#5 å‘¢ï¼Ÿå› ä¸ºå‘é€ç«¯å¹¶ä¸æ¸…æ¥šè¿™è¿ç»­çš„ 3 ä¸ª ack(2)æ˜¯è°ä¼ å›æ¥çš„ï¼Ÿä¹Ÿè®¸å‘é€ç«¯å‘äº† 20 ä»½æ•°æ®ï¼Œæ˜¯#6ï¼Œ#10ï¼Œ#20 ä¼ æ¥çš„å‘¢ã€‚è¿™æ ·ï¼Œå‘é€ç«¯å¾ˆæœ‰å¯èƒ½è¦é‡ä¼ ä» 2 åˆ° 20 çš„è¿™å †æ•°æ®ï¼ˆè¿™å°±æ˜¯æŸäº› TCP çš„å®é™…çš„å®ç°ï¼‰ã€‚å¯è§ï¼Œè¿™æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚ SACK æ–¹æ³•å¦å¤–ä¸€ç§æ›´å¥½çš„æ–¹å¼å«ï¼šSelective Acknowledgment (SACK)ï¼ˆå‚çœ‹RFC 2018ï¼‰ï¼Œè¿™ç§æ–¹å¼éœ€è¦åœ¨ TCP å¤´é‡ŒåŠ ä¸€ä¸ª SACK çš„ä¸œè¥¿ï¼ŒACK è¿˜æ˜¯ Fast Retransmit çš„ ACKï¼ŒSACK åˆ™æ˜¯æ±‡æŠ¥æ”¶åˆ°çš„æ•°æ®ç¢ç‰ˆã€‚å‚çœ‹ä¸‹å›¾ï¼š è¿™æ ·ï¼Œåœ¨å‘é€ç«¯å°±å¯ä»¥æ ¹æ®å›ä¼ çš„ SACK æ¥çŸ¥é“å“ªäº›æ•°æ®åˆ°äº†ï¼Œå“ªäº›æ²¡æœ‰åˆ°ã€‚äºæ˜¯å°±ä¼˜åŒ–äº† Fast Retransmit çš„ç®—æ³•ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåè®®éœ€è¦ä¸¤è¾¹éƒ½æ”¯æŒã€‚åœ¨ Linux ä¸‹ï¼Œå¯ä»¥é€šè¿‡tcp_sackå‚æ•°æ‰“å¼€è¿™ä¸ªåŠŸèƒ½ï¼ˆLinux 2.4 åé»˜è®¤æ‰“å¼€ï¼‰ã€‚ è¿™é‡Œè¿˜éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜â€”â€”æ¥æ”¶æ–¹ Renegingï¼Œæ‰€è°“ Reneging çš„æ„æ€å°±æ˜¯æ¥æ”¶æ–¹æœ‰æƒæŠŠå·²ç»æŠ¥ç»™å‘é€ç«¯ SACK é‡Œçš„æ•°æ®ç»™ä¸¢äº†ã€‚è¿™æ ·å¹²æ˜¯ä¸è¢«é¼“åŠ±çš„ï¼Œå› ä¸ºè¿™ä¸ªäº‹ä¼šæŠŠé—®é¢˜å¤æ‚åŒ–äº†ï¼Œä½†æ˜¯ï¼Œæ¥æ”¶æ–¹è¿™ä¹ˆåšå¯èƒ½ä¼šæœ‰äº›æç«¯æƒ…å†µï¼Œæ¯”å¦‚è¦æŠŠå†…å­˜ç»™åˆ«çš„æ›´é‡è¦çš„ä¸œè¥¿ã€‚æ‰€ä»¥ï¼Œå‘é€æ–¹ä¹Ÿä¸èƒ½å®Œå…¨ä¾èµ– SACKï¼Œè¿˜æ˜¯è¦ä¾èµ– ACKï¼Œå¹¶ç»´æŠ¤ Time-Outï¼Œå¦‚æœåç»­çš„ ACK æ²¡æœ‰å¢é•¿ï¼Œé‚£ä¹ˆè¿˜æ˜¯è¦æŠŠ SACK çš„ä¸œè¥¿é‡ä¼ ï¼Œå¦å¤–ï¼Œæ¥æ”¶ç«¯è¿™è¾¹æ°¸è¿œä¸èƒ½æŠŠ SACK çš„åŒ…æ ‡è®°ä¸º Ackã€‚ æ³¨æ„ï¼šSACK ä¼šæ¶ˆè´¹å‘é€æ–¹çš„èµ„æºï¼Œè¯•æƒ³ï¼Œå¦‚æœä¸€ä¸ªæ”»å‡»è€…ç»™æ•°æ®å‘é€æ–¹å‘ä¸€å † SACK çš„é€‰é¡¹ï¼Œè¿™ä¼šå¯¼è‡´å‘é€æ–¹å¼€å§‹è¦é‡ä¼ ç”šè‡³éå†å·²ç»å‘å‡ºçš„æ•°æ®ï¼Œè¿™ä¼šæ¶ˆè€—å¾ˆå¤šå‘é€ç«¯çš„èµ„æºã€‚ Duplicate SACK â€“ é‡å¤æ”¶åˆ°æ•°æ®çš„é—®é¢˜Duplicate SACK åˆç§° D-SACKï¼Œå…¶ä¸»è¦ä½¿ç”¨äº† SACK æ¥å‘Šè¯‰å‘é€æ–¹æœ‰å“ªäº›æ•°æ®è¢«é‡å¤æ¥æ”¶äº†ã€‚RFC-2883 é‡Œæœ‰è¯¦ç»†æè¿°å’Œç¤ºä¾‹ã€‚ä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­ï¼ˆæ¥æºäºRFC-2883ï¼‰ D-SACK ä½¿ç”¨äº† SACK çš„ç¬¬ä¸€ä¸ªæ®µæ¥åšæ ‡å¿—ï¼Œ å¦‚æœ SACK çš„ç¬¬ä¸€ä¸ªæ®µçš„èŒƒå›´è¢« ACK æ‰€è¦†ç›–ï¼Œé‚£ä¹ˆå°±æ˜¯ D-SACK å¦‚æœ SACK çš„ç¬¬ä¸€ä¸ªæ®µçš„èŒƒå›´è¢« SACK çš„ç¬¬äºŒä¸ªæ®µè¦†ç›–ï¼Œé‚£ä¹ˆå°±æ˜¯ D-SACK ç¤ºä¾‹ä¸€ï¼šACK ä¸¢åŒ…ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œä¸¢äº†ä¸¤ä¸ª ACKï¼Œæ‰€ä»¥ï¼Œå‘é€ç«¯é‡ä¼ äº†ç¬¬ä¸€ä¸ªæ•°æ®åŒ…ï¼ˆ3000-3499ï¼‰ï¼Œäºæ˜¯æ¥æ”¶ç«¯å‘ç°é‡å¤æ”¶åˆ°ï¼Œäºæ˜¯å›äº†ä¸€ä¸ª SACK=3000-3500ï¼Œå› ä¸º ACK éƒ½åˆ°äº† 4000 æ„å‘³ç€æ”¶åˆ°äº† 4000 ä¹‹å‰çš„æ‰€æœ‰æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸ª SACK å°±æ˜¯ D-SACKâ€”â€”æ—¨åœ¨å‘Šè¯‰å‘é€ç«¯æˆ‘æ”¶åˆ°äº†é‡å¤çš„æ•°æ®ï¼Œè€Œä¸”æˆ‘ä»¬çš„å‘é€ç«¯è¿˜çŸ¥é“ï¼Œæ•°æ®åŒ…æ²¡æœ‰ä¸¢ï¼Œä¸¢çš„æ˜¯ ACK åŒ…ã€‚ 123456Transmitted Received ACK SentSegment Segment (Including SACK Blocks)3000-3499 3000-3499 3500 (ACK dropped)3500-3999 3500-3999 4000 (ACK dropped)3000-3499 3000-3499 4000, SACK=3000-3500 --------- ç¤ºä¾‹äºŒï¼Œç½‘ç»œå»¶è¯¯ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œç½‘ç»œåŒ…ï¼ˆ1000-1499ï¼‰è¢«ç½‘ç»œç»™å»¶è¯¯äº†ï¼Œå¯¼è‡´å‘é€æ–¹æ²¡æœ‰æ”¶åˆ° ACKï¼Œè€Œåé¢åˆ°è¾¾çš„ä¸‰ä¸ªåŒ…è§¦å‘äº†â€œFast Retransmit ç®—æ³•â€ï¼Œæ‰€ä»¥é‡ä¼ ï¼Œä½†é‡ä¼ æ—¶ï¼Œè¢«å»¶è¯¯çš„åŒ…åˆåˆ°äº†ï¼Œæ‰€ä»¥ï¼Œå›äº†ä¸€ä¸ª SACK=1000-1500ï¼Œå› ä¸º ACK å·²åˆ°äº† 3000ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ª SACK æ˜¯ D-SACKâ€”â€”æ ‡è¯†æ”¶åˆ°äº†é‡å¤çš„åŒ…ã€‚ è¿™ä¸ªæ¡ˆä¾‹ä¸‹ï¼Œå‘é€ç«¯çŸ¥é“ä¹‹å‰å› ä¸ºâ€œFast Retransmit ç®—æ³•â€è§¦å‘çš„é‡ä¼ ä¸æ˜¯å› ä¸ºå‘å‡ºå»çš„åŒ…ä¸¢äº†ï¼Œä¹Ÿä¸æ˜¯å› ä¸ºå›åº”çš„ ACK åŒ…ä¸¢äº†ï¼Œè€Œæ˜¯å› ä¸ºç½‘ç»œå»¶æ—¶äº†ã€‚ 12345678910Transmitted Received ACK SentSegment Segment (Including SACK Blocks)500-999 500-999 10001000-1499 (delayed)1500-1999 1500-1999 1000, SACK=1500-20002000-2499 2000-2499 1000, SACK=1500-25002500-2999 2500-2999 1000, SACK=1500-30001000-1499 1000-1499 3000 1000-1499 3000, SACK=1000-1500 --------- å¯è§ï¼Œå¼•å…¥äº† D-SACKï¼Œæœ‰è¿™ä¹ˆå‡ ä¸ªå¥½å¤„ï¼š 1ï¼‰å¯ä»¥è®©å‘é€æ–¹çŸ¥é“ï¼Œæ˜¯å‘å‡ºå»çš„åŒ…ä¸¢äº†ï¼Œè¿˜æ˜¯å›æ¥çš„ ACK åŒ…ä¸¢äº†ã€‚ 2ï¼‰æ˜¯ä¸æ˜¯è‡ªå·±çš„ timeout å¤ªå°äº†ï¼Œå¯¼è‡´é‡ä¼ ã€‚ 3ï¼‰ç½‘ç»œä¸Šå‡ºç°äº†å…ˆå‘çš„åŒ…ååˆ°çš„æƒ…å†µï¼ˆåˆç§° reorderingï¼‰ 4ï¼‰ç½‘ç»œä¸Šæ˜¯ä¸æ˜¯æŠŠæˆ‘çš„æ•°æ®åŒ…ç»™å¤åˆ¶äº†ã€‚ çŸ¥é“è¿™äº›ä¸œè¥¿å¯ä»¥å¾ˆå¥½å¾—å¸®åŠ© TCP äº†è§£ç½‘ç»œæƒ…å†µï¼Œä»è€Œå¯ä»¥æ›´å¥½çš„åšç½‘ç»œä¸Šçš„æµæ§ã€‚ Linux ä¸‹çš„ tcp_dsack å‚æ•°ç”¨äºå¼€å¯è¿™ä¸ªåŠŸèƒ½ï¼ˆLinux 2.4 åé»˜è®¤æ‰“å¼€ï¼‰ TCP çš„ RTT ç®—æ³•ä»å‰é¢çš„ TCP é‡ä¼ æœºåˆ¶æˆ‘ä»¬çŸ¥é“ Timeout çš„è®¾ç½®å¯¹äºé‡ä¼ éå¸¸é‡è¦ã€‚ è®¾é•¿äº†ï¼Œé‡å‘å°±æ…¢ï¼Œä¸¢äº†è€åŠå¤©æ‰é‡å‘ï¼Œæ²¡æœ‰æ•ˆç‡ï¼Œæ€§èƒ½å·®ï¼› è®¾çŸ­äº†ï¼Œä¼šå¯¼è‡´å¯èƒ½å¹¶æ²¡æœ‰ä¸¢å°±é‡å‘ã€‚äºæ˜¯é‡å‘çš„å°±å¿«ï¼Œä¼šå¢åŠ ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´æ›´å¤šçš„è¶…æ—¶ï¼Œæ›´å¤šçš„è¶…æ—¶å¯¼è‡´æ›´å¤šçš„é‡å‘ã€‚ è€Œä¸”ï¼Œè¿™ä¸ªè¶…æ—¶æ—¶é—´åœ¨ä¸åŒçš„ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œæ ¹æœ¬æ²¡æœ‰åŠæ³•è®¾ç½®ä¸€ä¸ªæ­»çš„å€¼ã€‚åªèƒ½åŠ¨æ€åœ°è®¾ç½®ã€‚ ä¸ºäº†åŠ¨æ€åœ°è®¾ç½®ï¼ŒTCP å¼•å…¥äº† RTTâ€”â€”Round Trip Timeï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°æ®åŒ…ä»å‘å‡ºå»åˆ°å›æ¥çš„æ—¶é—´ã€‚è¿™æ ·å‘é€ç«¯å°±å¤§çº¦çŸ¥é“éœ€è¦å¤šå°‘çš„æ—¶é—´ï¼Œä»è€Œå¯ä»¥æ–¹ä¾¿åœ°è®¾ç½® Timeoutâ€”â€”RTOï¼ˆRetransmission TimeOutï¼‰ï¼Œä»¥è®©æˆ‘ä»¬çš„é‡ä¼ æœºåˆ¶æ›´é«˜æ•ˆã€‚ å¬èµ·æ¥ä¼¼ä¹å¾ˆç®€å•ï¼Œå¥½åƒå°±æ˜¯åœ¨å‘é€ç«¯å‘åŒ…æ—¶è®°ä¸‹ t0ï¼Œç„¶åæ¥æ”¶ç«¯å†æŠŠè¿™ä¸ª ack å›æ¥æ—¶å†è®°ä¸€ä¸ª t1ï¼Œäºæ˜¯ RTT = t1 â€“ t0ã€‚æ²¡é‚£ä¹ˆç®€å•ï¼Œè¿™åªæ˜¯ä¸€ä¸ªé‡‡æ ·ï¼Œä¸èƒ½ä»£è¡¨æ™®éæƒ…å†µã€‚ ç»å…¸ç®—æ³•RFC793 ä¸­å®šä¹‰çš„ç»å…¸ç®—æ³•æ˜¯è¿™æ ·çš„ï¼š 1ï¼‰é¦–å…ˆï¼Œå…ˆé‡‡æ · RTTï¼Œè®°ä¸‹æœ€è¿‘å¥½å‡ æ¬¡çš„ RTT å€¼ã€‚ 2ï¼‰ç„¶ååšå¹³æ»‘è®¡ç®— SRTTï¼ˆ Smoothed RTTï¼‰ã€‚å…¬å¼ä¸ºï¼šï¼ˆå…¶ä¸­çš„ Î± å–å€¼åœ¨ 0.8 åˆ° 0.9 ä¹‹é—´ï¼Œè¿™ä¸ªç®—æ³•è‹±æ–‡å« Exponential weighted moving averageï¼Œä¸­æ–‡å«ï¼šåŠ æƒç§»åŠ¨å¹³å‡ï¼‰ SRTT = ( Î± * SRTT ) + ((1- Î±) * RTT) 3ï¼‰å¼€å§‹è®¡ç®— RTOã€‚å…¬å¼å¦‚ä¸‹ï¼š RTO = min [ UBOUND, max [ LBOUND, (Î² * SRTT) ] ] å…¶ä¸­ï¼š UBOUND æ˜¯æœ€å¤§çš„ timeout æ—¶é—´ï¼Œä¸Šé™å€¼ LBOUND æ˜¯æœ€å°çš„ timeout æ—¶é—´ï¼Œä¸‹é™å€¼ Î² å€¼ä¸€èˆ¬åœ¨ 1.3 åˆ° 2.0 ä¹‹é—´ã€‚ Karn / Partridge ç®—æ³•ä½†æ˜¯ä¸Šé¢çš„è¿™ä¸ªç®—æ³•åœ¨é‡ä¼ çš„æ—¶å€™ä¼šå‡ºæœ‰ä¸€ä¸ªç»ˆæé—®é¢˜â€”â€”ä½ æ˜¯ç”¨ç¬¬ä¸€æ¬¡å‘æ•°æ®çš„æ—¶é—´å’Œ ack å›æ¥çš„æ—¶é—´åš RTT æ ·æœ¬å€¼ï¼Œè¿˜æ˜¯ç”¨é‡ä¼ çš„æ—¶é—´å’Œ ACK å›æ¥çš„æ—¶é—´åš RTT æ ·æœ¬å€¼ï¼Ÿ è¿™ä¸ªé—®é¢˜æ— è®ºä½ é€‰é‚£å¤´éƒ½æ˜¯æŒ‰ä¸‹è‘«èŠ¦èµ·äº†ç“¢ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æƒ…å†µï¼ˆaï¼‰æ˜¯ ack æ²¡å›æ¥ï¼Œæ‰€ä»¥é‡ä¼ ã€‚å¦‚æœä½ è®¡ç®—ç¬¬ä¸€æ¬¡å‘é€å’Œ ACK çš„æ—¶é—´ï¼Œé‚£ä¹ˆï¼Œæ˜æ˜¾ç®—å¤§äº†ã€‚ æƒ…å†µï¼ˆbï¼‰æ˜¯ ack å›æ¥æ…¢äº†ï¼Œä½†æ˜¯å¯¼è‡´äº†é‡ä¼ ï¼Œä½†åˆšé‡ä¼ ä¸ä¸€ä¼šå„¿ï¼Œä¹‹å‰ ACK å°±å›æ¥äº†ã€‚å¦‚æœä½ æ˜¯ç®—é‡ä¼ çš„æ—¶é—´å’Œ ACK å›æ¥çš„æ—¶é—´çš„å·®ï¼Œå°±ä¼šç®—çŸ­äº†ã€‚ æ‰€ä»¥ 1987 å¹´çš„æ—¶å€™ï¼Œæäº†ä¸€ä¸ªå«Karn / Partridge Algorithmï¼Œè¿™ä¸ªç®—æ³•çš„æœ€å¤§ç‰¹ç‚¹æ˜¯â€”â€”å¿½ç•¥é‡ä¼ ï¼Œä¸æŠŠé‡ä¼ çš„ RTT åšé‡‡æ ·ï¼ˆä½ çœ‹ï¼Œä½ ä¸éœ€è¦å»è§£å†³ä¸å­˜åœ¨çš„é—®é¢˜ï¼‰ã€‚ ä½†æ˜¯ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåˆä¼šå¼•å‘ä¸€ä¸ªå¤§ BUGâ€”â€”å¦‚æœåœ¨æŸä¸€æ—¶é—´ï¼Œç½‘ç»œé—ªåŠ¨ï¼Œçªç„¶å˜æ…¢äº†ï¼Œäº§ç”Ÿäº†æ¯”è¾ƒå¤§çš„å»¶æ—¶ï¼Œè¿™ä¸ªå»¶æ—¶å¯¼è‡´è¦é‡è½¬æ‰€æœ‰çš„åŒ…ï¼ˆå› ä¸ºä¹‹å‰çš„ RTO å¾ˆå°ï¼‰ï¼Œäºæ˜¯ï¼Œå› ä¸ºé‡è½¬çš„ä¸ç®—ï¼Œæ‰€ä»¥ï¼ŒRTO å°±ä¸ä¼šè¢«æ›´æ–°ï¼Œè¿™æ˜¯ä¸€ä¸ªç¾éš¾ã€‚ äºæ˜¯ Karn ç®—æ³•ç”¨äº†ä¸€ä¸ªå–å·§çš„æ–¹å¼â€”â€”åªè¦ä¸€å‘ç”Ÿé‡ä¼ ï¼Œå°±å¯¹ç°æœ‰çš„ RTO å€¼ç¿»å€ï¼ˆè¿™å°±æ˜¯æ‰€è°“çš„ Exponential backoffï¼‰ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™ç§æ­»è§„çŸ©å¯¹äºä¸€ä¸ªéœ€è¦ä¼°è®¡æ¯”è¾ƒå‡†ç¡®çš„ RTT ä¹Ÿä¸é è°±ã€‚ Jacobson / Karels ç®—æ³•å‰é¢ä¸¤ç§ç®—æ³•ç”¨çš„éƒ½æ˜¯â€œåŠ æƒç§»åŠ¨å¹³å‡â€ï¼Œè¿™ç§æ–¹æ³•æœ€å¤§çš„æ¯›ç—…å°±æ˜¯å¦‚æœ RTT æœ‰ä¸€ä¸ªå¤§çš„æ³¢åŠ¨çš„è¯ï¼Œå¾ˆéš¾è¢«å‘ç°ï¼Œå› ä¸ºè¢«å¹³æ»‘æ‰äº†ã€‚æ‰€ä»¥ï¼Œ1988 å¹´ï¼Œåˆæœ‰äººæ¨å‡ºæ¥äº†ä¸€ä¸ªæ–°çš„ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•å« Jacobson / Karels Algorithmï¼ˆå‚çœ‹RFC6289ï¼‰ã€‚è¿™ä¸ªç®—æ³•å¼•å…¥äº†æœ€æ–°çš„ RTT çš„é‡‡æ ·å’Œå¹³æ»‘è¿‡çš„ SRTT çš„å·®è·åšå› å­æ¥è®¡ç®—ã€‚ å…¬å¼å¦‚ä¸‹ï¼šï¼ˆå…¶ä¸­çš„ DevRTT æ˜¯ Deviation RTT çš„æ„æ€ï¼‰ SRTT = S**RTT** + Î± (**RTT** â€“ S**RTT**) â€”â€” è®¡ç®—å¹³æ»‘ RTT DevRTT = (1-Î²**)***DevRTT + Î²***(|**RTT-SRTT**|)** â€”â€”è®¡ç®—å¹³æ»‘ RTT å’ŒçœŸå®çš„å·®è·ï¼ˆåŠ æƒç§»åŠ¨å¹³å‡ï¼‰ RTO= Âµ * SRTT + âˆ‚ *DevRTT â€”â€” ç¥ä¸€æ ·çš„å…¬å¼ ï¼ˆå…¶ä¸­ï¼šåœ¨ Linux ä¸‹ï¼ŒÎ± = 0.125ï¼ŒÎ² = 0.25ï¼Œ Î¼ = 1ï¼Œâˆ‚ = 4 â€”â€”è¿™å°±æ˜¯ç®—æ³•ä¸­çš„â€œè°ƒå¾—ä¸€æ‰‹å¥½å‚æ•°â€ï¼Œnobody knows why, it just worksâ€¦ï¼‰ æœ€åçš„è¿™ä¸ªç®—æ³•åœ¨è¢«ç”¨åœ¨ä»Šå¤©çš„ TCP åè®®ä¸­ï¼ˆLinux çš„æºä»£ç åœ¨ï¼štcp_rtt_estimatorï¼‰ã€‚ TCP æ»‘åŠ¨çª—å£éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚æœä½ ä¸äº†è§£ TCP çš„æ»‘åŠ¨çª—å£è¿™ä¸ªäº‹ï¼Œä½ ç­‰äºä¸äº†è§£ TCP åè®®ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒTCP å¿…éœ€è¦è§£å†³çš„å¯é ä¼ è¾“ä»¥åŠåŒ…ä¹±åºï¼ˆreorderingï¼‰çš„é—®é¢˜ï¼Œæ‰€ä»¥ï¼ŒTCP å¿…éœ€è¦çŸ¥é“ç½‘ç»œå®é™…çš„æ•°æ®å¤„ç†å¸¦å®½æˆ–æ˜¯æ•°æ®å¤„ç†é€Ÿåº¦ï¼Œè¿™æ ·æ‰ä¸ä¼šå¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´ä¸¢åŒ…ã€‚ æ‰€ä»¥ï¼ŒTCP å¼•å…¥äº†ä¸€äº›æŠ€æœ¯å’Œè®¾è®¡æ¥åšç½‘ç»œæµæ§ï¼ŒSliding Window æ˜¯å…¶ä¸­ä¸€ä¸ªæŠ€æœ¯ã€‚ å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼ŒTCP å¤´é‡Œæœ‰ä¸€ä¸ªå­—æ®µå« Windowï¼Œåˆå« Advertised-Windowï¼Œè¿™ä¸ªå­—æ®µæ˜¯æ¥æ”¶ç«¯å‘Šè¯‰å‘é€ç«¯è‡ªå·±è¿˜æœ‰å¤šå°‘ç¼“å†²åŒºå¯ä»¥æ¥æ”¶æ•°æ®ã€‚äºæ˜¯å‘é€ç«¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›æ¥å‘é€æ•°æ®ï¼Œè€Œä¸ä¼šå¯¼è‡´æ¥æ”¶ç«¯å¤„ç†ä¸è¿‡æ¥ã€‚ ä¸ºäº†è¯´æ˜æ»‘åŠ¨çª—å£ï¼Œæˆ‘ä»¬éœ€è¦å…ˆçœ‹ä¸€ä¸‹ TCP ç¼“å†²åŒºçš„ä¸€äº›æ•°æ®ç»“æ„ï¼š ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š æ¥æ”¶ç«¯ LastByteRead æŒ‡å‘äº† TCP ç¼“å†²åŒºä¸­è¯»åˆ°çš„ä½ç½®ï¼ŒNextByteExpected æŒ‡å‘çš„åœ°æ–¹æ˜¯æ”¶åˆ°çš„è¿ç»­åŒ…çš„æœ€åä¸€ä¸ªä½ç½®ï¼ŒLastByteRcved æŒ‡å‘çš„æ˜¯æ”¶åˆ°çš„åŒ…çš„æœ€åä¸€ä¸ªä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸­é—´æœ‰äº›æ•°æ®è¿˜æ²¡æœ‰åˆ°è¾¾ï¼Œæ‰€ä»¥æœ‰æ•°æ®ç©ºç™½åŒºã€‚ å‘é€ç«¯çš„ LastByteAcked æŒ‡å‘äº†è¢«æ¥æ”¶ç«¯ Ack è¿‡çš„ä½ç½®ï¼ˆè¡¨ç¤ºæˆåŠŸå‘é€ç¡®è®¤ï¼‰ï¼ŒLastByteSent è¡¨ç¤ºå‘å‡ºå»äº†ï¼Œä½†è¿˜æ²¡æœ‰æ”¶åˆ°æˆåŠŸç¡®è®¤çš„ Ackï¼ŒLastByteWritten æŒ‡å‘çš„æ˜¯ä¸Šå±‚åº”ç”¨æ­£åœ¨å†™çš„åœ°æ–¹ã€‚ äºæ˜¯ï¼š æ¥æ”¶ç«¯åœ¨ç»™å‘é€ç«¯å› ACK ä¸­ä¼šæ±‡æŠ¥è‡ªå·±çš„ AdvertisedWindow = MaxRcvBuffer â€“ LastByteRcvd â€“ 1; è€Œå‘é€æ–¹ä¼šæ ¹æ®è¿™ä¸ªçª—å£æ¥æ§åˆ¶å‘é€æ•°æ®çš„å¤§å°ï¼Œä»¥ä¿è¯æ¥æ”¶æ–¹å¯ä»¥å¤„ç†ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‘é€æ–¹çš„æ»‘åŠ¨çª—å£ç¤ºæ„å›¾ï¼š ä¸Šå›¾ä¸­åˆ†æˆäº†å››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šï¼ˆå…¶ä¸­é‚£ä¸ªé»‘æ¨¡å‹å°±æ˜¯æ»‘åŠ¨çª—å£ï¼‰ #1 å·²æ”¶åˆ° ack ç¡®è®¤çš„æ•°æ®ã€‚ #2 å‘è¿˜æ²¡æ”¶åˆ° ack çš„ã€‚ #3 åœ¨çª—å£ä¸­è¿˜æ²¡æœ‰å‘å‡ºçš„ï¼ˆæ¥æ”¶æ–¹è¿˜æœ‰ç©ºé—´ï¼‰ã€‚ #4 çª—å£ä»¥å¤–çš„æ•°æ®ï¼ˆæ¥æ”¶æ–¹æ²¡ç©ºé—´ï¼‰ ä¸‹é¢æ˜¯ä¸ªæ»‘åŠ¨åçš„ç¤ºæ„å›¾ï¼ˆæ”¶åˆ° 36 çš„ ackï¼Œå¹¶å‘å‡ºäº† 46-51 çš„å­—èŠ‚ï¼‰ï¼š ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ¥å—ç«¯æ§åˆ¶å‘é€ç«¯çš„å›¾ç¤ºï¼š Zero Windowä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¤„ç†ç¼“æ…¢çš„ Serverï¼ˆæ¥æ”¶ç«¯ï¼‰æ˜¯æ€ä¹ˆæŠŠ Clientï¼ˆå‘é€ç«¯ï¼‰çš„ TCP Sliding Window ç»™é™æˆ 0 çš„ã€‚æ­¤æ—¶ï¼Œä½ ä¸€å®šä¼šé—®ï¼Œå¦‚æœ Window å˜æˆ 0 äº†ï¼ŒTCP ä¼šæ€ä¹ˆæ ·ï¼Ÿæ˜¯ä¸æ˜¯å‘é€ç«¯å°±ä¸å‘æ•°æ®äº†ï¼Ÿæ˜¯çš„ï¼Œå‘é€ç«¯å°±ä¸å‘æ•°æ®äº†ï¼Œä½ å¯ä»¥æƒ³åƒæˆâ€œWindow Closedâ€ï¼Œé‚£ä½ ä¸€å®šè¿˜ä¼šé—®ï¼Œå¦‚æœå‘é€ç«¯ä¸å‘æ•°æ®äº†ï¼Œæ¥æ”¶æ–¹ä¸€ä¼šå„¿ Window size å¯ç”¨äº†ï¼Œæ€ä¹ˆé€šçŸ¥å‘é€ç«¯å‘¢ï¼Ÿ è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒTCP ä½¿ç”¨äº† Zero Window Probe æŠ€æœ¯ï¼Œç¼©å†™ä¸º ZWPï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€ç«¯åœ¨çª—å£å˜æˆ 0 åï¼Œä¼šå‘ ZWP çš„åŒ…ç»™æ¥æ”¶æ–¹ï¼Œè®©æ¥æ”¶æ–¹æ¥ ack ä»–çš„ Window å°ºå¯¸ï¼Œä¸€èˆ¬è¿™ä¸ªå€¼ä¼šè®¾ç½®æˆ 3 æ¬¡ï¼Œç¬¬æ¬¡å¤§çº¦ 30-60 ç§’ï¼ˆä¸åŒçš„å®ç°å¯èƒ½ä¼šä¸ä¸€æ ·ï¼‰ã€‚å¦‚æœ 3 æ¬¡è¿‡åè¿˜æ˜¯ 0 çš„è¯ï¼Œæœ‰çš„ TCP å®ç°å°±ä¼šå‘ RST æŠŠé“¾æ¥æ–­äº†ã€‚ æ³¨æ„ï¼šåªè¦æœ‰ç­‰å¾…çš„åœ°æ–¹éƒ½å¯èƒ½å‡ºç° DDoS æ”»å‡»ï¼ŒZero Window ä¹Ÿä¸ä¾‹å¤–ï¼Œä¸€äº›æ”»å‡»è€…ä¼šåœ¨å’Œ HTTP å»ºå¥½é“¾å‘å®Œ GET è¯·æ±‚åï¼Œå°±æŠŠ Window è®¾ç½®ä¸º 0ï¼Œç„¶åæœåŠ¡ç«¯å°±åªèƒ½ç­‰å¾…è¿›è¡Œ ZWPï¼Œäºæ˜¯æ”»å‡»è€…ä¼šå¹¶å‘å¤§é‡çš„è¿™æ ·çš„è¯·æ±‚ï¼ŒæŠŠæœåŠ¡å™¨ç«¯çš„èµ„æºè€—å°½ã€‚ï¼ˆå…³äºè¿™æ–¹é¢çš„æ”»å‡»ï¼Œå¤§å®¶å¯ä»¥ç§»æ­¥çœ‹ä¸€ä¸‹Wikipedia çš„ SockStress è¯æ¡ï¼‰ å¦å¤–ï¼ŒWireshark ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ tcp.analysis.zero_window æ¥è¿‡æ»¤åŒ…ï¼Œç„¶åä½¿ç”¨å³é”®èœå•é‡Œçš„ follow TCP streamï¼Œä½ å¯ä»¥çœ‹åˆ° ZeroWindowProbe åŠ ZeroWindowProbeAck çš„åŒ…ã€‚ Silly Window SyndromeSilly Window Syndrome ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯â€œç³Šæ¶‚çª—å£ç»¼åˆç—‡â€ã€‚æ­£å¦‚ä½ ä¸Šé¢çœ‹åˆ°çš„ä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬çš„æ¥æ”¶æ–¹å¤ªå¿™äº†ï¼Œæ¥ä¸åŠå–èµ° Receive Windows é‡Œçš„æ•°æ®ï¼Œé‚£ä¹ˆï¼Œå°±ä¼šå¯¼è‡´å‘é€æ–¹è¶Šæ¥è¶Šå°ã€‚åˆ°æœ€åï¼Œå¦‚æœæ¥æ”¶æ–¹è…¾å‡ºå‡ ä¸ªå­—èŠ‚å¹¶å‘Šè¯‰å‘é€æ–¹ç°åœ¨æœ‰å‡ ä¸ªå­—èŠ‚çš„ windowï¼Œè€Œæˆ‘ä»¬çš„å‘é€æ–¹ä¼šä¹‰æ— åé¡¾åœ°å‘é€è¿™å‡ ä¸ªå­—èŠ‚ã€‚ è¦çŸ¥é“ï¼Œæˆ‘ä»¬çš„ TCP+IP å¤´æœ‰ 40 ä¸ªå­—èŠ‚ï¼Œä¸ºäº†å‡ ä¸ªå­—èŠ‚ï¼Œè¦è¾¾ä¸Šè¿™ä¹ˆå¤§çš„å¼€é”€ï¼Œè¿™å¤ªä¸ç»æµäº†ã€‚ å¦å¤–ï¼Œä½ éœ€è¦çŸ¥é“ç½‘ç»œä¸Šæœ‰ä¸ª MTUï¼Œå¯¹äºä»¥å¤ªç½‘æ¥è¯´ï¼ŒMTU æ˜¯ 1500 å­—èŠ‚ï¼Œé™¤å» TCP+IP å¤´çš„ 40 ä¸ªå­—èŠ‚ï¼ŒçœŸæ­£çš„æ•°æ®ä¼ è¾“å¯ä»¥æœ‰ 1460ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ MSSï¼ˆMax Segment Sizeï¼‰æ³¨æ„ï¼ŒTCP çš„ RFC å®šä¹‰è¿™ä¸ª MSS çš„é»˜è®¤å€¼æ˜¯ 536ï¼Œè¿™æ˜¯å› ä¸º RFC 791é‡Œè¯´äº†ä»»ä½•ä¸€ä¸ª IP è®¾å¤‡éƒ½å¾—æœ€å°‘æ¥æ”¶ 576 å°ºå¯¸çš„å¤§å°ï¼ˆå®é™…ä¸Šæ¥è¯´ 576 æ˜¯æ‹¨å·çš„ç½‘ç»œçš„ MTUï¼Œè€Œ 576 å‡å» IP å¤´çš„ 20 ä¸ªå­—èŠ‚å°±æ˜¯ 536ï¼‰ã€‚ å¦‚æœä½ çš„ç½‘ç»œåŒ…å¯ä»¥å¡æ»¡ MTUï¼Œé‚£ä¹ˆä½ å¯ä»¥ç”¨æ»¡æ•´ä¸ªå¸¦å®½ï¼Œå¦‚æœä¸èƒ½ï¼Œé‚£ä¹ˆä½ å°±ä¼šæµªè´¹å¸¦å®½ã€‚ï¼ˆå¤§äº MTU çš„åŒ…æœ‰ä¸¤ç§ç»“å±€ï¼Œä¸€ç§æ˜¯ç›´æ¥è¢«ä¸¢äº†ï¼Œå¦ä¸€ç§æ˜¯ä¼šè¢«é‡æ–°åˆ†å—æ‰“åŒ…å‘é€ï¼‰ ä½ å¯ä»¥æƒ³åƒæˆä¸€ä¸ª MTU å°±ç›¸å½“äºä¸€ä¸ªé£æœºçš„æœ€å¤šå¯ä»¥è£…çš„äººï¼Œå¦‚æœè¿™é£æœºé‡Œæ»¡è½½çš„è¯ï¼Œå¸¦å®½æœ€é«˜ï¼Œå¦‚æœä¸€ä¸ªé£æœºåªè¿ä¸€ä¸ªäººçš„è¯ï¼Œæ— ç–‘æˆæœ¬å¢åŠ äº†ï¼Œä¹Ÿè€Œç›¸å½“äºŒã€‚ æ‰€ä»¥ï¼ŒSilly Windows Syndrome è¿™ä¸ªç°åƒå°±åƒæ˜¯ä½ æœ¬æ¥å¯ä»¥å 200 äººçš„é£æœºé‡Œåªåšäº†ä¸€ä¸¤ä¸ªäººã€‚ è¦è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯é¿å…å¯¹å°çš„ window size åšå‡ºå“åº”ï¼Œç›´åˆ°æœ‰è¶³å¤Ÿå¤§çš„ window size å†å“åº”ï¼Œè¿™ä¸ªæ€è·¯å¯ä»¥åŒæ—¶å®ç°åœ¨ sender å’Œ receiver ä¸¤ç«¯ã€‚ å¦‚æœè¿™ä¸ªé—®é¢˜æ˜¯ç”± Receiver ç«¯å¼•èµ·çš„ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨ David D Clarkâ€™s æ–¹æ¡ˆã€‚åœ¨ receiver ç«¯ï¼Œå¦‚æœæ”¶åˆ°çš„æ•°æ®å¯¼è‡´ window size å°äºæŸä¸ªå€¼ï¼Œå¯ä»¥ç›´æ¥ ack(0)å› senderï¼Œè¿™æ ·å°±æŠŠ window ç»™å…³é—­äº†ï¼Œä¹Ÿé˜»æ­¢äº† sender å†å‘æ•°æ®è¿‡æ¥ï¼Œç­‰åˆ° receiver ç«¯å¤„ç†äº†ä¸€äº›æ•°æ®å windows size å¤§äºç­‰äºäº† MSSï¼Œæˆ–è€…ï¼Œreceiver buffer æœ‰ä¸€åŠä¸ºç©ºï¼Œå°±å¯ä»¥æŠŠ window æ‰“å¼€è®© send å‘é€æ•°æ®è¿‡æ¥ã€‚ å¦‚æœè¿™ä¸ªé—®é¢˜æ˜¯ç”± Sender ç«¯å¼•èµ·çš„ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨è‘—åçš„ Nagleâ€™s algorithmã€‚è¿™ä¸ªç®—æ³•çš„æ€è·¯ä¹Ÿæ˜¯å»¶æ—¶å¤„ç†ï¼Œä»–æœ‰ä¸¤ä¸ªä¸»è¦çš„æ¡ä»¶ï¼š1ï¼‰è¦ç­‰åˆ° Window Size&gt;=MSS æˆ–æ˜¯ Data Size &gt;=MSSï¼Œ2ï¼‰æ”¶åˆ°ä¹‹å‰å‘é€æ•°æ®çš„ ack å›åŒ…ï¼Œä»–æ‰ä¼šå‘æ•°æ®ï¼Œå¦åˆ™å°±æ˜¯åœ¨æ”’æ•°æ®ã€‚ å¦å¤–ï¼ŒNagle ç®—æ³•é»˜è®¤æ˜¯æ‰“å¼€çš„ï¼Œæ‰€ä»¥ï¼Œå¯¹äºä¸€äº›éœ€è¦å°åŒ…åœºæ™¯çš„ç¨‹åºâ€”â€”æ¯”å¦‚åƒ telnet æˆ– ssh è¿™æ ·çš„äº¤äº’æ€§æ¯”è¾ƒå¼ºçš„ç¨‹åºï¼Œä½ éœ€è¦å…³é—­è¿™ä¸ªç®—æ³•ã€‚ä½ å¯ä»¥åœ¨ Socket è®¾ç½® TCP_NODELAY é€‰é¡¹æ¥å…³é—­è¿™ä¸ªç®—æ³•ï¼ˆå…³é—­ Nagle ç®—æ³•æ²¡æœ‰å…¨å±€å‚æ•°ï¼Œéœ€è¦æ ¹æ®æ¯ä¸ªåº”ç”¨è‡ªå·±çš„ç‰¹ç‚¹æ¥å…³é—­ï¼‰ 1setsockopt(sock_fd, IPPROTO_TCP, TCP_NODELAY, (char*)&amp;value,sizeof(int)); å¦å¤–ï¼Œç½‘ä¸Šæœ‰äº›æ–‡ç« è¯´ TCP_CORK çš„ socket option æ˜¯ä¹Ÿå…³é—­ Nagle ç®—æ³•ï¼Œè¿™ä¸å¯¹ã€‚TCP_CORK å…¶å®æ˜¯æ›´æ–°æ¿€è¿›çš„ Nagle ç®—æ±‰ï¼Œå®Œå…¨ç¦æ­¢å°åŒ…å‘é€ï¼Œè€Œ Nagle ç®—æ³•æ²¡æœ‰ç¦æ­¢å°åŒ…å‘é€ï¼Œåªæ˜¯ç¦æ­¢äº†å¤§é‡çš„å°åŒ…å‘é€ã€‚æœ€å¥½ä¸è¦ä¸¤ä¸ªé€‰é¡¹éƒ½è®¾ç½®ã€‚ TCP çš„æ‹¥å¡å¤„ç† â€“ Congestion Handlingä¸Šé¢æˆ‘ä»¬çŸ¥é“äº†ï¼ŒTCP é€šè¿‡ Sliding Window æ¥åšæµæ§ï¼ˆFlow Controlï¼‰ï¼Œä½†æ˜¯ TCP è§‰å¾—è¿™è¿˜ä¸å¤Ÿï¼Œå› ä¸º Sliding Window éœ€è¦ä¾èµ–äºè¿æ¥çš„å‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼Œå…¶å¹¶ä¸çŸ¥é“ç½‘ç»œä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆã€‚TCP çš„è®¾è®¡è€…è§‰å¾—ï¼Œä¸€ä¸ªä¼Ÿå¤§è€Œç‰›é€¼çš„åè®®ä»…ä»…åšåˆ°æµæ§å¹¶ä¸å¤Ÿï¼Œå› ä¸ºæµæ§åªæ˜¯ç½‘ç»œæ¨¡å‹ 4 å±‚ä»¥ä¸Šçš„äº‹ï¼ŒTCP çš„è¿˜åº”è¯¥æ›´èªæ˜åœ°çŸ¥é“æ•´ä¸ªç½‘ç»œä¸Šçš„äº‹ã€‚ å…·ä½“ä¸€ç‚¹ï¼Œæˆ‘ä»¬çŸ¥é“ TCP é€šè¿‡ä¸€ä¸ª timer é‡‡æ ·äº† RTT å¹¶è®¡ç®— RTOï¼Œä½†æ˜¯ï¼Œå¦‚æœç½‘ç»œä¸Šçš„å»¶æ—¶çªç„¶å¢åŠ ï¼Œé‚£ä¹ˆï¼ŒTCP å¯¹è¿™ä¸ªäº‹åšå‡ºçš„åº”å¯¹åªæœ‰é‡ä¼ æ•°æ®ï¼Œä½†æ˜¯ï¼Œé‡ä¼ ä¼šå¯¼è‡´ç½‘ç»œçš„è´Ÿæ‹…æ›´é‡ï¼Œäºæ˜¯ä¼šå¯¼è‡´æ›´å¤§çš„å»¶è¿Ÿä»¥åŠæ›´å¤šçš„ä¸¢åŒ…ï¼Œäºæ˜¯ï¼Œè¿™ä¸ªæƒ…å†µå°±ä¼šè¿›å…¥æ¶æ€§å¾ªç¯è¢«ä¸æ–­åœ°æ”¾å¤§ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªç½‘ç»œå†…æœ‰æˆåƒä¸Šä¸‡çš„ TCP è¿æ¥éƒ½è¿™ä¹ˆè¡Œäº‹ï¼Œé‚£ä¹ˆé©¬ä¸Šå°±ä¼šå½¢æˆâ€œç½‘ç»œé£æš´â€ï¼ŒTCP è¿™ä¸ªåè®®å°±ä¼šæ‹–å®æ•´ä¸ªç½‘ç»œã€‚è¿™æ˜¯ä¸€ä¸ªç¾éš¾ã€‚ æ‰€ä»¥ï¼ŒTCP ä¸èƒ½å¿½ç•¥ç½‘ç»œä¸Šå‘ç”Ÿçš„äº‹æƒ…ï¼Œè€Œæ— è„‘åœ°ä¸€ä¸ªåŠ²åœ°é‡å‘æ•°æ®ï¼Œå¯¹ç½‘ç»œé€ æˆæ›´å¤§çš„ä¼¤å®³ã€‚å¯¹æ­¤ TCP çš„è®¾è®¡ç†å¿µæ˜¯ï¼šTCP ä¸æ˜¯ä¸€ä¸ªè‡ªç§çš„åè®®ï¼Œå½“æ‹¥å¡å‘ç”Ÿçš„æ—¶å€™ï¼Œè¦åšè‡ªæˆ‘ç‰ºç‰²ã€‚å°±åƒäº¤é€šé˜»å¡ä¸€æ ·ï¼Œæ¯ä¸ªè½¦éƒ½åº”è¯¥æŠŠè·¯è®©å‡ºæ¥ï¼Œè€Œä¸è¦å†å»æŠ¢è·¯äº†ã€‚ æ‹¥å¡æ§åˆ¶ä¸»è¦æ˜¯å››ä¸ªç®—æ³•ï¼š1ï¼‰æ…¢å¯åŠ¨ï¼Œ2ï¼‰æ‹¥å¡é¿å…ï¼Œ3ï¼‰æ‹¥å¡å‘ç”Ÿï¼Œ4ï¼‰å¿«é€Ÿæ¢å¤ã€‚è¿™å››ä¸ªç®—æ³•ä¸æ˜¯ä¸€å¤©éƒ½æå‡ºæ¥çš„ï¼Œè¿™ä¸ªå››ç®—æ³•çš„å‘å±•ç»å†äº†å¾ˆå¤šæ—¶é—´ï¼Œåˆ°ä»Šå¤©éƒ½è¿˜åœ¨ä¼˜åŒ–ä¸­ã€‚ å¤‡æ³¨: 1988 å¹´ï¼ŒTCP-Tahoe æå‡ºäº† 1ï¼‰æ…¢å¯åŠ¨ï¼Œ2ï¼‰æ‹¥å¡é¿å…ï¼Œ3ï¼‰æ‹¥å¡å‘ç”Ÿæ—¶çš„å¿«é€Ÿé‡ä¼  1990 å¹´ï¼ŒTCP Reno åœ¨ Tahoe çš„åŸºç¡€ä¸Šå¢åŠ äº† 4ï¼‰å¿«é€Ÿæ¢å¤ æ…¢çƒ­å¯åŠ¨ç®—æ³• â€“ Slow Starté¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ TCP çš„æ…¢çƒ­å¯åŠ¨ã€‚æ…¢å¯åŠ¨çš„æ„æ€æ˜¯ï¼ŒåˆšåˆšåŠ å…¥ç½‘ç»œçš„è¿æ¥ï¼Œä¸€ç‚¹ä¸€ç‚¹åœ°æé€Ÿï¼Œä¸è¦ä¸€ä¸Šæ¥å°±åƒé‚£äº›ç‰¹æƒè½¦ä¸€æ ·éœ¸é“åœ°æŠŠè·¯å æ»¡ã€‚æ–°åŒå­¦ä¸Šé«˜é€Ÿè¿˜æ˜¯è¦æ…¢ä¸€ç‚¹ï¼Œä¸è¦æŠŠå·²ç»åœ¨é«˜é€Ÿä¸Šçš„ç§©åºç»™æä¹±äº†ã€‚ æ…¢å¯åŠ¨çš„ç®—æ³•å¦‚ä¸‹(cwnd å…¨ç§° Congestion Window)ï¼š 1ï¼‰è¿æ¥å»ºå¥½çš„å¼€å§‹å…ˆåˆå§‹åŒ– cwnd = 1ï¼Œè¡¨æ˜å¯ä»¥ä¼ ä¸€ä¸ª MSS å¤§å°çš„æ•°æ®ã€‚ 2ï¼‰æ¯å½“æ”¶åˆ°ä¸€ä¸ª ACKï¼Œcwnd++; å‘ˆçº¿æ€§ä¸Šå‡ 3ï¼‰æ¯å½“è¿‡äº†ä¸€ä¸ª RTTï¼Œcwnd = cwnd*2; å‘ˆæŒ‡æ•°è®©å‡ 4ï¼‰è¿˜æœ‰ä¸€ä¸ª ssthreshï¼ˆslow start thresholdï¼‰ï¼Œæ˜¯ä¸€ä¸ªä¸Šé™ï¼Œå½“ cwnd &gt;= ssthresh æ—¶ï¼Œå°±ä¼šè¿›å…¥â€œæ‹¥å¡é¿å…ç®—æ³•â€ï¼ˆåé¢ä¼šè¯´è¿™ä¸ªç®—æ³•ï¼‰ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœç½‘é€Ÿå¾ˆå¿«çš„è¯ï¼ŒACK ä¹Ÿä¼šè¿”å›å¾—å¿«ï¼ŒRTT ä¹Ÿä¼šçŸ­ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªæ…¢å¯åŠ¨å°±ä¸€ç‚¹ä¹Ÿä¸æ…¢ã€‚ä¸‹å›¾è¯´æ˜äº†è¿™ä¸ªè¿‡ç¨‹ã€‚ ä¸€ç¯‡ Google çš„è®ºæ–‡ã€ŠAn Argument for Increasing TCPâ€™s Initial Congestion Windowã€‹Linux 3.0 åé‡‡ç”¨äº†è¿™ç¯‡è®ºæ–‡çš„å»ºè®®â€”â€”æŠŠ cwnd åˆå§‹åŒ–æˆäº† 10 ä¸ª MSSã€‚è€Œ Linux 3.0 ä»¥å‰ï¼Œæ¯”å¦‚ 2.6ï¼ŒLinux é‡‡ç”¨äº†RFC3390ï¼Œcwnd æ˜¯è·Ÿ MSS çš„å€¼æ¥å˜çš„ï¼Œå¦‚æœ MSS&lt; 1095ï¼Œåˆ™ cwnd = 4ï¼›å¦‚æœ MSS&gt;2190ï¼Œåˆ™ cwnd=2ï¼›å…¶å®ƒæƒ…å†µä¸‹ï¼Œåˆ™æ˜¯ 3ã€‚ æ‹¥å¡é¿å…ç®—æ³• â€“ Congestion Avoidanceå‰é¢è¯´è¿‡ï¼Œè¿˜æœ‰ä¸€ä¸ª ssthreshï¼ˆslow start thresholdï¼‰ï¼Œæ˜¯ä¸€ä¸ªä¸Šé™ï¼Œå½“ cwnd &gt;= ssthresh æ—¶ï¼Œå°±ä¼šè¿›å…¥â€œæ‹¥å¡é¿å…ç®—æ³•â€ã€‚ä¸€èˆ¬æ¥è¯´ ssthresh çš„å€¼æ˜¯ 65535ï¼Œå•ä½æ˜¯å­—èŠ‚ï¼Œå½“ cwnd è¾¾åˆ°è¿™ä¸ªå€¼æ—¶åï¼Œç®—æ³•å¦‚ä¸‹ï¼š 1ï¼‰æ”¶åˆ°ä¸€ä¸ª ACK æ—¶ï¼Œcwnd = cwnd + 1/cwnd 2ï¼‰å½“æ¯è¿‡ä¸€ä¸ª RTT æ—¶ï¼Œcwnd = cwnd + 1 è¿™æ ·å°±å¯ä»¥é¿å…å¢é•¿è¿‡å¿«å¯¼è‡´ç½‘ç»œæ‹¥å¡ï¼Œæ…¢æ…¢çš„å¢åŠ è°ƒæ•´åˆ°ç½‘ç»œçš„æœ€ä½³å€¼ã€‚å¾ˆæ˜æ˜¾ï¼Œæ˜¯ä¸€ä¸ªçº¿æ€§ä¸Šå‡çš„ç®—æ³•ã€‚ æ‹¥å¡çŠ¶æ€æ—¶çš„ç®—æ³•å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œå½“ä¸¢åŒ…çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸¤ç§æƒ…å†µï¼š 1ï¼‰ç­‰åˆ° RTO è¶…æ—¶ï¼Œé‡ä¼ æ•°æ®åŒ…ã€‚TCP è®¤ä¸ºè¿™ç§æƒ…å†µå¤ªç³Ÿç³•ï¼Œååº”ä¹Ÿå¾ˆå¼ºçƒˆã€‚ sshthresh = cwnd /2 cwnd é‡ç½®ä¸º 1 è¿›å…¥æ…¢å¯åŠ¨è¿‡ç¨‹ 2ï¼‰Fast Retransmit ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨æ”¶åˆ° 3 ä¸ª duplicate ACK æ—¶å°±å¼€å¯é‡ä¼ ï¼Œè€Œä¸ç”¨ç­‰åˆ° RTO è¶…æ—¶ã€‚ TCP Tahoe çš„å®ç°å’Œ RTO è¶…æ—¶ä¸€æ ·ã€‚ TCP Reno çš„å®ç°æ˜¯ï¼š cwnd = cwnd /2 sshthresh = cwnd è¿›å…¥å¿«é€Ÿæ¢å¤ç®—æ³•â€”â€”Fast Recovery ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ° RTO è¶…æ—¶åï¼Œsshthresh ä¼šå˜æˆ cwnd çš„ä¸€åŠï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœ cwnd&lt;=sshthresh æ—¶å‡ºç°çš„ä¸¢åŒ…ï¼Œé‚£ä¹ˆ TCP çš„ sshthresh å°±ä¼šå‡äº†ä¸€åŠï¼Œç„¶åç­‰ cwnd åˆå¾ˆå¿«åœ°ä»¥æŒ‡æ•°çº§å¢æ¶¨çˆ¬åˆ°è¿™ä¸ªåœ°æ–¹æ—¶ï¼Œå°±ä¼šæˆæ…¢æ…¢çš„çº¿æ€§å¢æ¶¨ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒTCP æ˜¯æ€ä¹ˆé€šè¿‡è¿™ç§å¼ºçƒˆåœ°éœ‡è¡å¿«é€Ÿè€Œå°å¿ƒå¾—æ‰¾åˆ°ç½‘ç«™æµé‡çš„å¹³è¡¡ç‚¹çš„ã€‚ å¿«é€Ÿæ¢å¤ç®—æ³• â€“ Fast RecoveryTCP Renoè¿™ä¸ªç®—æ³•å®šä¹‰åœ¨RFC5681ã€‚å¿«é€Ÿé‡ä¼ å’Œå¿«é€Ÿæ¢å¤ç®—æ³•ä¸€èˆ¬åŒæ—¶ä½¿ç”¨ã€‚å¿«é€Ÿæ¢å¤ç®—æ³•æ˜¯è®¤ä¸ºï¼Œä½ è¿˜æœ‰ 3 ä¸ª Duplicated Acks è¯´æ˜ç½‘ç»œä¹Ÿä¸é‚£ä¹ˆç³Ÿç³•ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦åƒ RTO è¶…æ—¶é‚£ä¹ˆå¼ºçƒˆã€‚ æ³¨æ„ï¼Œæ­£å¦‚å‰é¢æ‰€è¯´ï¼Œè¿›å…¥ Fast Recovery ä¹‹å‰ï¼Œcwnd å’Œ sshthresh å·²è¢«æ›´æ–°ï¼š cwnd = cwnd /2 sshthresh = cwnd ç„¶åï¼ŒçœŸæ­£çš„ Fast Recovery ç®—æ³•å¦‚ä¸‹ï¼š cwnd = sshthresh + 3 * MSS ï¼ˆ3 çš„æ„æ€æ˜¯ç¡®è®¤æœ‰ 3 ä¸ªæ•°æ®åŒ…è¢«æ”¶åˆ°äº†ï¼‰ é‡ä¼  Duplicated ACKs æŒ‡å®šçš„æ•°æ®åŒ… å¦‚æœå†æ”¶åˆ° duplicated Acksï¼Œé‚£ä¹ˆ cwnd = cwnd +1 å¦‚æœæ”¶åˆ°äº†æ–°çš„ Ackï¼Œé‚£ä¹ˆï¼Œcwnd = sshthresh ï¼Œç„¶åå°±è¿›å…¥äº†æ‹¥å¡é¿å…çš„ç®—æ³•äº†ã€‚ å¦‚æœä½ ä»”ç»†æ€è€ƒä¸€ä¸‹ä¸Šé¢çš„è¿™ä¸ªç®—æ³•ï¼Œä½ å°±ä¼šçŸ¥é“ï¼Œä¸Šé¢è¿™ä¸ªç®—æ³•ä¹Ÿæœ‰é—®é¢˜ï¼Œé‚£å°±æ˜¯â€”â€”å®ƒä¾èµ–äº 3 ä¸ªé‡å¤çš„ Acksã€‚æ³¨æ„ï¼Œ3 ä¸ªé‡å¤çš„ Acks å¹¶ä¸ä»£è¡¨åªä¸¢äº†ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯ä¸¢äº†å¥½å¤šåŒ…ã€‚ä½†è¿™ä¸ªç®—æ³•åªä¼šé‡ä¼ ä¸€ä¸ªï¼Œè€Œå‰©ä¸‹çš„é‚£äº›åŒ…åªèƒ½ç­‰åˆ° RTO è¶…æ—¶ï¼Œäºæ˜¯ï¼Œè¿›å…¥äº†æ¶æ¢¦æ¨¡å¼â€”â€”è¶…æ—¶ä¸€ä¸ªçª—å£å°±å‡åŠä¸€ä¸‹ï¼Œå¤šä¸ªè¶…æ—¶ä¼šè¶…æˆ TCP çš„ä¼ è¾“é€Ÿåº¦å‘ˆçº§æ•°ä¸‹é™ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šè§¦å‘ Fast Recovery ç®—æ³•äº†ã€‚ é€šå¸¸æ¥è¯´ï¼Œæ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è¯´çš„ï¼ŒSACK æˆ– D-SACK çš„æ–¹æ³•å¯ä»¥è®© Fast Recovery æˆ– Sender åœ¨åšå†³å®šæ—¶æ›´èªæ˜ä¸€äº›ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„ TCP çš„å®ç°éƒ½æ”¯æŒ SACKï¼ˆSACK éœ€è¦ä¸¤ç«¯éƒ½æ”¯æŒï¼‰ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä¸€ä¸ªæ²¡æœ‰ SACK çš„è§£å†³æ–¹æ¡ˆã€‚è€Œé€šè¿‡ SACK è¿›è¡Œæ‹¥å¡æ§åˆ¶çš„ç®—æ³•æ˜¯ FACKï¼ˆåé¢ä¼šè®²ï¼‰ TCP New Renoäºæ˜¯ï¼Œ1995 å¹´ï¼ŒTCP New Renoï¼ˆå‚è§ RFC 6582 ï¼‰ç®—æ³•æå‡ºæ¥ï¼Œä¸»è¦å°±æ˜¯åœ¨æ²¡æœ‰ SACK çš„æ”¯æŒä¸‹æ”¹è¿› Fast Recovery ç®—æ³•çš„â€”â€” å½“ sender è¿™è¾¹æ”¶åˆ°äº† 3 ä¸ª Duplicated Acksï¼Œè¿›å…¥ Fast Retransimit æ¨¡å¼ï¼Œå¼€å‘é‡ä¼ é‡å¤ Acks æŒ‡ç¤ºçš„é‚£ä¸ªåŒ…ã€‚å¦‚æœåªæœ‰è¿™ä¸€ä¸ªåŒ…ä¸¢äº†ï¼Œé‚£ä¹ˆï¼Œé‡ä¼ è¿™ä¸ªåŒ…åå›æ¥çš„ Ack ä¼šæŠŠæ•´ä¸ªå·²ç»è¢« sender ä¼ è¾“å‡ºå»çš„æ•°æ® ack å›æ¥ã€‚å¦‚æœæ²¡æœ‰çš„è¯ï¼Œè¯´æ˜æœ‰å¤šä¸ªåŒ…ä¸¢äº†ã€‚æˆ‘ä»¬å«è¿™ä¸ª ACK ä¸º Partial ACKã€‚ ä¸€æ—¦ Sender è¿™è¾¹å‘ç°äº† Partial ACK å‡ºç°ï¼Œé‚£ä¹ˆï¼Œsender å°±å¯ä»¥æ¨ç†å‡ºæ¥æœ‰å¤šä¸ªåŒ…è¢«ä¸¢äº†ï¼Œäºæ˜¯ä¹ç»§ç»­é‡ä¼  sliding window é‡Œæœªè¢« ack çš„ç¬¬ä¸€ä¸ªåŒ…ã€‚ç›´åˆ°å†ä¹Ÿæ”¶ä¸åˆ°äº† Partial Ackï¼Œæ‰çœŸæ­£ç»“æŸ Fast Recovery è¿™ä¸ªè¿‡ç¨‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªâ€œFast Recovery çš„å˜æ›´â€æ˜¯ä¸€ä¸ªéå¸¸æ¿€è¿›çš„ç©æ³•ï¼Œä»–åŒæ—¶å»¶é•¿äº† Fast Retransmit å’Œ Fast Recovery çš„è¿‡ç¨‹ã€‚ ç®—æ³•ç¤ºæ„å›¾ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„å›¾ç¤ºä»¥åŒæ—¶çœ‹ä¸€ä¸‹ä¸Šé¢çš„å„ç§ç®—æ³•çš„æ ·å­ï¼š FACK ç®—æ³•FACK å…¨ç§° Forward Acknowledgment ç®—æ³•ï¼Œè®ºæ–‡åœ°å€åœ¨è¿™é‡Œï¼ˆPDFï¼‰Forward Acknowledgement: Refining TCP Congestion Control è¿™ä¸ªç®—æ³•æ˜¯å…¶äº SACK çš„ï¼Œå‰é¢æˆ‘ä»¬è¯´è¿‡ SACK æ˜¯ä½¿ç”¨äº† TCP æ‰©å±•å­—æ®µ Ack äº†æœ‰å“ªäº›æ•°æ®æ”¶åˆ°ï¼Œå“ªäº›æ•°æ®æ²¡æœ‰æ”¶åˆ°ï¼Œä»–æ¯” Fast Retransmit çš„ 3 ä¸ª duplicated acks å¥½å¤„åœ¨äºï¼Œå‰è€…åªçŸ¥é“æœ‰åŒ…ä¸¢äº†ï¼Œä¸çŸ¥é“æ˜¯ä¸€ä¸ªè¿˜æ˜¯å¤šä¸ªï¼Œè€Œ SACK å¯ä»¥å‡†ç¡®çš„çŸ¥é“æœ‰å“ªäº›åŒ…ä¸¢äº†ã€‚ æ‰€ä»¥ï¼ŒSACK å¯ä»¥è®©å‘é€ç«¯è¿™è¾¹åœ¨é‡ä¼ è¿‡ç¨‹ä¸­ï¼ŒæŠŠé‚£äº›ä¸¢æ‰çš„åŒ…é‡ä¼ ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„ä¼ ï¼Œä½†è¿™æ ·çš„ä¸€æ¥ï¼Œå¦‚æœé‡ä¼ çš„åŒ…æ•°æ®æ¯”è¾ƒå¤šçš„è¯ï¼Œåˆä¼šå¯¼è‡´æœ¬æ¥å°±å¾ˆå¿™çš„ç½‘ç»œå°±æ›´å¿™äº†ã€‚æ‰€ä»¥ï¼ŒFACK ç”¨æ¥åšé‡ä¼ è¿‡ç¨‹ä¸­çš„æ‹¥å¡æµæ§ã€‚ è¿™ä¸ªç®—æ³•ä¼šæŠŠ SACK ä¸­æœ€å¤§çš„ Sequence Number ä¿å­˜åœ¨snd.fackè¿™ä¸ªå˜é‡ä¸­ï¼Œsnd.fack çš„æ›´æ–°ç”± ack å¸¦ç§‹ï¼Œå¦‚æœç½‘ç»œä¸€åˆ‡å®‰å¥½åˆ™å’Œ snd.una ä¸€æ ·ï¼ˆsnd.una å°±æ˜¯è¿˜æ²¡æœ‰æ”¶åˆ° ack çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯å‰é¢ sliding window é‡Œçš„ category #2 çš„ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼‰ ç„¶åå®šä¹‰ä¸€ä¸ªawnd = snd.nxt â€“ snd.fackï¼ˆsnd.nxt æŒ‡å‘å‘é€ç«¯ sliding window ä¸­æ­£åœ¨è¦è¢«å‘é€çš„åœ°æ–¹â€”â€”å‰é¢ sliding windows å›¾ç¤ºçš„ category#3 ç¬¬ä¸€ä¸ªä½ç½®ï¼‰ï¼Œè¿™æ · awnd çš„æ„æ€å°±æ˜¯åœ¨ç½‘ç»œä¸Šçš„æ•°æ®ã€‚ï¼ˆæ‰€è°“ awnd æ„ä¸ºï¼šactual quantity of data outstanding in the networkï¼‰ å¦‚æœéœ€è¦é‡ä¼ æ•°æ®ï¼Œé‚£ä¹ˆï¼Œawnd = snd.nxt â€“ snd.fack + retran_dataï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œawnd æ˜¯ä¼ å‡ºå»çš„æ•°æ® + é‡ä¼ çš„æ•°æ®ã€‚ ç„¶åè§¦å‘ Fast Recovery çš„æ¡ä»¶æ˜¯ï¼š ( ( snd.fack â€“ snd.una ) &gt; (3*MSS) ) || (dupacks == 3) ) ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ä¸éœ€è¦ç­‰åˆ° 3 ä¸ª duplicated acks æ‰é‡ä¼ ï¼Œè€Œæ˜¯åªè¦ sack ä¸­çš„æœ€å¤§çš„ä¸€ä¸ªæ•°æ®å’Œ ack çš„æ•°æ®æ¯”è¾ƒé•¿äº†ï¼ˆ3 ä¸ª MSSï¼‰ï¼Œé‚£å°±è§¦å‘é‡ä¼ ã€‚åœ¨æ•´ä¸ªé‡ä¼ è¿‡ç¨‹ä¸­ cwnd ä¸å˜ã€‚ç›´åˆ°å½“ç¬¬ä¸€æ¬¡ä¸¢åŒ…çš„ snd.nxt&lt;=snd.unaï¼ˆä¹Ÿå°±æ˜¯é‡ä¼ çš„æ•°æ®éƒ½è¢«ç¡®è®¤äº†ï¼‰ï¼Œç„¶åè¿›æ¥æ‹¥å¡é¿å…æœºåˆ¶â€”â€”cwnd çº¿æ€§ä¸Šæ¶¨ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœæ²¡æœ‰ FACK åœ¨ï¼Œé‚£ä¹ˆåœ¨ä¸¢åŒ…æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼ŒåŸæ¥ä¿å®ˆçš„ç®—æ³•ä¼šä½ä¼°äº†éœ€è¦ä½¿ç”¨çš„ window çš„å¤§å°ï¼Œè€Œéœ€è¦å‡ ä¸ª RTT çš„æ—¶é—´æ‰ä¼šå®Œæˆæ¢å¤ï¼Œè€Œ FACK ä¼šæ¯”è¾ƒæ¿€è¿›åœ°æ¥å¹²è¿™äº‹ã€‚ ä½†æ˜¯ï¼ŒFACK å¦‚æœåœ¨ä¸€ä¸ªç½‘ç»œåŒ…ä¼šè¢« reordering çš„ç½‘ç»œé‡Œä¼šæœ‰å¾ˆå¤§çš„é—®é¢˜ã€‚ å…¶å®ƒæ‹¥å¡æ§åˆ¶ç®—æ³•ç®€ä»‹TCP Vegas æ‹¥å¡æ§åˆ¶ç®—æ³•è¿™ä¸ªç®—æ³• 1994 å¹´è¢«æå‡ºï¼Œå®ƒä¸»è¦å¯¹ TCP Reno åšäº†äº›ä¿®æ”¹ã€‚è¿™ä¸ªç®—æ³•é€šè¿‡å¯¹ RTT çš„éå¸¸é‡çš„ç›‘æ§æ¥è®¡ç®—ä¸€ä¸ªåŸºå‡† RTTã€‚ç„¶åé€šè¿‡è¿™ä¸ªåŸºå‡† RTT æ¥ä¼°è®¡å½“å‰çš„ç½‘ç»œå®é™…å¸¦å®½ï¼Œå¦‚æœå®é™…å¸¦å®½æ¯”æˆ‘ä»¬çš„æœŸæœ›çš„å¸¦å®½è¦å°æˆ–æ˜¯è¦å¤šçš„æ´»ï¼Œé‚£ä¹ˆå°±å¼€å§‹çº¿æ€§åœ°å‡å°‘æˆ–å¢åŠ  cwnd çš„å¤§å°ã€‚å¦‚æœè¿™ä¸ªè®¡ç®—å‡ºæ¥çš„ RTT å¤§äºäº† Timeout åï¼Œé‚£ä¹ˆï¼Œä¸ç­‰ ack è¶…æ—¶å°±ç›´æ¥é‡ä¼ ã€‚ï¼ˆVegas çš„æ ¸å¿ƒæ€æƒ³æ˜¯ç”¨ RTT çš„å€¼æ¥å½±å“æ‹¥å¡çª—å£ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¸¢åŒ…ï¼‰ è¿™ä¸ªç®—æ³•çš„è®ºæ–‡æ˜¯ã€ŠTCP Vegas: End to End Congestion Avoidance on a Global Internetã€‹è¿™ç¯‡è®ºæ–‡ç»™äº† Vegas å’Œ New Reno çš„å¯¹æ¯”ï¼š å…³äºè¿™ä¸ªç®—æ³•å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š/net/ipv4/tcp_vegas.hï¼Œ /net/ipv4/tcp_vegas.c HSTCP(High Speed TCP) ç®—æ³•è¿™ä¸ªç®—æ³•æ¥è‡ªRFC 3649ï¼ˆWikipedia è¯æ¡ï¼‰ã€‚å…¶å¯¹æœ€åŸºç¡€çš„ç®—æ³•è¿›è¡Œäº†æ›´æ”¹ï¼Œä»–ä½¿å¾— Congestion Window æ¶¨å¾—å¿«ï¼Œå‡å¾—æ…¢ã€‚å…¶ä¸­ï¼š æ‹¥å¡é¿å…æ—¶çš„çª—å£å¢é•¿æ–¹å¼ï¼š cwnd = cwnd + Î±(cwnd) / cwnd ä¸¢åŒ…åçª—å£ä¸‹é™æ–¹å¼ï¼šcwnd = (1- Î²(cwnd))*cwnd æ³¨ï¼šÎ±(cwnd)å’Œ Î²(cwnd)éƒ½æ˜¯å‡½æ•°ï¼Œå¦‚æœä½ è¦è®©ä»–ä»¬å’Œæ ‡å‡†çš„ TCP ä¸€æ ·ï¼Œé‚£ä¹ˆè®© Î±(cwnd)=1ï¼ŒÎ²(cwnd)=0.5 å°±å¯ä»¥äº†ã€‚ å¯¹äº Î±(cwnd)å’Œ Î²(cwnd)çš„å€¼æ˜¯ä¸ªåŠ¨æ€çš„å˜æ¢çš„ä¸œè¥¿ã€‚ å…³äºè¿™ä¸ªç®—æ³•çš„å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š/net/ipv4/tcp_highspeed.c TCP BIC ç®—æ³•2004 å¹´ï¼Œäº§å†…å‡º BIC ç®—æ³•ã€‚ç°åœ¨ä½ è¿˜å¯ä»¥æŸ¥å¾—åˆ°ç›¸å…³çš„æ–°é—»ã€ŠGoogleï¼šç¾ç§‘å­¦å®¶ç ”å‘ BIC-TCP åè®® é€Ÿåº¦æ˜¯ DSL å…­åƒå€ã€‹ BIC å…¨ç§°Binary Increase Congestion controlï¼Œåœ¨ Linux 2.6.8 ä¸­æ˜¯é»˜è®¤æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚BIC çš„å‘æ˜è€…å‘è¿™ä¹ˆå¤šçš„æ‹¥å¡æ§åˆ¶ç®—æ³•éƒ½åœ¨åŠªåŠ›æ‰¾ä¸€ä¸ªåˆé€‚çš„ cwnd â€“ Congestion Windowï¼Œè€Œä¸” BIC-TCP çš„æå‡ºè€…ä»¬çœ‹ç©¿äº†äº‹æƒ…çš„æœ¬è´¨ï¼Œå…¶å®è¿™å°±æ˜¯ä¸€ä¸ªæœç´¢çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ BIC è¿™ä¸ªç®—æ³•ä¸»è¦ç”¨çš„æ˜¯ Binary Searchâ€”â€”äºŒåˆ†æŸ¥æ‰¾æ¥å¹²è¿™ä¸ªäº‹ã€‚ å…³äºè¿™ä¸ªç®—æ³•å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š/net/ipv4/tcp_bic.c TCP WestWood ç®—æ³•westwood é‡‡ç”¨å’Œ Reno ç›¸åŒçš„æ…¢å¯åŠ¨ç®—æ³•ã€æ‹¥å¡é¿å…ç®—æ³•ã€‚westwood çš„ä¸»è¦æ”¹è¿›æ–¹é¢ï¼šåœ¨å‘é€ç«¯åšå¸¦å®½ä¼°è®¡ï¼Œå½“æ¢æµ‹åˆ°ä¸¢åŒ…æ—¶ï¼Œæ ¹æ®å¸¦å®½å€¼æ¥è®¾ç½®æ‹¥å¡çª—å£ã€æ…¢å¯åŠ¨é˜ˆå€¼ã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ªç®—æ³•æ˜¯æ€ä¹ˆæµ‹é‡å¸¦å®½çš„ï¼Ÿæ¯ä¸ª RTT æ—¶é—´ï¼Œä¼šæµ‹é‡ä¸€æ¬¡å¸¦å®½ï¼Œæµ‹é‡å¸¦å®½çš„å…¬å¼å¾ˆç®€å•ï¼Œå°±æ˜¯è¿™æ®µ RTT å†…æˆåŠŸè¢« ack äº†å¤šå°‘å­—èŠ‚ã€‚å› ä¸ºï¼Œè¿™ä¸ªå¸¦å®½å’Œç”¨ RTT è®¡ç®— RTO ä¸€æ ·ï¼Œä¹Ÿæ˜¯éœ€è¦ä»æ¯ä¸ªæ ·æœ¬æ¥å¹³æ»‘åˆ°ä¸€ä¸ªå€¼çš„â€”â€”ä¹Ÿæ˜¯ç”¨ä¸€ä¸ªåŠ æƒç§»å¹³å‡çš„å…¬å¼ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸€ä¸ªç½‘ç»œçš„å¸¦å®½æ˜¯æ¯ç§’å¯ä»¥å‘é€ X ä¸ªå­—èŠ‚ï¼Œè€Œ RTT æ˜¯ä¸€ä¸ªæ•°æ®å‘å‡ºå»åç¡®è®¤éœ€è¦çš„æ—¶å€™ï¼Œæ‰€ä»¥ï¼ŒX _ RTT åº”è¯¥æ˜¯æˆ‘ä»¬ç¼“å†²åŒºå¤§å°ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªç®—æ³•ä¸­ï¼Œssthresh çš„å€¼å°±æ˜¯ est_BD _ min-RTT(æœ€å°çš„ RTT å€¼)ï¼Œå¦‚æœä¸¢åŒ…æ˜¯ Duplicated ACKs å¼•èµ·çš„ï¼Œé‚£ä¹ˆå¦‚æœ cwnd &gt; ssthreshï¼Œåˆ™ cwin = ssthreshã€‚å¦‚æœæ˜¯ RTO å¼•èµ·çš„ï¼Œcwnd = 1ï¼Œè¿›å…¥æ…¢å¯åŠ¨ã€‚ å…³äºè¿™ä¸ªç®—æ³•å®ç°ï¼Œä½ å¯ä»¥å‚çœ‹ Linux æºç ï¼š /net/ipv4/tcp_westwood.c å››æ¬¡æŒ¥æ‰‹ä¼˜åŒ–â€”â€”ä¸‰æ¬¡æŒ¥æ‰‹123456789#ä¸‰æ¬¡æŒ¥æ‰‹ -- å®¢æˆ·ç«¯å‘èµ·æ–­å¼€è¿æ¥è¯·æ±‚ å®¢æˆ·ç«¯åºåˆ—å·ä¸º 3495051432#fin seq = 349505143200:05:30.157325 IP 221.122.42.100.58706 &gt; VM_0_6_centos.webcache: Flags [F.], seq 3495051432, ack 485492629, win 115, options [nop,nop,TS val 1695781058 ecr 629900122], length 0#ä¸‰æ¬¡æŒ¥æ‰‹ -- æœåŠ¡å™¨ç«¯å‘èµ·æ–­å¼€è¿æ¥è¯·æ±‚#ack = 3495051432 + 1 = 3495051433 æ³¨æ„ å› ä¸ºæœåŠ¡å™¨ç«¯ä¹Ÿæ²¡æœ‰ä¸œè¥¿è¦å‘é€äº†ï¼Œæ‰€ä»¥ä¹Ÿè¦å…³é—­è¿æ¥ï¼Œå› æ­¤åŒæ—¶å‘é€äº†finä¿¡å·ï¼Œseq = 48549262900:05:30.157562 IP VM_0_6_centos.webcache &gt; 221.122.42.100.58706: Flags [F.], seq 485492629, ack 3495051433, win 235, options [nop,nop,TS val 629900162 ecr 1695781058], length 0#ä¸‰æ¬¡æŒ¥æ‰‹ -- å®¢æˆ·ç«¯åº”ç­”#ack = 485492629 + 1 = 48549263000:05:30.196710 IP 221.122.42.100.58706 &gt; VM_0_6_centos.webcache: Flags [.], ack 485492630, win 115, options [nop,nop,TS val 1695781097 ecr 629900162], length 0 è¿™æ˜¯å› ä¸ºå…³é—­è¿æ¥æœ‰ä¸¤ç§æ–¹å¼ï¼Œå½“ä¸€æ–¹å…³é—­è¿æ¥ï¼Œå¦å¤–ä¸€æ–¹æ²¡æœ‰æ•°æ®å‘é€æ—¶ï¼Œé©¬ä¸Šå…³é—­è¿æ¥ï¼Œä¹Ÿå°±å°†ç¬¬äºŒæ­¥çš„ ack ä¸ç¬¬ä¸‰æ­¥çš„ fin åˆå¹¶ä¸ºä¸€æ­¥äº†","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"},{"name":"TCP/IP","slug":"TCP-IP","permalink":"http://yoursite.com/tags/TCP-IP/"}]},{"title":"Promise","slug":"promise","date":"2019-08-05T11:44:02.000Z","updated":"2019-11-10T14:37:39.027Z","comments":true,"path":"2019/08/05/promise/","link":"","permalink":"http://yoursite.com/2019/08/05/promise/","excerpt":"promiseåˆ›å»º XHR çš„ promise å¯¹è±¡ï¼ˆPromise åŒ…è£… XHR[ajax]å¤„ç†ï¼‰æ–¹æ³•ä¸€ï¼š åˆ›å»ºä¸€ä¸ªç”¨ Promise æŠŠ XHR å¤„ç†åŒ…è£…èµ·æ¥çš„åä¸º getURL çš„å‡½æ•°ã€‚","text":"promiseåˆ›å»º XHR çš„ promise å¯¹è±¡ï¼ˆPromise åŒ…è£… XHR[ajax]å¤„ç†ï¼‰æ–¹æ³•ä¸€ï¼š åˆ›å»ºä¸€ä¸ªç”¨ Promise æŠŠ XHR å¤„ç†åŒ…è£…èµ·æ¥çš„åä¸º getURL çš„å‡½æ•°ã€‚ 1234567891011121314151617181920212223242526function getURL(URL) &#123; return new Promise(function(resolve, reject) &#123; var req = new XMLHttpRequest(); req.open(\"GET\", URL, true); req.onload = function() &#123; if (req.status === 200) &#123; resolve(req.responseText); &#125; else &#123; reject(new Error(req.statusText)); &#125; &#125;; req.onerror = function() &#123; reject(new Error(req.statusText)); &#125;; req.send(); &#125;);&#125;// è¿è¡Œç¤ºä¾‹var URL = \"http://httpbin.org/get\";getURL(URL) .then(function onFulfilled(value) &#123; console.log(value); &#125;) .catch(function onRejected(error) &#123; console.error(error); &#125;); æ–¹æ³•äºŒï¼š 12345678910111213141516171819202122232425function ajaxPromise(url, data, callback) &#123; return new Promise(function(resolve, reject) &#123; $.ajax(&#123; url: url, type: data == null ? \"GET\" : \"POST\", dataType: \"json\", data: data == null ? \"\" : JSON.stringify(data), async: true, contentType: \"application/json\", success: function(res) &#123; callback(res); resolve(); &#125;, error: function(XMLHttpRequest, textStatus, errorThrown) &#123; if (XMLHttpRequest.status == \"401\") &#123; window.parent.location = \"/enterprise/enterprise_login.html\"; self.location = \"/enterprise/enterprise_login.html\"; &#125; else &#123; alert(XMLHttpRequest.responseText); &#125; reject(); &#125; &#125;); &#125;);&#125; è°ƒç”¨ 1234567891011ajaxPromise('/prefix/entity1/action1',null, function(res)&#123; //do something on response&#125;).then( ajaxPromise('/prefix/entity2/action2', someData, function(res)&#123; //do something on response &#125;).then( initVue() ;).then( //do something else) promise çš„å®ç°å’ŒåŸç†ï¼ˆç”¨ jsï¼‰promise å®ç°åŸç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210// åˆ¤æ–­å˜é‡å¦ä¸ºfunctionconst isFunction = variable =&gt; typeof variable === \"function\";// å®šä¹‰Promiseçš„ä¸‰ç§çŠ¶æ€å¸¸é‡const PENDING = \"PENDING\";const FULFILLED = \"FULFILLED\";const REJECTED = \"REJECTED\";class MyPromise &#123; constructor(handle) &#123; if (!isFunction(handle)) &#123; throw new Error(\"MyPromise must accept a function as a parameter\"); &#125; // æ·»åŠ çŠ¶æ€ this._status = PENDING; // æ·»åŠ çŠ¶æ€ this._value = undefined; // æ·»åŠ æˆåŠŸå›è°ƒå‡½æ•°é˜Ÿåˆ— this._fulfilledQueues = []; // æ·»åŠ å¤±è´¥å›è°ƒå‡½æ•°é˜Ÿåˆ— this._rejectedQueues = []; // æ‰§è¡Œhandle try &#123; handle(this._resolve.bind(this), this._reject.bind(this)); &#125; catch (err) &#123; this._reject(err); &#125; &#125; // æ·»åŠ resovleæ—¶æ‰§è¡Œçš„å‡½æ•° _resolve(val) &#123; const run = () =&gt; &#123; if (this._status !== PENDING) return; // ä¾æ¬¡æ‰§è¡ŒæˆåŠŸé˜Ÿåˆ—ä¸­çš„å‡½æ•°ï¼Œå¹¶æ¸…ç©ºé˜Ÿåˆ— const runFulfilled = value =&gt; &#123; let cb; while ((cb = this._fulfilledQueues.shift())) &#123; cb(value); &#125; &#125;; // ä¾æ¬¡æ‰§è¡Œå¤±è´¥é˜Ÿåˆ—ä¸­çš„å‡½æ•°ï¼Œå¹¶æ¸…ç©ºé˜Ÿåˆ— const runRejected = error =&gt; &#123; let cb; while ((cb = this._rejectedQueues.shift())) &#123; cb(error); &#125; &#125;; /* å¦‚æœresolveçš„å‚æ•°ä¸ºPromiseå¯¹è±¡ï¼Œåˆ™å¿…é¡»ç­‰å¾…è¯¥Promiseå¯¹è±¡çŠ¶æ€æ”¹å˜å, å½“å‰Promsieçš„çŠ¶æ€æ‰ä¼šæ”¹å˜ï¼Œä¸”çŠ¶æ€å–å†³äºå‚æ•°Promsieå¯¹è±¡çš„çŠ¶æ€ */ if (val instanceof MyPromise) &#123; val.then( value =&gt; &#123; this._value = value; this._status = FULFILLED; runFulfilled(value); &#125;, err =&gt; &#123; this._value = err; this._status = REJECTED; runRejected(err); &#125; ); &#125; else &#123; this._value = val; this._status = FULFILLED; runFulfilled(val); &#125; &#125;; // ä¸ºäº†æ”¯æŒåŒæ­¥çš„Promiseï¼Œè¿™é‡Œé‡‡ç”¨å¼‚æ­¥è°ƒç”¨ setTimeout(run, 0); &#125; // æ·»åŠ rejectæ—¶æ‰§è¡Œçš„å‡½æ•° _reject(err) &#123; if (this._status !== PENDING) return; // ä¾æ¬¡æ‰§è¡Œå¤±è´¥é˜Ÿåˆ—ä¸­çš„å‡½æ•°ï¼Œå¹¶æ¸…ç©ºé˜Ÿåˆ— const run = () =&gt; &#123; this._status = REJECTED; this._value = err; let cb; while ((cb = this._rejectedQueues.shift())) &#123; cb(err); &#125; &#125;; // ä¸ºäº†æ”¯æŒåŒæ­¥çš„Promiseï¼Œè¿™é‡Œé‡‡ç”¨å¼‚æ­¥è°ƒç”¨ setTimeout(run, 0); &#125; // æ·»åŠ thenæ–¹æ³• then(onFulfilled, onRejected) &#123; const &#123; _value, _status &#125; = this; // è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ return new MyPromise((onFulfilledNext, onRejectedNext) =&gt; &#123; // å°è£…ä¸€ä¸ªæˆåŠŸæ—¶æ‰§è¡Œçš„å‡½æ•° let fulfilled = value =&gt; &#123; try &#123; if (!isFunction(onFulfilled)) &#123; onFulfilledNext(value); &#125; else &#123; let res = onFulfilled(value); if (res instanceof MyPromise) &#123; // å¦‚æœå½“å‰å›è°ƒå‡½æ•°è¿”å›MyPromiseå¯¹è±¡ï¼Œå¿…é¡»ç­‰å¾…å…¶çŠ¶æ€æ”¹å˜ååœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªå›è°ƒ res.then(onFulfilledNext, onRejectedNext); &#125; else &#123; //å¦åˆ™ä¼šå°†è¿”å›ç»“æœç›´æ¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•°ï¼Œå¹¶ç«‹å³æ‰§è¡Œä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•° onFulfilledNext(res); &#125; &#125; &#125; catch (err) &#123; // å¦‚æœå‡½æ•°æ‰§è¡Œå‡ºé”™ï¼Œæ–°çš„Promiseå¯¹è±¡çš„çŠ¶æ€ä¸ºå¤±è´¥ onRejectedNext(err); &#125; &#125;; // å°è£…ä¸€ä¸ªå¤±è´¥æ—¶æ‰§è¡Œçš„å‡½æ•° let rejected = error =&gt; &#123; try &#123; if (!isFunction(onRejected)) &#123; onRejectedNext(error); &#125; else &#123; let res = onRejected(error); if (res instanceof MyPromise) &#123; // å¦‚æœå½“å‰å›è°ƒå‡½æ•°è¿”å›MyPromiseå¯¹è±¡ï¼Œå¿…é¡»ç­‰å¾…å…¶çŠ¶æ€æ”¹å˜ååœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªå›è°ƒ res.then(onFulfilledNext, onRejectedNext); &#125; else &#123; //å¦åˆ™ä¼šå°†è¿”å›ç»“æœç›´æ¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•°ï¼Œå¹¶ç«‹å³æ‰§è¡Œä¸‹ä¸€ä¸ªthençš„å›è°ƒå‡½æ•° onFulfilledNext(res); &#125; &#125; &#125; catch (err) &#123; // å¦‚æœå‡½æ•°æ‰§è¡Œå‡ºé”™ï¼Œæ–°çš„Promiseå¯¹è±¡çš„çŠ¶æ€ä¸ºå¤±è´¥ onRejectedNext(err); &#125; &#125;; switch (_status) &#123; // å½“çŠ¶æ€ä¸ºpendingæ—¶ï¼Œå°†thenæ–¹æ³•å›è°ƒå‡½æ•°åŠ å…¥æ‰§è¡Œé˜Ÿåˆ—ç­‰å¾…æ‰§è¡Œ case PENDING: this._fulfilledQueues.push(fulfilled); this._rejectedQueues.push(rejected); break; // å½“çŠ¶æ€å·²ç»æ”¹å˜æ—¶ï¼Œç«‹å³æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•° case FULFILLED: fulfilled(_value); break; case REJECTED: rejected(_value); break; &#125; &#125;); &#125; // æ·»åŠ catchæ–¹æ³• catch(onRejected) &#123; return this.then(undefined, onRejected); &#125; // æ·»åŠ é™æ€resolveæ–¹æ³• static resolve(value) &#123; // å¦‚æœå‚æ•°æ˜¯MyPromiseå®ä¾‹ï¼Œç›´æ¥è¿”å›è¿™ä¸ªå®ä¾‹ if (value instanceof MyPromise) return value; return new MyPromise(resolve =&gt; resolve(value)); &#125; // æ·»åŠ é™æ€rejectæ–¹æ³• static reject(value) &#123; return new MyPromise((resolve, reject) =&gt; reject(value)); &#125; // æ·»åŠ é™æ€allæ–¹æ³• static all(list) &#123; return new MyPromise((resolve, reject) =&gt; &#123; /** * è¿”å›å€¼çš„é›†åˆ */ let values = []; let count = 0; for (let [i, p] of list.entries()) &#123; // æ•°ç»„å‚æ•°å¦‚æœä¸æ˜¯MyPromiseå®ä¾‹ï¼Œå…ˆè°ƒç”¨MyPromise.resolve this.resolve(p).then( res =&gt; &#123; values[i] = res; count++; // æ‰€æœ‰çŠ¶æ€éƒ½å˜æˆfulfilledæ—¶è¿”å›çš„MyPromiseçŠ¶æ€å°±å˜æˆfulfilled if (count === list.length) resolve(values); &#125;, err =&gt; &#123; // æœ‰ä¸€ä¸ªè¢«rejectedæ—¶è¿”å›çš„MyPromiseçŠ¶æ€å°±å˜æˆrejected reject(err); &#125; ); &#125; &#125;); &#125; // æ·»åŠ é™æ€raceæ–¹æ³• static race(list) &#123; return new MyPromise((resolve, reject) =&gt; &#123; for (let p of list) &#123; // åªè¦æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œæ–°çš„MyPromiseçš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ this.resolve(p).then( res =&gt; &#123; resolve(res); &#125;, err =&gt; &#123; reject(err); &#125; ); &#125; &#125;); &#125; finally(cb) &#123; return this.then( value =&gt; MyPromise.resolve(cb()).then(() =&gt; value), reason =&gt; MyPromise.resolve(cb()).then(() =&gt; &#123; throw reason; &#125;) ); &#125;&#125; promise.race å’Œè¶…æ—¶å¤„ç†å‡½æ•° timeoutPromise(æ¯”è¾ƒå¯¹è±¡promise, ms) æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯éœ€è¦ä½¿ç”¨è¶…æ—¶æœºåˆ¶çš„ promise å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¶…æ—¶æ—¶é—´ï¼Œå®ƒè¿”å›ä¸€ä¸ªç”± Promise.race åˆ›å»ºçš„ç›¸äº’ç«äº‰çš„ promise å¯¹è±¡ã€‚ 1234567891011function delayPromise(ms) &#123; return new Promise(function(resolve) &#123; setTimeout(resolve, ms); &#125;);&#125;function timeoutPromise(promise, ms) &#123; var timeout = delayPromise(ms).then(function() &#123; throw new Error(\"Operation timed out after \" + ms + \" ms\"); &#125;); return Promise.race([promise, timeout]);&#125; ä¾‹å­ï¼š 1234567891011121314151617181920212223242526function delayPromise(ms) &#123; return new Promise(function(resolve) &#123; setTimeout(resolve, ms); &#125;);&#125;function timeoutPromise(promise, ms) &#123; var timeout = delayPromise(ms).then(function() &#123; throw new Error(\"Operation timed out after \" + ms + \" ms\"); &#125;); return Promise.race([promise, timeout]);&#125;// è¿è¡Œç¤ºä¾‹var taskPromise = new Promise(function(resolve) &#123; // éšä¾¿ä¸€äº›ä»€ä¹ˆå¤„ç† var delay = Math.random() * 2000; setTimeout(function() &#123; resolve(delay + \"ms\"); &#125;, delay);&#125;);timeoutPromise(taskPromise, 1000) .then(function(value) &#123; console.log(\"taskPromiseåœ¨è§„å®šæ—¶é—´å†…ç»“æŸ : \" + value); &#125;) .catch(function(error) &#123; console.log(\"å‘ç”Ÿè¶…æ—¶\", error); &#125;); è™½ç„¶åœ¨å‘ç”Ÿè¶…æ—¶çš„æ—¶å€™æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä½†æ˜¯è¿™æ ·çš„è¯æˆ‘ä»¬å°±ä¸èƒ½åŒºåˆ†è¿™ä¸ªå¼‚å¸¸åˆ°åº•æ˜¯æ™®é€šçš„é”™è¯¯è¿˜æ˜¯è¶…æ—¶é”™è¯¯äº†ã€‚ ä¸ºäº†èƒ½åŒºåˆ†è¿™ä¸ª Error å¯¹è±¡çš„ç±»å‹ï¼Œæˆ‘ä»¬å†æ¥å®šä¹‰ä¸€ä¸ªError å¯¹è±¡çš„å­ç±» TimeoutErrorã€‚ å®šåˆ¶ Error å¯¹è±¡ 1234567891011121314151617//TimeoutError.jsfunction copyOwnFrom(target, source) &#123; Object.getOwnPropertyNames(source).forEach(function(propName) &#123; Object.defineProperty( target, propName, Object.getOwnPropertyDescriptor(source, propName) ); &#125;); return target;&#125;function TimeoutError() &#123; var superInstance = Error.apply(null, arguments); copyOwnFrom(this, superInstance);&#125;TimeoutError.prototype = Object.create(Error.prototype);TimeoutError.prototype.constructor = TimeoutError; æˆ‘ä»¬å®šä¹‰äº† TimeoutError ç±»å’Œæ„é€ å‡½æ•°ï¼Œè¿™ä¸ªç±»ç»§æ‰¿äº† Error çš„ prototypeã€‚ å®ƒçš„ä½¿ç”¨æ–¹æ³•å’Œæ™®é€šçš„ Error å¯¹è±¡ä¸€æ ·ï¼Œä½¿ç”¨ throw è¯­å¥å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ 1234567var promise = new Promise(function() &#123; throw TimeoutError(\"timeout\");&#125;);promise.catch(function(error) &#123; console.log(error instanceof TimeoutError); // true&#125;); åº”ç”¨ å–æ¶ˆ XHR æ“ä½œæœ¬èº«çš„è¯å¹¶ä¸éš¾ï¼Œåªéœ€è¦è°ƒç”¨ XMLHttpRequest å¯¹è±¡çš„ abort() æ–¹æ³•å°±å¯ä»¥äº†ã€‚ ä¸ºäº†èƒ½åœ¨å¤–éƒ¨è°ƒç”¨ abort() æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆå¯¹ä¹‹å‰æœ¬èŠ‚å‡ºç°çš„ getURL è¿›è¡Œç®€å•çš„æ‰©å±•ï¼ŒcancelableXHR æ–¹æ³•é™¤äº†è¿”å›ä¸€ä¸ªåŒ…è£…äº† XHR çš„ promise å¯¹è±¡ä¹‹å¤–ï¼Œè¿˜è¿”å›äº†ä¸€ä¸ªç”¨äºå–æ¶ˆè¯¥ XHR è¯·æ±‚çš„abortæ–¹æ³•ã€‚ å¤§ä½“çš„æµç¨‹å°±åƒä¸‹é¢è¿™æ ·ã€‚ é€šè¿‡ cancelableXHR æ–¹æ³•å–å¾—åŒ…è£…äº† XHR çš„ promise å¯¹è±¡å’Œå–æ¶ˆè¯¥ XHR è¯·æ±‚çš„æ–¹æ³• åœ¨ timeoutPromise æ–¹æ³•ä¸­é€šè¿‡ Promise.race è®© XHR çš„åŒ…è£… promise å’Œè¶…æ—¶ç”¨ promise è¿›è¡Œç«äº‰ã€‚ XHR åœ¨è¶…æ—¶å‰è¿”å›ç»“æœçš„è¯ å’Œæ­£å¸¸çš„ promise ä¸€æ ·ï¼Œé€šè¿‡ then è¿”å›è¯·æ±‚ç»“æœ å‘ç”Ÿè¶…æ—¶çš„æ—¶å€™ æŠ›å‡º throw TimeoutError å¼‚å¸¸å¹¶è¢« catch catch çš„é”™è¯¯å¯¹è±¡å¦‚æœæ˜¯ TimeoutError ç±»å‹çš„è¯ï¼Œåˆ™è°ƒç”¨ abort æ–¹æ³•å–æ¶ˆ XHR è¯·æ±‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273function copyOwnFrom(target, source) &#123; Object.getOwnPropertyNames(source).forEach(function(propName) &#123; Object.defineProperty( target, propName, Object.getOwnPropertyDescriptor(source, propName) ); &#125;); return target;&#125;function TimeoutError() &#123; var superInstance = Error.apply(null, arguments); copyOwnFrom(this, superInstance);&#125;TimeoutError.prototype = Object.create(Error.prototype);TimeoutError.prototype.constructor = TimeoutError;function delayPromise(ms) &#123; return new Promise(function(resolve) &#123; setTimeout(resolve, ms); &#125;);&#125;function timeoutPromise(promise, ms) &#123; var timeout = delayPromise(ms).then(function() &#123; return Promise.reject( new TimeoutError(\"Operation timed out after \" + ms + \" ms\") ); &#125;); return Promise.race([promise, timeout]);&#125;function cancelableXHR(URL) &#123; var req = new XMLHttpRequest(); var promise = new Promise(function(resolve, reject) &#123; req.open(\"GET\", URL, true); req.onload = function() &#123; if (req.status === 200) &#123; resolve(req.responseText); &#125; else &#123; reject(new Error(req.statusText)); &#125; &#125;; req.onerror = function() &#123; reject(new Error(req.statusText)); &#125;; req.onabort = function() &#123; reject(new Error(\"abort this request\")); &#125;; req.send(); &#125;); var abort = function() &#123; // å¦‚æœrequestè¿˜æ²¡æœ‰ç»“æŸçš„è¯å°±æ‰§è¡Œabort // https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest if (req.readyState !== XMLHttpRequest.UNSENT) &#123; req.abort(); &#125; &#125;; return &#123; promise: promise, abort: abort &#125;;&#125;var object = cancelableXHR(\"http://httpbin.org/get\");// maintimeoutPromise(object.promise, 1000) .then(function(contents) &#123; console.log(\"Contents\", contents); &#125;) .catch(function(error) &#123; if (error instanceof TimeoutError) &#123; object.abort(); return console.log(error); &#125; console.log(\"XHR Error :\", error); &#125;); promise.all å’Œé¡ºåºå¤„ç† åœ¨ é‡å¤ä½¿ç”¨å¤šä¸ª then çš„æ–¹æ³• ä¸­çš„å®ç°æ–¹æ³•å¦‚ä¸‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950function getURL(URL) &#123; return new Promise(function(resolve, reject) &#123; var req = new XMLHttpRequest(); req.open(\"GET\", URL, true); req.onload = function() &#123; if (req.status === 200) &#123; resolve(req.responseText); &#125; else &#123; reject(new Error(req.statusText)); &#125; &#125;; req.onerror = function() &#123; reject(new Error(req.statusText)); &#125;; req.send(); &#125;);&#125;var request = &#123; comment: function getComment() &#123; return getURL(\"http://azu.github.io/promises-book/json/comment.json\").then( JSON.parse ); &#125;, people: function getPeople() &#123; return getURL(\"http://azu.github.io/promises-book/json/people.json\").then( JSON.parse ); &#125;&#125;;function main() &#123; function recordValue(results, value) &#123; results.push(value); return results; &#125; // [] ç”¨æ¥ä¿å­˜åˆå§‹åŒ–çš„å€¼ var pushValue = recordValue.bind(null, []); return request .comment() .then(pushValue) .then(request.people) .then(pushValue);&#125;// è¿è¡Œç¤ºä¾‹main() .then(function(value) &#123; console.log(value); &#125;) .catch(function(error) &#123; console.error(error); &#125;); ä½¿ç”¨è¿™ç§å†™æ³•çš„è¯é‚£ä¹ˆéšç€ request ä¸­å…ƒç´ æ•°é‡çš„å¢åŠ ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸æ–­å¢åŠ å¯¹ then æ–¹æ³•çš„è°ƒç”¨ å°†å¤„ç†å†…å®¹ç»Ÿä¸€æ”¾åˆ°æ•°ç»„é‡Œï¼Œå†é…åˆ for å¾ªç¯è¿›è¡Œå¤„ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354function getURL(URL) &#123; return new Promise(function(resolve, reject) &#123; var req = new XMLHttpRequest(); req.open(\"GET\", URL, true); req.onload = function() &#123; if (req.status === 200) &#123; resolve(req.responseText); &#125; else &#123; reject(new Error(req.statusText)); &#125; &#125;; req.onerror = function() &#123; reject(new Error(req.statusText)); &#125;; req.send(); &#125;);&#125;var request = &#123; comment: function getComment() &#123; return getURL(\"http://azu.github.io/promises-book/json/comment.json\").then( JSON.parse ); &#125;, people: function getPeople() &#123; return getURL(\"http://azu.github.io/promises-book/json/people.json\").then( JSON.parse ); &#125;&#125;;function main() &#123; function recordValue(results, value) &#123; results.push(value); return results; &#125; // [] ç”¨æ¥ä¿å­˜åˆå§‹åŒ–å€¼ var pushValue = recordValue.bind(null, []); // è¿”å›promiseå¯¹è±¡çš„å‡½æ•°çš„æ•°ç»„ var tasks = [request.comment, request.people]; var promise = Promise.resolve(); // å¼€å§‹çš„åœ°æ–¹ for (var i = 0; i &lt; tasks.length; i++) &#123; var task = tasks[i]; promise = promise.then(task).then(pushValue); &#125; return promise;&#125;// è¿è¡Œç¤ºä¾‹main() .then(function(value) &#123; console.log(value); &#125;) .catch(function(error) &#123; console.error(error); &#125;); promise = promise.then(task).then(pushValue); çš„ä»£ç å°±æ˜¯é€šè¿‡ä¸æ–­å¯¹ promise è¿›è¡Œå¤„ç†ï¼Œä¸æ–­çš„è¦†ç›– promise å˜é‡çš„å€¼ï¼Œä»¥è¾¾åˆ°å¯¹ promise å¯¹è±¡çš„ç´¯ç§¯å¤„ç†æ•ˆæœã€‚ ä½†æ˜¯è¿™ç§æ–¹æ³•éœ€è¦ promise è¿™ä¸ªä¸´æ—¶å˜é‡ï¼Œä»ä»£ç è´¨é‡ä¸Šæ¥è¯´æ˜¾å¾—ä¸é‚£ä¹ˆç®€æ´ã€‚ Promise chain å’Œ reduce 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748function getURL(URL) &#123; return new Promise(function(resolve, reject) &#123; var req = new XMLHttpRequest(); req.open(\"GET\", URL, true); req.onload = function() &#123; if (req.status === 200) &#123; resolve(req.responseText); &#125; else &#123; reject(new Error(req.statusText)); &#125; &#125;; req.onerror = function() &#123; reject(new Error(req.statusText)); &#125;; req.send(); &#125;);&#125;var request = &#123; comment: function getComment() &#123; return getURL(\"http://azu.github.io/promises-book/json/comment.json\").then( JSON.parse ); &#125;, people: function getPeople() &#123; return getURL(\"http://azu.github.io/promises-book/json/people.json\").then( JSON.parse ); &#125;&#125;;function main() &#123; function recordValue(results, value) &#123; results.push(value); return results; &#125; var pushValue = recordValue.bind(null, []); var tasks = [request.comment, request.people]; return tasks.reduce(function(promise, task) &#123; return promise.then(task).then(pushValue); &#125;, Promise.resolve());&#125;// è¿è¡Œç¤ºä¾‹main() .then(function(value) &#123; console.log(value); &#125;) .catch(function(error) &#123; console.error(error); &#125;); Array.prototype.reduce çš„ç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥è®¾ç½®ç››æ”¾è®¡ç®—ç»“æœçš„åˆå§‹å€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ Promise.resolve() ä¼šèµ‹å€¼ç»™ promiseï¼Œæ­¤æ—¶çš„ task ä¸º request.comment ã€‚ åœ¨ reduce ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸­è¢« return çš„å€¼ï¼Œåˆ™ä¼šè¢«èµ‹å€¼ä¸ºä¸‹æ¬¡å¾ªç¯æ—¶çš„ promise ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡è¿”å›ç”± then åˆ›å»ºçš„æ–°çš„ promise å¯¹è±¡ï¼Œå°±å®ç°äº†å’Œ for å¾ªç¯ç±»ä¼¼çš„ Promise chain äº†ã€‚ ä½¿ç”¨ reduce å’Œ for å¾ªç¯ä¸åŒçš„åœ°æ–¹æ˜¯ reduce ä¸å†éœ€è¦ä¸´æ—¶å˜é‡ promise äº†ï¼Œå› æ­¤ä¹Ÿä¸ç”¨ç¼–å†™ promise = promise.then(task).then(pushValue); è¿™æ ·å†—é•¿çš„ä»£ç äº†ï¼Œè¿™æ˜¯éå¸¸å¤§çš„è¿›æ­¥ã€‚ å®šä¹‰è¿›è¡Œé¡ºåºå¤„ç†çš„å‡½æ•° 12345678910function sequenceTasks(tasks) &#123; function recordValue(results, value) &#123; results.push(value); return results; &#125; var pushValue = recordValue.bind(null, []); return tasks.reduce(function(promise, task) &#123; return promise.then(task).then(pushValue); &#125;, Promise.resolve());&#125; éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå’Œ Promise.all ç­‰ä¸åŒï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ•°ç»„ã€‚ä¸ºä»€ä¹ˆä¼ ç»™è¿™ä¸ªå‡½æ•°çš„ä¸æ˜¯ä¸€ä¸ª promise å¯¹è±¡çš„æ•°ç»„å‘¢ï¼Ÿè¿™æ˜¯å› ä¸º promise å¯¹è±¡åˆ›å»ºçš„æ—¶å€™ï¼ŒXHR å·²ç»å¼€å§‹æ‰§è¡Œäº†ï¼Œå› æ­¤å†å¯¹è¿™äº› promise å¯¹è±¡è¿›è¡Œé¡ºåºå¤„ç†çš„è¯å°±ä¸èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚ é‡å†™ä¸Šä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950function sequenceTasks(tasks) &#123; function recordValue(results, value) &#123; results.push(value); return results; &#125; var pushValue = recordValue.bind(null, []); return tasks.reduce(function(promise, task) &#123; return promise.then(task).then(pushValue); &#125;, Promise.resolve());&#125;function getURL(URL) &#123; return new Promise(function(resolve, reject) &#123; var req = new XMLHttpRequest(); req.open(\"GET\", URL, true); req.onload = function() &#123; if (req.status === 200) &#123; resolve(req.responseText); &#125; else &#123; reject(new Error(req.statusText)); &#125; &#125;; req.onerror = function() &#123; reject(new Error(req.statusText)); &#125;; req.send(); &#125;);&#125;var request = &#123; comment: function getComment() &#123; return getURL(\"http://azu.github.io/promises-book/json/comment.json\").then( JSON.parse ); &#125;, people: function getPeople() &#123; return getURL(\"http://azu.github.io/promises-book/json/people.json\").then( JSON.parse ); &#125;&#125;;function main() &#123; return sequenceTasks([request.comment, request.people]);&#125;// è¿è¡Œç¤ºä¾‹main() .then(function(value) &#123; console.log(value); &#125;) .catch(function(error) &#123; console.error(error); &#125;); å¦‚ä½•å®ç° Promise.all ?12345678910111213141516171819202122232425262728Promise.all = function(promises) &#123; return new Promise((resolve, reject) =&gt; &#123; let index = 0; let result = []; if (promises.length === 0) &#123; resolve(result); &#125; else &#123; function processValue(i, data) &#123; result[i] = data; if (++index === promises.length) &#123; resolve(result); &#125; &#125; for (let i = 0; i &lt; promises.length; i++) &#123; //promises[i] å¯èƒ½æ˜¯æ™®é€šå€¼ Promise.resolve(promises[i]).then( data =&gt; &#123; processValue(i, data); &#125;, err =&gt; &#123; reject(err); return; &#125; ); &#125; &#125; &#125;);&#125;; å¦‚ä½•å®ç° Promise.finally ?ä¸ç®¡æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šèµ°åˆ° finally ä¸­,å¹¶ä¸” finally ä¹‹åï¼Œè¿˜å¯ä»¥ç»§ç»­ thenã€‚å¹¶ä¸”ä¼šå°†å€¼åŸå°ä¸åŠ¨çš„ä¼ é€’ç»™åé¢çš„ then. 1234567891011121314Promise.prototype.finally = function(callback) &#123; return this.then( value =&gt; &#123; return Promise.resolve(callback()).then(() =&gt; &#123; return value; &#125;); &#125;, err =&gt; &#123; return Promise.resolve(callback()).then(() =&gt; &#123; throw err; &#125;); &#125; );&#125;; å¸¸è§é—®é¢˜ è¾“å‡ºç»“æœï¼šsuccess è§£é¢˜æ€è·¯ï¼šPromise çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œæ— æ³•åœ¨å‘ç”Ÿå˜æ›´ã€‚ 1234567891011121314const promise = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(\"success\"); reject(\"error\"); &#125;, 1000);&#125;);promise.then( res =&gt; &#123; console.log(res); &#125;, err =&gt; &#123; console.log(err); &#125;); è¾“å‡ºç»“æœï¼š1 è§£é¢˜æ€è·¯ï¼šPromise çš„ then æ–¹æ³•çš„å‚æ•°æœŸæœ›æ˜¯å‡½æ•°ï¼Œä¼ å…¥éå‡½æ•°åˆ™ä¼šå‘ç”Ÿå€¼ç©¿é€ã€‚ 1234Promise.resolve(1) .then(2) .then(Promise.resolve(3)) .then(console.log); ç»“æœæ˜¯ï¼š3 4 6 8 7 5 2 1 ä¼˜å…ˆçº§å…³ç³»å¦‚ä¸‹ï¼šprocess.nextTick &gt; promise.then &gt; setTimeout &gt; setImmediate 123456789101112131415161718setImmediate(function() &#123; console.log(1);&#125;, 0);setTimeout(function() &#123; console.log(2);&#125;, 0);new Promise(function(resolve) &#123; console.log(3); resolve(); console.log(4);&#125;).then(function() &#123; console.log(5);&#125;);console.log(6);process.nextTick(function() &#123; console.log(7);&#125;);console.log(8); V8 å®ç°ä¸­ï¼Œä¸¤ä¸ªé˜Ÿåˆ—å„åŒ…å«ä¸åŒçš„ä»»åŠ¡ï¼š macrotasks: script(æ•´ä½“ä»£ç ),setTimeout, setInterval, setImmediate, I/O, UI renderingmicrotasks: process.nextTick, Promises, Object.observe, MutationObserver å®ç°ä¸€ä¸ªç®€å•çš„ Promise 1234567891011121314151617181920212223242526272829303132333435function Promise(fn) &#123; var status = \"pending\"; function successNotify() &#123; status = \"fulfilled\"; //çŠ¶æ€å˜ä¸ºfulfilled toDoThen.apply(undefined, arguments); //æ‰§è¡Œå›è°ƒ &#125; function failNotify() &#123; status = \"rejected\"; //çŠ¶æ€å˜ä¸ºrejected toDoThen.apply(undefined, arguments); //æ‰§è¡Œå›è°ƒ &#125; function toDoThen() &#123; setTimeout(() =&gt; &#123; // ä¿è¯å›è°ƒæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ if (status === \"fulfilled\") &#123; for (let i = 0; i &lt; successArray.length; i++) &#123; successArray[i].apply(undefined, arguments); //æ‰§è¡Œthené‡Œé¢çš„å›æ‰å‡½æ•° &#125; &#125; else if (status === \"rejected\") &#123; for (let i = 0; i &lt; failArray.length; i++) &#123; failArray[i].apply(undefined, arguments); //æ‰§è¡Œthené‡Œé¢çš„å›æ‰å‡½æ•° &#125; &#125; &#125;); &#125; var successArray = []; var failArray = []; fn.call(undefined, successNotify, failNotify); return &#123; then: function(successFn, failFn) &#123; successArray.push(successFn); failArray.push(failFn); return undefined; // æ­¤å¤„åº”è¯¥è¿”å›ä¸€ä¸ªPromise &#125; &#125;;&#125; è§£é¢˜æ€è·¯ï¼šPromise ä¸­çš„ resolve å’Œ reject ç”¨äºæ”¹å˜ Promise çš„çŠ¶æ€å’Œä¼ å‚ï¼Œthen ä¸­çš„å‚æ•°å¿…é¡»æ˜¯ä½œä¸ºå›è°ƒæ‰§è¡Œçš„å‡½æ•°ã€‚å› æ­¤ï¼Œå½“ Promise æ”¹å˜çŠ¶æ€ä¹‹åä¼šè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œæ ¹æ®çŠ¶æ€çš„ä¸åŒé€‰æ‹©éœ€è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"JSå¼•æ“æ‰§è¡Œæœºåˆ¶","slug":"JSå¼•æ“æ‰§è¡Œæœºåˆ¶","date":"2019-07-30T05:13:29.000Z","updated":"2019-11-10T14:37:39.019Z","comments":true,"path":"2019/07/30/JSå¼•æ“æ‰§è¡Œæœºåˆ¶/","link":"","permalink":"http://yoursite.com/2019/07/30/JSå¼•æ“æ‰§è¡Œæœºåˆ¶/","excerpt":"JS å¼•æ“æ‰§è¡Œæœºåˆ¶(1) JS æ˜¯å•çº¿ç¨‹è¯­è¨€ (2) JS çš„ Event Loop æ˜¯ JS çš„æ‰§è¡Œæœºåˆ¶ã€‚æ·±å…¥äº†è§£ JS çš„æ‰§è¡Œ,å°±ç­‰äºæ·±å…¥äº†è§£ JS é‡Œçš„ event loop","text":"JS å¼•æ“æ‰§è¡Œæœºåˆ¶(1) JS æ˜¯å•çº¿ç¨‹è¯­è¨€ (2) JS çš„ Event Loop æ˜¯ JS çš„æ‰§è¡Œæœºåˆ¶ã€‚æ·±å…¥äº†è§£ JS çš„æ‰§è¡Œ,å°±ç­‰äºæ·±å…¥äº†è§£ JS é‡Œçš„ event loop JS ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„? ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥? å•çº¿ç¨‹åˆæ˜¯å¦‚ä½•å®ç°å¼‚æ­¥çš„å‘¢? JS æœ€åˆè¢«è®¾è®¡ç”¨åœ¨æµè§ˆå™¨ä¸­,é‚£ä¹ˆæƒ³è±¡ä¸€ä¸‹,å¦‚æœæµè§ˆå™¨ä¸­çš„ JS æ˜¯å¤šçº¿ç¨‹çš„ã€‚ åœºæ™¯æè¿°: é‚£ä¹ˆç°åœ¨æœ‰ 2 ä¸ªçº¿ç¨‹,process1 process2,ç”±äºæ˜¯å¤šçº¿ç¨‹çš„ JS,æ‰€ä»¥ä»–ä»¬å¯¹åŒä¸€ä¸ª dom,åŒæ—¶è¿›è¡Œæ“ä½œã€‚process1 åˆ é™¤äº†è¯¥ dom,è€Œ process2 ç¼–è¾‘äº†è¯¥ dom,åŒæ—¶ä¸‹è¾¾ 2 ä¸ªçŸ›ç›¾çš„å‘½ä»¤,æµè§ˆå™¨ç©¶ç«Ÿè¯¥å¦‚ä½•æ‰§è¡Œå‘¢? JS ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥? å¦‚æœ JS ä¸­ä¸å­˜åœ¨å¼‚æ­¥,åªèƒ½è‡ªä¸Šè€Œä¸‹æ‰§è¡Œ,å¦‚æœä¸Šä¸€è¡Œè§£ææ—¶é—´å¾ˆé•¿,é‚£ä¹ˆä¸‹é¢çš„ä»£ç å°±ä¼šè¢«é˜»å¡ã€‚å¯¹äºç”¨æˆ·è€Œè¨€,é˜»å¡å°±æ„å‘³ç€â€å¡æ­»â€,è¿™æ ·å°±å¯¼è‡´äº†å¾ˆå·®çš„ç”¨æˆ·ä½“éªŒ JS å•çº¿ç¨‹åˆæ˜¯å¦‚ä½•å®ç°å¼‚æ­¥çš„å‘¢? æ˜¯é€šè¿‡çš„äº‹ä»¶å¾ªç¯(event loop),ç†è§£äº† event loop æœºåˆ¶,å°±ç†è§£äº† JS çš„æ‰§è¡Œæœºåˆ¶ JS ä¸­çš„ event loopevent loopï¼ˆ1ï¼‰JS é‡Œçš„ä¸€ç§åˆ†ç±»æ–¹å¼,å°±æ˜¯å°†ä»»åŠ¡åˆ†ä¸º: åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ JS çš„æ‰§è¡Œæœºåˆ¶æ˜¯ï¼š é¦–å…ˆåˆ¤æ–­ JS æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥,åŒæ­¥å°±è¿›å…¥ä¸»çº¿ç¨‹,å¼‚æ­¥å°±è¿›å…¥ event table å¼‚æ­¥ä»»åŠ¡åœ¨ event table ä¸­æ³¨å†Œå‡½æ•°,å½“æ»¡è¶³è§¦å‘æ¡ä»¶å,è¢«æ¨å…¥ event queue åŒæ­¥ä»»åŠ¡è¿›å…¥ä¸»çº¿ç¨‹åä¸€ç›´æ‰§è¡Œ,ç›´åˆ°ä¸»çº¿ç¨‹ç©ºé—²æ—¶,æ‰ä¼šå» event queue ä¸­æŸ¥çœ‹æ˜¯å¦æœ‰å¯æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡,å¦‚æœæœ‰å°±æ¨å…¥ä¸»çº¿ç¨‹ä¸­ event loopï¼ˆ2ï¼‰å‡†ç¡®çš„åˆ’åˆ†æ–¹å¼æ˜¯: macro-task(å®ä»»åŠ¡)ï¼šåŒ…æ‹¬æ•´ä½“ä»£ç  scriptï¼ŒsetTimeoutï¼ŒsetInterval micro-task(å¾®ä»»åŠ¡)ï¼šPromise.thenï¼Œprocess.nextTick JS çš„æ‰§è¡Œæœºåˆ¶æ˜¯ï¼š æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡,è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡,å°±å°†å…¶æ”¾åˆ°å¾®ä»»åŠ¡çš„ã€äº‹ä»¶é˜Ÿåˆ—ã€‘é‡Œ å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæˆå,ä¼šæŸ¥çœ‹å¾®ä»»åŠ¡çš„ã€äº‹ä»¶é˜Ÿåˆ—ã€‘,å¹¶å°†é‡Œé¢å…¨éƒ¨çš„å¾®ä»»åŠ¡ä¾æ¬¡æ‰§è¡Œå®Œ é‡å¤ä»¥ä¸Š 2 æ­¥éª¤,ç»“åˆ event loop(1) event loop(2) ,å°±æ˜¯æ›´ä¸ºå‡†ç¡®çš„ JS æ‰§è¡Œæœºåˆ¶äº†ã€‚ ç†è§£ JavaScript çš„ async/awaitasync å’Œ await åœ¨å¹²ä»€ä¹ˆå…ˆä»å­—é¢æ„æ€æ¥ç†è§£ã€‚async æ˜¯â€œå¼‚æ­¥â€çš„ç®€å†™ï¼Œè€Œ await å¯ä»¥è®¤ä¸ºæ˜¯ async wait çš„ç®€å†™ã€‚æ‰€ä»¥åº”è¯¥å¾ˆå¥½ç†è§£ async ç”¨äºç”³æ˜ä¸€ä¸ª function æ˜¯å¼‚æ­¥çš„ï¼Œè€Œ await ç”¨äºç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•æ‰§è¡Œå®Œæˆã€‚ async å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚ å¦‚æœåœ¨å‡½æ•°ä¸­ return ä¸€ä¸ªç›´æ¥é‡ï¼Œasync ä¼šæŠŠè¿™ä¸ªç›´æ¥é‡é€šè¿‡ Promise.resolve() å°è£…æˆ Promise å¯¹è±¡ã€‚ å¦‚æœ async å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œåˆè¯¥å¦‚ä½•ï¼Ÿå¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œå®ƒä¼šè¿”å› Promise.resolve(undefined)ã€‚ Promise çš„ç‰¹ç‚¹â€”â€”æ— ç­‰å¾…ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰ await çš„æƒ…å†µä¸‹æ‰§è¡Œ async å‡½æ•°ï¼Œå®ƒä¼šç«‹å³æ‰§è¡Œï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¹¶ä¸”ï¼Œç»ä¸ä¼šé˜»å¡åé¢çš„è¯­å¥ã€‚è¿™å’Œæ™®é€šè¿”å› Promise å¯¹è±¡çš„å‡½æ•°å¹¶æ— äºŒè‡´ã€‚ await ç­‰å¾…çš„æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ è¿™ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœæ˜¯ Promise å¯¹è±¡æˆ–è€…å…¶å®ƒå€¼ï¼ˆæ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ²¡æœ‰ç‰¹æ®Šé™å®šï¼‰ã€‚ await ä¸ä»…ä»…ç”¨äºç­‰ Promise å¯¹è±¡ï¼Œå®ƒå¯ä»¥ç­‰ä»»æ„è¡¨è¾¾å¼çš„ç»“æœï¼Œæ‰€ä»¥ï¼Œawait åé¢å®é™…æ˜¯å¯ä»¥æ¥æ™®é€šå‡½æ•°è°ƒç”¨æˆ–è€…ç›´æ¥é‡çš„ã€‚ await ç­‰åˆ°äº†è¦ç­‰çš„ï¼Œç„¶åå‘¢ï¼Ÿ await æ˜¯ä¸ªè¿ç®—ç¬¦ï¼Œç”¨äºç»„æˆè¡¨è¾¾å¼ï¼Œawait è¡¨è¾¾å¼çš„è¿ç®—ç»“æœå–å†³äºå®ƒç­‰çš„ä¸œè¥¿ã€‚ å¦‚æœå®ƒç­‰åˆ°çš„ä¸æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œé‚£ await è¡¨è¾¾å¼çš„è¿ç®—ç»“æœå°±æ˜¯å®ƒç­‰åˆ°çš„ä¸œè¥¿ã€‚ å¦‚æœå®ƒç­‰åˆ°çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œawait å°±å¿™èµ·æ¥äº†ï¼Œå®ƒä¼šé˜»å¡åé¢çš„ä»£ç ï¼Œç­‰ç€ Promise å¯¹è±¡ resolveï¼Œç„¶åå¾—åˆ° resolve çš„å€¼ï¼Œä½œä¸º await è¡¨è¾¾å¼çš„è¿ç®—ç»“æœã€‚ è¿™å°±æ˜¯ await å¿…é¡»ç”¨åœ¨ async å‡½æ•°ä¸­çš„åŸå› ã€‚async å‡½æ•°è°ƒç”¨ä¸ä¼šé€ æˆé˜»å¡ï¼Œå®ƒå†…éƒ¨æ‰€æœ‰çš„é˜»å¡éƒ½è¢«å°è£…åœ¨ä¸€ä¸ª Promise å¯¹è±¡ä¸­å¼‚æ­¥æ‰§è¡Œã€‚ await ç­‰å¾…çš„è¡¨è¾¾å¼è¯¦è§£await ç­‰çš„æ˜¯å³ä¾§ã€Œè¡¨è¾¾å¼ã€çš„ç»“æœ await æ˜¯ä»å³å‘å·¦æ‰§è¡Œçš„ 12345678910async function async1() &#123; console.log(\"async1 start\"); await async2(); console.log(\"async1 end\");&#125;async function async2() &#123; console.log(\"async2\");&#125;async1();console.log(\"script start\"); å…ˆæ‰§è¡Œ async2 åï¼Œå‘ç°æœ‰ await å…³é”®å­—ï¼Œäºæ˜¯è®©å‡ºçº¿ç¨‹ï¼Œé˜»å¡ä»£ç  å³ä¾§è¡¨è¾¾å¼çš„ç»“æœ: å¦‚æœä¸æ˜¯ promise , await ä¼šé˜»å¡åé¢çš„ä»£ç ï¼Œå…ˆæ‰§è¡Œ async å¤–é¢çš„åŒæ­¥ä»£ç ï¼ŒåŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼Œå†å›åˆ° async å†…éƒ¨ï¼ŒæŠŠè¿™ä¸ªé promise çš„ä¸œè¥¿ï¼Œä½œä¸º await è¡¨è¾¾å¼çš„ç»“æœ å¦‚æœå®ƒç­‰åˆ°çš„æ˜¯ä¸€ä¸ª promise å¯¹è±¡ï¼Œawait ä¹Ÿä¼šæš‚åœ async åé¢çš„ä»£ç ï¼Œå…ˆæ‰§è¡Œ async å¤–é¢çš„åŒæ­¥ä»£ç ï¼Œç­‰ç€ Promise å¯¹è±¡ fulfilledï¼Œç„¶åæŠŠ resolve çš„å‚æ•°ä½œä¸º await è¡¨è¾¾å¼çš„è¿ç®—ç»“æœã€‚ async/await çš„ä¼˜åŠ¿åœ¨äºå¤„ç† then é“¾å•ä¸€çš„ Promise é“¾å¹¶ä¸èƒ½å‘ç° async/await çš„ä¼˜åŠ¿ï¼Œä½†æ˜¯ï¼Œå¦‚æœéœ€è¦å¤„ç†ç”±å¤šä¸ª Promise ç»„æˆçš„ then é“¾çš„æ—¶å€™ï¼Œä¼˜åŠ¿å°±èƒ½ä½“ç°å‡ºæ¥äº†ã€‚ Async/await ä»£ç æ¸…æ™°å¾ˆå¤šï¼Œå‡ ä¹è·ŸåŒæ­¥ä»£ç ä¸€æ ·ã€‚ Promise æ–¹æ¡ˆçš„æ­»ç©´â€”â€” é“¾å¼è°ƒç”¨å‚æ•°ä¼ é€’å¤ªéº»çƒ¦ async/await å’Œ promise çš„æ‰§è¡Œé¡ºåºä¾‹å­1234567891011121314151617181920async function async1() &#123; console.log(\"async1 start\"); await async2(); console.log(\"async1 end\");&#125;async function async2() &#123; console.log(\"async2\");&#125;console.log(\"script start\");setTimeout(function() &#123; console.log(\"setTimeout\");&#125;, 0);async1();new Promise(function(resolve) &#123; console.log(\"promise1\"); resolve();&#125;).then(function() &#123; console.log(\"promise2\");&#125;);console.log(\"script end\"); 12345678script startasync1 startasync2promise1script endpromise2async1 endsetTimeout å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„æ…¨å¿µï¼Œåœ¨æˆ‘è„‘æµ·ä¸­å®ä»»åŠ¡å’Œä¸ºå¾®ä»»åŠ¡å¦‚å›¾æ‰€ç¤º ä¹Ÿå°±æ˜¯ã€Œå®ä»»åŠ¡ã€ã€ã€Œå¾®ä»»åŠ¡ã€éƒ½æ˜¯é˜Ÿåˆ—ã€‚ ä¸€æ®µä»£ç æ‰§è¡Œæ—¶ï¼Œä¼šå…ˆæ‰§è¡Œå®ä»»åŠ¡ä¸­çš„åŒæ­¥ä»£ç ï¼Œ å¦‚æœæ‰§è¡Œä¸­é‡åˆ° setTimeout ä¹‹ç±»å®ä»»åŠ¡ï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸ª setTimeout å†…éƒ¨çš„å‡½æ•°æ¨å…¥ã€Œå®ä»»åŠ¡çš„é˜Ÿåˆ—ã€ä¸­ï¼Œä¸‹ä¸€è½®å®ä»»åŠ¡æ‰§è¡Œæ—¶è°ƒç”¨ã€‚ å¦‚æœæ‰§è¡Œä¸­é‡åˆ° promise.then()ä¹‹ç±»çš„å¾®ä»»åŠ¡ï¼Œå°±ä¼šæ¨å…¥åˆ°ã€Œå½“å‰å®ä»»åŠ¡çš„å¾®ä»»åŠ¡é˜Ÿåˆ—ã€ä¸­ï¼Œåœ¨æœ¬è½®å®ä»»åŠ¡çš„åŒæ­¥ä»£ç æ‰§è¡Œéƒ½å®Œæˆåï¼Œä¾æ¬¡æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡ 1ã€2ã€3 ä¾‹å­åˆ†ææ‰§è¡Œé¡ºåºç›´æ¥æ‰“å°åŒæ­¥ä»£ç  console.log(â€˜script startâ€™)12// é¦–å…ˆæ˜¯2ä¸ªå‡½æ•°å£°æ˜ï¼Œè™½ç„¶æœ‰asyncå…³é”®å­—ï¼Œä½†ä¸æ˜¯è°ƒç”¨æˆ‘ä»¬å°±ä¸çœ‹ã€‚ç„¶åé¦–å…ˆæ˜¯æ‰“å°åŒæ­¥ä»£ç console.log(\"script start\"); å°† setTimeout æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—é»˜è®¤æ‰€åŒ…è£¹çš„ä»£ç ï¼Œå…¶å®å¯ä»¥ç†è§£ä¸ºæ˜¯ç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯å®ä»»åŠ¡ 2 è°ƒç”¨ async1ï¼Œæ‰“å° åŒæ­¥ä»£ç  console.log( â€˜async1 startâ€™ )æˆ‘ä»¬è¯´è¿‡çœ‹åˆ°å¸¦æœ‰ async å…³é”®å­—çš„å‡½æ•°ï¼Œä¸ç”¨å®³æ€•ï¼Œå®ƒçš„ä»…ä»…æ˜¯æŠŠ return å€¼åŒ…è£…æˆäº† promiseï¼Œå…¶ä»–å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒçš„åœ°æ–¹ã€‚æ‰€ä»¥å°±å¾ˆæ™®é€šçš„æ‰“å° console.log( â€˜async1 startâ€™ ) åˆ†æä¸€ä¸‹ await async2()å‰æ–‡æè¿‡ awaitï¼Œ1.å®ƒå…ˆè®¡ç®—å‡ºå³ä¾§çš„ç»“æœï¼Œ2.ç„¶åçœ‹åˆ° await åï¼Œä¸­æ–­ async å‡½æ•° å…ˆå¾—åˆ° await å³ä¾§è¡¨è¾¾å¼çš„ç»“æœã€‚æ‰§è¡Œ async2()ï¼Œæ‰“å°åŒæ­¥ä»£ç  console.log(â€˜async2â€™), å¹¶ä¸” return Promise.resolve(undefined) await åï¼Œä¸­æ–­ async å‡½æ•°ï¼Œå…ˆæ‰§è¡Œ async å¤–çš„åŒæ­¥ä»£ç  ç›®å‰å°±ç›´æ¥æ‰“å° console.log(â€˜async2â€™) è¢«é˜»å¡åï¼Œè¦æ‰§è¡Œ async ä¹‹å¤–çš„ä»£ç æ‰§è¡Œ new Promise()ï¼ŒPromise æ„é€ å‡½æ•°æ˜¯ç›´æ¥è°ƒç”¨çš„åŒæ­¥ä»£ç ï¼Œæ‰€ä»¥ console.log( â€˜promise1â€™ ) ä»£ç è¿è¡Œåˆ° promise.then()ä»£ç è¿è¡Œåˆ° promise.then()ï¼Œå‘ç°è¿™ä¸ªæ˜¯å¾®ä»»åŠ¡ï¼Œæ‰€ä»¥æš‚æ—¶ä¸æ‰“å°ï¼Œåªæ˜¯æ¨å…¥å½“å‰å®ä»»åŠ¡çš„å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ æ³¨æ„ï¼šè¿™é‡Œåªæ˜¯æŠŠ promise2 æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œã€‚å¾®ä»»åŠ¡ä¼šåœ¨å½“å‰å®ä»»åŠ¡çš„åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šä¾æ¬¡æ‰§è¡Œ æ‰“å°åŒæ­¥ä»£ç  console.log(â€˜script endâ€™)æ‰§è¡Œå®Œè¿™ä¸ªåŒæ­¥ä»£ç åï¼Œã€Œasync å¤–çš„ä»£ç ã€ç»ˆäºèµ°äº†ä¸€é ä¸‹é¢è¯¥å›åˆ° await è¡¨è¾¾å¼é‚£é‡Œï¼Œæ‰§è¡Œ await Promise.resolve(undefined)äº† å›åˆ° async å†…éƒ¨ï¼Œæ‰§è¡Œ await Promise.resolve(undefined)è¿™éƒ¨åˆ†å¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œæˆ‘å°½é‡è¡¨è¾¾æˆ‘çš„æƒ³æ³•ã€‚ å¯¹äº await Promise.resolve(undefined) å¦‚ä½•ç†è§£å‘¢ï¼Ÿ æ ¹æ® MDN åŸè¯æˆ‘ä»¬çŸ¥é“ å¦‚æœä¸€ä¸ª Promise è¢«ä¼ é€’ç»™ä¸€ä¸ª await æ“ä½œç¬¦ï¼Œawait å°†ç­‰å¾… Promise æ­£å¸¸å¤„ç†å®Œæˆå¹¶è¿”å›å…¶å¤„ç†ç»“æœã€‚ åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯ Promise.resolve(undefined)æ­£å¸¸å¤„ç†å®Œæˆï¼Œå¹¶è¿”å›å…¶å¤„ç†ç»“æœã€‚é‚£ä¹ˆ await async2()å°±ç®—æ˜¯æ‰§è¡Œç»“æŸäº†ã€‚ ç›®å‰è¿™ä¸ª promise çš„çŠ¶æ€æ˜¯ fulfilledï¼Œç­‰å…¶å¤„ç†ç»“æœè¿”å›å°±å¯ä»¥æ‰§è¡Œ await ä¸‹é¢çš„ä»£ç äº†ã€‚ é‚£ä½•æ—¶èƒ½æ‹¿åˆ°å¤„ç†ç»“æœå‘¢ï¼Ÿ å›å¿†å¹³æ—¶æˆ‘ä»¬ç”¨ promiseï¼Œè°ƒç”¨ resolve åï¼Œä½•æ—¶èƒ½æ‹¿åˆ°å¤„ç†ç»“æœï¼Ÿæ˜¯ä¸æ˜¯éœ€è¦åœ¨ then çš„ç¬¬ä¸€ä¸ªå‚æ•°é‡Œï¼Œæ‰èƒ½æ‹¿åˆ°ç»“æœã€‚ ï¼ˆè°ƒç”¨ resolve æ—¶ï¼Œä¼šæŠŠ then çš„å‚æ•°æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰ä¸»çº¿ç¨‹ç©ºé—²æ—¶ï¼Œå†è°ƒç”¨å®ƒï¼‰ æ‰€ä»¥è¿™é‡Œçš„ await Promise.resolve() å°±ç±»ä¼¼äº 1Promise.resolve(undefined).then(undefined =&gt; &#123;&#125;); æŠŠ then çš„ç¬¬ä¸€ä¸ªå›è°ƒå‚æ•° (undefined) =&gt; {} æ¨å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚ then æ‰§è¡Œå®Œï¼Œæ‰æ˜¯ await async2()æ‰§è¡Œç»“æŸã€‚ await async2()æ‰§è¡Œç»“æŸï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç  å¦‚å›¾ æ­¤æ—¶å½“å‰å®ä»»åŠ¡ 1 éƒ½æ‰§è¡Œå®Œäº†ï¼Œè¦å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»£ç ã€‚å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå…ˆè¿›é€‰å‡ºçš„åŸåˆ™ï¼Œ æ‰§è¡Œå¾®ä»»åŠ¡ 1ï¼Œæ‰“å° promise2 æ‰§è¡Œå¾®ä»»åŠ¡ 2ï¼Œæ²¡ä»€ä¹ˆå†…å®¹.. ä½†æ˜¯å¾®ä»»åŠ¡ 2 æ‰§è¡Œåï¼Œawait async2()è¯­å¥ç»“æŸï¼Œåé¢çš„ä»£ç ä¸å†è¢«é˜»å¡ï¼Œæ‰€ä»¥æ‰“å° console.log(â€˜async1 endâ€™) å®ä»»åŠ¡ 1 æ‰§è¡Œå®Œæˆå,æ‰§è¡Œå®ä»»åŠ¡ 2å®ä»»åŠ¡ 2 çš„æ‰§è¡Œæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ‰“å° console.log(â€˜setTimeoutâ€™)","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"JSäº‹ä»¶æœºåˆ¶","slug":"JSäº‹ä»¶æœºåˆ¶","date":"2019-07-24T07:22:00.000Z","updated":"2019-11-10T14:37:39.019Z","comments":true,"path":"2019/07/24/JSäº‹ä»¶æœºåˆ¶/","link":"","permalink":"http://yoursite.com/2019/07/24/JSäº‹ä»¶æœºåˆ¶/","excerpt":"JS äº‹ä»¶æœºåˆ¶js é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿevent.preventDefault()å¯ä»¥å–æ¶ˆé»˜è®¤äº‹ä»¶ event.stopPropagation()èµ·åˆ°é˜»æ­¢æ•è·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚","text":"JS äº‹ä»¶æœºåˆ¶js é‡Œä¸€èˆ¬çš„é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ€ä¹ˆåšï¼Ÿevent.preventDefault()å¯ä»¥å–æ¶ˆé»˜è®¤äº‹ä»¶ event.stopPropagation()èµ·åˆ°é˜»æ­¢æ•è·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚ 1234567891011function cancelHandler(event) &#123; var event = event || window.event; //å…¼å®¹IE //å–æ¶ˆäº‹ä»¶ç›¸å…³çš„é»˜è®¤è¡Œä¸º if (event.preventDefault) //æ ‡å‡†æŠ€æœ¯ event.preventDefault(); if (event.returnValue) //å…¼å®¹IE9ä¹‹å‰çš„IE event.returnValue = false; return false; //ç”¨äºå¤„ç†ä½¿ç”¨å¯¹è±¡å±æ€§æ³¨å†Œçš„å¤„ç†ç¨‹åº&#125; å†’æ³¡çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿä¸‹é¢ä»£ç è¾“å‡ºé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ2-&gt;button-&gt;1ï¼‰ è§¦å‘é¡ºåºï¼šbutton-&gt;1-&gt;2 12345678910111213141516171819202122232425&lt;div&gt;&lt;button&gt;aaa&lt;/button&gt;&lt;/div&gt;&lt;script&gt; document.getElementById(\"div\").addEventListener( \"click\", function() &#123; console.log(\"1\"); &#125;, false ); document.getElementById(\"div\").addEventListener( \"click\", function() &#123; console.log(\"2\"); &#125;, false ); document.getElementById(\"button\").addEventListener( \"click\", function() &#123; console.log(\"button\"); &#125;, false );&lt;/script&gt; è§¦å‘é¡ºåºï¼š2-&gt;button-&gt;1 12345678910111213141516171819202122232425&lt;div&gt;&lt;button&gt;aaa&lt;/button&gt;&lt;/div&gt;&lt;script&gt; document.getElementById(\"div\").addEventListener( \"click\", function() &#123; console.log(\"1\"); &#125;, false ); document.getElementById(\"div\").addEventListener( \"click\", function() &#123; console.log(\"2\"); &#125;, true ); document.getElementById(\"button\").addEventListener( \"click\", function() &#123; console.log(\"button\"); &#125;, false );&lt;/script&gt; è§¦å‘é¡ºåºï¼š2-&gt;button-&gt;1 12345678910111213141516171819202122232425&lt;div&gt;&lt;button&gt;aaa&lt;/button&gt;&lt;/div&gt;&lt;script&gt; document.getElementById(\"div\").addEventListener( \"click\", function() &#123; console.log(\"1\"); &#125;, false ); document.getElementById(\"div\").addEventListener( \"click\", function() &#123; console.log(\"2\"); &#125;, true ); document.getElementById(\"button\").addEventListener( \"click\", function() &#123; console.log(\"button\"); &#125;, true );&lt;/script&gt;","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"JSé™æ€ä½œç”¨åŸŸ","slug":"JSé™æ€ä½œç”¨åŸŸ","date":"2019-07-11T03:01:34.000Z","updated":"2019-11-10T14:37:39.020Z","comments":true,"path":"2019/07/11/JSé™æ€ä½œç”¨åŸŸ/","link":"","permalink":"http://yoursite.com/2019/07/11/JSé™æ€ä½œç”¨åŸŸ/","excerpt":"JS é™æ€ä½œç”¨åŸŸjs çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«ä½œç”¨åŸŸä½œç”¨åŸŸæ˜¯æŒ‡ç¨‹åºæºä»£ç ä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸã€‚ ä½œç”¨åŸŸè§„å®šäº†å¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼Œä¹Ÿå°±æ˜¯ç¡®å®šå½“å‰æ‰§è¡Œä»£ç å¯¹å˜é‡çš„è®¿é—®æƒé™ã€‚ JavaScript é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸ(lexical scoping)ï¼Œä¹Ÿå°±æ˜¯é™æ€ä½œç”¨åŸŸã€‚","text":"JS é™æ€ä½œç”¨åŸŸjs çš„ä½œç”¨åŸŸå’Œåˆ«çš„ç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸæœ‰ä»€ä¹ˆåŒºåˆ«ä½œç”¨åŸŸä½œç”¨åŸŸæ˜¯æŒ‡ç¨‹åºæºä»£ç ä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸã€‚ ä½œç”¨åŸŸè§„å®šäº†å¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼Œä¹Ÿå°±æ˜¯ç¡®å®šå½“å‰æ‰§è¡Œä»£ç å¯¹å˜é‡çš„è®¿é—®æƒé™ã€‚ JavaScript é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸ(lexical scoping)ï¼Œä¹Ÿå°±æ˜¯é™æ€ä½œç”¨åŸŸã€‚ é™æ€ä½œç”¨åŸŸä¸åŠ¨æ€ä½œç”¨åŸŸå› ä¸º JavaScript é‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±å†³å®šäº†ã€‚ è€Œä¸è¯æ³•ä½œç”¨åŸŸç›¸å¯¹çš„æ˜¯åŠ¨æ€ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸæ˜¯åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ‰å†³å®šçš„ã€‚ è®©æˆ‘ä»¬è®¤çœŸçœ‹ä¸ªä¾‹å­å°±èƒ½æ˜ç™½ä¹‹é—´çš„åŒºåˆ«ï¼š 1234567891011121314var value = 1;function foo() &#123; console.log(value);&#125;function bar() &#123; var value = 2; foo();&#125;bar();// ç»“æœæ˜¯ ??? å‡è®¾ JavaScript é‡‡ç”¨é™æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š æ‰§è¡Œ foo å‡½æ•°ï¼Œå…ˆä» foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ valueï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æ ¹æ®ä¹¦å†™çš„ä½ç½®ï¼ŒæŸ¥æ‰¾ä¸Šé¢ä¸€å±‚çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯ value ç­‰äº 1ï¼Œæ‰€ä»¥ç»“æœä¼šæ‰“å° 1ã€‚ å‡è®¾ JavaScript é‡‡ç”¨åŠ¨æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š æ‰§è¡Œ foo å‡½æ•°ï¼Œä¾ç„¶æ˜¯ä» foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ valueã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±ä»è°ƒç”¨å‡½æ•°çš„ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯ bar å‡½æ•°å†…éƒ¨æŸ¥æ‰¾ value å˜é‡ï¼Œæ‰€ä»¥ç»“æœä¼šæ‰“å° 2ã€‚ å‰é¢æˆ‘ä»¬å·²ç»è¯´äº†ï¼ŒJavaScript é‡‡ç”¨çš„æ˜¯é™æ€ä½œç”¨åŸŸï¼Œæ‰€ä»¥è¿™ä¸ªä¾‹å­çš„ç»“æœæ˜¯ 1ã€‚ æœ€åï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªã€ŠJavaScript æƒå¨æŒ‡å—ã€‹ä¸­çš„ä¾‹å­ï¼š 123456789101112131415161718var scope = \"global scope\";function checkscope() &#123; var scope = \"local scope\"; function f() &#123; return scope; &#125; return f();&#125;checkscope();var scope = \"global scope\";function checkscope() &#123; var scope = \"local scope\"; function f() &#123; return scope; &#125; return f;&#125;checkscope()(); çŒœçŒœä¸¤æ®µä»£ç å„è‡ªçš„æ‰§è¡Œç»“æœæ˜¯å¤šå°‘ï¼Ÿ è¿™é‡Œç›´æ¥å‘Šè¯‰å¤§å®¶ç»“æœï¼Œä¸¤æ®µä»£ç éƒ½ä¼šæ‰“å°ï¼šlocal scopeã€‚ åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸º JavaScript é‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåŸºäºå‡½æ•°åˆ›å»ºçš„ä½ç½®ã€‚ è€Œå¼•ç”¨ã€ŠJavaScript æƒå¨æŒ‡å—ã€‹çš„å›ç­”å°±æ˜¯ï¼š JavaScript å‡½æ•°çš„æ‰§è¡Œç”¨åˆ°äº†ä½œç”¨åŸŸé“¾ï¼Œè¿™ä¸ªä½œç”¨åŸŸé“¾æ˜¯åœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™åˆ›å»ºçš„ã€‚åµŒå¥—çš„å‡½æ•° f() å®šä¹‰åœ¨è¿™ä¸ªä½œç”¨åŸŸé“¾é‡Œï¼Œå…¶ä¸­çš„å˜é‡ scope ä¸€å®šæ˜¯å±€éƒ¨å˜é‡ï¼Œä¸ç®¡ä½•æ—¶ä½•åœ°æ‰§è¡Œå‡½æ•° f()ï¼Œè¿™ç§ç»‘å®šåœ¨æ‰§è¡Œ f() æ—¶ä¾ç„¶æœ‰æ•ˆã€‚ bash å°±æ˜¯åŠ¨æ€ä½œç”¨åŸŸ","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"httpsä¸­é—´äººæ”»å‡»åŠé˜²å¾¡","slug":"httpsä¸­é—´äººæ”»å‡»åŠé˜²å¾¡","date":"2019-07-03T06:51:26.000Z","updated":"2019-11-10T14:37:39.023Z","comments":true,"path":"2019/07/03/httpsä¸­é—´äººæ”»å‡»åŠé˜²å¾¡/","link":"","permalink":"http://yoursite.com/2019/07/03/httpsä¸­é—´äººæ”»å‡»åŠé˜²å¾¡/","excerpt":"https ä¸­é—´äººæ”»å‡»åŠé˜²å¾¡HTTPS ä¹Ÿä¸æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œåœ¨ HTTPS æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå®æ–½ä¸å½“ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨æ¼æ´ï¼Œå¾ˆå®¹è¢«ä¸­é—´äººæ”»å‡»ï¼› ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ä¸­é—´äººæ”»å‡»ï¼ˆMan-in-the-middle attackï¼Œç¼©å†™ï¼šMITMï¼‰æ˜¯æŒ‡æ”»å‡»è€…ä¸é€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«å»ºç«‹ç‹¬ç«‹çš„è”ç³»ï¼Œå¹¶äº¤æ¢å…¶æ‰€æ”¶åˆ°çš„æ•°æ®ï¼Œä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡ä¸€ä¸ªç§å¯†çš„è¿æ¥ä¸å¯¹æ–¹ç›´æ¥å¯¹è¯ï¼Œä½†äº‹å®ä¸Šæ•´ä¸ªä¼šè¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æ§åˆ¶ã€‚åœ¨ä¸­é—´äººæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šè®¯åŒæ–¹çš„é€šè¯å¹¶æ’å…¥æ–°çš„å†…å®¹ã€‚","text":"https ä¸­é—´äººæ”»å‡»åŠé˜²å¾¡HTTPS ä¹Ÿä¸æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œåœ¨ HTTPS æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå®æ–½ä¸å½“ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨æ¼æ´ï¼Œå¾ˆå®¹è¢«ä¸­é—´äººæ”»å‡»ï¼› ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ä¸­é—´äººæ”»å‡»ï¼ˆMan-in-the-middle attackï¼Œç¼©å†™ï¼šMITMï¼‰æ˜¯æŒ‡æ”»å‡»è€…ä¸é€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«å»ºç«‹ç‹¬ç«‹çš„è”ç³»ï¼Œå¹¶äº¤æ¢å…¶æ‰€æ”¶åˆ°çš„æ•°æ®ï¼Œä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡ä¸€ä¸ªç§å¯†çš„è¿æ¥ä¸å¯¹æ–¹ç›´æ¥å¯¹è¯ï¼Œä½†äº‹å®ä¸Šæ•´ä¸ªä¼šè¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æ§åˆ¶ã€‚åœ¨ä¸­é—´äººæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šè®¯åŒæ–¹çš„é€šè¯å¹¶æ’å…¥æ–°çš„å†…å®¹ã€‚ å¦‚ä½•è¿›è¡Œä¸­é—´äººæ”»å‡»çš„å‘¢ï¼Ÿæ”»å‡»ä¸€ï¼šSSLSniffæ”»å‡»è€…åœ¨ç½‘å…³æˆªè· SSL ä¼šè¯ï¼Œæ›¿æ¢æœåŠ¡å™¨å…¬é’¥è¯ä¹¦ï¼Œå°†å…¬é’¥PKeyæ¢æˆè‡ªå·±çš„å…¬é’¥PKeyï¼Œæ¬ºéª—å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä½¿ç”¨PKeyåŠ å¯†ä¿¡æ¯å¹¶å‘é€ä¼šè¯ï¼Œä¸­é—´äººç”¨ç§é’¥Skeyè§£å¯†å®¢æˆ·ç«¯è¿”å›ä¼šè¯ï¼Œä»è€ŒåŠ«æŒä¼šè¯ã€‚åŒæ—¶ï¼Œä¸­é—´äººç”¨PKeyåŠ å¯†æ˜æ–‡ä¼šè¯å¹¶è¿”å›æœåŠ¡å™¨ è¿‡ç¨‹å¦‚ä¸‹ï¼š Attackeræˆªè·äº†å®¢æˆ·ç«¯çš„say helloï¼Œå¯ä»¥æŠŠpublicKey_attackerè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå–å¾—å®¢æˆ·ç«¯çš„ä¿¡ä»»ï¼Œè‡³æ­¤Attackerä¸å®¢æˆ·ç«¯å»ºç«‹äº†å®‰å…¨è¿æ¥ã€‚ Attackerå†’å……å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€say helloï¼Œè‡³æ­¤Attackerä¸æœåŠ¡å™¨å»ºç«‹äº†å®‰å…¨è¿æ¥ã€‚ è¿™ç§æ”»å‡»ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ä¼šè¢«æ„ŸçŸ¥åˆ°ï¼Œå°±æ˜¯Attackerçš„è¯ä¹¦æ˜¯ä¼ªé€ çš„ä¸å—ä¿¡ä»»çš„è¯ä¹¦ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å¯ä»¥ç¡®è®¤æ˜¯å¦éœ€è¦çœŸçš„è¿æ¥è¯¥æœåŠ¡å™¨ï¼Œä¸è¿‡å¦‚æœæœ‰å†…é¬¼çš„è¯ï¼Œä¼ªé€ çš„å—ä¿¡ä»»çš„è¯ä¹¦çš„è¯ï¼Œå°±å½“æˆ‘å•¥ä¹Ÿæ²¡è¯´ï¼› æ”»å‡»äºŒï¼šSSLStripè¿™ç§æ”»å‡»ç›¸å¯¹äºæ”»å‡»ä¸€å¤æ‚ä¸€ç‚¹ï¼Œä½†æ˜¯ä¹Ÿæ›´åŠ å‰å®³ï¼Œå‡ ä¹å¯ä»¥åœ¨å®¢æˆ·ç«¯æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹å®æ–½æ”»å‡»ï¼Œå¹¶ä¸”ä¸éœ€è¦ä¼ªé€ è¯ä¹¦ï¼›ç®€å•æ¥è¯´å°±æ˜¯è¿™æ ·ï¼šAttackeråœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œåœ¨Attackerä¸æœåŠ¡å™¨ä¹‹é—´å½¢æˆ HTTPS è¿æ¥ï¼Œè€Œåœ¨å®¢æˆ·ç«¯ä¸Attackerä¹‹é—´å½¢æˆHTTPè¿æ¥ï¼Œå³å°† SSL å±‚ä»åŸ HTTPS è¿æ¥ä¸­â€œå‰¥ç¦»â€ã€‚è¿™æ ·ï¼Œæ—¢é¿å…äº†åœ¨å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦æ—¶éš¾ä»¥é¿å…çš„å¼¹æ¡†é—®é¢˜ï¼Œåˆèƒ½å¤ŸåŠ«æŒ HTTP æ˜æ–‡æ•°æ®ï¼Œå¹¶åŒæ—¶ä¿è¯å®¢æˆ·ç«¯HTTPæ•°æ®çš„ä¼ è¾“ï¼Œè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„æ•ˆæœã€‚ è¿‡ç¨‹å¦‚ä¸‹ï¼š ç”¨æˆ·åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ç½‘å€æ—¶ï¼Œå¤šæ•°ä¼šé‡‡ç”¨ç›´æ¥è¾“å…¥ç½‘å€çš„æ–¹å¼ï¼Œè€Œå¿½ç•¥äº†ä¼ è¾“æ‰€é‡‡ç”¨çš„åè®®ã€‚ä¾‹å¦‚ï¼Œåœ¨ç™»å½• gmail è¿‡ç¨‹ä¸­ï¼Œå¤§å¤šæ•°ç”¨æˆ·ä¼šç›´æ¥åœ¨åœ°å€æ ä¸­è¾“å…¥www.gmail.comï¼Œå‘GoogleæœåŠ¡å™¨å‘é€ä¸€ä¸ª HTTP è¿æ¥è¯·æ±‚ï¼Œè€Œä¸æ˜¯è¾“å…¥httpsï¼š//www.gmail.comï¼Œ å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPSè¿æ¥è¯·æ±‚ã€‚å› æ­¤ï¼Œç”¨æˆ·é€šå¸¸æ¥è§¦åˆ° HTTPS çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯ Web ä¸Šçš„è¿æ¥ï¼Œæ¯”å¦‚å½“ç”¨æˆ·åœ¨ gmail ä¸Šè¾“å…¥ç”¨æˆ·åå’Œå¯†ç åï¼Œç‚¹å‡»çš„ç™»å½•é”®ï¼Œå°†ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ä»¥HTTPSçš„å½¢å¼POSTåˆ°æœåŠ¡å™¨ã€‚å¦ä¸€ç§æ˜¯é€šè¿‡ HTTP çš„ 302 çŠ¶æ€ã€‚ å½“å®¢æˆ·ç«¯å‘ gmail æå‡º HTTP è¿æ¥è¯·æ±‚æ—¶ï¼Œgmail æœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªREDIRECTç½‘å€ï¼Œhttpsï¼š//www.google.com/accounts/ServiceLogin?service=mail...ï¼Œç”¨æˆ·ç«¯åœ¨æ¥æ”¶åˆ°è¿™ä¸ª URL åï¼Œå°†é¡µé¢é‡å®šä½åˆ°è¯¥ç½‘é¡µï¼Œå¹¶è¯·æ±‚ HTTPS è¿æ¥ã€‚ ä»å¦å¤–ä¸€ä¸ªè§’åº¦è®²ï¼Œç”¨æˆ·é€šå¸¸æ˜¯é€šè¿‡HTTPå‘æœåŠ¡å™¨å‘èµ·HTTPSè¿æ¥çš„ã€‚è€ŒHTTPæœ¬èº«æ˜¯ä»¥æ˜æ–‡çš„å½¢å¼å¯¹å¤–ä¼ é€ï¼Œå¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å®‰å…¨ã€‚å› æ­¤ï¼Œå¯ä»¥è€ƒè™‘é€šè¿‡å¯¹ HTTP è¿›è¡ŒåŠ«æŒï¼Œæ¥å®ç°å¯¹ HTTPS åŠ«æŒçš„ç›®çš„ã€‚ å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·HTTPè¿æ¥è¯·æ±‚ï¼› ä¸­é—´äºº MITM ç›‘å¬å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„HTTPæ•°æ®ï¼› æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„ HTTP æ•°æ®åŒ…è¢«åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ä¸­é—´äººæˆªè·ã€‚ä¸­é—´äººè§£æåŸ HTTP æ•°æ®åŒ…ï¼Œå°†å…¶ä¸­&lt;a href=â€httpsï¼š//...â€&gt;æ›¿æ¢æˆ&lt;a href=â€http//...â€&gt;ï¼Œå°† Locationï¼š httpsï¼š//... æ›¿æ¢æˆLocationï¼šhttp://..ï¼ŒåŒæ—¶è®°å½•ä¸‹æ‰€ä¿®æ”¹çš„ URLï¼Œå¹¶ä¿å­˜ï¼› ä¸­é—´äººå°†ä¿®æ”¹åçš„HTTPæ•°æ®å‘é€ç»™å®¢æˆ·ç«¯ï¼› å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·HTTPè¿æ¥è¯·æ±‚ï¼› ä¸­é—´äººè®¡ç®—æœºè§£æå®¢æˆ·ç«¯çš„HTTPè¿æ¥è¯·æ±‚ï¼Œå¹¶ä¸ä¿å­˜æ–‡ä»¶ç›¸æ¯”è¾ƒã€‚å½“å‘ç°å­˜åœ¨æœ‰å·²ä¿®æ”¹è¿‡çš„HTTP URLæ—¶ï¼Œå°†å…¶æ›¿æ¢æˆåŸHTTPS URLï¼Œå¹¶å‘é€ç»™æœåŠ¡å™¨ï¼› ä¸æœåŠ¡å™¨ä¿æŒHTTPSè¿æ¥ï¼Œå›åˆ°æ­¥éª¤ 3ï¼› ä¸å®¢æˆ·ç«¯ä¿æŒHTTPè¿æ¥ï¼Œå›åˆ°æ­¥éª¤ 4ã€‚ æ•ˆæœå°±æ˜¯ï¼š æœåŠ¡å™¨è®¤ä¸º HTTPS æ˜¯å®‰å…¨çš„ã€‚å¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œç”±äºä¸­é—´äºº MITM ä¸å®¢æˆ·ç«¯ Client ä¹‹é—´æ˜¯ HTTP è¿æ¥ï¼Œå› æ­¤å¹¶ä¸ä¼šå¯¹è¯ä¹¦è¿›è¡Œè®¤è¯ï¼› HSTS:ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒIETFï¼ˆäº’è”ç½‘å·¥ç¨‹ä»»åŠ¡å°ç»„ï¼‰å¼•å…¥äº†ä¸€ä¸ªç­–ç•¥ï¼Œå«åš HSTS (HTTP Strict Transport Security, HTTP ä¸¥æ ¼ä¼ è¾“å®‰å…¨)ã€‚HSTS çš„ä½œç”¨æ˜¯å¼ºåˆ¶å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹å®‰å…¨çš„ HTTPS è¿æ¥ï¼Œè€Œéä¸å®‰å…¨çš„ HTTP è¿æ¥ã€‚å¦‚æœä¸€ä¸ªç«™ç‚¹å¯ç”¨äº† HSTS ç­–ç•¥ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åœ¨ç¬¬ä¸€æ¬¡ä¸è¯¥ç«™ç‚¹å»ºç«‹è¿æ¥ä¹‹åï¼Œåœ¨æœªæ¥çš„ä¸€æ®µæ—¶é—´å†…ï¼ˆç”±ä¸€ä¸ª HTTP å¤´éƒ¨æ§åˆ¶ï¼Œè¿™ä¸ªå¤´éƒ¨ä¸ºï¼šStrict-Transport-Securityï¼‰ï¼Œå®¢æˆ·ç«¯ä¸è¯¥ç«™ç‚¹çš„æ‰€æœ‰è¿æ¥éƒ½ä¼šç›´æ¥ä½¿ç”¨ HTTPSï¼Œå³ä½¿å®¢æˆ·ç«¯è®¿é—®çš„æ˜¯ HTTPï¼Œä¹Ÿä¼šç›´æ¥åœ¨å®¢æˆ·ç«¯é‡å®šå‘åˆ° HTTPS è¿æ¥ã€‚ å‡è®¾ https://example.com çš„å“åº”å¤´éƒ¨å«æœ‰ Strict-Transport-Security: max-age=31536000; includeSubDomainsï¼Œè¿™æ„å‘³ç€ï¼š åœ¨æœªæ¥çš„ 1 å¹´æ—¶é—´é‡Œï¼ˆå³ 31536000 ç§’ä¸­ï¼‰ï¼Œåªè¦æµè§ˆå™¨å‘ example.com æˆ–è€…å…¶å­åŸŸåå‘é€è¯·æ±‚ï¼Œå¿…é¡»é‡‡ç”¨ HTTPS æ¥å‘èµ·è¿æ¥ã€‚å³ä½¿ç”¨æˆ·åœ¨åœ°å€æ é‡Œå†™çš„æ˜¯ http://example.comï¼Œé‚£ä¹Ÿç›´æ¥é‡å†™ä¸º https://example.com å¹¶ç›´æ¥å‘èµ· HTTPS è¿æ¥ã€‚ åœ¨æ¥ä¸‹å»çš„ä¸€å¹´ä¸­ï¼Œå¦‚æœæœåŠ¡å™¨æä¾›çš„ HTTPS è¯ä¹¦æ— æ•ˆï¼ˆä¸è®ºæ˜¯åŸŸåå¯¹ä¸ä¸Šè¿˜æ˜¯è‡ªç­¾åè¿˜æ˜¯ä¸åœ¨æœ‰æ•ˆæœŸå†…ï¼‰ï¼Œç”¨æˆ·éƒ½æ— æ³•è®¿é—®è¯¥ç«™ç‚¹ã€‚ å¦‚æœç«™ç‚¹æ²¡æœ‰å¯ç”¨ HSTSï¼Œç”¨æˆ·å¯ä»¥å¿½ç•¥è¯ä¹¦æ— æ•ˆçš„è­¦å‘Šï¼Œç»§ç»­å»ºç«‹è¿æ¥ï¼Œè€Œå¦‚æœç«™ç‚¹å¯ç”¨äº† HSTSï¼Œé‚£ä¹ˆç”¨æˆ·å³ä½¿æƒ³å†’é£é™©ï¼Œæµè§ˆå™¨ä¹Ÿä¸ä¼šç»§ç»­è®¿é—®ã€‚ HSTS å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šé˜²æ­¢ SSLTrip æ”»å‡»ï¼Œä¸è¿‡è¿™æ ·è¿˜æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯è¦å¯ç”¨ HSTSï¼Œæµè§ˆå™¨è‡³å°‘è¦å’ŒæœåŠ¡å™¨å»ºç«‹ä¸€æ¬¡ HTTPS è¿æ¥ï¼Œå¦‚æœä¸­é—´äººä¸€ç›´é˜»æ­¢æµè§ˆå™¨ä¸æœåŠ¡å™¨å»ºç«‹ HTTPS è¿æ¥ï¼Œé‚£ä¹ˆ HSTS å°±å¤±æ•ˆäº†ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æœ‰ä¸ªåŠæ³•ï¼Œé‚£å°±æ˜¯å°† HSTS ç«™ç‚¹åˆ—è¡¨å†…ç½®åˆ°æµè§ˆå™¨ä¸­ï¼Œè¿™æ ·åªè¦æµè§ˆå™¨ç¦»çº¿åˆ¤æ–­è¯¥ç«™ç‚¹å¯ç”¨äº† HSTSï¼Œå°±ä¼šè·³è¿‡åŸå…ˆçš„ HTTP é‡å®šå‘ï¼Œç›´æ¥å‘èµ· HTTPS è¯·æ±‚ã€‚ å¦‚ä½•é˜²å¾¡ä¸­é—´äººæ”»å‡»ï¼Ÿä¸­é—´äººæ”»å‡»æ˜¯ä¸€ä¸ªï¼ˆç¼ºä¹ï¼‰ç›¸äº’è®¤è¯çš„æ”»å‡»ï¼›ç”±äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´åœ¨ SSL æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ç¼ºä¹ç›¸äº’è®¤è¯è€Œé€ æˆçš„æ¼æ´ é˜²å¾¡ä¸­é—´äººæ”»å‡»çš„æ–¹æ¡ˆé€šå¸¸åŸºäºä»¥ä¸‹å‡ ç§æŠ€æœ¯ å…¬é’¥åŸºç¡€å»ºè®¾ PKIï¼Œæ›´å¼ºåŠ›çš„ç›¸äº’è®¤è¯ ä½¿ç”¨ PKI ç›¸äº’è®¤è¯æœºåˆ¶ï¼Œå®¢æˆ·ç«¯éªŒè¯æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨éªŒè¯å®¢æˆ·ç«¯ï¼›ä¸Šè¿°ä¸¤ä¸ªä¾‹å­ä¸­éƒ½æ˜¯åªéªŒè¯æœåŠ¡å™¨ï¼Œè¿™æ ·å°±é€ æˆäº† SSL æ¡æ‰‹ç¯èŠ‚çš„æ¼æ´ï¼Œè€Œå¦‚æœä½¿ç”¨ç›¸äº’è®¤è¯çš„çš„è¯ï¼ŒåŸºæœ¬å¯ä»¥ä¿è¯ å»¶è¿Ÿæµ‹è¯• ä½¿ç”¨å¤æ‚åŠ å¯†å“ˆå¸Œå‡½æ•°è¿›è¡Œè®¡ç®—ä»¥é€ æˆæ•°åç§’çš„å»¶è¿Ÿï¼›å¦‚æœåŒæ–¹é€šå¸¸æƒ…å†µä¸‹éƒ½è¦èŠ±è´¹ 20 ç§’æ¥è®¡ç®—ï¼Œå¹¶ä¸”æ•´ä¸ªé€šè®¯èŠ±è´¹äº† 60 ç§’è®¡ç®—æ‰åˆ°è¾¾å¯¹æ–¹ï¼Œè¿™å°±èƒ½è¡¨æ˜å­˜åœ¨ç¬¬ä¸‰æ–¹ä¸­é—´äººã€‚ https é€šä¿¡å®‰å…¨æ€§çš„ä¿è¯é€šä¿¡è¿‡ç¨‹çš„å®‰å…¨æ€§è‡ªä¸‹è€Œä¸Šå°±æ˜¯è¿™æ ·ä¿è¯çš„ï¼š åŒæ–¹é€šä¿¡å†…å®¹çš„å®‰å…¨æ€§æ˜¯é å…¬é’¥åŠ å¯†ã€ç§é’¥è§£å¯†æ¥ä¿è¯çš„ï¼Œè¿™ä¸€å®‰å…¨æ€§ç”±éå¯¹ç§°åŠ å¯†çš„ç‰¹æ€§ï¼Œå³ç”±å…¬é’¥åŠ å¯†çš„ä¿¡æ¯åªèƒ½ä½¿ç”¨å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¼€æ¥ä¿è¯ã€‚ç”±äºç§é’¥ä¸ä¼šä¼ é€’ï¼Œåªæœ‰æ‹¥æœ‰è€…çŸ¥é“ï¼Œæ‰€ä»¥å®‰å…¨æ€§å°±ç”±å…¬é’¥çš„æ­£ç¡®æ€§æ¥ä¿è¯ã€‚ å…¬é’¥ç”±å¯¹æ–¹åœ¨é€šä¿¡åˆå§‹æ‰€æä¾›ï¼Œä½†æ˜¯è¿™æ—¶å¾ˆå®¹æ˜“è¢«ä¸­é—´äººæ›¿æ¢æ‰ï¼Œä¸ºäº†ä¿è¯å…¬é’¥çš„æ­£ç¡®æ€§ï¼Œæ‰€ä»¥åœ¨å‘é€å…¬é’¥çš„æ—¶å€™ä¹Ÿä¼šæä¾›å¯¹åº”çš„æ•°å­—è¯ä¹¦ï¼Œç”¨äºéªŒè¯è¿™ä¸ªå…¬é’¥æ˜¯å¯¹æ–¹çš„è€Œä¸æ˜¯ä¸­é—´äººçš„ã€‚é‚£ä¹ˆå®‰å…¨æ€§å°±æ˜¯ç”±æ•°å­—è¯ä¹¦çš„æ­£ç¡®æ€§æ¥ä¿è¯äº†ã€‚ æ•°å­—è¯ä¹¦æ˜¯ç”±ä¸Šçº§ CA ç­¾å‘ç»™ä¸ªäºº / ç»„ç»‡çš„ï¼Œä¸Šçº§ CA ç”¨è‡ªå·±çš„ç§é’¥ç»™ä¸ªäººè¯ä¹¦è¿›è¡Œç­¾åï¼Œä¿è¯è¯ä¹¦ä¸­çš„å…¬é’¥ä¸è¢«ç¯¡æ”¹ï¼Œè€Œæ¥å—è€…éœ€è¦ç”¨ä¸Šçº§ CA è¯ä¹¦ä¸­çš„å…¬é’¥æ¥è§£å¯†ä¸ªäººæ•°å­—è¯ä¹¦ä¸­çš„æ•°å­—ç­¾åæ¥éªŒè¯è¯ä¹¦ä¸­çš„å…¬é’¥æ˜¯å¦æ˜¯æ­£ç¡®çš„ã€‚é‚£ä¹ˆå®‰å…¨æ€§å°±æ˜¯ç”±*ä¸Šçº§ CA è¯ä¹¦çš„æ­£ç¡®æ€§ä¿è¯çš„äº†ã€‚*ï¼ˆæ•°å­—ç­¾åä¿è¯äº†æ•°å­—è¯ä¹¦æ²¡æœ‰è¢«ç¯¡æ”¹**ï¼‰ ä½†æ˜¯ï¼Œä¸Šçº§ CA è¯ä¹¦ä¹Ÿæ˜¯ç”±å…¶ä¸Šçº§ CA ç­¾å‘çš„ï¼Œè¿™ç§ä¿¡ä»»å…³ç³»ä¸€ç›´åˆ°æ ¹è¯ä¹¦ã€‚æ ¹è¯ä¹¦æ²¡æœ‰ä¸Šçº§ CA ä¸ºå…¶ç­¾åï¼Œè€Œæ˜¯è‡ªç­¾åçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒè‡ªèº«ä¸ºè‡ªèº«ç­¾åï¼Œä¿è¯æ­£ç¡®æ€§ã€‚æ‰€ä»¥æ ¹è¯ä¹¦å°±æ˜¯è¿™ä¸ªä¿¡ä»»é“¾æœ€é‡è¦çš„éƒ¨åˆ†ã€‚å¦‚æœæ ¹è¯ä¹¦æ³„éœ²çš„è¯ï¼Œå…¶ç­¾åçš„æ‰€æœ‰è¯ä¹¦åŠä½¿ç”¨å…¶ç­¾åçš„è¯ä¹¦æ‰€ç­¾åçš„è¯ä¹¦çš„å®‰å…¨æ€§å°†ä¸å¤å­˜åœ¨ã€‚ç°åœ¨ï¼Œå®‰å…¨æ€§å°±æ˜¯é ç³»ç»Ÿæ ¹è¯ä¹¦çš„ç§é’¥ä¸è¢«æ³„éœ²æˆ–è€…å…¶å…¬é’¥ä¸è¢«ç¯¡æ”¹æ¥ä¿è¯çš„äº†ã€‚ æ ¹è¯ä¹¦ä¸åº”è¯¥é€šè¿‡ç½‘ç»œåˆ†å‘ï¼Œå› ä¸ºé€šè¿‡ç½‘ç»œåˆ†å‘çš„è¯ï¼Œå¯èƒ½ä¼šè¢«ä¸­é—´äººæ”»å‡»ã€‚ä¸€èˆ¬æ ¹è¯ä¹¦éƒ½é€šè¿‡æ“ä½œç³»ç»Ÿæˆ–è€…æµè§ˆå™¨åˆ†å‘ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­ä¼šå†…ç½®å¾ˆå¤šæ ¹è¯ä¹¦ï¼Œä½†æ˜¯æœ€åˆçš„æ“ä½œç³»ç»Ÿä¹Ÿä¸èƒ½é€šè¿‡ç½‘ç»œåˆ†å‘ï¼Œå› ä¸ºä¸­é—´äººå¯ä»¥ä¿®æ”¹æ“ä½œç³»ç»Ÿä¸­çš„æ ¹è¯ä¹¦ã€‚æ‰€ä»¥è¦ä¿è¯å®‰å…¨åªèƒ½é æœ€åŸå§‹çš„æ–¹æ³•ï¼Œå½“é¢äº¤æµã€‚ç¡¬ä»¶å‚å•†ä¼šå’Œè¯ä¹¦ç­¾å‘æœºæ„åˆä½œï¼Œåœ¨ç”µè„‘ã€æ‰‹æœºç­‰è®¾å¤‡å‡ºå‚çš„æ—¶å€™åœ¨å…¶æ“ä½œç³»ç»Ÿä¸­å†…ç½®ç­¾å‘æœºæ„çš„æ ¹è¯ä¹¦ï¼Œå†å°†è¿™äº›è®¾å¤‡åˆ†å‘å‡ºå»ï¼Œè¿™æ ·ï¼Œè¿™äº›è®¾å¤‡çš„ç”¨æˆ·å°±å¯ä»¥å®‰å…¨åœ°è¿›è¡Œä¿¡æ¯äº¤æ¢äº†ã€‚æ‰€ä»¥ï¼Œå®‰å…¨æ€§å°±ä¾èµ–äºè¿™äº›è®¾å¤‡åœ¨åˆ†å‘åˆ°æ¶ˆè´¹è€…æ‰‹ä¸­ä¹‹å‰ä¸ä¼šè¢«æ¶æ„ä¿®æ”¹æ¥ä¿è¯äº†ã€‚ è‡³æ­¤ï¼Œæ•´ä¸ªä¿¡ä»»é“¾å°±å»ºç«‹èµ·æ¥äº†ï¼Œåªéœ€è¦æœ‰ä¸€å°è®¾å¤‡ä¸Šå®‰è£…äº†å¯ä»¥ä¿¡ä»»çš„æ ¹è¯ä¹¦ï¼Œå°±å¯ä»¥ç”¨æ¥åˆ†å‘æ›´å¤šå®‰å…¨çš„æ“ä½œç³»ç»Ÿäº†ã€‚ä¹‹åçš„æ‰€æœ‰ä¿¡ä»»é“¾éƒ½æ˜¯å®‰å…¨çš„äº†ã€‚","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"å®‰å…¨","slug":"å®‰å…¨","permalink":"http://yoursite.com/tags/å®‰å…¨/"},{"name":"HTTP","slug":"HTTP","permalink":"http://yoursite.com/tags/HTTP/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"}]},{"title":"CSRFæ”»å‡»","slug":"CSRFæ”»å‡»","date":"2019-06-18T12:05:23.000Z","updated":"2019-11-10T14:37:39.013Z","comments":true,"path":"2019/06/18/CSRFæ”»å‡»/","link":"","permalink":"http://yoursite.com/2019/06/18/CSRFæ”»å‡»/","excerpt":"CSRF æ”»å‡»1.ä»€ä¹ˆæ˜¯ CSRFCSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼šæ”»å‡»è€…è¯±å¯¼å—å®³è€…è¿›å…¥ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œåœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ä¸­ï¼Œå‘è¢«æ”»å‡»ç½‘ç«™å‘é€è·¨ç«™è¯·æ±‚ã€‚åˆ©ç”¨å—å®³è€…åœ¨è¢«æ”»å‡»ç½‘ç«™å·²ç»è·å–çš„æ³¨å†Œå‡­è¯ï¼Œç»•è¿‡åå°çš„ç”¨æˆ·éªŒè¯ï¼Œè¾¾åˆ°å†’å……ç”¨æˆ·å¯¹è¢«æ”»å‡»çš„ç½‘ç«™æ‰§è¡ŒæŸé¡¹æ“ä½œçš„ç›®çš„ã€‚ ä¸€ä¸ªå…¸å‹çš„ CSRF æ”»å‡»æœ‰ç€å¦‚ä¸‹çš„æµç¨‹ï¼š","text":"CSRF æ”»å‡»1.ä»€ä¹ˆæ˜¯ CSRFCSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼šæ”»å‡»è€…è¯±å¯¼å—å®³è€…è¿›å…¥ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œåœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ä¸­ï¼Œå‘è¢«æ”»å‡»ç½‘ç«™å‘é€è·¨ç«™è¯·æ±‚ã€‚åˆ©ç”¨å—å®³è€…åœ¨è¢«æ”»å‡»ç½‘ç«™å·²ç»è·å–çš„æ³¨å†Œå‡­è¯ï¼Œç»•è¿‡åå°çš„ç”¨æˆ·éªŒè¯ï¼Œè¾¾åˆ°å†’å……ç”¨æˆ·å¯¹è¢«æ”»å‡»çš„ç½‘ç«™æ‰§è¡ŒæŸé¡¹æ“ä½œçš„ç›®çš„ã€‚ ä¸€ä¸ªå…¸å‹çš„ CSRF æ”»å‡»æœ‰ç€å¦‚ä¸‹çš„æµç¨‹ï¼š å—å®³è€…ç™»å½• a.comï¼Œå¹¶ä¿ç•™äº†ç™»å½•å‡­è¯ï¼ˆCookieï¼‰ã€‚ æ”»å‡»è€…å¼•è¯±å—å®³è€…è®¿é—®äº† b.comã€‚ b.com å‘ a.com å‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼ša.com/act=xxã€‚æµè§ˆå™¨ä¼šé»˜è®¤æºå¸¦ a.com çš„ Cookieã€‚ a.com æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå¯¹è¯·æ±‚è¿›è¡ŒéªŒè¯ï¼Œå¹¶ç¡®è®¤æ˜¯å—å®³è€…çš„å‡­è¯ï¼Œè¯¯ä»¥ä¸ºæ˜¯å—å®³è€…è‡ªå·±å‘é€çš„è¯·æ±‚ã€‚ a.com ä»¥å—å®³è€…çš„åä¹‰æ‰§è¡Œäº† act=xxã€‚ æ”»å‡»å®Œæˆï¼Œæ”»å‡»è€…åœ¨å—å®³è€…ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå†’å……å—å®³è€…ï¼Œè®© a.com æ‰§è¡Œäº†è‡ªå·±å®šä¹‰çš„æ“ä½œã€‚ 2.å¸¸è§çš„æ”»å‡»ç±»å‹ GET ç±»å‹çš„ CSRF GET ç±»å‹çš„ CSRF åˆ©ç”¨éå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œä¸€èˆ¬ä¼šè¿™æ ·åˆ©ç”¨ï¼š 1&lt;img src=\"http://bank.example/withdraw?amount=10000&amp;for=hacker\" /&gt; åœ¨å—å®³è€…è®¿é—®å«æœ‰è¿™ä¸ª img çš„é¡µé¢åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å‘http://bank.example/withdraw?account=xiaoming&amp;amount=10000&amp;for=hackerå‘å‡ºä¸€æ¬¡ HTTP è¯·æ±‚ã€‚bank.example å°±ä¼šæ”¶åˆ°åŒ…å«å—å®³è€…ç™»å½•ä¿¡æ¯çš„ä¸€æ¬¡è·¨åŸŸè¯·æ±‚ã€‚ POST ç±»å‹çš„ CSRF è¿™ç§ç±»å‹çš„ CSRF åˆ©ç”¨èµ·æ¥é€šå¸¸ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„è¡¨å•ï¼Œå¦‚ï¼š 12345678&lt;form action=\"http://bank.example/withdraw\" method=\"POST\"&gt; &lt;input type=\"hidden\" name=\"account\" value=\"xiaoming\" /&gt; &lt;input type=\"hidden\" name=\"amount\" value=\"10000\" /&gt; &lt;input type=\"hidden\" name=\"for\" value=\"hacker\" /&gt;&lt;/form&gt;&lt;script&gt; document.forms[0].submit();&lt;/script&gt; è®¿é—®è¯¥é¡µé¢åï¼Œè¡¨å•ä¼šè‡ªåŠ¨æäº¤ï¼Œç›¸å½“äºæ¨¡æ‹Ÿç”¨æˆ·å®Œæˆäº†ä¸€æ¬¡ POST æ“ä½œã€‚ POST ç±»å‹çš„æ”»å‡»é€šå¸¸æ¯” GET è¦æ±‚æ›´åŠ ä¸¥æ ¼ä¸€ç‚¹ï¼Œä½†ä»å¹¶ä¸å¤æ‚ã€‚ä»»ä½•ä¸ªäººç½‘ç«™ã€åšå®¢ï¼Œè¢«é»‘å®¢ä¸Šä¼ é¡µé¢çš„ç½‘ç«™éƒ½æœ‰å¯èƒ½æ˜¯å‘èµ·æ”»å‡»çš„æ¥æºï¼Œåç«¯æ¥å£ä¸èƒ½å°†å®‰å…¨å¯„æ‰˜åœ¨ä»…å…è®¸ POST ä¸Šé¢ã€‚ é“¾æ¥ç±»å‹çš„ CSRF é“¾æ¥ç±»å‹çš„ CSRF å¹¶ä¸å¸¸è§ï¼Œæ¯”èµ·å…¶ä»–ä¸¤ç§ç”¨æˆ·æ‰“å¼€é¡µé¢å°±ä¸­æ‹›çš„æƒ…å†µï¼Œè¿™ç§éœ€è¦ç”¨æˆ·ç‚¹å‡»é“¾æ¥æ‰ä¼šè§¦å‘ã€‚è¿™ç§ç±»å‹é€šå¸¸æ˜¯åœ¨è®ºå›ä¸­å‘å¸ƒçš„å›¾ç‰‡ä¸­åµŒå…¥æ¶æ„é“¾æ¥ï¼Œæˆ–è€…ä»¥å¹¿å‘Šçš„å½¢å¼è¯±å¯¼ç”¨æˆ·ä¸­æ‹›ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šä»¥æ¯”è¾ƒå¤¸å¼ çš„è¯è¯­è¯±éª—ç”¨æˆ·ç‚¹å‡»ï¼Œä¾‹å¦‚ï¼š 1234567&lt;a href=\"http://test.com/csrf/withdraw.php?amount=1000&amp;for=hacker\" taget=\"_blank\"&gt; é‡ç£…æ¶ˆæ¯ï¼ï¼ &lt;a/&gt;&lt;/a&gt; ç”±äºä¹‹å‰ç”¨æˆ·ç™»å½•äº†ä¿¡ä»»çš„ç½‘ç«™ Aï¼Œå¹¶ä¸”ä¿å­˜ç™»å½•çŠ¶æ€ï¼Œåªè¦ç”¨æˆ·ä¸»åŠ¨è®¿é—®ä¸Šé¢çš„è¿™ä¸ª PHP é¡µé¢ï¼Œåˆ™è¡¨ç¤ºæ”»å‡»æˆåŠŸã€‚ 3.CSRF çš„ç‰¹ç‚¹ æ”»å‡»ä¸€èˆ¬å‘èµ·åœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œè€Œä¸æ˜¯è¢«æ”»å‡»çš„ç½‘ç«™ã€‚è¢«æ”»å‡»çš„ç½‘ç«™æ— æ³•é˜²æ­¢æ”»å‡»å‘ç”Ÿã€‚ æ”»å‡»åˆ©ç”¨å—å®³è€…åœ¨è¢«æ”»å‡»ç½‘ç«™çš„ç™»å½•å‡­è¯ï¼Œå†’å……å—å®³è€…æäº¤æ“ä½œï¼›è€Œä¸æ˜¯ç›´æ¥çªƒå–æ•°æ®ã€‚ æ•´ä¸ªè¿‡ç¨‹æ”»å‡»è€…å¹¶ä¸èƒ½è·å–åˆ°å—å®³è€…çš„ç™»å½•å‡­è¯ï¼Œä»…ä»…æ˜¯â€œå†’ç”¨â€ã€‚ è·¨ç«™è¯·æ±‚å¯ä»¥ç”¨å„ç§æ–¹å¼ï¼šå›¾ç‰‡ URLã€è¶…é“¾æ¥ã€CORSã€Form æäº¤ç­‰ç­‰ã€‚éƒ¨åˆ†è¯·æ±‚æ–¹å¼å¯ä»¥ç›´æ¥åµŒå…¥åœ¨ç¬¬ä¸‰æ–¹è®ºå›ã€æ–‡ç« ä¸­ï¼Œéš¾ä»¥è¿›è¡Œè¿½è¸ªã€‚ CSRF é€šå¸¸æ˜¯è·¨åŸŸçš„ï¼Œå› ä¸ºå¤–åŸŸé€šå¸¸æ›´å®¹æ˜“è¢«æ”»å‡»è€…æŒæ§ã€‚ä½†æ˜¯å¦‚æœæœ¬åŸŸä¸‹æœ‰å®¹æ˜“è¢«åˆ©ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¯ä»¥å‘å›¾å’Œé“¾æ¥çš„è®ºå›å’Œè¯„è®ºåŒºï¼Œæ”»å‡»å¯ä»¥ç›´æ¥åœ¨æœ¬åŸŸä¸‹è¿›è¡Œï¼Œè€Œä¸”è¿™ç§æ”»å‡»æ›´åŠ å±é™©ã€‚ 4.é˜²æŠ¤ç­–ç•¥CSRF é€šå¸¸ä»ç¬¬ä¸‰æ–¹ç½‘ç«™å‘èµ·ï¼Œè¢«æ”»å‡»çš„ç½‘ç«™æ— æ³•é˜²æ­¢æ”»å‡»å‘ç”Ÿï¼Œåªèƒ½é€šè¿‡å¢å¼ºè‡ªå·±ç½‘ç«™é’ˆå¯¹ CSRF çš„é˜²æŠ¤èƒ½åŠ›æ¥æå‡å®‰å…¨æ€§ã€‚ ä¸Šæ–‡ä¸­è®²äº†CSRF çš„ä¸¤ä¸ªç‰¹ç‚¹ï¼š CSRFï¼ˆé€šå¸¸ï¼‰å‘ç”Ÿåœ¨ç¬¬ä¸‰æ–¹åŸŸåã€‚ CSRF æ”»å‡»è€…ä¸èƒ½è·å–åˆ° Cookie ç­‰ä¿¡æ¯ï¼Œåªæ˜¯ä½¿ç”¨ã€‚ é’ˆå¯¹è¿™ä¸¤ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸“é—¨åˆ¶å®šé˜²æŠ¤ç­–ç•¥ï¼Œå¦‚ä¸‹ï¼š é˜»æ­¢ä¸æ˜å¤–åŸŸçš„è®¿é—® åŒæºæ£€æµ‹ Samesite Cookie æäº¤æ—¶è¦æ±‚é™„åŠ æœ¬åŸŸæ‰èƒ½è·å–çš„ä¿¡æ¯ CSRF Token åŒé‡ Cookie éªŒè¯ åŒæºæ£€æµ‹æ—¢ç„¶ CSRF å¤§å¤šæ¥è‡ªç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç›´æ¥ç¦æ­¢å¤–åŸŸï¼ˆæˆ–è€…ä¸å—ä¿¡ä»»çš„åŸŸåï¼‰å¯¹æˆ‘ä»¬å‘èµ·è¯·æ±‚ã€‚ æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­è¯·æ±‚æ˜¯å¦æ¥è‡ªå¤–åŸŸå‘¢ï¼Ÿ åœ¨ HTTP åè®®ä¸­ï¼Œæ¯ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚éƒ½ä¼šæºå¸¦ä¸¤ä¸ª Headerï¼Œç”¨äºæ ‡è®°æ¥æºåŸŸåï¼š Origin Header Referer Header è¿™ä¸¤ä¸ª Header åœ¨æµè§ˆå™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œå¤§å¤šæ•°æƒ…å†µä¼šè‡ªåŠ¨å¸¦ä¸Šï¼Œå¹¶ä¸”ä¸èƒ½ç”±å‰ç«¯è‡ªå®šä¹‰å†…å®¹ã€‚æœåŠ¡å™¨å¯ä»¥é€šè¿‡è§£æè¿™ä¸¤ä¸ª Header ä¸­çš„åŸŸåï¼Œç¡®å®šè¯·æ±‚çš„æ¥æºåŸŸã€‚ 1. ä½¿ç”¨ Origin Header ç¡®å®šæ¥æºåŸŸååœ¨éƒ¨åˆ†ä¸ CSRF æœ‰å…³çš„è¯·æ±‚ä¸­ï¼Œè¯·æ±‚çš„ Header ä¸­ä¼šæºå¸¦ Origin å­—æ®µã€‚å­—æ®µå†…åŒ…å«è¯·æ±‚çš„åŸŸåï¼ˆä¸åŒ…å« path åŠ queryï¼‰ã€‚ å¦‚æœ Origin å­˜åœ¨ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨ Origin ä¸­çš„å­—æ®µç¡®è®¤æ¥æºåŸŸåå°±å¯ä»¥ã€‚ ä½†æ˜¯ Origin åœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹å¹¶ä¸å­˜åœ¨ï¼š IE11 åŒæºç­–ç•¥ï¼š IE 11 ä¸ä¼šåœ¨è·¨ç«™ CORS è¯·æ±‚ä¸Šæ·»åŠ  Origin æ ‡å¤´ï¼ŒReferer å¤´å°†ä»ç„¶æ˜¯å”¯ä¸€çš„æ ‡è¯†ã€‚æœ€æ ¹æœ¬åŸå› æ˜¯å› ä¸º IE 11 å¯¹åŒæºçš„å®šä¹‰å’Œå…¶ä»–æµè§ˆå™¨æœ‰ä¸åŒï¼Œæœ‰ä¸¤ä¸ªä¸»è¦çš„åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒMDN Same-origin_policy#IE_Exceptions 302 é‡å®šå‘ï¼š åœ¨ 302 é‡å®šå‘ä¹‹å Origin ä¸åŒ…å«åœ¨é‡å®šå‘çš„è¯·æ±‚ä¸­ï¼Œå› ä¸º Origin å¯èƒ½ä¼šè¢«è®¤ä¸ºæ˜¯å…¶ä»–æ¥æºçš„æ•æ„Ÿä¿¡æ¯ã€‚å¯¹äº 302 é‡å®šå‘çš„æƒ…å†µæ¥è¯´éƒ½æ˜¯å®šå‘åˆ°æ–°çš„æœåŠ¡å™¨ä¸Šçš„ URLï¼Œå› æ­¤æµè§ˆå™¨ä¸æƒ³å°† Origin æ³„æ¼åˆ°æ–°çš„æœåŠ¡å™¨ä¸Šã€‚ 2. ä½¿ç”¨ Referer Header ç¡®å®šæ¥æºåŸŸåæ ¹æ® HTTP åè®®ï¼Œåœ¨ HTTP å¤´ä¸­æœ‰ä¸€ä¸ªå­—æ®µå« Refererï¼Œè®°å½•äº†è¯¥ HTTP è¯·æ±‚çš„æ¥æºåœ°å€ã€‚å¯¹äº Ajax è¯·æ±‚ï¼Œå›¾ç‰‡å’Œ script ç­‰èµ„æºè¯·æ±‚ï¼ŒReferer ä¸ºå‘èµ·è¯·æ±‚çš„é¡µé¢åœ°å€ã€‚å¯¹äºé¡µé¢è·³è½¬ï¼ŒReferer ä¸ºæ‰“å¼€é¡µé¢å†å²è®°å½•çš„å‰ä¸€ä¸ªé¡µé¢åœ°å€ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨ Referer ä¸­é“¾æ¥çš„ Origin éƒ¨åˆ†å¯ä»¥å¾—çŸ¥è¯·æ±‚çš„æ¥æºåŸŸåã€‚ è¿™ç§æ–¹æ³•å¹¶éä¸‡æ— ä¸€å¤±ï¼ŒReferer çš„å€¼æ˜¯ç”±æµè§ˆå™¨æä¾›çš„ï¼Œè™½ç„¶ HTTP åè®®ä¸Šæœ‰æ˜ç¡®çš„è¦æ±‚ï¼Œä½†æ˜¯æ¯ä¸ªæµè§ˆå™¨å¯¹äº Referer çš„å…·ä½“å®ç°å¯èƒ½æœ‰å·®åˆ«ï¼Œå¹¶ä¸èƒ½ä¿è¯æµè§ˆå™¨è‡ªèº«æ²¡æœ‰å®‰å…¨æ¼æ´ã€‚ä½¿ç”¨éªŒè¯ Referer å€¼çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠå®‰å…¨æ€§éƒ½ä¾èµ–äºç¬¬ä¸‰æ–¹ï¼ˆå³æµè§ˆå™¨ï¼‰æ¥ä¿éšœï¼Œä»ç†è®ºä¸Šæ¥è®²ï¼Œè¿™æ ·å¹¶ä¸æ˜¯å¾ˆå®‰å…¨ã€‚åœ¨éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥éšè—ï¼Œç”šè‡³ä¿®æ”¹è‡ªå·±è¯·æ±‚çš„ Refererã€‚ 2014 å¹´ï¼ŒW3C çš„ Web åº”ç”¨å®‰å…¨å·¥ä½œç»„å‘å¸ƒäº† Referrer Policy è‰æ¡ˆï¼Œå¯¹æµè§ˆå™¨è¯¥å¦‚ä½•å‘é€ Referer åšäº†è¯¦ç»†çš„è§„å®šã€‚æˆªæ­¢ç°åœ¨æ–°ç‰ˆæµè§ˆå™¨å¤§éƒ¨åˆ†å·²ç»æ”¯æŒäº†è¿™ä»½è‰æ¡ˆï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥çµæ´»åœ°æ§åˆ¶è‡ªå·±ç½‘ç«™çš„ Referer ç­–ç•¥äº†ã€‚æ–°ç‰ˆçš„ Referrer Policy è§„å®šäº†äº”ç§ Referer ç­–ç•¥ï¼šNo Referrerã€No Referrer When Downgradeã€Origin Onlyã€Origin When Cross-originã€å’Œ Unsafe URLã€‚ä¹‹å‰å°±å­˜åœ¨çš„ä¸‰ç§ç­–ç•¥ï¼šneverã€default å’Œ alwaysï¼Œåœ¨æ–°æ ‡å‡†é‡Œæ¢äº†ä¸ªåç§°ã€‚ä»–ä»¬çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š æ ¹æ®ä¸Šé¢çš„è¡¨æ ¼å› æ­¤éœ€è¦æŠŠ Referrer Policy çš„ç­–ç•¥è®¾ç½®æˆ same-originï¼Œå¯¹äºåŒæºçš„é“¾æ¥å’Œå¼•ç”¨ï¼Œä¼šå‘é€ Refererï¼Œreferer å€¼ä¸º Host ä¸å¸¦ Pathï¼›è·¨åŸŸè®¿é—®åˆ™ä¸æºå¸¦ Refererã€‚ä¾‹å¦‚ï¼šaaa.comå¼•ç”¨bbb.comçš„èµ„æºï¼Œä¸ä¼šå‘é€ Refererã€‚ è®¾ç½® Referrer Policy çš„æ–¹æ³•æœ‰ä¸‰ç§ï¼š åœ¨ CSP è®¾ç½® é¡µé¢å¤´éƒ¨å¢åŠ  meta æ ‡ç­¾ a æ ‡ç­¾å¢åŠ  referrerpolicy å±æ€§ æ”»å‡»è€…å¯ä»¥åœ¨è‡ªå·±çš„è¯·æ±‚ä¸­éšè— Refererã€‚ å¦å¤–åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ Referer æ²¡æœ‰æˆ–è€…ä¸å¯ä¿¡ï¼š IE6ã€7 ä¸‹ä½¿ç”¨ window.location.href=url è¿›è¡Œç•Œé¢çš„è·³è½¬ï¼Œä¼šä¸¢å¤± Refererã€‚ IE6ã€7 ä¸‹ä½¿ç”¨ window.openï¼Œä¹Ÿä¼šç¼ºå¤± Refererã€‚ HTTPS é¡µé¢è·³è½¬åˆ° HTTP é¡µé¢ï¼Œæ‰€æœ‰æµè§ˆå™¨ Referer éƒ½ä¸¢å¤±ã€‚ ç‚¹å‡» Flash ä¸Šåˆ°è¾¾å¦å¤–ä¸€ä¸ªç½‘ç«™çš„æ—¶å€™ï¼ŒReferer çš„æƒ…å†µå°±æ¯”è¾ƒæ‚ä¹±ï¼Œä¸å¤ªå¯ä¿¡ã€‚ æ— æ³•ç¡®è®¤æ¥æºåŸŸåæƒ…å†µå½“ Origin å’Œ Referer å¤´æ–‡ä»¶ä¸å­˜åœ¨æ—¶è¯¥æ€ä¹ˆåŠï¼Ÿå¦‚æœ Origin å’Œ Referer éƒ½ä¸å­˜åœ¨ï¼Œå»ºè®®ç›´æ¥è¿›è¡Œé˜»æ­¢ï¼Œç‰¹åˆ«æ˜¯å¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨éšæœº CSRF Tokenï¼ˆå‚è€ƒä¸‹æ–¹ï¼‰ä½œä¸ºç¬¬äºŒæ¬¡æ£€æŸ¥ã€‚ å¦‚ä½•é˜»æ­¢å¤–åŸŸè¯·æ±‚é€šè¿‡ Header çš„éªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å‘èµ·è¯·æ±‚çš„æ¥æºåŸŸåï¼Œè¿™äº›æ¥æºåŸŸåå¯èƒ½æ˜¯ç½‘ç«™æœ¬åŸŸï¼Œæˆ–è€…å­åŸŸåï¼Œæˆ–è€…æœ‰æˆæƒçš„ç¬¬ä¸‰æ–¹åŸŸåï¼Œåˆæˆ–è€…æ¥è‡ªä¸å¯ä¿¡çš„æœªçŸ¥åŸŸåã€‚ CSRF å¤§å¤šæ•°æƒ…å†µä¸‹æ¥è‡ªç¬¬ä¸‰æ–¹åŸŸåï¼Œä½†å¹¶ä¸èƒ½æ’é™¤æœ¬åŸŸå‘èµ·ã€‚å¦‚æœæ”»å‡»è€…æœ‰æƒé™åœ¨æœ¬åŸŸå‘å¸ƒè¯„è®ºï¼ˆå«é“¾æ¥ã€å›¾ç‰‡ç­‰ï¼Œç»Ÿç§° UGCï¼‰ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥ç›´æ¥åœ¨æœ¬åŸŸå‘èµ·æ”»å‡»ï¼Œè¿™ç§æƒ…å†µä¸‹åŒæºç­–ç•¥æ— æ³•è¾¾åˆ°é˜²æŠ¤çš„ä½œç”¨ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼šåŒæºéªŒè¯æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„é˜²èŒƒæ–¹æ³•ï¼Œèƒ½å¤Ÿé˜²èŒƒç»å¤§å¤šæ•°çš„ CSRF æ”»å‡»ã€‚ä½†è¿™å¹¶ä¸æ˜¯ä¸‡æ— ä¸€å¤±çš„ï¼Œå¯¹äºå®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œæˆ–è€…æœ‰è¾ƒå¤šç”¨æˆ·è¾“å…¥å†…å®¹çš„ç½‘ç«™ï¼Œæˆ‘ä»¬å°±è¦å¯¹å…³é”®çš„æ¥å£åšé¢å¤–çš„é˜²æŠ¤æªæ–½ã€‚ CSRF Tokenæˆ‘ä»¬å¯ä»¥è¦æ±‚æ‰€æœ‰çš„ç”¨æˆ·è¯·æ±‚éƒ½æºå¸¦ä¸€ä¸ª CSRF æ”»å‡»è€…æ— æ³•è·å–åˆ°çš„ Tokenã€‚æœåŠ¡å™¨é€šè¿‡æ ¡éªŒè¯·æ±‚æ˜¯å¦æºå¸¦æ­£ç¡®çš„ Tokenï¼Œæ¥æŠŠæ­£å¸¸çš„è¯·æ±‚å’Œæ”»å‡»çš„è¯·æ±‚åŒºåˆ†å¼€ï¼Œä¹Ÿå¯ä»¥é˜²èŒƒ CSRF çš„æ”»å‡»ã€‚ CSRF Token çš„é˜²æŠ¤ç­–ç•¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š å°† CSRF Token è¾“å‡ºåˆ°é¡µé¢ä¸­ é¦–å…ˆï¼Œç”¨æˆ·æ‰“å¼€é¡µé¢çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨éœ€è¦ç»™è¿™ä¸ªç”¨æˆ·ç”Ÿæˆä¸€ä¸ª Tokenï¼Œè¯¥ Token é€šè¿‡åŠ å¯†ç®—æ³•å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä¸€èˆ¬ Token éƒ½åŒ…æ‹¬éšæœºå­—ç¬¦ä¸²å’Œæ—¶é—´æˆ³çš„ç»„åˆï¼Œæ˜¾ç„¶åœ¨æäº¤æ—¶ Token ä¸èƒ½å†æ”¾åœ¨ Cookie ä¸­äº†ï¼Œå¦åˆ™åˆä¼šè¢«æ”»å‡»è€…å†’ç”¨ã€‚å› æ­¤ï¼Œä¸ºäº†å®‰å…¨èµ·è§ Token æœ€å¥½è¿˜æ˜¯å­˜åœ¨æœåŠ¡å™¨çš„ Session ä¸­ï¼Œä¹‹ååœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶ï¼Œä½¿ç”¨ JS éå†æ•´ä¸ª DOM æ ‘ï¼Œå¯¹äº DOM ä¸­æ‰€æœ‰çš„ a å’Œ form æ ‡ç­¾ååŠ å…¥ Tokenã€‚è¿™æ ·å¯ä»¥è§£å†³å¤§éƒ¨åˆ†çš„è¯·æ±‚ï¼Œä½†æ˜¯å¯¹äºåœ¨é¡µé¢åŠ è½½ä¹‹ååŠ¨æ€ç”Ÿæˆçš„ HTML ä»£ç ï¼Œè¿™ç§æ–¹æ³•å°±æ²¡æœ‰ä½œç”¨ï¼Œè¿˜éœ€è¦ç¨‹åºå‘˜åœ¨ç¼–ç æ—¶æ‰‹åŠ¨æ·»åŠ  Tokenã€‚ é¡µé¢æäº¤çš„è¯·æ±‚æºå¸¦è¿™ä¸ª Token å¯¹äº GET è¯·æ±‚ï¼ŒToken å°†é™„åœ¨è¯·æ±‚åœ°å€ä¹‹åï¼Œè¿™æ · URL å°±å˜æˆ http://url?csrftoken=tokenvalueã€‚ è€Œå¯¹äº POST è¯·æ±‚æ¥è¯´ï¼Œè¦åœ¨ form çš„æœ€ååŠ ä¸Šï¼š 1&lt;input type=\"â€hiddenâ€\" name=\"â€csrftokenâ€\" value=\"â€tokenvalueâ€\" /&gt; â€‹ è¿™æ ·ï¼Œå°±æŠŠ Token ä»¥å‚æ•°çš„å½¢å¼åŠ å…¥è¯·æ±‚äº†ã€‚ æœåŠ¡å™¨éªŒè¯ Token æ˜¯å¦æ­£ç¡® å½“ç”¨æˆ·ä»å®¢æˆ·ç«¯å¾—åˆ°äº† Tokenï¼Œå†æ¬¡æäº¤ç»™æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨éœ€è¦åˆ¤æ–­ Token çš„æœ‰æ•ˆæ€§ï¼ŒéªŒè¯è¿‡ç¨‹æ˜¯å…ˆè§£å¯† Tokenï¼Œå¯¹æ¯”åŠ å¯†å­—ç¬¦ä¸²ä»¥åŠæ—¶é—´æˆ³ï¼Œå¦‚æœåŠ å¯†å­—ç¬¦ä¸²ä¸€è‡´ä¸”æ—¶é—´æœªè¿‡æœŸï¼Œé‚£ä¹ˆè¿™ä¸ª Token å°±æ˜¯æœ‰æ•ˆçš„ã€‚ è¿™ç§æ–¹æ³•è¦æ¯”ä¹‹å‰æ£€æŸ¥ Referer æˆ–è€… Origin è¦å®‰å…¨ä¸€äº›ï¼ŒToken å¯ä»¥åœ¨äº§ç”Ÿå¹¶æ”¾äº Session ä¹‹ä¸­ï¼Œç„¶ååœ¨æ¯æ¬¡è¯·æ±‚æ—¶æŠŠ Token ä» Session ä¸­æ‹¿å‡ºï¼Œä¸è¯·æ±‚ä¸­çš„ Token è¿›è¡Œæ¯”å¯¹ï¼Œä½†è¿™ç§æ–¹æ³•çš„æ¯”è¾ƒéº»çƒ¦çš„åœ¨äºå¦‚ä½•æŠŠ Token ä»¥å‚æ•°çš„å½¢å¼åŠ å…¥è¯·æ±‚ã€‚ åˆ†å¸ƒå¼æ ¡éªŒ åœ¨å¤§å‹ç½‘ç«™ä¸­ï¼Œä½¿ç”¨ Session å­˜å‚¨ CSRF Token ä¼šå¸¦æ¥å¾ˆå¤§çš„å‹åŠ›ã€‚è®¿é—®å•å°æœåŠ¡å™¨ session æ˜¯åŒä¸€ä¸ªã€‚ä½†æ˜¯ç°åœ¨çš„å¤§å‹ç½‘ç«™ä¸­ï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨é€šå¸¸ä¸æ­¢ä¸€å°ï¼Œå¯èƒ½æ˜¯å‡ åå°ç”šè‡³å‡ ç™¾å°ä¹‹å¤šï¼Œç”šè‡³å¤šä¸ªæœºæˆ¿éƒ½å¯èƒ½åœ¨ä¸åŒçš„çœä»½ï¼Œç”¨æˆ·å‘èµ·çš„ HTTP è¯·æ±‚é€šå¸¸è¦ç»è¿‡åƒ Ngnix ä¹‹ç±»çš„è´Ÿè½½å‡è¡¡å™¨ä¹‹åï¼Œå†è·¯ç”±åˆ°å…·ä½“çš„æœåŠ¡å™¨ä¸Šï¼Œç”±äº Session é»˜è®¤å­˜å‚¨åœ¨å•æœºæœåŠ¡å™¨å†…å­˜ä¸­ï¼Œå› æ­¤åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹åŒä¸€ä¸ªç”¨æˆ·å‘é€çš„å¤šæ¬¡ HTTP è¯·æ±‚å¯èƒ½ä¼šå…ˆåè½åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå¯¼è‡´åé¢å‘èµ·çš„ HTTP è¯·æ±‚æ— æ³•æ‹¿åˆ°ä¹‹å‰çš„ HTTP è¯·æ±‚å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­çš„ Session æ•°æ®ï¼Œä»è€Œä½¿å¾— Session æœºåˆ¶åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¤±æ•ˆï¼Œå› æ­¤åœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­ CSRF Token éœ€è¦å­˜å‚¨åœ¨ Redis ä¹‹ç±»çš„å…¬å…±å­˜å‚¨ç©ºé—´ã€‚ ç”±äºä½¿ç”¨ Session å­˜å‚¨ï¼Œè¯»å–å’ŒéªŒè¯ CSRF Token ä¼šå¼•èµ·æ¯”è¾ƒå¤§çš„å¤æ‚åº¦å’Œæ€§èƒ½é—®é¢˜ï¼Œç›®å‰å¾ˆå¤šç½‘ç«™é‡‡ç”¨ Encrypted Token Pattern æ–¹å¼ã€‚è¿™ç§æ–¹æ³•çš„ Token æ˜¯ä¸€ä¸ªè®¡ç®—å‡ºæ¥çš„ç»“æœï¼Œè€Œééšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²ã€‚è¿™æ ·åœ¨æ ¡éªŒæ—¶æ— éœ€å†å»è¯»å–å­˜å‚¨çš„ Tokenï¼Œåªç”¨å†æ¬¡è®¡ç®—ä¸€æ¬¡å³å¯ã€‚ è¿™ç§ Token çš„å€¼é€šå¸¸æ˜¯ä½¿ç”¨ UserIDã€æ—¶é—´æˆ³å’Œéšæœºæ•°ï¼Œé€šè¿‡åŠ å¯†çš„æ–¹æ³•ç”Ÿæˆã€‚è¿™æ ·æ—¢å¯ä»¥ä¿è¯åˆ†å¸ƒå¼æœåŠ¡çš„ Token ä¸€è‡´ï¼Œåˆèƒ½ä¿è¯ Token ä¸å®¹æ˜“è¢«ç ´è§£ã€‚ åœ¨ token è§£å¯†æˆåŠŸä¹‹åï¼ŒæœåŠ¡å™¨å¯ä»¥è®¿é—®è§£æå€¼ï¼ŒToken ä¸­åŒ…å«çš„ UserID å’Œæ—¶é—´æˆ³å°†ä¼šè¢«æ‹¿æ¥è¢«éªŒè¯æœ‰æ•ˆæ€§ï¼Œå°† UserID ä¸å½“å‰ç™»å½•çš„ UserID è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å°†æ—¶é—´æˆ³ä¸å½“å‰æ—¶é—´è¿›è¡Œæ¯”è¾ƒã€‚ åŒé‡ Cookie éªŒè¯ä½¿ç”¨åŒé‡æäº¤ Cookieã€‚åˆ©ç”¨ CSRF æ”»å‡»ä¸èƒ½è·å–åˆ°ç”¨æˆ· Cookie çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚ Ajax å’Œè¡¨å•è¯·æ±‚æºå¸¦ä¸€ä¸ª Cookie ä¸­çš„å€¼ã€‚ åŒé‡ Cookie é‡‡ç”¨ä»¥ä¸‹æµç¨‹ï¼š åœ¨ç”¨æˆ·è®¿é—®ç½‘ç«™é¡µé¢æ—¶ï¼Œå‘è¯·æ±‚åŸŸåæ³¨å…¥ä¸€ä¸ª Cookieï¼Œå†…å®¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚csrfcookie=v8g9e4ksfhwï¼‰ã€‚ åœ¨å‰ç«¯å‘åç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œå–å‡º Cookieï¼Œå¹¶æ·»åŠ åˆ° URL çš„å‚æ•°ä¸­ï¼ˆæ¥ä¸Šä¾‹POST https://www.a.com/comment?csrfcookie=v8g9e4ksfhwï¼‰ã€‚ åç«¯æ¥å£éªŒè¯ Cookie ä¸­çš„å­—æ®µä¸ URL å‚æ•°ä¸­çš„å­—æ®µæ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´åˆ™æ‹’ç»ã€‚ æ­¤æ–¹æ³•ç›¸å¯¹äº CSRF Token å°±ç®€å•äº†è®¸å¤šã€‚å¯ä»¥ç›´æ¥é€šè¿‡å‰åç«¯æ‹¦æˆªçš„çš„æ–¹æ³•è‡ªåŠ¨åŒ–å®ç°ã€‚åç«¯æ ¡éªŒä¹Ÿæ›´åŠ æ–¹ä¾¿ï¼Œåªéœ€è¿›è¡Œè¯·æ±‚ä¸­å­—æ®µçš„å¯¹æ¯”ï¼Œè€Œä¸éœ€è¦å†è¿›è¡ŒæŸ¥è¯¢å’Œå­˜å‚¨ Tokenã€‚ ç”±äºä»»ä½•è·¨åŸŸéƒ½ä¼šå¯¼è‡´å‰ç«¯æ— æ³•è·å– Cookie ä¸­çš„å­—æ®µï¼ˆåŒ…æ‹¬å­åŸŸåä¹‹é—´ï¼‰ï¼Œäºæ˜¯å‘ç”Ÿäº†å¦‚ä¸‹æƒ…å†µï¼š å¦‚æœç”¨æˆ·è®¿é—®çš„ç½‘ç«™ä¸ºwww.a.comï¼Œè€Œåç«¯çš„ api åŸŸåä¸ºapi.a.comã€‚é‚£ä¹ˆåœ¨www.a.comä¸‹ï¼Œå‰ç«¯æ‹¿ä¸åˆ°api.a.comçš„ Cookieï¼Œä¹Ÿå°±æ— æ³•å®ŒæˆåŒé‡ Cookie è®¤è¯ã€‚ äºæ˜¯è¿™ä¸ªè®¤è¯ Cookie å¿…é¡»è¢«ç§åœ¨a.comä¸‹ï¼Œè¿™æ ·æ¯ä¸ªå­åŸŸéƒ½å¯ä»¥è®¿é—®ã€‚ ä»»ä½•ä¸€ä¸ªå­åŸŸéƒ½å¯ä»¥ä¿®æ”¹a.comä¸‹çš„ Cookieã€‚ æŸä¸ªå­åŸŸåå­˜åœ¨æ¼æ´è¢« XSS æ”»å‡»ï¼ˆä¾‹å¦‚upload.a.comï¼‰ã€‚è™½ç„¶è¿™ä¸ªå­åŸŸä¸‹å¹¶æ²¡æœ‰ä»€ä¹ˆå€¼å¾—çªƒå–çš„ä¿¡æ¯ã€‚ä½†æ”»å‡»è€…ä¿®æ”¹äº†a.comä¸‹çš„ Cookieã€‚ æ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªå·±é…ç½®çš„ Cookieï¼Œå¯¹ XSS ä¸­æ‹›çš„ç”¨æˆ·å†å‘www.a.comä¸‹ï¼Œå‘èµ· CSRF æ”»å‡»ã€‚ æ€»ç»“ ç”¨åŒé‡ Cookie é˜²å¾¡ CSRF çš„ä¼˜ç‚¹ï¼š æ— éœ€ä½¿ç”¨ Sessionï¼Œé€‚ç”¨é¢æ›´å¹¿ï¼Œæ˜“äºå®æ–½ã€‚ Token å‚¨å­˜äºå®¢æˆ·ç«¯ä¸­ï¼Œä¸ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ã€‚ ç›¸å¯¹äº Tokenï¼Œå®æ–½æˆæœ¬æ›´ä½ï¼Œå¯ä»¥åœ¨å‰åç«¯ç»Ÿä¸€æ‹¦æˆªæ ¡éªŒï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªä¸ªæ¥å£å’Œé¡µé¢æ·»åŠ ã€‚ ç¼ºç‚¹ï¼š Cookie ä¸­å¢åŠ äº†é¢å¤–çš„å­—æ®µã€‚ å¦‚æœæœ‰å…¶ä»–æ¼æ´ï¼ˆä¾‹å¦‚ XSSï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥ Cookieï¼Œé‚£ä¹ˆè¯¥é˜²å¾¡æ–¹å¼å¤±æ•ˆã€‚ éš¾ä»¥åšåˆ°å­åŸŸåçš„éš”ç¦»ã€‚ ä¸ºäº†ç¡®ä¿ Cookie ä¼ è¾“å®‰å…¨ï¼Œé‡‡ç”¨è¿™ç§é˜²å¾¡æ–¹å¼æœ€å¥½ç¡®ä¿ç”¨æ•´ç«™ HTTPS çš„æ–¹å¼ï¼Œå¦‚æœè¿˜æ²¡åˆ‡ HTTPS çš„ä½¿ç”¨è¿™ç§æ–¹å¼ä¹Ÿä¼šæœ‰é£é™©ã€‚ Samesite Cookie å±æ€§Set-Cookie å“åº”å¤´æ–°å¢ Samesite å±æ€§ï¼Œå®ƒç”¨æ¥æ ‡æ˜è¿™ä¸ª Cookie æ˜¯ä¸ªâ€œåŒç«™ Cookieâ€ï¼ŒåŒç«™ Cookie åªèƒ½ä½œä¸ºç¬¬ä¸€æ–¹ Cookieï¼Œä¸èƒ½ä½œä¸ºç¬¬ä¸‰æ–¹ Cookieï¼ŒSamesite æœ‰ä¸¤ä¸ªå±æ€§å€¼ï¼Œåˆ†åˆ«æ˜¯ Strict å’Œ Lax Samesite=Strictè¿™ç§ç§°ä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œè¡¨æ˜è¿™ä¸ª Cookie åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å¯èƒ½ä½œä¸ºç¬¬ä¸‰æ–¹ Cookieï¼Œç»æ— ä¾‹å¤–ã€‚æ¯”å¦‚è¯´ b.com è®¾ç½®äº†å¦‚ä¸‹ Cookieï¼š 123Set-Cookie: foo=1; Samesite=StrictSet-Cookie: bar=2; Samesite=LaxSet-Cookie: baz=3 æˆ‘ä»¬åœ¨ a.com ä¸‹å‘èµ·å¯¹ b.com çš„ä»»æ„è¯·æ±‚ï¼Œfoo è¿™ä¸ª Cookie éƒ½ä¸ä¼šè¢«åŒ…å«åœ¨ Cookie è¯·æ±‚å¤´ä¸­ï¼Œä½† bar ä¼šã€‚ä¸¾ä¸ªå®é™…çš„ä¾‹å­å°±æ˜¯ï¼Œå‡å¦‚æ·˜å®ç½‘ç«™ç”¨æ¥è¯†åˆ«ç”¨æˆ·ç™»å½•ä¸å¦çš„ Cookie è¢«è®¾ç½®æˆäº† Samesite=Strictï¼Œé‚£ä¹ˆç”¨æˆ·ä»ç™¾åº¦æœç´¢é¡µé¢ç”šè‡³å¤©çŒ«é¡µé¢çš„é“¾æ¥ç‚¹å‡»è¿›å…¥æ·˜å®åï¼Œæ·˜å®éƒ½ä¸ä¼šæ˜¯ç™»å½•çŠ¶æ€ï¼Œå› ä¸ºæ·˜å®çš„æœåŠ¡å™¨ä¸ä¼šæ¥å—åˆ°é‚£ä¸ª Cookieï¼Œå…¶å®ƒç½‘ç«™å‘èµ·çš„å¯¹æ·˜å®çš„ä»»æ„è¯·æ±‚éƒ½ä¸ä¼šå¸¦ä¸Šé‚£ä¸ª Cookieã€‚ Samesite=Laxè¿™ç§ç§°ä¸ºå®½æ¾æ¨¡å¼ï¼Œæ¯” Strict æ”¾å®½äº†ç‚¹é™åˆ¶ï¼šå‡å¦‚è¿™ä¸ªè¯·æ±‚æ˜¯è¿™ç§è¯·æ±‚ï¼ˆæ”¹å˜äº†å½“å‰é¡µé¢æˆ–è€…æ‰“å¼€äº†æ–°é¡µé¢ï¼‰ä¸”åŒæ—¶æ˜¯ä¸ª GET è¯·æ±‚ï¼Œåˆ™è¿™ä¸ª Cookie å¯ä»¥ä½œä¸ºç¬¬ä¸‰æ–¹ Cookieã€‚ å½“ç”¨æˆ·ä» a.com ç‚¹å‡»é“¾æ¥è¿›å…¥ b.com æ—¶ï¼Œfoo è¿™ä¸ª Cookie ä¸ä¼šè¢«åŒ…å«åœ¨ Cookie è¯·æ±‚å¤´ä¸­ï¼Œä½† bar å’Œ baz ä¼šï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·åœ¨ä¸åŒç½‘ç«™ä¹‹é—´é€šè¿‡é“¾æ¥è·³è½¬æ˜¯ä¸å—å½±å“äº†ã€‚ä½†å‡å¦‚è¿™ä¸ªè¯·æ±‚æ˜¯ä» a.com å‘èµ·çš„å¯¹ b.com çš„å¼‚æ­¥è¯·æ±‚ï¼Œæˆ–è€…é¡µé¢è·³è½¬æ˜¯é€šè¿‡è¡¨å•çš„ post æäº¤è§¦å‘çš„ï¼Œåˆ™ bar ä¹Ÿä¸ä¼šå‘é€ã€‚ ç”Ÿæˆ Token æ”¾åˆ° Cookie ä¸­å¹¶ä¸”è®¾ç½® Cookie çš„ Samesite æˆ‘ä»¬åº”è¯¥å¦‚ä½•ä½¿ç”¨ SamesiteCookieå¦‚æœ SamesiteCookie è¢«è®¾ç½®ä¸º Strictï¼Œæµè§ˆå™¨åœ¨ä»»ä½•è·¨åŸŸè¯·æ±‚ä¸­éƒ½ä¸ä¼šæºå¸¦ Cookieï¼Œæ–°æ ‡ç­¾é‡æ–°æ‰“å¼€ä¹Ÿä¸æºå¸¦ï¼Œæ‰€ä»¥è¯´ CSRF æ”»å‡»åŸºæœ¬æ²¡æœ‰æœºä¼šã€‚ ä½†æ˜¯è·³è½¬å­åŸŸåæˆ–è€…æ˜¯æ–°æ ‡ç­¾é‡æ–°æ‰“å¼€åˆšç™»é™†çš„ç½‘ç«™ï¼Œä¹‹å‰çš„ Cookie éƒ½ä¸ä¼šå­˜åœ¨ã€‚å°¤å…¶æ˜¯æœ‰ç™»å½•çš„ç½‘ç«™ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ–°æ‰“å¼€ä¸€ä¸ªæ ‡ç­¾è¿›å…¥ï¼Œæˆ–è€…è·³è½¬åˆ°å­åŸŸåçš„ç½‘ç«™ï¼Œéƒ½éœ€è¦é‡æ–°ç™»å½•ã€‚å¯¹äºç”¨æˆ·æ¥è®²ï¼Œå¯èƒ½ä½“éªŒä¸ä¼šå¾ˆå¥½ã€‚ å¦‚æœ SamesiteCookie è¢«è®¾ç½®ä¸º Laxï¼Œé‚£ä¹ˆå…¶ä»–ç½‘ç«™é€šè¿‡é¡µé¢è·³è½¬è¿‡æ¥çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ Cookieï¼Œå¯ä»¥ä¿éšœå¤–åŸŸè¿æ¥æ‰“å¼€é¡µé¢æ—¶ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚ä½†ç›¸åº”çš„ï¼Œå…¶å®‰å…¨æ€§ä¹Ÿæ¯”è¾ƒä½ã€‚ å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ Samesite çš„å…¼å®¹æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œç°é˜¶æ®µé™¤äº†ä»æ–°ç‰ˆ Chrome å’Œ Firefox æ”¯æŒä»¥å¤–ï¼ŒSafari ä»¥åŠ iOS Safari éƒ½è¿˜ä¸æ”¯æŒï¼Œç°é˜¶æ®µçœ‹æ¥æš‚æ—¶è¿˜ä¸èƒ½æ™®åŠã€‚ è€Œä¸”ï¼ŒSamesiteCookie ç›®å‰æœ‰ä¸€ä¸ªè‡´å‘½çš„ç¼ºé™·ï¼šä¸æ”¯æŒå­åŸŸã€‚ä¾‹å¦‚ï¼Œç§åœ¨ topic.a.com ä¸‹çš„ Cookieï¼Œå¹¶ä¸èƒ½ä½¿ç”¨ a.com ä¸‹ç§æ¤çš„ SamesiteCookieã€‚è¿™å°±å¯¼è‡´äº†å½“æˆ‘ä»¬ç½‘ç«™æœ‰å¤šä¸ªå­åŸŸåæ—¶ï¼Œä¸èƒ½ä½¿ç”¨ SamesiteCookie åœ¨ä¸»åŸŸåå­˜å‚¨ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€‚æ¯ä¸ªå­åŸŸåéƒ½éœ€è¦ç”¨æˆ·é‡æ–°ç™»å½•ä¸€æ¬¡ã€‚ æ€»ä¹‹ï¼ŒSamesiteCookie æ˜¯ä¸€ä¸ªå¯èƒ½æ›¿ä»£åŒæºéªŒè¯çš„æ–¹æ¡ˆï¼Œä½†ç›®å‰è¿˜å¹¶ä¸æˆç†Ÿï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰å¾…è§‚æœ›ã€‚ 5.é˜²æ­¢ç½‘ç«™è¢«åˆ©ç”¨ï¼ˆé˜²æ­¢æ”»å‡»çš„å‘ç”Ÿï¼‰CSRF çš„æ”»å‡»å¯ä»¥æ¥è‡ªï¼š æ”»å‡»è€…è‡ªå·±çš„ç½‘ç«™ã€‚ æœ‰æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„ç½‘ç«™ã€‚ ç¬¬ä¸‰æ–¹è®ºå›ç­‰ç”¨æˆ·å†…å®¹ã€‚ è¢«æ”»å‡»ç½‘ç«™è‡ªå·±çš„è¯„è®ºåŠŸèƒ½ç­‰ã€‚ å¦‚ä½•é˜²æ­¢è‡ªå·±çš„ç½‘ç«™è¢«åˆ©ç”¨æˆä¸ºæ”»å‡»çš„æºå¤´å‘¢ï¼Ÿ ä¸¥æ ¼ç®¡ç†æ‰€æœ‰çš„ä¸Šä¼ æ¥å£ï¼Œé˜²æ­¢ä»»ä½•é¢„æœŸä¹‹å¤–çš„ä¸Šä¼ å†…å®¹ï¼ˆä¾‹å¦‚ HTMLï¼‰ã€‚ æ·»åŠ  Header X-Content-Type-Options: nosniff é˜²æ­¢é»‘å®¢ä¸Šä¼  HTML å†…å®¹çš„èµ„æºï¼ˆä¾‹å¦‚å›¾ç‰‡ï¼‰è¢«è§£æä¸ºç½‘é¡µã€‚ å¯¹äºç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ï¼Œè¿›è¡Œè½¬å­˜æˆ–è€…æ ¡éªŒã€‚ä¸è¦ç›´æ¥ä½¿ç”¨ç”¨æˆ·å¡«å†™çš„å›¾ç‰‡é“¾æ¥ã€‚ å½“å‰ç”¨æˆ·æ‰“å¼€å…¶ä»–ç”¨æˆ·å¡«å†™çš„é“¾æ¥æ—¶ï¼Œéœ€å‘ŠçŸ¥é£é™©ï¼ˆè¿™ä¹Ÿæ˜¯å¾ˆå¤šè®ºå›ä¸å…è®¸ç›´æ¥åœ¨å†…å®¹ä¸­å‘å¸ƒå¤–åŸŸé“¾æ¥çš„åŸå› ä¹‹ä¸€ï¼Œä¸ä»…ä»…æ˜¯ä¸ºäº†ç”¨æˆ·ç•™å­˜ï¼Œä¹Ÿæœ‰å®‰å…¨è€ƒè™‘ï¼‰ã€‚ 6.CSRF å…¶ä»–é˜²èŒƒæªæ–½CSRF æµ‹è¯•CSRFTester æ˜¯ä¸€æ¬¾ CSRF æ¼æ´çš„æµ‹è¯•å·¥å…·ï¼ŒCSRFTester å·¥å…·çš„æµ‹è¯•åŸç†å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼Œä½¿ç”¨ä»£ç†æŠ“å–æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è®¿é—®è¿‡çš„æ‰€æœ‰çš„è¿æ¥ä»¥åŠæ‰€æœ‰çš„è¡¨å•ç­‰ä¿¡æ¯ï¼Œé€šè¿‡åœ¨ CSRFTester ä¸­ä¿®æ”¹ç›¸åº”çš„è¡¨å•ç­‰ä¿¡æ¯ï¼Œé‡æ–°æäº¤ï¼Œç›¸å½“äºä¸€æ¬¡ä¼ªé€ å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¦‚æœä¿®æ”¹åçš„æµ‹è¯•è¯·æ±‚æˆåŠŸè¢«ç½‘ç«™æœåŠ¡å™¨æ¥å—ï¼Œåˆ™è¯´æ˜å­˜åœ¨ CSRF æ¼æ´ï¼Œå½“ç„¶æ­¤æ¬¾å·¥å…·ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è¿›è¡Œ CSRF æ”»å‡»ã€‚CSRFTester ä½¿ç”¨æ–¹æ³•å¤§è‡´åˆ†ä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š æ­¥éª¤ 1ï¼šè®¾ç½®æµè§ˆå™¨ä»£ç† CSRFTester é»˜è®¤ä½¿ç”¨ Localhost ä¸Šçš„ç«¯å£ 8008 ä½œä¸ºå…¶ä»£ç†ï¼Œå¦‚æœä»£ç†é…ç½®æˆåŠŸï¼ŒCSRFTester å°†ä¸ºæ‚¨çš„æµè§ˆå™¨ç”Ÿæˆçš„æ‰€æœ‰åç»­ HTTP è¯·æ±‚ç”Ÿæˆè°ƒè¯•æ¶ˆæ¯ã€‚ æ­¥éª¤ 2ï¼šä½¿ç”¨åˆæ³•è´¦æˆ·è®¿é—®ç½‘ç«™å¼€å§‹æµ‹è¯• æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦ä¸º CSRF æµ‹è¯•çš„ç‰¹å®šä¸šåŠ¡ Web é¡µé¢ã€‚æ‰¾åˆ°æ­¤é¡µé¢åï¼Œé€‰æ‹© CSRFTester ä¸­çš„â€œå¼€å§‹å½•åˆ¶â€æŒ‰é’®å¹¶æ‰§è¡Œä¸šåŠ¡åŠŸèƒ½ï¼›å®Œæˆåï¼Œç‚¹å‡» CSRFTester ä¸­çš„â€œåœæ­¢å½•åˆ¶â€æŒ‰é’®ï¼›æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¯¥è½¯ä»¶ä¼šå…¨éƒ¨éå†ä¸€éå½“å‰é¡µé¢çš„æ‰€æœ‰è¯·æ±‚ã€‚ æ­¥éª¤ 3ï¼šé€šè¿‡ CSRF ä¿®æ”¹å¹¶ä¼ªé€ è¯·æ±‚ ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°è½¯ä»¶ä¸Šæœ‰ä¸€ç³»åˆ—è·‘å‡ºæ¥çš„è®°å½•è¯·æ±‚ï¼Œè¿™äº›éƒ½æ˜¯æˆ‘ä»¬çš„æµè§ˆå™¨åœ¨æ‰§è¡Œä¸šåŠ¡åŠŸèƒ½æ—¶ç”Ÿæˆçš„æ‰€æœ‰ GET æˆ–è€… POST è¯·æ±‚ã€‚é€šè¿‡é€‰æ‹©åˆ—è¡¨ä¸­çš„æŸä¸€è¡Œï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä¿®æ”¹ç”¨äºæ‰§è¡Œä¸šåŠ¡åŠŸèƒ½çš„å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡»å¯¹åº”çš„è¯·æ±‚ä¿®æ”¹ query å’Œ form çš„å‚æ•°ã€‚å½“ä¿®æ”¹å®Œæ‰€æœ‰æˆ‘ä»¬å¸Œæœ›è¯±å¯¼ç”¨æˆ· form æœ€ç»ˆçš„æäº¤å€¼ï¼Œå¯ä»¥é€‰æ‹©å¼€å§‹ç”Ÿæˆ HTML æŠ¥å‘Šã€‚ æ­¥éª¤ 4ï¼šæ‹¿åˆ°ç»“æœå¦‚æœ‰æ¼æ´è¿›è¡Œä¿®å¤ é¦–å…ˆå¿…é¡»é€‰æ‹©â€œæŠ¥å‘Šç±»å‹â€ã€‚æŠ¥å‘Šç±»å‹å†³å®šäº†æˆ‘ä»¬å¸Œæœ›å—å®³è€…æµè§ˆå™¨å¦‚ä½•æäº¤å…ˆå‰è®°å½•çš„è¯·æ±‚ã€‚ç›®å‰æœ‰ 5 ç§å¯èƒ½çš„æŠ¥å‘Šï¼šè¡¨å•ã€iFrameã€IMGã€XHR å’Œé“¾æ¥ã€‚ä¸€æ—¦é€‰æ‹©äº†æŠ¥å‘Šç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨æµè§ˆå™¨ä¸­å¯åŠ¨æ–°ç”Ÿæˆçš„æŠ¥å‘Šï¼Œæœ€åæ ¹æ®æŠ¥å‘Šçš„æƒ…å†µè¿›è¡Œå¯¹åº”çš„æ’æŸ¥å’Œä¿®å¤ã€‚ CSRF ç›‘æ§å¯¹äºä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ç½‘ç«™ç³»ç»Ÿï¼ŒæŸäº›é¡¹ç›®ã€é¡µé¢ã€æ¥å£æ¼æ‰äº† CSRF é˜²æŠ¤æªæ–½æ˜¯å¾ˆå¯èƒ½çš„ã€‚ ä¸€æ—¦å‘ç”Ÿäº† CSRF æ”»å‡»ï¼Œæˆ‘ä»¬å¦‚ä½•åŠæ—¶çš„å‘ç°è¿™äº›æ”»å‡»å‘¢ï¼Ÿ CSRF æ”»å‡»æœ‰ç€æ¯”è¾ƒæ˜æ˜¾çš„ç‰¹å¾ï¼š è·¨åŸŸè¯·æ±‚ã€‚ GET ç±»å‹è¯·æ±‚ Header çš„ MIME ç±»å‹å¤§æ¦‚ç‡ä¸ºå›¾ç‰‡ï¼Œè€Œå®é™…è¿”å› Header çš„ MIME ç±»å‹ä¸º Textã€JSONã€HTMLã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ç½‘ç«™çš„ä»£ç†å±‚ç›‘æ§æ‰€æœ‰çš„æ¥å£è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚ç¬¦åˆä¸Šé¢çš„ç‰¹å¾ï¼Œå°±å¯ä»¥è®¤ä¸ºè¯·æ±‚æœ‰ CSRF æ”»å‡»å«Œç–‘ã€‚æˆ‘ä»¬å¯ä»¥æé†’å¯¹åº”çš„é¡µé¢å’Œé¡¹ç›®è´Ÿè´£äººï¼Œæ£€æŸ¥æˆ–è€… Review å…¶ CSRF é˜²æŠ¤ç­–ç•¥ã€‚ ä¸ªäººç”¨æˆ· CSRF å®‰å…¨çš„å»ºè®®ç»å¸¸ä¸Šç½‘çš„ä¸ªäººç”¨æˆ·ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•æ¥ä¿æŠ¤è‡ªå·±ï¼š ä½¿ç”¨ç½‘é¡µç‰ˆé‚®ä»¶çš„æµè§ˆé‚®ä»¶æˆ–è€…æ–°é—»ä¹Ÿä¼šå¸¦æ¥é¢å¤–çš„é£é™©ï¼Œå› ä¸ºæŸ¥çœ‹é‚®ä»¶æˆ–è€…æ–°é—»æ¶ˆæ¯æœ‰å¯èƒ½å¯¼è‡´æ¶æ„ä»£ç çš„æ”»å‡»ã€‚ å°½é‡ä¸è¦æ‰“å¼€å¯ç–‘çš„é“¾æ¥ï¼Œä¸€å®šè¦æ‰“å¼€æ—¶ï¼Œä½¿ç”¨ä¸å¸¸ç”¨çš„æµè§ˆå™¨ã€‚","categories":[{"name":"å®‰å…¨","slug":"å®‰å…¨","permalink":"http://yoursite.com/categories/å®‰å…¨/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"å®‰å…¨","slug":"å®‰å…¨","permalink":"http://yoursite.com/tags/å®‰å…¨/"}]},{"title":"XSSæ”»å‡»","slug":"XSSæ”»å‡»","date":"2019-06-13T10:29:55.000Z","updated":"2019-11-10T14:37:39.023Z","comments":true,"path":"2019/06/13/XSSæ”»å‡»/","link":"","permalink":"http://yoursite.com/2019/06/13/XSSæ”»å‡»/","excerpt":"XSS æ”»å‡»1.ä»€ä¹ˆæ˜¯ XSSCross-Site Scriptingï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ç®€ç§° XSSï¼Œæ˜¯ä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ã€‚æ”»å‡»è€…é€šè¿‡åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„è„šæœ¬ï¼Œä½¿ä¹‹åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šè¿è¡Œã€‚åˆ©ç”¨è¿™äº›æ¶æ„è„šæœ¬ï¼Œæ”»å‡»è€…å¯è·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯å¦‚ Cookieã€SessionID ç­‰ï¼Œè¿›è€Œå±å®³æ•°æ®å®‰å…¨ã€‚ ä¸ºäº†å’Œ CSS åŒºåˆ†ï¼Œè¿™é‡ŒæŠŠæ”»å‡»çš„ç¬¬ä¸€ä¸ªå­—æ¯æ”¹æˆäº† Xï¼Œäºæ˜¯å«åš XSSã€‚ XSS çš„æœ¬è´¨æ˜¯ï¼šæ¶æ„ä»£ç æœªç»è¿‡æ»¤ï¼Œä¸ç½‘ç«™æ­£å¸¸çš„ä»£ç æ··åœ¨ä¸€èµ·ï¼›æµè§ˆå™¨æ— æ³•åˆ†è¾¨å“ªäº›è„šæœ¬æ˜¯å¯ä¿¡çš„ï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œã€‚","text":"XSS æ”»å‡»1.ä»€ä¹ˆæ˜¯ XSSCross-Site Scriptingï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ç®€ç§° XSSï¼Œæ˜¯ä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ã€‚æ”»å‡»è€…é€šè¿‡åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„è„šæœ¬ï¼Œä½¿ä¹‹åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šè¿è¡Œã€‚åˆ©ç”¨è¿™äº›æ¶æ„è„šæœ¬ï¼Œæ”»å‡»è€…å¯è·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯å¦‚ Cookieã€SessionID ç­‰ï¼Œè¿›è€Œå±å®³æ•°æ®å®‰å…¨ã€‚ ä¸ºäº†å’Œ CSS åŒºåˆ†ï¼Œè¿™é‡ŒæŠŠæ”»å‡»çš„ç¬¬ä¸€ä¸ªå­—æ¯æ”¹æˆäº† Xï¼Œäºæ˜¯å«åš XSSã€‚ XSS çš„æœ¬è´¨æ˜¯ï¼šæ¶æ„ä»£ç æœªç»è¿‡æ»¤ï¼Œä¸ç½‘ç«™æ­£å¸¸çš„ä»£ç æ··åœ¨ä¸€èµ·ï¼›æµè§ˆå™¨æ— æ³•åˆ†è¾¨å“ªäº›è„šæœ¬æ˜¯å¯ä¿¡çš„ï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œã€‚ è€Œç”±äºç›´æ¥åœ¨ç”¨æˆ·çš„ç»ˆç«¯æ‰§è¡Œï¼Œæ¶æ„ä»£ç èƒ½å¤Ÿç›´æ¥è·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œæˆ–è€…åˆ©ç”¨è¿™äº›ä¿¡æ¯å†’å……ç”¨æˆ·å‘ç½‘ç«™å‘èµ·æ”»å‡»è€…å®šä¹‰çš„è¯·æ±‚ã€‚ åœ¨å¤„ç†è¾“å…¥æ—¶ï¼Œä»¥ä¸‹å†…å®¹éƒ½ä¸å¯ä¿¡ï¼š æ¥è‡ªç”¨æˆ·çš„ UGC ä¿¡æ¯ æ¥è‡ªç¬¬ä¸‰æ–¹çš„é“¾æ¥ URL å‚æ•° POST å‚æ•° Referer ï¼ˆå¯èƒ½æ¥è‡ªä¸å¯ä¿¡çš„æ¥æºï¼‰ Cookie ï¼ˆå¯èƒ½æ¥è‡ªå…¶ä»–å­åŸŸæ³¨å…¥ï¼‰ 2.XSS åˆ†ç±»æ ¹æ®æ”»å‡»çš„æ¥æºï¼ŒXSS æ”»å‡»å¯åˆ†ä¸ºå­˜å‚¨å‹ã€åå°„å‹å’Œ DOM å‹ä¸‰ç§ã€‚ å­˜å‚¨å‹ XSSå­˜å‚¨å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ã€‚ ç”¨æˆ·æ‰“å¼€ç›®æ ‡ç½‘ç«™æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»æ•°æ®åº“å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ è¿™ç§æ”»å‡»å¸¸è§äºå¸¦æœ‰ç”¨æˆ·ä¿å­˜æ•°æ®çš„ç½‘ç«™åŠŸèƒ½ï¼Œå¦‚è®ºå›å‘å¸–ã€å•†å“è¯„è®ºã€ç”¨æˆ·ç§ä¿¡ç­‰ã€‚ åå°„å‹ XSSåå°„å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URL æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä» URL ä¸­å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ åå°„å‹ XSS è·Ÿå­˜å‚¨å‹ XSS çš„åŒºåˆ«æ˜¯ï¼šå­˜å‚¨å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨æ•°æ®åº“é‡Œï¼Œåå°„å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨ URL é‡Œã€‚ åå°„å‹ XSS æ¼æ´å¸¸è§äºé€šè¿‡ URL ä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œå¦‚ç½‘ç«™æœç´¢ã€è·³è½¬ç­‰ã€‚ ç”±äºéœ€è¦ç”¨æˆ·ä¸»åŠ¨æ‰“å¼€æ¶æ„çš„ URL æ‰èƒ½ç”Ÿæ•ˆï¼Œæ”»å‡»è€…å¾€å¾€ä¼šç»“åˆå¤šç§æ‰‹æ®µè¯±å¯¼ç”¨æˆ·ç‚¹å‡»ã€‚ POST çš„å†…å®¹ä¹Ÿå¯ä»¥è§¦å‘åå°„å‹ XSSï¼Œåªä¸è¿‡å…¶è§¦å‘æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼ˆéœ€è¦æ„é€ è¡¨å•æäº¤é¡µé¢ï¼Œå¹¶å¼•å¯¼ç”¨æˆ·ç‚¹å‡»ï¼‰ï¼Œæ‰€ä»¥éå¸¸å°‘è§ã€‚ DOM å‹ XSSDOM å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URLã€‚ ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œå‰ç«¯ JavaScript å–å‡º URL ä¸­çš„æ¶æ„ä»£ç å¹¶æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ DOM å‹ XSS è·Ÿå‰ä¸¤ç§ XSS çš„åŒºåˆ«ï¼šDOM å‹ XSS æ”»å‡»ä¸­ï¼Œå–å‡ºå’Œæ‰§è¡Œæ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆï¼Œå±äºå‰ç«¯ JavaScript è‡ªèº«çš„å®‰å…¨æ¼æ´ï¼Œè€Œå…¶ä»–ä¸¤ç§ XSS éƒ½å±äºæœåŠ¡ç«¯çš„å®‰å…¨æ¼æ´ã€‚ 3.XSS çš„é¢„é˜²XSS æ”»å‡»æœ‰ä¸¤å¤§è¦ç´ ï¼š æ”»å‡»è€…æäº¤æ¶æ„ä»£ç ã€‚ æµè§ˆå™¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚ è¾“å…¥è¿‡æ»¤è¾“å…¥ä¾§è¿‡æ»¤èƒ½å¤Ÿåœ¨æŸäº›æƒ…å†µä¸‹è§£å†³ç‰¹å®šçš„ XSS é—®é¢˜ï¼Œä½†ä¼šå¼•å…¥å¾ˆå¤§çš„ä¸ç¡®å®šæ€§å’Œä¹±ç é—®é¢˜ã€‚ å¯¹äºæ˜ç¡®çš„è¾“å…¥ç±»å‹ï¼Œä¾‹å¦‚æ•°å­—ã€URLã€ç”µè¯å·ç ã€é‚®ä»¶åœ°å€ç­‰ç­‰å†…å®¹ï¼Œè¿›è¡Œè¾“å…¥è¿‡æ»¤è¿˜æ˜¯å¿…è¦çš„ã€‚ è¾“å…¥è¿‡æ»¤å¹¶éå®Œå…¨å¯é ï¼Œæˆ‘ä»¬å°±è¦é€šè¿‡â€œé˜²æ­¢æµè§ˆå™¨æ‰§è¡Œæ¶æ„ä»£ç â€æ¥é˜²èŒƒ XSSã€‚è¿™éƒ¨åˆ†åˆ†ä¸ºä¸¤ç±»ï¼š é˜²æ­¢ HTML ä¸­å‡ºç°æ³¨å…¥ã€‚ é˜²æ­¢ JavaScript æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚ é¢„é˜²å­˜å‚¨å‹å’Œåå°„å‹ XSS æ”»å‡»é¢„é˜²è¿™ä¸¤ç§æ¼æ´ï¼Œæœ‰ä¸¤ç§å¸¸è§åšæ³•ï¼š æ”¹æˆçº¯å‰ç«¯æ¸²æŸ“ï¼ŒæŠŠä»£ç å’Œæ•°æ®åˆ†éš”å¼€ã€‚ çº¯å‰ç«¯æ¸²æŸ“çš„è¿‡ç¨‹ï¼š æµè§ˆå™¨å…ˆåŠ è½½ä¸€ä¸ªé™æ€ HTMLï¼Œæ­¤ HTML ä¸­ä¸åŒ…å«ä»»ä½•è·Ÿä¸šåŠ¡ç›¸å…³çš„æ•°æ®ã€‚ ç„¶åæµè§ˆå™¨æ‰§è¡Œ HTML ä¸­çš„ JavaScriptã€‚ JavaScript é€šè¿‡ Ajax åŠ è½½ä¸šåŠ¡æ•°æ®ï¼Œè°ƒç”¨ DOM API æ›´æ–°åˆ°é¡µé¢ä¸Šã€‚ åœ¨çº¯å‰ç«¯æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬ä¼šæ˜ç¡®çš„å‘Šè¯‰æµè§ˆå™¨ï¼šä¸‹é¢è¦è®¾ç½®çš„å†…å®¹æ˜¯æ–‡æœ¬ï¼ˆ.innerTextï¼‰ï¼Œè¿˜æ˜¯å±æ€§ï¼ˆ.setAttributeï¼‰ï¼Œè¿˜æ˜¯æ ·å¼ï¼ˆ.styleï¼‰ç­‰ç­‰ã€‚æµè§ˆå™¨ä¸ä¼šè¢«è½»æ˜“çš„è¢«æ¬ºéª—ï¼Œæ‰§è¡Œé¢„æœŸå¤–çš„ä»£ç äº†ã€‚ ä½†çº¯å‰ç«¯æ¸²æŸ“è¿˜éœ€æ³¨æ„é¿å… DOM å‹ XSS æ¼æ´ å¯¹ HTML åšå……åˆ†è½¬ä¹‰ã€‚ è½¬ä¹‰åº”è¯¥åœ¨è¾“å‡º HTML æ—¶è¿›è¡Œï¼Œè€Œä¸æ˜¯åœ¨æäº¤ç”¨æˆ·è¾“å…¥æ—¶ã€‚ å¸¸ç”¨çš„æ¨¡æ¿å¼•æ“ï¼Œå¦‚ doT.jsã€ejsã€FreeMarker ç­‰ï¼Œå¯¹äº HTML è½¬ä¹‰é€šå¸¸åªæœ‰ä¸€ä¸ªè§„åˆ™ï¼Œå°±æ˜¯æŠŠ &amp; &lt; &gt; &quot; &#39; / è¿™å‡ ä¸ªå­—ç¬¦è½¬ä¹‰æ‰ï¼Œç¡®å®èƒ½èµ·åˆ°ä¸€å®šçš„ XSS é˜²æŠ¤ä½œç”¨ï¼Œä½†å¹¶ä¸å®Œå–„ï¼š é¢„é˜² DOM å‹ XSS æ”»å‡» åœ¨ä½¿ç”¨ .innerHTMLã€.outerHTMLã€document.write() æ—¶è¦ç‰¹åˆ«å°å¿ƒï¼Œä¸è¦æŠŠä¸å¯ä¿¡çš„æ•°æ®ä½œä¸º HTML æ’åˆ°é¡µé¢ä¸Šï¼Œè€Œåº”å°½é‡ä½¿ç”¨ .textContentã€.setAttribute() ç­‰ã€‚ å¦‚æœç”¨ Vue/React æŠ€æœ¯æ ˆï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ v-html/dangerouslySetInnerHTML åŠŸèƒ½ï¼Œå°±åœ¨å‰ç«¯ render é˜¶æ®µé¿å… innerHTMLã€outerHTML çš„ XSS éšæ‚£ã€‚ DOM ä¸­çš„å†…è”äº‹ä»¶ç›‘å¬å™¨ï¼Œå¦‚ locationã€onclickã€onerrorã€onloadã€onmouseover ç­‰ï¼Œ&lt;a&gt; æ ‡ç­¾çš„ href å±æ€§ï¼ŒJavaScript çš„ eval()ã€setTimeout()ã€setInterval() ç­‰ï¼Œéƒ½èƒ½æŠŠå­—ç¬¦ä¸²ä½œä¸ºä»£ç è¿è¡Œã€‚å¦‚æœä¸å¯ä¿¡çš„æ•°æ®æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ä¼ é€’ç»™è¿™äº› APIï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿå®‰å…¨éšæ‚£ï¼Œè¯·åŠ¡å¿…é¿å…ã€‚ 4.å…¶ä»– XSS é˜²èŒƒæªæ–½Content Security Policyä¸¥æ ¼çš„ CSP åœ¨ XSS çš„é˜²èŒƒä¸­å¯ä»¥èµ·åˆ°ä»¥ä¸‹çš„ä½œç”¨ï¼š ç¦æ­¢åŠ è½½å¤–åŸŸä»£ç ï¼Œé˜²æ­¢å¤æ‚çš„æ”»å‡»é€»è¾‘ã€‚ ç¦æ­¢å¤–åŸŸæäº¤ï¼Œç½‘ç«™è¢«æ”»å‡»åï¼Œç”¨æˆ·çš„æ•°æ®ä¸ä¼šæ³„éœ²åˆ°å¤–åŸŸã€‚ ç¦æ­¢å†…è”è„šæœ¬æ‰§è¡Œï¼ˆè§„åˆ™è¾ƒä¸¥æ ¼ï¼Œç›®å‰å‘ç° GitHub ä½¿ç”¨ï¼‰ã€‚ ç¦æ­¢æœªæˆæƒçš„è„šæœ¬æ‰§è¡Œï¼ˆæ–°ç‰¹æ€§ï¼ŒGoogle Map ç§»åŠ¨ç‰ˆåœ¨ä½¿ç”¨ï¼‰ã€‚ åˆç†ä½¿ç”¨ä¸ŠæŠ¥å¯ä»¥åŠæ—¶å‘ç° XSSï¼Œåˆ©äºå°½å¿«ä¿®å¤é—®é¢˜ã€‚ è¾“å…¥å†…å®¹é•¿åº¦æ§åˆ¶å¯¹äºä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œéƒ½åº”è¯¥é™å®šä¸€ä¸ªåˆç†çš„é•¿åº¦ã€‚è™½ç„¶æ— æ³•å®Œå…¨é˜²æ­¢ XSS å‘ç”Ÿï¼Œä½†å¯ä»¥å¢åŠ  XSS æ”»å‡»çš„éš¾åº¦ã€‚ å…¶ä»–å®‰å…¨æªæ–½ HTTP-only Cookie: ç¦æ­¢ JavaScript è¯»å–æŸäº›æ•æ„Ÿ Cookieï¼Œæ”»å‡»è€…å®Œæˆ XSS æ³¨å…¥åä¹Ÿæ— æ³•çªƒå–æ­¤ Cookieã€‚ éªŒè¯ç ï¼šé˜²æ­¢è„šæœ¬å†’å……ç”¨æˆ·æäº¤å±é™©æ“ä½œã€‚ 5.XSS æ¼æ´æ€»ç»“æ¼æ´æ€»ç»“ åœ¨ HTML ä¸­å†…åµŒçš„æ–‡æœ¬ä¸­ï¼Œæ¶æ„å†…å®¹ä»¥ script æ ‡ç­¾å½¢æˆæ³¨å…¥ã€‚ åœ¨å†…è”çš„ JavaScript ä¸­ï¼Œæ‹¼æ¥çš„æ•°æ®çªç ´äº†åŸæœ¬çš„é™åˆ¶ï¼ˆå­—ç¬¦ä¸²ï¼Œå˜é‡ï¼Œæ–¹æ³•åç­‰ï¼‰ã€‚ åœ¨æ ‡ç­¾å±æ€§ä¸­ï¼Œæ¶æ„å†…å®¹åŒ…å«å¼•å·ï¼Œä»è€Œçªç ´å±æ€§å€¼çš„é™åˆ¶ï¼Œæ³¨å…¥å…¶ä»–å±æ€§æˆ–è€…æ ‡ç­¾ã€‚ åœ¨æ ‡ç­¾çš„ hrefã€src ç­‰å±æ€§ä¸­ï¼ŒåŒ…å« javascript: ç­‰å¯æ‰§è¡Œä»£ç ã€‚ åœ¨ onloadã€onerrorã€onclick ç­‰äº‹ä»¶ä¸­ï¼Œæ³¨å…¥ä¸å—æ§åˆ¶ä»£ç ã€‚ åœ¨ style å±æ€§å’Œæ ‡ç­¾ä¸­ï¼ŒåŒ…å«ç±»ä¼¼ background-image:url(&quot;javascript:...&quot;); çš„ä»£ç ï¼ˆæ–°ç‰ˆæœ¬æµè§ˆå™¨å·²ç»å¯ä»¥é˜²èŒƒï¼‰ã€‚ åœ¨ style å±æ€§å’Œæ ‡ç­¾ä¸­ï¼ŒåŒ…å«ç±»ä¼¼ expression(...) çš„ CSS è¡¨è¾¾å¼ä»£ç ï¼ˆæ–°ç‰ˆæœ¬æµè§ˆå™¨å·²ç»å¯ä»¥é˜²èŒƒï¼‰ã€‚ æ€»ä¹‹ï¼Œå¦‚æœå¼€å‘è€…æ²¡æœ‰å°†ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬è¿›è¡Œåˆé€‚çš„è¿‡æ»¤ï¼Œå°±è´¸ç„¶æ’å…¥åˆ° HTML ä¸­ï¼Œè¿™å¾ˆå®¹æ˜“é€ æˆæ³¨å…¥æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ¼æ´ï¼Œæ„é€ å‡ºæ¶æ„çš„ä»£ç æŒ‡ä»¤ï¼Œè¿›è€Œåˆ©ç”¨æ¶æ„ä»£ç å±å®³æ•°æ®å®‰å…¨ã€‚ å†…è” JSON ä¹Ÿæ˜¯ä¸å®‰å…¨çš„ï¼š å½“ JSON ä¸­åŒ…å« U+2028 æˆ– U+2029 è¿™ä¸¤ä¸ªå­—ç¬¦æ—¶ï¼Œä¸èƒ½ä½œä¸º JavaScript çš„å­—é¢é‡ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ›å‡ºè¯­æ³•é”™è¯¯ã€‚ å½“ JSON ä¸­åŒ…å«å­—ç¬¦ä¸² &lt;/script&gt; æ—¶ï¼Œå½“å‰çš„ script æ ‡ç­¾å°†ä¼šè¢«é—­åˆï¼Œåé¢çš„å­—ç¬¦ä¸²å†…å®¹æµè§ˆå™¨ä¼šæŒ‰ç…§ HTML è¿›è¡Œè§£æï¼›é€šè¿‡å¢åŠ ä¸‹ä¸€ä¸ª &lt;script&gt; æ ‡ç­¾ç­‰æ–¹æ³•å°±å¯ä»¥å®Œæˆæ³¨å…¥ã€‚ 6.å‡å°‘æ¼æ´äº§ç”Ÿçš„åŸåˆ™ åˆ©ç”¨æ¨¡æ¿å¼•æ“å¼€å¯æ¨¡æ¿å¼•æ“è‡ªå¸¦çš„ HTML è½¬ä¹‰åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼šåœ¨ ejs ä¸­ï¼Œå°½é‡ä½¿ç”¨ &lt;%= data %&gt; è€Œä¸æ˜¯ &lt;%- data %&gt;ï¼›åœ¨ FreeMarker ä¸­ï¼Œç¡®ä¿å¼•æ“ç‰ˆæœ¬é«˜äº 2.3.24ï¼Œå¹¶ä¸”é€‰æ‹©æ­£ç¡®çš„ freemarker.core.OutputFormatã€‚ é¿å…å†…è”äº‹ä»¶å°½é‡ä¸è¦ä½¿ç”¨ onLoad=&quot;onload(&#39;&#39;)&quot;ã€onClick=&quot;go(&#39;&#39;)&quot; è¿™ç§æ‹¼æ¥å†…è”äº‹ä»¶çš„å†™æ³•ã€‚åœ¨ JavaScript ä¸­é€šè¿‡ .addEventlistener() äº‹ä»¶ç»‘å®šä¼šæ›´å®‰å…¨ã€‚ é¿å…æ‹¼æ¥ HTMLå‰ç«¯é‡‡ç”¨æ‹¼æ¥ HTML çš„æ–¹æ³•æ¯”è¾ƒå±é™©ï¼Œå¦‚æœæ¡†æ¶å…è®¸ï¼Œä½¿ç”¨ createElementã€setAttribute ä¹‹ç±»çš„æ–¹æ³•å®ç°ã€‚æˆ–è€…é‡‡ç”¨æ¯”è¾ƒæˆç†Ÿçš„æ¸²æŸ“æ¡†æ¶ï¼Œå¦‚ Vue/React ç­‰ã€‚ æ—¶åˆ»ä¿æŒè­¦æƒ•åœ¨æ’å…¥ä½ç½®ä¸º DOM å±æ€§ã€é“¾æ¥ç­‰ä½ç½®æ—¶ï¼Œè¦æ‰“èµ·ç²¾ç¥ï¼Œä¸¥åŠ é˜²èŒƒã€‚ å¢åŠ æ”»å‡»éš¾åº¦ï¼Œé™ä½æ”»å‡»åæœé€šè¿‡ CSPã€è¾“å…¥é•¿åº¦é…ç½®ã€æ¥å£å®‰å…¨æªæ–½ç­‰æ–¹æ³•ï¼Œå¢åŠ æ”»å‡»çš„éš¾åº¦ï¼Œé™ä½æ”»å‡»çš„åæœã€‚ ä¸»åŠ¨æ£€æµ‹å’Œå‘ç°å¯ä½¿ç”¨ XSS æ”»å‡»å­—ç¬¦ä¸²å’Œè‡ªåŠ¨æ‰«æå·¥å…·å¯»æ‰¾æ½œåœ¨çš„ XSS æ¼æ´ã€‚ 7.vue react æ¡†æ¶å¯¹ xss çš„é˜²æŠ¤æœ‰åšä»€ä¹ˆï¼Ÿ VUE å°½é‡ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼(åŒèŠ±æ‹¬å·)ï¼Œå®ƒä¼šæŠŠè¦æ˜¾ç¤ºçš„å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²ã€‚ å¦‚æœä½¿ç”¨v-htmlï¼Œè¦ä¿è¯æ¥è‡ªæœåŠ¡ç«¯çš„æ¸²æŸ“æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ã€‚ åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹ UI ç»„ä»¶åº“çš„çš„æ—¶å€™ï¼Œè¦æ£€æŸ¥ä¸€ä¸‹å®ƒä»¬æ¸²æŸ“é¡µé¢çš„æ–¹å¼ï¼Œæ˜¯å¦ä½¿ç”¨äº†v-html REACT XSS é˜²å¾¡æªæ–½å°±æ˜¯å¯¹ä»»ä½•ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯è¿›è¡Œå¤„ç†ï¼Œåªå…è®¸åˆæ³•å€¼ï¼Œå…¶å®ƒå€¼ä¸€æ¦‚è¿‡æ»¤æ‰ æ‰€æœ‰çš„ç”¨æˆ·è¾“å…¥éƒ½éœ€è¦ç»è¿‡ HTML å®ä½“ç¼–ç ï¼ŒReact å·²ç»åšäº†ï¼Œå®ƒä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»º DOM èŠ‚ç‚¹ç„¶åå¡«å…¥æ–‡æœ¬å†…å®¹ (ä¹Ÿå¯ä»¥å¼ºåˆ¶è®¾ç½® HTML å†…å®¹ï¼Œä¸è¿‡è¿™æ ·æ¯”è¾ƒå±é™©) åºåˆ—åŒ–æŸäº›çŠ¶æ€å¹¶ä¸”ä¼ ç»™å®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œä¹Ÿè¿›è¡Œ HTML å®ä½“ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨ Yahoo çš„ Serialize JavaScript ä¸­çš„ serialize æ–¹æ³•æ›¿æ¢ JSON.stringify æ–¹æ³•ï¼ŒSerialize JavaScript ä¸­çš„æ–¹æ³•ä¼šè‡ªåŠ¨å°† HTML å’Œ JavaScript ä»£ç è¿›è¡Œè½¬ç ï¼ŒGitHub è®¿é—®åœ°å€ : https://github.com/yahoo/serialize-javascript é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact DOM åœ¨é‡æ–°æ¸²æŸ“é¡µé¢æ—¶å°†æ‰€æœ‰è¿›è¡Œè½¬ç ï¼Œå®˜æ–¹å®£ç§°åœ¨ React åº”ç”¨ä¸­ç¡®ä¿ä¸ä¼šæ³¨å…¥ä»»ä½•æ²¡æ˜¾å¼ç¼–å†™çš„æ•°æ®ï¼Œæ‰€æœ‰çš„æ•°æ®åœ¨é¡µé¢æ¸²æŸ“ä¹‹å‰éƒ½ä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè¿™é˜²æ­¢ XSS è¿›æ”» 8.xss æ”»å‡»åæœï¼Ÿæ¶æ„ä»£ç æœªç»è¿‡æ»¤ï¼Œä¸ç½‘ç«™æ­£å¸¸çš„ä»£ç æ··åœ¨ä¸€èµ·ï¼›æµè§ˆå™¨æ— æ³•åˆ†è¾¨å“ªäº›è„šæœ¬æ˜¯å¯ä¿¡çš„ï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œã€‚ è€Œç”±äºç›´æ¥åœ¨ç”¨æˆ·çš„ç»ˆç«¯æ‰§è¡Œï¼Œæ¶æ„ä»£ç èƒ½å¤Ÿç›´æ¥è·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œæˆ–è€…åˆ©ç”¨è¿™äº›ä¿¡æ¯å†’å……ç”¨æˆ·å‘ç½‘ç«™å‘èµ·æ”»å‡»è€…å®šä¹‰çš„è¯·æ±‚ã€‚ 9.éœ€è¦è½¬ä¹‰çš„å­—ç¬¦ï¼Ÿ escapeHTML() æŒ‰ç…§å¦‚ä¸‹è§„åˆ™è¿›è¡Œè½¬ä¹‰ï¼š è¿ javascript: è¿™æ ·çš„å­—ç¬¦ä¸²å¦‚æœå‡ºç°åœ¨ç‰¹å®šçš„ä½ç½®ä¹Ÿä¼šå¼•å‘ XSS æ”»å‡»ã€‚ %20javascript:alert(&#39;XSS&#39;) ç»è¿‡ URL è§£æåå˜æˆ javascript:alert(&#39;XSS&#39;)ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä»¥ç©ºæ ¼å¼€å¤´ã€‚è¿™æ ·æ”»å‡»è€…å¯ä»¥ç»•è¿‡åç«¯çš„å…³é”®è¯è§„åˆ™ï¼ŒåˆæˆåŠŸçš„å®Œæˆäº†æ³¨å…¥ã€‚ æ’å…¥ JSON çš„åœ°æ–¹ä¸èƒ½ä½¿ç”¨ escapeHTML()ï¼Œå› ä¸ºè½¬ä¹‰ &quot; åï¼ŒJSON æ ¼å¼ä¼šè¢«ç ´åã€‚ è¦å®ç°ä¸€ä¸ª escapeEmbedJSON() å‡½æ•°ï¼Œå¯¹å†…è” JSON è¿›è¡Œè½¬ä¹‰ã€‚","categories":[{"name":"å®‰å…¨","slug":"å®‰å…¨","permalink":"http://yoursite.com/categories/å®‰å…¨/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"å®‰å…¨","slug":"å®‰å…¨","permalink":"http://yoursite.com/tags/å®‰å…¨/"}]},{"title":"ES6 çš„æ–°ç‰¹æ€§æ€»ç»“","slug":"ES6 çš„æ–°ç‰¹æ€§æ€»ç»“","date":"2019-06-01T14:23:01.000Z","updated":"2019-11-10T14:37:39.016Z","comments":true,"path":"2019/06/01/ES6 çš„æ–°ç‰¹æ€§æ€»ç»“/","link":"","permalink":"http://yoursite.com/2019/06/01/ES6 çš„æ–°ç‰¹æ€§æ€»ç»“/","excerpt":"ES6 çš„æ–°ç‰¹æ€§1. æ•°ç»„çš„æ‹“å±•æ•°ç»„çš„æ–¹æ³• array.concat(array1, array2,â€¦arrayN)åˆå¹¶å¤šä¸ªæ•°ç»„ï¼Œè¿”å›åˆå¹¶åçš„æ–°æ•°ç»„ï¼ŒåŸæ•°ç»„æ²¡æœ‰å˜åŒ–ã€‚ array.every(callback[, thisArg])æ£€æµ‹æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯å¦éƒ½é€šè¿‡äº† callback æµ‹è¯•ï¼Œå…¨éƒ¨é€šè¿‡è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ array.filter(callback[, thisArg])è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼ŒåŒ…å«é€šè¿‡ callback å‡½æ•°æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚(callback å®šä¹‰ï¼Œä¸‰ä¸ªå‚æ•°ï¼š element:å½“å‰å…ƒç´ å€¼ï¼›indexï¼šå½“å‰å…ƒç´ ä¸‹æ ‡ï¼› array:å½“å‰æ•°ç»„) array.find(callback[, thisArg])è¿”å›é€šè¿‡ callback å‡½æ•°æµ‹è¯•çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™è¿”å› undefinedï¼Œcallback å‡½æ•°å®šä¹‰åŒä¸Šã€‚","text":"ES6 çš„æ–°ç‰¹æ€§1. æ•°ç»„çš„æ‹“å±•æ•°ç»„çš„æ–¹æ³• array.concat(array1, array2,â€¦arrayN)åˆå¹¶å¤šä¸ªæ•°ç»„ï¼Œè¿”å›åˆå¹¶åçš„æ–°æ•°ç»„ï¼ŒåŸæ•°ç»„æ²¡æœ‰å˜åŒ–ã€‚ array.every(callback[, thisArg])æ£€æµ‹æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯å¦éƒ½é€šè¿‡äº† callback æµ‹è¯•ï¼Œå…¨éƒ¨é€šè¿‡è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ array.filter(callback[, thisArg])è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼ŒåŒ…å«é€šè¿‡ callback å‡½æ•°æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚(callback å®šä¹‰ï¼Œä¸‰ä¸ªå‚æ•°ï¼š element:å½“å‰å…ƒç´ å€¼ï¼›indexï¼šå½“å‰å…ƒç´ ä¸‹æ ‡ï¼› array:å½“å‰æ•°ç»„) array.find(callback[, thisArg])è¿”å›é€šè¿‡ callback å‡½æ•°æµ‹è¯•çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™è¿”å› undefinedï¼Œcallback å‡½æ•°å®šä¹‰åŒä¸Šã€‚ array.findIndex(callback[, thisArg])è¿”å›é€šè¿‡ callback å‡½æ•°æµ‹è¯•çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œå¦åˆ™è¿”å›-1ï¼Œcallback å‡½æ•°å®šä¹‰åŒä¸Šã€‚ array.includes(searchElement, fromIndex)includes() æ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œè¿”å› true æˆ– falseã€‚searchElementï¼šè¦æŸ¥æ‰¾çš„å…ƒç´ ï¼›fromIndexï¼šå¼€å§‹æŸ¥æ‰¾çš„ç´¢å¼•ä½ç½®ã€‚ array.indexOf(searchElement[, fromIndex = 0])è¿”å›åœ¨æ•°ç»„ä¸­å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç»™å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1ã€‚searchElementï¼šè¦æŸ¥æ‰¾çš„å…ƒç´ ï¼›fromIndexï¼šå¼€å§‹æŸ¥æ‰¾çš„ç´¢å¼•ä½ç½®ã€‚ array.join(separator=&#39;,&#39;)å°†æ•°ç»„ä¸­çš„å…ƒç´ é€šè¿‡ separator è¿æ¥æˆå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›è¯¥å­—ç¬¦ä¸²ï¼Œseparator é»˜è®¤ä¸ºâ€,â€ã€‚ array.map(callback[, thisArg])è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œæ–°æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯è°ƒç”¨ callback å‡½æ•°åè¿”å›çš„ç»“æœã€‚æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰ return å€¼ï¼Œåˆ™æ–°æ•°ç»„ä¼šæ’å…¥ä¸€ä¸ª undefined å€¼ã€‚array.map ç”±äºä¸å…·æœ‰è¿‡æ»¤çš„åŠŸèƒ½ï¼Œå› æ­¤ array è°ƒç”¨ map å‡½æ•°æ—¶ï¼Œå¦‚æœ array ä¸­çš„æ•°æ®å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªéƒ½ä¼š returnï¼Œåˆ™å¿…é¡»å…ˆ filterï¼Œç„¶åå† mapï¼Œå³ map è°ƒç”¨æ—¶å¿…é¡»æ˜¯å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰æ•ˆã€‚ array.pop() ä¸ array.shift()pop ä¸ºä»æ•°ç»„ä¸­åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ï¼ŒåŸæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ è¢«åˆ é™¤ã€‚æ•°ç»„ä¸ºç©ºæ—¶è¿”å› undefinedã€‚shift åˆ é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ŒåŸæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«åˆ é™¤ã€‚æ•°ç»„ä¸ºç©ºè¿”å› undefinedã€‚ array.push(element1, element2, ....elementN) ä¸ array.unshift(element1, element2, ...elementN)push æ˜¯å°†ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ æ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œå¹¶è¿”å›æ–°æ•°ç»„çš„é•¿åº¦; unshift å°†ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ æ·»åŠ åˆ°æ•°ç»„çš„å¼€å¤´ï¼Œå¹¶è¿”å›æ–°æ•°ç»„çš„é•¿åº¦ã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ’å…¥çš„ä½ç½®ä¸åŒã€‚ array.reduce(callback[, initialValue])å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼ˆä»å·¦åˆ°å³ï¼‰æ‰§è¡Œ callback å‡½æ•°ç´¯åŠ ï¼Œå°†å…¶å‡å°‘ä¸ºå•ä¸ªå€¼ã€‚ array.reverse()å°†æ•°ç»„ä¸­å…ƒç´ çš„ä½ç½®é¢ å€’ã€‚ array.slice(begin, end)è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼ŒåŒ…å«åŸæ•°ç»„ä» begin åˆ° end(ä¸åŒ…å« end)ç´¢å¼•ä½ç½®çš„æ‰€æœ‰å…ƒç´ ã€‚ array.some(callback[, thisArg])åˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦åŒ…å«å¯ä»¥é€šè¿‡ callback æµ‹è¯•çš„å…ƒç´ ï¼Œä¸ every ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œåªè¦æŸä¸€ä¸ªå…ƒç´ é€šè¿‡æµ‹è¯•ï¼Œå³è¿”å› trueã€‚callback å®šä¹‰åŒä¸Šã€‚ array.sort([compareFunction])å¯¹æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼ŒcompareFunction ä¸å­˜åœ¨æ—¶ï¼Œå…ƒç´ æŒ‰ç…§è½¬æ¢ä¸ºçš„å­—ç¬¦ä¸²çš„è¯¸ä¸ªå­—ç¬¦çš„ Unicode ä½ç‚¹è¿›è¡Œæ’åºï¼Œæ…ç”¨ï¼è¯·ä½¿ç”¨æ—¶ä¸€å®šè¦åŠ  compareFunction å‡½æ•°ï¼Œè€Œä¸”è¯¥æ’åºæ˜¯ä¸ç¨³å®šçš„ã€‚ array.splice(start[, deleteCount, item1, item2, ...])é€šè¿‡åˆ é™¤ç°æœ‰å…ƒç´ å’Œ/æˆ–æ·»åŠ æ–°å…ƒç´ æ¥æ›´æ”¹ä¸€ä¸ªæ•°ç»„çš„å†…å®¹ã€‚start:æŒ‡å®šä¿®æ”¹çš„å¼€å§‹ä½ç½®ï¼›deleteCountï¼šä» start ä½ç½®å¼€å§‹è¦åˆ é™¤çš„å…ƒç´ ä¸ªæ•°ï¼›itemâ€¦ï¼šè¦æ·»åŠ è¿›æ•°ç»„çš„å…ƒç´ ,ä» start ä½ç½®å¼€å§‹ã€‚è¿”å›å€¼æ˜¯ç”±è¢«åˆ é™¤çš„å…ƒç´ ç»„æˆçš„ä¸€ä¸ªæ•°ç»„ã€‚å¦‚æœåªåˆ é™¤äº†ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™è¿”å›åªåŒ…å«ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰åˆ é™¤å…ƒç´ ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ã€‚å¦‚æœ deleteCount å¤§äº start ä¹‹åçš„å…ƒç´ çš„æ€»æ•°ï¼Œåˆ™ä» start åé¢çš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤ï¼ˆå«ç¬¬ start ä½ï¼‰ã€‚ æ³¨ï¼špushã€ shiftã€ popã€ unshiftã€ reverseã€ sortã€ splice æ–¹æ³•ä¼šå¯¹åŸæ¥çš„æ•°ç»„è¿›è¡Œä¿®æ”¹ï¼Œå…¶ä»–çš„æ•°ç»„æ“ä½œæ–¹æ³•åªæœ‰è¿”å›å€¼ä¸åŒï¼Œå¯¹åŸæ•°ç»„éƒ½æ²¡æœ‰å½±å“ï¼Œå³åŸæ•°ç»„ä¸å˜ã€‚ ES6 ä¸­å¯¹æ•°ç»„çš„æ‰©å±• Array.from() : å°†ä¼ªæ•°ç»„å¯¹è±¡æˆ–å¯éå†å¯¹è±¡è½¬æ¢ä¸ºçœŸæ•°ç»„ Array.of(v1, v2, v3) : å°†ä¸€ç³»åˆ—å€¼è½¬æ¢æˆæ•°ç»„ã€‚ å½“ä½¿ç”¨å•ä¸ªæ•°å€¼å‚æ•°æ¥è°ƒç”¨ Array æ„é€ å™¨æ—¶ï¼Œæ•°ç»„çš„é•¿åº¦å±æ€§ä¼šè¢«è®¾ç½®ä¸ºè¯¥å‚æ•°ã€‚ å¦‚æœä½¿ç”¨å¤šä¸ªå‚æ•°(æ— è®ºæ˜¯å¦ä¸ºæ•°å€¼ç±»å‹)æ¥è°ƒç”¨ï¼Œè¿™äº›å‚æ•°ä¹Ÿä¼šæˆä¸ºç›®æ ‡æ•°ç»„çš„é¡¹ã€‚æ•°ç»„çš„è¿™ç§è¡Œä¸ºæ—¢æ··ä¹±åˆæœ‰é£é™©ï¼Œå› ä¸ºæœ‰æ—¶å¯èƒ½ä¸ä¼šç•™æ„æ‰€ä¼ å‚æ•°çš„ç±»å‹ã€‚ Array.of( )æ–¹æ³•æ€»ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¼ å…¥å‚æ•°çš„æ•°ç»„ï¼Œè€Œä¸ç®¡å‚æ•°çš„æ•°é‡ä¸ç±»å‹ 1234567let items = Array.of(1, 2);console.log(items.length); // 2console.log(items[0]); // 1console.log(items[1]); // 2items = Array.of(2);console.log(items.length); // 1console.log(items[0]); // 2 Array.of åŸºæœ¬ä¸Šå¯ä»¥ç”¨æ¥æ›¿ä»£ Array()æˆ– newArray()ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ç”±äºå‚æ•°ä¸åŒè€Œå¯¼è‡´çš„é‡è½½ï¼Œè€Œä¸”ä»–ä»¬çš„è¡Œä¸ºéå¸¸ç»Ÿä¸€ã€‚ æ•°ç»„å®ä¾‹çš„ find() å’Œ findIndex() find æ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜ã€‚å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç›´åˆ°æ‰¾å‡ºç¬¬ä¸€ä¸ªè¿”å›å€¼ä¸º true çš„æˆå‘˜ï¼Œç„¶åè¿”å›è¯¥æˆå‘˜ã€‚å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æˆå‘˜ï¼Œåˆ™è¿”å› undefinedã€‚ 1[1, 4, -5, 10].find(n =&gt; n &lt; 0); // -5 findIndex æ–¹æ³•çš„ç”¨æ³•ä¸ find æ–¹æ³•éå¸¸ç±»ä¼¼ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ä½ç½®ï¼Œå¦‚æœæ‰€æœ‰æˆå‘˜éƒ½ä¸ç¬¦åˆæ¡ä»¶ï¼Œåˆ™è¿”å›-1ã€‚ 123[1, 5, 10, 15].findIndex(function(value, index, arr) &#123; return value &gt; 9;&#125;); // 2 æ•°ç»„å®ä¾‹çš„ includes() Array.prototype.includes æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ã€‚è¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæœç´¢çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º 0ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºå€’æ•°çš„ä½ç½®ï¼Œå¦‚æœè¿™æ—¶å®ƒå¤§äºæ•°ç»„é•¿åº¦ï¼ˆæ¯”å¦‚ç¬¬äºŒä¸ªå‚æ•°ä¸º-4ï¼Œä½†æ•°ç»„é•¿åº¦ä¸º 3ï¼‰ï¼Œåˆ™ä¼šé‡ç½®ä¸ºä» 0 å¼€å§‹ã€‚ 1234[1, 2, 3] .includes(2) // true [(1, 2, 3)].includes(3, -1); // true[1, 2, 3, 5, 1].includes(1, 2); // true æ²¡æœ‰è¯¥æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ•°ç»„çš„ indexOf æ–¹æ³•ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªå€¼ã€‚å®ƒå†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰è¿›è¡Œåˆ¤æ–­ï¼Œè¿™ä¼šå¯¼è‡´å¯¹ NaN çš„è¯¯åˆ¤ã€‚ 123[NaN] .indexOf(NaN) // -1 [NaN].includes(NaN); // true æ•°ç»„å®ä¾‹çš„ entries()ï¼Œkeys() å’Œ values() å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨ forâ€¦of å¾ªç¯è¿›è¡Œéå†ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ keys()æ˜¯å¯¹é”®åçš„éå†ã€values()æ˜¯å¯¹é”®å€¼çš„éå†ï¼Œentries()æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚ 1234567891011121314151617for (let index of [\"a\", \"b\"].keys()) &#123; console.log(index);&#125;// 0// 1for (let elem of [\"a\", \"b\"].values()) &#123; console.log(elem);&#125;// 'a'// 'b'for (let [index, elem] of [\"a\", \"b\"].entries()) &#123; console.log(index, elem);&#125;// 0 \"a\"// 1 \"b\" 2. ç®­å¤´å‡½æ•° ç¼©å‡ä»£ç å’Œæ”¹å˜ this æŒ‡å‘ ä½¿ç”¨æ³¨æ„ç‚¹ï¼š å‡½æ•°ä½“å†…çš„ this å¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚ ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨ new å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ ä¸å¯ä»¥ä½¿ç”¨ arguments å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ rest å‚æ•°ä»£æ›¿ã€‚ ä¸å¯ä»¥ä½¿ç”¨ yield å‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚ 3. rest å‚æ•° ç”¨äºè·å–å‡½æ•°çš„å¤šä½™å‚æ•°ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨ arguments å¯¹è±¡äº†ã€‚rest å‚æ•°æ­é…çš„å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥å˜é‡å°†å¤šä½™çš„å‚æ•°æ”¾å…¥æ•°ç»„ä¸­ã€‚ æ³¨æ„ç‚¹ï¼š æ¯ä¸ªå‡½æ•°æœ€å¤šåªèƒ½å£°æ˜ä¸€ä¸ª rest å‚æ•°ï¼Œè€Œä¸” rest å‚æ•°å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™æŠ¥é”™ã€‚ rest å‚æ•°ä¸èƒ½ç”¨äºå¯¹è±¡å­—é¢é‡ setter ä¹‹ä¸­ 4. å±•å¼€è¿ç®—ç¬¦å‰©ä½™å‚æ•°å…è®¸ä½ æŠŠå¤šä¸ªç‹¬ç«‹çš„å‚æ•°åˆå¹¶åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼›è€Œæ‰©å±•è¿ç®—ç¬¦åˆ™å…è®¸å°†ä¸€ä¸ªæ•°ç»„åˆ†å‰²ï¼Œå¹¶å°†å„ä¸ªé¡¹ä½œä¸ºåˆ†ç¦»çš„å‚æ•°ä¼ ç»™å‡½æ•°ã€‚ 5. è§£æ„èµ‹å€¼â€”-æ›´æ–¹ä¾¿çš„æ•°æ®è®¿é—®6. æ¨¡æ¿å­—ç¬¦ä¸²ç”¨åå¼•å·ï¼ˆ`ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡å’Œå‡½æ•°ï¼Œéœ€è¦å°†å˜é‡åå†™åœ¨${}ä¹‹ä¸­ã€‚ 7. class ç±»8. promise9. Iterator å’Œ forâ€¦of å¾ªç¯JavaScript åŸæœ‰çš„è¡¨ç¤ºâ€œé›†åˆâ€çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦æ˜¯æ•°ç»„ï¼ˆArrayï¼‰å’Œå¯¹è±¡ï¼ˆObjectï¼‰ï¼ŒES6 æ·»åŠ äº† Map å’Œ Setã€‚ ä»»ä½•æ•°æ®ç»“æ„åªè¦éƒ¨ç½² Iterator æ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œï¼ˆå³ä¾æ¬¡å¤„ç†è¯¥æ•°æ®ç»“æ„çš„æ‰€æœ‰æˆå‘˜ï¼‰ã€‚ Iterator çš„ä½œç”¨ï¼š ä¸ºå„ç§æ•°æ®ç»“æ„ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„ã€ç®€ä¾¿çš„è®¿é—®æ¥å£ï¼› ä½¿å¾—æ•°æ®ç»“æ„çš„æˆå‘˜èƒ½å¤ŸæŒ‰æŸç§æ¬¡åºæ’åˆ— ES6 åˆ›é€ äº†ä¸€ç§æ–°çš„éå†å‘½ä»¤ forâ€¦of å¾ªç¯ï¼ŒIterator æ¥å£ä¸»è¦ä¾› forâ€¦of æ¶ˆè´¹ã€‚ åŸç”Ÿå…·å¤‡ iterator æ¥å£çš„æ•°æ®(å¯ç”¨ for of éå†) Array set å®¹å™¨ map å®¹å™¨ String å‡½æ•°çš„ arguments å¯¹è±¡ NodeList å¯¹è±¡ å‡ ç§éå†æ–¹å¼æ¯”è¾ƒ for of å¾ªç¯ä¸ä»…æ”¯æŒæ•°ç»„ã€å¤§å¤šæ•°ä¼ªæ•°ç»„å¯¹è±¡ï¼Œä¹Ÿæ”¯æŒå­—ç¬¦ä¸²éå†ï¼Œæ­¤å¤–è¿˜æ”¯æŒ Map å’Œ Set å¯¹è±¡éå† for in å¾ªç¯å¯ä»¥éå†å­—ç¬¦ä¸²ã€å¯¹è±¡ã€æ•°ç»„ï¼Œä¸èƒ½éå† Set/Map forEach å¾ªç¯ä¸èƒ½éå†å­—ç¬¦ä¸²ã€å¯¹è±¡,å¯ä»¥éå† Set/Map 10. ES6 æ¨¡å—åŒ–å…¶æ¨¡å—åŠŸèƒ½ä¸»è¦ç”±ä¸¤ä¸ªå‘½ä»¤æ„æˆï¼šexport å’Œ importã€‚export å‘½ä»¤ç”¨äºè§„å®šæ¨¡å—çš„å¯¹å¤–æ¥å£ï¼Œimport å‘½ä»¤ç”¨äºè¾“å…¥å…¶ä»–æ¨¡å—æä¾›çš„åŠŸèƒ½ã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"CSSå…ƒç´ å±…ä¸­","slug":"CSSå…ƒç´ å±…ä¸­","date":"2019-05-23T10:06:01.000Z","updated":"2019-11-10T14:37:39.014Z","comments":true,"path":"2019/05/23/CSSå…ƒç´ å±…ä¸­/","link":"","permalink":"http://yoursite.com/2019/05/23/CSSå…ƒç´ å±…ä¸­/","excerpt":"CSS å…ƒç´ å±…ä¸­1.æ°´å¹³å±…ä¸­ è¡Œå†…å…ƒç´ æ°´å¹³å±…ä¸­ åˆ©ç”¨ text-align: center å¯ä»¥å®ç°åœ¨å—çº§å…ƒç´ å†…éƒ¨çš„è¡Œå†…å…ƒç´ æ°´å¹³å±…ä¸­ã€‚æ­¤æ–¹æ³•å¯¹ inlineã€inline-blockã€inline-table å’Œ inline-flex å…ƒç´ æ°´å¹³å±…ä¸­éƒ½æœ‰æ•ˆã€‚","text":"CSS å…ƒç´ å±…ä¸­1.æ°´å¹³å±…ä¸­ è¡Œå†…å…ƒç´ æ°´å¹³å±…ä¸­ åˆ©ç”¨ text-align: center å¯ä»¥å®ç°åœ¨å—çº§å…ƒç´ å†…éƒ¨çš„è¡Œå†…å…ƒç´ æ°´å¹³å±…ä¸­ã€‚æ­¤æ–¹æ³•å¯¹ inlineã€inline-blockã€inline-table å’Œ inline-flex å…ƒç´ æ°´å¹³å±…ä¸­éƒ½æœ‰æ•ˆã€‚ 1234.parent &#123; //åœ¨çˆ¶å®¹å™¨è®¾ç½® text-align: center;&#125; æ­¤å¤–ï¼Œå¦‚æœå—çº§å…ƒç´ å†…éƒ¨åŒ…ç€ä¹Ÿæ˜¯ä¸€ä¸ªå—çº§å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†å…¶ç”±å—çº§å…ƒç´ æ”¹å˜ä¸ºè¡Œå†…å—å…ƒç´ ï¼Œå†é€šè¿‡è®¾ç½®è¡Œå†…å—å…ƒç´ å±…ä¸­ä»¥è¾¾åˆ°æ°´å¹³å±…ä¸­ã€‚ 1234567891011&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;Demo&lt;/div&gt;&lt;/div&gt;&lt;style&gt; .parent &#123; text-align: center; &#125; .child &#123; display: inline-block; &#125;&lt;/style&gt; å—çº§å…ƒç´ çš„æ°´å¹³å±…ä¸­ è¿™ç§æƒ…å½¢å¯ä»¥æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œä¸‹é¢æˆ‘ä»¬è¯¦ç»†ä»‹ç»: â‘  å°†è¯¥å—çº§å…ƒç´ å·¦å³å¤–è¾¹è· margin-left å’Œ margin-right è®¾ç½®ä¸º auto1234.child &#123; width: 100px; //ç¡®ä¿è¯¥å—çº§å…ƒç´ å®šå®½ margin: 0 auto;&#125; â‘¡ ä½¿ç”¨ table+marginå…ˆå°†å­å…ƒç´ è®¾ç½®ä¸ºå—çº§è¡¨æ ¼æ¥æ˜¾ç¤ºï¼ˆç±»ä¼¼ï¼‰ï¼Œå†å°†å…¶è®¾ç½®æ°´å¹³å±…ä¸­ display:table åœ¨è¡¨ç°ä¸Šç±»ä¼¼ block å…ƒç´ ï¼Œä½†æ˜¯å®½åº¦ä¸ºå†…å®¹å®½ã€‚ 123456789&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;Demo&lt;/div&gt;&lt;/div&gt;&lt;style&gt; .child &#123; display: table; margin: 0 auto; &#125;&lt;/style&gt; â‘¢ ä½¿ç”¨ absolute+transformå…ˆå°†çˆ¶å…ƒç´ è®¾ç½®ä¸ºç›¸å¯¹å®šä½ï¼Œå†å°†å­å…ƒç´ è®¾ç½®ä¸ºç»å¯¹å®šä½ï¼Œå‘å³ç§»åŠ¨å­å…ƒç´ ï¼Œç§»åŠ¨è·ç¦»ä¸ºçˆ¶å®¹å™¨çš„ä¸€åŠï¼Œæœ€åé€šè¿‡å‘å·¦ç§»åŠ¨å­å…ƒç´ çš„ä¸€åŠå®½åº¦ä»¥è¾¾åˆ°æ°´å¹³å±…ä¸­ã€‚ 12345678910111213&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;Demo&lt;/div&gt;&lt;/div&gt;&lt;style&gt; .child &#123; position: absolute; left: 50%; transform: translateX(-50%); &#125; .parent &#123; position: relative; &#125;&lt;/style&gt; ä¸è¿‡ transform å±äº css3 å†…å®¹ï¼Œå…¼å®¹æ€§å­˜åœ¨ä¸€å®šé—®é¢˜ï¼Œé«˜ç‰ˆæœ¬æµè§ˆå™¨éœ€è¦æ·»åŠ ä¸€äº›å‰ç¼€ â‘£ ä½¿ç”¨ flex+justify-contenté€šè¿‡ CSS3 ä¸­çš„å¸ƒå±€åˆ©å™¨ flex ä¸­çš„ justify-content å±æ€§æ¥è¾¾åˆ°æ°´å¹³å±…ä¸­ã€‚ 123456789&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;Demo&lt;/div&gt;&lt;/div&gt;&lt;style&gt; .parent &#123; display: flex; justify-content: center; &#125;&lt;/style&gt; â‘¤ ä½¿ç”¨ flex+marginé€šè¿‡ flex å°†çˆ¶å®¹å™¨è®¾ç½®ä¸ºä¸º Flex å¸ƒå±€ï¼Œå†è®¾ç½®å­å…ƒç´ å±…ä¸­ã€‚ 1234567891011&lt;div class=&quot;parent&quot;&gt; &lt;div class=&quot;child&quot;&gt;Demo&lt;/div&gt;&lt;/div&gt;&lt;style&gt; .parent &#123; display: flex; &#125; .child &#123; margin:0 auto; &#125;&lt;/style&gt; å¤šå—çº§å…ƒç´ æ°´å¹³å±…ä¸­ â‘  åˆ©ç”¨ flex å¸ƒå±€åˆ©ç”¨å¼¹æ€§å¸ƒå±€(flex)ï¼Œå®ç°æ°´å¹³å±…ä¸­ï¼Œå…¶ä¸­ justify-content ç”¨äºè®¾ç½®å¼¹æ€§ç›’å­å…ƒç´ åœ¨ä¸»è½´ï¼ˆé»˜è®¤æ¨ªè½´ï¼‰æ–¹å‘ä¸Šçš„å¯¹é½æ–¹å¼ï¼Œæœ¬ä¾‹ä¸­è®¾ç½®å­å…ƒç´ æ°´å¹³å±…ä¸­æ˜¾ç¤ºã€‚ 1234#container &#123; display: flex; justify-content: center;&#125; â‘¡ åˆ©ç”¨ inline-blockå°†è¦æ°´å¹³æ’åˆ—çš„å—çŠ¶å…ƒç´ è®¾ä¸º display:inline-blockï¼Œç„¶ååœ¨çˆ¶çº§å…ƒç´ ä¸Šè®¾ç½® text-align:centerï¼Œè¾¾åˆ°ä¸ä¸Šé¢çš„è¡Œå†…å…ƒç´ çš„æ°´å¹³å±…ä¸­ä¸€æ ·çš„æ•ˆæœã€‚ 123456.container &#123; text-align: center;&#125;.inline-block &#123; display: inline-block;&#125; æµ®åŠ¨å…ƒç´ æ°´å¹³å±…ä¸­ å¯¹äºå®šå®½çš„æµ®åŠ¨å…ƒç´ ï¼Œé€šè¿‡å­å…ƒç´ è®¾ç½® relative + è´Ÿ margin å¯¹äºä¸å®šå®½çš„æµ®åŠ¨å…ƒç´ ï¼Œçˆ¶å­å®¹å™¨éƒ½ç”¨ç›¸å¯¹å®šä½ é€šç”¨æ–¹æ³•(ä¸ç®¡æ˜¯å®šå®½è¿˜æ˜¯ä¸å®šå®½)ï¼šflex å¸ƒå±€ â‘  å®šå®½çš„éæµ®åŠ¨å…ƒç´ é€šè¿‡å­å…ƒç´ è®¾ç½® relative + è´Ÿ margin,åŸç†è§ä¸‹å›¾ï¼š æ³¨æ„ï¼šæ ·å¼è®¾ç½®åœ¨æµ®åŠ¨å…ƒç´ æœ¬èº« 123456.child &#123; position:relative; left:50%; margin-left:-250px; &#125;&lt;div class=\"parent\"&gt; &lt;span class=\"child\" style=\"float: left;width: 500px;\" &gt;æˆ‘æ˜¯è¦å±…ä¸­çš„æµ®åŠ¨å…ƒç´ &lt;/span &gt;&lt;/div&gt; â‘¡ ä¸å®šå®½çš„æµ®åŠ¨å…ƒç´ é€šè¿‡çˆ¶å­å®¹å™¨éƒ½ç›¸å¯¹å®šä½ï¼Œåç§»ä½ç§»è§ä¸‹å›¾ï¼šæ³¨æ„ï¼šè¦æ¸…é™¤æµ®åŠ¨ï¼Œç»™å¤–éƒ¨å…ƒç´ åŠ ä¸Š floatã€‚è¿™é‡Œçš„çˆ¶å…ƒç´ å°±æ˜¯å¤–éƒ¨å…ƒç´  123456&lt;div class=\"box\"&gt; &lt;p&gt;æˆ‘æ˜¯æµ®åŠ¨çš„&lt;/p&gt; &lt;p&gt;æˆ‘ä¹Ÿæ˜¯å±…ä¸­çš„&lt;/p&gt;&lt;/div&gt;.box&#123; float:left; position:relative; left:50%; &#125; p&#123; float:left;position:relative; right:50%; &#125; â‘¢ é€šç”¨åŠæ³• flex å¸ƒå±€(ä¸ç®¡æ˜¯å®šå®½è¿˜æ˜¯ä¸å®šå®½)åˆ©ç”¨å¼¹æ€§å¸ƒå±€(flex)çš„ justify-content å±æ€§ï¼Œå®ç°æ°´å¹³å±…ä¸­ã€‚ 12345.parent &#123; display:flex; justify-content:center; &#125; .chlid&#123; float: left; width:200px;//æœ‰æ— å®½åº¦ä¸å½±å“å±…ä¸­ &#125;&lt;div class=\"parent\"&gt; &lt;span class=\"chlid\"&gt;æˆ‘æ˜¯è¦å±…ä¸­çš„æµ®åŠ¨å…ƒç´ &lt;/span&gt;&lt;/div&gt; ç»å¯¹å®šä½å…ƒç´ æ°´å¹³å±…ä¸­ è¿™ç§æ–¹å¼éå¸¸ç‹¬ç‰¹ï¼Œé€šè¿‡å­å…ƒç´ ç»å¯¹å®šä½ï¼Œå¤–åŠ  margin: 0 auto æ¥å®ç°ã€‚ 123456&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;è®©ç»å¯¹å®šä½çš„å…ƒç´ æ°´å¹³å±…ä¸­å¯¹é½ã€‚&lt;/div&gt;&lt;/div&gt;.parent&#123; position:relative; &#125; .child&#123; position: absolute; /*ç»å¯¹å®šä½*/ width:200px; height:100px; background: yellow; margin: 0 auto; /*æ°´å¹³å±…ä¸­*/ left: 0;/*æ­¤å¤„ä¸èƒ½çœç•¥ï¼Œä¸”ä¸º0*/ right: 0;/*æ­¤å¤„ä¸èƒ½çœç•¥ï¼Œä¸”ä¸º0*/ &#125; 2.å‚ç›´å±…ä¸­ å•è¡Œå†…è”å…ƒç´ å‚ç›´å±…ä¸­ 12345678&lt;div id=\"box\"&gt;&lt;span&gt;å•è¡Œå†…è”å…ƒç´ å‚ç›´å±…ä¸­ã€‚&lt;/span&gt;ã€‚&lt;/div&gt;&lt;style&gt; #box &#123; height: 120px; line-height: 120px; border: 2px dashed #f69c55; &#125;&lt;/style&gt; å¤šè¡Œå†…è”å…ƒç´ å‚ç›´å±…ä¸­ â‘  åˆ©ç”¨ flex å¸ƒå±€ï¼ˆflexï¼‰åˆ©ç”¨ flex å¸ƒå±€å®ç°å‚ç›´å±…ä¸­ï¼Œå…¶ä¸­ flex-direction: column å®šä¹‰ä¸»è½´æ–¹å‘ä¸ºçºµå‘ã€‚è¿™ç§æ–¹å¼åœ¨è¾ƒè€çš„æµè§ˆå™¨å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚ 12345678910111213141516&lt;div class=\"parent\"&gt; &lt;p&gt; Dance like nobody is watching, code like everybody is. Dance like nobody is watching, code like everybody is. Dance like nobody is watching, code like everybody is. &lt;/p&gt;&lt;/div&gt;&lt;style&gt; .parent &#123; height: 140px; display: flex; flex-direction: column; justify-content: center; border: 2px dashed #f69c55; &#125;&lt;/style&gt; â‘¡ åˆ©ç”¨è¡¨å¸ƒå±€ï¼ˆtableï¼‰åˆ©ç”¨è¡¨å¸ƒå±€çš„ vertical-align: middle å¯ä»¥å®ç°å­å…ƒç´ çš„å‚ç›´å±…ä¸­ 123456789101112131415161718&lt;div class=\"parent\"&gt; &lt;p class=\"child\"&gt; The more technology you learn, the more you realize how little you know. The more technology you learn, the more you realize how little you know. The more technology you learn, the more you realize how little you know. &lt;/p&gt;&lt;/div&gt;&lt;style&gt; .parent &#123; display: table; height: 140px; border: 2px dashed #f69c55; &#125; .child &#123; display: table-cell; vertical-align: middle; &#125;&lt;/style&gt; å—çº§å…ƒç´ å‚ç›´å±…ä¸­ â‘  ä½¿ç”¨ absolute+è´Ÿ margin(å·²çŸ¥é«˜åº¦å®½åº¦)é€šè¿‡ç»å¯¹å®šä½å…ƒç´ è·ç¦»é¡¶éƒ¨ 50%ï¼Œå¹¶è®¾ç½® margin-top å‘ä¸Šåç§»å…ƒç´ é«˜åº¦çš„ä¸€åŠï¼Œå°±å¯ä»¥å®ç°äº†ã€‚ 12345&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;å›ºå®šé«˜åº¦çš„å—çº§å…ƒç´ å‚ç›´å±…ä¸­ã€‚&lt;/div&gt;&lt;/div&gt;.parent &#123; position: relative; &#125; .child &#123; position: absolute; top: 50%; height:100px; margin-top: -50px; &#125; â‘¡ ä½¿ç”¨ absolute+transformå½“å‚ç›´å±…ä¸­çš„å…ƒç´ çš„é«˜åº¦å’Œå®½åº¦æœªçŸ¥æ—¶ï¼Œå¯ä»¥å€ŸåŠ© CSS3 ä¸­çš„ transform å±æ€§å‘ Y è½´åå‘åç§» 50%çš„æ–¹æ³•å®ç°å‚ç›´å±…ä¸­ã€‚ä½†æ˜¯éƒ¨åˆ†æµè§ˆå™¨å­˜åœ¨å…¼å®¹æ€§çš„é—®é¢˜ã€‚ 12345&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;æœªçŸ¥é«˜åº¦çš„å—çº§å…ƒç´ å‚ç›´å±…ä¸­ã€‚&lt;/div&gt;&lt;/div&gt;.parent &#123; position: relative; &#125; .child &#123; position: absolute; top: 50%;transform: translateY(-50%); &#125; â‘¢ ä½¿ç”¨ flex+align-itemsé€šè¿‡è®¾ç½® flex å¸ƒå±€ä¸­çš„å±æ€§ align-itemsï¼Œä½¿å­å…ƒç´ å‚ç›´å±…ä¸­ã€‚ 1234&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;æœªçŸ¥é«˜åº¦çš„å—çº§å…ƒç´ å‚ç›´å±…ä¸­ã€‚&lt;/div&gt;&lt;/div&gt;.parent &#123; display:flex; align-items:center; &#125; â‘£ ä½¿ç”¨ table-cell+vertical-aligné€šè¿‡å°†çˆ¶å…ƒç´ è½¬åŒ–ä¸ºä¸€ä¸ªè¡¨æ ¼å•å…ƒæ ¼æ˜¾ç¤ºï¼ˆç±»ä¼¼ å’Œ ï¼‰ï¼Œå†é€šè¿‡è®¾ç½® vertical-align å±æ€§ï¼Œä½¿è¡¨æ ¼å•å…ƒæ ¼å†…å®¹å‚ç›´å±…ä¸­ã€‚ 123456789&lt;div class=\"parent\"&gt; &lt;div class=\"child\"&gt;Demo&lt;/div&gt;&lt;/div&gt;&lt;style&gt; .parent &#123; display: table-cell; vertical-align: middle; &#125;&lt;/style&gt; 3.æ°´å¹³å‚ç›´å±…ä¸­12345678// htmléƒ¨åˆ†(è¿™éƒ¨åˆ†ä¸åšå˜åŒ–,ä¸‹é¢ä¾‹å­ç›´æ¥å…±ç”¨)&lt;body&gt; &lt;div id=\"container\"&gt; &lt;div id=\"center\" style=\"width: 100px;height: 100px;background-color: #666\"&gt; center &lt;/div&gt; &lt;/div&gt;&lt;/body&gt; ç»å¯¹å®šä½ä¸è´Ÿè¾¹è·å®ç°ï¼ˆå·²çŸ¥é«˜åº¦å®½åº¦ï¼‰ è¿™ç§æ–¹å¼éœ€è¦çŸ¥é“è¢«å‚ç›´å±…ä¸­å…ƒç´ çš„é«˜å’Œå®½ï¼Œæ‰èƒ½è®¡ç®—å‡º margin å€¼ï¼Œå…¼å®¹æ‰€æœ‰æµè§ˆå™¨ã€‚ 12345678910// csséƒ¨åˆ†#container &#123; position: relative;&#125;#center &#123; position: absolute; top: 50%; left: 50%; margin: -50px 0 0 -50px;&#125; ç»å¯¹å®šä½ä¸ margin:autoï¼ˆå·²çŸ¥é«˜åº¦å®½åº¦ï¼‰ è¿™ç§æ–¹å¼æ— éœ€çŸ¥é“è¢«å‚ç›´å±…ä¸­å…ƒç´ çš„é«˜å’Œå®½ï¼Œä½†ä¸èƒ½å…¼å®¹ä½ç‰ˆæœ¬çš„ IE æµè§ˆå™¨ã€‚ 123456789101112#container &#123; position: relative; height: 100px; //å¿…é¡»æœ‰ä¸ªé«˜åº¦&#125;#center &#123; position: absolute; top: 0; left: 0; right: 0; bottom: 0; margin: auto; //æ³¨æ„æ­¤å¤„çš„å†™æ³•&#125; ç»å¯¹å®šä½+transform(æœªçŸ¥å…ƒç´ çš„é«˜å®½) åˆ©ç”¨ Css3 çš„ transformï¼Œå¯ä»¥è½»æ¾çš„åœ¨æœªçŸ¥å…ƒç´ çš„é«˜å®½çš„æƒ…å†µä¸‹å®ç°å…ƒç´ çš„å‚ç›´å±…ä¸­ã€‚CSS3 çš„ transform å›ºç„¶å¥½ç”¨ï¼Œä½†åœ¨é¡¹ç›®çš„å®é™…è¿ç”¨ä¸­å¿…é¡»è€ƒè™‘å…¼å®¹é—®é¢˜ï¼Œå¤§é‡çš„ hack ä»£ç å¯èƒ½ä¼šå¯¼è‡´å¾—ä¸å¿å¤±ã€‚ 123456789#container &#123; position: relative;&#125;#center &#123; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);&#125; flex å¸ƒå±€ åˆ©ç”¨ flex å¸ƒå±€ï¼Œå…¶ä¸­ justify-content ç”¨äºè®¾ç½®æˆ–æ£€ç´¢å¼¹æ€§ç›’å­å…ƒç´ åœ¨ä¸»è½´ï¼ˆæ¨ªè½´ï¼‰æ–¹å‘ä¸Šçš„å¯¹é½æ–¹å¼ï¼›è€Œ align-items å±æ€§å®šä¹‰ flex å­é¡¹åœ¨ flex å®¹å™¨çš„å½“å‰è¡Œçš„ä¾§è½´ï¼ˆçºµè½´ï¼‰æ–¹å‘ä¸Šçš„å¯¹é½æ–¹å¼ã€‚ä¸èƒ½å…¼å®¹ä½ç‰ˆæœ¬çš„ IE æµè§ˆå™¨ã€‚ 1234567#container &#123; //ç›´æ¥åœ¨çˆ¶å®¹å™¨è®¾ç½®å³å¯ height: 100vh; //å¿…é¡»æœ‰é«˜åº¦ display: flex; justify-content: center; align-items: center;&#125; flex/grid ä¸ margin:auto(æœ€ç®€å•å†™æ³•) å®¹å™¨å…ƒç´ è®¾ä¸º flex å¸ƒå±€æˆ–æ˜¯ grid å¸ƒå±€ï¼Œå­å…ƒç´ åªè¦å†™ margin: auto å³å¯,ä¸èƒ½å…¼å®¹ä½ç‰ˆæœ¬çš„ IE æµè§ˆå™¨ã€‚ 1234567#container &#123; height: 100vh; //å¿…é¡»æœ‰é«˜åº¦ display: grid;&#125;#center &#123; margin: auto;&#125;","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"å±…ä¸­","slug":"å±…ä¸­","permalink":"http://yoursite.com/tags/å±…ä¸­/"}]},{"title":"CSSå¤šåˆ—å¸ƒå±€","slug":"CSSå¤šåˆ—å¸ƒå±€","date":"2019-05-08T03:25:33.000Z","updated":"2019-11-10T14:37:39.014Z","comments":true,"path":"2019/05/08/CSSå¤šåˆ—å¸ƒå±€/","link":"","permalink":"http://yoursite.com/2019/05/08/CSSå¤šåˆ—å¸ƒå±€/","excerpt":"1.å•åˆ—å¸ƒå±€å¸¸è§çš„å•åˆ—å¸ƒå±€æœ‰ä¸¤ç§ï¼š header,content å’Œ footer ç­‰å®½çš„å•åˆ—å¸ƒå±€ header ä¸ footer ç­‰å®½,content ç•¥çª„çš„å•åˆ—å¸ƒå±€","text":"1.å•åˆ—å¸ƒå±€å¸¸è§çš„å•åˆ—å¸ƒå±€æœ‰ä¸¤ç§ï¼š header,content å’Œ footer ç­‰å®½çš„å•åˆ—å¸ƒå±€ header ä¸ footer ç­‰å®½,content ç•¥çª„çš„å•åˆ—å¸ƒå±€ ç¬¬ä¸€ç§ï¼šå¯¹äºç¬¬ä¸€ç§ï¼Œå…ˆé€šè¿‡å¯¹ header,content,footer ç»Ÿä¸€è®¾ç½® widthï¼š1000px;æˆ–è€… max-widthï¼š1000px(è¿™ä¸¤è€…çš„åŒºåˆ«æ˜¯å½“å±å¹•å°äº 1000px æ—¶ï¼Œå‰è€…ä¼šå‡ºç°æ»šåŠ¨æ¡ï¼Œåè€…åˆ™ä¸ä¼šï¼Œæ˜¾ç¤ºå‡ºå®é™…å®½åº¦);ç„¶åè®¾ç½® margin:auto å®ç°å±…ä¸­å³å¯å¾—åˆ°ã€‚ 123&lt;div class=\"header\"&gt;&lt;/div&gt;&lt;div class=\"content\"&gt;&lt;/div&gt;&lt;div class=\"footer\"&gt;&lt;/div&gt; 123456789101112131415161718.header &#123; margin: 0 auto; max-width: 960px; height: 100px; background-color: blue;&#125;.content &#123; margin: 0 auto; max-width: 960px; height: 400px; background-color: aquamarine;&#125;.footer &#123; margin: 0 auto; max-width: 960px; height: 100px; background-color: aqua;&#125; ç¬¬äºŒç§ï¼šå¯¹äºç¬¬äºŒç§ï¼Œheaderã€footer çš„å†…å®¹å®½åº¦ä¸è®¾ç½®ï¼Œå—çº§å…ƒç´ å……æ»¡æ•´ä¸ªå±å¹•ï¼Œä½† headerã€content å’Œ footer çš„å†…å®¹åŒºè®¾ç½®åŒä¸€ä¸ª widthï¼Œå¹¶é€šè¿‡ margin:auto å®ç°å±…ä¸­ã€‚ 12345&lt;div class=\"header\"&gt; &lt;div class=\"nav\"&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=\"content\"&gt;&lt;/div&gt;&lt;div class=\"footer\"&gt;&lt;/div&gt; 123456789101112131415161718192021222324.header &#123; margin: 0 auto; max-width: 960px; height: 100px; background-color: blue;&#125;.nav &#123; margin: 0 auto; max-width: 800px; background-color: darkgray; height: 50px;&#125;.content &#123; margin: 0 auto; max-width: 800px; height: 400px; background-color: aquamarine;&#125;.footer &#123; margin: 0 auto; max-width: 960px; height: 100px; background-color: aqua;&#125; 2.ä¸¤åˆ—è‡ªé€‚åº”å¸ƒå±€ä¸¤åˆ—è‡ªé€‚åº”å¸ƒå±€æ˜¯æŒ‡ä¸€åˆ—ç”±å†…å®¹æ’‘å¼€ï¼Œå¦ä¸€åˆ—æ’‘æ»¡å‰©ä½™å®½åº¦çš„å¸ƒå±€æ–¹å¼ float+overflow:hiddenå¦‚æœæ˜¯æ™®é€šçš„ä¸¤åˆ—å¸ƒå±€ï¼Œæµ®åŠ¨+æ™®é€šå…ƒç´ çš„ marginä¾¿å¯ä»¥å®ç°ï¼Œä½†å¦‚æœæ˜¯è‡ªé€‚åº”çš„ä¸¤åˆ—å¸ƒå±€ï¼Œåˆ©ç”¨float+overflow:hiddenä¾¿å¯ä»¥å®ç°ï¼Œè¿™ç§åŠæ³•ä¸»è¦é€šè¿‡ overflow è§¦å‘ BFC,è€Œ BFC ä¸ä¼šé‡å æµ®åŠ¨å…ƒç´ ã€‚ç”±äºè®¾ç½® overflow:hidden å¹¶ä¸ä¼šè§¦å‘ IE6-æµè§ˆå™¨çš„ haslayout å±æ€§ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½® zoom:1 æ¥å…¼å®¹ IE6-æµè§ˆå™¨ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š 123456789&lt;div class=\"parent\" style=\"background-color: lightgrey;\"&gt; &lt;div class=\"left\" style=\"background-color: lightblue;\"&gt; &lt;p&gt;left&lt;/p&gt; &lt;/div&gt; &lt;div class=\"right\" style=\"background-color: lightgreen;\"&gt; &lt;p&gt;right&lt;/p&gt; &lt;p&gt;right&lt;/p&gt; &lt;/div&gt;&lt;/div&gt; 123456789101112.parent &#123; overflow: hidden; zoom: 1;&#125;.left &#123; float: left; margin-right: 20px;&#125;.right &#123; overflow: hidden; zoom: 1;&#125; æ³¨æ„ç‚¹:å¦‚æœä¾§è¾¹æ åœ¨å³è¾¹æ—¶ï¼Œæ³¨æ„æ¸²æŸ“é¡ºåºã€‚å³åœ¨ HTML ä¸­ï¼Œå…ˆå†™ä¾§è¾¹æ åå†™ä¸»å†…å®¹ Flex å¸ƒå±€Flex å¸ƒå±€ï¼Œä¹Ÿå«å¼¹æ€§ç›’å­å¸ƒå±€ï¼ŒåŒºåŒºç®€å•å‡ è¡Œä»£ç å°±å¯ä»¥å®ç°å„ç§é¡µé¢çš„çš„å¸ƒå±€ã€‚ 12345678//htmléƒ¨åˆ†åŒä¸Š.parent &#123; display: flex;&#125;.right &#123; margin-left: 20px; flex: 1;&#125; grid å¸ƒå±€Grid å¸ƒå±€ï¼Œæ˜¯ä¸€ä¸ªåŸºäºç½‘æ ¼çš„äºŒç»´å¸ƒå±€ç³»ç»Ÿï¼Œç›®çš„æ˜¯ç”¨æ¥ä¼˜åŒ–ç”¨æˆ·ç•Œé¢è®¾è®¡ã€‚ 123456//htmléƒ¨åˆ†åŒä¸Š.parent &#123; display: grid; grid-template-columns: auto 1fr; grid-gap: 20px;&#125; 3.ä¸‰æ å¸ƒå±€ç‰¹å¾ï¼šä¸­é—´åˆ—è‡ªé€‚åº”å®½åº¦ï¼Œæ—è¾¹ä¸¤ä¾§å›ºå®šå®½åº¦ åœ£æ¯å¸ƒå±€ ç‰¹ç‚¹ æ¯”è¾ƒç‰¹æ®Šçš„ä¸‰æ å¸ƒå±€ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸¤è¾¹å›ºå®šå®½åº¦ï¼Œä¸­é—´è‡ªé€‚åº”ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯ dom ç»“æ„å¿…é¡»æ˜¯å…ˆå†™ä¸­é—´åˆ—éƒ¨åˆ†ï¼Œè¿™æ ·å®ç°ä¸­é—´åˆ—å¯ä»¥ä¼˜å…ˆåŠ è½½ã€‚ 1234567&lt;article class=\"container\"&gt; &lt;div class=\"center\"&gt; &lt;h2&gt;åœ£æ¯å¸ƒå±€&lt;/h2&gt; &lt;/div&gt; &lt;div class=\"left\"&gt;&lt;/div&gt; &lt;div class=\"right\"&gt;&lt;/div&gt;&lt;/article&gt; 12345678910111213141516171819202122232425262728.container &#123; padding-left: 220px; //ä¸ºå·¦å³æ è…¾å‡ºç©ºé—´ padding-right: 220px;&#125;.left &#123; float: left; width: 200px; height: 400px; background: red; margin-left: -100%; position: relative; left: -220px;&#125;.center &#123; float: left; width: 100%; height: 500px; background: yellow;&#125;.right &#123; float: left; width: 200px; height: 400px; background: blue; margin-left: -200px; position: relative; right: -220px;&#125; å®ç°æ­¥éª¤ ä¸‰ä¸ªéƒ¨åˆ†éƒ½è®¾å®šä¸ºå·¦æµ®åŠ¨ï¼Œå¦åˆ™å·¦å³ä¸¤è¾¹å†…å®¹ä¸Šä¸å»ï¼Œå°±ä¸å¯èƒ½ä¸ä¸­é—´åˆ—åŒä¸€è¡Œã€‚ç„¶åè®¾ç½® center çš„å®½åº¦ä¸º 100%(å®ç°ä¸­é—´åˆ—å†…å®¹è‡ªé€‚åº”)ï¼Œæ­¤æ—¶ï¼Œleft å’Œ right éƒ¨åˆ†ä¼šè·³åˆ°ä¸‹ä¸€è¡Œ é€šè¿‡è®¾ç½® margin-left ä¸ºè´Ÿå€¼è®© left å’Œ right éƒ¨åˆ†å›åˆ°ä¸ center éƒ¨åˆ†åŒä¸€è¡Œ é€šè¿‡è®¾ç½®çˆ¶å®¹å™¨çš„ padding-left å’Œ padding-rightï¼Œè®©å·¦å³ä¸¤è¾¹ç•™å‡ºé—´éš™ã€‚ é€šè¿‡è®¾ç½®ç›¸å¯¹å®šä½ï¼Œè®© left å’Œ right éƒ¨åˆ†ç§»åŠ¨åˆ°ä¸¤è¾¹ã€‚ ç¼ºç‚¹ center éƒ¨åˆ†çš„æœ€å°å®½åº¦ä¸èƒ½å°äº left éƒ¨åˆ†çš„å®½åº¦ï¼Œå¦åˆ™ä¼š left éƒ¨åˆ†æ‰åˆ°ä¸‹ä¸€è¡Œ å¦‚æœå…¶ä¸­ä¸€åˆ—å†…å®¹é«˜åº¦æ‹‰é•¿(å¦‚ä¸‹å›¾)ï¼Œå…¶ä»–ä¸¤åˆ—çš„èƒŒæ™¯å¹¶ä¸ä¼šè‡ªåŠ¨å¡«å……ã€‚(å€ŸåŠ©ç­‰é«˜å¸ƒå±€æ­£ padding+è´Ÿ margin å¯è§£å†³ï¼Œä¸‹æ–‡ä¼šä»‹ç») åŒé£ç¿¼å¸ƒå±€ ç‰¹ç‚¹ åŒæ ·ä¹Ÿæ˜¯ä¸‰æ å¸ƒå±€ï¼Œåœ¨åœ£æ¯å¸ƒå±€åŸºç¡€ä¸Šè¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œè§£å†³äº†åœ£æ¯å¸ƒå±€é”™ä¹±é—®é¢˜ï¼Œå®ç°äº†å†…å®¹ä¸å¸ƒå±€çš„åˆ†ç¦»ã€‚è€Œä¸”ä»»ä½•ä¸€æ éƒ½å¯ä»¥æ˜¯æœ€é«˜æ ï¼Œä¸ä¼šå‡ºé—®é¢˜ã€‚ 1234567&lt;article class=\"container\"&gt; &lt;div class=\"center\"&gt; &lt;div class=\"inner\"&gt;åŒé£ç¿¼å¸ƒå±€&lt;/div&gt; &lt;/div&gt; &lt;div class=\"left\"&gt;&lt;/div&gt; &lt;div class=\"right\"&gt;&lt;/div&gt;&lt;/article&gt; 1234567891011121314151617181920212223242526.container &#123; min-width: 600px; //ç¡®ä¿ä¸­é—´å†…å®¹å¯ä»¥æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸¤å€leftå®½+rightå®½&#125;.left &#123; float: left; width: 200px; height: 400px; background: red; margin-left: -100%;&#125;.center &#123; float: left; width: 100%; height: 500px; background: yellow;&#125;.center .inner &#123; margin: 0 200px; //æ–°å¢éƒ¨åˆ†&#125;.right &#123; float: left; width: 200px; height: 400px; background: blue; margin-left: -200px;&#125; å®ç°æ­¥éª¤(å‰ä¸¤æ­¥ä¸åœ£æ¯å¸ƒå±€ä¸€æ ·) ä¸‰ä¸ªéƒ¨åˆ†éƒ½è®¾å®šä¸ºå·¦æµ®åŠ¨ï¼Œç„¶åè®¾ç½® center çš„å®½åº¦ä¸º 100%ï¼Œæ­¤æ—¶ï¼Œleft å’Œ right éƒ¨åˆ†ä¼šè·³åˆ°ä¸‹ä¸€è¡Œï¼› é€šè¿‡è®¾ç½® margin-left ä¸ºè´Ÿå€¼è®© left å’Œ right éƒ¨åˆ†å›åˆ°ä¸ center éƒ¨åˆ†åŒä¸€è¡Œï¼› center éƒ¨åˆ†å¢åŠ ä¸€ä¸ªå†…å±‚ divï¼Œå¹¶è®¾ margin: 0 200pxï¼› ç¼ºç‚¹å¤šåŠ ä¸€å±‚ dom æ ‘èŠ‚ç‚¹ï¼Œå¢åŠ æ¸²æŸ“æ ‘ç”Ÿæˆçš„è®¡ç®—é‡ã€‚ ä¸¤ç§å¸ƒå±€å®ç°æ–¹å¼å¯¹æ¯”: ä¸¤ç§å¸ƒå±€æ–¹å¼éƒ½æ˜¯æŠŠä¸»åˆ—æ”¾åœ¨æ–‡æ¡£æµæœ€å‰é¢ï¼Œä½¿ä¸»åˆ—ä¼˜å…ˆåŠ è½½ã€‚ ä¸¤ç§å¸ƒå±€æ–¹å¼åœ¨å®ç°ä¸Šä¹Ÿæœ‰ç›¸åŒä¹‹å¤„ï¼Œéƒ½æ˜¯è®©ä¸‰åˆ—æµ®åŠ¨ï¼Œç„¶åé€šè¿‡è´Ÿå¤–è¾¹è·å½¢æˆä¸‰åˆ—å¸ƒå±€ã€‚ ä¸¤ç§å¸ƒå±€æ–¹å¼çš„ä¸åŒä¹‹å¤„åœ¨äºå¦‚ä½•å¤„ç†ä¸­é—´ä¸»åˆ—çš„ä½ç½®ï¼šåœ£æ¯å¸ƒå±€æ˜¯åˆ©ç”¨çˆ¶å®¹å™¨çš„å·¦ã€å³å†…è¾¹è·+ä¸¤ä¸ªä»åˆ—ç›¸å¯¹å®šä½ï¼›åŒé£ç¿¼å¸ƒå±€æ˜¯æŠŠä¸»åˆ—åµŒå¥—åœ¨ä¸€ä¸ªæ–°çš„çˆ¶çº§å—ä¸­åˆ©ç”¨ä¸»åˆ—çš„å·¦ã€å³å¤–è¾¹è·è¿›è¡Œå¸ƒå±€è°ƒæ•´ æµ®åŠ¨å¸ƒå±€1234567891011&lt;article class=\"left-right-center\"&gt; &lt;div class=\"left\"&gt;&lt;/div&gt; &lt;div class=\"right\"&gt;&lt;/div&gt; // å³æ éƒ¨åˆ†è¦å†™åœ¨ä¸­é—´å†…å®¹ä¹‹å‰ &lt;div class=\"center\"&gt; &lt;h2&gt;æµ®åŠ¨è§£å†³æ–¹æ¡ˆ&lt;/h2&gt; 1.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 2.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 3.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 4.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 5.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 6.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› &lt;/div&gt;&lt;/article&gt; 12345678910111213.layout.float .left &#123; float: left; width: 300px; background: red;&#125;.layout.float .center &#123; background: yellow;&#125;.layout.float .right &#123; float: right; width: 300px; background: blue;&#125; è¿™ç§å¸ƒå±€æ–¹å¼ï¼Œdom ç»“æ„å¿…é¡»æ˜¯å…ˆå†™æµ®åŠ¨éƒ¨åˆ†ï¼Œç„¶åå†ä¸­é—´å—ï¼Œå¦åˆ™å³æµ®åŠ¨å—ä¼šæ‰åˆ°ä¸‹ä¸€è¡Œã€‚æµ®åŠ¨å¸ƒå±€çš„ä¼˜ç‚¹å°±æ˜¯æ¯”è¾ƒç®€å•ï¼Œå…¼å®¹æ€§ä¹Ÿæ¯”è¾ƒå¥½ã€‚ä½†æµ®åŠ¨å¸ƒå±€æ˜¯æœ‰å±€é™æ€§çš„ï¼Œæµ®åŠ¨å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œè¦åšæ¸…é™¤æµ®åŠ¨ï¼Œè¿™ä¸ªå¤„ç†ä¸å¥½çš„è¯ï¼Œä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚çˆ¶å®¹å™¨é«˜åº¦å¡Œé™·ç­‰ã€‚ ç»å¯¹å¸ƒå±€12345678910&lt;article class=\"left-center-right\"&gt; &lt;div class=\"left\"&gt;&lt;/div&gt; &lt;div class=\"center\"&gt; &lt;h2&gt;ç»å¯¹å®šä½è§£å†³æ–¹æ¡ˆ&lt;/h2&gt; 1.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 2.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 3.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 4.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 5.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 6.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› &lt;/div&gt; &lt;div class=\"right\"&gt;&lt;/div&gt;&lt;/article&gt; 123456789101112131415161718.layout.absolute .left-center-right &gt; div &#123; position: absolute; //ä¸‰å—éƒ½æ˜¯ç»å¯¹å®šä½&#125;.layout.absolute .left &#123; left: 0; width: 300px; background: red;&#125;.layout.absolute .center &#123; right: 300px; left: 300px; //ç¦»å·¦å³å„ä¸‰ç™¾ background: yellow;&#125;.layout.absolute .right &#123; right: 0; width: 300px; background: blue;&#125; ç»å¯¹å®šä½å¸ƒå±€ä¼˜ç‚¹å°±æ˜¯å¿«æ·ï¼Œè®¾ç½®å¾ˆæ–¹ä¾¿ï¼Œè€Œä¸”ä¹Ÿä¸å®¹æ˜“å‡ºé—®é¢˜ã€‚ç¼ºç‚¹å°±æ˜¯ï¼Œå®¹å™¨è„±ç¦»äº†æ–‡æ¡£æµï¼Œåä»£å…ƒç´ ä¹Ÿè„±ç¦»äº†æ–‡æ¡£æµï¼Œé«˜åº¦æœªçŸ¥çš„æ—¶å€™ï¼Œä¼šæœ‰é—®é¢˜ï¼Œè¿™å°±å¯¼è‡´äº†è¿™ç§æ–¹æ³•çš„æœ‰æ•ˆæ€§å’Œå¯ä½¿ç”¨æ€§æ˜¯æ¯”è¾ƒå·®çš„ã€‚ flexbox å¸ƒå±€12345678910&lt;article class=\"left-center-right\"&gt; &lt;div class=\"left\"&gt;&lt;/div&gt; &lt;div class=\"center\"&gt; &lt;h2&gt;flexboxè§£å†³æ–¹æ¡ˆ&lt;/h2&gt; 1.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 2.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 3.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 4.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 5.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 6.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› &lt;/div&gt; &lt;div class=\"right\"&gt;&lt;/div&gt;&lt;/article&gt; 123456789101112131415.layout.flexbox .left-center-right &#123; display: flex;&#125;.layout.flexbox .left &#123; width: 300px; background: red;&#125;.layout.flexbox .center &#123; background: yellow; flex: 1;&#125;.layout.flexbox .right &#123; width: 300px; background: blue;&#125; flexbox å¸ƒå±€æ˜¯ css3 é‡Œæ–°å‡ºçš„ä¸€ä¸ªï¼Œå®ƒå°±æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°ä¸¤ç§æ–¹å¼çš„ä¸è¶³å‡ºç°çš„ï¼Œæ˜¯æ¯”è¾ƒå®Œç¾çš„ä¸€ä¸ªã€‚ç›®å‰ç§»åŠ¨ç«¯çš„å¸ƒå±€ä¹Ÿéƒ½æ˜¯ç”¨ flexboxã€‚ flexbox çš„ç¼ºç‚¹å°±æ˜¯ IE10 å¼€å§‹æ”¯æŒï¼Œä½†æ˜¯ IE10 çš„æ˜¯-ms å½¢å¼çš„ã€‚ è¡¨æ ¼å¸ƒå±€12345678910&lt;article class=\"left-center-right\"&gt; &lt;div class=\"left\"&gt;&lt;/div&gt; &lt;div class=\"center\"&gt; &lt;h2&gt;è¡¨æ ¼å¸ƒå±€è§£å†³æ–¹æ¡ˆ&lt;/h2&gt; 1.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 2.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 3.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 4.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 5.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 6.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› &lt;/div&gt; &lt;div class=\"right\"&gt;&lt;/div&gt;&lt;/article&gt; 12345678910111213141516171819.layout.table .left-center-right &#123; display: table; height: 150px; width: 100%;&#125;.layout.table .left-center-right &gt; div &#123; display: table-cell;&#125;.layout.table .left &#123; width: 300px; background: red;&#125;.layout.table .center &#123; background: yellow;&#125;.layout.table .right &#123; width: 300px; background: blue;&#125; è¡¨æ ¼å¸ƒå±€çš„å…¼å®¹æ€§å¾ˆå¥½(è§ä¸‹å›¾)ï¼Œåœ¨ flex å¸ƒå±€ä¸å…¼å®¹çš„æ—¶å€™ï¼Œå¯ä»¥å°è¯•è¡¨æ ¼å¸ƒå±€ã€‚å½“å†…å®¹æº¢å‡ºæ—¶ä¼šè‡ªåŠ¨æ’‘å¼€çˆ¶å…ƒç´ ã€‚ è¡¨æ ¼å¸ƒå±€ä¹Ÿæ˜¯æœ‰ç¼ºé™·:â‘  æ— æ³•è®¾ç½®æ è¾¹è·ï¼›â‘¡ å¯¹ seo ä¸å‹å¥½ï¼›â‘¢ å½“å…¶ä¸­ä¸€ä¸ªå•å…ƒæ ¼é«˜åº¦è¶…å‡ºçš„æ—¶å€™ï¼Œä¸¤ä¾§çš„å•å…ƒæ ¼ä¹Ÿæ˜¯ä¼šè·Ÿç€ä¸€èµ·å˜é«˜çš„ï¼Œç„¶è€Œæœ‰æ—¶å€™è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚ ç½‘æ ¼å¸ƒå±€12345678910&lt;article class=\"left-center-right\"&gt; &lt;div class=\"left\"&gt;&lt;/div&gt; &lt;div class=\"center\"&gt; &lt;h2&gt;ç½‘æ ¼å¸ƒå±€è§£å†³æ–¹æ¡ˆ&lt;/h2&gt; 1.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 2.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 3.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 4.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 5.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› 6.è¿™æ˜¯ä¸‰æ å¸ƒå±€çš„æµ®åŠ¨è§£å†³æ–¹æ¡ˆï¼› &lt;/div&gt; &lt;div class=\"right\"&gt;&lt;/div&gt;&lt;/article&gt; 123456789101112131415.layout.grid .left-center-right &#123; display: grid; width: 100%; grid-template-columns: 300px auto 300px; grid-template-rows: 150px; //è¡Œé«˜&#125;.layout.grid .left &#123; background: red;&#125;.layout.grid .center &#123; background: yellow;&#125;.layout.grid .right &#123; background: blue;&#125; CSS Grid æ˜¯åˆ›å»ºç½‘æ ¼å¸ƒå±€æœ€å¼ºå¤§å’Œæœ€ç®€å•çš„å·¥å…·ã€‚å°±åƒè¡¨æ ¼ä¸€æ ·ï¼Œç½‘æ ¼å¸ƒå±€å¯ä»¥è®© Web è®¾è®¡å¸ˆæ ¹æ®å…ƒç´ æŒ‰åˆ—æˆ–è¡Œå¯¹é½æ’åˆ—ï¼Œä½†ä»–å’Œè¡¨æ ¼ä¸åŒï¼Œç½‘æ ¼å¸ƒå±€æ²¡æœ‰å†…å®¹ç»“æ„ï¼Œä»è€Œä½¿å„ç§å¸ƒå±€ä¸å¯èƒ½ä¸è¡¨æ ¼ä¸€æ ·ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç½‘æ ¼å¸ƒå±€ä¸­çš„å­å…ƒç´ éƒ½å¯ä»¥å®šä½è‡ªå·±çš„ä½ç½®ï¼Œè¿™æ ·ä»–ä»¬å¯ä»¥é‡å å’Œç±»ä¼¼å…ƒç´ å®šä½ã€‚ ä½†ç½‘æ ¼å¸ƒå±€çš„å…¼å®¹æ€§ä¸å¥½ã€‚IE10+ä¸Šæ”¯æŒï¼Œè€Œä¸”ä¹Ÿä»…æ”¯æŒéƒ¨åˆ†å±æ€§ã€‚ 4.ç­‰é«˜å¸ƒå±€ç­‰é«˜å¸ƒå±€æ˜¯æŒ‡å­å…ƒç´ åœ¨çˆ¶å…ƒç´ ä¸­é«˜åº¦ç›¸ç­‰çš„å¸ƒå±€æ–¹å¼ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»å¸¸è§å‡ ç§å®ç°æ–¹å¼ï¼š åˆ©ç”¨æ­£ padding+è´Ÿ margin æˆ‘ä»¬é€šè¿‡ç­‰é«˜å¸ƒå±€ä¾¿å¯è§£å†³åœ£æ¯å¸ƒå±€çš„ç¬¬äºŒç‚¹ç¼ºç‚¹ï¼Œå› ä¸ºèƒŒæ™¯æ˜¯åœ¨ padding åŒºåŸŸæ˜¾ç¤ºçš„ï¼Œè®¾ç½®ä¸€ä¸ªå¤§æ•°å€¼çš„ padding-bottomï¼Œå†è®¾ç½®ç›¸åŒæ•°å€¼çš„è´Ÿçš„ margin-bottomï¼Œå¹¶åœ¨æ‰€æœ‰åˆ—å¤–é¢åŠ ä¸Šä¸€ä¸ªå®¹å™¨ï¼Œå¹¶è®¾ç½® overflow:hidden æŠŠæº¢å‡ºèƒŒæ™¯åˆ‡æ‰ã€‚è¿™ç§å¯èƒ½å®ç°å¤šåˆ—ç­‰é«˜å¸ƒå±€ï¼Œå¹¶ä¸”ä¹Ÿèƒ½å®ç°åˆ—ä¸åˆ—ä¹‹é—´åˆ†éš”çº¿æ•ˆæœï¼Œç»“æ„ç®€å•ï¼Œå…¼å®¹æ‰€æœ‰æµè§ˆå™¨ã€‚æ–°å¢ä»£ç å¦‚ä¸‹ï¼š 1234567891011.center,.left,.right &#123; padding-bottom: 10000px; margin-bottom: -10000px;&#125;.container &#123; padding-left: 220px; padding-right: 220px; overflow: hidden; //æŠŠæº¢å‡ºèƒŒæ™¯åˆ‡æ‰&#125; åˆ©ç”¨èƒŒæ™¯å›¾ç‰‡ è¿™ç§æ–¹æ³•æ˜¯æˆ‘ä»¬å®ç°ç­‰é«˜åˆ—æœ€æ—©ä½¿ç”¨çš„ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨èƒŒæ™¯å›¾ç‰‡ï¼Œåœ¨åˆ—çš„çˆ¶å…ƒç´ ä¸Šä½¿ç”¨è¿™ä¸ªèƒŒæ™¯å›¾è¿›è¡Œ Y è½´çš„é“ºæ”¾ï¼Œä»è€Œå®ç°ä¸€ç§ç­‰é«˜åˆ—çš„å‡è±¡ã€‚å®ç°æ–¹æ³•ç®€å•ï¼Œå…¼å®¹æ€§å¼ºï¼Œä¸éœ€è¦å¤ªå¤šçš„ css æ ·å¼å°±å¯ä»¥è½»æ¾å®ç°,ä½†æ­¤æ–¹æ³•ä¸é€‚åˆæµä½“å¸ƒå±€ç­‰é«˜åˆ—çš„å¸ƒå±€ã€‚ åœ¨åˆ¶ä½œæ ·å¼ä¹‹å‰éœ€è¦ä¸€å¼ ç±»ä¼¼ä¸‹é¢çš„èƒŒæ™¯å›¾ï¼š 12345&lt;div class=\"â€container\" clearfixâ€&gt; &lt;div class=\"â€leftâ€\"&gt;&lt;/div&gt; &lt;div class=\"â€contentâ€\"&gt;&lt;/div&gt; &lt;div class=\"â€rightâ€\"&gt;&lt;/div&gt;&lt;/div&gt; 1234567891011121314151617.container &#123; background: url(\"column.png\") repeat-y; width: 960px; margin: 0 auto;&#125;.left &#123; float: left; width: 220px;&#125;.content &#123; float: left; width: 480px;&#125;.right &#123; float: left; width: 220px;&#125; æ¨¡ä»¿è¡¨æ ¼å¸ƒå±€ è¿™æ˜¯ä¸€ç§éå¸¸ç®€å•ï¼Œæ˜“äºå®ç°çš„æ–¹æ³•ã€‚ä¸è¿‡å…¼å®¹æ€§ä¸å¥½ï¼Œåœ¨ ie6-7 æ— æ³•æ­£å¸¸è¿è¡Œã€‚ 12345678910111213141516171819&lt;div class=\"container table\"&gt; &lt;div class=\"containerInner tableRow\"&gt; &lt;div class=\"column tableCell cell1\"&gt; &lt;div class=\"left aside\"&gt; .... &lt;/div&gt; &lt;/div&gt; &lt;div class=\"column tableCell cell2\"&gt; &lt;div class=\"content section\"&gt; ... &lt;/div&gt; &lt;/div&gt; &lt;div class=\"column tableCell cell3\"&gt; &lt;div class=\"right aside\"&gt; ... &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; 123456789101112131415161718192021222324.table &#123; width: auto; min-width: 1000px; margin: 0 auto; padding: 0; display: table;&#125;.tableRow &#123; display: table-row;&#125;.tableCell &#123; display: table-cell; width: 33%;&#125;.cell1 &#123; background: #f00; height: 800px;&#125;.cell2 &#123; background: #0f0;&#125;.cell3 &#123; background: #00f;&#125; ä½¿ç”¨è¾¹æ¡†å’Œå®šä½ è¿™ç§æ–¹æ³•æ˜¯ä½¿ç”¨è¾¹æ¡†å’Œç»å¯¹å®šä½æ¥å®ç°ä¸€ä¸ªå‡çš„é«˜åº¦ç›¸ç­‰åˆ—çš„æ•ˆæœã€‚ç»“æ„ç®€å•ï¼Œå…¼å®¹å„æµè§ˆå™¨ï¼Œå®¹æ˜“æŒæ¡ã€‚å‡è®¾ä½ éœ€è¦å®ç°ä¸€ä¸ªä¸¤åˆ—ç­‰é«˜å¸ƒå±€ï¼Œä¾§æ é«˜åº¦è¦å’Œä¸»å†…å®¹é«˜åº¦ç›¸ç­‰ã€‚ 1234&lt;div id=\"wrapper\"&gt; &lt;div id=\"mainContent\"&gt;...&lt;/div&gt; &lt;div id=\"sidebar\"&gt;...&lt;/div&gt;&lt;/div&gt; 123456789101112131415161718#wrapper &#123; width: 960px; margin: 0 auto;&#125;#mainContent &#123; border-right: 220px solid #dfdfdf; position: absolute; width: 740px; height: 800px; background: green;&#125;#sidebar &#123; background: #dfdfdf; margin-left: 740px; position: absolute; height: 800px; width: 220px;&#125; 5.ç²˜è¿å¸ƒå±€ ç‰¹ç‚¹ æœ‰ä¸€å—å†…å®¹&lt;main&gt;ï¼Œå½“&lt;main&gt;çš„é«˜åº·è¶³å¤Ÿé•¿çš„æ—¶å€™ï¼Œç´§è·Ÿåœ¨&lt;main&gt;åé¢çš„å…ƒç´ &lt;footer&gt;ä¼šè·Ÿåœ¨&lt;main&gt;å…ƒç´ çš„åé¢ã€‚ å½“&lt;main&gt;å…ƒç´ æ¯”è¾ƒçŸ­çš„æ—¶å€™(æ¯”å¦‚å°äºå±å¹•çš„é«˜åº¦),æˆ‘ä»¬æœŸæœ›è¿™ä¸ª&lt;footer&gt;å…ƒç´ èƒ½å¤Ÿâ€œç²˜è¿â€åœ¨å±å¹•çš„åº•éƒ¨ å…·ä½“ä»£ç å¦‚ä¸‹ï¼š 12345678&lt;div id=\"wrap\"&gt; &lt;div class=\"main\"&gt; main &lt;br /&gt; main &lt;br /&gt; main &lt;br /&gt; &lt;/div&gt;&lt;/div&gt;&lt;div id=\"footer\"&gt;footer&lt;/div&gt; 123456789101112131415161718192021222324* &#123; margin: 0; padding: 0;&#125;html,body &#123; height: 100%; //é«˜åº¦ä¸€å±‚å±‚ç»§æ‰¿ä¸‹æ¥&#125;#wrap &#123; min-height: 100%; background: pink; text-align: center; overflow: hidden;&#125;#wrap .main &#123; padding-bottom: 50px;&#125;#footer &#123; height: 50px; line-height: 50px; background: deeppink; text-align: center; margin-top: -50px;&#125; å®ç°æ­¥éª¤ footer å¿…é¡»æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç»“æ„ï¼Œä¸ wrap æ²¡æœ‰ä»»ä½•åµŒå¥—å…³ç³» wrap åŒºåŸŸçš„é«˜åº¦é€šè¿‡è®¾ç½® min-heightï¼Œå˜ä¸ºè§†å£é«˜åº¦ footer è¦ä½¿ç”¨ margin ä¸ºè´Ÿæ¥ç¡®å®šè‡ªå·±çš„ä½ç½® åœ¨ main åŒºåŸŸéœ€è¦è®¾ç½® padding-bottomã€‚è¿™ä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢è´Ÿ margin å¯¼è‡´ footer è¦†ç›–ä»»ä½•å®é™…å†…å®¹ã€‚","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"å¸ƒå±€","slug":"å¸ƒå±€","permalink":"http://yoursite.com/tags/å¸ƒå±€/"}]},{"title":"CSSå¸¸ç”¨å¸ƒå±€æ–¹å¼","slug":"CSSå¸¸ç”¨å¸ƒå±€æ–¹å¼","date":"2019-05-02T07:44:43.000Z","updated":"2019-11-10T14:37:39.014Z","comments":true,"path":"2019/05/02/CSSå¸¸ç”¨å¸ƒå±€æ–¹å¼/","link":"","permalink":"http://yoursite.com/2019/05/02/CSSå¸¸ç”¨å¸ƒå±€æ–¹å¼/","excerpt":"CSS å¸¸ç”¨å¸ƒå±€æ–¹å¼1.é™æ€å¸ƒå±€ï¼ˆå›ºå®šå¸ƒå±€ï¼‰å¸ƒå±€ç‰¹ç‚¹ä¸ç®¡æµè§ˆå™¨å°ºå¯¸å…·ä½“æ˜¯å¤šå°‘ï¼Œç½‘é¡µå¸ƒå±€å§‹ç»ˆæŒ‰ç…§æœ€åˆå†™ä»£ç æ—¶çš„å¸ƒå±€æ¥æ˜¾ç¤ºã€‚å¸¸è§„çš„ pc çš„ç½‘ç«™éƒ½æ˜¯é™æ€ï¼ˆå®šå®½åº¦ï¼‰å¸ƒå±€çš„ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®äº† min-widthï¼Œè¿™æ ·çš„è¯ï¼Œå¦‚æœå°äºè¿™ä¸ªå®½åº¦å°±ä¼šå‡ºç°æ»šåŠ¨æ¡ï¼Œå¦‚æœå¤§äºè¿™ä¸ªå®½åº¦åˆ™å†…å®¹å±…ä¸­å¤–åŠ èƒŒæ™¯ï¼Œè¿™ç§è®¾è®¡å¸¸è§äº pc ç«¯ã€‚","text":"CSS å¸¸ç”¨å¸ƒå±€æ–¹å¼1.é™æ€å¸ƒå±€ï¼ˆå›ºå®šå¸ƒå±€ï¼‰å¸ƒå±€ç‰¹ç‚¹ä¸ç®¡æµè§ˆå™¨å°ºå¯¸å…·ä½“æ˜¯å¤šå°‘ï¼Œç½‘é¡µå¸ƒå±€å§‹ç»ˆæŒ‰ç…§æœ€åˆå†™ä»£ç æ—¶çš„å¸ƒå±€æ¥æ˜¾ç¤ºã€‚å¸¸è§„çš„ pc çš„ç½‘ç«™éƒ½æ˜¯é™æ€ï¼ˆå®šå®½åº¦ï¼‰å¸ƒå±€çš„ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®äº† min-widthï¼Œè¿™æ ·çš„è¯ï¼Œå¦‚æœå°äºè¿™ä¸ªå®½åº¦å°±ä¼šå‡ºç°æ»šåŠ¨æ¡ï¼Œå¦‚æœå¤§äºè¿™ä¸ªå®½åº¦åˆ™å†…å®¹å±…ä¸­å¤–åŠ èƒŒæ™¯ï¼Œè¿™ç§è®¾è®¡å¸¸è§äº pc ç«¯ã€‚ è®¾è®¡æ–¹æ³• PCï¼šå±…ä¸­å¸ƒå±€ï¼Œæ‰€æœ‰æ ·å¼ä½¿ç”¨ç»å¯¹å®½åº¦/é«˜åº¦(px)ï¼Œè®¾è®¡ä¸€ä¸ª Layoutï¼Œåœ¨å±å¹•å®½é«˜æœ‰è°ƒæ•´æ—¶ï¼Œä½¿ç”¨æ¨ªå‘å’Œç«–å‘çš„æ»šåŠ¨æ¡æ¥æŸ¥é˜…è¢«é®æ©éƒ¨åˆ†ï¼› 12345.wrap &#123; width: 640px; overflow: hidden; margin: 0 auto;&#125; â€‹ æœ‰å›ºå®šçš„ç‰ˆå‹å¤§å°ï¼Œä¾‹å¦‚ 640pxï¼Œç„¶åè®¾ç½® marginï¼š0 autoï¼›æ¥å±…ä¸­ã€‚å°äº 640 æ—¶å‡ºç°æ»šåŠ¨æ¡ã€‚ ç§»åŠ¨è®¾å¤‡ï¼šå¦å¤–å»ºç«‹ç§»åŠ¨ç½‘ç«™ï¼Œå•ç‹¬è®¾è®¡ä¸€ä¸ªå¸ƒå±€ï¼Œä½¿ç”¨ä¸åŒçš„åŸŸåå¦‚ wap.æˆ– m.ã€‚åœ¨ &lt;viewport meta&gt; æ ‡ç­¾ä¸Šè®¾ç½® widthï¼Œé¡µé¢çš„å„ä¸ªå…ƒç´ ä¹Ÿé‡‡ç”¨pxä½œä¸ºå•ä½ã€‚é€šè¿‡ç”¨ JS åŠ¨æ€ä¿®æ”¹æ ‡ç­¾çš„initial-scaleä½¿å¾—é¡µé¢ç­‰æ¯”ç¼©æ”¾ï¼Œä»è€Œåˆšå¥½å æ»¡æ•´ä¸ªå±å¹•ã€‚ å®ç°æ–¹æ³• æ™®é€š/æ–‡æ¡£æµ å¸ƒå±€ Float å¸ƒå±€ ç»å¯¹å¸ƒå±€ ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šè¿™ç§å¸ƒå±€æ–¹å¼å¯¹è®¾è®¡å¸ˆå’Œ CSS ç¼–å†™è€…æ¥è¯´éƒ½æ˜¯æœ€ç®€å•çš„ï¼Œäº¦æ²¡æœ‰å…¼å®¹æ€§é—®é¢˜ã€‚ ç¼ºç‚¹ï¼šæ˜¾è€Œæ˜“è§ï¼Œä¸èƒ½æ ¹æ®ç”¨æˆ·çš„å±å¹•å°ºå¯¸åšå‡ºä¸åŒçš„å±•ç°ã€‚å½“å‰ï¼Œå¤§éƒ¨åˆ†é—¨æˆ·ç½‘ç«™ã€å¤§éƒ¨åˆ†ä¼ä¸šçš„ PC å®£ä¼ ç«™ç‚¹éƒ½é‡‡ç”¨äº†è¿™ç§å¸ƒå±€æ–¹å¼ã€‚å›ºå®šåƒç´ å°ºå¯¸çš„ç½‘é¡µæ˜¯åŒ¹é…å›ºå®šåƒç´ å°ºå¯¸æ˜¾ç¤ºå™¨çš„æœ€ç®€å•åŠæ³•ã€‚ä½†è¿™ç§æ–¹æ³•ä¸æ˜¯ä¸€ç§å®Œå…¨å…¼å®¹æœªæ¥ç½‘é¡µçš„åˆ¶ä½œæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›é€‚åº”æœªçŸ¥è®¾å¤‡çš„æ–¹æ³•ã€‚ çª„å±å¹•æ»šåŠ¨æ¡ä½“éªŒå¾ˆå·® å®½å±æœ‰å¤§ç‰‡ç©ºç™½ï¼Œä¸åˆ©äºç©ºé—´åˆ©ç”¨ 2.æµå¼å¸ƒå±€æµå¼å¸ƒå±€ï¼ˆLiquidï¼‰çš„ç‰¹ç‚¹ï¼ˆä¹Ÿå«â€Fluidâ€) æ˜¯é¡µé¢å…ƒç´ çš„å®½åº¦æŒ‰ç…§å±å¹•åˆ†è¾¨ç‡è¿›è¡Œé€‚é…è°ƒæ•´ï¼Œä½†æ•´ä½“å¸ƒå±€ä¸å˜ã€‚ä»£è¡¨ä½œæ …æ ç³»ç»Ÿï¼ˆç½‘æ ¼ç³»ç»Ÿï¼‰ã€‚ç½‘é¡µä¸­ä¸»è¦çš„åˆ’åˆ†åŒºåŸŸçš„å°ºå¯¸ä½¿ç”¨ç™¾åˆ†æ•°ï¼ˆæ­é… min-ã€max-å±æ€§ä½¿ç”¨ï¼‰ï¼Œä¾‹å¦‚ï¼Œè®¾ç½®ç½‘é¡µä¸»ä½“çš„å®½åº¦ä¸º 80%ï¼Œmin-width ä¸º 960pxã€‚å›¾ç‰‡ä¹Ÿä½œç±»ä¼¼å¤„ç†ï¼ˆwidth:100%, max-width ä¸€èˆ¬è®¾å®šä¸ºå›¾ç‰‡æœ¬èº«çš„å°ºå¯¸ï¼Œé˜²æ­¢è¢«æ‹‰ä¼¸è€Œå¤±çœŸï¼‰ã€‚ å¸ƒå±€ç‰¹ç‚¹å±å¹•åˆ†è¾¨ç‡å˜åŒ–æ—¶ï¼Œé¡µé¢é‡Œå…ƒç´ çš„å¤§å°ä¼šå˜åŒ–è€Œä½†å¸ƒå±€ä¸å˜ã€‚ã€è¿™å°±å¯¼è‡´å¦‚æœå±å¹•å¤ªå¤§æˆ–è€…å¤ªå°éƒ½ä¼šå¯¼è‡´å…ƒç´ æ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚ è®¾è®¡æ–¹æ³•ä½¿ç”¨%ç™¾åˆ†æ¯”å®šä¹‰å®½åº¦ï¼Œè€Œé«˜åº¦å¤§éƒ½æ˜¯ç”¨ px æ¥å›ºå®šä½ï¼Œå¯ä»¥æ ¹æ®å¯è§†åŒºåŸŸ (viewport) å’Œçˆ¶å…ƒç´ çš„å®æ—¶å°ºå¯¸è¿›è¡Œè°ƒæ•´ï¼Œå°½å¯èƒ½çš„é€‚åº”å„ç§åˆ†è¾¨ç‡ã€‚å¾€å¾€é…åˆ max-width/min-width ç­‰å±æ€§æ§åˆ¶å°ºå¯¸æµåŠ¨èŒƒå›´ä»¥å…è¿‡å¤§æˆ–è€…è¿‡å°å½±å“é˜…è¯»ã€‚ è¿™ç§å¸ƒå±€æ–¹å¼åœ¨ Web å‰ç«¯å¼€å‘çš„æ—©æœŸå†å²ä¸Šï¼Œç”¨æ¥åº”å¯¹ä¸åŒå°ºå¯¸çš„ PC å±å¹•ï¼ˆé‚£æ—¶å±å¹•å°ºå¯¸çš„å·®å¼‚ä¸ä¼šå¤ªå¤§ï¼‰ï¼Œåœ¨å½“ä»Šçš„ç§»åŠ¨ç«¯å¼€å‘ä¹Ÿæ˜¯å¸¸ç”¨å¸ƒå±€æ–¹å¼ã€‚æµå¼å¸ƒå±€ç›®çš„æ˜¯åœ¨ä¸åŒå¤§å°çš„è®¾å¤‡ä¸Šæ»¡å±å‘ˆç°åŒæ ·ç½‘é¡µã€‚å®ƒæ˜¯ç”¨äºè§£å†³ç±»ä¼¼çš„è®¾å¤‡ä¸åŒåˆ†è¾¨ç‡ä¹‹é—´çš„å…¼å®¹(ä¸€èˆ¬åˆ†è¾¨ç‡å·®å¼‚è¾ƒå°‘)ã€‚ ç™¾åˆ†æ¯”èƒ½å¤Ÿè®¾ç½®çš„å±æ€§æ˜¯ widthã€heightã€paddingã€marginã€‚å…¶ä»–å±æ€§æ¯”å¦‚ borderã€font-size ä¸èƒ½ç”¨ç™¾åˆ†æ¯”è®¾ç½®çš„ã€‚ å¦‚æœç”¨ç™¾åˆ†æ¯”å†™ widthï¼Œé‚£ä¹ˆæŒ‡çš„æ˜¯çˆ¶å…ƒç´  width çš„ç™¾åˆ†ä¹‹å¤šå°‘ã€‚ å¦‚æœç”¨ç™¾åˆ†æ¯”å†™ heightï¼Œé‚£ä¹ˆæŒ‡çš„æ˜¯çˆ¶å…ƒç´  height çš„ç™¾åˆ†ä¹‹å¤šå°‘ã€‚ å¦‚æœç”¨ç™¾åˆ†æ¯”å†™ paddingï¼Œé‚£ä¹ˆæŒ‡çš„æ˜¯*çˆ¶å…ƒç´  width *çš„ç™¾åˆ†ä¹‹å¤šå°‘ï¼Œæ— è®ºæ˜¯æ°´å¹³çš„ padding è¿˜æ˜¯ç«–ç›´çš„ paddingã€‚ å¦‚æœç”¨ç™¾åˆ†æ¯”å†™ marginï¼Œé‚£ä¹ˆæŒ‡çš„æ˜¯çˆ¶å…ƒç´  width çš„ç™¾åˆ†ä¹‹å¤šå°‘ï¼Œæ— è®ºæ˜¯æ°´å¹³çš„ margin è¿˜æ˜¯ç«–ç›´çš„ marginã€‚ ä¸èƒ½ç”¨ç™¾åˆ†æ¯”å†™ border çš„å®½åº¦ å®ç°æ–¹æ³• å…è®¸ç½‘é¡µå®½åº¦è‡ªåŠ¨è°ƒæ•´ï¼š&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt; ä¸ä½¿ç”¨ç»å¯¹å°ºå¯¸ï¼ˆåŒ…æ‹¬å®¹å™¨/å­—ä½“/å›¾ç‰‡ï¼‰ï¼Œä½¿ç”¨ç™¾åˆ†æ¯”ã€emã€remã€vwã€vh ç­‰ å¯ä½¿ç”¨ flex ç­‰å¼¹æ€§ç›’å­ï¼ˆä¸è¦ä½¿ç”¨ px å®šå°ºå¯¸ï¼‰ ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šé¡µé¢å·¦å³æ»¡å±ã€‚ ä½†ç¼ºç‚¹æ˜æ˜¾ï¼š ä¸»è¦çš„é—®é¢˜**æ˜¯å¦‚æœå±å¹•å°ºåº¦è·¨åº¦å¤ªå¤§ï¼Œé‚£ä¹ˆåœ¨ç›¸å¯¹å…¶åŸå§‹è®¾è®¡è€Œè¨€è¿‡å°æˆ–è¿‡å¤§çš„å±å¹•ä¸Šä¸èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚å› ä¸ºå®½åº¦ä½¿ç”¨%ç™¾åˆ†æ¯”å®šä¹‰ï¼Œä½†æ˜¯é«˜åº¦å’Œæ–‡å­—å¤§å°ç­‰å¤§éƒ½æ˜¯ç”¨ px æ¥å›ºå®šï¼Œæ‰€ä»¥åœ¨å¤§å±å¹•çš„æ‰‹æœºä¸‹æ˜¾ç¤ºæ•ˆæœä¼šå˜æˆæœ‰äº›é¡µé¢å…ƒç´ å®½åº¦è¢«æ‹‰çš„å¾ˆé•¿ï¼Œä½†æ˜¯é«˜åº¦ã€æ–‡å­—å¤§å°è¿˜æ˜¯å’ŒåŸæ¥ä¸€æ ·ï¼ˆå³ï¼Œè¿™äº›ä¸œè¥¿æ— æ³•å˜å¾—â€œæµå¼â€ï¼‰ï¼Œæ˜¾ç¤ºéå¸¸ä¸åè°ƒ ä½¿ç”¨ç™¾åˆ†æ¯”å®šä¹‰ï¼Œæ‰€ä»¥åœ¨å¤§å±å¹•çš„æ‰‹æœº/Pad ä¸‹ï¼ˆæˆ–è€…æ¨ªå±ä¸‹ï¼‰æ˜¾ç¤ºæ•ˆæœä¼šå˜æˆæœ‰äº›é¡µé¢å…ƒç´ è¢«æ‹‰çš„å¾ˆå¤§ï¼Œä½†æ˜¯å†…å®¹æ•°é‡å´ä¸å˜ï¼Œæ˜¾å¾—ç¨€ç–ä¸ç´§å‡‘ï¼Œç©ºé—´åˆ©ç”¨ç‡ä½ä¸‹ã€‚ å¦‚æœæ–‡å­—ä¹ŸæŒ‰ç…§ç™¾åˆ†æ¯”æ”¾å¤§ï¼Œåˆ™æ•´ä½“æ•ˆæœä¼šéå¸¸ä¸åè°ƒï¼ˆè€äººæœºæ•ˆæœï¼‰ã€‚ ä¾‹å­https://www.trip.com/flightsh5/status/ 3.è‡ªé€‚åº”å¸ƒå±€è‡ªé€‚åº”å¸ƒå±€çš„ç‰¹ç‚¹æ˜¯åˆ†åˆ«ä¸ºä¸åŒçš„å±å¹•åˆ†è¾¨ç‡å®šä¹‰å¸ƒå±€ï¼Œå³åˆ›å»ºå¤šä¸ªé™æ€å¸ƒå±€ï¼Œæ¯ä¸ªé™æ€å¸ƒå±€å¯¹åº”ä¸€ä¸ªå±å¹•åˆ†è¾¨ç‡èŒƒå›´ã€‚æ”¹å˜å±å¹•åˆ†è¾¨ç‡å¯ä»¥åˆ‡æ¢ä¸åŒçš„é™æ€å±€éƒ¨ï¼ˆé¡µé¢å…ƒç´ ä½ç½®å‘ç”Ÿæ”¹å˜ï¼‰ï¼Œä½†åœ¨æ¯ä¸ªé™æ€å¸ƒå±€ä¸­ï¼Œé¡µé¢å…ƒç´ ä¸éšçª—å£å¤§å°çš„è°ƒæ•´å‘ç”Ÿå˜åŒ–ã€‚å¯ä»¥æŠŠè‡ªé€‚åº”å¸ƒå±€çœ‹ä½œæ˜¯é™æ€å¸ƒå±€çš„ä¸€ä¸ªåˆé›†ã€‚ å¸ƒå±€ç‰¹ç‚¹å±å¹•åˆ†è¾¨ç‡å˜åŒ–æ—¶ï¼Œé¡µé¢é‡Œé¢å…ƒç´ çš„ä½ç½®ä¼šå˜åŒ–è€Œå¤§å°ä¸ä¼šå˜åŒ–ã€‚ è®¾è®¡æ–¹æ³•ä½¿ç”¨ @media åª’ä½“æŸ¥è¯¢ç»™ä¸åŒå°ºå¯¸å’Œä»‹è´¨çš„è®¾å¤‡åˆ‡æ¢ä¸åŒçš„æ ·å¼ã€‚åœ¨ä¼˜ç§€çš„å“åº”èŒƒå›´è®¾è®¡ä¸‹å¯ä»¥ç»™é€‚é…èŒƒå›´å†…çš„è®¾å¤‡æœ€å¥½çš„ä½“éªŒï¼Œåœ¨åŒä¸€ä¸ªè®¾å¤‡ä¸‹å®é™…è¿˜æ˜¯å›ºå®šçš„å¸ƒå±€ã€‚ å®ç°æ–¹å¼ é™æ€å¸ƒå±€æ–¹æ³• åˆ†è¾¨ç‡ detectorï¼ˆmedia query/server-side detector/UAï¼‰ ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šè‡ªé€‚åº”å¸ƒå±€é¡µé¢é‡Œé¢å…ƒç´ çš„ä½ç½®ä¼šå˜åŒ–ï¼Œå¾ˆå¥½çš„è§£å†³äº†æµå¼å¸ƒå±€ä¸­çš„å¤§å±ç©ºé—´åˆ©ç”¨ç‡ä¸é«˜å¼Šç«¯ã€‚ ç¼ºç‚¹ï¼šå•ä¸ªå¸ƒå±€å®¹å™¨æ— æ³•çµæ´»ä¼¸ç¼©ï¼Œæœªè§¦å‘å¸ƒå±€åˆ‡æ¢çš„æƒ…å†µä¸‹ï¼Œå®¹å™¨ä»ç„¶å®¹æ˜“å‡ºç°é™æ€å¸ƒå±€ä¸­æåˆ°çš„é—®é¢˜ã€‚ ä¾‹å­www.baidu.com/ è‡ªé€‚åº”è®¾è®¡ï¼ˆAWDï¼‰è‡ªé€‚åº”è®¾è®¡æ˜¯é€šè¿‡æœåŠ¡ç«¯æ£€æµ‹è®¾å¤‡ç±»å‹ã€ä» site çš„ä¸åŒç‰ˆæœ¬ä¸­é€‰æ‹©æœ€åˆé€‚è¯¥è®¾å¤‡ç±»å‹çš„è®¾è®¡å¸ƒå±€/å°ºå¯¸çš„ç‰ˆæœ¬è¿›è¡Œå±•ç¤ºã€‚å®ƒå¯ä»¥ä½¿ç”¨åˆ°æ‰€æœ‰ï¼ˆåŒ…æ‹¬å“åº”å¼å¸ƒå±€ï¼‰å¸ƒå±€æ–¹æ¡ˆã€‚ å®ç°æ–¹å¼ï¼š server-side detection different versions to different devices å¯¹äº PC: å¯ä½¿ç”¨æµå¼å¸ƒå±€ï¼› å¯¹äº Mobile: å¯ä½¿ç”¨æµå¼å¸ƒå±€ã€‚æ¨èä¸€ä¸ª Rem è§£å†³æ–¹æ¡ˆï¼š è®¾ç½®å…ƒç´ ï¼ˆå¯ä»¥åŒ…æ‹¬å­—ä½“ç­‰ï¼‰å¤§å°ä¸º rem ï¼ˆrem æ˜¯ä»¥è·Ÿå…ƒç´ font-sizeä¸ºåŸºå‡†çš„å•ä½ï¼‰ æŒ‰ç…§å±å¹•å®½åº¦çš„ä¸åŒï¼ŒJS åŠ¨æ€è®¾ç½® &lt;html&gt; çš„ font-size å¤§å°ï¼Œå…ƒç´ åŒæ ·ä¼šæŒ‰ç…§å±å¹•å®½åº¦ç­‰æ¯”ä¾‹æ”¾å¤§ç¼©å° ä¸¾ä¸ªæ —å­ï¼šwww.trip.com/ 4.å“åº”å¼å¸ƒå±€ï¼ˆåª’ä½“æŸ¥è¯¢ï¼‰éšç€ CSS3 å‡ºç°äº†åª’ä½“æŸ¥è¯¢æŠ€æœ¯ï¼Œåˆå‡ºç°äº†å“åº”å¼è®¾è®¡çš„æ¦‚å¿µã€‚å“åº”å¼è®¾è®¡çš„ç›®æ ‡æ˜¯ç¡®ä¿ä¸€ä¸ªé¡µé¢åœ¨æ‰€æœ‰ç»ˆç«¯ä¸Šï¼ˆå„ç§å°ºå¯¸çš„ PCã€æ‰‹æœºã€æ‰‹è¡¨ã€å†°ç®±çš„ Web æµè§ˆå™¨ç­‰ç­‰ï¼‰éƒ½èƒ½æ˜¾ç¤ºå‡ºä»¤äººæ»¡æ„çš„æ•ˆæœï¼Œå¯¹ CSS ç¼–å†™è€…è€Œè¨€ï¼Œåœ¨å®ç°ä¸Šä¸æ‹˜æ³¥äºå…·ä½“æ‰‹æ³•ï¼Œä½†é€šå¸¸æ˜¯ç³…åˆäº†æµå¼å¸ƒå±€+å¼¹æ€§å¸ƒå±€ï¼Œå†æ­é…åª’ä½“æŸ¥è¯¢æŠ€æœ¯ä½¿ç”¨ã€‚â€”â€”åˆ†åˆ«ä¸ºä¸åŒçš„å±å¹•åˆ†è¾¨ç‡å®šä¹‰å¸ƒå±€ï¼ŒåŒæ—¶ï¼Œåœ¨æ¯ä¸ªå¸ƒå±€ä¸­ï¼Œåº”ç”¨æµå¼å¸ƒå±€çš„ç†å¿µï¼Œå³é¡µé¢å…ƒç´ å®½åº¦éšç€çª—å£è°ƒæ•´è€Œè‡ªåŠ¨é€‚é…ã€‚å³ï¼šåˆ›å»ºå¤šä¸ªæµä½“å¼å¸ƒå±€ï¼Œåˆ†åˆ«å¯¹åº”ä¸€ä¸ªå±å¹•åˆ†è¾¨ç‡èŒƒå›´ã€‚æ”¹å˜å±å¹•åˆ†è¾¨ç‡å¯ä»¥é€šè¿‡ CSS Media query å®æ—¶åœ°åˆ‡æ¢ä¸åŒçš„å¸ƒå±€ï¼ˆé¡µé¢å…ƒç´ ä½ç½®å¯èƒ½å‘ç”Ÿæ”¹å˜ï¼‰ï¼Œåœ¨æ¯ä¸ªå¸ƒå±€ä¸­ï¼Œé¡µé¢å…ƒç´ ä¼šéšçª—å£å¤§å°çš„è°ƒæ•´å‘ç”Ÿæµå¼å¸ƒå±€ä¸­çš„è‡ªåŠ¨å°ºå¯¸å˜åŒ–ã€‚å¯ä»¥æŠŠå“åº”å¼å¸ƒå±€çœ‹ä½œæ˜¯æµå¼å¸ƒå±€å’Œè‡ªé€‚åº”å¸ƒå±€è®¾è®¡ç†å¿µçš„èåˆã€‚ å“åº”å¼å‡ ä¹å·²ç»æˆä¸ºä¼˜ç§€é¡µé¢å¸ƒå±€çš„æ ‡å‡†ã€‚ å¸ƒå±€ç‰¹ç‚¹æ¯ä¸ªå±å¹•åˆ†è¾¨ç‡ä¸‹é¢ä¼šæœ‰ä¸€ä¸ªå¸ƒå±€æ ·å¼ï¼Œå³å…ƒç´ ä½ç½®å’Œå¤§å°éƒ½ä¼šå˜ã€‚ è®¾è®¡æ–¹æ³•åª’ä½“æŸ¥è¯¢+æµå¼å¸ƒå±€ã€‚é€šå¸¸ä½¿ç”¨ @media åª’ä½“æŸ¥è¯¢å’Œç½‘æ ¼ç³»ç»Ÿ (Grid System) é…åˆç›¸å¯¹å¸ƒå±€å•ä½è¿›è¡Œå¸ƒå±€ï¼Œå®é™…ä¸Šå°±æ˜¯ç»¼åˆå“åº”å¼ã€æµåŠ¨ç­‰ä¸Šè¿°æŠ€æœ¯é€šè¿‡ CSS ç»™å•ä¸€ç½‘é¡µä¸åŒè®¾å¤‡è¿”å›ä¸åŒæ ·å¼çš„æŠ€æœ¯ç»Ÿç§°ã€‚ å®ç°æ–¹å¼ æµå¼å¸ƒå±€ CSS media query ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šé€‚åº” pc å’Œç§»åŠ¨ç«¯ï¼Œå¦‚æœè¶³å¤Ÿè€å¿ƒï¼Œæ•ˆæœå®Œç¾ã€‚èåˆäº†æµå¼å¸ƒå±€å’Œè‡ªé€‚åº”å¸ƒå±€çš„ä¼˜åŠ¿ã€‚ ç¼ºç‚¹ï¼š åª’ä½“æŸ¥è¯¢æ˜¯æœ‰é™çš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥æšä¸¾å‡ºæ¥çš„ï¼Œåªèƒ½é€‚åº”ä¸»æµçš„å®½é«˜ã€‚ è¦åŒ¹é…è¶³å¤Ÿå¤šçš„å±å¹•å¤§å°ï¼Œå·¥ä½œé‡ä¸å°ï¼Œè®¾è®¡ä¹Ÿéœ€è¦å¤šä¸ªç‰ˆæœ¬ã€‚ CSS ä»£ç ç¹çï¼Œå¯¹äºç‰¹å®šçš„è®¾å¤‡æœ‰è¾ƒå¤šå†—ä½™ï¼Œé€‚ç”¨äºå¯¹äºå„ä¸ªç»ˆç«¯ï¼ˆç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯ï¼‰æ€§èƒ½è¦æ±‚ä¸é«˜çš„ Blog Dos ç«™ç‚¹ã€‚ å“åº”å¼é¡µé¢åœ¨å¤´éƒ¨ä¼šåŠ ä¸Šè¿™ä¸€æ®µä»£ç ï¼š 12&lt;meta name=\"applicable-device\" content=\"pc,mobile\" /&gt;&lt;meta http-equiv=\"Cache-Control\" content=\"no-transform \" /&gt; ä¾‹å­elevenbeans.github.io/ å“åº”å¼è®¾è®¡ï¼ˆRWDï¼‰å“åº”å¼è®¾è®¡åŸºäºå“åº”å¼å¸ƒå±€ï¼Œä½¿ç”¨åŒä¸€å¥—é¡µé¢åœ¨å„ç§å„æ ·ä¸åŒå¤§å°çš„è®¾å¤‡ä¸Šè¿›è¡Œå¤§å°åˆé€‚ã€å¸ƒå±€ï¼ˆç”šè‡³åŠŸèƒ½ï¼‰åˆç†çš„å±•ç°ã€‚ å“åº”å¼è®¾è®¡ä¼šæ ¹æ®è¯†åˆ«å±å¹•å®½åº¦å¯¹äºå±•ç¤ºçš„å…·ä½“å†…å®¹å—è¿›è¡Œä½ç½®è°ƒæ•´ï¼Œç”šè‡³å±•ç¤ºå’Œéšè—ã€‚ å®ç°æ–¹å¼ï¼š å“åº”å¼å¸ƒå±€ ç‰¹æ€§æ£€æµ‹ ï¼ˆç”¨äºç½‘é¡µåŠŸèƒ½çš„æ¸è¿›å¢å¼ºï¼‰ ä¸¾ä¸ªæ —å­ï¼šelevenbeans.github.io/ï¼Œ RWD å’Œ AWD çš„å¼‚åŒç›¸åŒç‚¹ï¼š å‡é’ˆå¯¹ä¸åŒçš„åˆ†è¾¨ç‡/device é‡‡ç”¨ä¸åŒçš„æ ·å¼å’Œå¸ƒå±€è¾¾åˆ°é¡µé¢å±•ç¤ºæœ€ä¼˜ å¸ƒå±€æ–¹å¼æœ¬è´¨æ²¡æœ‰å·®åˆ«ï¼ˆAWD ä¹Ÿ including responsive layoutï¼‰ ä¸åŒç‚¹ï¼š å‰è€…å¼ºè°ƒåŒä¸€å¥—é¡µé¢å¤šç«¯å…¼å®¹å±•ç¤ºï¼Œè€Œåè€…ç»™å‡ºå¤šå¥—é¡µé¢ï¼Œå¯¹äºä¸åŒ device è¿›è¡Œäº†åˆ†ç±»å¤„ç† å‰è€…æ˜¯é€šè¿‡ CSS Media query è¿›è¡Œåˆ†è¾¨ç‡æ£€æµ‹ï¼Œå¯ä»¥å®æ—¶çš„å“åº”æµè§ˆå™¨å°ºå¯¸å˜åŒ–ï¼Œæ”¹å˜å…ƒç´ å°ºå¯¸/å¸ƒå±€ï¼Œè€Œåè€…ä¸€èˆ¬æ˜¯ server side detectionï¼Œä¸€æ¬¡æ€§æ¸²æŸ“æ—¢å®šå¸ƒå±€å’Œæ ·å¼ åª’ä½“æŸ¥è¯¢ç”¨æ³• å¼€å§‹åœ¨ html ä¸­å†™å…¥ Media åœ¨ html å¤´éƒ¨æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œç”¨æ¥æ˜¾ç¤ºå…¼å®¹ç§»åŠ¨è®¾å¤‡çš„æ˜¾ç¤ºæ•ˆæœ 1234&lt;meta name=\"viewport\" content=\"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no\"/&gt; å‚æ•°è¯¦è§£ï¼š width=device-width ï¼šå®½åº¦ç­‰äºå½“å‰è®¾å¤‡çš„å®½åº¦ initial-scale=1 ï¼šåˆå§‹çš„ç¼©æ”¾æ¯”ä¾‹ã€‚ï¼ˆé»˜è®¤ä¸º 1ï¼‰ minimum-scale=1 ï¼šå…è®¸ç”¨æˆ·ç¼©æ”¾åˆ°çš„æœ€å°æ¯”ä¾‹ã€‚ï¼ˆé»˜è®¤ä¸º 1ï¼‰ maximum-scale=1 ï¼šå…è®¸ç”¨æˆ·ç¼©æ”¾åˆ°çš„æœ€å¤§æ¯”ä¾‹ã€‚ï¼ˆé»˜è®¤ä¸º 1ï¼‰ user-scalable=no ï¼šç”¨æˆ·æ˜¯å¦å¯ä»¥æ‰‹åŠ¨ç¼©æ”¾ï¼ˆé»˜è®¤ä¸º noï¼‰ å¼•å…¥åŒ…å« Media çš„ css æ–‡ä»¶æˆ‘ä»¬åœ¨åª’ä½“æŸ¥è¯¢å¤–é¢å†™çš„ç¬¬ä¸€æ¡è§„åˆ™ï¼Œæ˜¯â€œåŸºæœ¬çš„â€æ ·å¼ï¼Œå®ƒé€‚ç”¨äºä»»ä½•è®¾å¤‡ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å†ä¸ºä¸åŒè§†å£ã€ä¸åŒèƒ½åŠ›çš„è®¾å¤‡ï¼Œæ¸è¿›å¢åŠ ä¸åŒçš„è§†è§‰æ•ˆæœå’ŒåŠŸèƒ½ã€‚(IE6ã€7ã€8 ä¸æ”¯æŒåª’ä½“æŸ¥è¯¢ï¼Œä¹Ÿä¸ºäº†é˜²æ­¢æ‰‹æœºç«¯çš„æŸäº›æµè§ˆå™¨ä¸æ”¯æŒåª’ä½“æŸ¥è¯¢ï¼Œæ‰€ä»¥ä¸è¦æŠŠæ‰€æœ‰çš„é€‰æ‹©å™¨éƒ½æ”¾åœ¨åª’ä½“æŸ¥è¯¢é‡Œé¢ã€‚) 123456789101112131415161718body &#123; background-color: grey;&#125;@media screen and (min-width: 1200px) &#123; body &#123; background-color: pink; &#125;&#125;@media screen and (min-width: 700px) and (max-width: 1200px) &#123; body &#123; background-color: blue; &#125;&#125;@media screen and (max-width: 700px) &#123; body &#123; background-color: orange; &#125;&#125; åª’ä½“ç±»å‹ å€¼ æè¿° all ç”¨äºæ‰€æœ‰è®¾å¤‡ aural å·²åºŸå¼ƒã€‚ç”¨äºè¯­éŸ³å’Œå£°éŸ³åˆæˆå™¨ braille å·²åºŸå¼ƒã€‚ åº”ç”¨äºç›²æ–‡è§¦æ‘¸å¼åé¦ˆè®¾å¤‡ embossed å·²åºŸå¼ƒã€‚ ç”¨äºæ‰“å°çš„ç›²äººå°åˆ·è®¾å¤‡ handheld å·²åºŸå¼ƒã€‚ ç”¨äºæŒä¸Šè®¾å¤‡æˆ–æ›´å°çš„è£…ç½®ï¼Œå¦‚ PDA å’Œå°å‹ç”µè¯ print ç”¨äºæ‰“å°æœºå’Œæ‰“å°é¢„è§ˆ projection å·²åºŸå¼ƒã€‚ ç”¨äºæŠ•å½±è®¾å¤‡ screen ç”¨äºç”µè„‘å±å¹•ï¼Œå¹³æ¿ç”µè„‘ï¼Œæ™ºèƒ½æ‰‹æœºç­‰ã€‚ speech åº”ç”¨äºå±å¹•é˜…è¯»å™¨ç­‰å‘å£°è®¾å¤‡ tty å·²åºŸå¼ƒã€‚ ç”¨äºå›ºå®šçš„å­—ç¬¦ç½‘æ ¼ï¼Œå¦‚ç”µæŠ¥ã€ç»ˆç«¯è®¾å¤‡å’Œå¯¹å­—ç¬¦æœ‰é™åˆ¶çš„ä¾¿æºè®¾å¤‡ tv å·²åºŸå¼ƒã€‚ ç”¨äºç”µè§†å’Œç½‘ç»œç”µè§† é€»è¾‘æ“ä½œç¬¦ andæ“ä½œç¬¦ç”¨æ¥æŠŠå¤šä¸ªåª’ä½“å±æ€§ç»„åˆæˆä¸€æ¡åª’ä½“æŸ¥è¯¢ï¼Œå¯¹æˆé“¾å¼çš„ç‰¹å¾è¿›è¡Œè¯·æ±‚ï¼Œåªæœ‰å½“æ¯ä¸ªå±æ€§éƒ½ä¸ºçœŸæ—¶ï¼Œç»“æœæ‰ä¸ºçœŸã€‚ notæ“ä½œç¬¦ç”¨æ¥å¯¹ä¸€æ¡åª’ä½“æŸ¥è¯¢çš„ç»“æœè¿›è¡Œå–åã€‚ onlyæ“ä½œç¬¦ä»…åœ¨åª’ä½“æŸ¥è¯¢åŒ¹é…æˆåŠŸçš„æƒ…å†µä¸‹è¢«ç”¨äºåº”ç”¨ä¸€ä¸ªæ ·å¼ï¼Œè¿™å¯¹äºé˜²æ­¢è®©é€‰ä¸­çš„æ ·å¼åœ¨è€å¼æµè§ˆå™¨ä¸­è¢«åº”ç”¨åˆ°ã€‚ ä¹Ÿå¯ä»¥å°†å¤šä¸ªåª’ä½“æŸ¥è¯¢ä»¥é€—å·åˆ†éš”æ”¾åœ¨ä¸€èµ·ï¼›åªè¦å…¶ä¸­ä»»ä½•ä¸€ä¸ªä¸ºçœŸï¼Œæ•´ä¸ªåª’ä½“è¯­å¥å°±è¿”å›çœŸã€‚ç›¸å½“äºoræ“ä½œç¬¦ã€‚ è‹¥ä½¿ç”¨äº†notæˆ–onlyæ“ä½œç¬¦ï¼Œå¿…é¡»æ˜ç¡®æŒ‡å®šä¸€ä¸ªåª’ä½“ç±»å‹ã€‚ åª’ä½“åŠŸèƒ½ å€¼ æè¿° å€¼ åª’ä½“ æ˜¯å¦æ¥å— min/max å‰ç¼€ aspect-ratio å®šä¹‰è¾“å‡ºè®¾å¤‡ä¸­çš„é¡µé¢å¯è§åŒºåŸŸå®½åº¦ä¸é«˜åº¦çš„æ¯”ç‡ visual/tactile æ˜¯ color å®šä¹‰è¾“å‡ºè®¾å¤‡æ¯ä¸€ç»„å½©è‰²åŸä»¶çš„ä¸ªæ•°ã€‚å¦‚æœä¸æ˜¯å½©è‰²è®¾å¤‡ï¼Œåˆ™å€¼ç­‰äº 0 visual æ˜¯ color-index å®šä¹‰åœ¨è¾“å‡ºè®¾å¤‡çš„å½©è‰²æŸ¥è¯¢è¡¨ä¸­çš„æ¡ç›®æ•°ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨å½©è‰²æŸ¥è¯¢è¡¨ï¼Œåˆ™å€¼ç­‰äº 0 visual æ˜¯ device-aspect-ratio å®šä¹‰è¾“å‡ºè®¾å¤‡çš„å±å¹•å¯è§å®½åº¦ä¸é«˜åº¦çš„æ¯”ç‡ã€‚ visual/tactile æ˜¯ device-height å®šä¹‰è¾“å‡ºè®¾å¤‡çš„å±å¹•å¯è§é«˜åº¦ã€‚ visual/tactile æ˜¯ device-width å®šä¹‰è¾“å‡ºè®¾å¤‡çš„å±å¹•å¯è§å®½åº¦ã€‚ visual/tactile æ˜¯ grid ç”¨æ¥æŸ¥è¯¢è¾“å‡ºè®¾å¤‡æ˜¯å¦ä½¿ç”¨æ …æ ¼æˆ–ç‚¹é˜µã€‚ all å¦ height å®šä¹‰è¾“å‡ºè®¾å¤‡ä¸­çš„é¡µé¢å¯è§åŒºåŸŸé«˜åº¦ã€‚ visual/tactile æ˜¯ monochrome å®šä¹‰åœ¨ä¸€ä¸ªå•è‰²æ¡†æ¶ç¼“å†²åŒºä¸­æ¯åƒç´ åŒ…å«çš„å•è‰²åŸä»¶ä¸ªæ•°ã€‚å¦‚æœä¸æ˜¯å•è‰²è®¾å¤‡ï¼Œåˆ™å€¼ç­‰äº 0 visual æ˜¯ orientation å®šä¹‰è¾“å‡ºè®¾å¤‡ä¸­çš„é¡µé¢å¯è§åŒºåŸŸé«˜åº¦æ˜¯å¦å¤§äºæˆ–ç­‰äºå®½åº¦ã€‚ landscape` `portrait visual resolution å®šä¹‰è®¾å¤‡çš„åˆ†è¾¨ç‡ã€‚å¦‚ï¼š96dpi, 300dpi, 118dpcm bitmap æ˜¯ scan å®šä¹‰ç”µè§†ç±»è®¾å¤‡çš„æ‰«æå·¥åºã€‚ progressive` `interlace tv width å®šä¹‰è¾“å‡ºè®¾å¤‡ä¸­çš„é¡µé¢å¯è§åŒºåŸŸå®½åº¦ã€‚ visual/tactile æ˜¯ 5.å¼¹æ€§å¸ƒå±€ï¼ˆflexï¼‰Flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸ºâ€å¼¹æ€§å¸ƒå±€â€ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§ã€‚å¼•å…¥å¼¹æ€§ç›’å¸ƒå±€æ¨¡å‹çš„ç›®çš„æ˜¯æä¾›ä¸€ç§æ›´åŠ æœ‰æ•ˆçš„æ–¹å¼æ¥å¯¹ä¸€ä¸ªå®¹å™¨ä¸­çš„å­å…ƒç´ è¿›è¡Œæ’åˆ—ã€å¯¹é½å’Œåˆ†é…ç©ºç™½ç©ºé—´ï¼ˆä»–ä¼šæ ¹æ®é¡µé¢çš„å‰©ä½™å®½åº¦è‡ªåŠ¨åˆ†é…ç©ºé—´ï¼‰ã€‚ é‡‡ç”¨ Flex å¸ƒå±€çš„å…ƒç´ ï¼Œç§°ä¸º Flex å®¹å™¨ï¼ˆflex containerï¼‰ï¼Œç®€ç§°â€å®¹å™¨â€ã€‚å®ƒçš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œç§°ä¸º Flex é¡¹ç›®ï¼ˆflex itemï¼‰ï¼Œç®€ç§°â€é¡¹ç›®â€ã€‚ å®¹å™¨é»˜è®¤å­˜åœ¨ä¸¤æ ¹è½´ï¼šæ°´å¹³çš„ä¸»è½´ï¼ˆmain axisï¼‰å’Œå‚ç›´çš„äº¤å‰è½´ï¼ˆcross axisï¼‰ã€‚ä¸»è½´çš„å¼€å§‹ä½ç½®ï¼ˆä¸è¾¹æ¡†çš„äº¤å‰ç‚¹ï¼‰å«åšmain startï¼Œç»“æŸä½ç½®å«åšmain endï¼›äº¤å‰è½´çš„å¼€å§‹ä½ç½®å«åšcross startï¼Œç»“æŸä½ç½®å«åšcross endã€‚ é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æ’åˆ—ã€‚å•ä¸ªé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´å«åšmain sizeï¼Œå æ®çš„äº¤å‰è½´ç©ºé—´å«åšcross sizeã€‚ å®¹å™¨çš„å±æ€§åŸºæœ¬è¯­æ³•ï¼š 123.box &#123; display: flex; /* æˆ–è€… inline-flex */&#125; ä¸Šè¿°å†™æ³•ï¼Œå®šä¹‰äº†ä¸€ä¸ª flex å®¹å™¨ï¼Œæ ¹æ®è®¾å€¼çš„ä¸åŒå¯ä»¥æ˜¯å—çŠ¶å®¹å™¨æˆ–å†…è”å®¹å™¨ã€‚è¿™ä½¿å¾—ç›´æ¥å­ç»“ç‚¹æ‹¥æœ‰äº†ä¸€ä¸ª flex ä¸Šä¸‹æ–‡ã€‚ flex-direction flex-wrap flex-flow justify-content align-items align-content 1.flex-directionå±æ€§å†³å®šä¸»è½´çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æ’åˆ—æ–¹å‘ï¼‰ã€‚ rowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚ row-reverseï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚ columnï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚ column-reverseï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚ 2.flex-wrapé»˜è®¤æƒ…å†µä¸‹ï¼Œé¡¹ç›®éƒ½æ’åœ¨ä¸€æ¡çº¿ï¼ˆåˆç§°â€è½´çº¿â€ï¼‰ä¸Šã€‚flex-wrapå±æ€§å®šä¹‰ï¼Œå¦‚æœä¸€æ¡è½´çº¿æ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œã€‚ nowrapï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œã€‚ wrapï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹ã€‚ wrap-reverseï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ã€‚ 3.flex-flowflex-flowå±æ€§æ˜¯flex-directionå±æ€§å’Œflex-wrapå±æ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸ºrow nowrapã€‚ 123.box &#123; flex-flow: &lt;flex-direction&gt; || &lt;flex-wrap&gt;;&#125; 4.justify-contentå®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚ flex-startï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½ flex-endï¼šå³å¯¹é½ centerï¼š å±…ä¸­ space-betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚ space-aroundï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚ 5.align-itemså®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½ã€‚ flex-startï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚ flex-endï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚ centerï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚ baseline: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚ stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸º autoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚ 6.align-contentå®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚ flex-startï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚ flex-endï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚ centerï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚ space-betweenï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚ space-aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚ stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚ é¡¹ç›®çš„å±æ€§ order flex-grow flex-shrink flex-basis flex align-self 1.orderå®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º 0ã€‚ 123.item &#123; order: &lt;integer&gt;;&#125; 2.flex-growå®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚ å¦‚æœæ‰€æœ‰é¡¹ç›®çš„flex-growå±æ€§éƒ½ä¸º 1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-growå±æ€§ä¸º 2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º 1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ã€‚ 3.flex-shrinkå®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚ å¦‚æœæ‰€æœ‰é¡¹ç›®çš„flex-shrinkå±æ€§éƒ½ä¸º 1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±æ€§ä¸º 0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º 1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚ è´Ÿå€¼å¯¹è¯¥å±æ€§æ— æ•ˆã€‚ 4.flex-basiså®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ï¼ˆmain sizeï¼‰ã€‚æµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±æ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®çš„æœ¬æ¥å¤§å°ã€‚ å®ƒå¯ä»¥è®¾ä¸ºè·Ÿwidthæˆ–heightå±æ€§ä¸€æ ·çš„å€¼ï¼ˆæ¯”å¦‚ 350pxï¼‰ï¼Œåˆ™é¡¹ç›®å°†å æ®å›ºå®šç©ºé—´ã€‚ 5.flexflexå±æ€§æ˜¯flex-grow, flex-shrink å’Œ flex-basisçš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚åä¸¤ä¸ªå±æ€§å¯é€‰ã€‚ è¯¥å±æ€§æœ‰ä¸¤ä¸ªå¿«æ·å€¼ï¼šauto (1 1 auto) å’Œ none (0 0 auto)ã€‚ å»ºè®®ä¼˜å…ˆä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œè€Œä¸æ˜¯å•ç‹¬å†™ä¸‰ä¸ªåˆ†ç¦»çš„å±æ€§ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šæ¨ç®—ç›¸å…³å€¼ã€‚ 6.align-selfå…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸å…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–align-itemså±æ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºstretchã€‚ è¯¥å±æ€§å¯èƒ½å– 6 ä¸ªå€¼ï¼Œé™¤äº† autoï¼Œå…¶ä»–éƒ½ä¸ align-items å±æ€§å®Œå…¨ä¸€è‡´ã€‚ 123.item &#123; align-self: auto | flex-start | flex-end | center | baseline | stretch;&#125; å…¼å®¹æ€§ Chrome Safari Firefox Opera IE Android iOS 21+ 6.1+ 22+ 12.1+ 11+ 4.4+ 7.1+ Flexbox éœ€è¦ä¸€äº›ç‰¹å®šçš„å‰ç¼€ä»¥æ”¯æŒå¤§å¤šæ•°çš„æµè§ˆå™¨ã€‚ç”šè‡³è¿˜å­˜åœ¨å®Œå…¨ä¸åŒçš„å±æ€§åç§°æˆ–å±æ€§å€¼ã€‚è¿™å°±éœ€è¦Autoprefixeræˆ–ç±»ä¼¼çš„ CSS åå¤„ç†å™¨çš„è¾…åŠ©ï¼Œå…·ä½“å†…å®¹è¯·å‚è€ƒç›¸å…³æ–‡æ¡£ã€‚ 6.REM å¸ƒå±€rem/em åŒºåˆ«rem:å½“å‰é¡µé¢ä¸­å…ƒç´ çš„ REM å•ä½çš„æ ·å¼å€¼éƒ½æ˜¯é’ˆå¯¹äº HTML å…ƒç´ çš„ font-size çš„å€¼è¿›è¡ŒåŠ¨æ€è®¡ç®—çš„ em:è¡¨ç¤ºçˆ¶å…ƒç´ çš„å­—å·çš„å€æ•°ã€‚(ç‰¹ä¾‹ï¼šåœ¨ text-indent å±æ€§ä¸­ï¼Œè¡¨ç¤ºæ–‡å­—å®½åº¦)em å•ä½ä¸ä»…ä»…å¯ä»¥ç”¨æ¥è®¾ç½®å­—å·ï¼Œè¿˜å¯ä»¥è®¾ç½®ä»»ä½•ç›’æ¨¡å‹çš„å±æ€§ï¼Œæ¯”å¦‚ widthã€heightã€paddingã€marginã€borderã€‚ rem ä½œç”¨äºéæ ¹å…ƒç´ æ—¶ï¼Œç›¸å¯¹äºæ ¹å…ƒç´ å­—ä½“å¤§å°ï¼›rem ä½œç”¨äºæ ¹å…ƒç´ å­—ä½“å¤§å°æ—¶ï¼Œç›¸å¯¹äºå…¶å‡ºåˆå§‹å­—ä½“å¤§å°ï¼ˆ16pxï¼‰ã€‚ rem æœ‰ä¸€ç‚¹ä¼˜åŠ¿å°±æ˜¯å¯ä»¥å’Œåª’ä½“æŸ¥è¯¢é…åˆï¼Œå®ç°å“åº”å¼å¸ƒå±€ï¼š ä½¿ç”¨ em æˆ– rem å•ä½è¿›è¡Œç›¸å¯¹å¸ƒå±€ï¼Œç›¸å¯¹%ç™¾åˆ†æ¯”æ›´åŠ çµæ´»ï¼ŒåŒæ—¶å¯ä»¥æ”¯æŒæµè§ˆå™¨çš„å­—ä½“å¤§å°è°ƒæ•´å’Œç¼©æ”¾ç­‰çš„æ­£å¸¸æ˜¾ç¤ºï¼Œå› ä¸º em æ˜¯ç›¸å¯¹çˆ¶çº§å…ƒç´ çš„åŸå› æ²¡æœ‰å¾—åˆ°æ¨å¹¿ã€‚ã€ä¸­å›½ç«™ç‚¹åˆ¶ä½œç½‘é¡µçš„æ—¶å€™ï¼Œä¹ æƒ¯ç”¨ CSS å¼ºåˆ¶å®šä¹‰å­—ä½“å¤§å°ï¼Œä¿è¯æ¯ä¸ªäººéƒ½çœ‹åˆ°ä¸€è‡´çš„æ•ˆæœï¼ŒåŒ…æ‹¬ç½‘æ˜“ã€æœç‹è¿™äº›é—¨æˆ·ç½‘ç«™åœ¨å†…çš„å¤§éƒ¨åˆ†ç«™ç‚¹ï¼Œç”¨çš„éƒ½æ˜¯ç»å¯¹å•ä½ pxï¼ˆåƒç´ ï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœä»ç½‘ç«™æ˜“ç”¨æ€§æ–¹é¢è€ƒè™‘ï¼Œå­—ä½“å¤§å°åº”è¯¥æ˜¯å¯å˜çš„ï¼Œä¸€äº›è§†åŠ›ä¸æ˜¯é‚£ä¹ˆå¥½çš„äººéœ€è¦æ”¾å¤§å­—ä½“æ‰èƒ½çœ‹å¾—æ¸…é¡µé¢å†…å®¹ã€‚ç„¶è€Œï¼Œå æ®å¤§éƒ¨åˆ†æµè§ˆå™¨å¸‚åœºçš„ IE æ— æ³•è°ƒæ•´é‚£äº›ä½¿ç”¨ px ä½œä¸ºå•ä½çš„å­—ä½“å¤§å°ã€‚å›½å¤–äººå£«éå¸¸é‡è§†ç½‘ç«™çš„æ˜“ç”¨æ€§ï¼Œç›¸å½“ä¸€éƒ¨åˆ†å¤–å›½ç«™ç‚¹å·²ç»ä½¿ç”¨ em ä½œä¸ºå­—ä½“å•ä½ã€‚ å¸ƒå±€ç‰¹ç‚¹åŒ…è£¹æ–‡å­—çš„å„å…ƒç´ çš„å°ºå¯¸é‡‡ç”¨ em/rem åšå•ä½ï¼Œè€Œé¡µé¢çš„ä¸»è¦åˆ’åˆ†åŒºåŸŸçš„å°ºå¯¸ä»ä½¿ç”¨ç™¾åˆ†æ•°æˆ– px åšå•ä½ï¼ˆåŒã€Œæµå¼å¸ƒå±€ã€æˆ–ã€Œé™æ€/å›ºå®šå¸ƒå±€ã€ï¼‰ã€‚æ—©æœŸæµè§ˆå™¨ä¸æ”¯æŒæ•´ä¸ªé¡µé¢æŒ‰æ¯”ä¾‹ç¼©æ”¾ï¼Œä»…æ”¯æŒç½‘é¡µå†…æ–‡å­—å°ºå¯¸çš„æ”¾å¤§ï¼Œè¿™ç§æƒ…å†µä¸‹ã€‚ä½¿ç”¨ em/rem åšå•ä½ï¼Œå¯ä»¥ä½¿åŒ…è£¹æ–‡å­—çš„å…ƒç´ éšç€æ–‡å­—çš„ç¼©æ”¾è€Œç¼©æ”¾ã€‚ æµè§ˆå™¨çš„é»˜è®¤å­—ä½“é«˜åº¦ä¸€èˆ¬ä¸º16pxï¼Œå³ 1em:16pxï¼Œä½†æ˜¯ 1:16 çš„æ¯”ä¾‹ä¸æ–¹ä¾¿è®¡ç®—ï¼Œä¸ºäº†ä½¿å•ä½ em/rem æ›´ç›´è§‚ï¼ŒCSS ç¼–å†™è€…å¸¸å¸¸å°†é¡µé¢è·ŸèŠ‚ç‚¹å­—ä½“è®¾ä¸º 62.5%ï¼Œæ¯”å¦‚é€‰æ‹©ç”¨ rem æ§åˆ¶å­—ä½“æ—¶ï¼Œå…ˆéœ€è¦è®¾ç½®æ ¹èŠ‚ç‚¹ html çš„å­—ä½“å¤§å°ï¼Œå› ä¸ºæµè§ˆå™¨é»˜è®¤å­—ä½“å¤§å° 16px*62.5%=10pxã€‚è¿™æ · 1rem ä¾¿æ˜¯ 10pxï¼Œæ–¹ä¾¿äº†è®¡ç®—ã€‚ è®¾è®¡æ€æƒ³ ä¸€èˆ¬ä¸è¦ç»™å…ƒç´ è®¾ç½®å…·ä½“çš„å®½åº¦,ä½†æ˜¯å¯¹äºä¸€äº›å°å›¾æ ‡å¯ä»¥è®¾å®šå…·ä½“å®½åº¦å€¼ é«˜åº¦å€¼å¯ä»¥è®¾ç½®å›ºå®šå€¼,è®¾è®¡ç¨¿æœ‰å¤šå¤§,æˆ‘ä»¬å°±ä¸¥æ ¼å†™å¤šå¤§ æ‰€æœ‰è®¾ç½®çš„å›ºå®šå€¼éƒ½ç”¨ REM åšå•ä½(é¦–å…ˆåœ¨ HTML ä¸­è®¾ç½®ä¸€ä¸ªåŸºå‡†å€¼ï¼šPX å’Œ REM çš„å¯¹åº”æ¯”ä¾‹,ç„¶ååœ¨æ•ˆæœå›¾ä¸Šè·å– PX å€¼,å¸ƒå±€çš„æ—¶å€™è½¬åŒ–ä¸º REM å€¼) JS è·å–çœŸå®å±å¹•çš„å®½åº¦,è®©å…¶é™¤ä»¥è®¾è®¡ç¨¿çš„å®½åº¦,ç®—å‡ºæ¯”ä¾‹,æŠŠä¹‹å‰çš„åŸºå‡†å€¼æŒ‰ç…§æ¯”ä¾‹è¿›è¡Œé‡æ–°çš„è®¾å®š,è¿™æ ·é¡¹ç›®å°±å¯ä»¥åœ¨ç§»åŠ¨ç«¯è‡ªé€‚åº”äº† ä¼˜ç‚¹æ›´èƒ½é€‚åº”ç¼©è¿›/ä»¥å­—ä½“å•ä½ padding æˆ– marginï¼æµè§ˆå™¨è®¾ç½®å­—ä½“å°ºå¯¸ç­‰æƒ…å†µï¼ˆå› ä¸º em/rem ç›¸å¯¹äºå­—ä½“å¤§å°ï¼Œä¼šåŒæ­¥æ”¹å˜ï¼‰ã€‚ä¾‹å¦‚ï¼šp{ text-indent: 2em; }ã€‚ 123p &#123; text-indent: 2em;&#125; rem å•ä½å¯¹äºï¼ˆæ ¹æ®å±å¹•å°ºå¯¸ï¼‰è°ƒæ•´é¡µé¢çš„å„å…ƒç´ çš„å°ºå¯¸ã€æ–‡å­—å¤§å°æ—¶æ¯”è¾ƒå¥½ç”¨ Rem å¸ƒå±€çš„ js å®ç°1234// pxè½¬remï¼Œæ–¹ä¾¿æ¨¡æ‹Ÿå°ç¨‹åº rpxpx2rem($px) &#123; $px / 750 * 10 * 1rem;&#125; 123456789101112131415161718192021222324252627282930313233343536if remlayout script. (function flexible (window, document) &#123; var docEl = document.documentElement var dpr = window.devicePixelRatio || 1 function setBodyFontSize () &#123; if (document.body) &#123; document.body.style.fontSize = (12 * dpr) + 'px' &#125; else &#123; document.addEventListener('DOMContentLoaded', setBodyFontSize) &#125; &#125; setBodyFontSize() function setRemUnit () &#123; var rem = docEl.clientWidth / 10 docEl.style.fontSize = rem + 'px' &#125; setRemUnit() window.addEventListener('resize', setRemUnit) window.addEventListener('pageshow', function (e) &#123; if (e.persisted) &#123; setRemUnit() &#125; &#125;) if (dpr &gt;= 2) &#123; var fakeBody = document.createElement('body') var testElement = document.createElement('div') testElement.style.border = '.5px solid transparent' fakeBody.appendChild(testElement) docEl.appendChild(fakeBody) if (testElement.offsetHeight === 1) &#123; docEl.classList.add('hairlines') &#125; docEl.removeChild(fakeBody) &#125; &#125;(window, document)) å¯¹æ¯”ä¸‰ç§æ–¹å¼ï¼ˆå“åº”å¼&amp;&amp;REM&amp;&amp;viewportï¼‰å“åº”å¼çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šå…¼å®¹æ€§å¥½ï¼Œ@media åœ¨ ie9 ä»¥ä¸Šæ˜¯æ”¯æŒçš„ï¼ŒPC å’Œ MOBILE æ˜¯åŒä¸€å¥—ä»£ç çš„ï¼Œä¸ç”¨åˆ†å¼€ã€‚ ç¼ºç‚¹ï¼šè¦å†™å¾— css ç›¸å¯¹å¦å¤–ä¸¤ä¸ªå¤šå¾ˆå¤šï¼Œè€Œä¸”å„ä¸ªæ–­ç‚¹éƒ½è¦åšå¥½ã€‚css æ ·å¼ä¼šç¨å¾®å¤§ç‚¹ï¼Œæ›´éº»çƒ¦ã€‚ REM ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šèƒ½ç»´æŒèƒ½æ•´ä½“çš„å¸ƒå±€æ•ˆæœï¼Œç§»åŠ¨ç«¯å…¼å®¹æ€§å¥½ï¼Œä¸ç”¨å†™å¤šä¸ª css ä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥åˆ©ç”¨@media è¿›è¡Œä¼˜åŒ–ã€‚ ç¼ºç‚¹ï¼šå¼€å¤´è¦å¼•å…¥ä¸€æ®µ js ä»£ç ï¼Œå•ä½éƒ½è¦æ”¹æˆ rem(font-size å¯ä»¥ç”¨ px)ï¼Œè®¡ç®— rem æ¯”è¾ƒéº»çƒ¦(å¯ä»¥å¼•ç”¨é¢„å¤„ç†å™¨ï¼Œä½†æ˜¯å¢åŠ äº†ç¼–è¯‘è¿‡ç¨‹ï¼Œç›¸å¯¹éº»çƒ¦äº†ç‚¹)ã€‚pc å’Œ mobile è¦åˆ†å¼€ã€‚ è®¾ç½® viewport ä¸­çš„ width1&lt;meta name=\"viewport\" content=\"width=750\" /&gt; ä¼˜ç‚¹ï¼šå’Œ REM ç›¸åŒï¼Œè€Œä¸”ä¸ç”¨å†™ remï¼Œç›´æ¥ä½¿ç”¨ pxï¼Œæ›´åŠ å¿«æ·ã€‚ ç¼ºç‚¹ï¼šæ•ˆæœå¯èƒ½æ²¡ rem çš„å¥½ï¼Œå›¾ç‰‡å¯èƒ½ä¼šç›¸å¯¹æ¨¡ç³Šï¼Œè€Œä¸”æ— æ³•ä½¿ç”¨@media è¿›è¡Œæ–­ç‚¹ï¼Œä¸åŒ size çš„æ‰‹æœºä¸Šæ˜¾ç¤ºï¼Œé«˜åº¦é—´è·å¯èƒ½ä¼šç›¸å·®å¾ˆå¤§ã€‚ 7.Grid å¸ƒå±€ï¼ˆBOOTSTRAP å¸ƒå±€ï¼‰ç½‘æ ¼å¸ƒå±€ï¼ˆGridï¼‰æ˜¯æœ€å¼ºå¤§çš„ CSS å¸ƒå±€æ–¹æ¡ˆã€‚ å®ƒå°†ç½‘é¡µåˆ’åˆ†æˆä¸€ä¸ªä¸ªç½‘æ ¼ï¼Œå¯ä»¥ä»»æ„ç»„åˆä¸åŒçš„ç½‘æ ¼ï¼Œåšå‡ºå„ç§å„æ ·çš„å¸ƒå±€ã€‚ä»¥å‰ï¼Œåªèƒ½é€šè¿‡å¤æ‚çš„ CSS æ¡†æ¶è¾¾åˆ°çš„æ•ˆæœï¼Œç°åœ¨æµè§ˆå™¨å†…ç½®äº†ã€‚ Flex å¸ƒå±€æ˜¯è½´çº¿å¸ƒå±€ï¼Œåªèƒ½æŒ‡å®šâ€é¡¹ç›®â€é’ˆå¯¹è½´çº¿çš„ä½ç½®ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç»´å¸ƒå±€ã€‚Grid å¸ƒå±€åˆ™æ˜¯å°†å®¹å™¨åˆ’åˆ†æˆâ€è¡Œâ€å’Œâ€åˆ—â€ï¼Œäº§ç”Ÿå•å…ƒæ ¼ï¼Œç„¶åæŒ‡å®šâ€é¡¹ç›®æ‰€åœ¨â€çš„å•å…ƒæ ¼ï¼Œå¯ä»¥çœ‹ä½œæ˜¯äºŒç»´å¸ƒå±€ã€‚Grid å¸ƒå±€è¿œæ¯” Flex å¸ƒå±€å¼ºå¤§ã€‚ é‡‡ç”¨ç½‘æ ¼å¸ƒå±€çš„åŒºåŸŸï¼Œç§°ä¸ºâ€å®¹å™¨â€ï¼ˆcontainerï¼‰ã€‚å®¹å™¨å†…éƒ¨é‡‡ç”¨ç½‘æ ¼å®šä½çš„å­å…ƒç´ ï¼Œç§°ä¸ºâ€é¡¹ç›®â€ï¼ˆitemï¼‰ã€‚å®¹å™¨é‡Œé¢çš„æ°´å¹³åŒºåŸŸç§°ä¸ºâ€è¡Œâ€ï¼ˆrowï¼‰ï¼Œå‚ç›´åŒºåŸŸä¸ºâ€åˆ—â€ï¼ˆcolumnï¼‰ã€‚è¡Œå’Œåˆ—çš„äº¤å‰åŒºåŸŸï¼Œç§°ä¸ºâ€å•å…ƒæ ¼â€ï¼ˆcellï¼‰ã€‚åˆ’åˆ†ç½‘æ ¼çš„çº¿ï¼Œç§°ä¸ºâ€ç½‘æ ¼çº¿â€ï¼ˆgrid lineï¼‰ã€‚æ°´å¹³ç½‘æ ¼çº¿åˆ’åˆ†å‡ºè¡Œï¼Œå‚ç›´ç½‘æ ¼çº¿åˆ’åˆ†å‡ºåˆ—ã€‚ å®¹å™¨çš„å±æ€§1.displaydisplay: gridæŒ‡å®šä¸€ä¸ªå®¹å™¨é‡‡ç”¨ç½‘æ ¼å¸ƒå±€ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¹å™¨å…ƒç´ éƒ½æ˜¯å—çº§å…ƒç´ ï¼Œä½†ä¹Ÿå¯ä»¥è®¾æˆè¡Œå†…å…ƒç´ ã€‚display: inline-grid; æ³¨æ„ï¼Œè®¾ä¸ºç½‘æ ¼å¸ƒå±€ä»¥åï¼Œå®¹å™¨å­å…ƒç´ ï¼ˆé¡¹ç›®ï¼‰çš„floatã€display: inline-blockã€display: table-cellã€vertical-alignå’Œcolumn-*ç­‰è®¾ç½®éƒ½å°†å¤±æ•ˆã€‚ 2.grid-template-columns å±æ€§ï¼Œ grid-template-rows å±æ€§å®¹å™¨æŒ‡å®šäº†ç½‘æ ¼å¸ƒå±€ä»¥åï¼Œæ¥ç€å°±è¦åˆ’åˆ†è¡Œå’Œåˆ—ã€‚grid-template-columnså±æ€§å®šä¹‰æ¯ä¸€åˆ—çš„åˆ—å®½ï¼Œgrid-template-rowså±æ€§å®šä¹‰æ¯ä¸€è¡Œçš„è¡Œé«˜ã€‚ 12345.container &#123; display: grid; grid-template-columns: 100px 100px 100px; grid-template-rows: 100px 100px 100px;&#125; é™¤äº†ä½¿ç”¨ç»å¯¹å•ä½ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç™¾åˆ†æ¯” repeat()ï¼šæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é‡å¤çš„æ¬¡æ•°ï¼ˆä¸Šä¾‹æ˜¯ 3ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦é‡å¤çš„å€¼ã€‚é‡å¤æŸç§æ¨¡å¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ 1grid-template-columns: repeat(2, 100px 20px 80px); auto-fill å…³é”®å­—ï¼šæœ‰æ—¶ï¼Œå•å…ƒæ ¼çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯å®¹å™¨çš„å¤§å°ä¸ç¡®å®šã€‚å¦‚æœå¸Œæœ›æ¯ä¸€è¡Œï¼ˆæˆ–æ¯ä¸€åˆ—ï¼‰å®¹çº³å°½å¯èƒ½å¤šçš„å•å…ƒæ ¼ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨auto-fillå…³é”®å­—è¡¨ç¤ºè‡ªåŠ¨å¡«å……ã€‚ 1234.container &#123; display: grid; grid-template-columns: repeat(auto-fill, 100px);&#125; fr å…³é”®å­—ï¼šä¸ºäº†æ–¹ä¾¿è¡¨ç¤ºæ¯”ä¾‹å…³ç³»ï¼Œç½‘æ ¼å¸ƒå±€æä¾›äº†frå…³é”®å­—ï¼ˆfraction çš„ç¼©å†™ï¼Œæ„ä¸ºâ€ç‰‡æ®µâ€ï¼‰ã€‚å¦‚æœä¸¤åˆ—çš„å®½åº¦åˆ†åˆ«ä¸º1frå’Œ2frï¼Œå°±è¡¨ç¤ºåè€…æ˜¯å‰è€…çš„ä¸¤å€ã€‚ï¼ˆfrå¯ä»¥ä¸ç»å¯¹é•¿åº¦çš„å•ä½ç»“åˆä½¿ç”¨ï¼‰ minmax()ï¼šminmax()å‡½æ•°äº§ç”Ÿä¸€ä¸ªé•¿åº¦èŒƒå›´ï¼Œè¡¨ç¤ºé•¿åº¦å°±åœ¨è¿™ä¸ªèŒƒå›´ä¹‹ä¸­ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºæœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ 1grid-template-columns: 1fr 1fr minmax(100px, 1fr); ä¸Šé¢ä»£ç ä¸­ï¼Œminmax(100px, 1fr)è¡¨ç¤ºåˆ—å®½ä¸å°äº100pxï¼Œä¸å¤§äº1frã€‚ auto å…³é”®å­—ï¼šè¡¨ç¤ºç”±æµè§ˆå™¨è‡ªå·±å†³å®šé•¿åº¦ ç½‘æ ¼çº¿çš„åç§°ï¼šgrid-template-columnså±æ€§å’Œgrid-template-rowså±æ€§é‡Œé¢ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·ï¼ŒæŒ‡å®šæ¯ä¸€æ ¹ç½‘æ ¼çº¿çš„åå­—ï¼Œæ–¹ä¾¿ä»¥åçš„å¼•ç”¨ã€‚ï¼ˆç½‘æ ¼å¸ƒå±€å…è®¸åŒä¸€æ ¹çº¿æœ‰å¤šä¸ªåå­—ï¼Œæ¯”å¦‚[fifth-line row-5]ã€‚ï¼‰ 12345.container &#123; display: grid; grid-template-columns: [c1] 100px [c2] 100px [c3] auto [c4]; grid-template-rows: [r1] 100px [r2] 100px [r3] auto [r4];&#125; 3.grid-row-gap å±æ€§ï¼Œ grid-column-gap å±æ€§ï¼Œ grid-gap å±æ€§ grid-row-gapå±æ€§è®¾ç½®è¡Œä¸è¡Œçš„é—´éš”ï¼ˆè¡Œé—´è·ï¼‰ grid-column-gapå±æ€§è®¾ç½®åˆ—ä¸åˆ—çš„é—´éš”ï¼ˆåˆ—é—´è·ï¼‰ã€‚ grid-gapå±æ€§æ˜¯grid-column-gapå’Œgrid-row-gapçš„åˆå¹¶ç®€å†™å½¢å¼ï¼šgrid-gap: &lt;grid-row-gap&gt; &lt;grid-column-gap&gt;;(å¦‚æœgrid-gapçœç•¥äº†ç¬¬äºŒä¸ªå€¼ï¼Œæµè§ˆå™¨è®¤ä¸ºç¬¬äºŒä¸ªå€¼ç­‰äºç¬¬ä¸€ä¸ªå€¼ã€‚) æ ¹æ®æœ€æ–°æ ‡å‡†ï¼Œä¸Šé¢ä¸‰ä¸ªå±æ€§åçš„grid-å‰ç¼€å·²ç»åˆ é™¤ï¼Œgrid-column-gapå’Œgrid-row-gapå†™æˆcolumn-gapå’Œrow-gapï¼Œgrid-gapå†™æˆgapã€‚ 4.grid-template-areas å±æ€§ç½‘æ ¼å¸ƒå±€å…è®¸æŒ‡å®šâ€åŒºåŸŸâ€ï¼ˆareaï¼‰ï¼Œä¸€ä¸ªåŒºåŸŸç”±å•ä¸ªæˆ–å¤šä¸ªå•å…ƒæ ¼ç»„æˆã€‚ 1234grid-template-areas: \"header header header\" \"main main sidebar\" \"footer footer footer\"; åŒºåŸŸçš„å‘½åä¼šå½±å“åˆ°ç½‘æ ¼çº¿ã€‚æ¯ä¸ªåŒºåŸŸçš„èµ·å§‹ç½‘æ ¼çº¿ï¼Œä¼šè‡ªåŠ¨å‘½åä¸ºåŒºåŸŸå-startï¼Œç»ˆæ­¢ç½‘æ ¼çº¿è‡ªåŠ¨å‘½åä¸ºåŒºåŸŸå-endã€‚ 5.grid-auto-flow å±æ€§åˆ’åˆ†ç½‘æ ¼ä»¥åï¼Œå®¹å™¨çš„å­å…ƒç´ ä¼šæŒ‰ç…§é¡ºåºï¼Œè‡ªåŠ¨æ”¾ç½®åœ¨æ¯ä¸€ä¸ªç½‘æ ¼ã€‚é»˜è®¤çš„æ”¾ç½®é¡ºåºæ˜¯â€å…ˆè¡Œååˆ—â€ï¼Œå³å…ˆå¡«æ»¡ç¬¬ä¸€è¡Œï¼Œå†å¼€å§‹æ”¾å…¥ç¬¬äºŒè¡Œï¼Œå³ä¸‹å›¾æ•°å­—çš„é¡ºåºã€‚ è¿™ä¸ªé¡ºåºç”±grid-auto-flowå±æ€§å†³å®šï¼Œé»˜è®¤å€¼æ˜¯rowï¼Œå³â€å…ˆè¡Œååˆ—â€ã€‚ ä¹Ÿå¯ä»¥å°†å®ƒè®¾æˆcolumnï¼Œå˜æˆâ€å…ˆåˆ—åè¡Œâ€ã€‚ è®¾ä¸ºrow denseï¼Œè¡¨ç¤ºâ€å…ˆè¡Œååˆ—â€ï¼Œå¹¶ä¸”å°½å¯èƒ½ç´§å¯†å¡«æ»¡ï¼Œå°½é‡ä¸å‡ºç°ç©ºæ ¼ã€‚ column denseï¼Œè¡¨ç¤ºâ€å…ˆåˆ—åè¡Œâ€ï¼Œå¹¶ä¸”å°½é‡å¡«æ»¡ç©ºæ ¼ã€‚ 6.justify-items å±æ€§ï¼Œ align-items å±æ€§ï¼Œ place-items å±æ€§ justify-itemså±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„æ°´å¹³ä½ç½®ï¼ˆå·¦ä¸­å³ï¼‰ align-itemså±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„å‚ç›´ä½ç½®ï¼ˆä¸Šä¸­ä¸‹ï¼‰ã€‚ è¿™ä¸¤ä¸ªå±æ€§çš„å†™æ³•å®Œå…¨ç›¸åŒï¼Œéƒ½å¯ä»¥å–ä¸‹é¢è¿™äº›å€¼ã€‚ startï¼šå¯¹é½å•å…ƒæ ¼çš„èµ·å§‹è¾¹ç¼˜ã€‚ endï¼šå¯¹é½å•å…ƒæ ¼çš„ç»“æŸè¾¹ç¼˜ã€‚ centerï¼šå•å…ƒæ ¼å†…éƒ¨å±…ä¸­ã€‚ stretchï¼šæ‹‰ä¼¸ï¼Œå æ»¡å•å…ƒæ ¼çš„æ•´ä¸ªå®½åº¦ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚ place-itemså±æ€§æ˜¯align-itemså±æ€§å’Œjustify-itemså±æ€§çš„åˆå¹¶ç®€å†™å½¢å¼ã€‚ï¼ˆå¦‚æœçœç•¥ç¬¬äºŒä¸ªå€¼ï¼Œåˆ™æµè§ˆå™¨è®¤ä¸ºä¸ç¬¬ä¸€ä¸ªå€¼ç›¸ç­‰ã€‚ï¼‰ 1place-items: &lt;align-items&gt; &lt;justify-items&gt;; 7.justify-content å±æ€§ï¼Œ align-content å±æ€§ï¼Œ place-content å±æ€§ justify-contentå±æ€§æ˜¯æ•´ä¸ªå†…å®¹åŒºåŸŸåœ¨å®¹å™¨é‡Œé¢çš„æ°´å¹³ä½ç½®ï¼ˆå·¦ä¸­å³ï¼‰ align-contentå±æ€§æ˜¯æ•´ä¸ªå†…å®¹åŒºåŸŸçš„å‚ç›´ä½ç½®ï¼ˆä¸Šä¸­ä¸‹ï¼‰ã€‚ è¿™ä¸¤ä¸ªå±æ€§çš„å†™æ³•å®Œå…¨ç›¸åŒï¼Œéƒ½å¯ä»¥å–ä¸‹é¢è¿™äº›å€¼ã€‚ åªæ˜¯å°†æ°´å¹³æ–¹å‘æ”¹æˆå‚ç›´æ–¹å‘ã€‚ï¼‰ start - å¯¹é½å®¹å™¨çš„èµ·å§‹è¾¹æ¡†ã€‚ end - å¯¹é½å®¹å™¨çš„ç»“æŸè¾¹æ¡†ã€‚ center - å®¹å™¨å†…éƒ¨å±…ä¸­ã€‚ stretch - é¡¹ç›®å¤§å°æ²¡æœ‰æŒ‡å®šæ—¶ï¼Œæ‹‰ä¼¸å æ®æ•´ä¸ªç½‘æ ¼å®¹å™¨ã€‚ space-around - æ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸å®¹å™¨è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚ space-between - é¡¹ç›®ä¸é¡¹ç›®çš„é—´éš”ç›¸ç­‰ï¼Œé¡¹ç›®ä¸å®¹å™¨è¾¹æ¡†ä¹‹é—´æ²¡æœ‰é—´éš”ã€‚ space-evenly - é¡¹ç›®ä¸é¡¹ç›®çš„é—´éš”ç›¸ç­‰ï¼Œé¡¹ç›®ä¸å®¹å™¨è¾¹æ¡†ä¹‹é—´ä¹Ÿæ˜¯åŒæ ·é•¿åº¦çš„é—´éš”ã€‚ place-contentå±æ€§æ˜¯align-contentå±æ€§å’Œjustify-contentå±æ€§çš„åˆå¹¶ç®€å†™å½¢å¼ã€‚ï¼ˆå¦‚æœçœç•¥ç¬¬äºŒä¸ªå€¼ï¼Œæµè§ˆå™¨å°±ä¼šå‡å®šç¬¬äºŒä¸ªå€¼ç­‰äºç¬¬ä¸€ä¸ªå€¼ã€‚ï¼‰ 1place-content: &lt;align-content&gt; &lt;justify-content&gt;; 8.grid-auto-columns å±æ€§ï¼Œ grid-auto-rows å±æ€§æœ‰æ—¶å€™ï¼Œä¸€äº›é¡¹ç›®çš„æŒ‡å®šä½ç½®ï¼Œåœ¨ç°æœ‰ç½‘æ ¼çš„å¤–éƒ¨ã€‚æ¯”å¦‚ç½‘æ ¼åªæœ‰ 3 åˆ—ï¼Œä½†æ˜¯æŸä¸€ä¸ªé¡¹ç›®æŒ‡å®šåœ¨ç¬¬ 5 è¡Œã€‚è¿™æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ç”Ÿæˆå¤šä½™çš„ç½‘æ ¼ï¼Œä»¥ä¾¿æ”¾ç½®é¡¹ç›®ã€‚ grid-auto-columnså±æ€§å’Œgrid-auto-rowså±æ€§ç”¨æ¥è®¾ç½®ï¼Œæµè§ˆå™¨è‡ªåŠ¨åˆ›å»ºçš„å¤šä½™ç½‘æ ¼çš„åˆ—å®½å’Œè¡Œé«˜ã€‚å®ƒä»¬çš„å†™æ³•ä¸grid-template-columnså’Œgrid-template-rowså®Œå…¨ç›¸åŒã€‚å¦‚æœä¸æŒ‡å®šè¿™ä¸¤ä¸ªå±æ€§ï¼Œæµè§ˆå™¨å®Œå…¨æ ¹æ®å•å…ƒæ ¼å†…å®¹çš„å¤§å°ï¼Œå†³å®šæ–°å¢ç½‘æ ¼çš„åˆ—å®½å’Œè¡Œé«˜ã€‚ åˆ’åˆ†å¥½çš„ç½‘æ ¼æ˜¯ 3 è¡Œ x 3 åˆ—ï¼Œä½†æ˜¯ï¼Œ8 å·é¡¹ç›®æŒ‡å®šåœ¨ç¬¬ 4 è¡Œï¼Œ9 å·é¡¹ç›®æŒ‡å®šåœ¨ç¬¬ 5 è¡Œã€‚ 123456.container &#123; display: grid; grid-template-columns: 100px 100px 100px; grid-template-rows: 100px 100px 100px; grid-auto-rows: 50px;&#125; ä¸Šé¢ä»£ç æŒ‡å®šæ–°å¢çš„è¡Œé«˜ç»Ÿä¸€ä¸º 50pxï¼ˆåŸå§‹çš„è¡Œé«˜ä¸º 100pxï¼‰ã€‚ 9.grid-template å±æ€§ï¼Œ grid å±æ€§grid-templateå±æ€§æ˜¯grid-template-columnsã€grid-template-rowså’Œgrid-template-areasè¿™ä¸‰ä¸ªå±æ€§çš„åˆå¹¶ç®€å†™å½¢å¼ã€‚ gridå±æ€§æ˜¯grid-template-rowsã€grid-template-columnsã€grid-template-areasã€ grid-auto-rowsã€grid-auto-columnsã€grid-auto-flowè¿™å…­ä¸ªå±æ€§çš„åˆå¹¶ç®€å†™å½¢å¼ã€‚ é¡¹ç›®å±æ€§1.grid-column-start å±æ€§ï¼Œ grid-column-end å±æ€§ï¼Œ grid-row-start å±æ€§ï¼Œ grid-row-end å±æ€§é¡¹ç›®çš„ä½ç½®æ˜¯å¯ä»¥æŒ‡å®šçš„ï¼Œå…·ä½“æ–¹æ³•å°±æ˜¯æŒ‡å®šé¡¹ç›®çš„å››ä¸ªè¾¹æ¡†ï¼Œåˆ†åˆ«å®šä½åœ¨å“ªæ ¹ç½‘æ ¼çº¿ã€‚ grid-column-startå±æ€§ï¼šå·¦è¾¹æ¡†æ‰€åœ¨çš„å‚ç›´ç½‘æ ¼çº¿ grid-column-endå±æ€§ï¼šå³è¾¹æ¡†æ‰€åœ¨çš„å‚ç›´ç½‘æ ¼çº¿ grid-row-startå±æ€§ï¼šä¸Šè¾¹æ¡†æ‰€åœ¨çš„æ°´å¹³ç½‘æ ¼çº¿ grid-row-endå±æ€§ï¼šä¸‹è¾¹æ¡†æ‰€åœ¨çš„æ°´å¹³ç½‘æ ¼çº¿ 1234.item-1 &#123; grid-column-start: 2; grid-column-end: 4;&#125; è¿™å››ä¸ªå±æ€§çš„å€¼è¿˜å¯ä»¥ä½¿ç”¨spanå…³é”®å­—ï¼Œè¡¨ç¤ºâ€è·¨è¶Šâ€ï¼Œå³å·¦å³è¾¹æ¡†ï¼ˆä¸Šä¸‹è¾¹æ¡†ï¼‰ä¹‹é—´è·¨è¶Šå¤šå°‘ä¸ªç½‘æ ¼ã€‚ ä½¿ç”¨è¿™å››ä¸ªå±æ€§ï¼Œå¦‚æœäº§ç”Ÿäº†é¡¹ç›®çš„é‡å ï¼Œåˆ™ä½¿ç”¨z-indexå±æ€§æŒ‡å®šé¡¹ç›®çš„é‡å é¡ºåºã€‚ 2.grid-column å±æ€§ï¼Œ grid-row å±æ€§ grid-columnå±æ€§æ˜¯grid-column-startå’Œgrid-column-endçš„åˆå¹¶ç®€å†™å½¢å¼ grid-rowå±æ€§æ˜¯grid-row-startå±æ€§å’Œgrid-row-endçš„åˆå¹¶ç®€å†™å½¢å¼ã€‚ è¿™ä¸¤ä¸ªå±æ€§ä¹‹ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨spanå…³é”®å­—ï¼Œè¡¨ç¤ºè·¨è¶Šå¤šå°‘ä¸ªç½‘æ ¼ã€‚æ–œæ ä»¥åŠåé¢çš„éƒ¨åˆ†å¯ä»¥çœç•¥ï¼Œé»˜è®¤è·¨è¶Šä¸€ä¸ªç½‘æ ¼ã€‚ 1234567891011.item-1 &#123; background: #b03532; grid-column: 1 / 3; grid-row: 1 / 3;&#125;/* ç­‰åŒäº */.item-1 &#123; background: #b03532; grid-column: 1 / span 2; grid-row: 1 / span 2;&#125; 3.grid-area å±æ€§grid-areaå±æ€§æŒ‡å®šé¡¹ç›®æ”¾åœ¨å“ªä¸€ä¸ªåŒºåŸŸã€‚ 123.item-1 &#123; grid-area: e;&#125; grid-areaå±æ€§è¿˜å¯ç”¨ä½œgrid-row-startã€grid-column-startã€grid-row-endã€grid-column-endçš„åˆå¹¶ç®€å†™å½¢å¼ï¼Œç›´æ¥æŒ‡å®šé¡¹ç›®çš„ä½ç½®ã€‚ 123.item &#123; grid-area: &lt;row-start&gt; / &lt;column-start&gt; / &lt;row-end&gt; / &lt;column-end&gt;;&#125; 4.justify-self å±æ€§ï¼Œ align-self å±æ€§ï¼Œ place-self å±æ€§ justify-selfå±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„æ°´å¹³ä½ç½®ï¼ˆå·¦ä¸­å³ï¼‰ï¼Œè·Ÿjustify-itemså±æ€§çš„ç”¨æ³•å®Œå…¨ä¸€è‡´ï¼Œä½†åªä½œç”¨äºå•ä¸ªé¡¹ç›®ã€‚ align-selfå±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„å‚ç›´ä½ç½®ï¼ˆä¸Šä¸­ä¸‹ï¼‰ï¼Œè·Ÿalign-itemså±æ€§çš„ç”¨æ³•å®Œå…¨ä¸€è‡´ï¼Œä¹Ÿæ˜¯åªä½œç”¨äºå•ä¸ªé¡¹ç›®ã€‚ è¿™ä¸¤ä¸ªå±æ€§éƒ½å¯ä»¥å–ä¸‹é¢å››ä¸ªå€¼ã€‚ startï¼šå¯¹é½å•å…ƒæ ¼çš„èµ·å§‹è¾¹ç¼˜ã€‚ endï¼šå¯¹é½å•å…ƒæ ¼çš„ç»“æŸè¾¹ç¼˜ã€‚ centerï¼šå•å…ƒæ ¼å†…éƒ¨å±…ä¸­ã€‚ stretchï¼šæ‹‰ä¼¸ï¼Œå æ»¡å•å…ƒæ ¼çš„æ•´ä¸ªå®½åº¦ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚ place-selfå±æ€§æ˜¯align-selfå±æ€§å’Œjustify-selfå±æ€§çš„åˆå¹¶ç®€å†™å½¢å¼ã€‚ 1place-self: &lt;align-self&gt; &lt;justify-self&gt;; å…¼å®¹æ€§ å¯¹æ¯” Bootstrap æ ‡ç­¾ä¼šæ›´åŠ ç®€æ´ï¼šç›¸æ¯”Bootstrapï¼Œä½¿ç”¨ grid ä¼šä½¿ä½ çš„ HTML æ›´åŠ å¹²å‡€ã€‚Bootstrapéœ€è¦åˆ›å»ºçš„æ ‡ç­¾ï¼Œæ¯ä¸ª row éƒ½éœ€è¦ä¸€ä¸ª&lt;div&gt;æ ‡ç­¾ï¼Œä½¿ç”¨äº† class name æ¥æŒ‡å®šå¸ƒå±€(col-xs-2)ã€‚grid ç”¨æ¥å¸ƒå±€çœ‹èµ·æ¥æ›´ç®€å•ï¼Œä¸‘é™‹çš„ç±»åå’Œæ¯è¡Œæ‰€éœ€çš„é¢å¤–çš„ div æ ‡ç­¾ä¸€å»ä¸å¤è¿”äº†ï¼Œç®€ç®€å•å•ä¸€ä¸ª container å’Œé‡Œé¢çš„ itemã€‚ä¸Bootstrapä¸åŒçš„æ˜¯ï¼Œéšç€å¸ƒå±€å¤æ‚åº¦çš„å¢åŠ ï¼ŒGrid å¸ƒå±€æ ‡ç­¾çš„å¤æ‚åº¦å°†ä¸ä¼šå¢åŠ å¤ªå¤šã€‚ æ›´çµæ´»ï¼šç”¨CSS Gridçš„è¯ä¼šéå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªmedia queryå°±å¯ä»¥é‡æ–°æ’åˆ—å¸ƒå±€ã€‚è€Œå¦‚æœæƒ³åœ¨Bootstrapä¸­åšåŒæ ·çš„äº‹æƒ…ï¼Œå°±å¿…é¡»å¾—ä¿®æ”¹ HTML äº†ï¼Œéœ€è¦è°ƒæ•´æ ‡ç­¾çš„é¡ºåºã€‚ ä¸å†é™æ­» 12 åˆ—ï¼šBootstrapçš„ grid ç³»ç»Ÿåˆ†ä¸ºäº† 12 åˆ—ï¼Œå¦‚æœä½ æƒ³è¦ä¸€ä¸ª 5 åˆ—çš„å¸ƒå±€å°±ä¼šçº ç»“ï¼Œæˆ–æ˜¯ 7 åˆ—ã€9 åˆ—ã€ä»»ä½•ä¸ä¼šåˆä¸º 12 åˆ—çš„ã€‚CSS Gridå°±æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œä½ å¯ä»¥è®© grid æ­£å¥½æœ‰ä½ æƒ³è¦çš„æ•°é‡ã€‚ æµè§ˆå™¨æ”¯æŒï¼šå…¨çƒ 75%çš„ç½‘ç«™æµé‡æ”¯æŒCSS Grid ç»“è®ºï¼š å¦‚æœåªåš pc ç«¯ï¼Œé‚£ä¹ˆé™æ€å¸ƒå±€ï¼ˆå®šå®½åº¦ï¼‰æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼› å¦‚æœåšç§»åŠ¨ç«¯ï¼Œä¸”è®¾è®¡å¯¹é«˜åº¦å’Œå…ƒç´ é—´è·è¦æ±‚ä¸é«˜ï¼Œé‚£ä¹ˆå¼¹æ€§å¸ƒå±€ï¼ˆrem+jsï¼‰æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œä¸€ä»½ css+ä¸€ä»½ js è°ƒèŠ‚ font-size æå®šï¼› å¦‚æœ pcï¼Œç§»åŠ¨è¦å…¼å®¹ï¼Œè€Œä¸”è¦æ±‚å¾ˆé«˜é‚£ä¹ˆå“åº”å¼å¸ƒå±€è¿˜æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå‰ææ˜¯è®¾è®¡æ ¹æ®ä¸åŒçš„é«˜å®½åšä¸åŒçš„è®¾è®¡ï¼Œå“åº”å¼æ ¹æ®åª’ä½“æŸ¥è¯¢åšä¸åŒçš„å¸ƒå±€.","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"å¸ƒå±€","slug":"å¸ƒå±€","permalink":"http://yoursite.com/tags/å¸ƒå±€/"}]},{"title":"CSS3æ–°ç‰¹æ€§","slug":"CSS3æ–°ç‰¹æ€§","date":"2019-04-28T04:37:08.000Z","updated":"2019-09-21T13:56:29.728Z","comments":true,"path":"2019/04/28/CSS3æ–°ç‰¹æ€§/","link":"","permalink":"http://yoursite.com/2019/04/28/CSS3æ–°ç‰¹æ€§/","excerpt":"CSS3 æ–°ç‰¹æ€§1. é€‰æ‹©å™¨CSS3 ä¸­æ–°æ·»åŠ äº†å¾ˆå¤šé€‰æ‹©å™¨ï¼Œè§£å†³äº†å¾ˆå¤šä¹‹å‰éœ€è¦ç”¨ javascript æ‰èƒ½è§£å†³çš„å¸ƒå±€é—®é¢˜ã€‚ element1~element2: é€‰æ‹©å‰é¢æœ‰ element1 å…ƒç´ çš„æ¯ä¸ª element2 å…ƒç´ ã€‚ [attribute^=value] ï¼šé€‰æ‹©æŸå…ƒç´  attribute å±æ€§æ˜¯ä»¥ value å¼€å¤´çš„ã€‚ [attribute$=value]ï¼šé€‰æ‹©æŸå…ƒç´  attribute å±æ€§æ˜¯ä»¥ value ç»“å°¾çš„ã€‚ [attribute*=value]ï¼šé€‰æ‹©æŸå…ƒç´  attribute å±æ€§åŒ…å« value å­—ç¬¦ä¸²çš„ã€‚ E:first-of-type: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ª E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:last-of-type: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„æœ€å E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:only-of-type: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å”¯ä¸€çš„ E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:only-child: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å”¯ä¸€å­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-child(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„ç¬¬ n ä¸ªå­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-last-child(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å€’æ•°ç¬¬ n ä¸ªå­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-of-type(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ ç¬¬ n ä¸ª E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-last-of-type(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å€’æ•°ç¬¬ n ä¸ª E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:last-child: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ æœ€åä¸€ä¸ªå­å…ƒç´ æ¯ä¸ª E å…ƒç´ ã€‚ :root: é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚ E:empty: é€‰æ‹©æ²¡æœ‰å­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ï¼ˆåŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹)ã€‚ E:target: é€‰æ‹©å½“å‰æ´»åŠ¨çš„ E å…ƒç´ ã€‚ E:enabled: é€‰æ‹©æ¯ä¸ªå¯ç”¨çš„ E å…ƒç´ ã€‚ E:disabled: é€‰æ‹©æ¯ä¸ªç¦ç”¨çš„ E å…ƒç´ ã€‚ E:checked: é€‰æ‹©æ¯ä¸ªè¢«é€‰ä¸­çš„ E å…ƒç´ ã€‚ E:not(selector): é€‰æ‹©é selector å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚ E::selection: é€‰æ‹©è¢«ç”¨æˆ·é€‰å–çš„å…ƒç´ éƒ¨åˆ†ã€‚","text":"CSS3 æ–°ç‰¹æ€§1. é€‰æ‹©å™¨CSS3 ä¸­æ–°æ·»åŠ äº†å¾ˆå¤šé€‰æ‹©å™¨ï¼Œè§£å†³äº†å¾ˆå¤šä¹‹å‰éœ€è¦ç”¨ javascript æ‰èƒ½è§£å†³çš„å¸ƒå±€é—®é¢˜ã€‚ element1~element2: é€‰æ‹©å‰é¢æœ‰ element1 å…ƒç´ çš„æ¯ä¸ª element2 å…ƒç´ ã€‚ [attribute^=value] ï¼šé€‰æ‹©æŸå…ƒç´  attribute å±æ€§æ˜¯ä»¥ value å¼€å¤´çš„ã€‚ [attribute$=value]ï¼šé€‰æ‹©æŸå…ƒç´  attribute å±æ€§æ˜¯ä»¥ value ç»“å°¾çš„ã€‚ [attribute*=value]ï¼šé€‰æ‹©æŸå…ƒç´  attribute å±æ€§åŒ…å« value å­—ç¬¦ä¸²çš„ã€‚ E:first-of-type: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ª E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:last-of-type: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„æœ€å E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:only-of-type: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å”¯ä¸€çš„ E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:only-child: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å”¯ä¸€å­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-child(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„ç¬¬ n ä¸ªå­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-last-child(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å€’æ•°ç¬¬ n ä¸ªå­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-of-type(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ ç¬¬ n ä¸ª E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:nth-last-of-type(n): é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å€’æ•°ç¬¬ n ä¸ª E å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ã€‚ E:last-child: é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ æœ€åä¸€ä¸ªå­å…ƒç´ æ¯ä¸ª E å…ƒç´ ã€‚ :root: é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚ E:empty: é€‰æ‹©æ²¡æœ‰å­å…ƒç´ çš„æ¯ä¸ª E å…ƒç´ ï¼ˆåŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹)ã€‚ E:target: é€‰æ‹©å½“å‰æ´»åŠ¨çš„ E å…ƒç´ ã€‚ E:enabled: é€‰æ‹©æ¯ä¸ªå¯ç”¨çš„ E å…ƒç´ ã€‚ E:disabled: é€‰æ‹©æ¯ä¸ªç¦ç”¨çš„ E å…ƒç´ ã€‚ E:checked: é€‰æ‹©æ¯ä¸ªè¢«é€‰ä¸­çš„ E å…ƒç´ ã€‚ E:not(selector): é€‰æ‹©é selector å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚ E::selection: é€‰æ‹©è¢«ç”¨æˆ·é€‰å–çš„å…ƒç´ éƒ¨åˆ†ã€‚ 2. Transition,Transform å’Œ Animationè¿™ä¸‰ä¸ªç‰¹æ€§æ˜¯ CSS3 æ–°å¢çš„å’ŒåŠ¨ç”»ç›¸å…³çš„ç‰¹æ€§ã€‚ Transition Transition å¯ä»¥åœ¨å½“å…ƒç´ ä»ä¸€ç§æ ·å¼å˜æ¢ä¸ºå¦ä¸€ç§æ ·å¼æ—¶ä¸ºå…ƒç´ æ·»åŠ æ•ˆæœï¼Œè€Œä¸ç”¨ä½¿ç”¨ Flash åŠ¨ç”»æˆ– JavaScriptã€‚Transition æœ‰å¦‚ä¸‹å±æ€§ï¼š transition-property: è§„å®šåº”ç”¨è¿‡æ¸¡çš„ CSS å±æ€§çš„åç§°ã€‚ transition-duration: è§„å®šå®Œæˆè¿‡æ¸¡æ•ˆæœéœ€è¦å¤šé•¿æ—¶é—´ã€‚ transition-delay: è§„å®šè¿‡æ¸¡æ•ˆæœä½•æ—¶å¼€å§‹ï¼Œé»˜è®¤æ˜¯ 0ã€‚ transition-timing-function: è§„å®šè¿‡æ¸¡æ•ˆæœçš„æ—¶é—´æ›²çº¿ï¼Œé»˜è®¤æ˜¯â€easeâ€ï¼Œè¿˜æœ‰ linearã€ease-inã€ease-outã€ease-in-out å’Œ cubic-bezier ç­‰è¿‡æ¸¡ç±»å‹ã€‚ transition: ç®€å†™å±æ€§ï¼Œç”¨äºåœ¨ä¸€ä¸ªå±æ€§ä¸­è®¾ç½®å››ä¸ªè¿‡æ¸¡å±æ€§ã€‚ Transform Transform ç”¨æ¥å‘å…ƒç´ åº”ç”¨å„ç§ 2D å’Œ 3D è½¬æ¢ï¼Œè¯¥å±æ€§å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œç­‰æ“ä½œã€‚ å˜æ¢ç±»å‹ï¼š none: å®šä¹‰ä¸è¿›è¡Œè½¬æ¢ã€‚ matrix(n,n,n,n,n,n): å®šä¹‰ 2D è½¬æ¢ï¼Œä½¿ç”¨å…­ä¸ªå€¼çš„çŸ©é˜µã€‚ matrix3d(n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n): å®šä¹‰ 3D è½¬æ¢ï¼Œä½¿ç”¨ 16 ä¸ªå€¼çš„ 4x4 çŸ©é˜µã€‚ translate(x,y): å®šä¹‰ 2D ä½ç§»è½¬æ¢ã€‚ translate3d(x,y,z): å®šä¹‰ 3D ä½ç§»è½¬æ¢ã€‚ translateX(x): å®šä¹‰ä½ç§»è½¬æ¢ï¼Œåªæ˜¯ç”¨ X è½´çš„å€¼ã€‚ translateY(y): å®šä¹‰ä½ç§»è½¬æ¢ï¼Œåªæ˜¯ç”¨ Y è½´çš„å€¼ã€‚ translateZ(z): å®šä¹‰ 3D ä½ç§»è½¬æ¢ï¼Œåªæ˜¯ç”¨ Z è½´çš„å€¼ã€‚ scale(x,y): å®šä¹‰ 2D ç¼©æ”¾è½¬æ¢ã€‚ scale3d(x,y,z): å®šä¹‰ 3D ç¼©æ”¾è½¬æ¢ã€‚ scaleX(x): é€šè¿‡è®¾ç½® X è½´çš„å€¼æ¥å®šä¹‰ç¼©æ”¾è½¬æ¢ã€‚ scaleY(y): é€šè¿‡è®¾ç½® Y è½´çš„å€¼æ¥å®šä¹‰ç¼©æ”¾è½¬æ¢ã€‚ scaleZ(z): é€šè¿‡è®¾ç½® Z è½´çš„å€¼æ¥å®šä¹‰ 3D ç¼©æ”¾è½¬æ¢ã€‚ rotate(angle): å®šä¹‰ 2D æ—‹è½¬ï¼Œåœ¨å‚æ•°ä¸­è§„å®šè§’åº¦ã€‚ rotate3d(x,y,z,angle): å®šä¹‰ 3D æ—‹è½¬ã€‚ rotateX(angle): å®šä¹‰æ²¿ç€ X è½´çš„ 3D æ—‹è½¬ã€‚ rotateY(angle): å®šä¹‰æ²¿ç€ Y è½´çš„ 3D æ—‹è½¬ã€‚ rotateZ(angle): å®šä¹‰æ²¿ç€ Z è½´çš„ 3D æ—‹è½¬ã€‚ skew(x-angle,y-angle): å®šä¹‰æ²¿ç€ X å’Œ Y è½´çš„ 2D å€¾æ–œè½¬æ¢ã€‚ skewX(angle): å®šä¹‰æ²¿ç€ X è½´çš„ 2D å€¾æ–œè½¬æ¢ã€‚ skewY(angle): å®šä¹‰æ²¿ç€ Y è½´çš„ 2D å€¾æ–œè½¬æ¢ã€‚ perspective(n): ä¸º 3D è½¬æ¢å…ƒç´ å®šä¹‰é€è§†è§†å›¾ã€‚ Animation Animation è®© CSS æ‹¥æœ‰äº†å¯ä»¥åˆ¶ä½œåŠ¨ç”»çš„åŠŸèƒ½ã€‚ä½¿ç”¨ CSS3 çš„ Animation åˆ¶ä½œåŠ¨ç”»æˆ‘ä»¬å¯ä»¥çœå»å¤æ‚çš„ js ä»£ç ã€‚ 3. è¾¹æ¡†CSS3 æ–°å¢äº†ä¸‰ä¸ªè¾¹æ¡†å±æ€§ï¼Œåˆ†åˆ«æ˜¯ border-radiusã€box-shadow å’Œ border-imageã€‚ border-radius å¯ä»¥åˆ›å»ºåœ†è§’è¾¹æ¡† box-shadow å¯ä»¥ä¸ºå…ƒç´ æ·»åŠ é˜´å½± border-image å¯ä»¥ä½¿ç”¨å›¾ç‰‡æ¥ç»˜åˆ¶è¾¹æ¡†ã€‚ 4. èƒŒæ™¯CSS3 æ–°å¢äº†å‡ ä¸ªå…³äºèƒŒæ™¯çš„å±æ€§ï¼Œåˆ†åˆ«æ˜¯ background-clipã€background-originã€background-size å’Œ background-breakã€‚ background-clip background-clip å±æ€§ç”¨äºç¡®å®šèƒŒæ™¯ç”»åŒºï¼Œæœ‰ä»¥ä¸‹å‡ ç§å¯èƒ½çš„å±æ€§ï¼š background-clip: border-box; èƒŒæ™¯ä» border å¼€å§‹æ˜¾ç¤º background-clip: padding-box; èƒŒæ™¯ä» padding å¼€å§‹æ˜¾ç¤º background-clip: content-box; èƒŒæ™¯æ˜¾ content åŒºåŸŸå¼€å§‹æ˜¾ç¤º background-clip: no-clip; é»˜è®¤å±æ€§ï¼Œç­‰åŒäº border-box é€šå¸¸æƒ…å†µï¼ŒèƒŒæ™¯éƒ½æ˜¯è¦†ç›–æ•´ä¸ªå…ƒç´ çš„ï¼Œåˆ©ç”¨è¿™ä¸ªå±æ€§å¯ä»¥è®¾å®šèƒŒæ™¯é¢œè‰²æˆ–å›¾ç‰‡çš„è¦†ç›–èŒƒå›´ã€‚ background-origin background-clip å±æ€§ç”¨äºç¡®å®šèƒŒæ™¯çš„ä½ç½®ï¼Œå®ƒé€šå¸¸ä¸ background-position è”åˆä½¿ç”¨ï¼Œå¯ä»¥ä» borderã€paddingã€content æ¥è®¡ç®— background-positionï¼ˆå°±åƒ background-clipï¼‰ã€‚ background-origin: border-box; ä» border å¼€å§‹è®¡ç®— background-position background-origin: padding-box; ä» padding å¼€å§‹è®¡ç®— background-position background-origin: content-box; ä» content å¼€å§‹è®¡ç®— background-position background-size background-size å±æ€§å¸¸ç”¨æ¥è°ƒæ•´èƒŒæ™¯å›¾ç‰‡çš„å¤§å°ï¼Œä¸»è¦ç”¨äºè®¾å®šå›¾ç‰‡æœ¬èº«ã€‚æœ‰ä»¥ä¸‹å¯èƒ½çš„å±æ€§ï¼š background-size: contain; ç¼©å°å›¾ç‰‡ä»¥é€‚åˆå…ƒç´ ï¼ˆç»´æŒåƒç´ é•¿å®½æ¯”ï¼‰ background-size: cover; æ‰©å±•å…ƒç´ ä»¥å¡«è¡¥å…ƒç´ ï¼ˆç»´æŒåƒç´ é•¿å®½æ¯”ï¼‰ background-size: 100px 100px; ç¼©å°å›¾ç‰‡è‡³æŒ‡å®šçš„å¤§å° background-size: 50% 100%; ç¼©å°å›¾ç‰‡è‡³æŒ‡å®šçš„å¤§å°ï¼Œç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹åŒ… å«å…ƒç´ çš„å°ºå¯¸ background-break CSS3 ä¸­ï¼Œå…ƒç´ å¯ä»¥è¢«åˆ†æˆå‡ ä¸ªç‹¬ç«‹çš„ç›’å­ï¼ˆå¦‚ä½¿å†…è”å…ƒç´  span è·¨è¶Šå¤šè¡Œï¼‰ï¼Œbackground-break å±æ€§ç”¨æ¥æ§åˆ¶èƒŒæ™¯æ€æ ·åœ¨è¿™äº›ä¸åŒçš„ç›’å­ä¸­æ˜¾ç¤ºã€‚ background-break: continuous; é»˜è®¤å€¼ã€‚å¿½ç•¥ç›’ä¹‹é—´çš„è·ç¦»ï¼ˆä¹Ÿå°±æ˜¯åƒå…ƒç´ æ²¡æœ‰åˆ†æˆå¤šä¸ªç›’å­ï¼Œä¾ç„¶æ˜¯ä¸€ä¸ªæ•´ä½“ä¸€æ ·ï¼‰ background-break: bounding-box; æŠŠç›’ä¹‹é—´çš„è·ç¦»è®¡ç®—åœ¨å†…ï¼› background-break: each-box; ä¸ºæ¯ä¸ªç›’å­å•ç‹¬é‡ç»˜èƒŒæ™¯ã€‚ 5. æ–‡å­—æ•ˆæœ word-wrap CSS3 ä¸­ï¼Œword-wrap å±æ€§å…è®¸æ‚¨å…è®¸æ–‡æœ¬å¼ºåˆ¶æ–‡æœ¬è¿›è¡Œæ¢è¡Œï¼Œå³è¿™æ„å‘³ç€ä¼šå¯¹å•è¯è¿›è¡Œæ‹†åˆ†ã€‚æ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒ word-wrap å±æ€§ã€‚ text-overflow å®ƒä¸ word-wrap æ˜¯ååŒå·¥ä½œçš„ï¼Œword-wrap è®¾ç½®æˆ–æ£€ç´¢å½“å½“å‰è¡Œè¶…è¿‡æŒ‡å®šå®¹å™¨çš„è¾¹ç•Œæ—¶æ˜¯å¦æ–­å¼€è½¬è¡Œï¼Œè€Œ text-overflow åˆ™è®¾ç½®æˆ–æ£€ç´¢å½“å½“å‰è¡Œè¶…è¿‡æŒ‡å®šå®¹å™¨çš„è¾¹ç•Œæ—¶å¦‚ä½•æ˜¾ç¤ºã€‚å¯¹äºâ€œtext-overflowâ€å±æ€§ï¼Œæœ‰â€œclipâ€å’Œâ€œellipsisâ€ä¸¤ç§å¯ä¾›é€‰æ‹©ã€‚ text-shadow CSS3 ä¸­ï¼Œtext-shadow å¯å‘æ–‡æœ¬åº”ç”¨é˜´å½±ã€‚èƒ½å¤Ÿè§„å®šæ°´å¹³é˜´å½±ã€å‚ç›´é˜´å½±ã€æ¨¡ç³Šè·ç¦»ï¼Œä»¥åŠé˜´å½±çš„é¢œè‰²ã€‚ text-decoration CSS3 é‡Œé¢å¼€å§‹æ”¯æŒå¯¹æ–‡å­—çš„æ›´æ·±å±‚æ¬¡çš„æ¸²æŸ“ï¼Œå…·ä½“æœ‰ä¸‰ä¸ªå±æ€§å¯ä¾›è®¾ç½®ï¼š text-fill-color: è®¾ç½®æ–‡å­—å†…éƒ¨å¡«å……é¢œè‰² text-stroke-color: è®¾ç½®æ–‡å­—è¾¹ç•Œå¡«å……é¢œè‰² text-stroke-width: è®¾ç½®æ–‡å­—è¾¹ç•Œå®½åº¦ 6. æ¸å˜CSS3 æ–°å¢äº†æ¸å˜æ•ˆæœï¼ŒåŒ…æ‹¬ linear-gradient(çº¿æ€§æ¸å˜)å’Œ radial-gradient(å¾„å‘æ¸å˜)ã€‚ 7. @font-face ç‰¹æ€§é€šè¿‡ CSS3ï¼Œweb è®¾è®¡å¸ˆå¯ä»¥ä½¿ç”¨ä»–ä»¬å–œæ¬¢çš„ä»»æ„å­—ä½“ã€‚å½“æ‚¨æ‚¨æ‰¾åˆ°æˆ–è´­ä¹°åˆ°å¸Œæœ›ä½¿ç”¨çš„å­—ä½“æ—¶ï¼Œå¯å°†è¯¥å­—ä½“æ–‡ä»¶å­˜æ”¾åˆ° web æœåŠ¡å™¨ä¸Šï¼Œå®ƒä¼šåœ¨éœ€è¦æ—¶è¢«è‡ªåŠ¨ä¸‹è½½åˆ°ç”¨æˆ·çš„è®¡ç®—æœºä¸Šã€‚å­—ä½“æ˜¯åœ¨ CSS3 @font-face è§„åˆ™ä¸­å®šä¹‰çš„ã€‚Firefoxã€Chromeã€Safari ä»¥åŠ Opera æ”¯æŒ .ttf(True Type Fonts)å’Œ .otf(OpenType Fonts)ç±»å‹çš„å­—ä½“ã€‚IE9+ æ”¯æŒæ–°çš„@font-face è§„åˆ™ï¼Œä½†æ˜¯ä»…æ”¯æŒ .eot ç±»å‹çš„å­—ä½“(Embedded OpenType)ã€‚ åœ¨æ–°çš„@font-face è§„åˆ™ä¸­ï¼Œå¿…é¡»é¦–å…ˆå®šä¹‰å­—ä½“çš„åç§°ï¼ˆæ¯”å¦‚ myFontï¼‰ï¼Œç„¶åæŒ‡å‘è¯¥å­—ä½“æ–‡ä»¶ã€‚å¦‚éœ€ä¸º HTML å…ƒç´ ä½¿ç”¨å­—ä½“ï¼Œè¯·é€šè¿‡ font-family å±æ€§æ¥å¼•ç”¨å­—ä½“çš„åç§° (myFont) 8. å¤šåˆ—å¸ƒå±€é€šè¿‡ CSS3ï¼Œèƒ½å¤Ÿåˆ›å»ºå¤šä¸ªåˆ—æ¥å¯¹æ–‡æœ¬è¿›è¡Œå¸ƒå±€ï¼ŒIE10 å’Œ Opera æ”¯æŒå¤šåˆ—å±æ€§ã€‚Firefox éœ€è¦å‰ç¼€-moz-ï¼ŒChrome å’Œ Safari éœ€è¦å‰ç¼€-webkit-ã€‚ä¸»è¦æœ‰å¦‚ä¸‹ä¸‰ä¸ªå±æ€§ï¼š column-count: è§„å®šå…ƒç´ åº”è¯¥è¢«åˆ†éš”çš„åˆ—æ•°ã€‚ column-gap: è§„å®šåˆ—ä¹‹é—´çš„é—´éš”ã€‚ column-rule: è®¾ç½®åˆ—ä¹‹é—´çš„å®½åº¦ã€æ ·å¼å’Œé¢œè‰²è§„åˆ™ 9. ç”¨æˆ·ç•Œé¢CSS3 ä¸­ï¼Œæ–°çš„ç”¨æˆ·ç•Œé¢ç‰¹æ€§åŒ…æ‹¬é‡è®¾å…ƒç´ å°ºå¯¸ã€ç›’å°ºå¯¸ä»¥åŠè½®å»“ç­‰ã€‚Firefoxã€Chrome ä»¥åŠ Safari æ”¯æŒ resize å±æ€§ã€‚IEã€Chromeã€Safari ä»¥åŠ Opera æ”¯æŒ box-sizing å±æ€§ã€‚Firefox éœ€è¦å‰ç¼€-moz-ã€‚æ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒ outline-offset å±æ€§ï¼Œé™¤äº† IEã€‚ resize resize å±æ€§è§„å®šæ˜¯å¦å¯ç”±ç”¨æˆ·è°ƒæ•´å…ƒç´ å°ºå¯¸ã€‚å¦‚æœå¸Œæœ›æ­¤å±æ€§ç”Ÿæ•ˆï¼Œéœ€è¦è®¾ç½®å…ƒç´ çš„ overflow å±æ€§ï¼Œå€¼å¯ä»¥æ˜¯ autoã€hidden æˆ– scrollã€‚ box-sizing box-sizing å±æ€§å¯è®¾ç½®çš„å€¼æœ‰ content-boxã€border-box å’Œ inheritã€‚ content-box: padding å’Œ border ä¸è¢«åŒ…å«åœ¨å®šä¹‰çš„ width å’Œ height ä¹‹å†…ã€‚å¯¹è±¡çš„å®é™…å®½åº¦ç­‰äºè®¾ç½®çš„ width å€¼å’Œ borderã€padding ä¹‹å’Œï¼Œå³ (Element width = width + border + padding)ï¼Œæ­¤å±æ€§è¡¨ç°ä¸ºæ ‡å‡†æ¨¡å¼ä¸‹çš„ç›’æ¨¡å‹ã€‚ border-box: padding å’Œ border è¢«åŒ…å«åœ¨å®šä¹‰çš„ width å’Œ height ä¹‹å†…ã€‚å¯¹è±¡çš„å®é™…å®½åº¦å°±ç­‰äºè®¾ç½®çš„ width å€¼ï¼Œå³ä½¿å®šä¹‰æœ‰ border å’Œ padding ä¹Ÿä¸ä¼šæ”¹å˜å¯¹è±¡çš„å®é™…å®½åº¦ï¼Œå³ (Element width = width)ï¼Œæ­¤å±æ€§è¡¨ç°ä¸ºæ€ªå¼‚æ¨¡å¼ä¸‹çš„ç›’æ¨¡å‹ã€‚ outline-offset outline-offset å±æ€§å¯¹è½®å»“è¿›è¡Œåç§»ï¼Œå¹¶åœ¨è¶…å‡ºè¾¹æ¡†è¾¹ç¼˜çš„ä½ç½®ç»˜åˆ¶è½®å»“ã€‚","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"}]},{"title":"BFC","slug":"BFC","date":"2019-04-10T00:11:20.000Z","updated":"2019-11-16T11:49:13.403Z","comments":true,"path":"2019/04/10/BFC/","link":"","permalink":"http://yoursite.com/2019/04/10/BFC/","excerpt":"BFCBFC çš„å®šä¹‰ï¼šBFC(Block formatting context)ç›´è¯‘ä¸ºâ€å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡â€ã€‚å®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œåªæœ‰Block-level boxå‚ä¸ï¼ˆåœ¨ä¸‹é¢æœ‰è§£é‡Šï¼‰ï¼Œ å®ƒè§„å®šäº†å†…éƒ¨çš„ Block-level Box å¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸è¿™ä¸ªåŒºåŸŸå¤–éƒ¨æ¯«ä¸ç›¸å¹²ã€‚é€šä¿—åœ°è®²ï¼ŒBFC æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºç®¡ç†å—çº§å…ƒç´ ã€‚","text":"BFCBFC çš„å®šä¹‰ï¼šBFC(Block formatting context)ç›´è¯‘ä¸ºâ€å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡â€ã€‚å®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œåªæœ‰Block-level boxå‚ä¸ï¼ˆåœ¨ä¸‹é¢æœ‰è§£é‡Šï¼‰ï¼Œ å®ƒè§„å®šäº†å†…éƒ¨çš„ Block-level Box å¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸è¿™ä¸ªåŒºåŸŸå¤–éƒ¨æ¯«ä¸ç›¸å¹²ã€‚é€šä¿—åœ°è®²ï¼ŒBFC æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºç®¡ç†å—çº§å…ƒç´ ã€‚ è§¦å‘ BFC çš„æ–¹å¼ï¼ˆä»¥ä¸‹ä»»æ„ä¸€æ¡å°±å¯ä»¥ï¼‰ æ ¹å…ƒç´ ï¼Œå³ HTML å…ƒç´  float çš„å€¼ä¸ä¸º noneï¼ˆä¸º leftæˆ–rightï¼‰ overflow çš„å€¼ä¸ä¸º visibleï¼ˆä¸ºhiddenæˆ–autoæˆ–scrollï¼‰ display çš„å€¼ä¸ºtable-cellã€table-captionã€inline-flexã€flexå’Œinline-blockä¹‹ä¸€ position çš„å€¼ä¸ä¸º static æˆ–è€… releative ä¸­ä»»ä½•ä¸€ä¸ª(ä¸ºabsoluteæˆ–fixed) BFC çš„å¸ƒå±€è§„åˆ™ å†…éƒ¨çš„ Box ä¼šåœ¨å‚ç›´æ–¹å‘ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ”¾ç½®ã€‚ Box å‚ç›´æ–¹å‘çš„è·ç¦»ç”± margin å†³å®šã€‚å±äºåŒä¸€ä¸ª BFC çš„ä¸¤ä¸ªç›¸é‚» Box çš„ margin ä¼šå‘ç”Ÿé‡å ï¼ˆmargin é‡å ä¸‰ä¸ªæ¡ä»¶:åŒå±äºä¸€ä¸ª BFC;ç›¸é‚»;å—çº§å…ƒç´ ï¼‰ï¼Œä¸¤ä¸ªç›¸é‚»çš„ BFC ä¸Šä¸‹ margin ä¸ä¼šé‡å  æ¯ä¸ªå…ƒç´ çš„ margin box çš„å·¦è¾¹ï¼Œ ä¸åŒ…å«å— border box çš„å·¦è¾¹ç›¸æ¥è§¦(å¯¹äºä»å·¦å¾€å³çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ç›¸å)ã€‚å³ä½¿å­˜åœ¨æµ®åŠ¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ BFC çš„åŒºåŸŸä¸ä¼šä¸ float box é‡å ã€‚éæµ®åŠ¨å…ƒç´ ä¸ä¼šè¦†ç›–æµ®åŠ¨å…ƒç´ çš„ä½ç½®ã€‚ BFC å°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚åä¹‹ä¹Ÿå¦‚æ­¤ã€‚ï¼ˆè§¦å‘ BFCï¼Œå›æµçš„å±€éƒ¨æ¸²æŸ“ï¼‰ è®¡ç®— BFC çš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®—ï¼ˆæ¸…é™¤æµ®åŠ¨ haslayoutï¼‰ margin ä¸ä¼šä¼ é€’ç»™çˆ¶çº§ï¼ˆçˆ¶çº§è§¦å‘äº† BFCï¼‰ å¯¹æ¯”æ™®é€šæ–‡æ¡£æµçš„å¸ƒå±€è§„åˆ™ æµ®åŠ¨çš„å…ƒç´ æ˜¯ä¸ä¼šè¢«çˆ¶çº§è®¡ç®—é«˜åº¦ éæµ®åŠ¨å…ƒç´ ä¼šè¦†ç›–æµ®åŠ¨å…ƒç´ çš„ä½ç½® margin ä¼šä¼ é€’ç»™çˆ¶çº§ ä¸¤ä¸ªç›¸é‚»çš„å…ƒç´ ä¸Šä¸‹ margin ä¼šé‡å  BFC æœ‰å“ªäº›ä½œç”¨ï¼š è‡ªé€‚åº”ä¸¤æ å¸ƒå±€ï¼ˆè§„åˆ™ 4ï¼‰ å¯ä»¥é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–ï¼ˆè§„åˆ™ 4ï¼‰ å¯ä»¥åŒ…å«æµ®åŠ¨å…ƒç´ â€”â€”æ¸…é™¤å†…éƒ¨æµ®åŠ¨ï¼ˆè§„åˆ™ 6ï¼‰ åˆ†å±äºä¸åŒçš„ BFC æ—¶å¯ä»¥é˜»æ­¢ margin é‡å ï¼ˆè§„åˆ™ 2ï¼‰","categories":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://yoursite.com/tags/CSS/"},{"name":"å¸ƒå±€","slug":"å¸ƒå±€","permalink":"http://yoursite.com/tags/å¸ƒå±€/"}]},{"title":"å­—ç¬¦ç¼–ç ï¼šUnicodeä¸JavaScript","slug":"å­—ç¬¦ç¼–ç ï¼šUnicodeä¸Javascript","date":"2019-04-06T11:08:55.000Z","updated":"2019-11-10T14:37:39.035Z","comments":true,"path":"2019/04/06/å­—ç¬¦ç¼–ç ï¼šUnicodeä¸Javascript/","link":"","permalink":"http://yoursite.com/2019/04/06/å­—ç¬¦ç¼–ç ï¼šUnicodeä¸Javascript/","excerpt":"å­—ç¬¦ç¼–ç ï¼šUnicode ä¸ Javascript1.ASCII ç æˆ‘ä»¬çŸ¥é“ï¼Œè®¡ç®—æœºå†…éƒ¨ï¼Œæ‰€æœ‰ä¿¡æ¯æœ€ç»ˆéƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å€¼ã€‚æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰æœ‰0å’Œ1ä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤å…«ä¸ªäºŒè¿›åˆ¶ä½å°±å¯ä»¥ç»„åˆå‡º 256 ç§çŠ¶æ€ï¼Œè¿™è¢«ç§°ä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€å…±å¯ä»¥ç”¨æ¥è¡¨ç¤º 256 ç§ä¸åŒçš„çŠ¶æ€ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªç¬¦å·ï¼Œå°±æ˜¯ 256 ä¸ªç¬¦å·ï¼Œä»00000000åˆ°11111111ã€‚ ä¸Šä¸ªä¸–çºª 60 å¹´ä»£ï¼Œç¾å›½åˆ¶å®šäº†ä¸€å¥—å­—ç¬¦ç¼–ç ï¼Œå¯¹è‹±è¯­å­—ç¬¦ä¸äºŒè¿›åˆ¶ä½ä¹‹é—´çš„å…³ç³»ï¼Œåšäº†ç»Ÿä¸€è§„å®šã€‚è¿™è¢«ç§°ä¸º ASCII ç ï¼Œä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚ ASCII ç ä¸€å…±è§„å®šäº† 128 ä¸ªå­—ç¬¦çš„ç¼–ç ï¼Œæ¯”å¦‚ç©ºæ ¼SPACEæ˜¯ 32ï¼ˆäºŒè¿›åˆ¶00100000ï¼‰ï¼Œå¤§å†™çš„å­—æ¯Aæ˜¯ 65ï¼ˆäºŒè¿›åˆ¶01000001ï¼‰ã€‚è¿™ 128 ä¸ªç¬¦å·ï¼ˆåŒ…æ‹¬ 32 ä¸ªä¸èƒ½æ‰“å°å‡ºæ¥çš„æ§åˆ¶ç¬¦å·ï¼‰ï¼Œåªå ç”¨äº†ä¸€ä¸ªå­—èŠ‚çš„åé¢ 7 ä½ï¼Œæœ€å‰é¢çš„ä¸€ä½ç»Ÿä¸€è§„å®šä¸º0ã€‚","text":"å­—ç¬¦ç¼–ç ï¼šUnicode ä¸ Javascript1.ASCII ç æˆ‘ä»¬çŸ¥é“ï¼Œè®¡ç®—æœºå†…éƒ¨ï¼Œæ‰€æœ‰ä¿¡æ¯æœ€ç»ˆéƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å€¼ã€‚æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰æœ‰0å’Œ1ä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤å…«ä¸ªäºŒè¿›åˆ¶ä½å°±å¯ä»¥ç»„åˆå‡º 256 ç§çŠ¶æ€ï¼Œè¿™è¢«ç§°ä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€å…±å¯ä»¥ç”¨æ¥è¡¨ç¤º 256 ç§ä¸åŒçš„çŠ¶æ€ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªç¬¦å·ï¼Œå°±æ˜¯ 256 ä¸ªç¬¦å·ï¼Œä»00000000åˆ°11111111ã€‚ ä¸Šä¸ªä¸–çºª 60 å¹´ä»£ï¼Œç¾å›½åˆ¶å®šäº†ä¸€å¥—å­—ç¬¦ç¼–ç ï¼Œå¯¹è‹±è¯­å­—ç¬¦ä¸äºŒè¿›åˆ¶ä½ä¹‹é—´çš„å…³ç³»ï¼Œåšäº†ç»Ÿä¸€è§„å®šã€‚è¿™è¢«ç§°ä¸º ASCII ç ï¼Œä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚ ASCII ç ä¸€å…±è§„å®šäº† 128 ä¸ªå­—ç¬¦çš„ç¼–ç ï¼Œæ¯”å¦‚ç©ºæ ¼SPACEæ˜¯ 32ï¼ˆäºŒè¿›åˆ¶00100000ï¼‰ï¼Œå¤§å†™çš„å­—æ¯Aæ˜¯ 65ï¼ˆäºŒè¿›åˆ¶01000001ï¼‰ã€‚è¿™ 128 ä¸ªç¬¦å·ï¼ˆåŒ…æ‹¬ 32 ä¸ªä¸èƒ½æ‰“å°å‡ºæ¥çš„æ§åˆ¶ç¬¦å·ï¼‰ï¼Œåªå ç”¨äº†ä¸€ä¸ªå­—èŠ‚çš„åé¢ 7 ä½ï¼Œæœ€å‰é¢çš„ä¸€ä½ç»Ÿä¸€è§„å®šä¸º0ã€‚ 2.é ASCII ç¼–ç è‹±è¯­ç”¨ 128 ä¸ªç¬¦å·ç¼–ç å°±å¤Ÿäº†ï¼Œä½†æ˜¯ç”¨æ¥è¡¨ç¤ºå…¶ä»–è¯­è¨€ï¼Œ128 ä¸ªç¬¦å·æ˜¯ä¸å¤Ÿçš„ã€‚æ¯”å¦‚ï¼Œåœ¨æ³•è¯­ä¸­ï¼Œå­—æ¯ä¸Šæ–¹æœ‰æ³¨éŸ³ç¬¦å·ï¼Œå®ƒå°±æ— æ³•ç”¨ ASCII ç è¡¨ç¤ºã€‚äºæ˜¯ï¼Œä¸€äº›æ¬§æ´²å›½å®¶å°±å†³å®šï¼Œåˆ©ç”¨å­—èŠ‚ä¸­é—²ç½®çš„æœ€é«˜ä½ç¼–å…¥æ–°çš„ç¬¦å·ã€‚æ¯”å¦‚ï¼Œæ³•è¯­ä¸­çš„Ã©çš„ç¼–ç ä¸º 130ï¼ˆäºŒè¿›åˆ¶10000010ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿™äº›æ¬§æ´²å›½å®¶ä½¿ç”¨çš„ç¼–ç ä½“ç³»ï¼Œå¯ä»¥è¡¨ç¤ºæœ€å¤š 256 ä¸ªç¬¦å·ã€‚ è¿™é‡Œå°±åˆå‡ºç°äº†æ–°çš„é—®é¢˜ã€‚ä¸åŒçš„å›½å®¶æœ‰ä¸åŒçš„å­—æ¯ï¼Œå› æ­¤ï¼Œå“ªæ€•å®ƒä»¬éƒ½ä½¿ç”¨ 256 ä¸ªç¬¦å·çš„ç¼–ç æ–¹å¼ï¼Œä»£è¡¨çš„å­—æ¯å´ä¸ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œ130 åœ¨æ³•è¯­ç¼–ç ä¸­ä»£è¡¨äº†Ã©ï¼Œåœ¨å¸Œä¼¯æ¥è¯­ç¼–ç ä¸­å´ä»£è¡¨äº†å­—æ¯Gimel (×’)ï¼Œåœ¨ä¿„è¯­ç¼–ç ä¸­åˆä¼šä»£è¡¨å¦ä¸€ä¸ªç¬¦å·ã€‚ä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œæ‰€æœ‰è¿™äº›ç¼–ç æ–¹å¼ä¸­ï¼Œ0â€“127 è¡¨ç¤ºçš„ç¬¦å·æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¸€æ ·çš„åªæ˜¯ 128â€“255 çš„è¿™ä¸€æ®µã€‚ è‡³äºäºšæ´²å›½å®¶çš„æ–‡å­—ï¼Œä½¿ç”¨çš„ç¬¦å·å°±æ›´å¤šäº†ï¼Œæ±‰å­—å°±å¤šè¾¾ 10 ä¸‡å·¦å³ã€‚ä¸€ä¸ªå­—èŠ‚åªèƒ½è¡¨ç¤º 256 ç§ç¬¦å·ï¼Œè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šä¸ªå­—èŠ‚è¡¨è¾¾ä¸€ä¸ªç¬¦å·ã€‚æ¯”å¦‚ï¼Œç®€ä½“ä¸­æ–‡å¸¸è§çš„ç¼–ç æ–¹å¼æ˜¯ GB2312ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥ç†è®ºä¸Šæœ€å¤šå¯ä»¥è¡¨ç¤º 256 x 256 = 65536 ä¸ªç¬¦å·ã€‚ ä¸­æ–‡ç¼–ç çš„é—®é¢˜éœ€è¦ä¸“æ–‡è®¨è®ºï¼Œæ­¤å¤„ä¸æ¶‰åŠã€‚è¿™é‡ŒåªæŒ‡å‡ºï¼Œè™½ç„¶éƒ½æ˜¯ç”¨å¤šä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œä½†æ˜¯ GB ç±»çš„æ±‰å­—ç¼–ç ä¸åæ–‡çš„ Unicode å’Œ UTF-8 æ˜¯æ¯«æ— å…³ç³»çš„ã€‚ 3.UnicodeUnicode æºäºä¸€ä¸ªå¾ˆç®€å•çš„æƒ³æ³•ï¼šå°†å…¨ä¸–ç•Œæ‰€æœ‰çš„å­—ç¬¦åŒ…å«åœ¨ä¸€ä¸ªé›†åˆé‡Œï¼Œè®¡ç®—æœºåªè¦æ”¯æŒè¿™ä¸€ä¸ªå­—ç¬¦é›†ï¼Œå°±èƒ½æ˜¾ç¤ºæ‰€æœ‰çš„å­—ç¬¦ï¼Œå†ä¹Ÿä¸ä¼šæœ‰ä¹±ç äº†ã€‚ Unicode å½“ç„¶æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é›†åˆï¼Œç°åœ¨çš„è§„æ¨¡å¯ä»¥å®¹çº³ 100 å¤šä¸‡ä¸ªç¬¦å·ã€‚æ¯ä¸ªç¬¦å·çš„ç¼–ç éƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ï¼ŒU+0639è¡¨ç¤ºé˜¿æ‹‰ä¼¯å­—æ¯Ainï¼ŒU+0041è¡¨ç¤ºè‹±è¯­çš„å¤§å†™å­—æ¯Aï¼ŒU+4E25è¡¨ç¤ºæ±‰å­—ä¸¥ã€‚å…·ä½“çš„ç¬¦å·å¯¹åº”è¡¨ï¼Œå¯ä»¥æŸ¥è¯¢unicode.orgï¼Œæˆ–è€…ä¸“é—¨çš„æ±‰å­—å¯¹åº”è¡¨ã€‚ ç ç‚¹å®ƒä» 0 å¼€å§‹ï¼Œä¸ºæ¯ä¸ªç¬¦å·æŒ‡å®šä¸€ä¸ªç¼–å·ï¼Œè¿™å«åšâ€ç ç‚¹â€ï¼ˆcode pointï¼‰ã€‚æ¯”å¦‚ï¼Œç ç‚¹ 0 çš„ç¬¦å·å°±æ˜¯ nullï¼ˆè¡¨ç¤ºæ‰€æœ‰äºŒè¿›åˆ¶ä½éƒ½æ˜¯ 0ï¼‰ã€‚ 1U+0000 = null ä¸Šå¼ä¸­ï¼ŒU+è¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„åå…­è¿›åˆ¶æ•°æ˜¯ Unicode çš„ç ç‚¹ã€‚ ç›®å‰ï¼ŒUnicode çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ 7.0 ç‰ˆï¼Œä¸€å…±æ”¶å…¥äº† 109449 ä¸ªç¬¦å·ï¼Œå…¶ä¸­çš„ä¸­æ—¥éŸ©æ–‡å­—ä¸º 74500 ä¸ªã€‚å¯ä»¥è¿‘ä¼¼è®¤ä¸ºï¼Œå…¨ä¸–ç•Œç°æœ‰çš„ç¬¦å·å½“ä¸­ï¼Œä¸‰åˆ†ä¹‹äºŒä»¥ä¸Šæ¥è‡ªä¸œäºšæ–‡å­—ã€‚æ¯”å¦‚ï¼Œä¸­æ–‡â€å¥½â€çš„ç ç‚¹æ˜¯åå…­è¿›åˆ¶çš„ 597Dã€‚ åˆ†åŒºï¼ˆåŸºæœ¬å¹³é¢&amp;&amp;è¾…åŠ©å¹³é¢ï¼‰è¿™ä¹ˆå¤šç¬¦å·ï¼ŒUnicode ä¸æ˜¯ä¸€æ¬¡æ€§å®šä¹‰çš„ï¼Œè€Œæ˜¯åˆ†åŒºå®šä¹‰ã€‚æ¯ä¸ªåŒºå¯ä»¥å­˜æ”¾ 65536 ä¸ªï¼ˆ216ï¼‰å­—ç¬¦ï¼Œç§°ä¸ºä¸€ä¸ªå¹³é¢ï¼ˆplaneï¼‰ã€‚ç›®å‰ï¼Œä¸€å…±æœ‰ 17 ä¸ªï¼ˆ25ï¼‰å¹³é¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ª Unicode å­—ç¬¦é›†çš„å¤§å°ç°åœ¨æ˜¯ 221ã€‚ æœ€å‰é¢çš„ 65536 ä¸ªå­—ç¬¦ä½ï¼Œç§°ä¸ºåŸºæœ¬å¹³é¢ï¼ˆç¼©å†™ BMPï¼‰ï¼Œå®ƒçš„ç ç‚¹èŒƒå›´æ˜¯ä» 0 ä¸€ç›´åˆ° 216-1ï¼Œå†™æˆ 16 è¿›åˆ¶å°±æ˜¯ä» U+0000 åˆ° U+FFFFã€‚æ‰€æœ‰æœ€å¸¸è§çš„å­—ç¬¦éƒ½æ”¾åœ¨è¿™ä¸ªå¹³é¢ï¼Œè¿™æ˜¯ Unicode æœ€å…ˆå®šä¹‰å’Œå…¬å¸ƒçš„ä¸€ä¸ªå¹³é¢ã€‚ å‰©ä¸‹çš„å­—ç¬¦éƒ½æ”¾åœ¨è¾…åŠ©å¹³é¢ï¼ˆç¼©å†™ SMPï¼‰ï¼Œç ç‚¹èŒƒå›´ä» U+010000 ä¸€ç›´åˆ° U+10FFFFã€‚ é—®é¢˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUnicode åªæ˜¯ä¸€ä¸ªç¬¦å·é›†ï¼Œå®ƒåªè§„å®šäº†ç¬¦å·çš„äºŒè¿›åˆ¶ä»£ç ï¼Œå´æ²¡æœ‰è§„å®šè¿™ä¸ªäºŒè¿›åˆ¶ä»£ç åº”è¯¥å¦‚ä½•å­˜å‚¨ã€‚ æ¯”å¦‚ï¼Œæ±‰å­—ä¸¥çš„ Unicode æ˜¯åå…­è¿›åˆ¶æ•°4E25ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶æ•°è¶³è¶³æœ‰ 15 ä½ï¼ˆ100111000100101ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªç¬¦å·çš„è¡¨ç¤ºè‡³å°‘éœ€è¦ 2 ä¸ªå­—èŠ‚ã€‚è¡¨ç¤ºå…¶ä»–æ›´å¤§çš„ç¬¦å·ï¼Œå¯èƒ½éœ€è¦ 3 ä¸ªå­—èŠ‚æˆ–è€… 4 ä¸ªå­—èŠ‚ï¼Œç”šè‡³æ›´å¤šã€‚ å¦‚ä½•æ‰èƒ½åŒºåˆ« Unicode å’Œ ASCII ï¼Ÿè®¡ç®—æœºæ€ä¹ˆçŸ¥é“ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œè€Œä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸‰ä¸ªç¬¦å·å‘¢ï¼Ÿ æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œè‹±æ–‡å­—æ¯åªç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå°±å¤Ÿäº†ï¼Œå¦‚æœ Unicode ç»Ÿä¸€è§„å®šï¼Œæ¯ä¸ªç¬¦å·ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªè‹±æ–‡å­—æ¯å‰éƒ½å¿…ç„¶æœ‰äºŒåˆ°ä¸‰ä¸ªå­—èŠ‚æ˜¯0ï¼Œè¿™å¯¹äºå­˜å‚¨æ¥è¯´æ˜¯æå¤§çš„æµªè´¹ï¼Œæ–‡æœ¬æ–‡ä»¶çš„å¤§å°ä¼šå› æ­¤å¤§å‡ºäºŒä¸‰å€ï¼Œè¿™æ˜¯æ— æ³•æ¥å—çš„ã€‚ 4.UTF-32 ä¸ UTF-8UTF-32æœ€ç›´è§‚çš„ç¼–ç æ–¹æ³•æ˜¯ï¼Œæ¯ä¸ªç ç‚¹ä½¿ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œå­—èŠ‚å†…å®¹ä¸€ä¸€å¯¹åº”ç ç‚¹ã€‚è¿™ç§ç¼–ç æ–¹æ³•å°±å«åš UTF-32ã€‚æ¯”å¦‚ï¼Œç ç‚¹ 0 å°±ç”¨å››ä¸ªå­—èŠ‚çš„ 0 è¡¨ç¤ºï¼Œç ç‚¹ 597D å°±åœ¨å‰é¢åŠ ä¸¤ä¸ªå­—èŠ‚çš„ 0ã€‚ 123U+0000 = 0x0000 0000U+597D = 0x0000 597D UTF-32 çš„ä¼˜ç‚¹è½¬æ¢è§„åˆ™ç®€å•ç›´è§‚ï¼ŒæŸ¥æ‰¾æ•ˆç‡é«˜ã€‚ ç¼ºç‚¹æµªè´¹ç©ºé—´ï¼ŒåŒæ ·å†…å®¹çš„è‹±è¯­æ–‡æœ¬ï¼Œå®ƒä¼šæ¯” ASCII ç¼–ç å¤§å››å€ã€‚è¿™ä¸ªç¼ºç‚¹å¾ˆè‡´å‘½ï¼Œå¯¼è‡´å®é™…ä¸Šæ²¡æœ‰äººä½¿ç”¨è¿™ç§ç¼–ç æ–¹æ³•ï¼ŒHTML 5 æ ‡å‡†å°±æ˜æ–‡è§„å®šï¼Œç½‘é¡µä¸å¾—ç¼–ç æˆ UTF-32ã€‚ UTF-8UTF-8 æ˜¯ä¸€ç§å˜é•¿çš„ç¼–ç æ–¹æ³•ï¼Œå­—ç¬¦é•¿åº¦ä» 1 ä¸ªå­—èŠ‚åˆ° 4 ä¸ªå­—èŠ‚ä¸ç­‰ã€‚è¶Šæ˜¯å¸¸ç”¨çš„å­—ç¬¦ï¼Œå­—èŠ‚è¶ŠçŸ­ï¼Œæœ€å‰é¢çš„ 128 ä¸ªå­—ç¬¦ï¼Œåªä½¿ç”¨ 1 ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä¸ ASCII ç å®Œå…¨ç›¸åŒã€‚ ç”±äº UTF-8 è¿™ç§èŠ‚çœç©ºé—´çš„ç‰¹æ€§ï¼Œå¯¼è‡´å®ƒæˆä¸ºäº’è”ç½‘ä¸Šæœ€å¸¸è§çš„ç½‘é¡µç¼–ç ã€‚ UTF-8 çš„ç¼–ç è§„åˆ™å¾ˆç®€å•ï¼Œåªæœ‰äºŒæ¡ï¼š 1ï¼‰å¯¹äºå•å­—èŠ‚çš„ç¬¦å·ï¼Œå­—èŠ‚çš„ç¬¬ä¸€ä½è®¾ä¸º0ï¼Œåé¢ 7 ä½ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ã€‚å› æ­¤å¯¹äºè‹±è¯­å­—æ¯ï¼ŒUTF-8 ç¼–ç å’Œ ASCII ç æ˜¯ç›¸åŒçš„ã€‚ 2ï¼‰å¯¹äºnå­—èŠ‚çš„ç¬¦å·ï¼ˆn &gt; 1ï¼‰ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰nä½éƒ½è®¾ä¸º1ï¼Œç¬¬n + 1ä½è®¾ä¸º0ï¼Œåé¢å­—èŠ‚çš„å‰ä¸¤ä½ä¸€å¾‹è®¾ä¸º10ã€‚å‰©ä¸‹çš„æ²¡æœ‰æåŠçš„äºŒè¿›åˆ¶ä½ï¼Œå…¨éƒ¨ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ã€‚ ç¼–ç è§„åˆ™ï¼š 1234567Unicodeç¬¦å·èŒƒå›´ | UTF-8ç¼–ç æ–¹å¼(åå…­è¿›åˆ¶) | ï¼ˆäºŒè¿›åˆ¶ï¼‰----------------------+---------------------------------------------0000 0000-0000 007F | 0xxxxxxx0000 0080-0000 07FF | 110xxxxx 10xxxxxx0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx è·Ÿæ®ä¸Šè¡¨ï¼Œè§£è¯» UTF-8 ç¼–ç éå¸¸ç®€å•ã€‚å¦‚æœä¸€ä¸ªå­—èŠ‚çš„ç¬¬ä¸€ä½æ˜¯0ï¼Œåˆ™è¿™ä¸ªå­—èŠ‚å•ç‹¬å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼›å¦‚æœç¬¬ä¸€ä½æ˜¯1ï¼Œåˆ™è¿ç»­æœ‰å¤šå°‘ä¸ª1ï¼Œå°±è¡¨ç¤ºå½“å‰å­—ç¬¦å ç”¨å¤šå°‘ä¸ªå­—èŠ‚ã€‚ ä¸‹é¢ï¼Œè¿˜æ˜¯ä»¥æ±‰å­—ä¸¥ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å®ç° UTF-8 ç¼–ç ã€‚ ä¸¥çš„ Unicode æ˜¯4E25ï¼ˆ100111000100101ï¼‰ï¼Œæ ¹æ®ä¸Šè¡¨ï¼Œå¯ä»¥å‘ç°4E25å¤„åœ¨ç¬¬ä¸‰è¡Œçš„èŒƒå›´å†…ï¼ˆ0000 0800 - 0000 FFFFï¼‰ï¼Œå› æ­¤ä¸¥çš„ UTF-8 ç¼–ç éœ€è¦ä¸‰ä¸ªå­—èŠ‚ï¼Œå³æ ¼å¼æ˜¯1110xxxx 10xxxxxx 10xxxxxxã€‚ç„¶åï¼Œä»ä¸¥çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä½å¼€å§‹ï¼Œä¾æ¬¡ä»åå‘å‰å¡«å…¥æ ¼å¼ä¸­çš„xï¼Œå¤šå‡ºçš„ä½è¡¥0ã€‚è¿™æ ·å°±å¾—åˆ°äº†ï¼Œä¸¥çš„ UTF-8 ç¼–ç æ˜¯11100100 10111000 10100101ï¼Œè½¬æ¢æˆåå…­è¿›åˆ¶å°±æ˜¯E4B8A5ã€‚ 5.UTF-16UTF-16 ç¼–ç ä»‹äº UTF-32 ä¸ UTF-8 ä¹‹é—´ï¼ŒåŒæ—¶ç»“åˆäº†å®šé•¿å’Œå˜é•¿ä¸¤ç§ç¼–ç æ–¹æ³•çš„ç‰¹ç‚¹ã€‚ å®ƒçš„ç¼–ç è§„åˆ™å¾ˆç®€å•ï¼šåŸºæœ¬å¹³é¢çš„å­—ç¬¦å ç”¨ 2 ä¸ªå­—èŠ‚ï¼Œè¾…åŠ©å¹³é¢çš„å­—ç¬¦å ç”¨ 4 ä¸ªå­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒUTF-16 çš„ç¼–ç é•¿åº¦è¦ä¹ˆæ˜¯ 2 ä¸ªå­—èŠ‚ï¼ˆU+0000 åˆ° U+FFFFï¼‰ï¼Œè¦ä¹ˆæ˜¯ 4 ä¸ªå­—èŠ‚ï¼ˆU+010000 åˆ° U+10FFFFï¼‰ã€‚ äºæ˜¯å°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘ä»¬é‡åˆ°ä¸¤ä¸ªå­—èŠ‚ï¼Œæ€ä¹ˆçœ‹å‡ºå®ƒæœ¬èº«æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œè¿˜æ˜¯éœ€è¦è·Ÿå…¶ä»–ä¸¤ä¸ªå­—èŠ‚æ”¾åœ¨ä¸€èµ·è§£è¯»ï¼Ÿ åœ¨åŸºæœ¬å¹³é¢å†…ï¼Œä» U+D800 åˆ° U+DFFF æ˜¯ä¸€ä¸ªç©ºæ®µï¼Œå³è¿™äº›ç ç‚¹ä¸å¯¹åº”ä»»ä½•å­—ç¬¦ã€‚å› æ­¤ï¼Œè¿™ä¸ªç©ºæ®µå¯ä»¥ç”¨æ¥æ˜ å°„è¾…åŠ©å¹³é¢çš„å­—ç¬¦ã€‚ å…·ä½“æ¥è¯´ï¼Œè¾…åŠ©å¹³é¢çš„å­—ç¬¦ä½å…±æœ‰ 220 ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹åº”è¿™äº›å­—ç¬¦è‡³å°‘éœ€è¦ 20 ä¸ªäºŒè¿›åˆ¶ä½ã€‚UTF-16 å°†è¿™ 20 ä½æ‹†æˆä¸¤åŠï¼Œå‰ 10 ä½æ˜ å°„åœ¨ U+D800 åˆ° U+DBFFï¼ˆç©ºé—´å¤§å° 210ï¼‰ï¼Œç§°ä¸ºé«˜ä½ï¼ˆHï¼‰ï¼Œå 10 ä½æ˜ å°„åœ¨ U+DC00 åˆ° U+DFFFï¼ˆç©ºé—´å¤§å° 210ï¼‰ï¼Œç§°ä¸ºä½ä½ï¼ˆLï¼‰ã€‚è¿™æ„å‘³ç€ï¼Œä¸€ä¸ªè¾…åŠ©å¹³é¢çš„å­—ç¬¦ï¼Œè¢«æ‹†æˆä¸¤ä¸ªåŸºæœ¬å¹³é¢çš„å­—ç¬¦è¡¨ç¤ºã€‚ ç¼–ç è§„åˆ™ æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬é‡åˆ°ä¸¤ä¸ªå­—èŠ‚ï¼Œå‘ç°å®ƒçš„ç ç‚¹åœ¨ U+D800 åˆ° U+DBFF ä¹‹é—´ï¼Œå°±å¯ä»¥æ–­å®šï¼Œç´§è·Ÿåœ¨åé¢çš„ä¸¤ä¸ªå­—èŠ‚çš„ç ç‚¹ï¼Œåº”è¯¥åœ¨ U+DC00 åˆ° U+DFFF ä¹‹é—´ï¼Œè¿™å››ä¸ªå­—èŠ‚å¿…é¡»æ”¾åœ¨ä¸€èµ·è§£è¯»ã€‚ Unicode ç ç‚¹ä¸ UTF-16 è½¬ç  é¦–å…ˆåŒºåˆ†è¿™æ˜¯åŸºæœ¬å¹³é¢å­—ç¬¦ï¼Œè¿˜æ˜¯è¾…åŠ©å¹³é¢å­—ç¬¦ã€‚å¦‚æœæ˜¯å‰è€…ï¼Œç›´æ¥å°†ç ç‚¹è½¬ä¸ºå¯¹åº”çš„åå…­è¿›åˆ¶å½¢å¼ï¼Œé•¿åº¦ä¸ºä¸¤å­—èŠ‚ã€‚ 1U+597D = 0x597D å¦‚æœæ˜¯è¾…åŠ©å¹³é¢å­—ç¬¦ï¼ŒUnicode 3.0 ç‰ˆç»™å‡ºäº†è½¬ç å…¬å¼ã€‚ 123H = Math.floor((c - 0x10000) / 0x400) + 0xd800;L = ((c - 0x10000) % 0x400) + 0xdc00; 6.JavaScript ç”¨çš„æ˜¯ UCS-2JavaScript è¯­è¨€é‡‡ç”¨ Unicode å­—ç¬¦é›†ï¼Œä½†æ˜¯åªæ”¯æŒä¸€ç§ç¼–ç æ–¹æ³•ã€‚UCS-2ï¼ äº’è”ç½‘è¿˜æ²¡å‡ºç°çš„å¹´ä»£ï¼Œæ›¾ç»æœ‰ä¸¤ä¸ªå›¢é˜Ÿï¼Œä¸çº¦è€ŒåŒæƒ³æç»Ÿä¸€å­—ç¬¦é›†ã€‚ä¸€ä¸ªæ˜¯ 1988 å¹´æˆç«‹çš„ Unicode å›¢é˜Ÿï¼Œå¦ä¸€ä¸ªæ˜¯ 1989 å¹´æˆç«‹çš„ UCS å›¢é˜Ÿã€‚ç­‰åˆ°ä»–ä»¬å‘ç°äº†å¯¹æ–¹çš„å­˜åœ¨ï¼Œå¾ˆå¿«å°±è¾¾æˆä¸€è‡´ï¼šä¸–ç•Œä¸Šä¸éœ€è¦ä¸¤å¥—ç»Ÿä¸€å­—ç¬¦é›† 1991 å¹´ 10 æœˆï¼Œä¸¤ä¸ªå›¢é˜Ÿå†³å®šåˆå¹¶å­—ç¬¦é›†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»ä»Šä»¥ååªå‘å¸ƒä¸€å¥—å­—ç¬¦é›†ï¼Œå°±æ˜¯ Unicodeï¼Œå¹¶ä¸”ä¿®è®¢æ­¤å‰å‘å¸ƒçš„å­—ç¬¦é›†ï¼ŒUCS çš„ç ç‚¹å°†ä¸ Unicode å®Œå…¨ä¸€è‡´ã€‚ ä¸¤è€…çš„å…³ç³»ç®€å•è¯´ï¼Œå°±æ˜¯ UTF-16 å–ä»£äº† UCS-2ï¼Œæˆ–è€…è¯´ UCS-2 æ•´åˆè¿›äº† UTF-16ã€‚ åœ¨ JavaScript è¯­è¨€å‡ºç°çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰ UTF-16 ç¼–ç ã€‚ ç”±äº JavaScript åªèƒ½å¤„ç† UCS-2 ç¼–ç ï¼Œé€ æˆæ‰€æœ‰å­—ç¬¦åœ¨è¿™é—¨è¯­è¨€ä¸­éƒ½æ˜¯ 2 ä¸ªå­—èŠ‚ï¼Œå¦‚æœæ˜¯ 4 ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼Œä¼šå½“ä½œä¸¤ä¸ªåŒå­—èŠ‚çš„å­—ç¬¦å¤„ç†ã€‚JavaScript çš„å­—ç¬¦å‡½æ•°éƒ½å—åˆ°è¿™ä¸€ç‚¹çš„å½±å“ï¼Œæ— æ³•è¿”å›æ­£ç¡®ç»“æœã€‚ ä»¥å­—ç¬¦ä¸ºä¾‹ï¼Œå®ƒçš„ UTF-16 ç¼–ç æ˜¯ 4 ä¸ªå­—èŠ‚çš„ 0xD834 DF06ã€‚é—®é¢˜å°±æ¥äº†ï¼Œ4 ä¸ªå­—èŠ‚çš„ç¼–ç ä¸å±äº UCS-2ï¼ŒJavaScript ä¸è®¤è¯†ï¼Œåªä¼šæŠŠå®ƒçœ‹ä½œå•ç‹¬çš„ä¸¤ä¸ªå­—ç¬¦ U+D834 å’Œ U+DF06ã€‚å‰é¢è¯´è¿‡ï¼Œè¿™ä¸¤ä¸ªç ç‚¹æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥ JavaScript ä¼šè®¤ä¸ºæ˜¯ä¸¤ä¸ªç©ºå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ï¼ ä¸Šé¢ä»£ç è¡¨ç¤ºï¼ŒJavaScript è®¤ä¸ºå­—ç¬¦çš„é•¿åº¦æ˜¯ 2ï¼Œå–åˆ°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ç©ºå­—ç¬¦ï¼Œå–åˆ°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹æ˜¯ 0xDB34ã€‚è¿™äº›ç»“æœéƒ½ä¸æ­£ç¡®ï¼ è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»å¯¹ç ç‚¹åšä¸€ä¸ªåˆ¤æ–­ï¼Œç„¶åæ‰‹åŠ¨è°ƒæ•´ã€‚ä¸‹é¢æ˜¯æ­£ç¡®çš„éå†å­—ç¬¦ä¸²çš„å†™æ³•ã€‚ 12345678while (++index &lt; length) &#123; // ... if (charCode &gt;= 0xd800 &amp;&amp; charCode &lt;= 0xdbff) &#123; output.push(character + string.charAt(++index)); &#125; else &#123; output.push(character); &#125;&#125; ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œéå†å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå¿…é¡»å¯¹ç ç‚¹åšä¸€ä¸ªåˆ¤æ–­ï¼Œåªè¦è½åœ¨ 0xD800 åˆ° 0xDBFF çš„åŒºé—´ï¼Œå°±è¦è¿åŒåé¢ 2 ä¸ªå­—èŠ‚ä¸€èµ·è¯»å–ã€‚ ç±»ä¼¼çš„é—®é¢˜å­˜åœ¨äºæ‰€æœ‰çš„ JavaScript å­—ç¬¦æ“ä½œå‡½æ•°ã€‚ String.prototype.replace() String.prototype.substring() String.prototype.slice() â€¦ ä¸Šé¢çš„å‡½æ•°éƒ½åªå¯¹ 2 å­—èŠ‚çš„ç ç‚¹æœ‰æ•ˆã€‚è¦æ­£ç¡®å¤„ç† 4 å­—èŠ‚çš„ç ç‚¹ï¼Œå°±å¿…é¡»é€ä¸€éƒ¨ç½²è‡ªå·±çš„ç‰ˆæœ¬ï¼Œåˆ¤æ–­ä¸€ä¸‹å½“å‰å­—ç¬¦çš„ç ç‚¹èŒƒå›´ã€‚ 7.ES6ECMAScript 6ï¼ˆç®€ç§° ES6ï¼‰ï¼Œå¤§å¹…å¢å¼ºäº† Unicode æ”¯æŒï¼ŒåŸºæœ¬ä¸Šè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ ï¼ˆ1ï¼‰æ­£ç¡®è¯†åˆ«å­—ç¬¦ ES6 å¯ä»¥è‡ªåŠ¨è¯†åˆ« 4 å­—èŠ‚çš„ç ç‚¹ã€‚å› æ­¤ï¼Œéå†å­—ç¬¦ä¸²å°±ç®€å•å¤šäº†ã€‚ 123for (let s of string) &#123; // ...&#125; ä½†æ˜¯ï¼Œä¸ºäº†ä¿æŒå…¼å®¹ï¼Œlength å±æ€§è¿˜æ˜¯åŸæ¥çš„è¡Œä¸ºæ–¹å¼ã€‚ä¸ºäº†å¾—åˆ°å­—ç¬¦ä¸²çš„æ­£ç¡®é•¿åº¦ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼ã€‚ 1Array.from(string).length; ï¼ˆ2ï¼‰ç ç‚¹è¡¨ç¤ºæ³• JavaScript å…è®¸ç›´æ¥ç”¨ç ç‚¹è¡¨ç¤º Unicode å­—ç¬¦ï¼Œå†™æ³•æ˜¯â€åæ–œæ +u+ç ç‚¹â€ã€‚ 1\"å¥½\" === \"\\u597D\"; // true ä½†æ˜¯ï¼Œè¿™ç§è¡¨ç¤ºæ³•å¯¹ 4 å­—èŠ‚çš„ç ç‚¹æ— æ•ˆã€‚ES6 ä¿®æ­£äº†è¿™ä¸ªé—®é¢˜ï¼Œåªè¦å°†ç ç‚¹æ”¾åœ¨å¤§æ‹¬å·å†…ï¼Œå°±èƒ½æ­£ç¡®è¯†åˆ«ã€‚ ï¼ˆ3ï¼‰å­—ç¬¦ä¸²å¤„ç†å‡½æ•° ES6 æ–°å¢äº†å‡ ä¸ªä¸“é—¨å¤„ç† 4 å­—èŠ‚ç ç‚¹çš„å‡½æ•°ã€‚ String.fromCodePoint()ï¼šä» Unicode ç ç‚¹è¿”å›å¯¹åº”å­—ç¬¦ String.prototype.codePointAt()ï¼šä»å­—ç¬¦è¿”å›å¯¹åº”çš„ç ç‚¹ String.prototype.at()ï¼šè¿”å›å­—ç¬¦ä¸²ç»™å®šä½ç½®çš„å­—ç¬¦ ï¼ˆ4ï¼‰æ­£åˆ™è¡¨è¾¾å¼ ES6 æä¾›äº† u ä¿®é¥°ç¬¦ï¼Œå¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ  4 å­—èŠ‚ç ç‚¹çš„æ”¯æŒã€‚ ï¼ˆ5ï¼‰Unicode æ­£è§„åŒ– æœ‰äº›å­—ç¬¦é™¤äº†å­—æ¯ä»¥å¤–ï¼Œè¿˜æœ‰é™„åŠ ç¬¦å·ã€‚æ¯”å¦‚ï¼Œæ±‰è¯­æ‹¼éŸ³çš„ Ç‘ï¼Œå­—æ¯ä¸Šé¢çš„å£°è°ƒå°±æ˜¯é™„åŠ ç¬¦å·ã€‚å¯¹äºè®¸å¤šæ¬§æ´²è¯­è¨€æ¥è¯´ï¼Œå£°è°ƒç¬¦å·æ˜¯éå¸¸é‡è¦çš„ã€‚ Unicode æä¾›äº†ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ã€‚ä¸€ç§æ˜¯å¸¦é™„åŠ ç¬¦å·çš„å•ä¸ªå­—ç¬¦ï¼Œå³ä¸€ä¸ªç ç‚¹è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚ Ç‘ çš„ç ç‚¹æ˜¯ U+01D1ï¼›å¦ä¸€ç§æ˜¯å°†é™„åŠ ç¬¦å·å•ç‹¬ä½œä¸ºä¸€ä¸ªç ç‚¹ï¼Œä¸ä¸»ä½“å­—ç¬¦å¤åˆæ˜¾ç¤ºï¼Œå³ä¸¤ä¸ªç ç‚¹è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚ Ç‘ å¯ä»¥å†™æˆ Oï¼ˆU+004Fï¼‰ + Ë‡ï¼ˆU+030Cï¼‰ã€‚ 1234567// æ–¹æ³•ä¸€\"\\u01D1\";// 'Ç‘'// æ–¹æ³•äºŒ\"\\u004F\\u030C\";// 'Ç‘' è¿™ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œè§†è§‰å’Œè¯­ä¹‰éƒ½å®Œå…¨ä¸€æ ·ï¼Œç†åº”ä½œä¸ºç­‰åŒæƒ…å†µå¤„ç†ã€‚ä½†æ˜¯ï¼ŒJavaScript æ— æ³•è¾¨åˆ«ã€‚ 12\"\\u01D1\" === \"\\u004F\\u030C\";//false ES6 æä¾›äº† normalize æ–¹æ³•ï¼Œå…è®¸â€œUnicode æ­£è§„åŒ–â€ï¼Œå³å°†ä¸¤ç§æ–¹æ³•è½¬ä¸ºåŒæ ·çš„åºåˆ—ã€‚ 12\"\\u01D1\".normalize() === \"\\u004F\\u030C\".normalize();// true 8.æ€»ç»“æˆªå–å«æœ‰å››å­—èŠ‚å­—ç¬¦çš„å­—ç¬¦ä¸²ä¸ä¼šå‡ºç°ä¹±ç çš„æ–¹æ³•12let nickname = \"éæ‹‰ğŸ’éæ‹‰\";nickname.length; // 6 Array.from æ–¹æ³•Array.fromè¿™ä¸ªæ–¹æ³•èƒ½å¤Ÿå°†ç±»æ•°ç»„è½¬æ¢ä¸ºçœŸå®çš„æ•°ç»„ï¼Œæ¯”å¦‚NodeList, argumentç­‰ï¼ŒåŒæ ·ï¼Œä¹ŸåŒ…æ‹¬å­—ç¬¦ä¸²ã€‚ 12Array.from(nickname); // [\"é\", \"æ‹‰\", \"ğŸ’\", \"é\", \"æ‹‰\"]nickname.split(\"\"); // [\"é\", \"æ‹‰\", \"ï¿½\", \"ï¿½\", \"é\", \"æ‹‰\"] ä½¿ç”¨ Array.from æŠŠ nickname è½¬æ¢åï¼Œå¯ä»¥çœ‹åˆ°è½¬æ¢æˆä¸€ä¸ªçœŸå®çš„æ•°ç»„äº†ï¼Œæ¨±æ¡ƒå­—ç¬¦å äº†æ•°ç»„ä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œç„¶åæŒ‰ç…§æ•°ç»„ä¸­çš„æ–¹æ³•æˆªå–å†è¿›è¡Œæ‹¼æ¥å³å¯ï¼Œè€Œä½¿ç”¨ split æ–¹æ³•æ‹†åˆ†ï¼Œåˆ™è¿˜æ˜¯ä¹±ç ï¼š 123456function truncated(str, num) &#123; return Array.from(str) .slice(0, num) .join(\"\");&#125;truncated(nickname, 3); // éæ‹‰ğŸ’ codePointAt()æ–¹æ³•åœ¨ ES6 ä¹‹å‰ï¼Œ JS çš„å­—ç¬¦ä¸²ä»¥ 16 ä½å­—ç¬¦ç¼–ç (UTF-16)ä¸ºåŸºç¡€ã€‚æ¯ä¸ª 16 ä½åºåˆ—(ç›¸å½“äº 2 ä¸ªå­—èŠ‚)æ˜¯ä¸€ä¸ªç¼–ç å•å…ƒ(code unit)ï¼Œå¯ç®€ç§°ä¸ºç å…ƒï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚å­—ç¬¦ä¸²æ‰€æœ‰çš„å±æ€§ä¸æ–¹æ³•(å¦‚ length å±æ€§ä¸ charAt() æ–¹æ³•ç­‰)éƒ½æ˜¯åŸºäº 16 ä½åºåˆ—ã€‚ æ¯”å¦‚ length æ–¹æ³•ã€nickname[2]ã€split æ–¹æ³•ç­‰æ“ä½œï¼Œéƒ½ä¼šäº§ç”Ÿå¼‚å¸¸ã€‚ä¸ºæ­¤åœ¨ ES6 ä¸­ï¼ŒåŠ å¼ºäº†å¯¹ Unicode çš„æ”¯æŒï¼Œå¹¶ä¸”æ‰©å±•äº†å­—ç¬¦ä¸²å¯¹è±¡ã€‚ å¯¹äº Unicode ç ç‚¹å¤§äº 0xFFFF çš„å­—ç¬¦ï¼Œæ˜¯ä½¿ç”¨ 4 ä¸ªå­—èŠ‚è¿›è¡Œå­˜å‚¨ã€‚ES6 æä¾›äº†codePointAtæ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç† 4 ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹ã€‚ 12345// è·å–æ¨±æ¡ƒçš„ç ç‚¹\"ğŸ’\".codePointAt(0).toString(16); // 1f352// è¾“å‡ºç ç‚¹å¯¹åº”çš„å­—ç¬¦(\"\\u&#123;1f352&#125;\"); // ğŸ’ è¯·æ³¨æ„ï¼š åœ¨ä¹‹å‰ Unicode ç¼–ç ï¼Œå‡åœ¨[\\u000-\\uFFFF]ä¹‹é—´ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ç±»ä¼¼\\u0047è¿™æ ·çš„ç¼–ç ï¼›ä½†æ˜¯ç°åœ¨ç ç‚¹è¶…è¿‡\\uFFFFçš„ç•Œé™ï¼Œè‹¥å†è¿™æ ·ä½¿ç”¨ï¼Œåˆ™è·å–ä¸åˆ°å¯¹åº”çš„å­—ç¬¦ã€‚å› æ­¤åœ¨ ES6 ä¸­ï¼Œç ç‚¹çš„å­—ç¬¦æ”¾åœ¨ä¸­æ‹¬å·å†…ï¼Œç±»ä¼¼ä¸Šé¢çš„æ ¼å¼ï¼ˆæ‰€æœ‰çš„ç ç‚¹å‡å¯ä»¥ä½¿ç”¨è¿™ç§æ ¼å¼ï¼‰ï¼š 123\"\\u&#123;1f352&#125;\"; // ğŸ’\"\\u&#123;47&#125;\"; // G\"\\u&#123;0047&#125;\"; // G é‚£ä¹ˆå°±å®¹æ˜“äº†ï¼šåˆ¤æ–­éœ€è¦æˆªå–çš„ä½ç½®æ˜¯å¦æ­£å¥½æ˜¯ 4 å­—èŠ‚çš„å­—ç¬¦ï¼Œå¦‚æœæ˜¯åˆ™å»¶é•¿ä¸€ä½æˆªå–ï¼Œå¦åˆ™æ­£å¸¸æˆªå–ï¼š 12345function truncated(str, num) &#123; let index = Array.from(str)[num - 1].codePointAt(0) &gt; 0xffff ? num + 1 : num; return str.slice(0, index);&#125;truncated(nickname, 3); // éæ‹‰ğŸ’ for-offor-inæ–¹æ³•æ˜¯éå† key å€¼ï¼Œfor-ofæ˜¯éå† value å€¼ï¼š 123456789101112let arr = [\"a\", \"b\", \"c\"];for (let k in arr) &#123; console.log(k); // 0 1 2&#125;for (let v of arr) &#123; console.log(v); // a b c&#125;for (let v of nickname) &#123; console.log(v); // é æ‹‰ ğŸ’ é æ‹‰&#125; å› æ­¤åˆ©ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½è¿›è¡Œæˆªå–ï¼š 123456789101112function truncated(str, num) &#123; let s = \"\"; for (let v of nickname) &#123; s += v; num--; if (num &lt;= 0) &#123; break; &#125; &#125; return s;&#125;truncated(nickname, 3); æ­£ç¡®è¾“å‡ºå­—ç¬¦ä¸²çš„å­—ç¬¦ä¸ªæ•°ï¼š1234567891011function getLen(str) &#123; var len = str.length; for (var i = 0; i &lt; len; i++) &#123; var charCode = str.charCodeAt(i); if (charCode &gt;= 0xd800 &amp;&amp; charCode &lt;= 0xdbff) &#123; len--; i++; &#125; &#125; return len;&#125; 1Array.from(str).length; 9.string.lengthstring.length è¿”å›çš„æ˜¯ä»€ä¹ˆ å­—ç¬¦çš„ä¸ªæ•°è¿˜æ˜¯å­—èŠ‚æ•°ï¼Ÿä¸ºä»€ä¹ˆä¼šä¸å®é™…é•¿åº¦ä¸ä¸€æ ·ï¼Ÿç¼–ç çš„éƒ¨åˆ†è¯¦ç»†è¯´string.length():è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚æ˜¯ç¬¦åˆå­—ç¬¦ä¸²å†…å®¹çš„å®é™…å­—èŠ‚æ•°ï¼Œä¸ä¸€å®šç­‰äºå…¶å®¹é‡ã€‚ string.size()å’Œ string.length()æ˜¯åŒä¹‰è¯ï¼Œå¹¶è¿”å›å®Œå…¨ç›¸åŒçš„å€¼ã€‚ string.max_size()ï¼šè¿”å›å­—ç¬¦ä¸²çš„æœ€å¤§å¤§å°ï¼Œè¿”å›å­—ç¬¦ä¸²å¯ä»¥è¾¾åˆ°çš„æœ€å¤§é•¿åº¦ã€‚ string.resize():string.resize(n)ï¼šæŠŠå­—ç¬¦ä¸²çš„é•¿åº¦è®¾ç½®ä¸º n ä¸ªå­—ç¬¦å¦‚æœ n å°äºå½“å‰å­—ç¬¦ä¸²é•¿åº¦ ï¼Œåˆ™åªæˆªå–å‰ n ä¸ªå­—ç¬¦ï¼Œåˆ é™¤è¶…å‡ºç¬¬ n ä¸ªå­—ç¬¦çš„å­—ç¬¦ã€‚å¦‚æœå¤§äºï¼Œåˆ™åœ¨æœ«ç«¯æ’å…¥å°½å¯èƒ½å¤šçš„å­—ç¬¦æ¥æ‰©å±•å½“å‰å†…å®¹ï¼Œä»¥è¾¾åˆ°å¤§å° nã€‚ å¦‚æœæŒ‡å®š cï¼Œåˆ™æ–°å…ƒç´ å°†åˆå§‹åŒ–ä¸º c çš„å‰¯æœ¬ï¼Œå¦åˆ™ä¸ºå€¼åˆå§‹åŒ–å­—ç¬¦ï¼ˆç©ºå­—ç¬¦ï¼‰ã€‚ string.capacity()ï¼šè¿”å›å·²åˆ†é…å­˜å‚¨çš„å¤§å°ã€‚å½“å‰ä¸ºå­—ç¬¦ä¸²åˆ†é…çš„å­˜å‚¨ç©ºé—´çš„å¤§å°ï¼Œä»¥å­—èŠ‚è¡¨ç¤ºã€‚ æ­¤å®¹é‡ä¸ä¸€å®šç­‰äºå­—ç¬¦ä¸²é•¿åº¦ã€‚ å®ƒå¯ä»¥ç›¸ç­‰æˆ–æ›´å¤§ï¼Œé¢å¤–çš„ç©ºé—´å…è®¸å¯¹è±¡åœ¨å°†æ–°å­—ç¬¦æ·»åŠ åˆ°å­—ç¬¦ä¸²æ—¶ä¼˜åŒ–å…¶æ“ä½œã€‚","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"å¸¸ç”¨çš„æ­£åˆ™","slug":"å¸¸ç”¨çš„æ­£åˆ™","date":"2019-03-29T14:07:27.000Z","updated":"2019-11-10T14:37:39.036Z","comments":true,"path":"2019/03/29/å¸¸ç”¨çš„æ­£åˆ™/","link":"","permalink":"http://yoursite.com/2019/03/29/å¸¸ç”¨çš„æ­£åˆ™/","excerpt":"æ­£åˆ™1.æ ¡éªŒæ•°å­—123456789101112131415161718æ•°å­—ï¼š^\\d*$nä½çš„æ•°å­—ï¼š^\\d&#123;n&#125;$è‡³å°‘nä½çš„æ•°å­—ï¼š^\\d&#123;n,&#125;$m-nä½çš„æ•°å­—ï¼š^\\d&#123;m,n&#125;$é›¶å’Œéé›¶å¼€å¤´çš„æ•°å­—ï¼š^(0|[1-9][0-9]*)$éé›¶å¼€å¤´çš„æœ€å¤šå¸¦ä¸¤ä½å°æ•°çš„æ•°å­—ï¼š^([1-9]\\d*)+(\\.\\d&#123;1,2&#125;)?$å¸¦1-2ä½å°æ•°çš„æ­£æ•°æˆ–è´Ÿæ•°ï¼š^(\\-)?\\d+\\.\\d&#123;1,2&#125;$æ­£æ•°ã€è´Ÿæ•°ã€å’Œå°æ•°ï¼š^(\\-)?\\d+(\\.\\d+)?$æœ‰ä¸¤ä½å°æ•°çš„æ­£å®æ•°ï¼š^\\d+\\.\\d&#123;2&#125;$æœ‰1~3ä½å°æ•°çš„æ­£å®æ•°ï¼š^\\d+\\.\\d&#123;1,3&#125;$éé›¶çš„æ­£æ•´æ•°ï¼š^[1-9]\\d*$éé›¶çš„è´Ÿæ•´æ•°ï¼š^-[1-9]\\d*$éæ­£æ•´æ•°ï¼š^-[1-9]\\d*|0$ æˆ– ^((-\\d+)|(0+))$éè´Ÿæµ®ç‚¹æ•°ï¼š^\\d+(\\.\\d+)?$ æˆ– ^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0$éæ­£æµ®ç‚¹æ•°ï¼š^((-\\d+(\\.\\d+)?)|(0+(\\.0+)?))$ æˆ– ^(-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*))|0?\\.0+|0$æ­£æµ®ç‚¹æ•°ï¼š^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*$ æˆ– ^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$è´Ÿæµ®ç‚¹æ•°ï¼š^-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*)$ æˆ– ^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$æµ®ç‚¹æ•°ï¼š^(-?\\d+)(\\.\\d+)?$ æˆ– ^-?([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0)$","text":"æ­£åˆ™1.æ ¡éªŒæ•°å­—123456789101112131415161718æ•°å­—ï¼š^\\d*$nä½çš„æ•°å­—ï¼š^\\d&#123;n&#125;$è‡³å°‘nä½çš„æ•°å­—ï¼š^\\d&#123;n,&#125;$m-nä½çš„æ•°å­—ï¼š^\\d&#123;m,n&#125;$é›¶å’Œéé›¶å¼€å¤´çš„æ•°å­—ï¼š^(0|[1-9][0-9]*)$éé›¶å¼€å¤´çš„æœ€å¤šå¸¦ä¸¤ä½å°æ•°çš„æ•°å­—ï¼š^([1-9]\\d*)+(\\.\\d&#123;1,2&#125;)?$å¸¦1-2ä½å°æ•°çš„æ­£æ•°æˆ–è´Ÿæ•°ï¼š^(\\-)?\\d+\\.\\d&#123;1,2&#125;$æ­£æ•°ã€è´Ÿæ•°ã€å’Œå°æ•°ï¼š^(\\-)?\\d+(\\.\\d+)?$æœ‰ä¸¤ä½å°æ•°çš„æ­£å®æ•°ï¼š^\\d+\\.\\d&#123;2&#125;$æœ‰1~3ä½å°æ•°çš„æ­£å®æ•°ï¼š^\\d+\\.\\d&#123;1,3&#125;$éé›¶çš„æ­£æ•´æ•°ï¼š^[1-9]\\d*$éé›¶çš„è´Ÿæ•´æ•°ï¼š^-[1-9]\\d*$éæ­£æ•´æ•°ï¼š^-[1-9]\\d*|0$ æˆ– ^((-\\d+)|(0+))$éè´Ÿæµ®ç‚¹æ•°ï¼š^\\d+(\\.\\d+)?$ æˆ– ^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0$éæ­£æµ®ç‚¹æ•°ï¼š^((-\\d+(\\.\\d+)?)|(0+(\\.0+)?))$ æˆ– ^(-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*))|0?\\.0+|0$æ­£æµ®ç‚¹æ•°ï¼š^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*$ æˆ– ^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$è´Ÿæµ®ç‚¹æ•°ï¼š^-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*)$ æˆ– ^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$æµ®ç‚¹æ•°ï¼š^(-?\\d+)(\\.\\d+)?$ æˆ– ^-?([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0)$ 2.æ ¡éªŒå­—ç¬¦çš„è¡¨è¾¾å¼123456789101112æ±‰å­—ï¼š^[\\u4e00-\\u9fa5]+$è‹±æ–‡å’Œæ•°å­—ï¼š^[A-Za-z0-9]+$é•¿åº¦ä¸º3-20çš„æ‰€æœ‰å­—ç¬¦ï¼š^.&#123;3,20&#125;$ç”±26ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z]+$ç”±26ä¸ªå¤§å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Z]+$ç”±26ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[a-z]+$ç”±æ•°å­—å’Œ26ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z0-9]+$ç”±æ•°å­—ã€26ä¸ªè‹±æ–‡å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^\\w+$ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—åŒ…æ‹¬ä¸‹åˆ’çº¿ï¼š^[\\u4E00-\\u9FA5A-Za-z0-9_]+$ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—ä½†ä¸åŒ…æ‹¬ä¸‹åˆ’çº¿ç­‰ç¬¦å·ï¼š^[\\u4E00-\\u9FA5A-Za-z0-9]+$å¯ä»¥è¾“å…¥å«æœ‰^%&amp;',;=?$\\\"ç­‰å­—ç¬¦ï¼š[^%&amp;',;=?$\\x22]+ç¦æ­¢è¾“å…¥å«æœ‰~çš„å­—ç¬¦ï¼š[^~\\x22]+ 3.ç‰¹æ®Šéœ€æ±‚è¡¨è¾¾å¼1234567891011121314Emailåœ°å€ï¼š^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$åŸŸåï¼š[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?InternetURLï¼š[a-zA-z]+://[^\\s]* æˆ– ^http://([\\w-]+\\.)+[\\w-]+(/[\\w-./?%&amp;=]*)?$å›½å†…æ‰‹æœºå·ç ï¼š^1[34578]&#123;1&#125;\\d&#123;9&#125;å¸å·æ˜¯å¦åˆæ³•(å­—æ¯å¼€å¤´ï¼Œå…è®¸5-16å­—èŠ‚ï¼Œå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿)ï¼š^[a-zA-Z]\\w&#123;4,15&#125;$å¯†ç (ä»¥å­—æ¯å¼€å¤´ï¼Œé•¿åº¦åœ¨6~18ä¹‹é—´ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿)ï¼š^[a-zA-Z]\\w&#123;5,17&#125;$å¼ºå¯†ç (å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„ç»„åˆï¼Œä¸èƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨8-10ä¹‹é—´)ï¼š^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$æ—¥æœŸæ ¼å¼ï¼š^\\d&#123;4&#125;-\\d&#123;1,2&#125;-\\d&#123;1,2&#125;ä¸€å¹´çš„12ä¸ªæœˆ(01ï½09å’Œ1ï½12)ï¼š^(0?[1-9]|1[0-2])$ä¸€ä¸ªæœˆçš„31å¤©(01ï½09å’Œ1ï½31)ï¼š^((0?[1-9])|((1|2)[0-9])|30|31)$è…¾è®¯QQå·ï¼š[1-9][0-9]&#123;4,&#125; (è…¾è®¯QQå·ä»10000å¼€å§‹)IPåœ°å€ï¼š\\d+\\.\\d+\\.\\d+\\.\\d+ (æå–IPåœ°å€æ—¶æœ‰ç”¨)IPåœ°å€ï¼š^(\\d&#123;1,2&#125;|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d&#123;1,2&#125;|1\\d\\d|2[0-4]\\d|25[0-5]))&#123;3&#125;$xmlæ–‡ä»¶ï¼š^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\\\.[x|X][m|M][l|L]$","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"æ­£åˆ™","slug":"æ­£åˆ™","permalink":"http://yoursite.com/tags/æ­£åˆ™/"}]},{"title":"ç§»åŠ¨ç«¯çš„è§¦å±äº‹ä»¶","slug":"ç§»åŠ¨ç«¯çš„è§¦å±äº‹ä»¶","date":"2019-03-22T08:28:36.000Z","updated":"2019-11-10T14:37:39.040Z","comments":true,"path":"2019/03/22/ç§»åŠ¨ç«¯çš„è§¦å±äº‹ä»¶/","link":"","permalink":"http://yoursite.com/2019/03/22/ç§»åŠ¨ç«¯çš„è§¦å±äº‹ä»¶/","excerpt":"ç§»åŠ¨ç«¯çš„è§¦å±äº‹ä»¶1.åŸç”Ÿè§¦æ‘¸äº‹ä»¶ï¼ˆtouch ç±»äº‹ä»¶ï¼‰åœ¨ç§»åŠ¨ç«¯ï¼ŒåŸç”Ÿè§¦æ‘¸äº‹ä»¶åªæœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼Œå…¶ä»–æ‰€æœ‰çš„è§¦æ‘¸äº‹ä»¶éƒ½æ˜¯ç”±è¿™ä¸‰ç§äº‹ä»¶ç›¸ç»“åˆäº§ç”Ÿçš„ï¼Œä¾‹å¦‚ï¼Œä¸Šåˆ’ã€ä¸‹æ»‘ã€å·¦æ»‘ã€å³æ»‘ã€åŒå‡»ç­‰ç­‰ï¼›","text":"ç§»åŠ¨ç«¯çš„è§¦å±äº‹ä»¶1.åŸç”Ÿè§¦æ‘¸äº‹ä»¶ï¼ˆtouch ç±»äº‹ä»¶ï¼‰åœ¨ç§»åŠ¨ç«¯ï¼ŒåŸç”Ÿè§¦æ‘¸äº‹ä»¶åªæœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼Œå…¶ä»–æ‰€æœ‰çš„è§¦æ‘¸äº‹ä»¶éƒ½æ˜¯ç”±è¿™ä¸‰ç§äº‹ä»¶ç›¸ç»“åˆäº§ç”Ÿçš„ï¼Œä¾‹å¦‚ï¼Œä¸Šåˆ’ã€ä¸‹æ»‘ã€å·¦æ»‘ã€å³æ»‘ã€åŒå‡»ç­‰ç­‰ï¼› è¿™ä¸‰ç§åŸç”Ÿè§¦æ‘¸äº‹ä»¶ä¸ºï¼š touchstartï¼šå¼€å§‹è§¦æ‘¸ touchmoveï¼šè§¦æ‘¸è¿‡ç¨‹ä¸­ touchendï¼šè§¦æ‘¸ç»“æŸ å¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªè§¦æ‘¸è¢«ç³»ç»Ÿå–æ¶ˆçš„äº‹ä»¶ï¼štouchcancelï¼ˆç”±æ›´é«˜çº§çš„äº‹ä»¶æ‰“æ–­å½“å‰æ­£åœ¨æ‰§è¡Œçš„ç§»åŠ¨ç«¯äº‹ä»¶æ—¶ï¼Œä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªäº‹ä»¶ä¸­ä¿å­˜å½“å‰ç›¸å…³çš„è§¦ç¢°äº‹ä»¶æ“ä½œçš„æ•°æ®ï¼Œä»¥ä¿è¯ç”¨æˆ·å›åˆ°é¡µé¢åæ¥ç€åˆšæ‰æ–­å¼€çš„ä½ç½®ç»§ç»­æ“ä½œï¼‰ï¼› è§¦æ‘¸äº‹ä»¶ä¸‹çš„ä¸€äº›ç›¸å…³å±æ€§ targetTouchesï¼šå¯è·å–åˆ°äº‹ä»¶å¯¹è±¡ä¸‹çš„è§¦æ‘¸ç‚¹ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ªç±»æ•°ç»„çš„ç»“æ„ï¼ŒåŒæ—¶è§¦å‘è¿™ä¸ªäº‹ä»¶çš„æ‰‹æŒ‡æœ‰å‡ ä¸ªï¼Œåˆ™æ•°ç»„ä¸­å°±æœ‰å‡ ä¸ªå…ƒç´ ã€‚è§¦æ‘¸ç‚¹çš„ç›¸å…³åæ ‡æ•°æ®å°±å­˜åœ¨è¿™äº›å¯¹è±¡ä¸­ã€‚ pageX\\pageY:åæ ‡ç³»åŸç‚¹åœ¨é¡µé¢çš„å·¦ä¸Šè§’ï¼› screenX\\screenY:åæ ‡ç³»çš„åŸç‚¹åœ¨å±å¹•çš„å·¦ä¸Šè§’ç‚¹ï¼ˆä¸åŒ…å«æ“ä½œç³»ç»Ÿåœ¨å·¦ä¸Šè§’çš„ç»„ä»¶ï¼‰ï¼› clientX\\clientY:è§¦æ‘¸ç›®æ ‡åœ¨è§†å£ä¸­çš„åæ ‡ï¼ŒåŸç‚¹åœ¨è§†å£å·¦ä¸Šè§’(é€‚å£è§†ç”¨æ¥å±•ç¤º html ä»£ç çš„å®¹å™¨)ï¼› targer:ä¿å­˜çš„æ˜¯è§¦å‘äº‹ä»¶çš„æ ‡ç­¾ï¼Œä½¿ç”¨äº‹ä»¶å§”æ‰˜æ—¶å¯ä»¥é€šè¿‡è¯¥å±æ€§è·å–åˆ°è§¦å‘è¯¥äº‹ä»¶çš„æ ‡ç­¾å¯¹è±¡ï¼› identifier:ID å€¼ï¼Œå”¯ä¸€æ ‡ç¤ºäº†æ‰‹æŒ‡è§¦æ‘¸ç‚¹ï¼Œå¦‚æœæ‰‹æŒ‡åœ¨å±å¹•ä¸Šäº§ç”Ÿç§»åŠ¨ï¼ˆå¦‚æœæœ‰å¤šä¸ªè§¦æ‘¸ç‚¹ï¼Œåˆ™å¯ä»¥æ ¹æ®è¿™ä¸ª id å€¼è·Ÿè¸ªå¯¹åº”çš„è§¦æ‘¸ç‚¹ï¼‰ï¼› event å¯¹è±¡ï¼šç”±äºæ‰‹æœºç«¯çš„æ‰‹æŒ‡è§¦å‘ä¸æ˜¯å•ä¸ªçš„ï¼Œæ‰€ä»¥åœ¨ event é‡Œé¢ç”Ÿæˆçš„ä¸è§¦æ‘¸æœ‰å…³çš„æ•°æ®éƒ½æ˜¯ä»¥æ•°ç»„çš„å½¢å¼åˆ—å‡ºæ¥çš„ï¼Œæœ‰ä»¥ä¸‹ä¸‰ä¸ªï¼š touchesï¼šè¡¨ç¤ºå½“å‰è·Ÿè¸ªçš„è§¦æ‘¸æ“ä½œçš„ touch å¯¹è±¡çš„æ•°ç»„ã€‚å½“å‰å±å¹•ä¸Šæ‰€æœ‰è§¦æ‘¸ç‚¹çš„é›†åˆåˆ—è¡¨ targetTouchesï¼šç‰¹å®šäºäº‹ä»¶ç›®æ ‡çš„ Touch å¯¹è±¡çš„æ•°ç»„ã€‚ç»‘å®šäº‹ä»¶çš„é‚£ä¸ªç»“ç‚¹ä¸Šçš„è§¦æ‘¸ç‚¹çš„é›†åˆåˆ—è¡¨ changedTouchesï¼šè¡¨ç¤ºè‡ªä¸Šæ¬¡è§¦æ‘¸ä»¥æ¥å‘ç”Ÿäº†ä»€ä¹ˆæ”¹å˜çš„ Touch å¯¹è±¡çš„æ•°ç»„ã€‚è§¦å‘äº‹ä»¶æ—¶æ”¹å˜çš„è§¦æ‘¸ç‚¹çš„é›†åˆ 2.è§¦ç¢°äº‹ä»¶ï¼ˆtap ç±»äº‹ä»¶ï¼‰è§¦ç¢°äº‹ä»¶ï¼Œæˆ‘ç›®å‰è¿˜ä¸çŸ¥é“å®ƒå’Œ touch çš„åŒºåˆ«ï¼Œä¸€èˆ¬ç”¨äºä»£æ›¿ click äº‹ä»¶ tap: æ‰‹æŒ‡ç¢°ä¸€ä¸‹å±å¹•ä¼šè§¦å‘ longTap: æ‰‹æŒ‡é•¿æŒ‰å±å¹•ä¼šè§¦å‘ singleTap: æ‰‹æŒ‡ç¢°ä¸€ä¸‹å±å¹•ä¼šè§¦å‘ doubleTap: æ‰‹æŒ‡åŒå‡»å±å¹•ä¼šè§¦å‘ 3.æ»‘åŠ¨äº‹ä»¶ï¼ˆswipe ç±»äº‹ä»¶ï¼‰æ»‘åŠ¨äº‹ä»¶ swipeï¼šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šæ»‘åŠ¨æ—¶ä¼šè§¦å‘ swipeLeftï¼šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šå‘å·¦æ»‘åŠ¨æ—¶ä¼šè§¦å‘ swipeRightï¼šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šå‘å³æ»‘åŠ¨æ—¶ä¼šè§¦å‘ swipeUpï¼šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šå‘ä¸Šæ»‘åŠ¨æ—¶ä¼šè§¦å‘ swipeDownï¼šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šå‘ä¸‹æ»‘åŠ¨æ—¶ä¼šè§¦å‘ 4.è‡ªå®šä¹‰æ‰‹åŠ¿äº‹ä»¶ gestureæ‰‹åŠ¿äº‹ä»¶åªæ˜¯æ¦‚å¿µå‹ï¼Œç›®å‰è¿˜æ²¡æœ‰æµè§ˆå™¨åŸç”Ÿæ”¯æŒï¼ŒæŒ‰ç…§æ¦‚å¿µå¯åˆ†ä¸º gesturestart gesturechange gestureend ä¸‰ç§äº‹ä»¶ gesturestartï¼šå½“æœ‰ä¸¤æ ¹æˆ–å¤šæ ¹æ‰‹æŒ‡æ”¾åˆ°å±å¹•ä¸Šçš„æ—¶å€™è§¦å‘ gesturechangeï¼šå½“æœ‰ä¸¤æ ¹æˆ–å¤šæ ¹æ‰‹æŒ‡åœ¨å±å¹•ä¸Šï¼Œå¹¶ä¸”æœ‰æ‰‹æŒ‡ç§»åŠ¨çš„æ—¶å€™è§¦å‘ gestureendï¼šå½“å€’æ•°ç¬¬äºŒæ ¹æ‰‹æŒ‡æèµ·çš„æ—¶å€™è§¦å‘ï¼Œç»“æŸ gesture æŒ‰ç…§å®šä¹‰ï¼Œå½“åˆ†åˆ«å°†ä¸¤æ ¹æ‰‹æŒ‡æ”¾åˆ°å±å¹•ä¸Šçš„æ—¶å€™ï¼Œä¼šæœ‰å¦‚ä¸‹é¡ºåºçš„äº‹ä»¶è§¦å‘ï¼š 1ã€ç¬¬ä¸€æ ¹æ‰‹æŒ‡æ”¾ä¸‹ï¼Œè§¦å‘ touchstart 2ã€ç¬¬äºŒæ ¹æ‰‹æŒ‡æ”¾ä¸‹ï¼Œè§¦å‘ gesturestart 3ã€è§¦å‘ç¬¬äºŒæ ¹æ‰‹æŒ‡çš„ touchstart 4ã€ç«‹å³è§¦å‘ gesturechange 5ã€æ‰‹æŒ‡ç§»åŠ¨ï¼ŒæŒç»­è§¦å‘ gesturechange 6ã€ç¬¬äºŒæ ¹æ‰‹æŒ‡æèµ·ï¼Œè§¦å‘ gestureendï¼Œä»¥åå°†ä¸ä¼šå†è§¦å‘ gesturechange 7ã€è§¦å‘ç¬¬äºŒæ ¹æ‰‹æŒ‡çš„ touchend 8ã€è§¦å‘ touchstartï¼ˆå¤šæ ¹æ‰‹æŒ‡åœ¨å±å¹•ä¸Šï¼Œæèµ·ä¸€æ ¹ï¼Œä¼šåˆ·æ–°ä¸€æ¬¡å…¨å±€ touchï¼Œé‡æ–°è§¦å‘ç¬¬ä¸€æ ¹æ‰‹æŒ‡çš„ touchstartï¼‰ 9ã€æèµ·ç¬¬ä¸€æ ¹æ‰‹æŒ‡ï¼Œè§¦å‘ touchend 5.Zepto.js åº“å¯ä»¥æ›´å¥½çš„æ”¯æŒï¼ŒåŸºäº CSS3","categories":[{"name":"ç§»åŠ¨ç«¯","slug":"ç§»åŠ¨ç«¯","permalink":"http://yoursite.com/categories/ç§»åŠ¨ç«¯/"}],"tags":[{"name":"ç§»åŠ¨ç«¯","slug":"ç§»åŠ¨ç«¯","permalink":"http://yoursite.com/tags/ç§»åŠ¨ç«¯/"},{"name":"è§¦å±","slug":"è§¦å±","permalink":"http://yoursite.com/tags/è§¦å±/"}]},{"title":"åŒå‘æ•°æ®ç»‘å®šProxyå’ŒObject.definePropertyå¯¹æ¯”","slug":"åŒå‘æ•°æ®ç»‘å®šProxyå’ŒObject.definePropertyå¯¹æ¯”","date":"2019-03-11T03:52:12.000Z","updated":"2019-11-10T14:37:39.033Z","comments":true,"path":"2019/03/11/åŒå‘æ•°æ®ç»‘å®šProxyå’ŒObject.definePropertyå¯¹æ¯”/","link":"","permalink":"http://yoursite.com/2019/03/11/åŒå‘æ•°æ®ç»‘å®šProxyå’ŒObject.definePropertyå¯¹æ¯”/","excerpt":"åŒå‘æ•°æ®ç»‘å®šProxyå’ŒObject.definePropertyå¯¹æ¯”æ•°æ®åŠ«æŒçš„ä¼˜åŠ¿æ‰€åœ¨ã€‚å¯¹æ¯”å…¶ä»–åŒå‘ç»‘å®šçš„å®ç°æ–¹æ³•,æ•°æ®åŠ«æŒçš„ä¼˜åŠ¿æ‰€åœ¨ï¼š æ— éœ€æ˜¾ç¤ºè°ƒç”¨: ä¾‹å¦‚ Vue è¿ç”¨æ•°æ®åŠ«æŒ+å‘å¸ƒè®¢é˜…,ç›´æ¥å¯ä»¥é€šçŸ¥å˜åŒ–å¹¶é©±åŠ¨è§†å›¾,ä¸Šé¢çš„ä¾‹å­ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„å®ç°data.name = &#39;æ¸£æ¸£è¾‰&#39;åç›´æ¥è§¦å‘å˜æ›´,è€Œæ¯”å¦‚ Angular çš„è„æ£€æµ‹åˆ™éœ€è¦æ˜¾ç¤ºè°ƒç”¨markForCheck(å¯ä»¥ç”¨ zone.js é¿å…æ˜¾ç¤ºè°ƒç”¨,ä¸å±•å¼€),react éœ€è¦æ˜¾ç¤ºè°ƒç”¨setStateã€‚ å¯ç²¾ç¡®å¾—çŸ¥å˜åŒ–æ•°æ®ï¼šè¿˜æ˜¯ä¸Šé¢çš„å°ä¾‹å­ï¼Œæˆ‘ä»¬åŠ«æŒäº†å±æ€§çš„ setter,å½“å±æ€§å€¼æ”¹å˜,æˆ‘ä»¬å¯ä»¥ç²¾ç¡®è·çŸ¥å˜åŒ–çš„å†…å®¹newVal,å› æ­¤åœ¨è¿™éƒ¨åˆ†ä¸éœ€è¦é¢å¤–çš„ diff æ“ä½œ,å¦åˆ™æˆ‘ä»¬åªçŸ¥é“æ•°æ®å‘ç”Ÿäº†å˜åŒ–è€Œä¸çŸ¥é“å…·ä½“å“ªäº›æ•°æ®å˜åŒ–äº†,è¿™ä¸ªæ—¶å€™éœ€è¦å¤§é‡ diff æ¥æ‰¾å‡ºå˜åŒ–å€¼,è¿™æ˜¯é¢å¤–æ€§èƒ½æŸè€—ã€‚","text":"åŒå‘æ•°æ®ç»‘å®šProxyå’ŒObject.definePropertyå¯¹æ¯”æ•°æ®åŠ«æŒçš„ä¼˜åŠ¿æ‰€åœ¨ã€‚å¯¹æ¯”å…¶ä»–åŒå‘ç»‘å®šçš„å®ç°æ–¹æ³•,æ•°æ®åŠ«æŒçš„ä¼˜åŠ¿æ‰€åœ¨ï¼š æ— éœ€æ˜¾ç¤ºè°ƒç”¨: ä¾‹å¦‚ Vue è¿ç”¨æ•°æ®åŠ«æŒ+å‘å¸ƒè®¢é˜…,ç›´æ¥å¯ä»¥é€šçŸ¥å˜åŒ–å¹¶é©±åŠ¨è§†å›¾,ä¸Šé¢çš„ä¾‹å­ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„å®ç°data.name = &#39;æ¸£æ¸£è¾‰&#39;åç›´æ¥è§¦å‘å˜æ›´,è€Œæ¯”å¦‚ Angular çš„è„æ£€æµ‹åˆ™éœ€è¦æ˜¾ç¤ºè°ƒç”¨markForCheck(å¯ä»¥ç”¨ zone.js é¿å…æ˜¾ç¤ºè°ƒç”¨,ä¸å±•å¼€),react éœ€è¦æ˜¾ç¤ºè°ƒç”¨setStateã€‚ å¯ç²¾ç¡®å¾—çŸ¥å˜åŒ–æ•°æ®ï¼šè¿˜æ˜¯ä¸Šé¢çš„å°ä¾‹å­ï¼Œæˆ‘ä»¬åŠ«æŒäº†å±æ€§çš„ setter,å½“å±æ€§å€¼æ”¹å˜,æˆ‘ä»¬å¯ä»¥ç²¾ç¡®è·çŸ¥å˜åŒ–çš„å†…å®¹newVal,å› æ­¤åœ¨è¿™éƒ¨åˆ†ä¸éœ€è¦é¢å¤–çš„ diff æ“ä½œ,å¦åˆ™æˆ‘ä»¬åªçŸ¥é“æ•°æ®å‘ç”Ÿäº†å˜åŒ–è€Œä¸çŸ¥é“å…·ä½“å“ªäº›æ•°æ®å˜åŒ–äº†,è¿™ä¸ªæ—¶å€™éœ€è¦å¤§é‡ diff æ¥æ‰¾å‡ºå˜åŒ–å€¼,è¿™æ˜¯é¢å¤–æ€§èƒ½æŸè€—ã€‚ åŸºäºæ•°æ®åŠ«æŒåŒå‘ç»‘å®šçš„å®ç°æ€è·¯æ•°æ®åŠ«æŒæ˜¯åŒå‘ç»‘å®šå„ç§æ–¹æ¡ˆä¸­æ¯”è¾ƒæµè¡Œçš„ä¸€ç§,æœ€è‘—åçš„å®ç°å°±æ˜¯ Vueã€‚ åŸºäºæ•°æ®åŠ«æŒçš„åŒå‘ç»‘å®šç¦»ä¸å¼€Proxyä¸Object.definePropertyç­‰æ–¹æ³•å¯¹å¯¹è±¡/å¯¹è±¡å±æ€§çš„â€åŠ«æŒâ€,æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªå®Œæ•´çš„åŒå‘ç»‘å®šéœ€è¦ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹ã€‚ åˆ©ç”¨Proxyæˆ–Object.definePropertyç”Ÿæˆçš„ Observer é’ˆå¯¹å¯¹è±¡/å¯¹è±¡çš„å±æ€§è¿›è¡Œâ€åŠ«æŒâ€,åœ¨å±æ€§å‘ç”Ÿå˜åŒ–åé€šçŸ¥è®¢é˜…è€… è§£æå™¨ Compile è§£ææ¨¡æ¿ä¸­çš„Directive(æŒ‡ä»¤)ï¼Œæ”¶é›†æŒ‡ä»¤æ‰€ä¾èµ–çš„æ–¹æ³•å’Œæ•°æ®,ç­‰å¾…æ•°æ®å˜åŒ–ç„¶åè¿›è¡Œæ¸²æŸ“ Watcher å±äº Observer å’Œ Compile æ¡¥æ¢,å®ƒå°†æ¥æ”¶åˆ°çš„ Observer äº§ç”Ÿçš„æ•°æ®å˜åŒ–,å¹¶æ ¹æ® Compile æä¾›çš„æŒ‡ä»¤è¿›è¡Œè§†å›¾æ¸²æŸ“,ä½¿å¾—æ•°æ®å˜åŒ–ä¿ƒä½¿è§†å›¾å˜åŒ– åœ¨ new Vue() åï¼Œ Vue ä¼šè°ƒç”¨_init å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯ init è¿‡ç¨‹ï¼Œåœ¨ è¿™ä¸ªè¿‡ç¨‹ Data é€šè¿‡ Observer è½¬æ¢æˆäº† getter/setter çš„å½¢å¼ï¼Œæ¥å¯¹æ•°æ®è¿½è¸ªå˜åŒ–ï¼Œå½“è¢«è®¾ç½®çš„å¯¹è±¡è¢«è¯»å–çš„æ—¶å€™ä¼šæ‰§è¡Œgetter å‡½æ•°ï¼Œè€Œåœ¨å½“è¢«èµ‹å€¼çš„æ—¶å€™ä¼šæ‰§è¡Œ setterå‡½æ•°ã€‚ å½“ render function æ‰§è¡Œçš„æ—¶å€™ï¼Œå› ä¸ºä¼šè¯»å–æ‰€éœ€å¯¹è±¡çš„å€¼ï¼Œæ‰€ä»¥ä¼šè§¦å‘getterå‡½æ•°ä»è€Œå°† Watcher æ·»åŠ åˆ°ä¾èµ–ä¸­è¿›è¡Œä¾èµ–æ”¶é›†ã€‚ åœ¨ä¿®æ”¹å¯¹è±¡çš„å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„setterï¼Œ setteré€šçŸ¥ä¹‹å‰ä¾èµ–æ”¶é›†å¾—åˆ°çš„ Dep ä¸­çš„æ¯ä¸€ä¸ª Watcherï¼Œå‘Šè¯‰å®ƒä»¬è‡ªå·±çš„å€¼æ”¹å˜äº†ï¼Œéœ€è¦é‡æ–°æ¸²æŸ“è§†å›¾ã€‚è¿™æ—¶å€™è¿™äº› Watcher å°±ä¼šå¼€å§‹è°ƒç”¨ update æ¥æ›´æ–°è§†å›¾ã€‚ åŸºäº Object.defineProperty åŒå‘ç»‘å®šçš„ç‰¹ç‚¹Vue é€šè¿‡è®¾å®šå¯¹è±¡å±æ€§çš„ setter/getter æ–¹æ³•æ¥ç›‘å¬æ•°æ®çš„å˜åŒ–ï¼Œé€šè¿‡ getter è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œè€Œæ¯ä¸ª setter æ–¹æ³•å°±æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œåœ¨æ•°æ®å˜æ›´çš„æ—¶å€™é€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾ã€‚ åœ¨ getter ä¸­æ”¶é›†ä¾èµ–ï¼Œåœ¨ setter ä¸­è§¦å‘ä¾èµ–ã€‚ å½“å¤–ç•Œé€šè¿‡ Watcher è¯»å–æ•°æ®æ—¶ï¼Œä¾¿ä¼šè§¦å‘ getter ä»è€Œå°† Watcher æ·»åŠ åˆ°ä¾èµ–ä¸­ï¼Œå“ªä¸ª Watcher è§¦å‘äº† getterï¼Œå°±æŠŠå“ªä¸ª Watcher æ”¶é›†åˆ° Dep ä¸­ã€‚å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¾ªç¯ä¾èµ–åˆ—è¡¨ï¼ŒæŠŠæ‰€æœ‰çš„ Watcher éƒ½é€šçŸ¥ä¸€éã€‚ æç®€ç‰ˆçš„åŒå‘ç»‘å®šObject.definePropertyçš„ä½œç”¨å°±æ˜¯åŠ«æŒä¸€ä¸ªå¯¹è±¡çš„å±æ€§,é€šå¸¸æˆ‘ä»¬å¯¹å±æ€§çš„getterå’Œsetteræ–¹æ³•è¿›è¡ŒåŠ«æŒ,åœ¨å¯¹è±¡çš„å±æ€§å‘ç”Ÿå˜åŒ–æ—¶è¿›è¡Œç‰¹å®šçš„æ“ä½œã€‚ æˆ‘ä»¬å°±å¯¹å¯¹è±¡objçš„textå±æ€§è¿›è¡ŒåŠ«æŒ,åœ¨è·å–æ­¤å±æ€§çš„å€¼æ—¶æ‰“å°&#39;get val&#39;,åœ¨æ›´æ”¹å±æ€§å€¼çš„æ—¶å€™å¯¹ DOM è¿›è¡Œæ“ä½œ,è¿™å°±æ˜¯ä¸€ä¸ªæç®€çš„åŒå‘ç»‘å®šã€‚ 12345678910111213141516const obj = &#123;&#125;;Object.defineProperty(obj, \"text\", &#123; get: function() &#123; console.log(\"get val\"); &#125;, set: function(newVal) &#123; console.log(\"set val:\" + newVal); document.getElementById(\"input\").value = newVal; document.getElementById(\"span\").innerHTML = newVal; &#125;&#125;);const input = document.getElementById(\"input\");input.addEventListener(\"keyup\", function(e) &#123; obj.text = e.target.value;&#125;); å‡çº§æ”¹é€ æˆ‘ä»¬å¾ˆå¿«ä¼šå‘ç°ï¼Œè¿™ä¸ªæ‰€è°“çš„åŒå‘ç»‘å®šè²Œä¼¼å¹¶æ²¡æœ‰ä»€ä¹ˆä¹±ç”¨ã€‚ã€‚ã€‚ åŸå› å¦‚ä¸‹: æˆ‘ä»¬åªç›‘å¬äº†ä¸€ä¸ªå±æ€§,ä¸€ä¸ªå¯¹è±¡ä¸å¯èƒ½åªæœ‰ä¸€ä¸ªå±æ€§,æˆ‘ä»¬éœ€è¦å¯¹å¯¹è±¡æ¯ä¸ªå±æ€§è¿›è¡Œç›‘å¬ã€‚ è¿åå¼€æ”¾å°é—­åŸåˆ™,æˆ‘ä»¬å¦‚æœäº†è§£å¼€æ”¾å°é—­åŸåˆ™çš„è¯,ä¸Šè¿°ä»£ç æ˜¯æ˜æ˜¾è¿åæ­¤åŸåˆ™,æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦è¿›å…¥æ–¹æ³•å†…éƒ¨,è¿™æ˜¯éœ€è¦åšå†³æœç»çš„ã€‚ ä»£ç è€¦åˆä¸¥é‡,æˆ‘ä»¬çš„æ•°æ®ã€æ–¹æ³•å’Œ DOM éƒ½æ˜¯è€¦åˆåœ¨ä¸€èµ·çš„ï¼Œå°±æ˜¯ä¼ è¯´ä¸­çš„é¢æ¡ä»£ç ã€‚ é‚£ä¹ˆå¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Ÿ Vue çš„æ“ä½œå°±æ˜¯åŠ å…¥äº†å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œç»“åˆObject.definePropertyçš„åŠ«æŒèƒ½åŠ›ï¼Œå®ç°äº†å¯ç”¨æ€§å¾ˆé«˜çš„åŒå‘ç»‘å®šã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ä»¥å‘å¸ƒè®¢é˜…çš„è§’åº¦çœ‹æˆ‘ä»¬ç¬¬ä¸€éƒ¨åˆ†å†™çš„é‚£ä¸€å¨ä»£ç ,ä¼šå‘ç°å®ƒçš„ç›‘å¬ã€å‘å¸ƒå’Œè®¢é˜…éƒ½æ˜¯å†™åœ¨ä¸€èµ·çš„,æˆ‘ä»¬é¦–å…ˆè¦åšçš„å°±æ˜¯è§£è€¦ã€‚ æˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ªè®¢é˜…å‘å¸ƒä¸­å¿ƒï¼Œå³æ¶ˆæ¯ç®¡ç†å‘˜ï¼ˆDepï¼‰,å®ƒè´Ÿè´£å‚¨å­˜è®¢é˜…è€…å’Œæ¶ˆæ¯çš„åˆ†å‘,ä¸ç®¡æ˜¯è®¢é˜…è€…è¿˜æ˜¯å‘å¸ƒè€…éƒ½éœ€è¦ä¾èµ–äºå®ƒã€‚ 123456789101112131415161718192021222324let uid = 0;// ç”¨äºå‚¨å­˜è®¢é˜…è€…å¹¶å‘å¸ƒæ¶ˆæ¯class Dep &#123; constructor() &#123; // è®¾ç½®id,ç”¨äºåŒºåˆ†æ–°Watcherå’Œåªæ”¹å˜å±æ€§å€¼åæ–°äº§ç”Ÿçš„Watcher this.id = uid++; // å‚¨å­˜è®¢é˜…è€…çš„æ•°ç»„ this.subs = []; &#125; // è§¦å‘targetä¸Šçš„Watcherä¸­çš„addDepæ–¹æ³•,å‚æ•°ä¸ºdepçš„å®ä¾‹æœ¬èº« depend() &#123; Dep.target.addDep(this); &#125; // æ·»åŠ è®¢é˜…è€… addSub(sub) &#123; this.subs.push(sub); &#125; notify() &#123; // é€šçŸ¥æ‰€æœ‰çš„è®¢é˜…è€…(Watcher)ï¼Œè§¦å‘è®¢é˜…è€…çš„ç›¸åº”é€»è¾‘å¤„ç† this.subs.forEach(sub =&gt; sub.update()); &#125;&#125;// ä¸ºDepç±»è®¾ç½®ä¸€ä¸ªé™æ€å±æ€§,é»˜è®¤ä¸ºnull,å·¥ä½œæ—¶æŒ‡å‘å½“å‰çš„WatcherDep.target = null; ç°åœ¨æˆ‘ä»¬éœ€è¦å®ç°ç›‘å¬è€…(Observer),ç”¨äºç›‘å¬å±æ€§å€¼çš„å˜åŒ–ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// ç›‘å¬è€…,ç›‘å¬å¯¹è±¡å±æ€§å€¼çš„å˜åŒ–class Observer &#123; constructor(value) &#123; this.value = value; this.walk(value); &#125; // éå†å±æ€§å€¼å¹¶ç›‘å¬ walk(value) &#123; Object.keys(value).forEach(key =&gt; this.convert(key, value[key])); &#125; // æ‰§è¡Œç›‘å¬çš„å…·ä½“æ–¹æ³• convert(key, val) &#123; defineReactive(this.value, key, val); &#125;&#125;function defineReactive(obj, key, val) &#123; const dep = new Dep(); // ç»™å½“å‰å±æ€§çš„å€¼æ·»åŠ ç›‘å¬ let chlidOb = observe(val); Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get: () =&gt; &#123; // å¦‚æœDepç±»å­˜åœ¨targetå±æ€§ï¼Œå°†å…¶æ·»åŠ åˆ°depå®ä¾‹çš„subsæ•°ç»„ä¸­ // targetæŒ‡å‘ä¸€ä¸ªWatcherå®ä¾‹ï¼Œæ¯ä¸ªWatcheréƒ½æ˜¯ä¸€ä¸ªè®¢é˜…è€… // Watcherå®ä¾‹åœ¨å®ä¾‹åŒ–è¿‡ç¨‹ä¸­ï¼Œä¼šè¯»å–dataä¸­çš„æŸä¸ªå±æ€§ï¼Œä»è€Œè§¦å‘å½“å‰getæ–¹æ³• if (Dep.target) &#123; dep.depend(); &#125; return val; &#125;, set: newVal =&gt; &#123; if (val === newVal) return; val = newVal; // å¯¹æ–°å€¼è¿›è¡Œç›‘å¬ chlidOb = observe(newVal); // é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ï¼Œæ•°å€¼è¢«æ”¹å˜äº† dep.notify(); &#125; &#125;);&#125;function observe(value) &#123; // å½“å€¼ä¸å­˜åœ¨ï¼Œæˆ–è€…ä¸æ˜¯å¤æ‚æ•°æ®ç±»å‹æ—¶ï¼Œä¸å†éœ€è¦ç»§ç»­æ·±å…¥ç›‘å¬ if (!value || typeof value !== \"object\") &#123; return; &#125; return new Observer(value);&#125; é‚£ä¹ˆæ¥ä¸‹æ¥å°±ç®€å•äº†,æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªè®¢é˜…è€…(Watcher)ã€‚ 12345678910111213141516171819202122232425262728293031323334353637class Watcher &#123; constructor(vm, expOrFn, cb) &#123; this.depIds = &#123;&#125;; // hashå‚¨å­˜è®¢é˜…è€…çš„id,é¿å…é‡å¤çš„è®¢é˜…è€… this.vm = vm; // è¢«è®¢é˜…çš„æ•°æ®ä¸€å®šæ¥è‡ªäºå½“å‰Vueå®ä¾‹ this.cb = cb; // å½“æ•°æ®æ›´æ–°æ—¶æƒ³è¦åšçš„äº‹æƒ… this.expOrFn = expOrFn; // è¢«è®¢é˜…çš„æ•°æ® this.val = this.get(); // ç»´æŠ¤æ›´æ–°ä¹‹å‰çš„æ•°æ® &#125; // å¯¹å¤–æš´éœ²çš„æ¥å£ï¼Œç”¨äºåœ¨è®¢é˜…çš„æ•°æ®è¢«æ›´æ–°æ—¶ï¼Œç”±è®¢é˜…è€…ç®¡ç†å‘˜(Dep)è°ƒç”¨ update() &#123; this.run(); &#125; addDep(dep) &#123; // å¦‚æœåœ¨depIdsçš„hashä¸­æ²¡æœ‰å½“å‰çš„id,å¯ä»¥åˆ¤æ–­æ˜¯æ–°Watcher,å› æ­¤å¯ä»¥æ·»åŠ åˆ°depçš„æ•°ç»„ä¸­å‚¨å­˜ // æ­¤åˆ¤æ–­æ˜¯é¿å…åŒidçš„Watcherè¢«å¤šæ¬¡å‚¨å­˜ if (!this.depIds.hasOwnProperty(dep.id)) &#123; dep.addSub(this); this.depIds[dep.id] = dep; &#125; &#125; run() &#123; const val = this.get(); console.log(val); if (val !== this.val) &#123; this.val = val; this.cb.call(this.vm, val); &#125; &#125; get() &#123; // å½“å‰è®¢é˜…è€…(Watcher)è¯»å–è¢«è®¢é˜…æ•°æ®çš„æœ€æ–°æ›´æ–°åçš„å€¼æ—¶ï¼Œé€šçŸ¥è®¢é˜…è€…ç®¡ç†å‘˜æ”¶é›†å½“å‰è®¢é˜…è€… Dep.target = this; const val = this.vm._data[this.expOrFn]; // ç½®ç©ºï¼Œç”¨äºä¸‹ä¸€ä¸ªWatcherä½¿ç”¨ Dep.target = null; return val; &#125;&#125; é‚£ä¹ˆæˆ‘ä»¬æœ€åå®Œæˆ Vue,å°†ä¸Šè¿°æ–¹æ³•æŒ‚è½½åœ¨ Vue ä¸Šã€‚ 123456789101112131415161718192021222324252627class Vue &#123; constructor(options = &#123;&#125;) &#123; // ç®€åŒ–äº†$optionsçš„å¤„ç† this.$options = options; // ç®€åŒ–äº†å¯¹dataçš„å¤„ç† let data = (this._data = this.$options.data); // å°†æ‰€æœ‰dataæœ€å¤–å±‚å±æ€§ä»£ç†åˆ°Vueå®ä¾‹ä¸Š Object.keys(data).forEach(key =&gt; this._proxy(key)); // ç›‘å¬æ•°æ® observe(data); &#125; // å¯¹å¤–æš´éœ²è°ƒç”¨è®¢é˜…è€…çš„æ¥å£ï¼Œå†…éƒ¨ä¸»è¦åœ¨æŒ‡ä»¤ä¸­ä½¿ç”¨è®¢é˜…è€… $watch(expOrFn, cb) &#123; new Watcher(this, expOrFn, cb); &#125; _proxy(key) &#123; Object.defineProperty(this, key, &#123; configurable: true, enumerable: true, get: () =&gt; this._data[key], set: val =&gt; &#123; this._data[key] = val; &#125;, &#125;); &#125; &#125;] è‡³æ­¤,ä¸€ä¸ªç®€å•çš„åŒå‘ç»‘å®šç®—æ˜¯è¢«æˆ‘ä»¬å®ç°äº†ã€‚ Object.defineProperty çš„ç¼ºé™· Object.definePropertyçš„ç¬¬ä¸€ä¸ªç¼ºé™·,æ— æ³•ç›‘å¬æ•°ç»„å˜åŒ–ã€‚Vue çš„æ–‡æ¡£æåˆ°äº† Vue æ˜¯å¯ä»¥æ£€æµ‹åˆ°æ•°ç»„å˜åŒ–çš„ï¼Œä½†æ˜¯åªæœ‰ä»¥ä¸‹å…«ç§æ–¹æ³•,vm.items[indexOfItem] = newValueè¿™ç§æ˜¯æ— æ³•æ£€æµ‹çš„ã€‚push()ã€pop()ã€shift()ã€unshift()ã€splice()ã€sort()ã€reverse() Object.definePropertyçš„ç¬¬äºŒä¸ªç¼ºé™·,åªèƒ½åŠ«æŒå¯¹è±¡çš„å±æ€§,å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå¯¹è±¡çš„æ¯ä¸ªå±æ€§è¿›è¡Œéå†ï¼Œå¦‚æœå±æ€§å€¼ä¹Ÿæ˜¯å¯¹è±¡é‚£ä¹ˆéœ€è¦æ·±åº¦éå†,æ˜¾ç„¶èƒ½åŠ«æŒä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ Object.keys(value).forEach(key =&gt; **this**.convert(key, value[key])); æ— æ³•æ£€æµ‹åˆ°å¯¹è±¡å±æ€§çš„æ·»åŠ æˆ–åˆ é™¤(å¦‚data.location.a=1)ã€‚ è¿™æ˜¯å› ä¸º Vue é€šè¿‡Object.definePropertyæ¥å°†å¯¹è±¡çš„ key è½¬æ¢æˆgetter/setterçš„å½¢å¼æ¥è¿½è¸ªå˜åŒ–ï¼Œä½†getter/setteråªèƒ½è¿½è¸ªä¸€ä¸ªæ•°æ®æ˜¯å¦è¢«ä¿®æ”¹ï¼Œæ— æ³•è¿½è¸ªæ–°å¢å±æ€§å’Œåˆ é™¤å±æ€§ã€‚å¦‚æœæ˜¯åˆ é™¤å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨vm.$deleteå®ç°ï¼Œé‚£å¦‚æœæ˜¯æ–°å¢å±æ€§ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ1ï¼‰å¯ä»¥ä½¿ç”¨ Vue.set(location, a, 1) æ–¹æ³•å‘åµŒå¥—å¯¹è±¡æ·»åŠ å“åº”å¼å±æ€§;2ï¼‰ä¹Ÿå¯ä»¥ç»™è¿™ä¸ªå¯¹è±¡é‡æ–°èµ‹å€¼ï¼Œæ¯”å¦‚data.location = {...data.location,a:1} Proxy å®ç°çš„åŒå‘ç»‘å®šçš„ç‰¹ç‚¹Proxy åœ¨ ES2015 è§„èŒƒä¸­è¢«æ­£å¼å‘å¸ƒ,å®ƒåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚â€œæ‹¦æˆªâ€ï¼Œå¤–ç•Œå¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–ç•Œçš„è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™,æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¤ä¸º,Proxy æ˜¯Object.definePropertyçš„å…¨æ–¹ä½åŠ å¼ºç‰ˆ Proxy å¯ä»¥ç›´æ¥ç›‘å¬å¯¹è±¡è€Œéå±æ€§æˆ‘ä»¬è¿˜æ˜¯ä»¥ä¸Šæ–‡ä¸­ç”¨Object.definePropertyå®ç°çš„æç®€ç‰ˆåŒå‘ç»‘å®šä¸ºä¾‹,ç”¨ Proxy è¿›è¡Œæ”¹å†™ã€‚ 12345678910111213141516171819202122const input = document.getElementById(\"input\");const p = document.getElementById(\"p\");const obj = &#123;&#125;;const newObj = new Proxy(obj, &#123; get: function(target, key, receiver) &#123; console.log(`getting $&#123;key&#125;!`); return Reflect.get(target, key, receiver); &#125;, set: function(target, key, value, receiver) &#123; console.log(target, key, value, receiver); if (key === \"text\") &#123; input.value = value; p.innerHTML = value; &#125; return Reflect.set(target, key, value, receiver); &#125;&#125;);input.addEventListener(\"keyup\", function(e) &#123; newObj.text = e.target.value;&#125;); æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,Proxy ç›´æ¥å¯ä»¥åŠ«æŒæ•´ä¸ªå¯¹è±¡,å¹¶è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡,ä¸ç®¡æ˜¯æ“ä½œä¾¿åˆ©ç¨‹åº¦è¿˜æ˜¯åº•å±‚åŠŸèƒ½ä¸Šéƒ½è¿œå¼ºäºObject.definePropertyã€‚ Proxy å¯ä»¥ç›´æ¥ç›‘å¬æ•°ç»„çš„å˜åŒ–å½“æˆ‘ä»¬å¯¹æ•°ç»„è¿›è¡Œæ“ä½œ(pushã€shiftã€splice ç­‰)æ—¶ï¼Œä¼šè§¦å‘å¯¹åº”çš„æ–¹æ³•åç§°å’Œlengthçš„å˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿæ­¤è¿›è¡Œæ“ä½œ,ä»¥ä¸Šæ–‡ä¸­Object.definePropertyæ— æ³•ç”Ÿæ•ˆçš„åˆ—è¡¨æ¸²æŸ“ä¸ºä¾‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950const list = document.getElementById(\"list\");const btn = document.getElementById(\"btn\");// æ¸²æŸ“åˆ—è¡¨const Render = &#123; // åˆå§‹åŒ– init: function(arr) &#123; const fragment = document.createDocumentFragment(); for (let i = 0; i &lt; arr.length; i++) &#123; const li = document.createElement(\"li\"); li.textContent = arr[i]; fragment.appendChild(li); &#125; list.appendChild(fragment); &#125;, // æˆ‘ä»¬åªè€ƒè™‘äº†å¢åŠ çš„æƒ…å†µ,ä»…ä½œä¸ºç¤ºä¾‹ change: function(val) &#123; const li = document.createElement(\"li\"); li.textContent = val; list.appendChild(li); &#125;&#125;;// åˆå§‹æ•°ç»„const arr = [1, 2, 3, 4];// ç›‘å¬æ•°ç»„const newArr = new Proxy(arr, &#123; get: function(target, key, receiver) &#123; console.log(key); return Reflect.get(target, key, receiver); &#125;, set: function(target, key, value, receiver) &#123; console.log(target, key, value, receiver); if (key !== \"length\") &#123; Render.change(value); &#125; return Reflect.set(target, key, value, receiver); &#125;&#125;);// åˆå§‹åŒ–window.onload = function() &#123; Render.init(arr);&#125;;// pushæ•°å­—btn.addEventListener(\"click\", function() &#123; newArr.push(6);&#125;); å¾ˆæ˜¾ç„¶,Proxy ä¸éœ€è¦é‚£ä¹ˆå¤š hackï¼ˆå³ä½¿ hack ä¹Ÿæ— æ³•å®Œç¾å®ç°ç›‘å¬ï¼‰å°±å¯ä»¥æ— å‹åŠ›ç›‘å¬æ•°ç»„çš„å˜åŒ–,æˆ‘ä»¬éƒ½çŸ¥é“,æ ‡å‡†æ°¸è¿œä¼˜å…ˆäº hackã€‚ Proxy çš„å…¶ä»–ä¼˜åŠ¿Proxy æœ‰å¤šè¾¾ 13 ç§æ‹¦æˆªæ–¹æ³•,ä¸é™äº applyã€ownKeysã€deletePropertyã€has ç­‰ç­‰æ˜¯Object.definePropertyä¸å…·å¤‡çš„ã€‚ Proxy è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡,æˆ‘ä»¬å¯ä»¥åªæ“ä½œæ–°çš„å¯¹è±¡è¾¾åˆ°ç›®çš„,è€ŒObject.definePropertyåªèƒ½éå†å¯¹è±¡å±æ€§ç›´æ¥ä¿®æ”¹ã€‚ Proxy ä½œä¸ºæ–°æ ‡å‡†å°†å—åˆ°æµè§ˆå™¨å‚å•†é‡ç‚¹æŒç»­çš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„æ–°æ ‡å‡†çš„æ€§èƒ½çº¢åˆ©ã€‚ å½“ç„¶,Proxy çš„åŠ£åŠ¿å°±æ˜¯å…¼å®¹æ€§é—®é¢˜,è€Œä¸”æ— æ³•ç”¨ polyfill ç£¨å¹³,å› æ­¤ Vue çš„ä½œè€…æ‰å£°æ˜éœ€è¦ç­‰åˆ°ä¸‹ä¸ªå¤§ç‰ˆæœ¬(3.0)æ‰èƒ½ç”¨ Proxy é‡å†™ã€‚ åŸºç¡€ proxy çš„åŒå‘æ•°æ®ç»‘å®šçš„å®ç°å‘å¸ƒè®¢é˜…ä¸­å¿ƒ(Dep)Depä¿å­˜è®¢é˜…è€…,å¹¶åœ¨ Observer å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥ä¿å­˜åœ¨ Dep ä¸­çš„è®¢é˜…è€…,è®©è®¢é˜…è€…å¾—çŸ¥å˜åŒ–å¹¶æ›´æ–°è§†å›¾,è¿™æ ·æ‰èƒ½ä¿è¯è§†å›¾ä¸çŠ¶æ€çš„åŒæ­¥ã€‚ 12345678910111213141516171819202122232425262728293031/** * [subs description] è®¢é˜…å™¨,å‚¨å­˜è®¢é˜…è€…,é€šçŸ¥è®¢é˜…è€… * @type &#123;Map&#125; */export default class Dep &#123; constructor() &#123; // æˆ‘ä»¬ç”¨ hash å‚¨å­˜è®¢é˜…è€… this.subs = new Map(); &#125; // æ·»åŠ è®¢é˜…è€… addSub(key, sub) &#123; // å–å‡ºé”®ä¸º key çš„è®¢é˜…è€… const currentSub = this.subs.get(key); // å¦‚æœèƒ½å–å‡ºè¯´æ˜æœ‰ç›¸åŒçš„ key çš„è®¢é˜…è€…å·²ç»å­˜åœ¨,ç›´æ¥æ·»åŠ  if (currentSub) &#123; currentSub.add(sub); &#125; else &#123; // ç”¨ Set æ•°æ®ç»“æ„å‚¨å­˜,ä¿è¯å”¯ä¸€å€¼ this.subs.set(key, new Set([sub])); &#125; &#125; // é€šçŸ¥ notify(key) &#123; // è§¦å‘é”®ä¸º key çš„è®¢é˜…è€…ä»¬ if (this.subs.get(key)) &#123; this.subs.get(key).forEach(sub =&gt; &#123; sub.update(); &#125;); &#125; &#125;&#125; ç›‘å¬è€…çš„å®ç°(Observer)æˆ‘ä»¬åœ¨è®¢é˜…å™¨ Dep ä¸­å®ç°äº†ä¸€ä¸ªnotifyæ–¹æ³•æ¥é€šçŸ¥ç›¸åº”çš„è®¢é˜…è¿™ä»¬,ç„¶è€Œnotifyæ–¹æ³•åˆ°åº•ä»€ä¹ˆæ—¶å€™è¢«è§¦å‘å‘¢? å½“ç„¶æ˜¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶,å³ MVVM ä¸­çš„ Modal å˜åŒ–æ—¶è§¦å‘é€šçŸ¥,ç„¶è€ŒDep æ˜¾ç„¶æ— æ³•å¾—çŸ¥ Modal æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–,å› æ­¤æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç›‘å¬è€…Observeræ¥ç›‘å¬ Modal, å½“ Modal å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æˆ‘ä»¬å°±æ‰§è¡Œé€šçŸ¥æ“ä½œã€‚ ä¸Object.definePropertyç›‘å¬å±æ€§ä¸åŒ, Proxy å¯ä»¥ç›‘å¬(å®é™…æ˜¯ä»£ç†)æ•´ä¸ªå¯¹è±¡,å› æ­¤å°±ä¸éœ€è¦éå†å¯¹è±¡çš„å±æ€§ä¾æ¬¡ç›‘å¬äº†,ä½†æ˜¯å¦‚æœå¯¹è±¡çš„å±æ€§ä¾ç„¶æ˜¯ä¸ªå¯¹è±¡,é‚£ä¹ˆ Proxy ä¹Ÿæ— æ³•ç›‘å¬,æ‰€ä»¥æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªobservifyè¿›è¡Œé€’å½’ç›‘å¬å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243/** * [Observer description] ç›‘å¬å™¨,ç›‘å¬å¯¹è±¡,è§¦å‘åé€šçŸ¥è®¢é˜… * @param &#123;[type]&#125; obj [description] éœ€è¦è¢«ç›‘å¬çš„å¯¹è±¡ */const Observer = obj =&gt; &#123; const dep = new Dep(); return new Proxy(obj, &#123; get: function(target, key, receiver) &#123; // å¦‚æœè®¢é˜…è€…å­˜åœ¨ï¼Œç›´æ¥æ·»åŠ è®¢é˜… if (Dep.target) &#123; dep.addSub(key, Dep.target); &#125; return Reflect.get(target, key, receiver); &#125;, set: function(target, key, value, receiver) &#123; // å¦‚æœå¯¹è±¡å€¼æ²¡æœ‰å˜,é‚£ä¹ˆä¸è§¦å‘ä¸‹é¢çš„æ“ä½œç›´æ¥è¿”å› if (Reflect.get(receiver, key) === value) &#123; return; &#125; const res = Reflect.set(target, key, observify(value), receiver); // å½“å€¼è¢«è§¦å‘æ›´æ”¹çš„æ—¶å€™,è§¦å‘ Dep çš„é€šçŸ¥æ–¹æ³• dep.notify(key); return res; &#125; &#125;);&#125;;/** * å°†å¯¹è±¡è½¬ä¸ºç›‘å¬å¯¹è±¡ * @param &#123;*&#125; obj è¦ç›‘å¬çš„å¯¹è±¡ */export default function observify(obj) &#123; if (!isObject(obj)) &#123; return obj; &#125; // æ·±åº¦ç›‘å¬ Object.keys(obj).forEach(key =&gt; &#123; obj[key] = observify(obj[key]); &#125;); return Observer(obj);&#125; è®¢é˜…è€…çš„å®ç°(watcher)æˆ‘ä»¬ç›®å‰å·²ç»è§£å†³äº†ä¸¤ä¸ªé—®é¢˜,ä¸€ä¸ªæ˜¯å¦‚ä½•å¾—çŸ¥ Modal å‘ç”Ÿäº†æ”¹å˜(åˆ©ç”¨ç›‘å¬è€… Observer ç›‘å¬ Modal å¯¹è±¡),ä¸€ä¸ªæ˜¯å¦‚ä½•æ”¶é›†è®¢é˜…è€…å¹¶é€šçŸ¥å…¶å˜åŒ–(åˆ©ç”¨è®¢é˜…å™¨æ”¶é›†è®¢é˜…è€…,å¹¶ç”¨ notify é€šçŸ¥è®¢é˜…è€…)ã€‚ æˆ‘ä»¬ç›®å‰è¿˜å·®ä¸€ä¸ªè®¢é˜…è€…ï¼ˆWatcherï¼‰ 12345678910111213141516171819202122232425262728293031// è®¢é˜…è€…export default class Watcher &#123; constructor(vm, exp, cb) &#123; this.vm = vm; // vm æ˜¯ vue çš„å®ä¾‹ this.exp = exp; // è¢«è®¢é˜…çš„æ•°æ® this.cb = cb; // è§¦å‘æ›´æ–°åçš„å›è°ƒ this.value = this.get(); // è·å–è€æ•°æ® &#125; get() &#123; const exp = this.exp; let value; Dep.target = this; if (typeof exp === \"function\") &#123; value = exp.call(this.vm); &#125; else if (typeof exp === \"string\") &#123; value = this.vm[exp]; &#125; Dep.target = null; return value; &#125; // å°†è®¢é˜…è€…æ”¾å…¥å¾…æ›´æ–°é˜Ÿåˆ—ç­‰å¾…æ‰¹é‡æ›´æ–° update() &#123; pushQueue(this); &#125; // è§¦å‘çœŸæ­£çš„æ›´æ–°æ“ä½œ run() &#123; const val = this.get(); // è·å–æ–°æ•°æ® this.cb.call(this.vm, val, this.value); this.value = val; &#125;&#125; æ‰¹é‡æ›´æ–°çš„å®ç°æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­å®ç°äº†è®¢é˜…è€…( Watcher),ä½†æ˜¯å…¶ä¸­çš„updateæ–¹æ³•æ˜¯å°†è®¢é˜…è€…æ”¾å…¥äº†ä¸€ä¸ªå¾…æ›´æ–°çš„é˜Ÿåˆ—ä¸­,è€Œä¸æ˜¯ç›´æ¥è§¦å‘,åŸå› å¦‚ä¸‹: å› æ­¤è¿™ä¸ªé˜Ÿåˆ—éœ€è¦åšçš„æ˜¯å¼‚æ­¥ä¸”å»é‡,å› æ­¤æˆ‘ä»¬ç”¨ Setä½œä¸ºæ•°æ®ç»“æ„å‚¨å­˜ Watcher æ¥å»é‡,åŒæ—¶ç”¨Promiseæ¨¡æ‹Ÿå¼‚æ­¥æ›´æ–°ã€‚ 1234567891011121314151617181920212223// åˆ›å»ºå¼‚æ­¥æ›´æ–°é˜Ÿåˆ—let queue = new Set();// ç”¨Promiseæ¨¡æ‹ŸnextTickfunction nextTick(cb) &#123; Promise.resolve().then(cb);&#125;// æ‰§è¡Œåˆ·æ–°é˜Ÿåˆ—function flushQueue(args) &#123; queue.forEach(watcher =&gt; &#123; watcher.run(); &#125;); // æ¸…ç©º queue = new Set();&#125;// æ·»åŠ åˆ°é˜Ÿåˆ—export default function pushQueue(watcher) &#123; queue.add(watcher); // ä¸‹ä¸€ä¸ªå¾ªç¯è°ƒç”¨ nextTick(flushQueue);&#125;","categories":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/categories/VUE/"}],"tags":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/tags/VUE/"}]},{"title":"ä¹ç§å®ç°è·¨åŸŸçš„æ–¹å¼","slug":"ä¹ç§å®ç°è·¨åŸŸçš„æ–¹å¼","date":"2019-03-07T07:00:20.000Z","updated":"2019-11-10T14:37:39.029Z","comments":true,"path":"2019/03/07/ä¹ç§å®ç°è·¨åŸŸçš„æ–¹å¼/","link":"","permalink":"http://yoursite.com/2019/03/07/ä¹ç§å®ç°è·¨åŸŸçš„æ–¹å¼/","excerpt":"åŸºæœ¬æ¦‚å¿µåŒæºç­–ç•¥æ˜¯çº¦å®šï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ã€‚åŒæºï¼šâ€åè®®+åŸŸå+ç«¯å£â€ åŒæºç­–ç•¥é™åˆ¶å†…å®¹æœ‰ï¼š Cookieã€LocalStorageã€IndexedDB ç­‰å­˜å‚¨æ€§å†…å®¹ DOM èŠ‚ç‚¹ AJAX è¯·æ±‚å‘é€åï¼Œç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº†","text":"åŸºæœ¬æ¦‚å¿µåŒæºç­–ç•¥æ˜¯çº¦å®šï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ã€‚åŒæºï¼šâ€åè®®+åŸŸå+ç«¯å£â€ åŒæºç­–ç•¥é™åˆ¶å†…å®¹æœ‰ï¼š Cookieã€LocalStorageã€IndexedDB ç­‰å­˜å‚¨æ€§å†…å®¹ DOM èŠ‚ç‚¹ AJAX è¯·æ±‚å‘é€åï¼Œç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº† æœ‰ä¸‰ä¸ªæ ‡ç­¾æ˜¯å…è®¸è·¨åŸŸåŠ è½½èµ„æºï¼š 123&lt;img src=XXX&gt;&lt;link href=XXX&gt;&lt;script src=XXX&gt; è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼šJSONPJSONP åŸç†åˆ©ç”¨ script æ ‡ç­¾æ²¡æœ‰è·¨åŸŸé™åˆ¶çš„æ¼æ´ï¼Œç½‘é¡µå¯ä»¥å¾—åˆ°ä»å…¶ä»–æ¥æºåŠ¨æ€äº§ç”Ÿçš„ JSON æ•°æ®ã€‚JSONP è¯·æ±‚ä¸€å®šéœ€è¦å¯¹æ–¹çš„æœåŠ¡å™¨åšæ”¯æŒæ‰å¯ä»¥ã€‚ JSONP ä¼˜ç¼ºç‚¹JSONP ä¼˜ç‚¹æ˜¯ç®€å•å…¼å®¹æ€§å¥½ï¼Œå¯ç”¨äºè§£å†³ä¸»æµæµè§ˆå™¨çš„è·¨åŸŸæ•°æ®è®¿é—®çš„é—®é¢˜ã€‚ç¼ºç‚¹æ˜¯ä»…æ”¯æŒ get æ–¹æ³•å…·æœ‰å±€é™æ€§,ä¸å®‰å…¨å¯èƒ½ä¼šé­å— XSS æ”»å‡»ã€‚ JSONP çš„å®ç°æµç¨‹ å£°æ˜ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå…¶å‡½æ•°å(å¦‚ show)å½“åšå‚æ•°å€¼ï¼Œè¦ä¼ é€’ç»™è·¨åŸŸè¯·æ±‚æ•°æ®çš„æœåŠ¡å™¨ï¼Œå‡½æ•°å½¢å‚ä¸ºè¦è·å–ç›®æ ‡æ•°æ®(æœåŠ¡å™¨è¿”å›çš„ data)ã€‚ åˆ›å»ºä¸€ä¸ª script æ ‡ç­¾ï¼ŒæŠŠé‚£ä¸ªè·¨åŸŸçš„ API æ•°æ®æ¥å£åœ°å€ï¼Œèµ‹å€¼ç»™ script çš„ src,è¿˜è¦åœ¨è¿™ä¸ªåœ°å€ä¸­å‘æœåŠ¡å™¨ä¼ é€’è¯¥å‡½æ•°åï¼ˆå¯ä»¥é€šè¿‡é—®å·ä¼ å‚:?callback=showï¼‰ã€‚ æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œéœ€è¦è¿›è¡Œç‰¹æ®Šçš„å¤„ç†ï¼šæŠŠä¼ é€’è¿›æ¥çš„å‡½æ•°åå’Œå®ƒéœ€è¦ç»™ä½ çš„æ•°æ®æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²,ä¾‹å¦‚ï¼šä¼ é€’è¿›å»çš„å‡½æ•°åæ˜¯ showï¼Œå®ƒå‡†å¤‡å¥½çš„æ•°æ®æ˜¯ show(â€˜æˆ‘ä¸çˆ±ä½ â€™)ã€‚ æœ€åæœåŠ¡å™¨æŠŠå‡†å¤‡çš„æ•°æ®é€šè¿‡ HTTP åè®®è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å†è°ƒç”¨æ‰§è¡Œä¹‹å‰å£°æ˜çš„å›è°ƒå‡½æ•°ï¼ˆshowï¼‰ï¼Œå¯¹è¿”å›çš„æ•°æ®è¿›è¡Œæ“ä½œã€‚ 123456789101112131415161718192021222324// index.htmlfunction jsonp(&#123; url, params, callback &#125;) &#123; return new Promise((resolve, reject) =&gt; &#123; let script = document.createElement(\"script\"); window[callback] = function(data) &#123; resolve(data); document.body.removeChild(script); &#125;; params = &#123; ...params, callback &#125;; // wd=b&amp;callback=show let arrs = []; for (let key in params) &#123; arrs.push(`$&#123;key&#125;=$&#123;params[key]&#125;`); &#125; script.src = `$&#123;url&#125;?$&#123;arrs.join(\"&amp;\")&#125;`; document.body.appendChild(script); &#125;);&#125;jsonp(&#123; url: \"http://localhost:3000/say\", params: &#123; wd: \"Iloveyou\" &#125;, callback: \"show\"&#125;).then(data =&gt; &#123; console.log(data);&#125;); ä¸Šé¢è¿™æ®µä»£ç ç›¸å½“äºå‘http://localhost:3000/say?wd=Iloveyou&amp;callback=show è¿™ä¸ªåœ°å€è¯·æ±‚æ•°æ®ï¼Œç„¶ååå°è¿”å› show(â€˜æˆ‘ä¸çˆ±ä½ â€™)ï¼Œæœ€åä¼šè¿è¡Œ show()è¿™ä¸ªå‡½æ•°ï¼Œæ‰“å°å‡ºâ€™æˆ‘ä¸çˆ±ä½ â€™ 12345678910// server.jslet express = require(\"express\");let app = express();app.get(\"/say\", function(req, res) &#123; let &#123; wd, callback &#125; = req.query; console.log(wd); // Iloveyou console.log(callback); // show res.end(`$&#123;callback&#125;('æˆ‘ä¸çˆ±ä½ ')`);&#125;);app.listen(3000); corsCORS éœ€è¦æµè§ˆå™¨å’Œåç«¯åŒæ—¶æ”¯æŒã€‚IE 8 å’Œ 9 éœ€è¦é€šè¿‡ XDomainRequest æ¥å®ç°ã€‚æµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡Œ CORS é€šä¿¡ï¼Œå®ç° CORS é€šä¿¡çš„å…³é”®æ˜¯åç«¯ã€‚ æœåŠ¡ç«¯è®¾ç½® Access-Control-Allow-Origin å°±å¯ä»¥å¼€å¯ CORSã€‚ è¯¥å±æ€§è¡¨ç¤ºå“ªäº›åŸŸåå¯ä»¥è®¿é—®èµ„æºï¼Œå¦‚æœè®¾ç½®é€šé…ç¬¦åˆ™è¡¨ç¤ºæ‰€æœ‰ç½‘ç«™éƒ½å¯ä»¥è®¿é—®èµ„æºã€‚ ç®€å•è¯·æ±‚ä½¿ç”¨æ–¹æ³•ä¸º GETã€HEADã€POST ä¹‹ä¸€Content-Type çš„å€¼ä»…é™äº text/plainã€multipart/form-dataã€application/x-www-form-urlencoded ä¸‰è€…ä¹‹ä¸€åŒæ—¶æ»¡è¶³è¿™ä¸¤å¤§æ¡ä»¶ï¼Œä¸ºç®€å•è¯·æ±‚ å¤æ‚è¯·æ±‚å¤æ‚è¯·æ±‚çš„ CORS è¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡ HTTP æŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€é¢„æ£€â€è¯·æ±‚,è¯¥è¯·æ±‚æ˜¯ option æ–¹æ³•çš„ï¼Œé€šè¿‡è¯¥è¯·æ±‚æ¥çŸ¥é“æœåŠ¡ç«¯æ˜¯å¦å…è®¸è·¨åŸŸè¯·æ±‚ã€‚ 12345678910111213141516// index.htmllet xhr = new XMLHttpRequest();document.cookie = \"name=xiamen\"; // cookieä¸èƒ½è·¨åŸŸxhr.withCredentials = true; // å‰ç«¯è®¾ç½®æ˜¯å¦å¸¦cookiexhr.open(\"PUT\", \"http://localhost:4000/getData\", true);xhr.setRequestHeader(\"name\", \"xiamen\");xhr.onreadystatechange = function() &#123; if (xhr.readyState === 4) &#123; if ((xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300) || xhr.status === 304) &#123; console.log(xhr.response); //å¾—åˆ°å“åº”å¤´ï¼Œåå°éœ€è®¾ç½®Access-Control-Expose-Headers console.log(xhr.getResponseHeader(\"name\")); &#125; &#125;&#125;;xhr.send(); 12345//server1.jslet express = require(\"express\");let app = express();app.use(express.static(__dirname));app.listen(3000); 123456789101112131415161718192021222324252627282930313233343536//server2.jslet express = require(\"express\");let app = express();let whitList = [\"http://localhost:3000\"]; //è®¾ç½®ç™½åå•app.use(function(req, res, next) &#123; let origin = req.headers.origin; if (whitList.includes(origin)) &#123; // è®¾ç½®å“ªä¸ªæºå¯ä»¥è®¿é—®æˆ‘ res.setHeader(\"Access-Control-Allow-Origin\", origin); // å…è®¸æºå¸¦å“ªä¸ªå¤´è®¿é—®æˆ‘ res.setHeader(\"Access-Control-Allow-Headers\", \"name\"); // å…è®¸å“ªä¸ªæ–¹æ³•è®¿é—®æˆ‘ res.setHeader(\"Access-Control-Allow-Methods\", \"PUT\"); // å…è®¸æºå¸¦cookie res.setHeader(\"Access-Control-Allow-Credentials\", true); // é¢„æ£€çš„å­˜æ´»æ—¶é—´ res.setHeader(\"Access-Control-Max-Age\", 6); // å…è®¸è¿”å›çš„å¤´ res.setHeader(\"Access-Control-Expose-Headers\", \"name\"); if (req.method === \"OPTIONS\") &#123; res.end(); // OPTIONSè¯·æ±‚ä¸åšä»»ä½•å¤„ç† &#125; &#125; next();&#125;);app.put(\"/getData\", function(req, res) &#123; console.log(req.headers); res.setHeader(\"name\", \"jw\"); //è¿”å›ä¸€ä¸ªå“åº”å¤´ï¼Œåå°éœ€è®¾ç½® res.end(\"æˆ‘ä¸çˆ±ä½ \");&#125;);app.get(\"/getData\", function(req, res) &#123; console.log(req.headers); res.end(\"æˆ‘ä¸çˆ±ä½ \");&#125;);app.use(express.static(__dirname));app.listen(4000); postMessageæ˜¯ä¸ºæ•°ä¸å¤šå¯ä»¥è·¨åŸŸæ“ä½œçš„ window å±æ€§ï¼Œå¯ç”¨äºè§£å†³ä»¥ä¸‹æ–¹é¢çš„é—®é¢˜ï¼š é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’ å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’ é¡µé¢ä¸åµŒå¥—çš„ iframe æ¶ˆæ¯ä¼ é€’ ä¸Šé¢ä¸‰ä¸ªåœºæ™¯çš„è·¨åŸŸæ•°æ®ä¼ é€’postMessage()æ–¹æ³•å…è®¸æ¥è‡ªä¸åŒæºçš„è„šæœ¬é‡‡ç”¨å¼‚æ­¥æ–¹å¼è¿›è¡Œæœ‰é™çš„é€šä¿¡ï¼Œå¯ä»¥å®ç°è·¨æ–‡æœ¬æ¡£ã€å¤šçª—å£ã€è·¨åŸŸæ¶ˆæ¯ä¼ é€’ã€‚ 1otherWindow.postMessage(message, targetOrigin, [transfer]); ä¾‹å­ï¼š 123456789101112131415161718// a.html&lt;iframe src=\"http://localhost:4000/b.html\" frameborder=\"0\" id=\"frame\" onload=\"load()\"&gt;&lt;/iframe&gt;//ç­‰å®ƒåŠ è½½å®Œè§¦å‘ä¸€ä¸ªäº‹ä»¶ //å†…åµŒåœ¨http://localhost:3000/a.html&lt;script&gt; function load() &#123; let frame = document.getElementById(\"frame\"); frame.contentWindow.postMessage(\"æˆ‘çˆ±ä½ \", \"http://localhost:4000\"); //å‘é€æ•°æ® window.onmessage = function(e) &#123; //æ¥å—è¿”å›æ•°æ® console.log(e.data); //æˆ‘ä¸çˆ±ä½  &#125;; &#125;&lt;/script&gt; 12345// b.htmlwindow.onmessage = function(e) &#123; console.log(e.data); //æˆ‘çˆ±ä½  e.source.postMessage(\"æˆ‘ä¸çˆ±ä½ \", e.origin);&#125;; websocketWebsocket æ˜¯ HTML5 çš„ WebSocket å’Œ HTTP éƒ½æ˜¯åº”ç”¨å±‚åè®®ï¼Œéƒ½åŸºäº TCP åè®®ã€‚ä½†æ˜¯ WebSocket æ˜¯ä¸€ç§åŒå‘é€šä¿¡åè®®ï¼Œåœ¨å»ºç«‹è¿æ¥ä¹‹åï¼ŒWebSocket çš„ server ä¸ client éƒ½èƒ½ä¸»åŠ¨å‘å¯¹æ–¹å‘é€æˆ–æ¥æ”¶æ•°æ®ã€‚ä¸€ä¸ªæŒä¹…åŒ–çš„åè®®ï¼Œå®ƒå®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„å…¨åŒå·¥é€šä¿¡ï¼ŒåŒæ—¶ä¹Ÿæ˜¯è·¨åŸŸçš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚åŒæ—¶ï¼ŒWebSocket åœ¨å»ºç«‹è¿æ¥æ—¶éœ€è¦å€ŸåŠ© HTTP åè®®ï¼Œè¿æ¥å»ºç«‹å¥½äº†ä¹‹å client ä¸ server ä¹‹é—´çš„åŒå‘é€šä¿¡å°±ä¸ HTTP æ— å…³äº†ã€‚ 12345678910// socket.html&lt;script&gt; let socket = new WebSocket(\"ws://localhost:3000\"); socket.onopen = function() &#123; socket.send(\"æˆ‘çˆ±ä½ \"); //å‘æœåŠ¡å™¨å‘é€æ•°æ® &#125;; socket.onmessage = function(e) &#123; console.log(e.data); //æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ•°æ® &#125;;&lt;/script&gt; 1234567891011// server.jslet express = require(\"express\");let app = express();let WebSocket = require(\"ws\"); //è®°å¾—å®‰è£…wslet wss = new WebSocket.Server(&#123; port: 3000 &#125;);wss.on(\"connection\", function(ws) &#123; ws.on(\"message\", function(data) &#123; console.log(data); ws.send(\"æˆ‘ä¸çˆ±ä½ \"); &#125;);&#125;); Node ä¸­é—´ä»¶ä»£ç†(ä¸¤æ¬¡è·¨åŸŸ)å®ç°åŸç†ï¼šåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨éœ€è¦éµå¾ªçš„æ ‡å‡†ï¼Œè€Œå¦‚æœæ˜¯æœåŠ¡å™¨å‘æœåŠ¡å™¨è¯·æ±‚å°±æ— éœ€éµå¾ªåŒæºç­–ç•¥ã€‚ ä»£ç†æœåŠ¡å™¨ï¼Œéœ€è¦åšä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š æ¥å—å®¢æˆ·ç«¯è¯·æ±‚ ã€‚ å°†è¯·æ±‚ è½¬å‘ç»™æœåŠ¡å™¨ã€‚ æ‹¿åˆ°æœåŠ¡å™¨ å“åº” æ•°æ®ã€‚ å°† å“åº” è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ æœ¬åœ°æ–‡ä»¶ index.html æ–‡ä»¶ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨http://localhost:3000å‘ç›®æ ‡æœåŠ¡å™¨http://localhost:4000è¯·æ±‚æ•°æ®ï¼š 12345678910111213141516// index.html(http://127.0.0.1:5500)&lt;script src=\"https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;&lt;script&gt; $.ajax(&#123; url: \"http://localhost:3000\", type: \"post\", data: &#123; name: \"xiamen\", password: \"123456\" &#125;, contentType: \"application/json;charset=utf-8\", success: function(result) &#123; console.log(result); // &#123;\"title\":\"fontend\",\"password\":\"123456\"&#125; &#125;, error: function(msg) &#123; console.log(msg); &#125; &#125;);&lt;/script&gt; 1234567891011121314151617181920212223242526272829303132333435363738// server1.js ä»£ç†æœåŠ¡å™¨(http://localhost:3000)const http = require(\"http\");// ç¬¬ä¸€æ­¥ï¼šæ¥å—å®¢æˆ·ç«¯è¯·æ±‚const server = http.createServer((request, response) =&gt; &#123; // ä»£ç†æœåŠ¡å™¨ï¼Œç›´æ¥å’Œæµè§ˆå™¨ç›´æ¥äº¤äº’ï¼Œéœ€è¦è®¾ç½®CORS çš„é¦–éƒ¨å­—æ®µ response.writeHead(200, &#123; \"Access-Control-Allow-Origin\": \"*\", \"Access-Control-Allow-Methods\": \"*\", \"Access-Control-Allow-Headers\": \"Content-Type\" &#125;); // ç¬¬äºŒæ­¥ï¼šå°†è¯·æ±‚è½¬å‘ç»™æœåŠ¡å™¨ const proxyRequest = http .request( &#123; host: \"127.0.0.1\", port: 4000, url: \"/\", method: request.method, headers: request.headers &#125;, serverResponse =&gt; &#123; // ç¬¬ä¸‰æ­¥ï¼šæ”¶åˆ°æœåŠ¡å™¨çš„å“åº” var body = \"\"; serverResponse.on(\"data\", chunk =&gt; &#123; body += chunk; &#125;); serverResponse.on(\"end\", () =&gt; &#123; console.log(\"The data is \" + body); // ç¬¬å››æ­¥ï¼šå°†å“åº”ç»“æœè½¬å‘ç»™æµè§ˆå™¨ response.end(body); &#125;); &#125; ) .end();&#125;);server.listen(3000, () =&gt; &#123; console.log(\"The proxyServer is running at http://localhost:3000\");&#125;); 1234567891011// server2.js(http://localhost:4000)const http = require(\"http\");const data = &#123; title: \"fontend\", password: \"123456\" &#125;;const server = http.createServer((request, response) =&gt; &#123; if (request.url === \"/\") &#123; response.end(JSON.stringify(data)); &#125;&#125;);server.listen(4000, () =&gt; &#123; console.log(\"The server is running at http://localhost:4000\");&#125;); nginx åå‘ä»£ç†å®ç°åŸç†ç±»ä¼¼äº Node ä¸­é—´ä»¶ä»£ç†ï¼Œéœ€è¦ä½ æ­å»ºä¸€ä¸ªä¸­è½¬ nginx æœåŠ¡å™¨ï¼Œç”¨äºè½¬å‘è¯·æ±‚ã€‚ ä½¿ç”¨ nginx åå‘ä»£ç†å®ç°è·¨åŸŸï¼Œæ˜¯æœ€ç®€å•çš„è·¨åŸŸæ–¹å¼ã€‚åªéœ€è¦ä¿®æ”¹ nginx çš„é…ç½®å³å¯è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæ”¯æŒæ‰€æœ‰æµè§ˆå™¨ï¼Œæ”¯æŒ sessionï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“æœåŠ¡å™¨æ€§èƒ½ã€‚ å®ç°æ€è·¯ï¼šé€šè¿‡ nginx é…ç½®ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼ˆåŸŸåä¸ domain1 ç›¸åŒï¼Œç«¯å£ä¸åŒï¼‰åšè·³æ¿æœºï¼Œåå‘ä»£ç†è®¿é—® domain2 æ¥å£ï¼Œå¹¶ä¸”å¯ä»¥é¡ºä¾¿ä¿®æ”¹ cookie ä¸­ domain ä¿¡æ¯ï¼Œæ–¹ä¾¿å½“å‰åŸŸ cookie å†™å…¥ï¼Œå®ç°è·¨åŸŸç™»å½•ã€‚ å…ˆä¸‹è½½ nginxï¼Œç„¶åå°† nginx ç›®å½•ä¸‹çš„ nginx.conf ä¿®æ”¹ï¼Œæœ€åé€šè¿‡å‘½ä»¤è¡Œ nginx -s reload å¯åŠ¨ nginx window.name + iframewindow.name å±æ€§çš„ç‹¬ç‰¹ä¹‹å¤„ï¼šname å€¼åœ¨ä¸åŒçš„é¡µé¢ï¼ˆç”šè‡³ä¸åŒåŸŸåï¼‰åŠ è½½åä¾æ—§å­˜åœ¨ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒéå¸¸é•¿çš„ name å€¼ï¼ˆ2MBï¼‰ã€‚å…¶ä¸­ a.html å’Œ b.html æ˜¯åŒåŸŸçš„ï¼Œéƒ½æ˜¯http://localhost:3000;è€Œc.htmlæ˜¯http://localhost:4000 12345678910111213141516171819202122// a.html(http://localhost:3000/b.html)&lt;iframe src=\"http://localhost:4000/c.html\" frameborder=\"0\" onload=\"load()\" id=\"iframe\"&gt;&lt;/iframe&gt;&lt;script&gt; let first = true; // onloadäº‹ä»¶ä¼šè§¦å‘2æ¬¡ï¼Œç¬¬1æ¬¡åŠ è½½è·¨åŸŸé¡µï¼Œå¹¶ç•™å­˜æ•°æ®äºwindow.name function load() &#123; if (first) &#123; // ç¬¬1æ¬¡onload(è·¨åŸŸé¡µ)æˆåŠŸåï¼Œåˆ‡æ¢åˆ°åŒåŸŸä»£ç†é¡µé¢ let iframe = document.getElementById(\"iframe\"); iframe.src = \"http://localhost:3000/b.html\"; first = false; &#125; else &#123; // ç¬¬2æ¬¡onload(åŒåŸŸb.htmlé¡µ)æˆåŠŸåï¼Œè¯»å–åŒåŸŸwindow.nameä¸­æ•°æ® console.log(iframe.contentWindow.name); &#125; &#125;&lt;/script&gt; b.html ä¸ºä¸­é—´ä»£ç†é¡µï¼Œä¸ a.html åŒåŸŸï¼Œå†…å®¹ä¸ºç©ºã€‚ 1234// c.html(http://localhost:4000/c.html)&lt;script&gt; window.name = \"æˆ‘ä¸çˆ±ä½ \";&lt;/script&gt; é€šè¿‡ iframe çš„ src å±æ€§ç”±å¤–åŸŸè½¬å‘æœ¬åœ°åŸŸï¼Œè·¨åŸŸæ•°æ®å³ç”± iframe çš„ window.name ä»å¤–åŸŸä¼ é€’åˆ°æœ¬åœ°åŸŸã€‚è¿™ä¸ªå°±å·§å¦™åœ°ç»•è¿‡äº†æµè§ˆå™¨çš„è·¨åŸŸè®¿é—®é™åˆ¶ï¼Œä½†åŒæ—¶å®ƒåˆæ˜¯å®‰å…¨æ“ä½œã€‚ location.hash + iframeå®ç°åŸç†ï¼š a.html æ¬²ä¸ c.html è·¨åŸŸç›¸äº’é€šä¿¡ï¼Œé€šè¿‡ä¸­é—´é¡µ b.html æ¥å®ç°ã€‚ ä¸‰ä¸ªé¡µé¢ï¼Œä¸åŒåŸŸä¹‹é—´åˆ©ç”¨ iframe çš„ location.hash ä¼ å€¼ï¼Œç›¸åŒåŸŸä¹‹é—´ç›´æ¥ js è®¿é—®æ¥é€šä¿¡ã€‚ å…·ä½“å®ç°æ­¥éª¤ï¼šä¸€å¼€å§‹ a.html ç»™ c.html ä¼ ä¸€ä¸ª hash å€¼ï¼Œç„¶å c.html æ”¶åˆ° hash å€¼åï¼Œå†æŠŠ hash å€¼ä¼ é€’ç»™ b.htmlï¼Œæœ€å b.html å°†ç»“æœæ”¾åˆ° a.html çš„ hash å€¼ä¸­ã€‚ 12345678// a.html&lt;iframe src=\"http://localhost:4000/c.html#iloveyou\"&gt;&lt;/iframe&gt;&lt;script&gt; window.onhashchange = function() &#123; //æ£€æµ‹hashçš„å˜åŒ– console.log(location.hash); &#125;;&lt;/script&gt; 12345// b.html&lt;script&gt; window.parent.parent.location.hash = location.hash; //b.htmlå°†ç»“æœæ”¾åˆ°a.htmlçš„hashå€¼ä¸­ï¼Œb.htmlå¯é€šè¿‡parent.parentè®¿é—®a.htmlé¡µé¢&lt;/script&gt; 12345// c.htmlconsole.log(location.hash);let iframe = document.createElement(\"iframe\");iframe.src = \"http://localhost:3000/b.html#idontloveyou\";document.body.appendChild(iframe); document.domain + iframeè¯¥æ–¹å¼åªèƒ½ç”¨äºäºŒçº§åŸŸåç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚ a.test.com å’Œ b.test.com é€‚ç”¨äºè¯¥æ–¹å¼ã€‚åªéœ€è¦ç»™é¡µé¢æ·»åŠ  document.domain =â€™test.comâ€™ è¡¨ç¤ºäºŒçº§åŸŸåéƒ½ç›¸åŒå°±å¯ä»¥å®ç°è·¨åŸŸã€‚å®ç°åŸç†ï¼šä¸¤ä¸ªé¡µé¢éƒ½é€šè¿‡ js å¼ºåˆ¶è®¾ç½® document.domain ä¸ºåŸºç¡€ä¸»åŸŸï¼Œå°±å®ç°äº†åŒåŸŸã€‚ 12345678910111213141516// a.zf1.cn:3000/a.html&lt;body&gt; helloa &lt;iframe src=\"http://b.zf1.cn:3000/b.html\" frameborder=\"0\" onload=\"load()\" id=\"frame\" &gt;&lt;/iframe&gt; &lt;script&gt; document.domain = \"zf1.cn\"; function load() &#123; console.log(frame.contentWindow.a); &#125; &lt;/script&gt;&lt;/body&gt; 12345678// b.zf1.cn:3000/b.html&lt;body&gt; hellob &lt;script&gt; document.domain = \"zf1.cn\"; var a = 100; &lt;/script&gt;&lt;/body&gt;","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"},{"name":"è·¨åŸŸ","slug":"è·¨åŸŸ","permalink":"http://yoursite.com/tags/è·¨åŸŸ/"}]},{"title":"æ ‘çš„diffç®—æ³•ï¼ˆvue 2.0ï¼‰","slug":"æ ‘çš„diffç®—æ³•ï¼ˆvue 2.0ï¼‰","date":"2019-02-25T16:26:33.000Z","updated":"2019-11-10T14:37:39.036Z","comments":true,"path":"2019/02/26/æ ‘çš„diffç®—æ³•ï¼ˆvue 2.0ï¼‰/","link":"","permalink":"http://yoursite.com/2019/02/26/æ ‘çš„diffç®—æ³•ï¼ˆvue 2.0ï¼‰/","excerpt":"æ ‘çš„ diff ç®—æ³•ï¼ˆvue 2.0ï¼‰æ¨¡æ¿è½¬æ¢æˆè§†å›¾çš„è¿‡ç¨‹ Vue.js é€šè¿‡ç¼–è¯‘å°† template æ¨¡æ¿è½¬æ¢æˆæ¸²æŸ“å‡½æ•°(render ) ï¼Œæ‰§è¡Œæ¸²æŸ“å‡½æ•°å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹æ ‘ åœ¨å¯¹ Model è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº” Dep ä¸­çš„ Watcher å¯¹è±¡ã€‚Watcher å¯¹è±¡ä¼šè°ƒç”¨å¯¹åº”çš„ update æ¥ä¿®æ”¹è§†å›¾ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ˜¯å°†æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹è¿›è¡Œå·®å¼‚å¯¹æ¯”ï¼Œç„¶åæ ¹æ®å¯¹æ¯”ç»“æœè¿›è¡Œ DOM æ“ä½œæ¥æ›´æ–°è§†å›¾ã€‚ ç®€å•ç‚¹è®²ï¼Œåœ¨ Vue çš„åº•å±‚å®ç°ä¸Šï¼ŒVue å°†æ¨¡æ¿ç¼–è¯‘æˆè™šæ‹Ÿ DOM æ¸²æŸ“å‡½æ•°ã€‚ç»“åˆ Vue è‡ªå¸¦çš„å“åº”ç³»ç»Ÿï¼Œåœ¨çŠ¶æ€æ”¹å˜æ—¶ï¼ŒVue èƒ½å¤Ÿæ™ºèƒ½åœ°è®¡ç®—å‡ºé‡æ–°æ¸²æŸ“ç»„ä»¶çš„æœ€å°ä»£ä»·å¹¶åº”åˆ° DOM æ“ä½œä¸Šã€‚","text":"æ ‘çš„ diff ç®—æ³•ï¼ˆvue 2.0ï¼‰æ¨¡æ¿è½¬æ¢æˆè§†å›¾çš„è¿‡ç¨‹ Vue.js é€šè¿‡ç¼–è¯‘å°† template æ¨¡æ¿è½¬æ¢æˆæ¸²æŸ“å‡½æ•°(render ) ï¼Œæ‰§è¡Œæ¸²æŸ“å‡½æ•°å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹æ ‘ åœ¨å¯¹ Model è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº” Dep ä¸­çš„ Watcher å¯¹è±¡ã€‚Watcher å¯¹è±¡ä¼šè°ƒç”¨å¯¹åº”çš„ update æ¥ä¿®æ”¹è§†å›¾ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ˜¯å°†æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹è¿›è¡Œå·®å¼‚å¯¹æ¯”ï¼Œç„¶åæ ¹æ®å¯¹æ¯”ç»“æœè¿›è¡Œ DOM æ“ä½œæ¥æ›´æ–°è§†å›¾ã€‚ ç®€å•ç‚¹è®²ï¼Œåœ¨ Vue çš„åº•å±‚å®ç°ä¸Šï¼ŒVue å°†æ¨¡æ¿ç¼–è¯‘æˆè™šæ‹Ÿ DOM æ¸²æŸ“å‡½æ•°ã€‚ç»“åˆ Vue è‡ªå¸¦çš„å“åº”ç³»ç»Ÿï¼Œåœ¨çŠ¶æ€æ”¹å˜æ—¶ï¼ŒVue èƒ½å¤Ÿæ™ºèƒ½åœ°è®¡ç®—å‡ºé‡æ–°æ¸²æŸ“ç»„ä»¶çš„æœ€å°ä»£ä»·å¹¶åº”åˆ° DOM æ“ä½œä¸Šã€‚ æ¸²æŸ“å‡½æ•°ï¼šæ¸²æŸ“å‡½æ•°æ˜¯ç”¨æ¥ç”Ÿæˆ Virtual DOM çš„ã€‚Vue æ¨èä½¿ç”¨æ¨¡æ¿æ¥æ„å»ºæˆ‘ä»¬çš„åº”ç”¨ç•Œé¢ï¼Œåœ¨åº•å±‚å®ç°ä¸­ Vue ä¼šå°†æ¨¡æ¿ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸å†™æ¨¡æ¿ï¼Œç›´æ¥å†™æ¸²æŸ“å‡½æ•°ï¼Œä»¥è·å¾—æ›´å¥½çš„æ§åˆ¶ã€‚ VNode è™šæ‹ŸèŠ‚ç‚¹ï¼šå®ƒå¯ä»¥ä»£è¡¨ä¸€ä¸ªçœŸå®çš„ dom èŠ‚ç‚¹ã€‚é€šè¿‡ createElement æ–¹æ³•èƒ½å°† VNode æ¸²æŸ“æˆ dom èŠ‚ç‚¹ã€‚ç®€å•åœ°è¯´ï¼Œvnode å¯ä»¥ç†è§£æˆèŠ‚ç‚¹æè¿°å¯¹è±¡ï¼Œå®ƒæè¿°äº†åº”è¯¥æ€æ ·å»åˆ›å»ºçœŸå®çš„ DOM èŠ‚ç‚¹ã€‚ patch(ä¹Ÿå«åš patching ç®—æ³•)ï¼šè™šæ‹Ÿ DOM æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå®ƒå¯ä»¥å°† vnode æ¸²æŸ“æˆçœŸå®çš„ DOMï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¯¹æ¯”æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹ä¹‹é—´æœ‰å“ªäº›ä¸åŒï¼Œç„¶åæ ¹æ®å¯¹æ¯”ç»“æœæ‰¾å‡ºéœ€è¦æ›´æ–°çš„çš„èŠ‚ç‚¹è¿›è¡Œæ›´æ–°ã€‚è¿™ç‚¹æˆ‘ä»¬ä»å•è¯å«ä¹‰å°±å¯ä»¥çœ‹å‡ºï¼Œ patch æœ¬èº«å°±æœ‰è¡¥ä¸ã€ä¿®è¡¥çš„æ„æ€ï¼Œå…¶å®é™…ä½œç”¨æ˜¯åœ¨ç°æœ‰ DOM ä¸Šè¿›è¡Œä¿®æ”¹æ¥å®ç°æ›´æ–°è§†å›¾çš„ç›®çš„ã€‚Vue çš„ Virtual DOM Patching ç®—æ³•æ˜¯åŸºäºSnabbdomçš„å®ç°ï¼Œå¹¶åœ¨äº›åŸºç¡€ä¸Šä½œäº†å¾ˆå¤šçš„è°ƒæ•´å’Œæ”¹è¿›ã€‚ Virtual DOM æ˜¯ä»€ä¹ˆï¼ŸVirtual DOM å…¶å®å°±æ˜¯ä¸€æ£µä»¥ JavaScript å¯¹è±¡( VNode èŠ‚ç‚¹)ä½œä¸ºåŸºç¡€çš„æ ‘ï¼Œç”¨å¯¹è±¡å±æ€§æ¥æè¿°èŠ‚ç‚¹ï¼Œå®é™…ä¸Šå®ƒåªæ˜¯ä¸€å±‚å¯¹çœŸå® DOM çš„æŠ½è±¡ã€‚æœ€ç»ˆå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—æ“ä½œä½¿è¿™æ£µæ ‘æ˜ å°„åˆ°çœŸå®ç¯å¢ƒä¸Šã€‚ ç®€å•æ¥è¯´ï¼Œå¯ä»¥æŠŠ Virtual DOM ç†è§£ä¸ºä¸€ä¸ªç®€å•çš„ JS å¯¹è±¡ï¼Œå¹¶ä¸”æœ€å°‘åŒ…å«æ ‡ç­¾å( tag)ã€å±æ€§(attrs)å’Œå­å…ƒç´ å¯¹è±¡( children)ä¸‰ä¸ªå±æ€§ã€‚ä¸åŒçš„æ¡†æ¶å¯¹è¿™ä¸‰ä¸ªå±æ€§çš„å‘½åä¼šæœ‰ç‚¹å·®åˆ«ã€‚ å¯¹äºè™šæ‹Ÿ DOMï¼Œå’±ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„å®ä¾‹ï¼Œå°±æ˜¯ä¸‹å›¾æ‰€ç¤ºçš„è¿™ä¸ªï¼Œè¯¦ç»†çš„é˜è¿°äº†æ¨¡æ¿ â†’ æ¸²æŸ“å‡½æ•° â†’ è™šæ‹ŸDOMæ ‘ â†’ çœŸå®DOMçš„ä¸€ä¸ªè¿‡ç¨‹ Virtual DOM ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿè™šæ‹Ÿ DOM çš„æœ€ç»ˆç›®æ ‡æ˜¯å°†è™šæ‹ŸèŠ‚ç‚¹æ¸²æŸ“åˆ°è§†å›¾ä¸Šã€‚ä½†æ˜¯å¦‚æœç›´æ¥ä½¿ç”¨è™šæ‹ŸèŠ‚ç‚¹è¦†ç›–æ—§èŠ‚ç‚¹çš„è¯ï¼Œä¼šæœ‰å¾ˆå¤šä¸å¿…è¦çš„ DOM æ“ä½œã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª ul æ ‡ç­¾ä¸‹å¾ˆå¤šä¸ª li æ ‡ç­¾ï¼Œå…¶ä¸­åªæœ‰ä¸€ä¸ª li æœ‰å˜åŒ–ï¼Œè¿™ç§æƒ…å†µä¸‹å¦‚æœä½¿ç”¨æ–°çš„ ul å»æ›¿ä»£æ—§çš„ ul,å› ä¸ºè¿™äº›ä¸å¿…è¦çš„ DOM æ“ä½œè€Œé€ æˆäº†æ€§èƒ½ä¸Šçš„æµªè´¹ã€‚ ä¸ºäº†é¿å…ä¸å¿…è¦çš„ DOM æ“ä½œï¼Œè™šæ‹Ÿ DOM åœ¨è™šæ‹ŸèŠ‚ç‚¹æ˜ å°„åˆ°è§†å›¾çš„è¿‡ç¨‹ä¸­ï¼Œå°†è™šæ‹ŸèŠ‚ç‚¹ä¸ä¸Šä¸€æ¬¡æ¸²æŸ“è§†å›¾æ‰€ä½¿ç”¨çš„æ—§è™šæ‹ŸèŠ‚ç‚¹ï¼ˆoldVnodeï¼‰åšå¯¹æ¯”ï¼Œæ‰¾å‡ºçœŸæ­£éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹æ¥è¿›è¡Œ DOM æ“ä½œï¼Œä»è€Œé¿å…æ“ä½œå…¶ä»–æ— éœ€æ”¹åŠ¨çš„ DOMã€‚ å…¶å®è™šæ‹Ÿ DOM åœ¨ Vue.js ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š æä¾›ä¸çœŸå® DOM èŠ‚ç‚¹æ‰€å¯¹åº”çš„è™šæ‹ŸèŠ‚ç‚¹ vnode å°†è™šæ‹ŸèŠ‚ç‚¹ vnode å’Œæ—§è™šæ‹ŸèŠ‚ç‚¹ oldVnode è¿›è¡Œå¯¹æ¯”ï¼Œç„¶åæ›´æ–°è§†å›¾ ä¸ºä½•éœ€è¦ Virtual DOMï¼Ÿ å…·å¤‡è·¨å¹³å°çš„ä¼˜åŠ¿ ç”±äº Virtual DOM æ˜¯ä»¥ JavaScript å¯¹è±¡ä¸ºåŸºç¡€è€Œä¸ä¾èµ–çœŸå®å¹³å°ç¯å¢ƒï¼Œæ‰€ä»¥ä½¿å®ƒå…·æœ‰äº†è·¨å¹³å°çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æµè§ˆå™¨å¹³å°ã€Weexã€Node ç­‰ã€‚ æ“ä½œ DOM æ…¢ï¼Œjs è¿è¡Œæ•ˆç‡é«˜ã€‚æˆ‘ä»¬å¯ä»¥å°† DOM å¯¹æ¯”æ“ä½œæ”¾åœ¨ JS å±‚ï¼Œæé«˜æ•ˆç‡ã€‚ å› ä¸º DOM æ“ä½œçš„æ‰§è¡Œé€Ÿåº¦è¿œä¸å¦‚ Javascript çš„è¿ç®—é€Ÿåº¦å¿«ï¼Œå› æ­¤ï¼ŒæŠŠå¤§é‡çš„ DOM æ“ä½œæ¬è¿åˆ° Javascript ä¸­ï¼Œè¿ç”¨ patching ç®—æ³•æ¥è®¡ç®—å‡ºçœŸæ­£éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘ DOM æ“ä½œï¼Œä»è€Œæ˜¾è‘—æé«˜æ€§èƒ½ã€‚ Virtual DOM æœ¬è´¨ä¸Šå°±æ˜¯åœ¨ JS å’Œ DOM ä¹‹é—´åšäº†ä¸€ä¸ªç¼“å­˜ã€‚å¯ä»¥ç±»æ¯” CPU å’Œç¡¬ç›˜ï¼Œæ—¢ç„¶ç¡¬ç›˜è¿™ä¹ˆæ…¢ï¼Œæˆ‘ä»¬å°±åœ¨å®ƒä»¬ä¹‹é—´åŠ ä¸ªç¼“å­˜ï¼šæ—¢ç„¶ DOM è¿™ä¹ˆæ…¢ï¼Œæˆ‘ä»¬å°±åœ¨å®ƒä»¬ JS å’Œ DOM ä¹‹é—´åŠ ä¸ªç¼“å­˜ã€‚CPUï¼ˆJSï¼‰åªæ“ä½œå†…å­˜ï¼ˆVirtual DOMï¼‰ï¼Œæœ€åçš„æ—¶å€™å†æŠŠå˜æ›´å†™å…¥ç¡¬ç›˜ï¼ˆDOMï¼‰ æå‡æ¸²æŸ“æ€§èƒ½ Virtual DOM çš„ä¼˜åŠ¿ä¸åœ¨äºå•æ¬¡çš„æ“ä½œï¼Œè€Œæ˜¯åœ¨å¤§é‡ã€é¢‘ç¹çš„æ•°æ®æ›´æ–°ä¸‹ï¼Œèƒ½å¤Ÿå¯¹è§†å›¾è¿›è¡Œåˆç†ã€é«˜æ•ˆçš„æ›´æ–°ã€‚ ä¸ºäº†å®ç°é«˜æ•ˆçš„ DOM æ“ä½œï¼Œä¸€å¥—é«˜æ•ˆçš„è™šæ‹Ÿ DOM diff ç®—æ³•æ˜¾å¾—å¾ˆæœ‰å¿…è¦ã€‚æˆ‘ä»¬é€šè¿‡ patch çš„æ ¸å¿ƒâ€”-diff ç®—æ³•ï¼Œæ‰¾å‡ºæœ¬æ¬¡ DOM éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹æ¥æ›´æ–°ï¼Œå…¶ä»–çš„ä¸æ›´æ–°ã€‚ VNodeæŠ½è±¡ Dom æ ‘æŠŠçœŸå® Dom æ ‘æŠ½è±¡æˆä¸€æ£µä»¥ javascript å¯¹è±¡æ„æˆçš„æŠ½è±¡æ ‘ï¼Œåœ¨ä¿®æ”¹æŠ½è±¡æ ‘æ•°æ®åå°†æŠ½è±¡æ ‘è½¬åŒ–æˆçœŸå® Dom é‡ç»˜åˆ°é¡µé¢ä¸Šå‘¢ï¼Ÿäºæ˜¯è™šæ‹Ÿ Dom å‡ºç°äº†ï¼Œå®ƒæ˜¯çœŸå® Dom çš„ä¸€å±‚æŠ½è±¡ï¼Œç”¨å±æ€§æè¿°çœŸå® Dom çš„å„ä¸ªç‰¹æ€§ã€‚å½“å®ƒå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šå»ä¿®æ”¹è§†å›¾ã€‚ ä½†æ˜¯è¿™æ ·çš„ javascript æ“ä½œ Dom è¿›è¡Œé‡ç»˜æ•´ä¸ªè§†å›¾å±‚æ˜¯ç›¸å½“æ¶ˆè€—æ€§èƒ½çš„ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æ¯æ¬¡åªæ›´æ–°å®ƒçš„ä¿®æ”¹å‘¢ï¼Ÿæ‰€ä»¥ Vue.js å°† Dom æŠ½è±¡æˆä¸€ä¸ªä»¥ javascript å¯¹è±¡ä¸ºèŠ‚ç‚¹çš„è™šæ‹Ÿ Dom æ ‘ï¼Œä»¥ VNode èŠ‚ç‚¹æ¨¡æ‹ŸçœŸå® Domï¼Œå¯ä»¥å¯¹è¿™é¢—æŠ½è±¡æ ‘è¿›è¡Œåˆ›å»ºèŠ‚ç‚¹ã€åˆ é™¤èŠ‚ç‚¹ä»¥åŠä¿®æ”¹èŠ‚ç‚¹ç­‰æ“ä½œï¼Œåœ¨è¿™è¿‡ç¨‹ä¸­éƒ½ä¸éœ€è¦æ“ä½œçœŸå® Domï¼Œåªéœ€è¦æ“ä½œ javascript å¯¹è±¡ï¼Œå¤§å¤§æå‡äº†æ€§èƒ½ã€‚ä¿®æ”¹ä»¥åç»è¿‡ diff ç®—æ³•å¾—å‡ºä¸€äº›éœ€è¦ä¿®æ”¹çš„æœ€å°å•ä½ï¼Œå†å°†è¿™äº›å°å•ä½çš„è§†å›¾è¿›è¡Œæ›´æ–°ã€‚è¿™æ ·åšå‡å°‘äº†å¾ˆå¤šä¸éœ€è¦çš„ Dom æ“ä½œï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½ã€‚ Vue å°±ä½¿ç”¨äº†è¿™æ ·çš„æŠ½è±¡èŠ‚ç‚¹ VNodeï¼Œå®ƒæ˜¯å¯¹çœŸå® Dom çš„ä¸€å±‚æŠ½è±¡ï¼Œè€Œä¸ä¾èµ–æŸä¸ªå¹³å°ï¼Œå®ƒå¯ä»¥æ˜¯æµè§ˆå™¨å¹³å°ï¼Œä¹Ÿå¯ä»¥æ˜¯ weexï¼Œç”šè‡³æ˜¯ node å¹³å°ä¹Ÿå¯ä»¥å¯¹è¿™æ ·ä¸€æ£µæŠ½è±¡ Dom æ ‘è¿›è¡Œåˆ›å»ºåˆ é™¤ä¿®æ”¹ç­‰æ“ä½œï¼Œè¿™ä¹Ÿä¸ºå‰åç«¯åŒæ„æä¾›äº†å¯èƒ½ã€‚ VNode åŸºç±»å…ˆæ¥çœ‹ä¸€ä¸‹ Vue.js æºç ä¸­å¯¹ VNode ç±»çš„å®šä¹‰ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273export default class VNode &#123; tag: string | void; data: VNodeData | void; children: ?Array&lt;VNode&gt;; text: string | void; elm: Node | void; ns: string | void; context: Component | void; // rendered in this component's scope functionalContext: Component | void; // only for functional component root nodes key: string | number | void; componentOptions: VNodeComponentOptions | void; componentInstance: Component | void; // component instance parent: VNode | void; // component placeholder node raw: boolean; // contains raw HTML? (server only) isStatic: boolean; // hoisted static node isRootInsert: boolean; // necessary for enter transition check isComment: boolean; // empty comment placeholder? isCloned: boolean; // is a cloned node? isOnce: boolean; // is a v-once node? constructor( tag?: string, data?: VNodeData, children?: ?Array&lt;VNode&gt;, text?: string, elm?: Node, context?: Component, componentOptions?: VNodeComponentOptions ) &#123; /*å½“å‰èŠ‚ç‚¹çš„æ ‡ç­¾å*/ this.tag = tag; /*å½“å‰èŠ‚ç‚¹å¯¹åº”çš„å¯¹è±¡ï¼ŒåŒ…å«äº†å…·ä½“çš„ä¸€äº›æ•°æ®ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªVNodeDataç±»å‹ï¼Œå¯ä»¥å‚è€ƒVNodeDataç±»å‹ä¸­çš„æ•°æ®ä¿¡æ¯*/ this.data = data; /*å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„*/ this.children = children; /*å½“å‰èŠ‚ç‚¹çš„æ–‡æœ¬*/ this.text = text; /*å½“å‰è™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„çœŸå®domèŠ‚ç‚¹*/ this.elm = elm; /*å½“å‰èŠ‚ç‚¹çš„åå­—ç©ºé—´*/ this.ns = undefined; /*ç¼–è¯‘ä½œç”¨åŸŸ*/ this.context = context; /*å‡½æ•°åŒ–ç»„ä»¶ä½œç”¨åŸŸ*/ this.functionalContext = undefined; /*èŠ‚ç‚¹çš„keyå±æ€§ï¼Œè¢«å½“ä½œèŠ‚ç‚¹çš„æ ‡å¿—ï¼Œç”¨ä»¥ä¼˜åŒ–*/ this.key = data &amp;&amp; data.key; /*ç»„ä»¶çš„optioné€‰é¡¹*/ this.componentOptions = componentOptions; /*å½“å‰èŠ‚ç‚¹å¯¹åº”çš„ç»„ä»¶çš„å®ä¾‹*/ this.componentInstance = undefined; /*å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹*/ this.parent = undefined; /*ç®€è€Œè¨€ä¹‹å°±æ˜¯æ˜¯å¦ä¸ºåŸç”ŸHTMLæˆ–åªæ˜¯æ™®é€šæ–‡æœ¬ï¼ŒinnerHTMLçš„æ—¶å€™ä¸ºtrueï¼ŒtextContentçš„æ—¶å€™ä¸ºfalse*/ this.raw = false; /*é™æ€èŠ‚ç‚¹æ ‡å¿—*/ this.isStatic = false; /*æ˜¯å¦ä½œä¸ºè·ŸèŠ‚ç‚¹æ’å…¥*/ this.isRootInsert = true; /*æ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹*/ this.isComment = false; /*æ˜¯å¦ä¸ºå…‹éš†èŠ‚ç‚¹*/ this.isCloned = false; /*æ˜¯å¦æœ‰v-onceæŒ‡ä»¤*/ this.isOnce = false; &#125; // DEPRECATED: alias for componentInstance for backwards compat. /* istanbul ignore next https://github.com/answershuto/learnVue*/ get child(): Component | void &#123; return this.componentInstance; &#125;&#125; è¿™æ˜¯ä¸€ä¸ªæœ€åŸºç¡€çš„ VNode èŠ‚ç‚¹ï¼Œä½œä¸ºå…¶ä»–æ´¾ç”Ÿ VNode ç±»çš„åŸºç±»ï¼Œé‡Œé¢å®šä¹‰äº†ä¸‹é¢è¿™äº›æ•°æ®ã€‚ tag: å½“å‰èŠ‚ç‚¹çš„æ ‡ç­¾å data: å½“å‰èŠ‚ç‚¹å¯¹åº”çš„å¯¹è±¡ï¼ŒåŒ…å«äº†å…·ä½“çš„ä¸€äº›æ•°æ®ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ª VNodeData ç±»å‹ï¼Œå¯ä»¥å‚è€ƒ VNodeData ç±»å‹ä¸­çš„æ•°æ®ä¿¡æ¯ children: å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ text: å½“å‰èŠ‚ç‚¹çš„æ–‡æœ¬ elm: å½“å‰è™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„çœŸå® dom èŠ‚ç‚¹ ns: å½“å‰èŠ‚ç‚¹çš„åå­—ç©ºé—´ context: å½“å‰èŠ‚ç‚¹çš„ç¼–è¯‘ä½œç”¨åŸŸ functionalContext: å‡½æ•°åŒ–ç»„ä»¶ä½œç”¨åŸŸ key: èŠ‚ç‚¹çš„ key å±æ€§ï¼Œè¢«å½“ä½œèŠ‚ç‚¹çš„æ ‡å¿—ï¼Œç”¨ä»¥ä¼˜åŒ– componentOptions: ç»„ä»¶çš„ option é€‰é¡¹ componentInstance: å½“å‰èŠ‚ç‚¹å¯¹åº”çš„ç»„ä»¶çš„å®ä¾‹ parent: å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ raw: ç®€è€Œè¨€ä¹‹å°±æ˜¯æ˜¯å¦ä¸ºåŸç”Ÿ HTML æˆ–åªæ˜¯æ™®é€šæ–‡æœ¬ï¼ŒinnerHTML çš„æ—¶å€™ä¸º trueï¼ŒtextContent çš„æ—¶å€™ä¸º false isStatic: æ˜¯å¦ä¸ºé™æ€èŠ‚ç‚¹ isRootInsert: æ˜¯å¦ä½œä¸ºè·ŸèŠ‚ç‚¹æ’å…¥ isComment: æ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹ isCloned: æ˜¯å¦ä¸ºå…‹éš†èŠ‚ç‚¹ isOnce: æ˜¯å¦æœ‰ v-once æŒ‡ä»¤ æ‰“ä¸ªæ¯”æ–¹ï¼Œæ¯”å¦‚è¯´æˆ‘ç°åœ¨æœ‰è¿™ä¹ˆä¸€ä¸ª VNode æ ‘ 123456789101112131415&#123; tag: 'div' data: &#123; class: 'test' &#125;, children: [ &#123; tag: 'span', data: &#123; class: 'demo' &#125; text: 'hello,VNode' &#125; ]&#125; æ¸²æŸ“ä¹‹åçš„ç»“æœå°±æ˜¯è¿™æ ·çš„ 123&lt;div class=\"test\"&gt; &lt;span class=\"demo\"&gt;hello,VNode&lt;/span&gt;&lt;/div&gt; ç”Ÿæˆä¸€ä¸ªæ–°çš„ VNode çš„æ–¹æ³•ä¸‹é¢è¿™äº›æ–¹æ³•éƒ½æ˜¯ä¸€äº›å¸¸ç”¨çš„æ„é€  VNode çš„æ–¹æ³•ã€‚ createEmptyVNode åˆ›å»ºä¸€ä¸ªç©º VNode èŠ‚ç‚¹ 1234567/*åˆ›å»ºä¸€ä¸ªç©ºVNodeèŠ‚ç‚¹*/export const createEmptyVNode = () =&gt; &#123; const node = new VNode(); node.text = \"\"; node.isComment = true; return node;&#125;; createTextVNode åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ 1234/*åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹*/export function createTextVNode(val: string | number) &#123; return new VNode(undefined, undefined, undefined, String(val));&#125; createComponent åˆ›å»ºä¸€ä¸ªç»„ä»¶èŠ‚ç‚¹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071 // plain options object: turn it into a constructor https://github.com/answershuto/learnVue if (isObject(Ctor)) &#123; Ctor = baseCtor.extend(Ctor) &#125; // if at this stage it's not a constructor or an async component factory, // reject. /*Github:https://github.com/answershuto*/ /*å¦‚æœåœ¨è¯¥é˜¶æ®µCtorä¾ç„¶ä¸æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°æˆ–è€…æ˜¯ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶å·¥å‚åˆ™ç›´æ¥è¿”å›*/ if (typeof Ctor !== 'function') &#123; if (process.env.NODE_ENV !== 'production') &#123; warn(`Invalid Component definition: $&#123;String(Ctor)&#125;`, context) &#125; return &#125; // async component /*å¤„ç†å¼‚æ­¥ç»„ä»¶*/ if (isUndef(Ctor.cid)) &#123; Ctor = resolveAsyncComponent(Ctor, baseCtor, context) if (Ctor === undefined) &#123; // return nothing if this is indeed an async component // wait for the callback to trigger parent update. /*å¦‚æœè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶åˆ™ä¼šä¸ä¼šè¿”å›ä»»ä½•ä¸œè¥¿ï¼ˆundifienedï¼‰ï¼Œç›´æ¥returnæ‰ï¼Œç­‰å¾…å›è°ƒå‡½æ•°å»è§¦å‘çˆ¶ç»„ä»¶æ›´æ–°ã€‚s*/ return &#125; &#125; // resolve constructor options in case global mixins are applied after // component constructor creation resolveConstructorOptions(Ctor) data = data || &#123;&#125; // transform component v-model data into props &amp; events if (isDef(data.model)) &#123; transformModel(Ctor.options, data) &#125; // extract props const propsData = extractPropsFromVNodeData(data, Ctor, tag) // functional component if (isTrue(Ctor.options.functional)) &#123; return createFunctionalComponent(Ctor, propsData, data, context, children) &#125; // extract listeners, since these needs to be treated as // child component listeners instead of DOM listeners const listeners = data.on // replace with listeners with .native modifier data.on = data.nativeOn if (isTrue(Ctor.options.abstract)) &#123; // abstract components do not keep anything // other than props &amp; listeners data = &#123;&#125; &#125; // merge component management hooks onto the placeholder node mergeHooks(data) // return a placeholder vnode const name = Ctor.options.name || tag const vnode = new VNode( `vue-component-$&#123;Ctor.cid&#125;$&#123;name ? `-$&#123;name&#125;` : ''&#125;`, data, undefined, undefined, undefined, context, &#123; Ctor, propsData, listeners, tag, children &#125; ) return vnode&#125; cloneVNode å…‹éš†ä¸€ä¸ª VNode èŠ‚ç‚¹ 12345678910111213141516export function cloneVNode(vnode: VNode): VNode &#123; const cloned = new VNode( vnode.tag, vnode.data, vnode.children, vnode.text, vnode.elm, vnode.context, vnode.componentOptions ); cloned.ns = vnode.ns; cloned.isStatic = vnode.isStatic; cloned.key = vnode.key; cloned.isCloned = true; return cloned;&#125; createElementcreateElement ç”¨æ¥åˆ›å»ºä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ã€‚å½“ data ä¸Šå·²ç»ç»‘å®šobçš„æ—¶å€™ï¼Œä»£è¡¨è¯¥å¯¹è±¡å·²ç»è¢« Oberver è¿‡äº†ï¼Œæ‰€ä»¥åˆ›å»ºä¸€ä¸ªç©ºèŠ‚ç‚¹ã€‚tag ä¸å­˜åœ¨çš„æ—¶å€™åŒæ ·åˆ›å»ºä¸€ä¸ªç©ºèŠ‚ç‚¹ã€‚å½“ tag ä¸æ˜¯ä¸€ä¸ª String ç±»å‹çš„æ—¶å€™ä»£è¡¨ tag æ˜¯ä¸€ä¸ªç»„ä»¶çš„æ„é€ ç±»ï¼Œç›´æ¥ç”¨ new VNode åˆ›å»ºã€‚å½“ tag æ˜¯ String ç±»å‹çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯ä¿ç•™æ ‡ç­¾ï¼Œåˆ™ç”¨ new VNode åˆ›å»ºä¸€ä¸ª VNode å®ä¾‹ï¼Œå¦‚æœåœ¨ vm çš„ option çš„ components æ‰¾å¾—åˆ°è¯¥ tagï¼Œä»£è¡¨è¿™æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå¦åˆ™ç»Ÿä¸€ç”¨ new VNode åˆ›å»ºã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109// wrapper function for providing a more flexible interface// without getting yelled at by flowexport function createElement( context: Component, tag: any, data: any, children: any, normalizationType: any, alwaysNormalize: boolean): VNode &#123; /*å…¼å®¹ä¸ä¼ dataçš„æƒ…å†µ*/ if (Array.isArray(data) || isPrimitive(data)) &#123; normalizationType = children; children = data; data = undefined; &#125; /*å¦‚æœalwaysNormalizeä¸ºtrueï¼Œåˆ™normalizationTypeæ ‡è®°ä¸ºALWAYS_NORMALIZE*/ if (isTrue(alwaysNormalize)) &#123; normalizationType = ALWAYS_NORMALIZE; &#125; /*Github:https://github.com/answershuto*/ /*åˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹*/ return _createElement(context, tag, data, children, normalizationType);&#125;/*åˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹*/export function _createElement( context: Component, tag?: string | Class&lt;Component&gt; | Function | Object, data?: VNodeData, children?: any, normalizationType?: number): VNode &#123; /* å¦‚æœdataæœªå®šä¹‰ï¼ˆundefinedæˆ–è€…nullï¼‰æˆ–è€…æ˜¯dataçš„__ob__å·²ç»å®šä¹‰ï¼ˆä»£è¡¨å·²ç»è¢«observedï¼Œä¸Šé¢ç»‘å®šäº†Oberverå¯¹è±¡ï¼‰ï¼Œ https://cn.vuejs.org/v2/guide/render-function.html#çº¦æŸ é‚£ä¹ˆåˆ›å»ºä¸€ä¸ªç©ºèŠ‚ç‚¹ */ if (isDef(data) &amp;&amp; isDef((data: any).__ob__)) &#123; process.env.NODE_ENV !== \"production\" &amp;&amp; warn( `Avoid using observed data object as vnode data: $&#123;JSON.stringify( data )&#125;\\n` + \"Always create fresh vnode data objects in each render!\", context ); return createEmptyVNode(); &#125; /*å¦‚æœtagä¸å­˜åœ¨ä¹Ÿæ˜¯åˆ›å»ºä¸€ä¸ªç©ºèŠ‚ç‚¹*/ if (!tag) &#123; // in case of component :is set to falsy value return createEmptyVNode(); &#125; // support single function children as default scoped slot /*é»˜è®¤é»˜è®¤ä½œç”¨åŸŸæ’æ§½*/ if (Array.isArray(children) &amp;&amp; typeof children[0] === \"function\") &#123; data = data || &#123;&#125;; data.scopedSlots = &#123; default: children[0] &#125;; children.length = 0; &#125; if (normalizationType === ALWAYS_NORMALIZE) &#123; children = normalizeChildren(children); &#125; else if (normalizationType === SIMPLE_NORMALIZE) &#123; children = simpleNormalizeChildren(children); &#125; let vnode, ns; if (typeof tag === \"string\") &#123; let Ctor; /*è·å–tagçš„åå­—ç©ºé—´*/ ns = config.getTagNamespace(tag); /*åˆ¤æ–­æ˜¯å¦æ˜¯ä¿ç•™çš„æ ‡ç­¾*/ if (config.isReservedTag(tag)) &#123; // platform built-in elements /*å¦‚æœæ˜¯ä¿ç•™çš„æ ‡ç­¾åˆ™åˆ›å»ºä¸€ä¸ªç›¸åº”èŠ‚ç‚¹*/ vnode = new VNode( config.parsePlatformTagName(tag), data, children, undefined, undefined, context ); &#125; else if ( isDef((Ctor = resolveAsset(context.$options, \"components\", tag))) ) &#123; // component /*ä»vmå®ä¾‹çš„optionçš„componentsä¸­å¯»æ‰¾è¯¥tagï¼Œå­˜åœ¨åˆ™å°±æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œåˆ›å»ºç›¸åº”èŠ‚ç‚¹ï¼ŒCtorä¸ºç»„ä»¶çš„æ„é€ ç±»*/ vnode = createComponent(Ctor, data, context, children, tag); &#125; else &#123; // unknown or unlisted namespaced elements // check at runtime because it may get assigned a namespace when its // parent normalizes children /*æœªçŸ¥çš„å…ƒç´ ï¼Œåœ¨è¿è¡Œæ—¶æ£€æŸ¥ï¼Œå› ä¸ºçˆ¶ç»„ä»¶å¯èƒ½åœ¨åºåˆ—åŒ–å­ç»„ä»¶çš„æ—¶å€™åˆ†é…ä¸€ä¸ªåå­—ç©ºé—´*/ vnode = new VNode(tag, data, children, undefined, undefined, context); &#125; &#125; else &#123; // direct component options / constructor /*tagä¸æ˜¯å­—ç¬¦ä¸²çš„æ—¶å€™åˆ™æ˜¯ç»„ä»¶çš„æ„é€ ç±»*/ vnode = createComponent(tag, data, context, children); &#125; if (isDef(vnode)) &#123; /*å¦‚æœæœ‰åå­—ç©ºé—´ï¼Œåˆ™é€’å½’æ‰€æœ‰å­èŠ‚ç‚¹åº”ç”¨è¯¥åå­—ç©ºé—´*/ if (ns) applyNS(vnode, ns); return vnode; &#125; else &#123; /*å¦‚æœvnodeæ²¡æœ‰æˆåŠŸåˆ›å»ºåˆ™åˆ›å»ºç©ºèŠ‚ç‚¹*/ return createEmptyVNode(); &#125;&#125; diff æ¦‚è§£1.å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œvue æ˜¯æ€ä¹ˆæ›´æ–°èŠ‚ç‚¹çš„ï¼Ÿå‘¨æ‰€å‘¨çŸ¥ï¼ŒVue é€šè¿‡æ•°æ®ç»‘å®šæ¥ä¿®æ”¹è§†å›¾ï¼Œå½“æŸä¸ªæ•°æ®è¢«ä¿®æ”¹çš„æ—¶å€™ï¼Œset æ–¹æ³•ä¼šè®©é—­åŒ…ä¸­çš„ Dep è°ƒç”¨ notify é€šçŸ¥æ‰€æœ‰è®¢é˜…è€… Watcherï¼ŒWatcher é€šè¿‡ get æ–¹æ³•æ‰§è¡Œ vm._update(vm._render(), hydrating)ã€‚ è¿™é‡Œçœ‹ä¸€ä¸‹_update æ–¹æ³• 1234567891011121314151617181920212223242526272829303132333435363738394041Vue.prototype._update = function (vnode: VNode, hydrating?: boolean) &#123; const vm: Component = this /*å¦‚æœå·²ç»è¯¥ç»„ä»¶å·²ç»æŒ‚è½½è¿‡äº†åˆ™ä»£è¡¨è¿›å…¥è¿™ä¸ªæ­¥éª¤æ˜¯ä¸ªæ›´æ–°çš„è¿‡ç¨‹ï¼Œè§¦å‘beforeUpdateé’©å­*/ if (vm._isMounted) &#123; callHook(vm, 'beforeUpdate') &#125; const prevEl = vm.$el const prevVnode = vm._vnode const prevActiveInstance = activeInstance activeInstance = vm vm._vnode = vnode // Vue.prototype.__patch__ is injected in entry points // based on the rendering backend used. /*åŸºäºåç«¯æ¸²æŸ“Vue.prototype.__patch__è¢«ç”¨æ¥ä½œä¸ºä¸€ä¸ªå…¥å£*/ if (!prevVnode) &#123; // initial render vm.$el = vm.__patch__( vm.$el, vnode, hydrating, false /* removeOnly */, vm.$options._parentElm, vm.$options._refElm ) &#125; else &#123; // updates vm.$el = vm.__patch__(prevVnode, vnode) &#125; activeInstance = prevActiveInstance // update __vue__ reference /*æ›´æ–°æ–°çš„å®ä¾‹å¯¹è±¡çš„__vue__*/ if (prevEl) &#123; prevEl.__vue__ = null &#125; if (vm.$el) &#123; vm.$el.__vue__ = vm &#125; // if parent is an HOC, update its $el as well if (vm.$vnode &amp;&amp; vm.$parent &amp;&amp; vm.$vnode === vm.$parent._vnode) &#123; vm.$parent.$el = vm.$el &#125; // updated hook is called by the scheduler to ensure that children are // updated in a parent's updated hook. &#125;å¤åˆ¶ä»£ç  _update æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª VNode å¯¹è±¡ï¼Œåœ¨å†…éƒ¨ä¼šå°†è¯¥ VNode å¯¹è±¡ä¸ä¹‹å‰æ—§çš„ VNode å¯¹è±¡è¿›è¡Œpatchã€‚ è¦çŸ¥é“æ¸²æŸ“çœŸå® DOM çš„å¼€é”€æ˜¯å¾ˆå¤§çš„ï¼Œæ¯”å¦‚æœ‰æ—¶å€™æˆ‘ä»¬ä¿®æ”¹äº†æŸä¸ªæ•°æ®ï¼Œå¦‚æœç›´æ¥æ¸²æŸ“åˆ°çœŸå® dom ä¸Šä¼šå¼•èµ·æ•´ä¸ª dom æ ‘çš„é‡ç»˜å’Œé‡æ’ï¼Œæœ‰æ²¡æœ‰å¯èƒ½æˆ‘ä»¬åªæ›´æ–°æˆ‘ä»¬ä¿®æ”¹çš„é‚£ä¸€å°å— dom è€Œä¸è¦æ›´æ–°æ•´ä¸ª dom å‘¢ï¼Ÿdiff ç®—æ³•èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ã€‚ æˆ‘ä»¬å…ˆæ ¹æ®çœŸå® DOM ç”Ÿæˆä¸€é¢—virtual DOMï¼Œå½“virtual DOMæŸä¸ªèŠ‚ç‚¹çš„æ•°æ®æ”¹å˜åä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„Vnodeï¼Œç„¶åVnodeå’ŒoldVnodeä½œå¯¹æ¯”ï¼Œå‘ç°æœ‰ä¸ä¸€æ ·çš„åœ°æ–¹å°±ç›´æ¥ä¿®æ”¹åœ¨çœŸå®çš„ DOM ä¸Šï¼Œç„¶åä½¿oldVnodeçš„å€¼ä¸ºVnodeã€‚ diff çš„è¿‡ç¨‹å°±æ˜¯è°ƒç”¨åä¸ºpatchçš„å‡½æ•°ï¼Œæ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹ï¼Œä¸€è¾¹æ¯”è¾ƒä¸€è¾¹ç»™çœŸå®çš„ DOMæ‰“è¡¥ä¸ã€‚ 2. virtual DOM å’ŒçœŸå® DOM çš„åŒºåˆ«ï¼Ÿè™šæ‹Ÿ dom å¯¹åº”çš„æ˜¯çœŸå® domï¼Œ ä½¿ç”¨document.CreateElement å’Œ document.CreateTextNodeåˆ›å»ºçš„å°±æ˜¯çœŸå®èŠ‚ç‚¹ã€‚ virtual DOM æ˜¯å°†çœŸå®çš„ DOM çš„æ•°æ®æŠ½å–å‡ºæ¥ï¼Œä»¥å¯¹è±¡çš„å½¢å¼æ¨¡æ‹Ÿæ ‘å½¢ç»“æ„ã€‚æ¯”å¦‚ dom æ˜¯è¿™æ ·çš„ï¼š 123&lt;div&gt; &lt;p&gt;123&lt;/p&gt;&lt;/div&gt; å¯¹åº”çš„ virtual DOMï¼ˆä¼ªä»£ç ï¼‰ï¼š 1234var Vnode = &#123; tag: \"div\", children: [&#123; tag: \"p\", text: \"123\" &#125;]&#125;; ï¼ˆæ¸©é¦¨æç¤ºï¼šVNodeå’ŒoldVNodeéƒ½æ˜¯å¯¹è±¡ï¼Œä¸€å®šè¦è®°ä½ï¼‰ virtual dom å¾ˆå¤šæ—¶å€™éƒ½ä¸æ˜¯æœ€ä¼˜çš„æ“ä½œï¼Œä½†å®ƒå…·æœ‰æ™®é€‚æ€§ï¼Œåœ¨æ•ˆç‡ã€å¯ç»´æŠ¤æ€§ä¹‹é—´è¾¾å¹³è¡¡ã€‚ 3. diff çš„æ¯”è¾ƒæ–¹å¼ï¼Ÿåœ¨é‡‡å– diff ç®—æ³•æ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ¯”è¾ƒåªä¼šåœ¨åŒå±‚çº§è¿›è¡Œ, ä¸ä¼šè·¨å±‚çº§æ¯”è¾ƒã€‚ 1234567&lt;div&gt; &lt;p&gt;123&lt;/p&gt;&lt;/div&gt;&lt;div&gt; &lt;span&gt;456&lt;/span&gt;&lt;/div&gt; ä¸Šé¢çš„ä»£ç ä¼šåˆ†åˆ«æ¯”è¾ƒåŒä¸€å±‚çš„ä¸¤ä¸ª div ä»¥åŠç¬¬äºŒå±‚çš„ p å’Œ spanï¼Œä½†æ˜¯ä¸ä¼šæ‹¿ div å’Œ span ä½œæ¯”è¾ƒã€‚åœ¨åˆ«å¤„çœ‹åˆ°çš„ä¸€å¼ å¾ˆå½¢è±¡çš„å›¾ï¼š diff æµç¨‹å›¾å½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œset æ–¹æ³•ä¼šè®©è°ƒç”¨Dep.notifyé€šçŸ¥æ‰€æœ‰è®¢é˜…è€… Watcherï¼Œè®¢é˜…è€…å°±ä¼šè°ƒç”¨patchç»™çœŸå®çš„ DOM æ‰“è¡¥ä¸ï¼Œæ›´æ–°ç›¸åº”çš„è§†å›¾ã€‚ diff ç®—æ³•åŒ…æ‹¬å‡ ä¸ªæ­¥éª¤ï¼š ç”¨ JavaScript å¯¹è±¡ç»“æ„è¡¨ç¤º DOM æ ‘çš„ç»“æ„ï¼›ç„¶åç”¨è¿™ä¸ªæ ‘æ„å»ºä¸€ä¸ªçœŸæ­£çš„ DOM æ ‘ï¼Œæ’åˆ°æ–‡æ¡£å½“ä¸­ å½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ„é€ ä¸€æ£µæ–°çš„å¯¹è±¡æ ‘ã€‚ç„¶åç”¨æ–°çš„æ ‘å’Œæ—§çš„æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œè®°å½•ä¸¤æ£µæ ‘å·®å¼‚ æŠŠæ‰€è®°å½•çš„å·®å¼‚åº”ç”¨åˆ°æ‰€æ„å»ºçš„çœŸæ­£çš„ DOM æ ‘ä¸Šï¼Œè§†å›¾å°±æ›´æ–°äº† diff ç®—æ³•å…·ä½“åˆ†æ1. patchæ¥çœ‹çœ‹patchæ˜¯æ€ä¹ˆæ‰“è¡¥ä¸çš„ï¼ˆä»£ç åªä¿ç•™æ ¸å¿ƒéƒ¨åˆ†ï¼‰ 123456789101112131415161718function patch(oldVnode, vnode) &#123; // some code if (sameVnode(oldVnode, vnode)) &#123; patchVnode(oldVnode, vnode); &#125; else &#123; const oEl = oldVnode.el; // å½“å‰oldVnodeå¯¹åº”çš„çœŸå®å…ƒç´ èŠ‚ç‚¹ let parentEle = api.parentNode(oEl); // çˆ¶å…ƒç´  createEle(vnode); // æ ¹æ®Vnodeç”Ÿæˆæ–°å…ƒç´  if (parentEle !== null) &#123; api.insertBefore(parentEle, vnode.el, api.nextSibling(oEl)); // å°†æ–°å…ƒç´ æ·»åŠ è¿›çˆ¶å…ƒç´  api.removeChild(parentEle, oldVnode.el); // ç§»é™¤ä»¥å‰çš„æ—§å…ƒç´ èŠ‚ç‚¹ oldVnode = null; &#125; &#125; // some code return vnode;&#125;å¤åˆ¶ä»£ç ; patch å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°oldVnodeå’ŒVnodeåˆ†åˆ«ä»£è¡¨æ–°çš„èŠ‚ç‚¹å’Œä¹‹å‰çš„æ—§èŠ‚ç‚¹ åˆ¤æ–­ä¸¤èŠ‚ç‚¹æ˜¯å¦å€¼å¾—æ¯”è¾ƒï¼Œå€¼å¾—æ¯”è¾ƒåˆ™æ‰§è¡ŒpatchVnode 1234567891011function sameVnode(a, b) &#123; return ( a.key === b.key &amp;&amp; // keyå€¼ a.tag === b.tag &amp;&amp; // æ ‡ç­¾å a.isComment === b.isComment &amp;&amp; // æ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹ // æ˜¯å¦éƒ½å®šä¹‰äº†dataï¼ŒdataåŒ…å«ä¸€äº›å…·ä½“ä¿¡æ¯ï¼Œä¾‹å¦‚onclick , style isDef(a.data) === isDef(b.data) &amp;&amp; sameInputType(a, b) // å½“æ ‡ç­¾æ˜¯&lt;input&gt;çš„æ—¶å€™ï¼Œtypeå¿…é¡»ç›¸åŒ );&#125;å¤åˆ¶ä»£ç ; ä¸å€¼å¾—æ¯”è¾ƒåˆ™ç”¨Vnodeæ›¿æ¢oldVnode å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±æ·±å…¥æ£€æŸ¥ä»–ä»¬çš„å­èŠ‚ç‚¹ã€‚å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ä¸ä¸€æ ·é‚£å°±è¯´æ˜Vnodeå®Œå…¨è¢«æ”¹å˜äº†ï¼Œå°±å¯ä»¥ç›´æ¥æ›¿æ¢oldVnodeã€‚ è™½ç„¶è¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¸ä¸€æ ·ä½†æ˜¯ä»–ä»¬çš„å­èŠ‚ç‚¹ä¸€æ ·æ€ä¹ˆåŠï¼Ÿåˆ«å¿˜äº†ï¼Œdiff å¯æ˜¯é€å±‚æ¯”è¾ƒçš„ï¼Œå¦‚æœç¬¬ä¸€å±‚ä¸ä¸€æ ·é‚£ä¹ˆå°±ä¸ä¼šç»§ç»­æ·±å…¥æ¯”è¾ƒç¬¬äºŒå±‚äº†ã€‚ï¼ˆæˆ‘åœ¨æƒ³è¿™ç®—æ˜¯ä¸€ä¸ªç¼ºç‚¹å—ï¼Ÿç›¸åŒå­èŠ‚ç‚¹ä¸èƒ½é‡å¤åˆ©ç”¨äº†â€¦ï¼‰ 2. patchVnodeå½“æˆ‘ä»¬ç¡®å®šä¸¤ä¸ªèŠ‚ç‚¹å€¼å¾—æ¯”è¾ƒä¹‹åæˆ‘ä»¬ä¼šå¯¹ä¸¤ä¸ªèŠ‚ç‚¹æŒ‡å®špatchVnodeæ–¹æ³•ã€‚é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•åšäº†ä»€ä¹ˆå‘¢ï¼Ÿ 123456789101112131415161718patchVnode (oldVnode, vnode) &#123; const el = vnode.el = oldVnode.el let i, oldCh = oldVnode.children, ch = vnode.children if (oldVnode === vnode) return if (oldVnode.text !== null &amp;&amp; vnode.text !== null &amp;&amp; oldVnode.text !== vnode.text) &#123; api.setTextContent(el, vnode.text) &#125;else &#123; updateEle(el, vnode, oldVnode) if (oldCh &amp;&amp; ch &amp;&amp; oldCh !== ch) &#123; updateChildren(el, oldCh, ch) &#125;else if (ch)&#123; createEle(vnode) //create el's children dom &#125;else if (oldCh)&#123; api.removeChildren(el) &#125; &#125;&#125;å¤åˆ¶ä»£ç  è¿™ä¸ªå‡½æ•°åšäº†ä»¥ä¸‹äº‹æƒ…ï¼š æ‰¾åˆ°å¯¹åº”çš„çœŸå® domï¼Œç§°ä¸ºel åˆ¤æ–­Vnodeå’ŒoldVnodeæ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆç›´æ¥return å¦‚æœä»–ä»¬éƒ½æœ‰æ–‡æœ¬èŠ‚ç‚¹å¹¶ä¸”ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆå°†elçš„æ–‡æœ¬èŠ‚ç‚¹è®¾ç½®ä¸ºVnodeçš„æ–‡æœ¬èŠ‚ç‚¹ã€‚ å¦‚æœoldVnodeæœ‰å­èŠ‚ç‚¹è€ŒVnodeæ²¡æœ‰ï¼Œåˆ™åˆ é™¤elçš„å­èŠ‚ç‚¹ å¦‚æœoldVnodeæ²¡æœ‰å­èŠ‚ç‚¹è€ŒVnodeæœ‰ï¼Œåˆ™å°†Vnodeçš„å­èŠ‚ç‚¹çœŸå®åŒ–ä¹‹åæ·»åŠ åˆ°el å¦‚æœä¸¤è€…éƒ½æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™æ‰§è¡ŒupdateChildrenå‡½æ•°æ¯”è¾ƒå­èŠ‚ç‚¹ï¼Œè¿™ä¸€æ­¥å¾ˆé‡è¦ å…¶ä»–å‡ ä¸ªç‚¹éƒ½å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬è¯¦ç»†æ¥è®²ä¸€ä¸‹ updateChildren 3. updateChildrenä»£ç é‡å¾ˆå¤§ï¼Œä¸æ–¹ä¾¿ä¸€è¡Œä¸€è¡Œçš„è®²è§£ï¼Œæ‰€ä»¥ä¸‹é¢ç»“åˆä¸€äº›ç¤ºä¾‹å›¾æ¥æè¿°ä¸€ä¸‹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970updateChildren (parentElm, oldCh, newCh) &#123; let oldStartIdx = 0, newStartIdx = 0 let oldEndIdx = oldCh.length - 1 let oldStartVnode = oldCh[0] let oldEndVnode = oldCh[oldEndIdx] let newEndIdx = newCh.length - 1 let newStartVnode = newCh[0] let newEndVnode = newCh[newEndIdx] let oldKeyToIdx let idxInOld let elmToMove let before while (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123; if (oldStartVnode == null) &#123; // å¯¹äºvnode.keyçš„æ¯”è¾ƒï¼Œä¼šæŠŠoldVnode = null oldStartVnode = oldCh[++oldStartIdx] &#125;else if (oldEndVnode == null) &#123; oldEndVnode = oldCh[--oldEndIdx] &#125;else if (newStartVnode == null) &#123; newStartVnode = newCh[++newStartIdx] &#125;else if (newEndVnode == null) &#123; newEndVnode = newCh[--newEndIdx] &#125;else if (sameVnode(oldStartVnode, newStartVnode)) &#123; patchVnode(oldStartVnode, newStartVnode) oldStartVnode = oldCh[++oldStartIdx] newStartVnode = newCh[++newStartIdx] &#125;else if (sameVnode(oldEndVnode, newEndVnode)) &#123; patchVnode(oldEndVnode, newEndVnode) oldEndVnode = oldCh[--oldEndIdx] newEndVnode = newCh[--newEndIdx] &#125;else if (sameVnode(oldStartVnode, newEndVnode)) &#123; patchVnode(oldStartVnode, newEndVnode) api.insertBefore(parentElm, oldStartVnode.el, api.nextSibling(oldEndVnode.el)) oldStartVnode = oldCh[++oldStartIdx] newEndVnode = newCh[--newEndIdx] &#125;else if (sameVnode(oldEndVnode, newStartVnode)) &#123; patchVnode(oldEndVnode, newStartVnode) api.insertBefore(parentElm, oldEndVnode.el, oldStartVnode.el) oldEndVnode = oldCh[--oldEndIdx] newStartVnode = newCh[++newStartIdx] &#125;else &#123; // ä½¿ç”¨keyæ—¶çš„æ¯”è¾ƒ if (oldKeyToIdx === undefined) &#123; oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx) // æœ‰keyç”Ÿæˆindexè¡¨ &#125; idxInOld = oldKeyToIdx[newStartVnode.key] if (!idxInOld) &#123; api.insertBefore(parentElm, createEle(newStartVnode).el, oldStartVnode.el) newStartVnode = newCh[++newStartIdx] &#125; else &#123; elmToMove = oldCh[idxInOld] if (elmToMove.sel !== newStartVnode.sel) &#123; api.insertBefore(parentElm, createEle(newStartVnode).el, oldStartVnode.el) &#125;else &#123; patchVnode(elmToMove, newStartVnode) oldCh[idxInOld] = null api.insertBefore(parentElm, elmToMove.el, oldStartVnode.el) &#125; newStartVnode = newCh[++newStartIdx] &#125; &#125; &#125; if (oldStartIdx &gt; oldEndIdx) &#123; before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].el addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx) &#125;else if (newStartIdx &gt; newEndIdx) &#123; removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx) &#125;&#125;å¤åˆ¶ä»£ç  å…ˆè¯´ä¸€ä¸‹è¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆ å°†Vnodeçš„å­èŠ‚ç‚¹Vchå’ŒoldVnodeçš„å­èŠ‚ç‚¹oldChæå–å‡ºæ¥ oldChå’ŒvChå„æœ‰ä¸¤ä¸ªå¤´å°¾çš„å˜é‡StartIdxå’ŒEndIdxï¼Œå®ƒä»¬çš„ 2 ä¸ªå˜é‡ç›¸äº’æ¯”è¾ƒï¼Œä¸€å…±æœ‰ 4 ç§æ¯”è¾ƒæ–¹å¼ã€‚å¦‚æœ 4 ç§æ¯”è¾ƒéƒ½æ²¡åŒ¹é…ï¼Œå¦‚æœè®¾ç½®äº†keyï¼Œå°±ä¼šç”¨keyè¿›è¡Œæ¯”è¾ƒï¼Œåœ¨æ¯”è¾ƒçš„è¿‡ç¨‹ä¸­ï¼Œå˜é‡ä¼šå¾€ä¸­é—´é ï¼Œä¸€æ—¦StartIdx&gt;EndIdxè¡¨æ˜oldChå’ŒvChè‡³å°‘æœ‰ä¸€ä¸ªå·²ç»éå†å®Œäº†ï¼Œå°±ä¼šç»“æŸæ¯”è¾ƒã€‚ å›¾è§£ updateChildrenç»ˆäºæ¥åˆ°äº†è¿™ä¸€éƒ¨åˆ†ï¼Œä¸Šé¢çš„æ€»ç»“ç›¸ä¿¡å¾ˆå¤šäººä¹Ÿçœ‹å¾—ä¸€è„¸æ‡µé€¼ï¼Œä¸‹é¢æˆ‘ä»¬å¥½å¥½è¯´é“è¯´é“ã€‚ ç²‰çº¢è‰²çš„éƒ¨åˆ†ä¸º oldChã€é»„è‰²çš„éƒ¨åˆ†ä¸º vCh æˆ‘ä»¬å°†å®ƒä»¬å–å‡ºæ¥å¹¶åˆ†åˆ«ç”¨ s å’Œ e æŒ‡é’ˆæŒ‡å‘å®ƒä»¬çš„å¤´ child å’Œå°¾ child ç°åœ¨åˆ†åˆ«å¯¹oldSã€oldEã€Sã€Eä¸¤ä¸¤åšsameVnodeæ¯”è¾ƒï¼Œæœ‰å››ç§æ¯”è¾ƒæ–¹å¼ï¼Œå½“å…¶ä¸­ä¸¤ä¸ªèƒ½åŒ¹é…ä¸Šé‚£ä¹ˆçœŸå® dom ä¸­çš„ç›¸åº”èŠ‚ç‚¹ä¼šç§»åˆ° Vnode ç›¸åº”çš„ä½ç½®ï¼Œè¿™å¥è¯æœ‰ç‚¹ç»•ï¼Œæ‰“ä¸ªæ¯”æ–¹ å¦‚æœæ˜¯ oldS å’Œ E åŒ¹é…ä¸Šäº†ï¼Œé‚£ä¹ˆçœŸå® dom ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¼šç§»åˆ°æœ€å å¦‚æœæ˜¯ oldE å’Œ S åŒ¹é…ä¸Šäº†ï¼Œé‚£ä¹ˆçœŸå® dom ä¸­çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ä¼šç§»åˆ°æœ€å‰ï¼ŒåŒ¹é…ä¸Šçš„ä¸¤ä¸ªæŒ‡é’ˆå‘ä¸­é—´ç§»åŠ¨ å¦‚æœå››ç§åŒ¹é…æ²¡æœ‰ä¸€å¯¹æ˜¯æˆåŠŸçš„ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µ å¦‚æœæ–°æ—§å­èŠ‚ç‚¹éƒ½å­˜åœ¨ keyï¼Œé‚£ä¹ˆä¼šæ ¹æ®oldChildçš„ key ç”Ÿæˆä¸€å¼  hash è¡¨ï¼Œç”¨Sçš„ key ä¸ hash è¡¨åšåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸå°±åˆ¤æ–­Så’ŒåŒ¹é…èŠ‚ç‚¹æ˜¯å¦ä¸ºsameNodeï¼Œå¦‚æœæ˜¯ï¼Œå°±åœ¨çœŸå® dom ä¸­å°†æˆåŠŸçš„èŠ‚ç‚¹ç§»åˆ°æœ€å‰é¢ï¼Œå¦åˆ™ï¼Œå°†Sç”Ÿæˆå¯¹åº”çš„èŠ‚ç‚¹æ’å…¥åˆ° dom ä¸­å¯¹åº”çš„oldSä½ç½®ï¼ŒoldSå’ŒSæŒ‡é’ˆå‘ä¸­é—´ç§»åŠ¨ã€‚ å¦‚æœæ²¡æœ‰ key,åˆ™ç›´æ¥å°†Sç”Ÿæˆæ–°çš„èŠ‚ç‚¹æ’å…¥çœŸå®DOMï¼ˆpsï¼šè¿™ä¸‹å¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆ v-for çš„æ—¶å€™éœ€è¦è®¾ç½® key äº†ï¼Œå¦‚æœæ²¡æœ‰ key é‚£ä¹ˆå°±åªä¼šåšå››ç§åŒ¹é…ï¼Œå°±ç®—æŒ‡é’ˆä¸­é—´æœ‰å¯å¤ç”¨çš„èŠ‚ç‚¹éƒ½ä¸èƒ½è¢«å¤ç”¨äº†ï¼‰ å†é…ä¸ªå›¾ï¼ˆå‡è®¾ä¸‹å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯æœ‰ key çš„ï¼Œä¸” key ä¸ºè‡ªèº«çš„å€¼ï¼‰ ç¬¬ä¸€æ­¥ 12oldS = a, oldE = dï¼›S = a, E = b; oldSå’ŒSåŒ¹é…ï¼Œåˆ™å°† dom ä¸­çš„ a èŠ‚ç‚¹æ”¾åˆ°ç¬¬ä¸€ä¸ªï¼Œå·²ç»æ˜¯ç¬¬ä¸€ä¸ªäº†å°±ä¸ç®¡äº†ï¼Œæ­¤æ—¶ dom çš„ä½ç½®ä¸ºï¼ša b d ç¬¬äºŒæ­¥ 12oldS = b, oldE = dï¼›S = c, E = b; oldSå’ŒEåŒ¹é…ï¼Œå°±å°†åŸæœ¬çš„ b èŠ‚ç‚¹ç§»åŠ¨åˆ°æœ€åï¼Œå› ä¸ºEæ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»–ä»¬ä½ç½®è¦ä¸€è‡´ï¼Œè¿™å°±æ˜¯ä¸Šé¢è¯´çš„ï¼šå½“å…¶ä¸­ä¸¤ä¸ªèƒ½åŒ¹é…ä¸Šé‚£ä¹ˆçœŸå® dom ä¸­çš„ç›¸åº”èŠ‚ç‚¹ä¼šç§»åˆ° Vnode ç›¸åº”çš„ä½ç½®ï¼Œæ­¤æ—¶ dom çš„ä½ç½®ä¸ºï¼ša d b ç¬¬ä¸‰æ­¥ 12oldS = d, oldE = dï¼›S = c, E = d; oldEå’ŒEåŒ¹é…ï¼Œä½ç½®ä¸å˜æ­¤æ—¶ dom çš„ä½ç½®ä¸ºï¼ša d b ç¬¬å››æ­¥ 123oldS++;oldE--;oldS &gt; oldE; éå†ç»“æŸï¼Œè¯´æ˜oldChå…ˆéå†å®Œã€‚å°±å°†å‰©ä½™çš„vChèŠ‚ç‚¹æ ¹æ®è‡ªå·±çš„çš„ index æ’å…¥åˆ°çœŸå® dom ä¸­å»ï¼Œæ­¤æ—¶ dom ä½ç½®ä¸ºï¼ša c d b ä¸€æ¬¡æ¨¡æ‹Ÿå®Œæˆã€‚ è¿™ä¸ªåŒ¹é…è¿‡ç¨‹çš„ç»“æŸæœ‰ä¸¤ä¸ªæ¡ä»¶ï¼š oldS &gt; oldEè¡¨ç¤ºoldChå…ˆéå†å®Œï¼Œé‚£ä¹ˆå°±å°†å¤šä½™çš„vChæ ¹æ® index æ·»åŠ åˆ° dom ä¸­å»ï¼ˆå¦‚ä¸Šå›¾ï¼‰ S &gt; Eè¡¨ç¤º vCh å…ˆéå†å®Œï¼Œé‚£ä¹ˆå°±åœ¨çœŸå® dom ä¸­å°†åŒºé—´ä¸º[oldS, oldE]çš„å¤šä½™èŠ‚ç‚¹åˆ æ‰ ä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥åƒä¸Šé¢é‚£æ ·è‡ªå·±è¯•ç€æ¨¡æ‹Ÿä¸€ä¸‹ å½“è¿™äº›èŠ‚ç‚¹sameVnodeæˆåŠŸåå°±ä¼šç´§æ¥ç€æ‰§è¡ŒpatchVnodeäº†ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸Šé¢çš„ä»£ç  123if (sameVnode(oldStartVnode, newStartVnode)) &#123; patchVnode(oldStartVnode, newStartVnode);&#125; å°±è¿™æ ·å±‚å±‚é€’å½’ä¸‹å»ï¼Œç›´åˆ°å°† oldVnode å’Œ Vnode ä¸­çš„æ‰€æœ‰å­èŠ‚ç‚¹æ¯”å¯¹å®Œã€‚ä¹Ÿå°† dom çš„æ‰€æœ‰è¡¥ä¸éƒ½æ‰“å¥½å•¦ã€‚é‚£ä¹ˆç°åœ¨å†å›è¿‡å»çœ‹ updateChildren çš„ä»£ç ä¼šä¸ä¼šå®¹æ˜“å¾ˆå¤šå‘¢ï¼Ÿ 4. æ“ä½œ domè¿™é‡Œæˆ‘ä»¬åªæ˜¯å°†è™šæ‹Ÿ DOM æ˜ å°„æˆäº†çœŸå®çš„ DOMã€‚é‚£å¦‚ä½•ç»™è¿™äº› DOM åŠ å…¥ attrã€classã€style ç­‰ DOM å±æ€§å‘¢ï¼Ÿ è¿™è¦ä¾èµ–äºè™šæ‹Ÿ DOM çš„ç”Ÿå‘½é’©å­ã€‚è™šæ‹Ÿ DOM æä¾›äº†å¦‚ä¸‹çš„é’©å­å‡½æ•°ï¼Œåˆ†åˆ«åœ¨ä¸åŒçš„æ—¶æœŸä¼šè¿›è¡Œè°ƒç”¨ã€‚ 1234567891011const hooks = [\"create\", \"activate\", \"update\", \"remove\", \"destroy\"];/*æ„å»ºcbså›è°ƒå‡½æ•°ï¼Œwebå¹³å°ä¸Šè§/platforms/web/runtime/modules*/for (i = 0; i &lt; hooks.length; ++i) &#123; cbs[hooks[i]] = []; for (j = 0; j &lt; modules.length; ++j) &#123; if (isDef(modules[j][hooks[i]])) &#123; cbs[hooks[i]].push(modules[j][hooks[i]]); &#125; &#125;&#125; åŒç†ï¼Œä¹Ÿä¼šæ ¹æ®ä¸åŒå¹³å°æœ‰è‡ªå·±ä¸åŒçš„å®ç°ï¼Œæˆ‘ä»¬è¿™é‡Œä»¥ Web å¹³å°ä¸ºä¾‹ã€‚Web å¹³å°çš„é’©å­å‡½æ•°è§/platforms/web/runtime/modulesã€‚é‡Œé¢æœ‰å¯¹ attrã€classã€propsã€eventsã€style ä»¥åŠ transitionï¼ˆè¿‡æ¸¡çŠ¶æ€ï¼‰çš„ DOM å±æ€§è¿›è¡Œæ“ä½œã€‚ ä»¥ attr ä¸ºä¾‹ï¼Œä»£ç å¾ˆç®€å•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192/* @flow */import &#123; isIE9 &#125; from \"core/util/env\";import &#123; extend, isDef, isUndef &#125; from \"shared/util\";import &#123; isXlink, xlinkNS, getXlinkProp, isBooleanAttr, isEnumeratedAttr, isFalsyAttrValue&#125; from \"web/util/index\";/*æ›´æ–°attr*/function updateAttrs(oldVnode: VNodeWithData, vnode: VNodeWithData) &#123; /*å¦‚æœæ—§çš„ä»¥åŠæ–°çš„VNodeèŠ‚ç‚¹å‡æ²¡æœ‰attrå±æ€§ï¼Œåˆ™ç›´æ¥è¿”å›*/ if (isUndef(oldVnode.data.attrs) &amp;&amp; isUndef(vnode.data.attrs)) &#123; return; &#125; let key, cur, old; /*VNodeèŠ‚ç‚¹å¯¹åº”çš„Domå®ä¾‹*/ const elm = vnode.elm; /*æ—§VNodeèŠ‚ç‚¹çš„attr*/ const oldAttrs = oldVnode.data.attrs || &#123;&#125;; /*æ–°VNodeèŠ‚ç‚¹çš„attr*/ let attrs: any = vnode.data.attrs || &#123;&#125;; // clone observed objects, as the user probably wants to mutate it /*å¦‚æœæ–°çš„VNodeçš„attrå·²ç»æœ‰__ob__ï¼ˆä»£è¡¨å·²ç»è¢«Observeå¤„ç†è¿‡äº†ï¼‰ï¼Œ è¿›è¡Œæ·±æ‹·è´*/ if (isDef(attrs.__ob__)) &#123; attrs = vnode.data.attrs = extend(&#123;&#125;, attrs); &#125; /*éå†attrï¼Œä¸ä¸€è‡´åˆ™æ›¿æ¢*/ for (key in attrs) &#123; cur = attrs[key]; old = oldAttrs[key]; if (old !== cur) &#123; setAttr(elm, key, cur); &#125; &#125; // #4391: in IE9, setting type can reset value for input[type=radio] /* istanbul ignore if */ if (isIE9 &amp;&amp; attrs.value !== oldAttrs.value) &#123; setAttr(elm, \"value\", attrs.value); &#125; for (key in oldAttrs) &#123; if (isUndef(attrs[key])) &#123; if (isXlink(key)) &#123; elm.removeAttributeNS(xlinkNS, getXlinkProp(key)); &#125; else if (!isEnumeratedAttr(key)) &#123; elm.removeAttribute(key); &#125; &#125; &#125;&#125;/*è®¾ç½®attr*/function setAttr(el: Element, key: string, value: any) &#123; if (isBooleanAttr(key)) &#123; // set attribute for blank value // e.g. &lt;option disabled&gt;Select one&lt;/option&gt; if (isFalsyAttrValue(value)) &#123; el.removeAttribute(key); &#125; else &#123; el.setAttribute(key, key); &#125; &#125; else if (isEnumeratedAttr(key)) &#123; el.setAttribute( key, isFalsyAttrValue(value) || value === \"false\" ? \"false\" : \"true\" ); &#125; else if (isXlink(key)) &#123; if (isFalsyAttrValue(value)) &#123; el.removeAttributeNS(xlinkNS, getXlinkProp(key)); &#125; else &#123; el.setAttributeNS(xlinkNS, key, value); &#125; &#125; else &#123; if (isFalsyAttrValue(value)) &#123; el.removeAttribute(key); &#125; else &#123; el.setAttribute(key, value); &#125; &#125;&#125;export default &#123; create: updateAttrs, update: updateAttrs&#125;; attr åªéœ€è¦åœ¨ create ä»¥åŠ update é’©å­è¢«è°ƒç”¨æ—¶æ›´æ–° DOM çš„ attr å±æ€§å³å¯ã€‚","categories":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/categories/VUE/"}],"tags":[{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/tags/VUE/"}]},{"title":"leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”æ’åº","slug":"leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”æ’åº","date":"2019-02-22T06:54:39.000Z","updated":"2019-11-10T14:37:39.026Z","comments":true,"path":"2019/02/22/leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”æ’åº/","link":"","permalink":"http://yoursite.com/2019/02/22/leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”æ’åº/","excerpt":"è¯¥ç¬”è®°åªä¸ºä¸ªäººæ‰€å†™ç®—æ³•ï¼Œä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£æ³•ï¼Œä»…ä¾›å‚è€ƒ [56] Merge IntervalsGiven a collection of intervals, merge all overlapping intervals.éš¾åº¦ï¼šMedium (34.95%)æ€è·¯ï¼š é¦–å…ˆæŒ‰ start å‡åºæˆ–æŒ‰ end å‡åºæ’åˆ— å¦‚æœå‰ä¸€é¡¹çš„ end å¤§äºåä¸€é¡¹çš„ startï¼Œè¯´æ˜è¦ merge å› ä¸ºå·²ç»åšäº†å‡åºæ’åˆ—ï¼Œæ‰€ä»¥è¦ push è¿›ç»“æœçš„é‚£ä¸€é¡¹çš„ start ä¸€å®šä¸ºå‰ä¸€é¡¹çš„ startï¼Œè€Œ end ä¸ºä¸¤é¡¹ä¸­ end è¾ƒå¤§çš„é‚£ä¸ªå€¼ã€‚","text":"è¯¥ç¬”è®°åªä¸ºä¸ªäººæ‰€å†™ç®—æ³•ï¼Œä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£æ³•ï¼Œä»…ä¾›å‚è€ƒ [56] Merge IntervalsGiven a collection of intervals, merge all overlapping intervals.éš¾åº¦ï¼šMedium (34.95%)æ€è·¯ï¼š é¦–å…ˆæŒ‰ start å‡åºæˆ–æŒ‰ end å‡åºæ’åˆ— å¦‚æœå‰ä¸€é¡¹çš„ end å¤§äºåä¸€é¡¹çš„ startï¼Œè¯´æ˜è¦ merge å› ä¸ºå·²ç»åšäº†å‡åºæ’åˆ—ï¼Œæ‰€ä»¥è¦ push è¿›ç»“æœçš„é‚£ä¸€é¡¹çš„ start ä¸€å®šä¸ºå‰ä¸€é¡¹çš„ startï¼Œè€Œ end ä¸ºä¸¤é¡¹ä¸­ end è¾ƒå¤§çš„é‚£ä¸ªå€¼ã€‚ 12345678910111213141516171819202122var merge = function(intervals) &#123; var res = []; if (intervals.length == 0) &#123; return res; &#125; intervals.sort(function(a, b) &#123; return a.start !== b.start ? a.start - b.start : a.end - b.end; &#125;); var pre = intervals[0]; res.push(pre); for (var cur of intervals) &#123; if (pre.end &gt;= cur.start) &#123; if (cur.end &gt; pre.end) &#123; pre.end = cur.end; &#125; &#125; else &#123; res.push(cur); pre = cur; &#125; &#125; return res;&#125;; [75] Sort ColorsGiven an array with n objects colored red, white or blue, sort them in-place so that objects of the same color are adjacent, with the colors in the order red, white and blue.Here, we will use the integers 0, 1, and 2 to represent the color red, white, and blue respectively.Note: You are not suppose to use the libraryâ€™s sort function for this problem.éš¾åº¦ï¼šMedium (41.44%)æ€è·¯ï¼šé‡åˆ° 0 æ”¾åœ¨æœ€å‰é¢ï¼Œé‡åˆ° 2 æ”¾åœ¨æœ€åé¢ï¼Œ1 ä¸åŠ¨ i ä» 0 å¼€å§‹ï¼Œå¦‚æœ nums[i]ç­‰äº 1ï¼Œåˆ™ i++ã€‚ å¦‚æœ nums[i]ç­‰äº 0ï¼Œåˆ™æŠŠ nums[i]æ”¾åˆ°æœ€å‰é¢ å¦‚æœ nums[i]ç­‰äº 2ï¼Œåˆ™æŠŠ nums[i]æ”¾åˆ°æœ€åé¢ 1234567891011121314151617181920212223242526var sortColors = function(nums) &#123; if (nums.length == 0) &#123; return -1; &#125; var i = 0; var m = 0; var n = nums.length - 1; var temp; while (i &lt;= n) &#123; if (nums[i] == 1) &#123; i++; &#125; else if (nums[i] == 0) &#123; temp = nums[m]; nums[m] = nums[i]; nums[i] = temp; m++; i++; &#125; else &#123; temp = nums[n]; nums[n] = nums[i]; nums[i] = temp; n--; &#125; &#125; return nums;&#125;; [147] Insertion Sort ListSort a linked list using insertion sort.A graphical example of insertion sort. The partial sorted list (black) initially contains only the first element in the list.With each iteration one element (red) is removed from the input data and inserted in-place into the sorted list.Algorithm of Insertion Sort:Insertion sort iterates, consuming one input element each repetition, and growing a sorted output list. At each iteration, insertion sort removes one element from the input data, finds the location it belongs within the sorted list, and inserts it there. It repeats until no input elements remain.éš¾åº¦ï¼šMedium (36.50%)æ€è·¯ï¼šæ–°å¼€è¾Ÿä¸€ä¸ªç©ºé“¾è¡¨ï¼Œä½œä¸ºä»¥æ’åºåŒºåŸŸï¼Œæ¯æ¬¡æ‹¿å‡º head æ¥ï¼Œä¸ä»¥æ’åºåŒºåŸŸçš„é“¾è¡¨çš„ val è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾åˆ°æ’å…¥ä½ç½®ï¼Œæ’å…¥ã€‚åˆ™æœªæ’åºåŒºåŸŸçš„äº†é“¾è¡¨é•¿åº¦å‡ä¸€ã€‚ 123456789101112131415var insertionSortList = function(head) &#123; var current = &#123; val: -Number.MAX_VALUE, next: null &#125;; while (head) &#123; var prev = current; while (prev.next &amp;&amp; prev.next.val &lt; head.val) &#123; prev = prev.next; &#125; var next = head.next; head.next = prev.next; prev.next = head; head = next; &#125; return current.next;&#125;; [148] Sort ListSort a linked list in O(n log n) time using constant space complexity.éš¾åº¦ï¼šMedium (34.12%)æ€è·¯ï¼šå½’å¹¶æ’åºçš„é“¾è¡¨å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142var sortList = function(head) &#123; if (head == null || head.next == null) &#123; return head; &#125; var fast = head; var slow = head; var pre = null; while (fast &amp;&amp; fast.next != null) &#123; pre = slow; slow = slow.next; fast = fast.next.next; &#125; pre.next = null; return merge(sortList(head), sortList(slow));&#125;;function merge(left, right) &#123; var result = &#123;&#125;; var pre = result; while (left &amp;&amp; right) &#123; if (left.val &lt; right.val) &#123; pre.next = left; pre = pre.next; left = left.next; &#125; else &#123; pre.next = right; pre = pre.next; right = right.next; &#125; &#125; while (left) &#123; pre.next = left; pre = pre.next; left = left.next; &#125; while (right) &#123; pre.next = right; pre = pre.next; right = right.next; &#125; return result.next;&#125; [179] Largest NumberGiven a list of non negative integers, arrange them such that they form the largest number.éš¾åº¦ï¼šMedium (25.32%) 12345678910111213var largestNumber = function(nums) &#123; nums.sort(function(a, b) &#123; var ab = a.toString() + b.toString(); var ba = b.toString() + a.toString(); return ba - ab; &#125;); var result = nums.join(\"\"); if (parseInt(result) == 0) &#123; return \"0\"; &#125; else &#123; return result; &#125;&#125;; [242] Valid AnagramGiven two strings s and t , write a function to determine if t is an anagram of s.Note: You may assume the string contains only lowercase alphabets.éš¾åº¦ï¼šEasy (51.12%) 1234567891011121314151617var isAnagram = function(s, t) &#123; if (s.length != = t.length) &#123; return false; &#125; var res = new Array(26); res.fill(0); for (var i = 0; i &lt; s.length; i++) &#123; res[s.codePointAt(i) - 97]++; res[t.codePointAt(i) - 97]--; &#125; for (var i = 0; i &lt; res.length; i++) &#123; if (res[i] !== 0) &#123; return false; &#125; &#125; return true;&#125;; [274] H-IndexGiven an array of citations (each citation is a non-negative integer) of a researcher, write a function to compute the researcherâ€™s h-index.According to the definition of h-index on Wikipedia: â€œA scientist has index h if h of his/her N papers have at least h citations each, and the other N âˆ’ h papers have no more than h citations each.â€éš¾åº¦ï¼šMedium (34.43%)æ€è·¯ï¼šä¸€ä¸ªäººåœ¨å…¶æ‰€æœ‰å­¦æœ¯æ–‡ç« ä¸­æœ‰ N ç¯‡è®ºæ–‡åˆ†åˆ«è¢«å¼•ç”¨äº†è‡³å°‘ N æ¬¡ï¼Œä»–çš„ H æŒ‡æ•°å°±æ˜¯ Nã€‚æ ¹æ®è¿™ä¸ªè§„åˆ™ï¼Œé¦–å…ˆè®²æ•°ç»„å€’åºæ’åˆ—ï¼Œåˆ¤æ–­æ•°ç»„ä¸­çš„ç¬¬ i ä¸ªï¼Œæ˜¯å¦å¤§äºç­‰äº i+1ï¼Œå¦‚æœæˆç«‹ï¼Œåˆ™ä»£è¡¨ï¼Œè‡³å°‘æœ‰ i+1 ç¯‡æ–‡ç« ï¼Œè¢«å¼•ç”¨äº† i+1 æ¬¡ï¼Œåˆ™ä»–çš„ h-index å°±æ˜¯ i+1. 12345678910111213141516var hIndex = function(citations) &#123; if (citations.length == 0) &#123; return 0; &#125; citations.sort((a, b) =&gt; b - a); var res = citations.length; for (var i = citations.length - 1; i &gt;= 0; i--) &#123; if (citations[i] &gt;= res) &#123; return res; &#125; res--; &#125; if (res == 0) &#123; return 0; &#125;&#125;; [324] Wiggle Sort IIGiven an unsorted array nums, reorder it such that nums[0] &lt; nums[1] &gt; nums[2] &lt; nums[3]â€¦.éš¾åº¦ï¼šMedium (27.54%)æ€è·¯ï¼šå°†æ•°ç»„æ­£åºæ’åºä¹‹åï¼Œä»ä¸­é—´åˆ†ä¸ºä¸¤ä¸ªæ•°ç»„ï¼Œæ¯æ¬¡ä»å°æ•°ç»„é‡Œæ‹¿ä¸€ä¸ªæ•°ï¼Œä»å¤§æ•°ç»„é‡Œæ‹¿ä¸€ä¸ªæ•°ï¼Œç»„æˆçš„ æ–°æ•°ç»„å°±æ˜¯ä¸€ä¸ªæ•°å¤§ä¸€ä¸ªæ•°å°çš„çŠ¶æ€ã€‚ 12345678910111213141516171819202122232425262728var wiggleSort = function(nums) &#123; if (nums.length &lt;= 1) &#123; return nums; &#125; nums = nums.sort((a, b) =&gt; a - b); var mid = Math.floor((nums.length + 1) / 2); var small = nums.slice(0, mid); var big = nums.slice(mid); if (big.length &gt; small.length) &#123; return []; &#125; var i = 0; var j = small.length - 1; var k = big.length - 1; while (i &lt; nums.length &amp;&amp; j &gt;= 0 &amp;&amp; k &gt;= 0) &#123; nums[i] = small[j]; nums[i + 1] = big[k]; i = i + 2; j--; k--; &#125; while (i &lt; nums.length &amp;&amp; j &gt;= 0) &#123; nums[i] = small[j]; i++; j--; &#125; return nums;&#125;;","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/categories/ç®—æ³•/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://yoursite.com/tags/LeetCode/"},{"name":"æ’åº","slug":"æ’åº","permalink":"http://yoursite.com/tags/æ’åº/"}]},{"title":"å‰ç«¯è·¯ç”±","slug":"å‰ç«¯è·¯ç”±","date":"2019-01-28T12:56:32.000Z","updated":"2019-11-10T14:37:39.032Z","comments":true,"path":"2019/01/28/å‰ç«¯è·¯ç”±/","link":"","permalink":"http://yoursite.com/2019/01/28/å‰ç«¯è·¯ç”±/","excerpt":"å‰ç«¯è·¯ç”±1.ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œè·¯ç”±å°±æ˜¯æµè§ˆå™¨åœ°å€æ ä¸­çš„ url ä¸æ‰€è§ç½‘é¡µçš„å¯¹åº”å…³ç³»ã€‚è€Œå¯¹äº web å¼€å‘äººå‘˜æ¥è¯´ï¼Œè·¯ç”±æ›´åƒæ˜¯ url ä¸å¤„ç†å‡½æ•°çš„å¯¹åº”å…³ç³»ã€‚ ä¼ ç»Ÿçš„æœåŠ¡ç«¯è·¯ç”±ï¼Œæ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„ä¸åŒç½‘å€ï¼Œè¿”å›ä¸åŒçš„ç½‘é¡µå†…å®¹ï¼Œè¿™ç§æƒ…å†µä¸€æ˜¯ä¼šé€ æˆæœåŠ¡å™¨å‹åŠ›å¢åŠ ï¼ŒäºŒæ˜¯æ¯æ¬¡éƒ½é‡æ–°è¯·æ±‚ï¼Œå“åº”è¾ƒæ…¢ã€ç”¨æˆ·ä½“éªŒä¸‹é™ã€‚äºæ˜¯ï¼Œå•é¡µåº”ç”¨ï¼ˆspa,single page applicationï¼‰åº”è¿è€Œç”Ÿã€‚åœ¨ url åœ°å€æ”¹å˜çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ js æ¥å®ç°ä¸åŒ UI ä¹‹é—´çš„åˆ‡æ¢ï¼ˆjs å¯¹ DOM çš„æ“ä½œï¼‰ï¼Œè€Œä¸å†å‘æœåŠ¡å™¨é‡æ–°è¯·æ±‚é¡µé¢ï¼Œåªé€šè¿‡ ajax å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ï¼Œå¯¹ç”¨æˆ·æ¥è¯´è¿™ç§æ— åˆ·æ–°çš„ã€å³æ—¶å“åº”æ˜¯æ›´å¥½çš„ä½“éªŒã€‚å…¶ä¸­ï¼Œæ ¹æ® url åœ°å€æ çš„å˜åŒ–è€Œå±•ç¤ºä¸åŒçš„ UIï¼Œå°±æ˜¯é€šè¿‡å‰ç«¯è·¯ç”±æ¥å®ç°çš„ã€‚ç›®å‰ä¸»æµçš„æ”¯æŒå•é¡µåº”ç”¨çš„å‰ç«¯æ¡†æ¶ï¼ŒåŸºæœ¬éƒ½æœ‰é…å¥—çš„æˆ–ç¬¬ä¸‰æ–¹çš„è·¯ç”±ç³»ç»Ÿã€‚","text":"å‰ç«¯è·¯ç”±1.ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œè·¯ç”±å°±æ˜¯æµè§ˆå™¨åœ°å€æ ä¸­çš„ url ä¸æ‰€è§ç½‘é¡µçš„å¯¹åº”å…³ç³»ã€‚è€Œå¯¹äº web å¼€å‘äººå‘˜æ¥è¯´ï¼Œè·¯ç”±æ›´åƒæ˜¯ url ä¸å¤„ç†å‡½æ•°çš„å¯¹åº”å…³ç³»ã€‚ ä¼ ç»Ÿçš„æœåŠ¡ç«¯è·¯ç”±ï¼Œæ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„ä¸åŒç½‘å€ï¼Œè¿”å›ä¸åŒçš„ç½‘é¡µå†…å®¹ï¼Œè¿™ç§æƒ…å†µä¸€æ˜¯ä¼šé€ æˆæœåŠ¡å™¨å‹åŠ›å¢åŠ ï¼ŒäºŒæ˜¯æ¯æ¬¡éƒ½é‡æ–°è¯·æ±‚ï¼Œå“åº”è¾ƒæ…¢ã€ç”¨æˆ·ä½“éªŒä¸‹é™ã€‚äºæ˜¯ï¼Œå•é¡µåº”ç”¨ï¼ˆspa,single page applicationï¼‰åº”è¿è€Œç”Ÿã€‚åœ¨ url åœ°å€æ”¹å˜çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ js æ¥å®ç°ä¸åŒ UI ä¹‹é—´çš„åˆ‡æ¢ï¼ˆjs å¯¹ DOM çš„æ“ä½œï¼‰ï¼Œè€Œä¸å†å‘æœåŠ¡å™¨é‡æ–°è¯·æ±‚é¡µé¢ï¼Œåªé€šè¿‡ ajax å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ï¼Œå¯¹ç”¨æˆ·æ¥è¯´è¿™ç§æ— åˆ·æ–°çš„ã€å³æ—¶å“åº”æ˜¯æ›´å¥½çš„ä½“éªŒã€‚å…¶ä¸­ï¼Œæ ¹æ® url åœ°å€æ çš„å˜åŒ–è€Œå±•ç¤ºä¸åŒçš„ UIï¼Œå°±æ˜¯é€šè¿‡å‰ç«¯è·¯ç”±æ¥å®ç°çš„ã€‚ç›®å‰ä¸»æµçš„æ”¯æŒå•é¡µåº”ç”¨çš„å‰ç«¯æ¡†æ¶ï¼ŒåŸºæœ¬éƒ½æœ‰é…å¥—çš„æˆ–ç¬¬ä¸‰æ–¹çš„è·¯ç”±ç³»ç»Ÿã€‚ 2.å‰ç«¯è·¯ç”±çš„å®ç°æ–¹å¼åœ¨ HTML5 çš„ history API å‡ºç°ä¹‹å‰ï¼Œå‰ç«¯è·¯ç”±ä¸»è¦æ˜¯é€šè¿‡ hash æ¥å®ç°çš„ï¼Œhash èƒ½å…¼å®¹ä½ç‰ˆæœ¬çš„æµè§ˆå™¨ã€‚ä¸‹é¢åˆ†åˆ«æ¥ä»‹ç»è¿™ 2 ç§æ–¹å¼ã€‚ æ–¹æ³•ä¸€ï¼šåŸºäº hashï¼ˆlocation.hash+hashchange äº‹ä»¶ï¼‰ æˆ‘ä»¬çŸ¥é“ location.hash çš„å€¼æ˜¯ url ä¸­#åé¢çš„å†…å®¹ï¼Œå¦‚http://www.163.com#neteaseæ­¤ç½‘å€ä¸­ï¼Œlocation.hash=â€™#neteaseâ€™ã€‚ hash æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªç‰¹æ€§ï¼Œæ‰ä½¿å¾—å…¶å¯ä»¥å®ç°å‰ç«¯è·¯ç”±ï¼š url ä¸­ hash å€¼çš„å˜åŒ–å¹¶ä¸ä¼šé‡æ–°åŠ è½½é¡µé¢ï¼Œå› ä¸º hash æ˜¯ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨è¡Œä¸ºçš„ï¼Œå¯¹æœåŠ¡ç«¯æ˜¯æ— ç”¨çš„ï¼Œæ‰€ä»¥ä¸ä¼šåŒ…æ‹¬åœ¨ http è¯·æ±‚ä¸­ã€‚ hash å€¼çš„æ”¹å˜ï¼Œéƒ½ä¼šåœ¨æµè§ˆå™¨çš„è®¿é—®å†å²ä¸­å¢åŠ ä¸€ä¸ªè®°å½•ï¼Œä¹Ÿå°±æ˜¯èƒ½é€šè¿‡æµè§ˆå™¨çš„å›é€€ã€å‰è¿›æŒ‰é’®æ§åˆ¶ hash çš„åˆ‡æ¢ æˆ‘ä»¬å¯ä»¥é€šè¿‡ hashchange äº‹ä»¶ï¼Œç›‘å¬åˆ° hash å€¼çš„å˜åŒ–ï¼Œä»è€Œå“åº”ä¸åŒè·¯å¾„çš„é€»è¾‘å¤„ç†ã€‚ 1window.addEventListener(\"hashchange\", funcRef, false); å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ hashchange äº‹ä»¶é‡Œï¼Œæ ¹æ® hash å€¼æ¥æ›´æ–°å¯¹åº”çš„è§†å›¾ï¼Œä½†ä¸ä¼šå»é‡æ–°è¯·æ±‚é¡µé¢ï¼ŒåŒæ—¶å‘¢ï¼Œä¹Ÿåœ¨ history é‡Œå¢åŠ äº†ä¸€æ¡è®¿é—®è®°å½•ï¼Œç”¨æˆ·ä¹Ÿä»ç„¶å¯ä»¥é€šè¿‡å‰è¿›åé€€é”®å®ç° UI çš„åˆ‡æ¢ã€‚ è§¦å‘ hash å€¼çš„å˜åŒ–æœ‰ 2 ç§æ–¹æ³•:ä¸€ç§æ˜¯é€šè¿‡ a æ ‡ç­¾ï¼Œè®¾ç½® href å±æ€§ï¼Œå½“æ ‡ç­¾ç‚¹å‡»ä¹‹åï¼Œåœ°å€æ ä¼šæ”¹å˜ï¼ŒåŒæ—¶ä¼šè§¦å‘ hashchange äº‹ä»¶ 1&lt;a href=\"#kaola\"&gt;to KAOLA&lt;/a&gt; å¦ä¸€ç§æ˜¯é€šè¿‡ js ç›´æ¥èµ‹å€¼ç»™ location.hashï¼Œä¹Ÿä¼šæ”¹å˜ urlï¼Œè§¦å‘ hashchange äº‹ä»¶ã€‚ 1location.hash = \"#kaola\"; ä¸‹é¢å±•ç¤ºä¸€ä¸ªé€šè¿‡ hash å®ç°çš„ç®€æ˜“ Routerï¼š123456789101112131415161718192021222324function Router() &#123; this.routes = &#123;&#125;; this.currentUrl = \"\";&#125;Router.prototype.route = function(path, callback) &#123; this.routes[path] = callback || function() &#123;&#125;;&#125;;Router.prototype.refresh = function() &#123; this.currentUrl = location.hash.slice(1) || \"/\"; this.routes[this.currentUrl]();&#125;;Router.prototype.init = function() &#123; window.addEventListener(\"load\", this.refresh.bind(this), false); window.addEventListener(\"hashchange\", this.refresh.bind(this), false);&#125;;window.Router = new Router();window.Router.init();// æ·»åŠ è·¯ç”±è§„åˆ™Router.route(\"/\", function() &#123; // è®¾ç½®å“åº”å†…å®¹&#125;);Router.route(\"/blue\", function() &#123; // è®¾ç½®å“åº”å†…å®¹&#125;); ã€route vs routerã€‘route æ˜¯ä¸€æ¡è·¯ç”±ï¼Œæ˜¯å°†ä¸€ä¸ª URL è·¯å¾„å’Œä¸€ä¸ªå¤„ç†å‡½æ•°ç›¸å…³è”ï¼Œæ˜¯ä¸€æ¡ url å’Œå‡½æ•°çš„æ˜ å°„è§„åˆ™ï¼Œå¦‚ä¸Šé¢ä»£ç ä¸­é€šè¿‡åŸå‹ä¸Šçš„ route å¯ä»¥è®¾ç½®ä¸€æ¡è·¯ç”±è§„åˆ™ï¼Œå°†ä¸€ä¸ª path å’Œå…¶ callback å…³è”èµ·æ¥ã€‚ è€Œ router åˆ™æ›´åƒæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæˆ–è€…è¯´ä¸€ç§æœºåˆ¶ï¼Œå®ƒç®¡ç†äº†ä¸€ç»„ routeã€‚ç®€å•æ¥è¯´ï¼Œroute åªæ˜¯è¿›è¡Œäº† URL å’Œå‡½æ•°çš„æ˜ å°„ï¼Œè€Œåœ¨å½“æ¥æ”¶åˆ°ä¸€ä¸ª URL ä¹‹åï¼Œå»è·¯ç”±æ˜ å°„è¡¨ä¸­æŸ¥æ‰¾ç›¸åº”çš„å‡½æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ç”± router æ¥å¤„ç†çš„ï¼Œå¦‚ä¸Šé¢ä»£ç ï¼ŒRouter ç®¡ç†ä¼ å…¥çš„ routeï¼Œå¹¶ä¸”åœ¨ hash æ”¹å˜çš„æ—¶å€™ï¼Œæ ¹æ®å½“å‰çš„ url å“åº”å…¶å¯¹åº”çš„å‡½æ•°ã€‚ æ–¹æ³•äºŒï¼šåŸºäº History æ–° APIï¼ˆhistory.pushState()+popState äº‹ä»¶ï¼‰ HTML5 ä¸­ history å¯¹è±¡ä¸Šæ–°çš„ APIï¼ŒåŒæ ·èƒ½å®ç°å‰ç«¯çš„è·¯ç”±ã€‚é€šè¿‡ pushState()æ–¹æ³•æˆ– replaceState()æ–¹æ³•å¯ä»¥ä¿®æ”¹ url çš„åœ°å€ï¼Œå¹¶åœ¨ popstate äº‹ä»¶ä¸­èƒ½ç›‘å¬åœ°å€çš„æ”¹å˜ï¼Œä¸åŒçš„æ˜¯ï¼Œæ‰‹åŠ¨çš„è¿›è¡Œ pushState()å¹¶ä¸ä¼šè§¦å‘ popstate äº‹ä»¶ã€‚ ä¸¤ä¸ªæ–°å¢çš„ APIï¼šhistory.pushState å’Œ history.replaceStateè¿™ä¸¤ä¸ª API éƒ½æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š 1window.history.pushState(null, null, \"http://www.163.com\"); çŠ¶æ€å¯¹è±¡ï¼ˆstate objectï¼‰ï¼Œä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œä¸ç”¨ pushState()æ–¹æ³•åˆ›å»ºçš„æ–°å†å²è®°å½•æ¡ç›®å…³è”ã€‚æ— è®ºä½•æ—¶ç”¨æˆ·å¯¼èˆªåˆ°æ–°åˆ›å»ºçš„çŠ¶æ€ï¼Œä¼šè§¦å‘ popstate äº‹ä»¶ï¼Œå¹¶èƒ½åœ¨äº‹ä»¶ä¸­ä½¿ç”¨è¯¥å¯¹è±¡ã€‚ æ ‡é¢˜ï¼ˆtitleï¼‰ ï¼šä¼ å…¥ä¸€ä¸ªçŸ­æ ‡é¢˜ç»™å½“å‰ stateã€‚ç°åœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸æ”¯æŒæˆ–è€…ä¼šå¿½ç•¥æ­¤å‚æ•°ï¼Œæœ€å¥½ä¼ å…¥ null ä»£æ›¿ï¼› åœ°å€ï¼ˆURLï¼‰ï¼šæ–°çš„å†å²è®°å½•æ¡ç›®çš„åœ°å€ã€‚æµè§ˆå™¨ä¸ä¼šåœ¨è°ƒç”¨ pushState()æ–¹æ³•ååŠ è½½è¯¥åœ°å€ï¼Œä½†ä¹‹åï¼Œå¯èƒ½ä¼šè¯•å›¾åŠ è½½ï¼Œä¾‹å¦‚ç”¨æˆ·é‡å¯æµè§ˆå™¨ã€‚æ–°çš„ URL ä¸ä¸€å®šæ˜¯ç»å¯¹è·¯å¾„ï¼›å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå®ƒå°†ä»¥å½“å‰ URL ä¸ºåŸºå‡†ï¼›ä¼ å…¥çš„ URL ä¸å½“å‰ URL åº”è¯¥æ˜¯åŒæºçš„ï¼Œå¦åˆ™ï¼ŒpushState()ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¯¥å‚æ•°æ˜¯å¯é€‰çš„ï¼›ä¸æŒ‡å®šçš„è¯åˆ™ä¸ºæ–‡æ¡£å½“å‰ URLã€‚ è¿™ä¸¤ä¸ª API çš„ç›¸åŒä¹‹å¤„æ˜¯éƒ½ä¼šæ“ä½œæµè§ˆå™¨çš„å†å²è®°å½•ï¼Œè€Œä¸ä¼šå¼•èµ·é¡µé¢çš„åˆ·æ–°ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼ŒpushState ä¼šå¢åŠ ä¸€æ¡æ–°çš„å†å²è®°å½•ï¼Œè€Œ replaceState åˆ™ä¼šæ›¿æ¢å½“å‰çš„å†å²è®°å½•ã€‚è¿™ä¸¤ä¸ª apiï¼ŒåŠ ä¸Š state æ”¹å˜è§¦å‘çš„ popstate äº‹ä»¶ï¼Œæä¾›äº†å•é¡µåº”è¯¥çš„å¦ä¸€ç§è·¯ç”±æ–¹å¼ã€‚ ä¸‹é¢å±•ç¤ºä¸€ä¸ªä½¿ç”¨è¿™ç§æ–¹å¼çš„ç®€å• demoï¼š12345678910111213141516171819202122232425&lt;p id=\"menu\"&gt; &lt;a href=\"/profile\" title=\"profile\"&gt;profile&lt;/a&gt; &lt;a href=\"/account\" title=\"account\"&gt;account&lt;/a&gt;?&lt;/p&gt;&lt;div class=\"main\" id=\"main\"&gt;&lt;/div&gt;&lt;script&gt; (function() &#123; var menubox = document.getElementById(\"menu\"); var mainbox = document.getElementById(\"main\"); menubox.addEventListener(\"click\", function(e) &#123; e.preventDefault(); var elm = e.target; var uri = elm.href; var tlt = elm.title; history.pushState(&#123; path: uri, title: tlt &#125;, null, uri); mainbox.innerHTML = \"current page is \" + tlt; &#125;); window.addEventListener(\"popstate\", function(e) &#123; var state = e.state; console.log(state); mainbox.innerHTML = \"current page is \" + state.title; // è¿˜åŸUI &#125;); &#125;)();&lt;/script&gt; å½“æˆ‘ä»¬åœ¨å†å²è®°å½•ä¸­åˆ‡æ¢æ—¶å°±ä¼šè§¦å‘ popstate äº‹ä»¶ï¼Œå¯ä»¥åœ¨äº‹ä»¶ä¸­è¿˜åŸå½“å‰ state å¯¹åº”çš„ UIã€‚å¯¹äºè§¦å‘ popstate äº‹ä»¶çš„æ–¹å¼ï¼Œå„æµè§ˆå™¨å®ç°ä¹Ÿæœ‰å·®å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒæµè§ˆå™¨åšå…¼å®¹å¤„ç†ã€‚ ä¸¤ç§æ–¹å¼å¯¹æ¯”ï¼ˆHistory&amp;&amp;hashï¼‰ ä¸¤ç§æ–¹å¼å¯¹æ¯”ï¼ŒåŸºäº Hash çš„è·¯ç”±ï¼Œå…¼å®¹æ€§æ›´å¥½ï¼›åŸºäº History API çš„è·¯ç”±ï¼Œåˆ™æ›´æ­£å¼ï¼Œå¯ä»¥è®¾ç½®ä¸å½“å‰ URL åŒæºçš„ä»»æ„ URLï¼Œè·¯å¾„æ›´ç›´è§‚ã€‚å¦å¤–ï¼ŒåŸºäº Hash çš„è·¯ç”±ä¸éœ€è¦å¯¹æœåŠ¡å™¨åšæ”¹åŠ¨ï¼ŒåŸºäº History API çš„è·¯ç”±éœ€è¦å¯¹æœåŠ¡å™¨åšä¸€äº›æ”¹é€ ï¼Œé…ç½®ä¸åŒçš„è·¯ç”±éƒ½è¿”å›ç›¸åŒçš„é¡µé¢ã€‚ å½“ç›´æ¥è®¿é—®http://example.com/çš„æ—¶å€™ï¼Œä¸¤è€…çš„è¡Œä¸ºæ˜¯ä¸€è‡´çš„ï¼Œéƒ½æ˜¯è¿”å›äº†index.htmlæ–‡ä»¶ã€‚å½“ä»http://example.com/è·³è½¬åˆ°http://example.com/#/foobaræˆ–è€…http://example.com/foobarçš„æ—¶å€™ï¼Œä¹Ÿéƒ½æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæ­¤æ—¶å·²ç»åŠ è½½äº†é¡µé¢ä»¥åŠè„šæœ¬æ–‡ä»¶ï¼Œæ‰€ä»¥è·¯ç”±è·³è½¬æ­£å¸¸ã€‚ å½“ç›´æ¥è®¿é—®http://example.com/#/foobarçš„æ—¶å€™ï¼Œå®é™…ä¸Šå‘æœåŠ¡å™¨å‘èµ·çš„è¯·æ±‚æ˜¯http://example.com/ï¼Œå› æ­¤ä¼šé¦–å…ˆåŠ è½½é¡µé¢åŠè„šæœ¬æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥è„šæœ¬æ‰§è¡Œè·¯ç”±è·³è½¬ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ å½“ç›´æ¥è®¿é—®http://example.com/foobarçš„æ—¶å€™ï¼Œå®é™…ä¸Šå‘æœåŠ¡å™¨å‘èµ·çš„è¯·æ±‚ä¹Ÿæ˜¯http://example.com/foobarï¼Œç„¶è€ŒæœåŠ¡å™¨ç«¯åªèƒ½åŒ¹é…/è€Œæ— æ³•åŒ¹é…/foobarï¼Œå› æ­¤ä¼šå‡ºç°404é”™è¯¯ã€‚ å› æ­¤å¦‚æœä½¿ç”¨äº†åŸºäº History API çš„è·¯ç”±ï¼Œéœ€è¦æ”¹é€ æœåŠ¡å™¨ç«¯ï¼Œä½¿å¾—è®¿é—®/foobar çš„æ—¶å€™ä¹Ÿèƒ½è¿”å› index.html æ–‡ä»¶ï¼Œè¿™æ ·å½“æµè§ˆå™¨åŠ è½½äº†é¡µé¢åŠè„šæœ¬ä¹‹åï¼Œå°±èƒ½è¿›è¡Œè·¯ç”±è·³è½¬äº†ã€‚ Vue Routervue-router åŸºæœ¬çš„è·¯ç”±é…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324import Router from 'vue-router'import Index from 'pages/index'import Error from 'pages/error'Vue.use(Router)export default new Router(&#123; mode: 'history', // è®¾ç½®è·¯ç”±æ–¹å¼ routes: [ &#123; path: '/', name: 'index', component: Index &#125;, &#123; path: '*', name: '404', component: Error &#125; ]&#125;)// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨routerè§†å›¾ç»„ä»¶&lt;router-view&gt;&lt;/router-view&gt; å¯ä»¥é€šè¿‡ vue-router å®ä¾‹æ¥é…ç½®è·¯ç”±è§„åˆ™åˆ—è¡¨ï¼ŒæŒ‡å®šè·¯å¾„ path ä¸ç»„ä»¶ component çš„å¯¹åº”å…³ç³»ã€‚ 1.æ¨¡å¼å‚æ•°åœ¨ vue-router ä¸­æ˜¯é€šè¿‡ mode è¿™ä¸€å‚æ•°æ§åˆ¶è·¯ç”±çš„å®ç°æ¨¡å¼çš„ï¼š 1234const router = new VueRouter(&#123; mode: 'history', routes: [...]&#125;) åˆ›å»º VueRouter çš„å®ä¾‹å¯¹è±¡æ—¶ï¼Œmode ä»¥æ„é€ å‡½æ•°å‚æ•°çš„å½¢å¼ä¼ å…¥ã€‚ä» VueRouter ç±»çš„å®šä¹‰å…¥æ‰‹ã€‚ä¸€èˆ¬æ’ä»¶å¯¹å¤–æš´éœ²çš„ç±»éƒ½æ˜¯å®šä¹‰åœ¨æºç  src æ ¹ç›®å½•ä¸‹çš„ index.js æ–‡ä»¶ä¸­ï¼Œæ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° VueRouter ç±»çš„å®šä¹‰ï¼Œæ‘˜å½•ä¸ mode å‚æ•°æœ‰å…³çš„éƒ¨åˆ†å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667export default class VueRouter &#123; mode: string; // ä¼ å…¥çš„å­—ç¬¦ä¸²å‚æ•°ï¼ŒæŒ‡ç¤ºhistoryç±»åˆ« history: HashHistory | HTML5History | AbstractHistory; // å®é™…èµ·ä½œç”¨çš„å¯¹è±¡å±æ€§ï¼Œå¿…é¡»æ˜¯ä»¥ä¸Šä¸‰ä¸ªç±»çš„æšä¸¾ fallback: boolean; // å¦‚æµè§ˆå™¨ä¸æ”¯æŒï¼Œ'history'æ¨¡å¼éœ€å›æ»šä¸º'hash'æ¨¡å¼ constructor(options: RouterOptions = &#123;&#125;) &#123; let mode = options.mode || \"hash\"; // é»˜è®¤ä¸º'hash'æ¨¡å¼ this.fallback = mode === \"history\" &amp;&amp; !supportsPushState; // é€šè¿‡supportsPushStateåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒ'history'æ¨¡å¼ if (this.fallback) &#123; mode = \"hash\"; &#125; if (!inBrowser) &#123; mode = \"abstract\"; // ä¸åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹è¿è¡Œéœ€å¼ºåˆ¶ä¸º'abstract'æ¨¡å¼ &#125; this.mode = mode; // æ ¹æ®modeç¡®å®šhistoryå®é™…çš„ç±»å¹¶å®ä¾‹åŒ– switch (mode) &#123; case \"history\": this.history = new HTML5History(this, options.base); break; case \"hash\": this.history = new HashHistory(this, options.base, this.fallback); break; case \"abstract\": this.history = new AbstractHistory(this, options.base); break; default: if (process.env.NODE_ENV !== \"production\") &#123; assert(false, `invalid mode: $&#123;mode&#125;`); &#125; &#125; &#125; init(app: any /* Vue component instance */) &#123; const history = this.history; // æ ¹æ®historyçš„ç±»åˆ«æ‰§è¡Œç›¸åº”çš„åˆå§‹åŒ–æ“ä½œå’Œç›‘å¬ if (history instanceof HTML5History) &#123; history.transitionTo(history.getCurrentLocation()); &#125; else if (history instanceof HashHistory) &#123; const setupHashListener = () =&gt; &#123; history.setupListeners(); &#125;; history.transitionTo( history.getCurrentLocation(), setupHashListener, setupHashListener ); &#125; history.listen(route =&gt; &#123; this.apps.forEach(app =&gt; &#123; app._route = route; &#125;); &#125;); &#125; // VueRouterç±»æš´éœ²çš„ä»¥ä¸‹æ–¹æ³•å®é™…æ˜¯è°ƒç”¨å…·ä½“historyå¯¹è±¡çš„æ–¹æ³• push(location: RawLocation, onComplete?: Function, onAbort?: Function) &#123; this.history.push(location, onComplete, onAbort); &#125; replace(location: RawLocation, onComplete?: Function, onAbort?: Function) &#123; this.history.replace(location, onComplete, onAbort); &#125;&#125; å¯ä»¥çœ‹å‡ºï¼š ä½œä¸ºå‚æ•°ä¼ å…¥çš„å­—ç¬¦ä¸²å±æ€§ mode åªæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œç”¨æ¥æŒ‡ç¤ºå®é™…èµ·ä½œç”¨çš„å¯¹è±¡å±æ€§ history çš„å®ç°ç±»ï¼Œä¸¤è€…å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š modehistoryï¼š â€˜historyâ€™â€”â€”HTML5History â€˜hashâ€™â€”â€”HashHistory â€˜abstractâ€™â€”â€”AbstractHistory åœ¨åˆå§‹åŒ–å¯¹åº”çš„ history ä¹‹å‰ï¼Œä¼šå¯¹ mode åšä¸€äº›æ ¡éªŒï¼šè‹¥æµè§ˆå™¨ä¸æ”¯æŒ HTML5History æ–¹å¼ï¼ˆé€šè¿‡ supportsPushState å˜é‡åˆ¤æ–­ï¼‰ï¼Œåˆ™ mode å¼ºåˆ¶è®¾ä¸ºâ€™hashâ€™ï¼›è‹¥ä¸æ˜¯åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹è¿è¡Œï¼Œåˆ™ mode å¼ºåˆ¶è®¾ä¸ºâ€™abstractâ€™ VueRouter ç±»ä¸­çš„ onReady(), push()ç­‰æ–¹æ³•åªæ˜¯ä¸€ä¸ªä»£ç†ï¼Œå®é™…æ˜¯è°ƒç”¨çš„å…·ä½“ history å¯¹è±¡çš„å¯¹åº”æ–¹æ³•ï¼Œåœ¨ init()æ–¹æ³•ä¸­åˆå§‹åŒ–æ—¶ï¼Œä¹Ÿæ˜¯æ ¹æ® history å¯¹è±¡å…·ä½“çš„ç±»åˆ«æ‰§è¡Œä¸åŒæ“ä½œ åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹çš„ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«å°±æ˜¯åœ¨ HTML5Historyï¼ŒHashHistory ä¸¤ä¸ªç±»ä¸­å®ç°çš„ã€‚ä»–ä»¬éƒ½å®šä¹‰åœ¨ src/history æ–‡ä»¶å¤¹ä¸‹ï¼Œç»§æ‰¿è‡ªåŒç›®å½•ä¸‹ base.js æ–‡ä»¶ä¸­å®šä¹‰çš„ History ç±»ã€‚History ä¸­å®šä¹‰çš„æ˜¯å…¬ç”¨å’ŒåŸºç¡€çš„æ–¹æ³•ï¼Œç›´æ¥çœ‹ä¼šä¸€å¤´é›¾æ°´ï¼Œæˆ‘ä»¬å…ˆä» HTML5Historyï¼ŒHashHistory ä¸¤ä¸ªç±»ä¸­çœ‹ç€äº²åˆ‡çš„ push(), replace()æ–¹æ³•çš„è¯´èµ·ã€‚ 2.HashHistoryçœ‹æºç å‰å…ˆå›é¡¾ä¸€ä¸‹åŸç†ï¼š hashï¼ˆâ€œ#â€ï¼‰ç¬¦å·çš„æœ¬æ¥ä½œç”¨æ˜¯åŠ åœ¨ URL ä¸­æŒ‡ç¤ºç½‘é¡µä¸­çš„ä½ç½®ï¼š http://www.example.com/index.html#print #ç¬¦å·æœ¬èº«ä»¥åŠå®ƒåé¢çš„å­—ç¬¦ç§°ä¹‹ä¸º hashï¼Œå¯é€šè¿‡ window.location.hash å±æ€§è¯»å–ã€‚å®ƒå…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š hash è™½ç„¶å‡ºç°åœ¨ URL ä¸­ï¼Œä½†ä¸ä¼šè¢«åŒ…æ‹¬åœ¨ HTTP è¯·æ±‚ä¸­ã€‚å®ƒæ˜¯ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨åŠ¨ä½œçš„ï¼Œå¯¹æœåŠ¡å™¨ç«¯å®Œå…¨æ— ç”¨ï¼Œå› æ­¤ï¼Œæ”¹å˜ hash ä¸ä¼šé‡æ–°åŠ è½½é¡µé¢ å¯ä»¥ä¸º hash çš„æ”¹å˜æ·»åŠ ç›‘å¬äº‹ä»¶ï¼š 1window.addEventListener(\"hashchange\", funcRef, false); æ¯ä¸€æ¬¡æ”¹å˜ hashï¼ˆwindow.location.hashï¼‰ï¼Œéƒ½ä¼šåœ¨æµè§ˆå™¨çš„è®¿é—®å†å²ä¸­å¢åŠ ä¸€ä¸ªè®°å½• åˆ©ç”¨ hash çš„ä»¥ä¸Šç‰¹ç‚¹ï¼Œå°±å¯ä»¥æ¥å®ç°å‰ç«¯è·¯ç”±â€œæ›´æ–°è§†å›¾ä½†ä¸é‡æ–°è¯·æ±‚é¡µé¢â€çš„åŠŸèƒ½äº†ã€‚ HashHistory.push()æˆ‘ä»¬æ¥çœ‹ HashHistory ä¸­çš„ push()æ–¹æ³•ï¼š 12345678910push (location: RawLocation, onComplete?: Function, onAbort?: Function) &#123; this.transitionTo(location, route =&gt; &#123; pushHash(route.fullPath) onComplete &amp;&amp; onComplete(route) &#125;, onAbort)&#125;function pushHash (path) &#123; window.location.hash = path&#125; transitionTo()æ–¹æ³•æ˜¯çˆ¶ç±»ä¸­å®šä¹‰çš„æ˜¯ç”¨æ¥å¤„ç†è·¯ç”±å˜åŒ–ä¸­çš„åŸºç¡€é€»è¾‘çš„ï¼Œpush()æ–¹æ³•æœ€ä¸»è¦çš„æ˜¯å¯¹ window çš„ hash è¿›è¡Œäº†ç›´æ¥èµ‹å€¼ï¼š 1window.location.hash = route.fullPath; hash çš„æ”¹å˜ä¼šè‡ªåŠ¨æ·»åŠ åˆ°æµè§ˆå™¨çš„è®¿é—®å†å²è®°å½•ä¸­ã€‚ é‚£ä¹ˆè§†å›¾çš„æ›´æ–°æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹çˆ¶ç±» History ä¸­ transitionTo()æ–¹æ³•çš„è¿™ä¹ˆä¸€æ®µï¼š 123456789101112131415transitionTo (location: RawLocation, onComplete?: Function, onAbort?: Function) &#123; const route = this.router.match(location, this.current) this.confirmTransition(route, () =&gt; &#123; this.updateRoute(route) ... &#125;)&#125;updateRoute (route: Route) &#123; this.cb &amp;&amp; this.cb(route)&#125;listen (cb: Function) &#123; this.cb = cb&#125; å¯ä»¥çœ‹åˆ°ï¼Œå½“è·¯ç”±å˜åŒ–æ—¶ï¼Œè°ƒç”¨äº† History ä¸­çš„ this.cb æ–¹æ³•ï¼Œè€Œ this.cb æ–¹æ³•æ˜¯é€šè¿‡ History.listen(cb)è¿›è¡Œè®¾ç½®çš„ã€‚å›åˆ° VueRouter ç±»å®šä¹‰ä¸­ï¼Œæ‰¾åˆ°äº†åœ¨ init()æ–¹æ³•ä¸­å¯¹å…¶è¿›è¡Œäº†è®¾ç½®ï¼š 12345678910init (app: any /* Vue component instance */) &#123; this.apps.push(app) history.listen(route =&gt; &#123; this.apps.forEach((app) =&gt; &#123; app._route = route &#125;) &#125;)&#125; æ ¹æ®æ³¨é‡Šï¼Œapp ä¸º Vue ç»„ä»¶å®ä¾‹ï¼Œä½†æˆ‘ä»¬çŸ¥é“ Vue ä½œä¸ºæ¸è¿›å¼çš„å‰ç«¯æ¡†æ¶ï¼Œæœ¬èº«çš„ç»„ä»¶å®šä¹‰ä¸­åº”è¯¥æ˜¯æ²¡æœ‰æœ‰å…³è·¯ç”±å†…ç½®å±æ€§_routeï¼Œå¦‚æœç»„ä»¶ä¸­è¦æœ‰è¿™ä¸ªå±æ€§ï¼Œåº”è¯¥æ˜¯åœ¨æ’ä»¶åŠ è½½çš„åœ°æ–¹ï¼Œå³ VueRouter çš„ install()æ–¹æ³•ä¸­æ··åˆå…¥ Vue å¯¹è±¡çš„ï¼ŒæŸ¥çœ‹ install.js æºç ï¼Œæœ‰å¦‚ä¸‹ä¸€æ®µï¼š 123456789101112export function install(Vue) &#123; Vue.mixin(&#123; beforeCreate() &#123; if (isDef(this.$options.router)) &#123; this._router = this.$options.router; this._router.init(this); Vue.util.defineReactive(this, \"_route\", this._router.history.current); &#125; registerInstance(this, this); &#125; &#125;);&#125; é€šè¿‡ Vue.mixin()æ–¹æ³•ï¼Œå…¨å±€æ³¨å†Œä¸€ä¸ªæ··åˆï¼Œå½±å“æ³¨å†Œä¹‹åæ‰€æœ‰åˆ›å»ºçš„æ¯ä¸ª Vue å®ä¾‹ï¼Œè¯¥æ··åˆåœ¨ beforeCreate é’©å­ä¸­é€šè¿‡ Vue.util.defineReactive()å®šä¹‰äº†å“åº”å¼çš„_route å±æ€§ã€‚æ‰€è°“å“åº”å¼å±æ€§ï¼Œå³å½“_route å€¼æ”¹å˜æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ Vue å®ä¾‹çš„ render()æ–¹æ³•ï¼Œæ›´æ–°è§†å›¾ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œä»è®¾ç½®è·¯ç”±æ”¹å˜åˆ°è§†å›¾æ›´æ–°çš„æµç¨‹å¦‚ä¸‹ï¼š1$router.push() --&gt; HashHistory.push() --&gt; History.transitionTo() --&gt; History.updateRoute() --&gt; &#123;app._route = route&#125; --&gt; vm.render() HashHistory.replace()replace()æ–¹æ³•ä¸ push()æ–¹æ³•ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒå¹¶ä¸æ˜¯å°†æ–°è·¯ç”±æ·»åŠ åˆ°æµè§ˆå™¨è®¿é—®å†å²çš„æ ˆé¡¶ï¼Œè€Œæ˜¯æ›¿æ¢æ‰å½“å‰çš„è·¯ç”±ï¼š 12345678910111213replace (location: RawLocation, onComplete?: Function, onAbort?: Function) &#123; this.transitionTo(location, route =&gt; &#123; replaceHash(route.fullPath) onComplete &amp;&amp; onComplete(route) &#125;, onAbort)&#125;function replaceHash (path) &#123; const i = window.location.href.indexOf('#') window.location.replace( window.location.href.slice(0, i &gt;= 0 ? i : 0) + '#' + path )&#125; å¯ä»¥çœ‹å‡ºï¼Œå®ƒä¸ push()çš„å®ç°ç»“æ„ä¸ŠåŸºæœ¬ç›¸ä¼¼ï¼Œä¸åŒç‚¹åœ¨äºå®ƒä¸æ˜¯ç›´æ¥å¯¹ window.location.hash è¿›è¡Œèµ‹å€¼ï¼Œè€Œæ˜¯è°ƒç”¨ window.location.replace æ–¹æ³•å°†è·¯ç”±è¿›è¡Œæ›¿æ¢ã€‚ ç›‘å¬åœ°å€æ ä»¥ä¸Šè®¨è®ºçš„ VueRouter.push()å’Œ VueRouter.replace()æ˜¯å¯ä»¥åœ¨ vue ç»„ä»¶çš„é€»è¾‘ä»£ç ä¸­ç›´æ¥è°ƒç”¨çš„ï¼Œé™¤æ­¤ä¹‹å¤–åœ¨æµè§ˆå™¨ä¸­ï¼Œç”¨æˆ·è¿˜å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥æ”¹å˜è·¯ç”±ï¼Œå› æ­¤ VueRouter è¿˜éœ€è¦èƒ½ç›‘å¬æµè§ˆå™¨åœ°å€æ ä¸­è·¯ç”±çš„å˜åŒ–ï¼Œå¹¶å…·æœ‰ä¸é€šè¿‡ä»£ç è°ƒç”¨ç›¸åŒçš„å“åº”è¡Œä¸ºã€‚åœ¨ HashHistory ä¸­è¿™ä¸€åŠŸèƒ½é€šè¿‡ setupListeners å®ç°ï¼š 12345678910setupListeners () &#123; window.addEventListener('hashchange', () =&gt; &#123; if (!ensureSlash()) &#123; return &#125; this.transitionTo(getHash(), route =&gt; &#123; replaceHash(route.fullPath) &#125;) &#125;)&#125; è¯¥æ–¹æ³•è®¾ç½®ç›‘å¬äº†æµè§ˆå™¨äº‹ä»¶ hashchangeï¼Œè°ƒç”¨çš„å‡½æ•°ä¸º replaceHashï¼Œå³åœ¨æµè§ˆå™¨åœ°å€æ ä¸­ç›´æ¥è¾“å…¥è·¯ç”±ç›¸å½“äºä»£ç è°ƒç”¨äº† replace()æ–¹æ³• 3.HTML5HistoryHistory interface æ˜¯æµè§ˆå™¨å†å²è®°å½•æ ˆæä¾›çš„æ¥å£ï¼Œé€šè¿‡ back(), forward(), go()ç­‰æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–æµè§ˆå™¨å†å²è®°å½•æ ˆçš„ä¿¡æ¯ï¼Œè¿›è¡Œå„ç§è·³è½¬æ“ä½œã€‚ ä» HTML5 å¼€å§‹ï¼ŒHistory interface æä¾›äº†ä¸¤ä¸ªæ–°çš„æ–¹æ³•ï¼špushState(), replaceState()ä½¿å¾—æˆ‘ä»¬å¯ä»¥å¯¹æµè§ˆå™¨å†å²è®°å½•æ ˆè¿›è¡Œä¿®æ”¹ï¼š12window.history.pushState(stateObject, title, URL);window.history.replaceState(stateObject, title, URL); stateObject: å½“æµè§ˆå™¨è·³è½¬åˆ°æ–°çš„çŠ¶æ€æ—¶ï¼Œå°†è§¦å‘ popState äº‹ä»¶ï¼Œè¯¥äº‹ä»¶å°†æºå¸¦è¿™ä¸ª stateObject å‚æ•°çš„å‰¯æœ¬ title: æ‰€æ·»åŠ è®°å½•çš„æ ‡é¢˜ URL: æ‰€æ·»åŠ è®°å½•çš„ URL è¿™ä¸¤ä¸ªæ–¹æ³•æœ‰ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼šå½“è°ƒç”¨ä»–ä»¬ä¿®æ”¹æµè§ˆå™¨å†å²è®°å½•æ ˆåï¼Œè™½ç„¶å½“å‰ URL æ”¹å˜äº†ï¼Œä½†æµè§ˆå™¨ä¸ä¼šç«‹å³å‘é€è¯·æ±‚è¯¥ URLï¼ˆthe browser wonâ€™t attempt to load this URL after a call to pushState()ï¼‰ï¼Œè¿™å°±ä¸ºå•é¡µåº”ç”¨å‰ç«¯è·¯ç”±â€œæ›´æ–°è§†å›¾ä½†ä¸é‡æ–°è¯·æ±‚é¡µé¢â€æä¾›äº†åŸºç¡€ã€‚ æˆ‘ä»¬æ¥çœ‹ vue-router ä¸­çš„æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839push (location: RawLocation, onComplete?: Function, onAbort?: Function) &#123; const &#123; current: fromRoute &#125; = this this.transitionTo(location, route =&gt; &#123; pushState(cleanPath(this.base + route.fullPath)) handleScroll(this.router, route, fromRoute, false) onComplete &amp;&amp; onComplete(route) &#125;, onAbort)&#125;replace (location: RawLocation, onComplete?: Function, onAbort?: Function) &#123; const &#123; current: fromRoute &#125; = this this.transitionTo(location, route =&gt; &#123; replaceState(cleanPath(this.base + route.fullPath)) handleScroll(this.router, route, fromRoute, false) onComplete &amp;&amp; onComplete(route) &#125;, onAbort)&#125;// src/util/push-state.jsexport function pushState (url?: string, replace?: boolean) &#123; saveScrollPosition() // try...catch the pushState call to get around Safari // DOM Exception 18 where it limits to 100 pushState calls const history = window.history try &#123; if (replace) &#123; history.replaceState(&#123; key: _key &#125;, '', url) &#125; else &#123; _key = genKey() history.pushState(&#123; key: _key &#125;, '', url) &#125; &#125; catch (e) &#123; window.location[replace ? 'replace' : 'assign'](url) &#125;&#125;export function replaceState (url?: string) &#123; pushState(url, true)&#125; ä»£ç ç»“æ„ä»¥åŠæ›´æ–°è§†å›¾çš„é€»è¾‘ä¸ hash æ¨¡å¼åŸºæœ¬ç±»ä¼¼ï¼Œåªä¸è¿‡å°†å¯¹ window.location.hash ç›´æ¥è¿›è¡Œèµ‹å€¼ window.location.replace()æ”¹ä¸ºäº†è°ƒç”¨ history.pushState()å’Œ history.replaceState()æ–¹æ³•ã€‚ åœ¨ HTML5History ä¸­æ·»åŠ å¯¹ä¿®æ”¹æµè§ˆå™¨åœ°å€æ  URL çš„ç›‘å¬æ˜¯ç›´æ¥åœ¨æ„é€ å‡½æ•°ä¸­æ‰§è¡Œçš„ï¼š1234567891011constructor (router: Router, base: ?string) &#123; window.addEventListener('popstate', e =&gt; &#123; const current = this.current this.transitionTo(getLocation(this.base), route =&gt; &#123; if (expectScroll) &#123; handleScroll(router, route, current, true) &#125; &#125;) &#125;)&#125; å½“ç„¶äº† HTML5History ç”¨åˆ°äº† HTML5 çš„æ–°ç‰¹ç‰¹æ€§ï¼Œæ˜¯éœ€è¦ç‰¹å®šæµè§ˆå™¨ç‰ˆæœ¬çš„æ”¯æŒçš„ï¼Œå‰æ–‡å·²ç»çŸ¥é“ï¼Œæµè§ˆå™¨æ˜¯å¦æ”¯æŒæ˜¯é€šè¿‡å˜é‡ supportsPushState æ¥æ£€æŸ¥çš„ï¼š 1234567891011121314151617// src/util/push-state.jsexport const supportsPushState = inBrowser &amp;&amp; (function() &#123; const ua = window.navigator.userAgent; if ( (ua.indexOf(\"Android 2.\") !== -1 || ua.indexOf(\"Android 4.0\") !== -1) &amp;&amp; ua.indexOf(\"Mobile Safari\") !== -1 &amp;&amp; ua.indexOf(\"Chrome\") === -1 &amp;&amp; ua.indexOf(\"Windows Phone\") === -1 ) &#123; return false; &#125; return window.history &amp;&amp; \"pushState\" in window.history; &#125;)(); è¿™ä¸¤ç§æ¨¡å¼éƒ½æ˜¯é€šè¿‡æµè§ˆå™¨æ¥å£å®ç°çš„ï¼Œé™¤æ­¤ä¹‹å¤– vue-router è¿˜ä¸ºéæµè§ˆå™¨ç¯å¢ƒå‡†å¤‡äº†ä¸€ä¸ª abstract æ¨¡å¼ï¼Œå…¶åŸç†ä¸ºç”¨ä¸€ä¸ªæ•°ç»„ stack æ¨¡æ‹Ÿå‡ºæµè§ˆå™¨å†å²è®°å½•æ ˆçš„åŠŸèƒ½ã€‚ 4.vue ä¸­ä¸¤ç§æ¨¡å¼æ¯”è¾ƒåœ¨ä¸€èˆ¬çš„éœ€æ±‚åœºæ™¯ä¸­ï¼Œhash æ¨¡å¼ä¸ history æ¨¡å¼æ˜¯å·®ä¸å¤šçš„ï¼Œä½†å‡ ä¹æ‰€æœ‰çš„æ–‡ç« éƒ½æ¨èä½¿ç”¨ history æ¨¡å¼ï¼Œç†ç”±ç«Ÿç„¶æ˜¯ï¼šâ€#â€ ç¬¦å·å¤ªä¸‘â€¦0_0 â€œ å¦‚æœä¸æƒ³è¦å¾ˆä¸‘çš„ hashï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è·¯ç”±çš„ history æ¨¡å¼ â€”â€”å®˜æ–¹æ–‡æ¡£ å½“ç„¶ï¼Œä¸¥è°¨çš„æˆ‘ä»¬è‚¯å®šä¸åº”è¯¥ç”¨é¢œå€¼è¯„ä»·æŠ€æœ¯çš„å¥½åã€‚æ ¹æ® MDN çš„ä»‹ç»ï¼Œè°ƒç”¨ history.pushState()ç›¸æ¯”äºç›´æ¥ä¿®æ”¹ hash ä¸»è¦æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š pushState è®¾ç½®çš„æ–° URL å¯ä»¥æ˜¯ä¸å½“å‰ URL åŒæºçš„ä»»æ„ URLï¼›è€Œ hash åªå¯ä¿®æ”¹#åé¢çš„éƒ¨åˆ†ï¼Œæ•…åªå¯è®¾ç½®ä¸å½“å‰åŒæ–‡æ¡£çš„ URL pushState è®¾ç½®çš„æ–° URL å¯ä»¥ä¸å½“å‰ URL ä¸€æ¨¡ä¸€æ ·ï¼Œè¿™æ ·ä¹Ÿä¼šæŠŠè®°å½•æ·»åŠ åˆ°æ ˆä¸­ï¼›è€Œ hash è®¾ç½®çš„æ–°å€¼å¿…é¡»ä¸åŸæ¥ä¸ä¸€æ ·æ‰ä¼šè§¦å‘è®°å½•æ·»åŠ åˆ°æ ˆä¸­ pushState é€šè¿‡ stateObject å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹çš„æ•°æ®åˆ°è®°å½•ä¸­ï¼›è€Œ hash åªå¯æ·»åŠ çŸ­å­—ç¬¦ä¸² pushState å¯é¢å¤–è®¾ç½® title å±æ€§ä¾›åç»­ä½¿ç”¨ a æ ‡ç­¾ hash è·³è½¬ï¼Œä¼šæ”¹å˜é¡µé¢è·¯å¾„çš„ hash å€¼ï¼Œä½†ä¸ä¼šé‡è½½ history æ¨¡å¼çš„ä¸€ä¸ªé—®é¢˜ æˆ‘ä»¬çŸ¥é“å¯¹äºå•é¡µåº”ç”¨æ¥è®²ï¼Œç†æƒ³çš„ä½¿ç”¨åœºæ™¯æ˜¯ä»…åœ¨è¿›å…¥åº”ç”¨æ—¶åŠ è½½ index.htmlï¼Œåç»­åœ¨çš„ç½‘ç»œæ“ä½œé€šè¿‡ Ajax å®Œæˆï¼Œä¸ä¼šæ ¹æ® URL é‡æ–°è¯·æ±‚é¡µé¢ï¼Œä½†æ˜¯éš¾å…é‡åˆ°ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚ç”¨æˆ·ç›´æ¥åœ¨åœ°å€æ ä¸­è¾“å…¥å¹¶å›è½¦ï¼Œæµè§ˆå™¨é‡å¯é‡æ–°åŠ è½½åº”ç”¨ç­‰ã€‚ hash æ¨¡å¼ä»…æ”¹å˜ hash éƒ¨åˆ†çš„å†…å®¹ï¼Œè€Œ hash éƒ¨åˆ†æ˜¯ä¸ä¼šåŒ…å«åœ¨ HTTP è¯·æ±‚ä¸­çš„ï¼š 1http://oursite.com/#/user/id // å¦‚é‡æ–°è¯·æ±‚åªä¼šå‘é€http://oursite.com/ æ•…åœ¨ hash æ¨¡å¼ä¸‹é‡åˆ°æ ¹æ® URL è¯·æ±‚é¡µé¢çš„æƒ…å†µä¸ä¼šæœ‰é—®é¢˜ã€‚ è€Œ history æ¨¡å¼åˆ™ä¼šå°† URL ä¿®æ”¹å¾—å°±å’Œæ­£å¸¸è¯·æ±‚åç«¯çš„ URL ä¸€æ · 1http://oursite.com/user/id åœ¨æ­¤æƒ…å†µä¸‹é‡æ–°å‘åç«¯å‘é€è¯·æ±‚ï¼Œå¦‚åç«¯æ²¡æœ‰é…ç½®å¯¹åº”/user/id çš„è·¯ç”±å¤„ç†ï¼Œåˆ™ä¼šè¿”å› 404 é”™è¯¯ã€‚å®˜æ–¹æ¨èçš„è§£å†³åŠæ³•æ˜¯åœ¨æœåŠ¡ç«¯å¢åŠ ä¸€ä¸ªè¦†ç›–æ‰€æœ‰æƒ…å†µçš„å€™é€‰èµ„æºï¼šå¦‚æœ URL åŒ¹é…ä¸åˆ°ä»»ä½•é™æ€èµ„æºï¼Œåˆ™åº”è¯¥è¿”å›åŒä¸€ä¸ª index.html é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢å°±æ˜¯ä½  app ä¾èµ–çš„é¡µé¢ã€‚åŒæ—¶è¿™ä¹ˆåšä»¥åï¼ŒæœåŠ¡å™¨å°±ä¸å†è¿”å› 404 é”™è¯¯é¡µé¢ï¼Œå› ä¸ºå¯¹äºæ‰€æœ‰è·¯å¾„éƒ½ä¼šè¿”å› index.html æ–‡ä»¶ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåœ¨ Vue åº”ç”¨é‡Œé¢è¦†ç›–æ‰€æœ‰çš„è·¯ç”±æƒ…å†µï¼Œç„¶ååœ¨ç»™å‡ºä¸€ä¸ª 404 é¡µé¢ã€‚æˆ–è€…ï¼Œå¦‚æœæ˜¯ç”¨ Node.js ä½œåå°ï¼Œå¯ä»¥ä½¿ç”¨æœåŠ¡ç«¯çš„è·¯ç”±æ¥åŒ¹é… URLï¼Œå½“æ²¡æœ‰åŒ¹é…åˆ°è·¯ç”±çš„æ—¶å€™è¿”å› 404ï¼Œä»è€Œå®ç° fallbackã€‚ 5.AbstractHistoryâ€˜abstractâ€™æ¨¡å¼ï¼Œä¸æ¶‰åŠå’Œæµè§ˆå™¨åœ°å€çš„ç›¸å…³è®°å½•ï¼Œæµç¨‹è·Ÿâ€™HashHistoryâ€™æ˜¯ä¸€æ ·çš„ï¼Œå…¶åŸç†æ˜¯é€šè¿‡æ•°ç»„æ¨¡æ‹Ÿæµè§ˆå™¨å†å²è®°å½•æ ˆçš„åŠŸèƒ½ 12345678910111213141516171819// å¯¹äº go çš„æ¨¡æ‹Ÿ go (n: number) &#123; // æ–°çš„å†å²è®°å½•ä½ç½® const targetIndex = this.index + n // è¶…å‡ºè¿”å›äº† if (targetIndex &lt; 0 || targetIndex &gt;= this.stack.length) &#123; return &#125; // å–å¾—æ–°çš„ route å¯¹è±¡ // å› ä¸ºæ˜¯å’Œæµè§ˆå™¨æ— å…³çš„ è¿™é‡Œå¾—åˆ°çš„ä¸€å®šæ˜¯å·²ç»è®¿é—®è¿‡çš„ const route = this.stack[targetIndex] // æ‰€ä»¥è¿™é‡Œç›´æ¥è°ƒç”¨ confirmTransition äº† // è€Œä¸æ˜¯è°ƒç”¨ transitionTo è¿˜è¦èµ°ä¸€é match é€»è¾‘ this.confirmTransition(route, () =&gt; &#123; // æ›´æ–° this.index = targetIndex this.updateRoute(route) &#125;) &#125; 6.ç›´æ¥åŠ è½½åº”ç”¨æ–‡ä»¶ Tip: built files are meant to be served over an HTTP server. Opening index.html over file:// wonâ€™t work. Vue é¡¹ç›®é€šè¿‡ vue-cli çš„ webpack æ‰“åŒ…å®Œæˆåï¼Œå‘½ä»¤è¡Œä¼šæœ‰è¿™ä¹ˆä¸€æ®µæç¤ºã€‚é€šå¸¸æƒ…å†µï¼Œæ— è®ºæ˜¯å¼€å‘è¿˜æ˜¯çº¿ä¸Šï¼Œå‰ç«¯é¡¹ç›®éƒ½æ˜¯é€šè¿‡æœåŠ¡å™¨è®¿é—®ï¼Œä¸å­˜åœ¨ â€œOpening index.html over file://â€œ ï¼Œä½†ç¨‹åºå‘˜éƒ½çŸ¥é“ï¼Œéœ€æ±‚å’Œåœºæ™¯æ°¸è¿œæ˜¯åƒå¥‡ç™¾æ€ªçš„ï¼Œåªæœ‰ä½ æƒ³ä¸åˆ°çš„ï¼Œæ²¡æœ‰äº§å“ç»ç†æƒ³ä¸åˆ°çš„ã€‚ æœ¬æ–‡å†™ä½œçš„åˆè¡·å°±æ˜¯é‡åˆ°äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šéœ€è¦å¿«é€Ÿå¼€å‘ä¸€ä¸ªç§»åŠ¨ç«¯çš„å±•ç¤ºé¡¹ç›®ï¼Œå†³å®šé‡‡ç”¨ WebView åŠ è½½ Vue å•é¡µåº”ç”¨çš„å½¢å¼ï¼Œä½†æ²¡æœ‰åç«¯æœåŠ¡å™¨æä¾›ï¼Œæ‰€ä»¥æ‰€æœ‰èµ„æºéœ€ä»æœ¬åœ°æ–‡ä»¶ç³»ç»ŸåŠ è½½ï¼š 123456789101112131415161718192021222324// AndroidAppWrapperpublic class MainActivity extends AppCompatActivity &#123; private WebView webView; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); webView = new WebView(this); webView.getSettings().setJavaScriptEnabled(true); webView.loadUrl(\"file:///android_asset/index.html\"); setContentView(webView); &#125; @Override public boolean onKeyDown(int keyCode, KeyEvent event) &#123; if ((keyCode == KeyEvent.KEYCODE_BACK) &amp;&amp; webView.canGoBack()) &#123; webView.goBack(); return true; &#125; return false; &#125;&#125; æ­¤æƒ…æ­¤æ™¯çœ‹æ¥æ˜¯å¿…é¡» â€œOpening index.html over file://â€œ äº†ï¼Œä¸ºæ­¤ï¼Œæˆ‘é¦–å…ˆè¦è¿›è¡Œäº†ä¸€äº›è®¾ç½® åœ¨é¡¹ç›® config.js æ–‡ä»¶ä¸­å°† assetsPublicPath å­—æ®µçš„å€¼æ”¹ä¸ºç›¸å¯¹è·¯å¾„ â€˜./â€˜ è°ƒæ•´ç”Ÿæˆçš„ static æ–‡ä»¶å¤¹ä¸­å›¾ç‰‡ç­‰é™æ€èµ„æºçš„ä½ç½®ä¸ä»£ç ä¸­çš„å¼•ç”¨åœ°å€ä¸€è‡´ è¿™æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„éœ€è¦æ”¹åŠ¨ä¹‹å¤„ï¼Œä½†æ”¹å®Œåä¾æ—§æ— æ³•é¡ºåˆ©åŠ è½½ï¼Œç»è¿‡åå¤æ’æŸ¥å‘ç°ï¼Œé¡¹ç›®åœ¨å¼€å‘æ—¶ï¼Œrouter è®¾ç½®ä¸ºäº† history æ¨¡å¼ï¼ˆä¸ºäº†ç¾è§‚â€¦0_0â€ï¼‰ï¼Œå½“æ”¹ä¸º hash æ¨¡å¼åå°±å¯æ­£å¸¸åŠ è½½äº†ã€‚ ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿæˆ‘åˆ†æåŸå› å¯èƒ½å¦‚ä¸‹ï¼š å½“ä»æ–‡ä»¶ç³»ç»Ÿä¸­ç›´æ¥åŠ è½½ index.html æ—¶ï¼ŒURL ä¸ºï¼š 1file:///android_asset/index.html è€Œé¦–é¡µè§†å›¾éœ€åŒ¹é…çš„è·¯å¾„ä¸º path: â€˜/â€˜ : 12345678910export default new Router(&#123; mode: \"history\", routes: [ &#123; path: \"/\", name: \"index\", component: IndexView &#125; ]&#125;); æˆ‘ä»¬å…ˆæ¥çœ‹ history æ¨¡å¼ï¼Œåœ¨ HTML5History ä¸­ï¼š 1234567891011121314ensureURL (push?: boolean) &#123; if (getLocation(this.base) !== this.current.fullPath) &#123; const current = cleanPath(this.base + this.current.fullPath) push ? pushState(current) : replaceState(current) &#125;&#125;export function getLocation (base: string): string &#123; let path = window.location.pathname if (base &amp;&amp; path.indexOf(base) === 0) &#123; path = path.slice(base.length) &#125; return (path || '/') + window.location.search + window.location.hash&#125; é€»è¾‘åªä¼šç¡®ä¿å­˜åœ¨ URLï¼Œpath æ˜¯é€šè¿‡å‰ªåˆ‡çš„æ–¹å¼ç›´æ¥ä» window.location.pathname è·å–åˆ°çš„ï¼Œå®ƒçš„ç»“å°¾æ˜¯ index.htmlï¼Œå› æ­¤åŒ¹é…ä¸åˆ° â€˜/â€˜ ï¼Œæ•… â€œOpening index.html over file:// wonâ€™t workâ€ ã€‚ å†çœ‹ hash æ¨¡å¼ï¼Œåœ¨ HashHistory ä¸­ï¼š 123456789101112131415161718192021222324252627282930313233343536export class HashHistory extends History &#123; constructor (router: Router, base: ?string, fallback: boolean) &#123; ... ensureSlash() &#125; // this is delayed until the app mounts // to avoid the hashchange listener being fired too early setupListeners () &#123; window.addEventListener('hashchange', () =&gt; &#123; if (!ensureSlash()) &#123; return &#125; ... &#125;) &#125; getCurrentLocation () &#123; return getHash() &#125;&#125;function ensureSlash (): boolean &#123; const path = getHash() if (path.charAt(0) === '/') &#123; return true &#125; replaceHash('/' + path) return false&#125;export function getHash (): string &#123; const href = window.location.href const index = href.indexOf('#') return index === -1 ? '' : href.slice(index + 1)&#125; æˆ‘ä»¬çœ‹åˆ°åœ¨ä»£ç é€»è¾‘ä¸­ï¼Œå¤šæ¬¡å‡ºç°ä¸€ä¸ªå‡½æ•° ensureSlash()ï¼Œå½“#ç¬¦å·åç´§è·Ÿç€çš„æ˜¯â€™/â€˜ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™å¼ºè¡Œæ’å…¥è¿™ä¸ªâ€™/â€˜ï¼Œæ•…æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿æ˜¯ä»æ–‡ä»¶ç³»ç»Ÿæ‰“å¼€ index.htmlï¼ŒURL ä¾æ—§ä¼šå˜ä¸ºä»¥ä¸‹å½¢å¼ï¼š 1file:///C:/Users/dist/index.html#/ getHash()æ–¹æ³•è¿”å›çš„ path ä¸º â€˜/â€˜ ï¼Œå¯ä¸é¦–é¡µè§†å›¾çš„è·¯ç”±åŒ¹é…ã€‚ æ•…è¦æƒ³ä»æ–‡ä»¶ç³»ç»Ÿç›´æ¥åŠ è½½ Vue å•é¡µåº”ç”¨è€Œä¸å€ŸåŠ©åç«¯æœåŠ¡å™¨ï¼Œé™¤äº†æ‰“åŒ…åçš„ä¸€äº›è·¯å¾„è®¾ç½®å¤–ï¼Œè¿˜éœ€ç¡®ä¿ vue-router ä½¿ç”¨çš„æ˜¯ hash æ¨¡å¼ã€‚ React Routerreact-router æ˜¯åŸºäº history æ¨¡å—æä¾›çš„ api è¿›è¡Œå¼€å‘çš„ã€‚å…¶è·¯ç”±é…ç½®æ˜¯é€šè¿‡ react component æ–¹å¼è¿›è¡Œçš„ï¼Œè·¯ç”±æ›´æ”¹è§¦å‘çš„å›è°ƒå‡½æ•°æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„æ“ä½œ DOM çš„å‡½æ•°ï¼›åœ¨ react ä¸­æˆ‘ä»¬ä¸ç›´æ¥æ“ä½œ DOMï¼Œè€Œæ˜¯ç®¡ç†æŠ½è±¡å‡ºæ¥çš„ VDOM æˆ–è€…è¯´ JSXï¼Œå¯¹ react çš„æ¥è¯´è·¯ç”±éœ€è¦ç®¡ç†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯¹ä¸åŒçš„è·¯ç”±æ¸²æŸ“ä¸åŒçš„ç»„ä»¶ã€‚ å¦‚ä¸‹ï¼š 1234567891011121314render(( &lt;Router history=&#123;browserHistory&#125;&gt; &lt;Route path=&quot;/&quot; component=&#123;App&#125;&gt; &lt;Route path=&quot;about&quot; component=&#123;About&#125;/&gt; &lt;Route path=&quot;users&quot; component=&#123;Users&#125;&gt; &lt;Route path=&quot;/user/:userId&quot; component=&#123;User&#125;/&gt; &lt;/Route&gt; &lt;Route path=&quot;*&quot; component=&#123;NoMatch&#125;/&gt; &lt;/Route&gt; &lt;/Router&gt;), document.body)// link è§¦å‘è·¯ç”±&lt;Link to=&#123;`/user/89757`&#125;&gt;&apos;joey&apos;&lt;/Link&gt; ä»¥ä¸Šå£°æ˜äº†ä¸€ä»½å«æœ‰ path to component çš„å„ä¸ªæ˜ å°„çš„è·¯ç”±è¡¨ã€‚Router åœ¨ react ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„é’©å­ componentWillMount ï¼ˆç»„ä»¶è¢«æŒ‚è½½å‰ï¼‰ä¸­ï¼Œä½¿ç”¨ this.history.listen å»æ³¨å†Œäº† url æ›´æ–°çš„å›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°å°†åœ¨ url æ›´æ–°æ—¶è§¦å‘ï¼Œå›è°ƒä¸­çš„ setState ä¼šå» render æ–°çš„ componentã€‚ 1.historyhistory åº“ï¼Œæ˜¯ rr4 ä¾èµ–çš„ä¸€ä¸ªå¯¹ window.history åŠ å¼ºç‰ˆçš„ history åº“ã€‚ matchæºè‡ª history åº“ï¼Œè¡¨ç¤ºå½“å‰çš„ URL ä¸ path çš„åŒ¹é…çš„ç»“æœ 123456match: &#123; path: &quot;/&quot;, // ç”¨æ¥åŒ¹é…çš„ path url: &quot;/&quot;, // å½“å‰çš„ URL params: &#123;&#125;, // è·¯å¾„ä¸­çš„å‚æ•° isExact: pathname === &quot;/&quot; // æ˜¯å¦ä¸ºä¸¥æ ¼åŒ¹é…&#125; locationè¿˜æ˜¯æºè‡ª history åº“ï¼Œæ˜¯ history åº“åŸºäº window.location çš„ä¸€ä¸ªè¡ç”Ÿã€‚ 12345hash: &quot;&quot; // hashkey: &quot;nyi4ea&quot; // ä¸€ä¸ª uuidpathname: &quot;/explore&quot; // URL ä¸­è·¯å¾„éƒ¨åˆ†search: &quot;&quot; // URL å‚æ•°state: undefined // è·¯ç”±è·³è½¬æ—¶ä¼ é€’çš„ state æˆ‘ä»¬å¸¦ç€é—®é¢˜å»åˆ†ææºç ï¼Œå…ˆé€ä¸ªåˆ†ææ¯ä¸ªç»„ä»¶çš„ä½œç”¨ï¼Œåœ¨æœ€åä¼šæœ‰å›ç­”ï¼Œåœ¨è¿™é‡Œå…ˆä¸¾ä¸€ä¸ª rr4 çš„å° DEMO é¡µé¢åˆå§‹åŒ–æ—¶çš„æ¸²æŸ“è¿‡ç¨‹ï¼Ÿ ç‚¹å‡»ä¸€ä¸ª Link è·³è½¬åŠæ¸²æŸ“æ›´æ–°çš„è¿‡ç¨‹ï¼Ÿ 2.packagesrr4 å°†è·¯ç”±æ‹†æˆäº†å‡ ä¸ªåŒ…ï¼š react-router è´Ÿè´£é€šç”¨çš„è·¯ç”±é€»è¾‘ react-router-dom è´Ÿè´£æµè§ˆå™¨çš„è·¯ç”±ç®¡ç† react-router-native è´Ÿè´£ react-native çš„è·¯ç”±ç®¡ç† é€šç”¨çš„éƒ¨åˆ†ç›´æ¥ä» react-router ä¸­å¯¼å…¥ï¼Œç”¨æˆ·åªéœ€å¼•å…¥ react-router-dom æˆ– react-router-native å³å¯ï¼Œreact-router ä½œä¸ºä¾èµ–å­˜åœ¨ä¸å†éœ€è¦å•ç‹¬å¼•å…¥ã€‚ Router123456789101112import React from &apos;react&apos;import &#123; render &#125; from &apos;react-dom&apos;import &#123; BrowserRouter &#125; from &apos;react-router-dom&apos;import App from &apos;./components/App&apos;;render()&#123; return( &lt;BrowserRouter&gt; &lt;App /&gt; &lt;/BrowserRouter&gt; ))&#125; è¿™æ˜¯æˆ‘ä»¬è°ƒç”¨ Router çš„æ–¹å¼ï¼Œè¿™é‡Œæ‹¿ BrowserRouter æ¥ä¸¾ä¾‹ã€‚ BrowserRouter çš„æºç åœ¨ react-router-dom ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œåœ¨å†…éƒ¨åˆ›å»ºä¸€ä¸ªå…¨å±€çš„ history å¯¹è±¡ï¼ˆå¯ä»¥ç›‘å¬æ•´ä¸ªè·¯ç”±çš„å˜åŒ–ï¼‰ï¼Œå¹¶å°† history ä½œä¸º props ä¼ é€’ç»™ react-router çš„ Router ç»„ä»¶ï¼ˆRouter ç»„ä»¶å†ä¼šå°†è¿™ä¸ª history çš„å±æ€§ä½œä¸º context ä¼ é€’ç»™å­ç»„ä»¶ï¼‰ 123render() &#123; return &lt;Router history=&#123;this.history&#125; children=&#123;this.props.children&#125; /&gt;;&#125; æ•´ä¸ª Router çš„æ ¸å¿ƒæ˜¯åœ¨ react-router çš„ Router ç»„ä»¶ä¸­ï¼Œå¦‚ä¸‹ï¼Œå€ŸåŠ© context å‘ Route ä¼ é€’ç»„ä»¶ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆ Router è¦åœ¨æ‰€æœ‰ Route çš„å¤–é¢ã€‚ 123456789101112getChildContext() &#123; return &#123; router: &#123; ...this.context.router, history: this.props.history, route: &#123; location: this.props.history.location, match: this.state.match &#125; &#125; &#125;;&#125; è¿™æ˜¯ Router ä¼ é€’ç»™å­ç»„ä»¶çš„ contextï¼Œäº‹å®ä¸Š Route ä¹Ÿä¼šå°† router ä½œä¸º context å‘ä¸‹ä¼ é€’ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ Route æ¸²æŸ“çš„ç»„ä»¶ä¸­åŠ å…¥ 1234567static contextTypes = &#123; router: PropTypes.shape(&#123; history: PropTypes.object.isRequired, route: PropTypes.object.isRequired, staticContext: PropTypes.object &#125;)&#125;; æ¥é€šè¿‡ context è®¿é—® routerï¼Œä¸è¿‡ rr4 ä¸€èˆ¬é€šè¿‡ props ä¼ é€’ï¼Œå°† history, location, match ä½œä¸ºä¸‰ä¸ªç‹¬ç«‹çš„ props ä¼ é€’ç»™è¦æ¸²æŸ“çš„ç»„ä»¶ï¼Œè¿™æ ·è®¿é—®èµ·æ¥æ–¹ä¾¿ä¸€ç‚¹ï¼ˆå®é™…ä¸Šå·²ç»å®Œå…¨å°† router å¯¹è±¡çš„å±æ€§å®Œå…¨ä¼ é€’äº†ï¼‰ã€‚ åœ¨ Router çš„ componentWillMount ä¸­ï¼Œ æ·»åŠ äº† 1234567891011121314151617componentWillMount() &#123; const &#123; children, history &#125; = this.props; invariant( children == null || React.Children.count(children) === 1, &quot;A &lt;Router&gt; may have only one child element&quot; ); // Do this here so we can setState when a &lt;Redirect&gt; changes the // location in componentWillMount. This happens e.g. when doing // server rendering using a &lt;sStaticRouter&gt;. this.unlisten = history.listen(() =&gt; &#123; this.setState(&#123; match: this.computeMatch(history.location.pathname) &#125;); &#125;);&#125; history.listen èƒ½å¤Ÿç›‘å¬è·¯ç”±çš„å˜åŒ–å¹¶æ‰§è¡Œå›è°ƒäº‹ä»¶ã€‚ åœ¨è¿™é‡Œæ¯æ¬¡è·¯ç”±çš„å˜åŒ–æ‰§è¡Œçš„å›è°ƒäº‹ä»¶ä¸º 123this.setState(&#123; match: this.computeMatch(history.location.pathname)&#125;); ç›¸æ¯”äºåœ¨ setState é‡Œåšçš„æ“ä½œï¼ŒsetState æœ¬èº«çš„æ„ä¹‰æ›´å¤§ â€”â€” æ¯æ¬¡è·¯ç”±å˜åŒ– -&gt; è§¦å‘é¡¶å±‚ Router çš„å›è°ƒäº‹ä»¶ -&gt; Router è¿›è¡Œ setState -&gt; å‘ä¸‹ä¼ é€’ nextContextï¼ˆcontext ä¸­å«æœ‰æœ€æ–°çš„ locationï¼‰-&gt; ä¸‹é¢çš„ Route è·å–æ–°çš„ nextContext åˆ¤æ–­æ˜¯å¦è¿›è¡Œæ¸²æŸ“ã€‚ ä¹‹æ‰€ä»¥æŠŠè¿™ä¸ª subscribe çš„å‡½æ•°å†™åœ¨ componentWillMount é‡Œï¼Œå°±åƒæºç ä¸­ç»™å‡ºçš„æ³¨é‡Šï¼šæ˜¯ä¸ºäº† SSR çš„æ—¶å€™ï¼Œèƒ½å¤Ÿä½¿ç”¨ Redirectã€‚ RouteRoute çš„ä½œç”¨æ˜¯åŒ¹é…è·¯ç”±ï¼Œå¹¶ä¼ é€’ç»™è¦æ¸²æŸ“çš„ç»„ä»¶ propsã€‚ åœ¨ Route çš„ componentWillReceiveProps ä¸­ 123456componentWillReceiveProps(nextProps, nextContext) &#123; ... this.setState(&#123; match: this.computeMatch(nextProps, nextContext.router) &#125;);&#125; Route æ¥å—ä¸Šå±‚çš„ Router ä¼ å…¥çš„ contextï¼ŒRouter ä¸­çš„ history ç›‘å¬ç€æ•´ä¸ªé¡µé¢çš„è·¯ç”±å˜åŒ–ï¼Œå½“é¡µé¢å‘ç”Ÿè·³è½¬æ—¶ï¼Œhistory è§¦å‘ç›‘å¬äº‹ä»¶ï¼ŒRouter å‘ä¸‹ä¼ é€’ nextContextï¼Œå°±ä¼šæ›´æ–° Route çš„ props å’Œ context æ¥åˆ¤æ–­å½“å‰ Route çš„ path æ˜¯å¦åŒ¹é… locationï¼Œå¦‚æœåŒ¹é…åˆ™æ¸²æŸ“ï¼Œå¦åˆ™ä¸æ¸²æŸ“ã€‚ æ˜¯å¦åŒ¹é…çš„ä¾æ®å°±æ˜¯ computeMatch è¿™ä¸ªå‡½æ•°ï¼Œåœ¨ä¸‹æ–‡ä¼šæœ‰åˆ†æï¼Œè¿™é‡Œåªéœ€è¦çŸ¥é“åŒ¹é…å¤±è´¥åˆ™ match ä¸º nullï¼Œå¦‚æœåŒ¹é…æˆåŠŸåˆ™å°† match çš„ç»“æœä½œä¸º props çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ render ä¸­ä¼ é€’ç»™ä¼ è¿›æ¥çš„è¦æ¸²æŸ“çš„ç»„ä»¶ã€‚ æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ Route çš„ render éƒ¨åˆ†ã€‚ 123456789101112131415161718render() &#123; const &#123; match &#125; = this.state; // å¸ƒå°”å€¼ï¼Œè¡¨ç¤º location æ˜¯å¦åŒ¹é…å½“å‰ Route çš„ path const &#123; children, component, render &#125; = this.props; // Route æä¾›çš„ä¸‰ç§å¯é€‰çš„æ¸²æŸ“æ–¹å¼ const &#123; history, route, staticContext &#125; = this.context.router; // Router ä¼ å…¥çš„ context const location = this.props.location || route.location; const props = &#123; match, location, history, staticContext &#125;; if (component) return match ? React.createElement(component, props) : null; // Component åˆ›å»º if (render) return match ? render(props) : null; // render åˆ›å»º if (typeof children === &quot;function&quot;) return children(props); // å›è°ƒ children åˆ›å»º if (children &amp;&amp; !isEmptyChildren(children)) // æ™®é€š children åˆ›å»º return React.Children.only(children); return null;&#125; rr4 æä¾›äº†ä¸‰ç§æ¸²æŸ“ç»„ä»¶çš„æ–¹æ³•ï¼šcomponent propsï¼Œrender props å’Œ children propsï¼Œæ¸²æŸ“çš„ä¼˜å…ˆçº§ä¹Ÿæ˜¯ä¾æ¬¡æŒ‰ç…§é¡ºåºï¼Œå¦‚æœå‰é¢çš„å·²ç»æ¸²æŸ“åäº†ï¼Œå°†ä¼šç›´æ¥ returnã€‚ component (props) â€”â€” ç”±äºä½¿ç”¨ React.createElement åˆ›å»ºï¼Œæ‰€ä»¥å¯ä»¥ä¼ å…¥ä¸€ä¸ª class componentã€‚ render (props) â€”â€” ç›´æ¥è°ƒç”¨ render() å±•å¼€å­å…ƒç´ ï¼Œæ‰€ä»¥éœ€è¦ä¼ å…¥ stateless function componentã€‚ children (props) â€”â€” å…¶å®å’Œ render å·®ä¸å¤šï¼ŒåŒºåˆ«æ˜¯ä¸åˆ¤æ–­ matchï¼Œæ€»æ˜¯ä¼šè¢«æ¸²æŸ“ã€‚ childrenï¼ˆå­å…ƒç´ ï¼‰â€”â€” å¦‚æœä»¥ä¸Šéƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆä¼šé»˜è®¤æ¸²æŸ“å­å…ƒç´ ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªå­å…ƒç´ ã€‚ è¿™é‡Œè§£é‡Šä¸€ä¸‹å®˜ç½‘çš„ tipsï¼Œcomponent æ˜¯ä½¿ç”¨ React.createElement æ¥åˆ›å»ºæ–°çš„å…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœä¼ å…¥ä¸€ä¸ªå†…è”å‡½æ•°ï¼Œæ¯”å¦‚ 1&lt;Route path=&apos;/&apos; component=&#123;()=&gt;(&lt;div&gt;hello world&lt;/div&gt;)&#125; çš„è¯ï¼Œç”±äºæ¯æ¬¡çš„ props.component éƒ½æ˜¯æ–°åˆ›å»ºçš„ï¼Œæ‰€ä»¥ React åœ¨ diff çš„æ—¶å€™ä¼šè®¤ä¸ºè¿›æ¥äº†ä¸€ä¸ªå…¨æ–°çš„ç»„ä»¶ï¼Œæ‰€ä»¥ä¼šå°†æ—§çš„ç»„ä»¶ unmountï¼Œå† re-mountã€‚è¿™æ—¶å€™å°±è¦ä½¿ç”¨ renderï¼Œå°‘äº†ä¸€å±‚åŒ…è£¹çš„ component å…ƒç´ ï¼Œrender å±•å¼€åçš„å…ƒç´ ç±»å‹æ¯æ¬¡éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå°±ä¸ä¼šå‘ç”Ÿ re-mount äº†ï¼ˆchildren ä¹Ÿä¸ä¼šå‘ç”Ÿ re-mountï¼‰ã€‚ Switchæˆ‘ä»¬ç´§æ¥ç€ Route æ¥çœ‹ Switchï¼ŒSwitch æ˜¯ç”¨æ¥åµŒå¥—åœ¨ Route çš„å¤–é¢ï¼Œå½“ Switch ä¸­çš„ç¬¬ä¸€ä¸ª Route åŒ¹é…ä¹‹åå°±ä¸ä¼šå†æ¸²æŸ“å…¶ä»–çš„ Route äº†ã€‚ 123456789101112131415161718192021222324252627282930render() &#123; const &#123; route &#125; = this.context.router; const &#123; children &#125; = this.props; const location = this.props.location || route.location; let match, child; React.Children.forEach(children, element =&gt; &#123; if (match == null &amp;&amp; React.isValidElement(element)) &#123; const &#123; path: pathProp, exact, strict, sensitive, from &#125; = element.props; const path = pathProp || from; child = element; match = matchPath( location.pathname, &#123; path, exact, strict, sensitive &#125;, route.match ); &#125; &#125;); return match ? React.cloneElement(child, &#123; location, computedMatch: match &#125;) : null;&#125; Switch ä¹Ÿæ˜¯é€šè¿‡ matchPath è¿™ä¸ªå‡½æ•°æ¥åˆ¤æ–­æ˜¯å¦åŒ¹é…æˆåŠŸï¼Œä¸€ç›´æŒ‰ç…§ Switch ä¸­ children çš„é¡ºåºä¾æ¬¡éå†å­å…ƒç´ ï¼Œå¦‚æœåŒ¹é…å¤±è´¥åˆ™ match ä¸º nullï¼Œå¦‚æœåŒ¹é…æˆåŠŸåˆ™æ ‡è®°è¿™ä¸ªå­å…ƒç´ å’Œå®ƒå¯¹åº”çš„ locationã€computedMatchã€‚åœ¨æœ€åçš„æ—¶å€™ä½¿ç”¨ React.cloneElement æ¸²æŸ“ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…åˆ°çš„å­å…ƒç´ åˆ™è¿”å› nullã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹ matchPath æ˜¯å¦‚ä½•åˆ¤æ–­ location æ˜¯å¦ç¬¦åˆ path çš„ã€‚ matchPathmatchPath è¿”å›çš„æ˜¯ä¸€ä¸ªå¦‚ä¸‹ç»“æ„çš„å¯¹è±¡ 123456789101112&#123; path, // ç”¨æ¥è¿›è¡ŒåŒ¹é…çš„è·¯å¾„ï¼Œå…¶å®æ˜¯ç›´æ¥å¯¼å‡ºçš„ä¼ å…¥ matchPath çš„ options ä¸­çš„ path url: path === &quot;/&quot; &amp;&amp; url === &quot;&quot; ? &quot;/&quot; : url, // æ•´ä¸ªçš„ URL isExact, // url ä¸ path æ˜¯å¦æ˜¯ exact çš„åŒ¹é… // è¿”å›çš„æ˜¯ä¸€ä¸ªé”®å€¼å¯¹çš„æ˜ å°„ // æ¯”å¦‚ä½ çš„ path æ˜¯ /users/:idï¼Œç„¶ååŒ¹é…çš„ pathname æ˜¯ /user/123 // é‚£ä¹ˆ params çš„è¿”å›å€¼å°±æ˜¯ &#123;id: &apos;123&apos;&#125; params: keys.reduce((memo, key, index) =&gt; &#123; memo[key.name] = values[index]; return memo; &#125;, &#123;&#125;) &#125; è¿™äº›ä¿¡æ¯å°†ä½œä¸ºåŒ¹é…çš„å‚æ•°ä¼ é€’ç»™ Route å’Œ Switchï¼ˆSwitch åªæ˜¯ä¸€ä¸ªä»£ç†ï¼Œå®ƒçš„ä½œç”¨è¿˜æ˜¯æ¸²æŸ“ Routeï¼ŒSwitch è®¡ç®—å¾—åˆ°çš„ computedMatch ä¼šä¼ é€’ç»™è¦æ¸²æŸ“çš„ Routeï¼Œæ­¤æ—¶ Route å°†ç›´æ¥ä½¿ç”¨è¿™ä¸ª computedMatch è€Œä¸éœ€è¦å†è‡ªå·±æ¥è®¡ç®—ï¼‰ã€‚ åœ¨ matchPath å†…éƒ¨ compilePath æ—¶ï¼Œæœ‰ä¸ª 123const patternCache = &#123;&#125;;const cacheLimit = 10000;let cacheCount = 0; ä½œä¸º pathToRegexp çš„ç¼“å­˜ï¼Œå› ä¸º ES6 çš„ import æ¨¡å—å¯¼å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œæ‰€ä»¥å°† patternCache å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå…¨å±€å˜é‡ç¼“å­˜ï¼Œç¼“å­˜ä»¥ {option:{pattern: }} çš„å½¢å¼å­˜å‚¨ï¼Œä¹‹åå¦‚æœéœ€è¦åŒ¹é…ç›¸åŒ pattern å’Œ option çš„ pathï¼Œåˆ™å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å¾—æ­£åˆ™è¡¨è¾¾å¼å’Œ keysã€‚ åŠ ç¼“å­˜çš„åŸå› æ˜¯è·¯ç”±é¡µé¢å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œæ¯”å¦‚è¦è®¿é—® /user/123 æˆ– /users/234ï¼Œéƒ½ä¼šä½¿ç”¨ /user/:id è¿™ä¸ª path å»åŒ¹é…ï¼Œæ²¡æœ‰å¿…è¦æ¯æ¬¡éƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚SPA åœ¨é¡µé¢æ•´ä¸ªè®¿é—®çš„è¿‡ç¨‹ä¸­éƒ½ç»´æŠ¤ç€è¿™ä»½ç¼“å­˜ã€‚ Linkå®é™…ä¸Šæˆ‘ä»¬å¯èƒ½å†™çš„æœ€å¤šçš„å°±æ˜¯ Link è¿™ä¸ªæ ‡ç­¾äº†ï¼Œæˆ‘ä»¬ä»å®ƒçš„ render å‡½æ•°å¼€å§‹çœ‹ 12345678910111213141516171819202122render() &#123; const &#123; replace, to, innerRef, ...props &#125; = this.props; // eslint-disable-line no-unused-vars invariant( this.context.router, &quot;You should not use &lt;Link&gt; outside a &lt;Router&gt;&quot; ); invariant(to !== undefined, &apos;You must specify the &quot;to&quot; property&apos;); const &#123; history &#125; = this.context.router; const location = typeof to === &quot;string&quot; ? createLocation(to, null, null, history.location) : to; const href = history.createHref(location); // æœ€ç»ˆåˆ›å»ºçš„æ˜¯ä¸€ä¸ª a æ ‡ç­¾ return ( &lt;a &#123;...props&#125; onClick=&#123;this.handleClick&#125; href=&#123;href&#125; ref=&#123;innerRef&#125; /&gt; ); &#125; å¯ä»¥çœ‹åˆ°Link æœ€ç»ˆè¿˜æ˜¯åˆ›å»ºä¸€ä¸ª a æ ‡ç­¾æ¥åŒ…è£¹ä½è¦è·³è½¬çš„å…ƒç´ ï¼Œä½†æ˜¯å¦‚æœåªæ˜¯ä¸€ä¸ªæ™®é€šçš„å¸¦ href çš„ a æ ‡ç­¾ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢è€Œä¸æ˜¯ SPA äº†ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ª a æ ‡ç­¾çš„ handleClick ä¸­ä¼š preventDefault ç¦æ­¢é»˜è®¤çš„è·³è½¬ï¼Œæ‰€ä»¥è¿™é‡Œçš„ href å¹¶æ²¡æœ‰å®é™…çš„ä½œç”¨ï¼Œä½†ä»ç„¶å¯ä»¥æ ‡ç¤ºå‡ºè¦è·³è½¬åˆ°çš„é¡µé¢çš„ URL å¹¶ä¸”æœ‰æ›´å¥½çš„ html è¯­ä¹‰ã€‚ åœ¨ handleClick ä¸­ï¼Œå¯¹æ²¡æœ‰è¢« â€œpreventDefault çš„ &amp;&amp; é¼ æ ‡å·¦é”®ç‚¹å‡»çš„ &amp;&amp; é _blank è·³è½¬ çš„&amp;&amp; æ²¡æœ‰æŒ‰ä½å…¶ä»–åŠŸèƒ½é”®çš„â€œ å•å‡»è¿›è¡Œ preventDefaultï¼Œç„¶å push è¿› history ä¸­ï¼Œè¿™ä¹Ÿæ˜¯å‰é¢è®²è¿‡çš„ â€”â€” è·¯ç”±çš„å˜åŒ– ä¸ é¡µé¢çš„è·³è½¬ æ˜¯ä¸äº’ç›¸å…³è”çš„ï¼Œrr4 åœ¨ Link ä¸­é€šè¿‡ history åº“çš„ push è°ƒç”¨äº† HTML5 history çš„ pushStateï¼Œä½†æ˜¯è¿™ä»…ä»…ä¼šè®©è·¯ç”±å˜åŒ–ï¼Œå…¶ä»–ä»€ä¹ˆéƒ½æ²¡æœ‰æ”¹å˜ã€‚è¿˜è®°ä¸è®°å¾— Router ä¸­çš„ listenï¼Œå®ƒä¼šç›‘å¬è·¯ç”±çš„å˜åŒ–ï¼Œç„¶åé€šè¿‡ context æ›´æ–° props å’Œ nextContext è®©ä¸‹å±‚çš„ Route å»é‡æ–°åŒ¹é…ï¼Œå®Œæˆéœ€è¦æ¸²æŸ“éƒ¨åˆ†çš„æ›´æ–°ã€‚ 123456789101112131415161718192021handleClick = event =&gt; &#123; if (this.props.onClick) this.props.onClick(event); if ( !event.defaultPrevented &amp;&amp; // onClick prevented default event.button === 0 &amp;&amp; // ignore everything but left clicks !this.props.target &amp;&amp; // let browser handle &quot;target=_blank&quot; etc. !isModifiedEvent(event) // ignore clicks with modifier keys ) &#123; event.preventDefault(); const &#123; history &#125; = this.context.router; const &#123; replace, to &#125; = this.props; if (replace) &#123; history.replace(to); &#125; else &#123; history.push(to); &#125; &#125;&#125;; withRouter1234567891011121314151617181920212223242526const withRouter = Component =&gt; &#123; const C = props =&gt; &#123; const &#123; wrappedComponentRef, ...remainingProps &#125; = props; return ( &lt;Route children=&#123;routeComponentProps =&gt; ( &lt;Component &#123;...remainingProps&#125; &#123;...routeComponentProps&#125; ref=&#123;wrappedComponentRef&#125; /&gt; )&#125; /&gt; ); &#125;; C.displayName = `withRouter($&#123;Component.displayName || Component.name&#125;)`; C.WrappedComponent = Component; C.propTypes = &#123; wrappedComponentRef: PropTypes.func &#125;; return hoistStatics(C, Component);&#125;;export default withRouter; withRouter çš„ä½œç”¨æ˜¯è®©æˆ‘ä»¬åœ¨æ™®é€šçš„éç›´æ¥åµŒå¥—åœ¨ Route ä¸­çš„ç»„ä»¶ä¹Ÿèƒ½è·å¾—è·¯ç”±çš„ä¿¡æ¯ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±è¦ WithRouter(wrappedComponent) æ¥åˆ›å»ºä¸€ä¸ª HOC ä¼ é€’ propsï¼ŒWithRouter çš„å…¶å®å°±æ˜¯ç”¨ Route åŒ…è£¹äº† SomeComponent çš„ä¸€ä¸ª HOCã€‚ åˆ›å»º Route æœ‰ä¸‰ç§æ–¹æ³•ï¼Œè¿™é‡Œç›´æ¥é‡‡ç”¨äº†ä¼ é€’ children props çš„æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ª HOC è¦åŸå°ä¸åŠ¨çš„æ¸²æŸ“ wrappedComponentï¼ˆchildren props æ¯”è¾ƒå°‘ç”¨å¾—åˆ°ï¼ŒæŸç§ç¨‹åº¦ä¸Šæ˜¯ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ï¼‰ã€‚ åœ¨æœ€åè¿”å› HOC æ—¶ï¼Œä½¿ç”¨äº† hoistStatics è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯ä¿ç•™ SomeComponent ç±»çš„é™æ€æ–¹æ³•ï¼Œå› ä¸º HOC æ˜¯åœ¨ wrappedComponent çš„å¤–å±‚åˆåŒ…äº†ä¸€å±‚ Routeï¼Œæ‰€ä»¥è¦å°† wrappedComponent ç±»çš„é™æ€æ–¹æ³•è½¬ç§»ç»™æ–°çš„ Routeï¼Œå…·ä½“å‚è§ Static Methods Must Be Copied Overã€‚ 3.ç†è§£ç°åœ¨å›åˆ°ä¸€å¼€å§‹çš„é—®é¢˜ï¼Œé‡æ–°ç†è§£ä¸€ä¸‹ç‚¹å‡»ä¸€ä¸ª Link è·³è½¬çš„è¿‡ç¨‹ã€‚ æœ‰ä¸¤ä»¶äº‹éœ€è¦å®Œæˆï¼š è·¯ç”±çš„æ”¹å˜ é¡µé¢çš„æ¸²æŸ“éƒ¨åˆ†çš„æ”¹å˜ è¿‡ç¨‹å¦‚ä¸‹ï¼š åœ¨æœ€ä¸€å¼€å§‹ mount Router çš„æ—¶å€™ï¼ŒRouter åœ¨ componentWillMount ä¸­ listen äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç”± history åº“ç®¡ç†ï¼Œè·¯ç”±æ¯æ¬¡æ”¹å˜çš„æ—¶å€™è§¦å‘è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°ä¼šè§¦å‘ setStateã€‚ å½“ç‚¹å‡» Link æ ‡ç­¾çš„æ—¶å€™ï¼Œå®é™…ä¸Šç‚¹å‡»çš„æ˜¯é¡µé¢ä¸Šæ¸²æŸ“å‡ºæ¥çš„ a æ ‡ç­¾ï¼Œç„¶åé€šè¿‡ preventDefault é˜»æ­¢ a æ ‡ç­¾çš„é¡µé¢è·³è½¬ã€‚ Link ä¸­ä¹Ÿèƒ½æ‹¿åˆ° Router -&gt; Route ä¸­é€šè¿‡ context ä¼ é€’çš„ historyï¼Œæ‰§è¡Œ hitsory.push(to)ï¼Œè¿™ä¸ªå‡½æ•°å®é™…ä¸Šå°±æ˜¯åŒ…è£…äº†ä¸€ä¸‹ window.history.pushState()ï¼Œæ˜¯ HTML5 history çš„ APIï¼Œä½†æ˜¯ pushState ä¹‹åé™¤äº†åœ°å€æ æœ‰å˜åŒ–å…¶ä»–æ²¡æœ‰ä»»ä½•å½±å“ï¼Œåˆ°è¿™ä¸€æ­¥å·²ç»å®Œæˆäº†ç›®æ ‡ 1ï¼šè·¯ç”±çš„æ”¹å˜ã€‚ ç¬¬ 1 æ­¥ä¸­ï¼Œè·¯ç”±æ”¹å˜æ˜¯ä¼šè§¦å‘ Router çš„ setState çš„ï¼Œåœ¨ Router é‚£ç« æœ‰å†™é“ï¼šæ¯æ¬¡è·¯ç”±å˜åŒ– -&gt; è§¦å‘é¡¶å±‚ Router çš„ç›‘å¬äº‹ä»¶ -&gt; Router è§¦å‘ setState -&gt; å‘ä¸‹ä¼ é€’æ–°çš„ nextContextï¼ˆnextContext ä¸­å«æœ‰æœ€æ–°çš„ locationï¼‰ ä¸‹å±‚çš„ Route æ‹¿åˆ°æ–°çš„ nextContext é€šè¿‡ matchPath å‡½æ•°æ¥åˆ¤æ–­ path æ˜¯å¦ä¸ location åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ™æ¸²æŸ“ï¼Œä¸åŒ¹é…åˆ™ä¸æ¸²æŸ“ï¼Œå®Œæˆç›®æ ‡ 2ï¼šé¡µé¢çš„æ¸²æŸ“éƒ¨åˆ†çš„æ”¹å˜ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://yoursite.com/categories/å‰ç«¯/"}],"tags":[{"name":"React","slug":"React","permalink":"http://yoursite.com/tags/React/"},{"name":"VUE","slug":"VUE","permalink":"http://yoursite.com/tags/VUE/"},{"name":"è·¯ç”±","slug":"è·¯ç”±","permalink":"http://yoursite.com/tags/è·¯ç”±/"}]},{"title":"leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”å›æº¯é—®é¢˜","slug":"leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”å›æº¯é—®é¢˜","date":"2019-01-15T14:07:43.000Z","updated":"2019-11-10T14:37:39.026Z","comments":true,"path":"2019/01/15/leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”å›æº¯é—®é¢˜/","link":"","permalink":"http://yoursite.com/2019/01/15/leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”å›æº¯é—®é¢˜/","excerpt":"è¯¥ç¬”è®°åªä¸ºä¸ªäººæ‰€å†™ç®—æ³•ï¼Œä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£æ³•ï¼Œä»…ä¾›å‚è€ƒ [17] Letter Combinations of a Phone NumberGiven a string containing digits from 2-9 inclusive, return all possible letter combinations that the number could represent.A mapping of digit to letters (just like on the telephone buttons) is given below. Note that 1 does not map to any letters.Note:Although the above answer is in lexicographical order, your answer could be in any order you want.éš¾åº¦ï¼šMedium (40.58%)è€ƒç‚¹ï¼šå›æº¯","text":"è¯¥ç¬”è®°åªä¸ºä¸ªäººæ‰€å†™ç®—æ³•ï¼Œä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£æ³•ï¼Œä»…ä¾›å‚è€ƒ [17] Letter Combinations of a Phone NumberGiven a string containing digits from 2-9 inclusive, return all possible letter combinations that the number could represent.A mapping of digit to letters (just like on the telephone buttons) is given below. Note that 1 does not map to any letters.Note:Although the above answer is in lexicographical order, your answer could be in any order you want.éš¾åº¦ï¼šMedium (40.58%)è€ƒç‚¹ï¼šå›æº¯ 123456789101112131415161718192021222324252627282930313233var letterCombinations = function(digits) &#123; var res = []; var sort = []; if (digits.length == 0) &#123; return res; &#125; var phone = [ \"0\", \"1\", [\"a\", \"b\", \"c\"], [\"d\", \"e\", \"f\"], [\"g\", \"h\", \"i\"], [\"j\", \"k\", \"l\"], [\"m\", \"n\", \"o\"], [\"p\", \"q\", \"r\", \"s\"], [\"t\", \"u\", \"v\"], [\"w\", \"x\", \"y\", \"z\"] ]; finger(0); return res; function finger(index) &#123; if (index == digits.length) &#123; return res.push(sort.join(\"\")); &#125; var temp = phone[digits[index]]; for (var i = 0; i &lt; temp.length; i++) &#123; sort.push(temp[i]); finger(index + 1); sort.pop(); &#125; &#125;&#125;; [22] Generate ParenthesesGiven n pairs of parentheses, write a function to generate all combinations of well-formed parentheses.éš¾åº¦ï¼šMedium (53.42%)è€ƒç‚¹ï¼šå›æº¯æ€è·¯ï¼š ç»™å®š n å€¼ï¼Œåˆ™æ€»å…±æœ‰ n ä¸ªå·¦æ‹¬å·ï¼Œn ä¸ªå³æ‹¬å·ã€‚ ç¬¬ä¸€ä¸ªæ·»åŠ çš„ä¸€å®šæ˜¯å·¦æ‹¬å·ã€‚ å½“æ·»åŠ äº†ä¸€ä¸ªå·¦æ‹¬å·ä¹‹åï¼Œæ‰ä¼šæœ‰ä¸€ä¸ªå³æ‹¬å·å¯ä»¥æ·»åŠ ã€‚æ‰€ä»¥å›æº¯æ—¶ï¼Œleft-1 çš„åŒæ—¶ right+1 å½“å·²æ·»åŠ äº† n ä¸ªå·¦æ‹¬å·åï¼Œå‰©ä¸‹çš„éƒ½åº”è¯¥æ·»åŠ å³æ‹¬å· 123456789101112131415161718192021var generateParenthesis = function(n) &#123; var res = []; var left = n - 1; var right = 1; function quote(left, right, str) &#123; if (left &lt;= 0) &#123; if (right) &#123; for (var i = 0; i &lt; right; i++) &#123; str = str + \")\"; &#125; &#125; return res.push(str); &#125; quote(left - 1, right + 1, str + \"(\"); if (right &gt; 0) &#123; quote(left, right - 1, str + \")\"); &#125; &#125; quote(left, right, \"(\"); return res;&#125;; [46] PermutationsGiven a collection of distinct integers, return all possible permutations.éš¾åº¦ï¼šMedium (53.67%)è€ƒç‚¹ï¼šå›æº¯æ€è·¯ï¼šé€‰æ‹©ä¸€ä¸ªå…ƒç´ ä¹‹åï¼Œåˆ™ä¸‹æ¬¡å¯é€‰æ‹©çš„å…ƒç´ å°±å°‘ä¸€ä¸ªã€‚ 12345678910111213141516171819202122var permute = function(nums) &#123; var res = []; var sort = []; if (nums.length == 0) &#123; return res; &#125; select(nums); return res; function select(nums) &#123; if (nums.length &lt; 1) &#123; return res.push(sort.slice()); &#125; for (var i = 0; i &lt; nums.length; i++) &#123; var nextNums = nums.slice(); sort.push(nextNums[i]); nextNums.splice(i, 1); select(nextNums); sort.pop(); &#125; &#125;&#125;; [47] Permutations IIGiven a collection of numbers that might contain duplicates, return all possible unique permutations.éš¾åº¦ï¼šMedium (39.35%)è€ƒç‚¹ï¼šå›æº¯æ€è·¯ï¼šæ€è·¯åŒä¸Šé¢˜ã€‚æ³¨æ„ç­›é€‰æ¡ä»¶ã€‚ 12345678910111213141516171819202122232425262728var permuteUnique = function(nums) &#123; var res = []; var sort = []; if (nums.length == 0) &#123; return res; &#125; nums = nums.sort((a, b) =&gt; &#123; return a - b; &#125;); select(nums); return res; function select(nums) &#123; if (nums.length &lt; 1) &#123; return res.push(sort.slice()); &#125; for (var i = 0; i &lt; nums.length; i++) &#123; if (nums[i] == nums[i - 1]) &#123; continue; &#125; var nextNums = nums.slice(); sort.push(nextNums[i]); nextNums.splice(i, 1); select(nextNums); sort.pop(); &#125; &#125;&#125;; [60] Permutations II â˜†â˜†The set [1,2,3,â€¦,n] contains a total of n! unique permutations.By listing and labeling all of the permutations in order, we get the following sequence for n = 3:â€œ123â€â€œ132â€â€œ213â€â€œ231â€â€œ312â€â€œ321â€Given n and k, return the k^th permutation sequence.Note:Given n will be between 1 and 9 inclusive. Given k will be between 1 and n! inclusive.éš¾åº¦ï¼šMedium (32.42%)è€ƒç‚¹ï¼šå›æº¯ 123456789101112131415161718192021var getPermutation = function(n, k) &#123; (res = []), (pos = k - 1); var nums = []; if (n == 0) &#123; return \"error\"; &#125; for (var i = 0; i &lt; n; i++) &#123; nums[i] = i + 1; &#125; var numsSort = nums.reduce((a, b) =&gt; a * b); if (k &lt; 1 || k &gt; numsSort) &#123; return \"error\"; &#125; for (var j = n; j &gt;= 1; --j) &#123; numsSort /= j; res.push(nums.splice(parseInt(pos / numsSort), 1)[0]); pos %= numsSort; &#125; return res.join(\"\");&#125;; [77] ombinations â˜†â˜†Given two integers n and k, return all possible combinations of k numbers out of 1 â€¦ n.éš¾åº¦ï¼šMedium (46.23%)è€ƒç‚¹ï¼šå›æº¯éš¾ç‚¹ï¼šä¸‹ä¸€æ¬¡é€‰æ‹©ä¸èƒ½é€‰æ‹©æ¯”ä¸Šä¸€æ¬¡å°çš„æ•°ï¼Œæ‰€ä»¥éœ€æ³¨æ„ push è¿›å»çš„æ¡ä»¶ 12345678910111213141516171819202122232425262728var combine = function(n, k) &#123; var nums = []; var res = []; var temp = []; if (n == 0 || k &lt;= 0 || k &gt; n) &#123; return \"error\"; &#125; for (var i = 0; i &lt; n; i++) &#123; nums[i] = i + 1; &#125; select(0, nums); return res; function select(start, nums) &#123; if (temp.length == k) &#123; return res.push(temp.slice()); &#125; for (var i = start; i &lt; n; i++) &#123; if (temp.length &gt;= 1 &amp;&amp; temp[temp.length - 1] &gt; i) &#123; continue; &#125; temp.push(nums[i]); select(start + 1, nums); temp.pop(); &#125; &#125;&#125;; [78] SubsetsGiven a set of distinct integers, nums, return all possible subsets (the power set).Note: The solution set must not contain duplicate subsets.éš¾åº¦ï¼šMedium (51.26%)è€ƒç‚¹ï¼šå›æº¯éš¾ç‚¹ï¼šä¸‹ä¸€æ¬¡é€‰æ‹©ä¸èƒ½é€‰æ‹©æ¯”ä¸Šä¸€æ¬¡å°çš„æ•°ï¼Œæ‰€ä»¥éœ€æ³¨æ„ push è¿›å»çš„æ¡ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233var subsets = function(nums) &#123; var res = []; var subsets = []; var used = []; res.push(subsets.slice()); if (nums.length == 0) &#123; return res; &#125; nums = nums.sort((a, b) =&gt; a - b); for (var j = 1; j &lt;= nums.length; j++) &#123; findSubsets(0, j); &#125; return res; function findSubsets(start, k) &#123; for (var i = 0; i &lt; nums.length; i++) &#123; if (subsets.length == k) &#123; return res.push(subsets.slice()); &#125; if (used[i]) &#123; continue; &#125; if (start &gt; 0 &amp;&amp; nums[i] &lt; subsets[subsets.length - 1]) &#123; continue; &#125; subsets.push(nums[i]); used[i] = true; findSubsets(start + 1, k); subsets.pop(); used[i] = false; &#125; &#125;&#125;; [79] Word SearchGiven a 2D board and a word, find if the word exists in the grid.The word can be constructed from letters of sequentially adjacent cell, where â€œadjacentâ€ cells are those horizontally or vertically neighboring. The same letter cell may not be used more than once.éš¾åº¦ï¼šMedium (30.52%)è€ƒç‚¹ï¼šå›æº¯æ€è·¯ï¼šè¦åˆ†å››ä¸ªæ–¹å‘åˆ†åˆ«å›æº¯ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445var exist = function(board, word) &#123; var row = board.length; var col = board[0].length; if (word.length &gt; row * col) &#123; return false; &#125; function search(i, j, n) &#123; if ( i &gt;= row || j &gt;= col || i &lt; 0 || j &lt; 0 || board[i][j] != word[n] || n &gt; word.length ) &#123; return false; &#125; if (n == word.length - 1) &#123; return true; &#125; board[i][j] = true; if (search(i + 1, j, n + 1)) &#123; return true; &#125; if (search(i - 1, j, n + 1)) &#123; return true; &#125; if (search(i, j + 1, n + 1)) &#123; return true; &#125; if (search(i, j - 1, n + 1)) &#123; return true; &#125; board[i][j] = word[n]; return false; &#125; for (var i = 0; i &lt; row; i++) &#123; for (var j = 0; j &lt; col; j++) &#123; if (search(i, j, 0)) &#123; return true; &#125; &#125; &#125; return false;&#125;; [89] Gray Code â˜†â˜†The gray code is a binary numeral system where two successive values differ in only one bit.Given a non-negative integer n representing the total number of bits in the code, print the sequence of gray code. A gray code sequence must begin with 0.éš¾åº¦ï¼šMedium (45.03%)è€ƒç‚¹ï¼šå›æº¯æ€è·¯ï¼šå¯æ ¹æ®æ ¼é›·ç çš„ç‰¹æ€§è€ƒè™‘è§£æ³•ä¸€ï¼ˆæ™®é€šè§£æ³•ï¼‰ï¼š 123456789101112131415161718192021222324252627282930var grayCode = function(n) &#123; var result = []; var graycodeFn = function(n) &#123; var graycode = []; if (n == 1) &#123; graycode[0] = \"0\"; graycode[1] = \"1\"; return graycode; &#125; var last = arguments.callee(n - 1); // arguments.callee(n-1) == graycodeFn(n-1) for (var i = last.length - 1; i &gt;= 0; --i) &#123; graycode.unshift(\"0\" + last[i]); graycode.push(\"1\" + last[i]); &#125; return graycode; &#125;; var graycode = n == 0 ? [\"0\"] : graycodeFn(n); for (var i = 0; i &lt; graycode.length; ++i) &#123; result.push(parseInt(parseInt(graycode[i], 2), 10)); // String To Number &#125; return result;&#125;; è§£æ³•äºŒï¼ˆå¤§ç¥è§£æ³•ï¼‰ï¼š 1234567var grayCode = function(n) &#123; let nums = [0], c = -1; while (c++ &lt; n - 1) nums = [...nums, ...nums.map(num =&gt; num + Math.pow(2, c)).reverse()]; return nums;&#125;; [90] Subsets IIGiven a collection of integers that might contain duplicates, nums, return all possible subsets (the power set).Note: The solution set must not contain duplicate subsets.éš¾åº¦ï¼šMedium (41.57%)è€ƒç‚¹ï¼šå›æº¯ 12345678910111213141516171819202122232425262728var subsetsWithDup = function(nums) &#123; var sub = []; var res = []; res.push(sub.slice()); if (nums.length == 0) &#123; return res; &#125; nums = nums.sort((a, b) =&gt; a - b); for (var i = 1; i &lt;= nums.length; i++) &#123; findSub(0, i); &#125; return res; function findSub(start, k) &#123; if (sub.length == k) &#123; return res.push(sub.slice()); &#125; for (var j = start; j &lt; nums.length; j++) &#123; if (j &gt; start &amp;&amp; nums[j] == nums[j - 1]) &#123; continue; &#125; sub.push(nums[j]); findSub(j + 1, k); sub.pop(); &#125; &#125;&#125;;","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/categories/ç®—æ³•/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://yoursite.com/tags/LeetCode/"},{"name":"å›æº¯","slug":"å›æº¯","permalink":"http://yoursite.com/tags/å›æº¯/"}]},{"title":"æµè§ˆå™¨å†…æ ¸","slug":"æµè§ˆå™¨å†…æ ¸","date":"2019-01-07T13:07:44.000Z","updated":"2019-11-10T14:37:39.037Z","comments":true,"path":"2019/01/07/æµè§ˆå™¨å†…æ ¸/","link":"","permalink":"http://yoursite.com/2019/01/07/æµè§ˆå™¨å†…æ ¸/","excerpt":"æµè§ˆå™¨å†…æ ¸æµè§ˆå™¨å†…æ ¸æœ‰å“ªå‡ ç§ï¼ŸTridentï¼šIEï¼ˆInternet Explorerï¼‰ï¼Œç”±äºå…¶è¢«åŒ…å«åœ¨å…¨ä¸–ç•Œä½¿ç”¨ç‡æœ€é«˜çš„æ“ä½œç³»ç»Ÿ Windows ä¸­ï¼Œå¾—åˆ°äº†æé«˜çš„å¸‚åœºå æœ‰ç‡ï¼Œä»è€Œä½¿å¾— Trident å†…æ ¸ï¼ˆä¹Ÿè¢«ç§°ä¸º IE å†…æ ¸ï¼‰é•¿æœŸä¸€å®¶ç‹¬å¤§ã€‚ ä½†æ˜¯ç”±äºå¾®è½¯é•¿æ—¶é—´æ²¡æœ‰æ›´æ–° Trident å†…æ ¸ï¼Œåˆ™å¯¼è‡´äº†ä¸¤ä¸ªåæœï¼šä¸€æ˜¯ Trident å†…æ ¸æ›¾ç»å‡ ä¹ä¸ W3C æ ‡å‡†è„±èŠ‚ï¼ˆ2005 å¹´ï¼‰ï¼ŒäºŒæ˜¯ Trident å†…æ ¸çš„å¤§é‡ Bug ç­‰å®‰å…¨æ€§é—®é¢˜æ²¡æœ‰å¾—åˆ°åŠæ—¶è§£å†³ï¼Œç„¶ååŠ ä¸Šä¸€äº›è‡´åŠ›äºå¼€æºçš„å¼€å‘è€…å’Œä¸€äº›å­¦è€…ä»¬å…¬å¼€è‡ªå·±è®¤ä¸º IE æµè§ˆå™¨ä¸å®‰å…¨çš„è§‚ç‚¹ï¼Œä¹Ÿæœ‰å¾ˆå¤šç”¨æˆ·è½¬å‘äº†å…¶ä»–æµè§ˆå™¨ã€‚","text":"æµè§ˆå™¨å†…æ ¸æµè§ˆå™¨å†…æ ¸æœ‰å“ªå‡ ç§ï¼ŸTridentï¼šIEï¼ˆInternet Explorerï¼‰ï¼Œç”±äºå…¶è¢«åŒ…å«åœ¨å…¨ä¸–ç•Œä½¿ç”¨ç‡æœ€é«˜çš„æ“ä½œç³»ç»Ÿ Windows ä¸­ï¼Œå¾—åˆ°äº†æé«˜çš„å¸‚åœºå æœ‰ç‡ï¼Œä»è€Œä½¿å¾— Trident å†…æ ¸ï¼ˆä¹Ÿè¢«ç§°ä¸º IE å†…æ ¸ï¼‰é•¿æœŸä¸€å®¶ç‹¬å¤§ã€‚ ä½†æ˜¯ç”±äºå¾®è½¯é•¿æ—¶é—´æ²¡æœ‰æ›´æ–° Trident å†…æ ¸ï¼Œåˆ™å¯¼è‡´äº†ä¸¤ä¸ªåæœï¼šä¸€æ˜¯ Trident å†…æ ¸æ›¾ç»å‡ ä¹ä¸ W3C æ ‡å‡†è„±èŠ‚ï¼ˆ2005 å¹´ï¼‰ï¼ŒäºŒæ˜¯ Trident å†…æ ¸çš„å¤§é‡ Bug ç­‰å®‰å…¨æ€§é—®é¢˜æ²¡æœ‰å¾—åˆ°åŠæ—¶è§£å†³ï¼Œç„¶ååŠ ä¸Šä¸€äº›è‡´åŠ›äºå¼€æºçš„å¼€å‘è€…å’Œä¸€äº›å­¦è€…ä»¬å…¬å¼€è‡ªå·±è®¤ä¸º IE æµè§ˆå™¨ä¸å®‰å…¨çš„è§‚ç‚¹ï¼Œä¹Ÿæœ‰å¾ˆå¤šç”¨æˆ·è½¬å‘äº†å…¶ä»–æµè§ˆå™¨ã€‚ Trident å†…æ ¸å¸¸è§æµè§ˆå™¨ï¼ˆ1ï¼‰IE6ã€IE7ã€IE8ï¼ˆTrident 4.0ï¼‰ã€IE9ï¼ˆTrident 5.0ï¼‰ã€IE10ï¼ˆTrident 6.0ï¼‰ï¼› ï¼ˆ2ï¼‰çŒè±¹å®‰å…¨æµè§ˆå™¨ï¼š1.0-4.2 ç‰ˆæœ¬ä¸º Trident+Webkitï¼Œ4.3 ç‰ˆæœ¬ä¸º Trident+Blinkï¼› ï¼ˆ3ï¼‰360 å®‰å…¨æµè§ˆå™¨ ï¼š1.0-5.0 ä¸º Tridentï¼Œ6.0 ä¸º Trident+Webkitï¼Œ7.0 ä¸º Trident+Blinkï¼› ï¼ˆ4ï¼‰360 æé€Ÿæµè§ˆå™¨ï¼š7.5 ä¹‹å‰ä¸º Trident+Webkit,7.5 ä¸º Trident+Blinkï¼› ï¼ˆ5ï¼‰å‚²æ¸¸æµè§ˆå™¨ ï¼šå‚²æ¸¸ 1.xã€2.x ä¸º IE å†…æ ¸ï¼Œ3.x ä¸º IE ä¸ Webkit åŒæ ¸ï¼› ï¼ˆ6ï¼‰æœç‹—é«˜é€Ÿæµè§ˆå™¨ï¼š1.x ä¸º Tridentï¼Œ2.0 åŠä»¥åç‰ˆæœ¬ä¸º Trident+Webkitï¼› å…¼å®¹æ¨¡å¼å›½å†…å¾ˆå¤šçš„åŒæ ¸æµè§ˆå™¨çš„å…¶ä¸­ä¸€æ ¸ä¾¿æ˜¯ Tridentï¼Œç¾å…¶åæ›° â€œå…¼å®¹æ¨¡å¼â€ã€‚ EdgeHTML å†…æ ¸Window10 å‘å¸ƒåï¼ŒIE å°†å…¶å†…ç½®æµè§ˆå™¨å‘½åä¸º Edgeï¼ŒEdge æœ€æ˜¾è‘—çš„ç‰¹ç‚¹å°±æ˜¯æ–°å†…æ ¸ EdgeHTMLã€‚ Gecko ([â€˜gekÉ™ÊŠ])å¼€æºå†…æ ¸Gecko(Firefox å†…æ ¸)ï¼šNetscape6 å¼€å§‹é‡‡ç”¨çš„å†…æ ¸ï¼Œåæ¥çš„ Mozilla FireFox(ç«ç‹æµè§ˆå™¨) ä¹Ÿé‡‡ç”¨äº†è¯¥å†…æ ¸ï¼ŒGecko çš„ç‰¹ç‚¹æ˜¯ä»£ç å®Œå…¨å…¬å¼€ï¼Œå› æ­¤ï¼Œå…¶å¯å¼€å‘ç¨‹åº¦å¾ˆé«˜ï¼Œå…¨ä¸–ç•Œçš„ç¨‹åºå‘˜éƒ½å¯ä»¥ä¸ºå…¶ç¼–å†™ä»£ç ï¼Œå¢åŠ åŠŸèƒ½ã€‚å› ä¸ºè¿™æ˜¯ä¸ªå¼€æºå†…æ ¸ï¼Œå› æ­¤å—åˆ°è®¸å¤šäººçš„é’çï¼ŒGecko å†…æ ¸çš„æµè§ˆå™¨ä¹Ÿå¾ˆå¤šï¼Œè¿™ä¹Ÿæ˜¯ Gecko å†…æ ¸è™½ç„¶å¹´è½»ä½†å¸‚åœºå æœ‰ç‡èƒ½å¤Ÿè¿…é€Ÿæé«˜çš„é‡è¦åŸå› ã€‚ Firefox å†…æ ¸äº‹å®ä¸Šï¼ŒGecko å¼•æ“çš„ç”±æ¥è·Ÿ IE ä¸æ— å…³ç³»ï¼Œå‰é¢è¯´è¿‡ IE æ²¡æœ‰ä½¿ç”¨ W3C çš„æ ‡å‡†ï¼Œè¿™å¯¼è‡´äº†å¾®è½¯å†…éƒ¨ä¸€äº›å¼€å‘äººå‘˜çš„ä¸æ»¡ï¼›ä»–ä»¬ä¸å½“æ—¶å·²ç»åœæ­¢æ›´æ–°äº†çš„ Netscape çš„ä¸€äº›å‘˜å·¥ä¸€èµ·åˆ›åŠäº† Mozillaï¼Œä»¥å½“æ—¶çš„ Mosaic å†…æ ¸ä¸ºåŸºç¡€é‡æ–°ç¼–å†™å†…æ ¸ï¼Œäºæ˜¯å¼€å‘å‡ºäº† Geckoã€‚ä¸è¿‡äº‹å®ä¸Šï¼ŒGecko å†…æ ¸çš„æµè§ˆå™¨ä»ç„¶è¿˜æ˜¯ Firefox (ç«ç‹) ç”¨æˆ·æœ€å¤šï¼Œæ‰€ä»¥æœ‰æ—¶ä¹Ÿä¼šè¢«ç§°ä¸º Firefox å†…æ ¸ã€‚æ­¤å¤– Gecko ä¹Ÿæ˜¯ä¸€ä¸ªè·¨å¹³å°å†…æ ¸ï¼Œå¯ä»¥åœ¨ Windowsã€ BSDã€Linux å’Œ Mac OS X ä¸­ä½¿ç”¨ã€‚ WebkitSafari æµè§ˆå™¨åªè¦æåˆ° Webkitï¼Œå¤§å¤šæ•°äººç«‹é©¬æƒ³åˆ°çš„å¿…ç„¶æ˜¯ Chromeï¼Œç»“æœå¯¼è‡´å¦‚ä»Šæœ‰äº†æŠŠ webkit ç§°ä¸º chrome å†…æ ¸çš„é”™è¯¯è¯´æ³•ï¼Œå³ä½¿ chrome çš„å†…æ ¸å·²ç»æ˜¯ blinkï¼Œå…¶å® Webkit çš„ç¥–å…ˆæ˜¯ Safariï¼Œä¹Ÿå°±æ˜¯è‹¹æœç³»åˆ—äº§å“çš„ä¸“å±æµè§ˆå™¨ã€‚ WebKit æ˜¯ KHTML çš„åˆ†æ”¯WebKit çš„å‰èº«æ˜¯è‹¹æœå…¬å¸ä½¿ç”¨ KDEï¼ˆLinux æ¡Œé¢ç³»ç»Ÿï¼‰å¼€å‘çš„ KHTML å¼€æºå¼•æ“ï¼Œå¯ä»¥è¯´ WebKit æ˜¯ KHTML çš„ä¸€ä¸ªå¼€æºåˆ†æ”¯ã€‚ Chromium/BlinkChromium Fork webkit2008 å¹´ï¼Œè°·æ­Œå…¬å¸å‘å¸ƒäº† chrome æµè§ˆå™¨ï¼Œæµè§ˆå™¨ä½¿ç”¨çš„å†…æ ¸è¢«å‘½åä¸º chromiumã€‚chromium fork è‡ªå¼€æºå¼•æ“ webkitï¼Œå¹¶æé«˜äº† WebKit çš„ä»£ç å¯è¯»æ€§å’Œç¼–è¯‘é€Ÿåº¦ã€‚ V8 å¼•æ“è°·æ­Œå…¬å¸è¿˜ç ”å‘äº†è‡ªå·±çš„ Javascript å¼•æ“ï¼ŒV8ï¼Œæå¤§åœ°æé«˜äº† Javascript çš„è¿ç®—é€Ÿåº¦ã€‚ Blink æ˜¯ WebKit çš„åˆ†æ”¯Google çš„ Chromium é¡¹ç›®æœ€åˆä¸€ç›´ä½¿ç”¨ WebKit(WebCore) ä½œä¸ºæ¸²æŸ“å¼•æ“ï¼Œä½†ç”±äºåæ¥è‹¹æœæ¨å‡ºçš„ WebKit2 ä¸ Chromium çš„æ²™ç®±è®¾è®¡å­˜åœ¨å†²çªï¼Œæ‰€ä»¥ Google å†³å®šä» WebKit è¡ç”Ÿå‡ºè‡ªå·±çš„ Blink å¼•æ“ï¼ˆåç”± Google å’Œ Opera Software å…±åŒç ”å‘ï¼‰ã€‚ Blink å…¶å®æ˜¯ WebKit çš„åˆ†æ”¯ï¼Œå¦‚åŒ WebKit æ˜¯ KHTML çš„åˆ†æ”¯ã€‚Google çš„ Chromium é¡¹ç›®æ­¤å‰ä¸€ç›´ä½¿ç”¨ WebKit(WebCore) ä½œä¸ºæ¸²æŸ“å¼•æ“ï¼Œä½†å‡ºäºæŸç§åŸå› ï¼Œå¹¶æ²¡æœ‰å°†å…¶å¤šè¿›ç¨‹æ¶æ„ç§»æ¤å…¥ Webkitã€‚ åæ¥ï¼Œç”±äºè‹¹æœæ¨å‡ºçš„ WebKit2 ä¸ Chromium çš„æ²™ç®±è®¾è®¡å­˜åœ¨å†²çªï¼Œæ‰€ä»¥ Chromium ä¸€ç›´åœç•™åœ¨ WebKitï¼Œå¹¶ä½¿ç”¨ç§»æ¤çš„æ–¹å¼æ¥å®ç°å’Œä¸»çº¿ WebKit2 çš„å¯¹æ¥ã€‚è¿™å¢åŠ äº† Chromium çš„å¤æ‚æ€§ï¼Œä¸”åœ¨ä¸€å®šç¨‹åº¦ä¸Šå½±å“äº† Chromium çš„æ¶æ„ç§»æ¤å·¥ä½œã€‚ åŸºäºä»¥ä¸ŠåŸå› ï¼ŒGoogle å†³å®šä» WebKit è¡ç”Ÿå‡ºè‡ªå·±çš„ Blink å¼•æ“ï¼ˆåç”± Google å’Œ Opera Software å…±åŒç ”å‘ï¼‰ï¼Œå°†åœ¨ WebKit ä»£ç çš„åŸºç¡€ä¸Šç ”å‘æ›´åŠ å¿«é€Ÿå’Œç®€çº¦çš„æ¸²æŸ“å¼•æ“ï¼Œå¹¶é€æ­¥è„±ç¦» WebKit çš„å½±å“ï¼Œåˆ›é€ ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ Blink å¼•æ“ã€‚è¿™æ ·ä»¥æ¥ï¼Œå”¯ä¸€ä¸€æ¡ç»´ç³» Google å’Œè‹¹æœä¹‹é—´æŠ€æœ¯å…³ç³»çš„çº½å¸¦å°±è¿™æ ·è¢«åˆ‡æ–­äº†ã€‚ Presto ([â€˜prestÉ™ÊŠ])Opera æµè§ˆå™¨Presto æ˜¯ Opera è‡ªä¸»ç ”å‘çš„æ¸²æŸ“å¼•æ“ï¼Œç„¶è€Œä¸ºäº†å‡å°‘ç ”å‘æˆæœ¬ï¼ŒOpera åœ¨ 2013 å¹´ 2 æœˆå®£å¸ƒæ”¾å¼ƒ Prestoï¼Œè½¬è€Œè·Ÿéš Chrome ä½¿ç”¨ WebKit åˆ†æ”¯çš„ Chromium å¼•æ“ä½œä¸ºè‡ªå®¶æµè§ˆå™¨æ ¸å¿ƒå¼•æ“ã€‚ åœ¨ Chrome äº 2013 å¹´æ¨å‡º Blink å¼•æ“ä¹‹åï¼ŒOpera ä¹Ÿç´§è·Ÿå…¶è„šæ­¥è¡¨ç¤ºå°†è½¬è€Œä½¿ç”¨ Blink ä½œä¸ºæµè§ˆå™¨æ ¸å¿ƒå¼•æ“ã€‚ ç§»åŠ¨ç«¯ç§»åŠ¨ç«¯çš„æµè§ˆå™¨å†…æ ¸ä¸»è¦è¯´çš„æ˜¯ç³»ç»Ÿå†…ç½®æµè§ˆå™¨çš„å†…æ ¸ã€‚ ç›®å‰ç§»åŠ¨è®¾å¤‡æµè§ˆå™¨ä¸Šå¸¸ç”¨çš„å†…æ ¸æœ‰ Webkitï¼ŒBlinkï¼ŒTridentï¼ŒGecko ã€‚ 1ã€iPhone å’Œ iPad ç­‰è‹¹æœ iOS å¹³å°ä¸»è¦æ˜¯ WebKitã€‚ 2ã€Android 4.4 ä¹‹å‰çš„ Android ç³»ç»Ÿæµè§ˆå™¨å†…æ ¸æ˜¯ WebKitï¼ŒAndroid 4.4 ç³»ç»Ÿæµè§ˆå™¨åˆ‡æ¢åˆ°äº† Chromiumï¼Œå†…æ ¸æ˜¯ Webkit çš„åˆ†æ”¯ Blinkã€‚ 3ã€Windows Phone 8 ç³»ç»Ÿæµè§ˆå™¨å†…æ ¸æ˜¯ Tridentã€‚ webkit å†…æ ¸äº†è§£å¤šå°‘ï¼Ÿï¼ˆchrome å†…æ ¸æ˜¯ b-linkï¼‰æ·±å…¥å‰–æ webkit å¾®ä¿¡ x5 å†…æ ¸å’Œåˆ«çš„å†…æ ¸æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿï¼ˆx5 æ˜¯åŸºäº webkit çš„ï¼‰è®¤è¯† X5 è…¾è®¯åŸºäºä¼˜ç§€å¼€æº Webkit æ·±åº¦ä¼˜åŒ–çš„æµè§ˆå™¨æ¸²æŸ“å¼•æ“ ä¸ºæŠ¹å¹³ä¸åŒ Android ç‰ˆæœ¬ä¸åŒ Webview çš„å‘è€Œç”Ÿã€‚ä½†æœ¬èº«ä¹Ÿå¸¦æ¥äº†è®¸å¤šå‘ã€‚ è™½ç„¶å®˜æ–¹ä¸æ‰¿è®¤ï¼Œä½†å®é™…ä¸Šå®ƒæ˜¯åŸºäº Chromuim å¼€æºé¡¹ç›®çš„ã€‚ webkit å†…æ ¸ä»¥åŠ blink å†…æ ¸åœ¨ x5 çš„ä½¿ç”¨æƒ…å†µ QQ æµè§ˆå™¨ï¼š6.2 ç‰ˆæœ¬åŠä»¥åä½¿ç”¨ blink å†…æ ¸ã€‚ X5 tbs 1.xï¼šç‰ˆæœ¬å·ä¸º 02xxxxï¼Œä½¿ç”¨ webkit å†…æ ¸ã€‚ X5 tbs 2.xï¼šç‰ˆæœ¬å·ä¸º 03xxxxã€‚ä½¿ç”¨ blink å†…æ ¸ã€‚ æ‹“å±•ï¼šWebkit &amp; Chromuim &amp;Chrome &amp; Blink WebKitæ˜¯ä¸€ä¸ªå¼€æºçš„é¡¹ç›®ï¼Œå…¶å‰èº«æ˜¯æ¥æºäº KDE çš„ KHTML å’Œ KJSã€‚è¯¥é¡¹ç›®ä¸“æ³¨äºç½‘é¡µå†…å®¹çš„å±•ç¤ºï¼Œå¼€å‘å‡ºä¸€æµçš„ç½‘é¡µæ¸²æŸ“å¼•æ“ã€‚ Chromiumæ˜¯ä¸€ä¸ªå»ºç«‹åœ¨ WebKit ä¹‹ä¸Šçš„æµè§ˆå™¨å¼€æºé¡¹ç›®ï¼Œç”± Google å‘èµ·çš„ã€‚ ** Chrome**æ˜¯ Google å…¬å¸çš„æµè§ˆå™¨äº§å“ï¼Œå®ƒåŸºäº chromium å¼€æºé¡¹ç›®ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œå†…æ ¸æ˜¯å¼€æºçš„ï¼ŒUI æ˜¯é—­æºçš„ã€‚ Blinkæ˜¯ Google é€€å‡º WebKit é¡¹ç›®ï¼Œä»è€Œè‡ªå·±åˆ›å»ºçš„æ¸²æŸ“å¼•æ“ã€‚ä½†å¹¶ä¸æ˜¯å…¨æ–°çš„å¼•æ“ï¼ŒBlink ç›®å‰å°±æ˜¯ä» WebKit ç›´æ¥å¤åˆ¶å‡ºä¸€ä¸ªç‰ˆæœ¬å‡ºæ¥ï¼Œç„¶åå°†ä¸ chromium æ— å…³çš„ Ports å…¨éƒ¨ç§»é™¤æ‰ï¼Œå°†ä»£ç ç»“æ„é‡æ–°æ•´ç†ï¼Œå°±ç›®å‰è€Œè¨€ï¼ŒBlink çš„æ¸²æŸ“å’Œ WebKit æ˜¯ä¸€æ ·ï¼Œä½†æ˜¯ï¼Œä»¥åä¸¤è€…å°†å„è‡ªèµ°ä¸åŒçš„è·¯ã€‚ X5 å‡çº§äº†æˆªè‡³ 16 å¹´ 4 æœˆä»½ï¼Œx5 å‡çº§å…¨é‡å‘å¸ƒã€‚TBS2.0 åŸºäº Android 5.0 WebView Blink å†…æ ¸ï¼ˆM37 ç‰ˆæœ¬ï¼‰é€‚é…å®šåˆ¶ä¼˜åŒ–ï¼Œé€‚é… Android å…¨éƒ¨ä¸»æµå¹³å°ï¼Œå¯ä»¥åœ¨æ‰€æœ‰ Android æ‰‹æœºä¸Šä½¿ç”¨ Blink çš„æŠ€æœ¯èƒ½åŠ›ã€‚å…·æœ‰æ›´å¥½çš„ H5/CSS3 æ”¯æŒå’Œæ€§èƒ½ã€‚TBS2.0 å·²ç»å‘å¸ƒï¼Œå°†é€æ­¥åœ¨å„å®¢æˆ·ç«¯ä¸­é™é»˜å‡çº§ï¼Œæ— éœ€æ›´æ–°å¾®ä¿¡ã€æ‰‹æœº QQã€QQ ç©ºé—´å³å¯ä½¿ç”¨æœ€æ–°çš„ TBS2.0 Blink å†…æ ¸ã€‚ æ›´ç®€æ´åœ°è¯´ï¼Œå³æ˜¯ï¼š åŸºäº Blink å†…æ ¸ï¼ˆchrome 37 ç‰ˆæœ¬ï¼‰ é€‚ç”¨äº Android å…¨éƒ¨ä¸»æµå¹³å° é™é»˜å‡çº§ PSï¼šiOS ç‰ˆæœ¬çš„å¾®ä¿¡ Web View ä¸€ç›´æ˜¯ WKWebView å†…æ ¸ï¼ŒWKWebView çš„ç‰ˆæœ¬ä¾èµ–äº iOS çš„ç³»ç»Ÿç‰ˆæœ¬ã€‚ TBS2.0 å†…æ ¸è¯¦æƒ… BLINK ç‰ˆæœ¬: åŸºäº Chrome 37 HTML ç‰ˆæœ¬: HTML5.0 XHTML ç‰ˆæœ¬: xHTML Basic 1.0 | xHTML1.1 SVG ç‰ˆæœ¬: SVG1.2 WML ç‰ˆæœ¬: Wml 1.0 CSS ç‰ˆæœ¬: CSS3 Spdy ç‰ˆæœ¬: 3.1 æ”¯æŒçš„ JavaScript ç‰ˆæœ¬: Ecma5 Changelog ä»¥åŠ è§£è¯»1.å†…æ ¸ä» Webkit å‡çº§è‡³ Blinkï¼Œæ‹¥æœ‰æ›´å¥½çš„æ”¯æŒ é‚£ä¹ˆå“ªé‡Œå¯ä»¥æŸ¥é˜…å…¼å®¹æ€§å‘¢ï¼Ÿ X5 CanIUse 2.å†…æ ¸ç‰ˆæœ¬å·å‡çº§åˆ° 362xx ç‰ˆæœ¬ã€‚å¯ä»¥æ ¹æ® UserAgentåˆ¤æ–­å½“å‰ç¯å¢ƒæ˜¯å¦å·²å‡çº§åˆ° TBS2.0 ç‰ˆæœ¬,åŒ…å«ï¼ˆTBS/03xxxxï¼‰å­—æ®µã€‚ é‚£ä¹ˆæ€ä¹ˆæŸ¥çœ‹è‡ªå·±å¾®ä¿¡é‡Œçš„ TBS ç‰ˆæœ¬ï¼Ÿ ç”¨å¾®ä¿¡æ‰“å¼€è¿™ä¸ªé¡µé¢ï¼Œæ£€æŸ¥ TBS çš„ç‰ˆæœ¬å·ï¼Œ0362xx è¡¨ç¤ºå·²æ›´æ–°ã€‚é¡µé¢çš„ä»£ç åªæœ‰ä¸¤å¥ï¼Œä¸ºï¼š 123// æ£€æµ‹é¡µé¢çš„æ ¸å¿ƒä»£ç var resultDiv = document.getElementById(\"result\");resultDiv.innerHTML = window.navigator.userAgent; 3.CSS3 å±æ€§æ”¯æŒå¢å¼ºï¼š å®Œæ•´æ”¯æŒ flex ä¼ªå…ƒç´ æ”¯æŒåŠ¨ç”»æ•ˆæœ filter: blur æœ‰æ¨¡ç³Šæ•ˆæœ PSï¼šæ›´å¤šæ›´å…·ä½“çš„æ”¯æŒæƒ…å†µå¯æŸ¥é˜…è¿™é‡Œ 4.autoplay å±æ€§æœ‰æ•ˆï¼Œå¯è‡ªåŠ¨æ’­æ”¾ 5.canvas æ”¯æŒè®¾ç½®èƒŒæ™¯è‰² 6.æ ‡å‡†çš„ç¼“å­˜ç­–ç•¥ï¼Œæ”¯æŒ Spdy 3.1 7.åŠ¨ç”»æ€§èƒ½æå‡ 8.æ›´å¥½çš„ inspector æ”¯æŒ å¾®ä¿¡è¿œç¨‹è°ƒè¯•è§£å†³æ–¹æ¡ˆâ€”â€”å¾®ä¿¡ web å¼€å‘è€…å·¥å…· æ‰‹æœº QQ æµè§ˆå™¨çš„è¿œç¨‹è°ƒè¯•è§£å†³æ–¹æ¡ˆ å‚è€ƒèµ„æ–™ï¼š è§£è¯»å¾®ä¿¡å…¨é¢å‡çº§ X5 Blink å†…æ ¸ï¼ŒH5 æ¸¸æˆè¡Œä¸šé‡å¤§åˆ©å¥½ å®˜æ–¹ç½‘ç«™ï¼šè…¾è®¯æµè§ˆæœåŠ¡ï¼æŠ€æœ¯æŒ‡å— æ€»ç»“å¸¸ç”¨å·¥å…· æ£€æµ‹æ˜¯å¦ä¸º x5ï¼TBS/03xxxx x5 çš„å„é¡¹æ”¯æŒæƒ…å†µï¼X5 CanIUse Android ä¸‹å¾®ä¿¡è¿œç¨‹è°ƒè¯•å·¥å…·-å¾®ä¿¡ web å¼€å‘è€…å·¥å…·ï¼ˆPS:iOS ä¸‹ä½¿ç”¨ Safari è¿œç¨‹è°ƒè¯•å³å¯ï¼‰ æˆ‘ä»¬å¯ä»¥ä»ä¸­äº†è§£åˆ°ä»€ä¹ˆä¸€ã€å·¥å…·æ–¹é¢ï¼š å¯ä»¥é€šè¿‡æŸ¥è¯¢ UA æ¥æ£€æµ‹æ˜¯å¦ä¸º X5ï¼TBS/03xxxxï¼Œåœ¨çº¿æ£€æµ‹åœ°å€ æƒ³çŸ¥é“æŸä¸ª CSS3 å±æ€§ï¼Œæˆ–è€…å…¶ä»– API åœ¨ X5 æ˜¯å¦æ”¯æŒçš„æ—¶å€™ï¼Œå¯ä»¥æŸ¥è¯¢X5 CanIUse è¿œç¨‹è°ƒè¯•å¾®ä¿¡å†…é¡µé¢æ—¶ï¼Œåœ¨ Android ä¸‹å¯ä»¥ä½¿ç”¨å¾®ä¿¡è¿œç¨‹è°ƒè¯•å·¥å…·-å¾®ä¿¡ web å¼€å‘è€…å·¥å…·ï¼Œåœ¨ iOS ä¸‹ä½¿ç”¨ Safari è¿œç¨‹è°ƒè¯•å³å¯ã€‚ äºŒã€å¯¹äºå¼€å‘è°ƒè¯•é¡µé¢ ç›®å‰ï¼Œæš‚æ—¶è¿˜æ²¡æœ‰æŸ¥æ‰¾åˆ° X5 åœ¨å¾®ä¿¡ android å®¢æˆ·ç«¯çš„ç‰ˆæœ¬åˆ†å¸ƒæƒ…å†µçš„æ•°æ®(å¯èƒ½æ˜¯ç”±äº X5 tbs2.0 æ˜¯ä»Šå¹´ 4 æœˆä»½åˆæ‰å¼€å§‹å…¨é‡å‘å¸ƒçš„)ã€‚ è™½ç„¶è¯´ï¼ŒX5 æ˜¯é™é»˜å‡çº§ï¼Œæ— éœ€ç”¨æˆ·æ‰‹åŠ¨æ›´æ–°ï¼ŒåŸºæœ¬ä¸Šéƒ½å®ç°å‡çº§ä¸ºæœ€æ–°ç‰ˆæœ¬(ä¸šç•Œè¯´æ³•)ï¼Œä½†ä»å­˜åœ¨ X5 å†…æ ¸æ˜¯æ—§ç‰ˆæœ¬çš„æƒ…å†µ(æ ¹æ®æ˜¯éƒ¨åˆ†æµ‹è¯•çš„æ£€æµ‹ UA ç»“æœ)ã€‚å¸Œæœ›èƒ½å¤Ÿåœ¨åç»­çš„æ—¥å­å¯ä»¥è·å–åˆ°ç›¸å…³çš„æ•°æ®ã€‚ æ‰‹æœºåŒæ—¶å®‰è£…äº† QQ æµè§ˆå™¨å’Œå¾®ä¿¡ï¼Œä½† QQ æµè§ˆå™¨å†…æ ¸ç‰ˆæœ¬ä¸ç­‰äºå¾®ä¿¡å†…æ ¸ç‰ˆæœ¬ï¼Œåªæœ‰åœ¨ QQ æµè§ˆå™¨å†…æ ¸ä¸ºå¤§äºç­‰äº 6.2 ç‰ˆæœ¬æ‰æ˜¯ Blink å†…æ ¸ï¼Œè°ƒè¯•é¡µé¢çš„ç»“æœæ‰å¯ä»¥æ›¿ä»£åœ¨å¾®ä¿¡å†…é¡µé¢è°ƒè¯•çš„ç»“æœï¼ˆæƒ³è¦ä¸ç™»é™†å¾®ä¿¡ç”¨ QQ æµè§ˆå™¨æ¥æ›¿ä»£è°ƒè¯•çš„éœ€è¦æ³¨æ„ä¸‹ X5 çš„ç‰ˆæœ¬åˆ†å¸ƒæƒ…å†µæ®è…¾è®¯å†…éƒ¨çš„å°ä¼™ä¼´å‘ŠçŸ¥ï¼Œx5 å†…æ ¸åŸºæœ¬è¦†ç›–ç†è®ºä¸Šè¾¾åˆ° 100%ï¼Œä½†éš¾å…ä¼šæœ‰æ¼ç½‘ä¹‹é±¼ã€‚è€Œæ ¹æ®å®é™…æ•°æ®æŠ½æ ·æ•´ç†æ˜¾ç¤ºï¼Œæˆªè‡³ 2016 å¹´ 5 æœˆ 19 æ—¥ï¼Œx5 å†…æ ¸åŸºæœ¬è¦†ç›–ç‡è¾¾åˆ° 91.47%ã€‚ X5 é—®é¢˜æ±‡æ€»","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"}]},{"title":"leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”æ•°ç»„","slug":"leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”æ•°ç»„","date":"2018-12-18T16:07:06.000Z","updated":"2019-11-10T14:37:39.025Z","comments":true,"path":"2018/12/19/leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”æ•°ç»„/","link":"","permalink":"http://yoursite.com/2018/12/19/leetcodeç®—æ³•åˆ·é¢˜ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”æ•°ç»„/","excerpt":"è¯¥ç¬”è®°åªä¸ºä¸ªäººæ‰€å†™ç®—æ³•ï¼Œä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£æ³•ï¼Œä»…ä¾›å‚è€ƒ [1] Two SumGiven an array of integers, return indices of the two numbers such that they add up to a specific target.éš¾åº¦ï¼šEasy (42.36%)è€ƒç‚¹ï¼šå“ˆå¸Œè¡¨æ€è·¯ï¼šç”¨ä¸€éå¾ªç¯ ä¸€è¾¹å‘å“ˆå¸Œè¡¨ä¸­å­˜å€¼ï¼Œä¸€è¾¹æ¯”è¾ƒåˆ¤æ–­","text":"è¯¥ç¬”è®°åªä¸ºä¸ªäººæ‰€å†™ç®—æ³•ï¼Œä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£æ³•ï¼Œä»…ä¾›å‚è€ƒ [1] Two SumGiven an array of integers, return indices of the two numbers such that they add up to a specific target.éš¾åº¦ï¼šEasy (42.36%)è€ƒç‚¹ï¼šå“ˆå¸Œè¡¨æ€è·¯ï¼šç”¨ä¸€éå¾ªç¯ ä¸€è¾¹å‘å“ˆå¸Œè¡¨ä¸­å­˜å€¼ï¼Œä¸€è¾¹æ¯”è¾ƒåˆ¤æ–­ 1234567891011var twoSum = function(nums, target) &#123; var map = &#123;&#125;; for (i = 0; i &lt; nums.length; i++) &#123; const complement = target - nums[i]; if (complement in map) &#123; return [i, map[complement]]; &#125; map[nums[i]] = i; &#125; return -1;&#125;; [11] Container With Most WaterGiven n non-negative integers a1, a2, â€¦, an , where each represents a point at coordinate (i, ai). n vertical lines are drawn such that the two endpoints of line i is at (i, ai) and (i, 0). Find two lines, which together with x-axis forms a container, such that the container contains the most water.Note: You may not slant the container and n is at least 2.éš¾åº¦ï¼šMedium (42.93%)è€ƒç‚¹ï¼šåŠ¨æ€è§„åˆ’æ€è·¯ï¼š è®¾å®š iï¼Œj åˆ†åˆ«æŒ‡å‘æ•°ç»„çš„å¤´å’Œå°¾ æ¯”è¾ƒ iï¼Œj æ‰€å¯¹åº”çš„ä½ç½®çš„å€¼ï¼Œå€¼è¾ƒå°çš„é‚£ä¸€ä¸ªç§»åŠ¨ï¼ˆi++æˆ– jâ€“ï¼‰ 123456789101112131415161718var maxArea = function(height) &#123; var maxArea = 0; var i = 0; var j = height.length - 1; while (i &lt; j) &#123; const long = Math.min(height[i], height[j]); const area = long * (j - i); if (area &gt; maxArea) &#123; maxArea = area; &#125; if (height[i] &lt; height[j]) &#123; i++; &#125; else &#123; j--; &#125; &#125; return maxArea;&#125;; [15] 3SumGiven an array nums of n integers, are there elements a, b, c in nums such that a + b + c = 0? Find all unique triplets in the array which gives the sum of zero.Note: The solution set must not contain duplicate triplets.éš¾åº¦ï¼šMedium (23.55%)æ€è·¯ï¼š æ•°ç»„æ’åºï¼ˆå‡åºï¼‰ è®¾å®šä¸‰ä¸ªæŒ‡é’ˆï¼Œæœ€å¤–å±‚å¾ªç¯ä» 0 å¼€å§‹ï¼Œåˆ°æ•°ç»„çš„å°¾ç»“æŸï¼ˆi=0ï¼‰ ç¬¬äºŒå±‚å¾ªç¯ï¼Œä¸€ä¸ªæŒ‡å‘ä¸Šä¸€ä¸ªæŒ‡é’ˆçš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼ˆj=i+1ï¼‰ï¼Œå¦ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„å°¾éƒ¨(k=nums.length-1) å¦‚æœä¸‰ä¸ªå…ƒç´ ä¹‹å’Œç­‰äº 0ï¼Œåˆ™ push è¿›è¦è¿”å›çš„æ•°ç»„ä¸­ï¼›å¦‚æœä¸‰ä¸ªå…ƒç´ ä¹‹å’Œå¤§äº 0ï¼Œè¯´æ˜ç¬¬ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ è¿‡å¤§ï¼Œåˆ™ç¬¬ä¸‰ä¸ªæŒ‡é’ˆå‘å‰ç§»(kâ€“);å¦‚æœä¸‰ä¸ªå…ƒç´ ä¹‹å’Œå°äº 0ï¼Œè¯´æ˜ç¬¬äºŒä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ è¿‡å°ï¼Œåˆ™ç¬¬äºŒä¸ªæŒ‡é’ˆå‘åç§»(j++); 123456789101112131415161718192021222324252627282930313233343536var threeSum = function(nums) &#123; var rtn = []; if (nums.length &lt; 3) &#123; return rtn; &#125; nums = nums.sort(function(a, b) &#123; return a - b; &#125;); for (var i = 0; i &lt; nums.length - 1; i++) &#123; if (nums[i] &gt; 0) &#123; return rtn; &#125; if (i &gt; 0 &amp;&amp; nums[i] == nums[i - 1]) &#123; continue; &#125; for (var j = i + 1, k = nums.length - 1; j &lt; k; ) &#123; if (nums[i] + nums[j] + nums[k] === 0) &#123; rtn.push([nums[i], nums[j], nums[k]]); j++; k--; while (j &lt; k &amp;&amp; nums[j] == nums[j - 1]) &#123; j++; &#125; while (j &lt; k &amp;&amp; nums[k] == nums[k + 1]) &#123; k--; &#125; &#125; else if (nums[i] + nums[j] + nums[k] &gt; 0) &#123; k--; &#125; else &#123; j++; &#125; &#125; &#125; return rtn;&#125;; [16] 3Sum ClosestGiven an array nums of n integers and an integer target, find three integers in nums such that the sum is closest to target. Return the sum of the three integers. You may assume that each input would have exactly one solution.éš¾åº¦ï¼šMedium (41.40%)æ€è·¯ï¼šä¸ä¸Šé¢˜ç±»ä¼¼ 12345678910111213141516171819202122232425262728var threeSumClosest = function(nums, target) &#123; var sum; if (nums.length &lt; 3) &#123; return sum; &#125; nums = nums.sort(function(a, b) &#123; return a - b; &#125;); var sum = nums[0] + nums[1] + nums[2]; var distance = Math.abs(sum - target); for (var i = 0; i &lt; nums.length - 2; i++) &#123; for (var j = i + 1, k = nums.length - 1; j &lt; k; ) &#123; if (Math.abs(nums[i] + nums[j] + nums[k] - target) &lt; distance) &#123; sum = nums[i] + nums[j] + nums[k]; distance = Math.abs(sum - target); &#125; if (nums[i] + nums[j] + nums[k] === target) &#123; break; &#125; if (nums[i] + nums[j] + nums[k] &gt; target) &#123; k--; &#125; else if (nums[i] + nums[j] + nums[k] &lt; target) &#123; j++; &#125; &#125; &#125; return sum;&#125;; [18] 4SumGiven an array nums of n integers and an integer target, are there elements a, b, c, and d in nums such that a + b + c + d = target? Find all unique quadruplets in the array which gives the sum of target.Note: The solution set must not contain duplicate quadruplets.éš¾åº¦ï¼šMedium (29.83%)æ€è·¯ï¼šæ€è·¯åŒ 3Sumï¼Œå¤šä¸€å±‚å¾ªç¯ã€‚æ³¨æ„è·³è¿‡ç›¸åŒçš„æ•°ï¼ˆæœ€å¤–ä¸¤å±‚çš„å¾ªç¯å˜é‡ï¼‰ 1234567891011121314151617181920212223242526272829303132333435363738var fourSum = function(nums, target) &#123; var rtn = []; if (nums.length &lt; 4) &#123; return rtn; &#125; nums = nums.sort(function(a, b) &#123; return a - b; &#125;); for (var m = 0; m &lt; nums.length - 3; m++) &#123; var complement = target - nums[m]; for (var i = m + 1; i &lt; nums.length - 2; i++) &#123; for (var j = i + 1, k = nums.length - 1; j &lt; k; ) &#123; if (nums[i] + nums[j] + nums[k] === complement) &#123; rtn.push([nums[m], nums[i], nums[j], nums[k]]); j++; k--; while (j &lt; k &amp;&amp; nums[j] == nums[j - 1]) &#123; j++; &#125; while (j &lt; k &amp;&amp; nums[k] == nums[k + 1]) &#123; k--; &#125; &#125; else if (nums[i] + nums[j] + nums[k] &gt; complement) &#123; k--; &#125; else &#123; j++; &#125; if (i &lt; nums.length - 1 &amp;&amp; nums[i] == nums[i + 1]) &#123; ++i; &#125; &#125; if (m &lt; nums.length - 1 &amp;&amp; nums[m] == nums[m + 1]) &#123; ++m; &#125; &#125; &#125; return rtn;&#125;; [26] Remove Duplicates from Sorted ArrayGiven a sorted array nums, remove the duplicates in-place such that each element appear only once and return the new length.Do not allocate extra space for another array, you must do this by modifying the input array in-place with O(1) extra memory.éš¾åº¦ï¼šEasy (39.80%)æ€è·¯ï¼šä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡é’ˆè´Ÿè´£å¯»æ‰¾å’Œåä¸€ä¸ªä¸ç›¸ç­‰çš„æ•°ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆè´Ÿè´£ä¸€æ­¥æ­¥å‘åç§»å»é‡ã€‚ 1234567891011121314151617181920var removeDuplicates = function(nums) &#123; if (nums.length == 0) &#123; return 0; &#125; var i = 0; var j = 0; for (i = 0; i &lt; nums.length - 1; ) &#123; if (nums[i] === nums[i + 1]) &#123; i++; &#125; else &#123; if (i !== j) &#123; nums[j + 1] = nums[i + 1]; &#125; j++; i++; &#125; &#125; nums = nums.slice(0, j + 1); return nums.length;&#125;; [27] Remove ElementGiven an array nums and a value val, remove all instances of that value in-place and return the new length.Do not allocate extra space for another array, you must do this by modifying the input array in-place with O(1) extra memory.The order of elements can be changed. It doesnâ€™t matter what you leave beyond the new length.éš¾åº¦ï¼šEasy (43.73%)æ€è·¯ï¼šæ‰¾åˆ°å’Œ val å€¼ç›¸ç­‰çš„ä½ç½®ï¼Œå°†æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ èµ‹å€¼è¿‡æ¥ï¼ˆå»æ‰è¿™ä¸ª valï¼Œæ•°ç»„é•¿åº¦å‡ä¸€ï¼‰ 12345678910111213var removeElement = function(nums, val) &#123; var i = 0; var n = nums.length; for (i = 0; i &lt; n; ) &#123; if (nums[i] == val) &#123; nums[i] = nums[n - 1]; n--; &#125; else &#123; i++; &#125; &#125; return n;&#125;; [31] Next PermutationImplement next permutation, which rearranges numbers into the lexicographically next greater permutation of numbers.If such arrangement is not possible, it must rearrange it as the lowest possible order (ie, sorted in ascending order).The replacement must be in-place and use only constant extra memory.Here are some examples. Inputs are in the left-hand column and its corresponding outputs are in the right-hand column.1,2,3 â†’ 1,3,23,2,1 â†’ 1,2,31,1,5 â†’ 1,5,1éš¾åº¦ï¼šMedium (30.09%)æ€è·¯ï¼š ä»åå‘å‰æ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ ï¼Œç›´åˆ°å‰ä¸€ä¸ªå…ƒç´ å°äºåä¸€ä¸ªå…ƒç´ ï¼Œåœæ­¢ï¼ˆiï¼‰ã€‚ è‹¥å·²ç»æ²¡æœ‰äº†å‰ä¸€ä¸ªå…ƒç´ ï¼ˆi=0ï¼‰ï¼Œåˆ™è¯¥åºåˆ—ä¸ºé€’å‡åºåˆ—ï¼Œæ²¡æœ‰ Next Permutationã€‚æŒ‰ç…§é¢˜ç›®è¦æ±‚ï¼Œç›´æ¥åè½¬åºåˆ—ã€‚ å‰ä¸€ä¸ªå…ƒç´ ï¼ˆj=i-1ï¼‰å°äºåä¸€ä¸ªå…ƒç´ ï¼ˆiï¼‰ï¼Œæ‰¾åˆ°å‰ä¸€ä¸ªå…ƒç´ ï¼ˆjï¼‰è¦äº¤æ¢çš„å…ƒç´ ï¼Œä» i çš„åä¸€ä¸ªå…ƒç´ å¼€å§‹å¾€åæŸ¥æ‰¾ï¼Œæ‰¾åˆ°æœ€åä¸€ä¸ªæ¯”â€œå‰ä¸€ä¸ªå…ƒç´ ï¼ˆjï¼‰â€å¤§çš„å…ƒç´ ï¼ˆkï¼‰ï¼Œä¹Ÿå°±æ˜¯å†å¾€åçš„å…ƒç´ ï¼Œå°±æ¯”å…ƒç´  j å°äº†ã€‚äº¤æ¢ j å’Œ k å…ƒç´ ã€‚ ä» i å¼€å§‹ï¼ŒåŒ…æ‹¬ i åˆ°åºåˆ—çš„å°¾éƒ¨ï¼Œåè½¬ã€‚åˆ™å¾—å‡ºçš„å³æ˜¯ Next Permutation 1234567891011121314151617181920212223var nextPermutation = function(nums) &#123; var i = nums.length - 1; while (nums[i] &lt;= nums[i - 1]) &#123; i--; &#125; if (i !== 0) &#123; var j = i - 1; var k = i + 1; while (nums[j] &lt; nums[k]) &#123; k++; &#125; var temp = nums[k - 1]; nums[k - 1] = nums[j]; nums[j] = temp; for (var m = i, n = nums.length - 1; m &lt; n; m++, n--) &#123; var temp = nums[n]; nums[n] = nums[m]; nums[m] = temp; &#125; &#125; else &#123; nums = nums.reverse(); &#125;&#125;; [33] Search in Rotated Sorted ArraySuppose an array sorted in ascending order is rotated at some pivot unknown to you beforehand.(i.e., [0,1,2,4,5,6,7] might become [4,5,6,7,0,1,2]).You are given a target value to search. If found in the array return its index, otherwise return -1.You may assume no duplicate exists in the array.Your algorithmâ€™s runtime complexity must be in the order of O(log n).éš¾åº¦ï¼šMedium (32.68%)è€ƒç‚¹ï¼šäºŒåˆ†æ³•æ³¨æ„ï¼šåˆ¤æ–­å’Œå¾ªç¯çš„è¾¹ç•Œæ¡ä»¶ 123456789101112131415161718192021222324252627var search = function(nums, target) &#123; if (nums.length == 0) &#123; return -1; &#125; var start = 0; var end = nums.length - 1; while (start &lt;= end) &#123; var middle = parseInt((start + end) / 2); if (nums[middle] == target) &#123; return middle; &#125; if (nums[middle] &gt; nums[end]) &#123; if (target &gt;= nums[start] &amp;&amp; target &lt; nums[middle]) &#123; end = middle - 1; &#125; else &#123; start = middle + 1; &#125; &#125; else &#123; if (target &gt; nums[middle] &amp;&amp; target &lt;= nums[end]) &#123; start = middle + 1; &#125; else &#123; end = middle - 1; &#125; &#125; &#125; return -1;&#125;; [34] Find First and Last Position of Element in Sorted ArrayGiven an array of integers nums sorted in ascending order, find the starting and ending position of a given target value.Your algorithmâ€™s runtime complexity must be in the order of O(log n).If the target is not found in the array, return [-1, -1].éš¾åº¦ï¼šMedium (33.06%)è€ƒç‚¹ï¼šäºŒåˆ†æ³•æ³¨æ„ï¼šåˆ¤æ–­å’Œå¾ªç¯çš„è¾¹ç•Œæ¡ä»¶ 123456789101112131415161718192021222324252627282930var searchRange = function(nums, target) &#123; if (nums.length == 0) &#123; return [-1, -1]; &#125; var startFind = 0; var endFind = nums.length - 1; var start; var end; while (startFind &lt;= endFind) &#123; var mid = parseInt((startFind + endFind) / 2); if (nums[mid] == target) &#123; start = mid; end = mid; while (nums[start - 1] == target || nums[end + 1] == target) &#123; if (nums[start - 1] == target) &#123; start--; &#125; if (nums[end + 1] == target) &#123; end++; &#125; &#125; return [start, end]; &#125; else if (nums[mid] &lt; target) &#123; startFind = mid + 1; &#125; else &#123; endFind = mid - 1; &#125; &#125; return [-1, -1];&#125;; [35] Search Insert PositionGiven a sorted array and a target value, return the index if the target is found. If not, return the index where it would be if it were inserted in order.You may assume no duplicates in the array.éš¾åº¦ï¼šEasy (40.50%) 123456789101112var searchInsert = function(nums, target) &#123; if (nums.length == 0) &#123; return 0; &#125; let out = nums.indexOf(target); if (out == -1) &#123; let i = 0; for (; target &gt; nums[i]; i++) &#123;&#125; out = i; &#125; return out;&#125;; [39] Combination SumGiven a set of candidate numbers (candidates) (without duplicates) and a target number (target), find all unique combinations in candidates where the candidate numbers sums to target.The same repeated number may be chosen from candidates unlimited number of times.Note:All numbers (including target) will be positive integers.The solution set must not contain duplicate combinations.éš¾åº¦ï¼šMedium (46.97%)è€ƒç‚¹ï¼šé€’å½’ 12345678910111213141516171819202122232425262728var combinationSum = function(candidates, target) &#123; var rt = []; var solution = []; if (candidates.length == 0) &#123; return rt; &#125; candidates = candidates.sort(function(a, b) &#123; return a - b; &#125;); sarch(0, target); function sarch(start, target) &#123; if (start == candidates.length) &#123; return; &#125; if (target == 0) &#123; return rt.push(solution.slice()); &#125; if (target &lt; 0) &#123; return; &#125; solution.push(candidates[start]); sarch(start, target - candidates[start]); solution.pop(); sarch(start + 1, target); &#125; return rt;&#125;; [40] Combination Sum IIGiven a collection of candidate numbers (candidates) and a target number (target), find all unique combinations in candidates where the candidate numbers sums to target.Each number in candidates may only be used once in the combination.Note:All numbers (including target) will be positive integers.The solution set must not contain duplicate combinations.éš¾åº¦ï¼šMedium (40.37%)è€ƒç‚¹ï¼šé€’å½’æ³¨æ„ï¼šé™åˆ¶è¾¹ç•Œæ¡ä»¶ï¼Œè¿‡æ»¤é‡å¤çš„ç»“æœ 12345678910111213141516171819202122232425262728var combinationSum2 = function(candidates, target) &#123; var rt = []; var solution = []; if (candidates.length == 0) &#123; return rt; &#125; candidates = candidates.sort(function(a, b) &#123; return a - b; &#125;); search(0, target); return rt; function search(start, target) &#123; if (target === 0 &amp;&amp; start === candidates.length) &#123; return rt.push(solution.slice()); &#125; if (target &lt; 0 || start === candidates.length) &#123; return; &#125; solution.push(candidates[start]); search(start + 1, target - candidates[start]); solution.pop(); if (solution[solution.length - 1] !== candidates[start]) &#123; search(start + 1, target); &#125; &#125;&#125;;","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/categories/ç®—æ³•/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://yoursite.com/tags/LeetCode/"},{"name":"æ•°ç»„","slug":"æ•°ç»„","permalink":"http://yoursite.com/tags/æ•°ç»„/"}]},{"title":"webpackåŸºç¡€çŸ¥è¯†ï¼ˆäºŒï¼‰","slug":"webpackåŸºç¡€çŸ¥è¯†ï¼ˆäºŒï¼‰","date":"2018-12-05T07:12:28.000Z","updated":"2019-09-21T14:06:57.241Z","comments":true,"path":"2018/12/05/webpackåŸºç¡€çŸ¥è¯†ï¼ˆäºŒï¼‰/","link":"","permalink":"http://yoursite.com/2018/12/05/webpackåŸºç¡€çŸ¥è¯†ï¼ˆäºŒï¼‰/","excerpt":"ä»£ç åˆ†ç¦»ä»£ç åˆ†ç¦»æ˜¯ webpack ä¸­æœ€å¼•äººæ³¨ç›®çš„ç‰¹æ€§ä¹‹ä¸€ã€‚æ­¤ç‰¹æ€§èƒ½å¤ŸæŠŠä»£ç åˆ†ç¦»åˆ°ä¸åŒçš„ bundle ä¸­ï¼Œç„¶åå¯ä»¥æŒ‰éœ€åŠ è½½æˆ–å¹¶è¡ŒåŠ è½½è¿™äº›æ–‡ä»¶ã€‚ä»£ç åˆ†ç¦»å¯ä»¥ç”¨äºè·å–æ›´å°çš„ bundleï¼Œä»¥åŠæ§åˆ¶èµ„æºåŠ è½½ä¼˜å…ˆçº§ï¼Œå¦‚æœä½¿ç”¨åˆç†ï¼Œä¼šæå¤§å½±å“åŠ è½½æ—¶é—´ã€‚ æœ‰ä¸‰ç§å¸¸ç”¨çš„ä»£ç åˆ†ç¦»æ–¹æ³•ï¼š å…¥å£èµ·ç‚¹ï¼šä½¿ç”¨ entry é…ç½®æ‰‹åŠ¨åœ°åˆ†ç¦»ä»£ç ã€‚ é˜²æ­¢é‡å¤ï¼šä½¿ç”¨ CommonsChunkPlugin å»é‡å’Œåˆ†ç¦» chunkã€‚ åŠ¨æ€å¯¼å…¥ï¼šé€šè¿‡æ¨¡å—çš„å†…è”å‡½æ•°è°ƒç”¨æ¥åˆ†ç¦»ä»£ç ã€‚","text":"ä»£ç åˆ†ç¦»ä»£ç åˆ†ç¦»æ˜¯ webpack ä¸­æœ€å¼•äººæ³¨ç›®çš„ç‰¹æ€§ä¹‹ä¸€ã€‚æ­¤ç‰¹æ€§èƒ½å¤ŸæŠŠä»£ç åˆ†ç¦»åˆ°ä¸åŒçš„ bundle ä¸­ï¼Œç„¶åå¯ä»¥æŒ‰éœ€åŠ è½½æˆ–å¹¶è¡ŒåŠ è½½è¿™äº›æ–‡ä»¶ã€‚ä»£ç åˆ†ç¦»å¯ä»¥ç”¨äºè·å–æ›´å°çš„ bundleï¼Œä»¥åŠæ§åˆ¶èµ„æºåŠ è½½ä¼˜å…ˆçº§ï¼Œå¦‚æœä½¿ç”¨åˆç†ï¼Œä¼šæå¤§å½±å“åŠ è½½æ—¶é—´ã€‚ æœ‰ä¸‰ç§å¸¸ç”¨çš„ä»£ç åˆ†ç¦»æ–¹æ³•ï¼š å…¥å£èµ·ç‚¹ï¼šä½¿ç”¨ entry é…ç½®æ‰‹åŠ¨åœ°åˆ†ç¦»ä»£ç ã€‚ é˜²æ­¢é‡å¤ï¼šä½¿ç”¨ CommonsChunkPlugin å»é‡å’Œåˆ†ç¦» chunkã€‚ åŠ¨æ€å¯¼å…¥ï¼šé€šè¿‡æ¨¡å—çš„å†…è”å‡½æ•°è°ƒç”¨æ¥åˆ†ç¦»ä»£ç ã€‚ å…¥å£èµ·ç‚¹(entry points)é—®é¢˜ï¼š å¦‚æœå…¥å£ chunks ä¹‹é—´åŒ…å«é‡å¤çš„æ¨¡å—ï¼Œé‚£äº›é‡å¤æ¨¡å—éƒ½ä¼šè¢«å¼•å…¥åˆ°å„ä¸ª bundle ä¸­ã€‚ è¿™ç§æ–¹æ³•ä¸å¤Ÿçµæ´»ï¼Œå¹¶ä¸”ä¸èƒ½å°†æ ¸å¿ƒåº”ç”¨ç¨‹åºé€»è¾‘è¿›è¡ŒåŠ¨æ€æ‹†åˆ†ä»£ç ã€‚ é˜²æ­¢é‡å¤(prevent duplication)CommonsChunkPlugin æ’ä»¶å¯ä»¥å°†å…¬å…±çš„ä¾èµ–æ¨¡å—æå–åˆ°å·²æœ‰çš„å…¥å£ chunk ä¸­ï¼Œæˆ–è€…æå–åˆ°ä¸€ä¸ªæ–°ç”Ÿæˆçš„ chunkã€‚ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œå¯å°†é‡å¤çš„ lodash æ¨¡å—å»é™¤ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCommonsChunkPlugin æ’ä»¶å°† lodash åˆ†ç¦»åˆ°å•ç‹¬çš„ chunkï¼Œå¹¶ä¸”å°†å…¶ä» main bundle ä¸­ç§»é™¤ï¼Œå‡è½»äº†å¤§å°ã€‚ ä»¥ä¸‹æ˜¯ç”±ç¤¾åŒºæä¾›çš„ï¼Œä¸€äº›å¯¹äºä»£ç åˆ†ç¦»å¾ˆæœ‰å¸®åŠ©çš„æ’ä»¶å’Œ loadersï¼š ExtractTextPlugin: ç”¨äºå°† CSS ä»ä¸»åº”ç”¨ç¨‹åºä¸­åˆ†ç¦»ã€‚ bundle-loader: ç”¨äºåˆ†ç¦»ä»£ç å’Œå»¶è¿ŸåŠ è½½ç”Ÿæˆçš„ bundleã€‚ promise-loader: ç±»ä¼¼äº bundle-loader ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ˜¯ promisesã€‚ CommonsChunkPlugin æ’ä»¶è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨æ˜¾å¼çš„ vendor chunks åŠŸèƒ½ï¼Œä»åº”ç”¨ç¨‹åºä»£ç ä¸­åˆ†ç¦» vendor æ¨¡å—ã€‚ åŠ¨æ€å¯¼å…¥(dynamic imports)å½“æ¶‰åŠåˆ°åŠ¨æ€ä»£ç æ‹†åˆ†æ—¶ï¼Œwebpack æä¾›äº†ä¸¤ä¸ªç±»ä¼¼çš„æŠ€æœ¯ã€‚å¯¹äºåŠ¨æ€å¯¼å…¥ï¼Œç¬¬ä¸€ç§ï¼Œä¹Ÿæ˜¯ä¼˜å…ˆé€‰æ‹©çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨ç¬¦åˆ ECMAScript ææ¡ˆ çš„ import() è¯­æ³•ã€‚ç¬¬äºŒç§ï¼Œåˆ™æ˜¯ä½¿ç”¨ webpack ç‰¹å®šçš„ require.ensureã€‚ æ‡’åŠ è½½æ‡’åŠ è½½æˆ–è€…æŒ‰éœ€åŠ è½½ï¼Œæ˜¯ä¸€ç§å¾ˆå¥½çš„ä¼˜åŒ–ç½‘é¡µæˆ–åº”ç”¨çš„æ–¹å¼ã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯å…ˆæŠŠä½ çš„ä»£ç åœ¨ä¸€äº›é€»è¾‘æ–­ç‚¹å¤„åˆ†ç¦»å¼€ï¼Œç„¶ååœ¨ä¸€äº›ä»£ç å—ä¸­å®ŒæˆæŸäº›æ“ä½œåï¼Œç«‹å³å¼•ç”¨æˆ–å³å°†å¼•ç”¨å¦å¤–ä¸€äº›æ–°çš„ä»£ç å—ã€‚è¿™æ ·åŠ å¿«äº†åº”ç”¨çš„åˆå§‹åŠ è½½é€Ÿåº¦ï¼Œå‡è½»äº†å®ƒçš„æ€»ä½“ä½“ç§¯ï¼Œå› ä¸ºæŸäº›ä»£ç å—å¯èƒ½æ°¸è¿œä¸ä¼šè¢«åŠ è½½ã€‚ ç¼“å­˜æˆ‘ä»¬ä½¿ç”¨ webpack æ¥æ‰“åŒ…æˆ‘ä»¬çš„æ¨¡å—åŒ–åçš„åº”ç”¨ç¨‹åºï¼Œwebpack ä¼šç”Ÿæˆä¸€ä¸ªå¯éƒ¨ç½²çš„ /dist ç›®å½•ï¼Œç„¶åæŠŠæ‰“åŒ…åçš„å†…å®¹æ”¾ç½®åœ¨æ­¤ç›®å½•ä¸­ã€‚åªè¦ /dist ç›®å½•ä¸­çš„å†…å®¹éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œå®¢æˆ·ç«¯ï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼‰å°±èƒ½å¤Ÿè®¿é—®ç½‘ç«™æ­¤æœåŠ¡å™¨çš„ç½‘ç«™åŠå…¶èµ„æºã€‚è€Œæœ€åä¸€æ­¥è·å–èµ„æºæ˜¯æ¯”è¾ƒè€—è´¹æ—¶é—´çš„ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨ç¼“å­˜æŠ€æœ¯ã€‚ä»¥é€šè¿‡å‘½ä¸­ç¼“å­˜ï¼Œä»¥é™ä½ç½‘ç»œæµé‡ï¼Œä½¿ç½‘ç«™åŠ è½½é€Ÿåº¦æ›´å¿«ï¼Œç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬åœ¨éƒ¨ç½²æ–°ç‰ˆæœ¬æ—¶ä¸æ›´æ”¹èµ„æºçš„æ–‡ä»¶åï¼Œæµè§ˆå™¨å¯èƒ½ä¼šè®¤ä¸ºå®ƒæ²¡æœ‰è¢«æ›´æ–°ï¼Œå°±ä¼šä½¿ç”¨å®ƒçš„ç¼“å­˜ç‰ˆæœ¬ã€‚ç”±äºç¼“å­˜çš„å­˜åœ¨ï¼Œå½“ä½ éœ€è¦è·å–æ–°çš„ä»£ç æ—¶ï¼Œå°±ä¼šæ˜¾å¾—å¾ˆæ£˜æ‰‹ã€‚æ‰€ä»¥éœ€è¦é€šè¿‡å¿…è¦çš„é…ç½®ï¼Œä»¥ç¡®ä¿ webpack ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶èƒ½å¤Ÿè¢«å®¢æˆ·ç«¯ç¼“å­˜ï¼Œè€Œåœ¨æ–‡ä»¶å†…å®¹å˜åŒ–åï¼Œèƒ½å¤Ÿè¯·æ±‚åˆ°æ–°çš„æ–‡ä»¶ã€‚ è¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å(Output Filenames)é€šè¿‡ä½¿ç”¨ output.filename è¿›è¡Œæ–‡ä»¶åæ›¿æ¢ï¼Œå¯ä»¥ç¡®ä¿æµè§ˆå™¨è·å–åˆ°ä¿®æ”¹åçš„æ–‡ä»¶ã€‚[hash] æ›¿æ¢å¯ä»¥ç”¨äºåœ¨æ–‡ä»¶åä¸­åŒ…å«ä¸€ä¸ªæ„å»ºç›¸å…³(build-specific)çš„ hashï¼Œä½†æ˜¯æ›´å¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨ [chunkhash] æ›¿æ¢ï¼Œåœ¨æ–‡ä»¶åä¸­åŒ…å«ä¸€ä¸ª chunk ç›¸å…³(chunk-specific)çš„å“ˆå¸Œã€‚ æå–æ¨¡æ¿(Extracting Boilerplate)CommonsChunkPlugin å¯ä»¥ç”¨äºå°†æ¨¡å—åˆ†ç¦»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œè¿˜èƒ½å¤Ÿåœ¨æ¯æ¬¡ä¿®æ”¹åçš„æ„å»ºç»“æœä¸­ï¼Œå°† webpack çš„æ ·æ¿(boilerplate)å’Œ manifest æå–å‡ºæ¥ã€‚é€šè¿‡æŒ‡å®š entry é…ç½®ä¸­æœªç”¨åˆ°çš„åç§°ï¼Œæ­¤æ’ä»¶ä¼šè‡ªåŠ¨å°†æˆ‘ä»¬éœ€è¦çš„å†…å®¹æå–åˆ°å•ç‹¬çš„åŒ…ä¸­ï¼š 12345678910111213141516171819202122const path = require('path');+ const webpack = require('webpack'); const CleanWebpackPlugin = require('clean-webpack-plugin'); const HtmlWebpackPlugin = require('html-webpack-plugin'); module.exports = &#123; entry: './src/index.js', plugins: [ new CleanWebpackPlugin(['dist']), new HtmlWebpackPlugin(&#123; title: 'Caching'- &#125;)+ &#125;),+ new webpack.optimize.CommonsChunkPlugin(&#123;+ name: 'manifest'+ &#125;) ], output: &#123; filename: '[name].[chunkhash].js', path: path.resolve(__dirname, 'dist') &#125; &#125;; å°†ç¬¬ä¸‰æ–¹åº“(library)ï¼ˆä¾‹å¦‚ lodash æˆ– reactï¼‰æå–åˆ°å•ç‹¬çš„ vendor chunk æ–‡ä»¶ä¸­ï¼Œæ˜¯æ¯”è¾ƒæ¨èçš„åšæ³•ï¼Œè¿™æ˜¯å› ä¸ºï¼Œå®ƒä»¬å¾ˆå°‘åƒæœ¬åœ°çš„æºä»£ç é‚£æ ·é¢‘ç¹ä¿®æ”¹ã€‚å› æ­¤é€šè¿‡å®ç°ä»¥ä¸Šæ­¥éª¤ï¼Œåˆ©ç”¨å®¢æˆ·ç«¯çš„é•¿æ•ˆç¼“å­˜æœºåˆ¶ï¼Œå¯ä»¥é€šè¿‡å‘½ä¸­ç¼“å­˜æ¥æ¶ˆé™¤è¯·æ±‚ï¼Œå¹¶å‡å°‘å‘æœåŠ¡å™¨è·å–èµ„æºï¼ŒåŒæ—¶è¿˜èƒ½ä¿è¯å®¢æˆ·ç«¯ä»£ç å’ŒæœåŠ¡å™¨ç«¯ä»£ç ç‰ˆæœ¬ä¸€è‡´ã€‚ æ¨¡å—æ ‡è¯†ç¬¦(Module Identifiers)æ¯ä¸ª module.id ä¼šåŸºäºé»˜è®¤çš„è§£æé¡ºåº(resolve order)è¿›è¡Œå¢é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è§£æé¡ºåºå‘ç”Ÿå˜åŒ–ï¼ŒID ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚ å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ’ä»¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç¬¬ä¸€ä¸ªæ’ä»¶æ˜¯ NamedModulesPluginï¼Œå°†ä½¿ç”¨æ¨¡å—çš„è·¯å¾„ï¼Œè€Œä¸æ˜¯æ•°å­—æ ‡è¯†ç¬¦ã€‚è™½ç„¶æ­¤æ’ä»¶æœ‰åŠ©äºåœ¨å¼€å‘è¿‡ç¨‹ä¸­è¾“å‡ºç»“æœçš„å¯è¯»æ€§ï¼Œç„¶è€Œæ‰§è¡Œæ—¶é—´ä¼šé•¿ä¸€äº›ã€‚ç¬¬äºŒä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨ HashedModuleIdsPluginï¼Œæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒæ„å»ºã€‚ libraryå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æš´éœ² libraryï¼š å˜é‡ï¼šä½œä¸ºä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé€šè¿‡ script æ ‡ç­¾æ¥è®¿é—®ï¼ˆlibraryTarget:â€™varâ€™ï¼‰ã€‚ thisï¼šé€šè¿‡ this å¯¹è±¡è®¿é—®ï¼ˆlibraryTarget:â€™thisâ€™ï¼‰ã€‚ windowï¼šé€šè¿‡ window å¯¹è±¡è®¿é—®ï¼Œåœ¨æµè§ˆå™¨ä¸­ï¼ˆlibraryTarget:â€™windowâ€™ï¼‰ã€‚ UMDï¼šåœ¨ AMD æˆ– CommonJS çš„ require ä¹‹åå¯è®¿é—®ï¼ˆlibraryTarget:â€™umdâ€™ï¼‰ã€‚å¦‚æœè®¾ç½®äº† library ä½†æ²¡è®¾ç½® libraryTargetï¼Œåˆ™ libraryTarget é»˜è®¤ä¸º var shimmingä¸€äº›ç¬¬ä¸‰æ–¹çš„åº“(library)å¯èƒ½ä¼šå¼•ç”¨ä¸€äº›å…¨å±€ä¾èµ–ï¼ˆä¾‹å¦‚ jQuery ä¸­çš„ $ï¼‰ã€‚è¿™äº›åº“ä¹Ÿå¯èƒ½åˆ›å»ºä¸€äº›éœ€è¦è¢«å¯¼å‡ºçš„å…¨å±€å˜é‡ã€‚è¿™äº›â€œä¸ç¬¦åˆè§„èŒƒçš„æ¨¡å—â€å°±æ˜¯ shimming å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚ shimming å…¨å±€å˜é‡ä½¿ç”¨ ProvidePlugin åï¼Œèƒ½å¤Ÿåœ¨é€šè¿‡ webpack ç¼–è¯‘çš„æ¯ä¸ªæ¨¡å—ä¸­ï¼Œé€šè¿‡è®¿é—®ä¸€ä¸ªå˜é‡æ¥è·å–åˆ° package åŒ…ã€‚å¦‚æœ webpack çŸ¥é“è¿™ä¸ªå˜é‡åœ¨æŸä¸ªæ¨¡å—ä¸­è¢«ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆ webpack å°†åœ¨æœ€ç»ˆ bundle ä¸­å¼•å…¥æˆ‘ä»¬ç»™å®šçš„ packageã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ ProvidePlugin æš´éœ²æŸä¸ªæ¨¡å—ä¸­å•ä¸ªå¯¼å‡ºå€¼ï¼Œåªéœ€é€šè¿‡ä¸€ä¸ªâ€œæ•°ç»„è·¯å¾„â€è¿›è¡Œé…ç½®ï¼ˆä¾‹å¦‚ [module, child, â€¦children?]ï¼‰ src/index.js 12345678910 function component() &#123; var element = document.createElement('div');- element.innerHTML = _.join(['Hello', 'webpack'], ' ');+ element.innerHTML = join(['Hello', 'webpack'], ' '); return element; &#125; document.body.appendChild(component()); webpack.config.js 12345678910111213141516 const path = require('path'); const webpack = require('webpack'); module.exports = &#123; entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;, plugins: [ new webpack.ProvidePlugin(&#123;- _: 'lodash'+ join: ['lodash', 'join'] &#125;) ] &#125;; è¿™æ ·ï¼Œæ— è®º join æ–¹æ³•åœ¨ä½•å¤„è°ƒç”¨ï¼Œæˆ‘ä»¬éƒ½åªä¼šå¾—åˆ°çš„æ˜¯ lodash ä¸­æä¾›çš„ join æ–¹æ³•ã€‚ä¸ tree shaking é…åˆï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„å°† lodash åº“ä¸­çš„å…¶ä»–æ²¡ç”¨åˆ°çš„éƒ¨åˆ†å»é™¤ã€‚ ç»†ç²’åº¦ shimmingä¸€äº›ä¼ ç»Ÿçš„æ¨¡å—ä¾èµ–çš„ this æŒ‡å‘çš„æ˜¯ window å¯¹è±¡ã€‚å½“æ¨¡å—è¿è¡Œåœ¨ CommonJS ç¯å¢ƒä¸‹è¿™å°†ä¼šå˜æˆä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶çš„ this æŒ‡å‘çš„æ˜¯ module.exportsã€‚æ­¤æ—¶ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ imports-loader è¦†å†™ thisï¼š 1234567891011121314151617181920212223 const path = require('path'); const webpack = require('webpack'); module.exports = &#123; entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;,+ module: &#123;+ rules: [+ &#123;+ test: require.resolve('index.js'),+ use: 'imports-loader?this=&gt;window'+ &#125;+ ]+ &#125;, plugins: [ new webpack.ProvidePlugin(&#123; join: ['lodash', 'join'] &#125;) ] &#125;; å…¨å±€ exportsä½¿ç”¨ exports-loaderï¼Œå°†ä¸€ä¸ªå…¨å±€å˜é‡ä½œä¸ºä¸€ä¸ªæ™®é€šçš„æ¨¡å—æ¥å¯¼å‡ºã€‚ 12345678910111213141516171819202122232425262728 const path = require('path'); const webpack = require('webpack'); module.exports = &#123; entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;, module: &#123; rules: [ &#123; test: require.resolve('index.js'), use: 'imports-loader?this=&gt;window'- &#125;+ &#125;,+ &#123;+ test: require.resolve('globals.js'),+ use: 'exports-loader?file,parse=helpers.parse'+ &#125; ] &#125;, plugins: [ new webpack.ProvidePlugin(&#123; join: ['lodash', 'join'] &#125;) ] &#125;; æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºæ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº(Progressive Web Application - PWA)ï¼Œæ˜¯ä¸€ç§å¯ä»¥æä¾›ç±»ä¼¼äºåŸç”Ÿåº”ç”¨ç¨‹åº(native app)ä½“éªŒçš„ç½‘ç»œåº”ç”¨ç¨‹åº(web app)ã€‚PWA å¯ä»¥ç”¨æ¥åšå¾ˆå¤šäº‹ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯ï¼Œåœ¨ç¦»çº¿(offline)æ—¶åº”ç”¨ç¨‹åºèƒ½å¤Ÿç»§ç»­è¿è¡ŒåŠŸèƒ½ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨åä¸º Service Workers çš„ç½‘ç»œæŠ€æœ¯æ¥å®ç°çš„ã€‚ æ·»åŠ  Workbox æ³¨å†Œ Service Worker åœæ­¢æœåŠ¡å™¨å¹¶åˆ·æ–°é¡µé¢ã€‚å¦‚æœæµè§ˆå™¨èƒ½å¤Ÿæ”¯æŒ Service Workerï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ°ä½ çš„åº”ç”¨ç¨‹åºè¿˜åœ¨æ­£å¸¸è¿è¡Œã€‚ç„¶è€Œï¼ŒæœåŠ¡å™¨å·²ç»åœæ­¢äº†æœåŠ¡ï¼Œæ­¤åˆ»æ˜¯ Service Worker åœ¨æä¾›æœåŠ¡ã€‚ æ„å»ºæ€§èƒ½chunkså‡å°‘ç¼–è¯‘çš„æ•´ä½“å¤§å°ï¼Œä»¥æé«˜æ„å»ºæ€§èƒ½ã€‚å°½é‡ä¿æŒ chunks å°å·§ã€‚ ä½¿ç”¨ æ›´å°‘/æ›´å° çš„åº“ã€‚ åœ¨å¤šé¡µé¢åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ CommonsChunksPluginã€‚ åœ¨å¤šé¡µé¢åº”ç”¨ç¨‹åºä¸­ä»¥ async æ¨¡å¼ä½¿ç”¨ CommonsChunksPlugin ã€‚ ç§»é™¤ä¸ä½¿ç”¨çš„ä»£ç ã€‚ åªç¼–è¯‘ä½ å½“å‰æ­£åœ¨å¼€å‘éƒ¨åˆ†çš„ä»£ç ã€‚ æœ€å°åŒ–å…¥å£ chunkwebpack åªä¼šåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ç”Ÿæˆå·²ç»æ›´æ–°çš„ chunk ã€‚å¯¹äºæŸäº›é…ç½®é€‰é¡¹(HMR, [name]/[chunkhash] in output.chunkFilename, [hash])æ¥è¯´ï¼Œé™¤äº†æ›´æ–°çš„ chunks æ— æ•ˆä¹‹å¤–ï¼Œå…¥å£ chunk ä¹Ÿä¸ä¼šç”Ÿæ•ˆã€‚åº”å½“åœ¨ç”Ÿæˆå…¥å£ chunk æ—¶ï¼Œå°½é‡å‡å°‘å…¥å£ chunk çš„ä½“ç§¯ï¼Œä»¥æé«˜æ€§èƒ½ã€‚ä¸‹è¿°ä»£ç å—å°†åªæå–åŒ…å« runtime çš„ chunk ï¼Œå…¶ä»– chunk éƒ½ä½œä¸ºå­æ¨¡å—: 1234new CommonsChunkPlugin(&#123; name: \"manifest\", minChunks: Infinity&#125;); Worker Poolthread-loader å¯ä»¥å°†éå¸¸æ¶ˆè€—èµ„æºçš„ loaders è½¬å­˜åˆ° worker pool ä¸­ æŒä¹…åŒ–ç¼“å­˜ä½¿ç”¨ cache-loader å¯ç”¨æŒä¹…åŒ–ç¼“å­˜ã€‚ä½¿ç”¨ package.json ä¸­çš„ â€œpostinstallâ€ æ¸…é™¤ç¼“å­˜ç›®å½•ã€‚ Dllsä½¿ç”¨ DllPlugin å°†æ›´æ”¹ä¸é¢‘ç¹çš„ä»£ç è¿›è¡Œå•ç‹¬ç¼–è¯‘ã€‚è¿™å°†æ”¹å–„å¼•ç”¨ç¨‹åºçš„ç¼–è¯‘é€Ÿåº¦ï¼Œå³ä½¿å®ƒå¢åŠ äº†æ„å»ºè¿‡ç¨‹çš„å¤æ‚æ€§ã€‚ å…¬å…±è·¯å¾„(public path)webpack æä¾›ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„é…ç½®ï¼Œè¯¥é…ç½®èƒ½å¸®åŠ©ä½ ä¸ºé¡¹ç›®ä¸­çš„æ‰€æœ‰èµ„æºæŒ‡å®šä¸€ä¸ªåŸºç¡€è·¯å¾„ã€‚å®ƒè¢«ç§°ä¸ºå…¬å…±è·¯å¾„(publicPath)ã€‚webpack æä¾›ä¸€ä¸ªå…¨å±€å˜é‡ä¾›ä½ è®¾ç½®ï¼Œå®ƒåå« webpack_public_path 1__webpack_public_path__ = process.env.ASSET_PATH;","categories":[{"name":"å‰ç«¯å·¥å…·","slug":"å‰ç«¯å·¥å…·","permalink":"http://yoursite.com/categories/å‰ç«¯å·¥å…·/"}],"tags":[{"name":"webpack","slug":"webpack","permalink":"http://yoursite.com/tags/webpack/"}]},{"title":"webpackåŸºç¡€çŸ¥è¯†ï¼ˆä¸€ï¼‰","slug":"webpackåŸºç¡€çŸ¥è¯†ï¼ˆä¸€ï¼‰","date":"2018-11-25T04:03:08.000Z","updated":"2019-09-21T14:26:18.053Z","comments":true,"path":"2018/11/25/webpackåŸºç¡€çŸ¥è¯†ï¼ˆä¸€ï¼‰/","link":"","permalink":"http://yoursite.com/2018/11/25/webpackåŸºç¡€çŸ¥è¯†ï¼ˆä¸€ï¼‰/","excerpt":"åŸºæœ¬æ¦‚å¿µwebpack æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨(module bundler)ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šé€’å½’åœ°æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾(dependency graph)ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚é€šè¿‡å£°æ˜æ¨¡å—æ‰€éœ€çš„ä¾èµ–ï¼Œwebpack èƒ½å¤Ÿåˆ©ç”¨è¿™äº›ä¿¡æ¯å»æ„å»ºä¾èµ–å›¾ï¼Œç„¶åä½¿ç”¨å›¾ç”Ÿæˆä¸€ä¸ªä¼˜åŒ–è¿‡çš„ï¼Œä¼šä»¥æ­£ç¡®é¡ºåºæ‰§è¡Œçš„ bundleã€‚","text":"åŸºæœ¬æ¦‚å¿µwebpack æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨(module bundler)ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šé€’å½’åœ°æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾(dependency graph)ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚é€šè¿‡å£°æ˜æ¨¡å—æ‰€éœ€çš„ä¾èµ–ï¼Œwebpack èƒ½å¤Ÿåˆ©ç”¨è¿™äº›ä¿¡æ¯å»æ„å»ºä¾èµ–å›¾ï¼Œç„¶åä½¿ç”¨å›¾ç”Ÿæˆä¸€ä¸ªä¼˜åŒ–è¿‡çš„ï¼Œä¼šä»¥æ­£ç¡®é¡ºåºæ‰§è¡Œçš„ bundleã€‚ ä¾èµ–å›¾(dependency graph)ä»»ä½•æ—¶å€™ï¼Œä¸€ä¸ªæ–‡ä»¶ä¾èµ–äºå¦ä¸€ä¸ªæ–‡ä»¶ï¼Œwebpack å°±æŠŠæ­¤è§†ä¸ºæ–‡ä»¶ä¹‹é—´æœ‰ ä¾èµ–å…³ç³» ã€‚è¿™ä½¿å¾— webpack å¯ä»¥æ¥æ”¶éä»£ç èµ„æº(non-code asset)ï¼ˆä¾‹å¦‚å›¾åƒæˆ– web å­—ä½“ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æŠŠå®ƒä»¬ä½œä¸º ä¾èµ– æä¾›ç»™ä½ çš„åº”ç”¨ç¨‹åºã€‚ webpack ä»å‘½ä»¤è¡Œæˆ–é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„ä¸€ä¸ªæ¨¡å—åˆ—è¡¨å¼€å§‹ï¼Œå¤„ç†ä½ çš„åº”ç”¨ç¨‹åºã€‚ ä»è¿™äº› å…¥å£èµ·ç‚¹ å¼€å§‹ï¼Œwebpack é€’å½’åœ°æ„å»ºä¸€ä¸ª ä¾èµ–å›¾ ï¼Œè¿™ä¸ªä¾èµ–å›¾åŒ…å«ç€åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…ä¸ºå°‘é‡çš„ bundle - é€šå¸¸åªæœ‰ä¸€ä¸ª - å¯ç”±æµè§ˆå™¨åŠ è½½ã€‚ å…¥å£å…¥å£èµ·ç‚¹(entry point)æŒ‡ç¤º webpack åº”è¯¥ä½¿ç”¨å“ªä¸ªæ¨¡å—ï¼Œæ¥ä½œä¸ºæ„å»ºå…¶å†…éƒ¨ä¾èµ–å›¾çš„å¼€å§‹ã€‚è¿›å…¥å…¥å£èµ·ç‚¹åï¼Œwebpack ä¼šæ‰¾å‡ºæœ‰å“ªäº›æ¨¡å—å’Œåº“æ˜¯å…¥å£èµ·ç‚¹ï¼ˆç›´æ¥å’Œé—´æ¥ï¼‰ä¾èµ–çš„ã€‚æ¯ä¸ªä¾èµ–é¡¹éšå³è¢«å¤„ç†ï¼Œæœ€åè¾“å‡ºåˆ°ç§°ä¹‹ä¸º bundles çš„æ–‡ä»¶ä¸­ã€‚ 123module.exports = &#123; entry: \"./path/to/my/entry/file.js\"&#125;; å…¥å£é…ç½®æ”¯æŒï¼š å•ä¸ªå…¥å£è¯­æ³•æ³¨ï¼šå‘ entry ä¼ å…¥ä¸€ä¸ªã€Œæ–‡ä»¶è·¯å¾„(file path)æ•°ç»„ã€æ—¶å°†åˆ›å»ºâ€œå¤šä¸ªä¸»å…¥å£(multi-main entry)â€ã€‚åœ¨ä½ æƒ³è¦å¤šä¸ªä¾èµ–æ–‡ä»¶ä¸€èµ·æ³¨å…¥ï¼Œå¹¶ä¸”å°†å®ƒä»¬çš„ä¾èµ–å¯¼å‘(graph)åˆ°ä¸€ä¸ªâ€œchunkâ€æ—¶ï¼Œä¼ å…¥æ•°ç»„çš„æ–¹å¼å°±å¾ˆæœ‰ç”¨ã€‚ å¯¹è±¡è¯­æ³•è¿™æ˜¯åº”ç”¨ç¨‹åºä¸­å®šä¹‰å…¥å£çš„æœ€å¯æ‰©å±•çš„æ–¹å¼ã€‚ å‡ºå£(output)output å±æ€§å‘Šè¯‰ webpack åœ¨å“ªé‡Œè¾“å‡ºå®ƒæ‰€åˆ›å»ºçš„ bundlesï¼Œä»¥åŠå¦‚ä½•å‘½åè¿™äº›æ–‡ä»¶ï¼Œé»˜è®¤å€¼ä¸º ./distã€‚åŸºæœ¬ä¸Šï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºç»“æ„ï¼Œéƒ½ä¼šè¢«ç¼–è¯‘åˆ°ä½ æŒ‡å®šçš„è¾“å‡ºè·¯å¾„çš„æ–‡ä»¶å¤¹ä¸­ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨é…ç½®ä¸­æŒ‡å®šä¸€ä¸ª output å­—æ®µï¼Œæ¥é…ç½®è¿™äº›å¤„ç†è¿‡ç¨‹ï¼š 123456789const path = require(\"path\");module.exports = &#123; entry: \"./path/to/my/entry/file.js\", output: &#123; path: path.resolve(__dirname, \"dist\"), filename: \"my-first-webpack.bundle.js\" &#125;&#125;; filename ç”¨äºè¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶åã€‚ç›®æ ‡è¾“å‡ºç›®å½• path çš„ç»å¯¹è·¯å¾„ã€‚ æ³¨ï¼šå¦‚æœé…ç½®åˆ›å»ºäº†å¤šä¸ªå•ç‹¬çš„ â€œchunkâ€ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨å¤šä¸ªå…¥å£èµ·ç‚¹æˆ–ä½¿ç”¨åƒ CommonsChunkPlugin è¿™æ ·çš„æ’ä»¶ï¼‰ï¼Œåˆ™åº”è¯¥ä½¿ç”¨å ä½ç¬¦(substitutions)æ¥ç¡®ä¿æ¯ä¸ªæ–‡ä»¶å…·æœ‰å”¯ä¸€çš„åç§°ã€‚ è®¾å®š HtmlWebpackPluginï¼Œè™½ç„¶åœ¨ dist/ æ–‡ä»¶å¤¹æˆ‘ä»¬å·²ç»æœ‰ index.html è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶è€Œ HtmlWebpackPlugin è¿˜æ˜¯ä¼šé»˜è®¤ç”Ÿæˆ index.html æ–‡ä»¶ã€‚è¿™å°±æ˜¯è¯´ï¼Œå®ƒä¼šç”¨æ–°ç”Ÿæˆçš„ index.html æ–‡ä»¶ï¼ŒæŠŠæˆ‘ä»¬çš„åŸæ¥çš„æ›¿æ¢ã€‚ ä½¿ç”¨ source mapå½“ webpack æ‰“åŒ…æºä»£ç æ—¶ï¼Œå¯èƒ½ä¼šå¾ˆéš¾è¿½è¸ªåˆ°é”™è¯¯å’Œè­¦å‘Šåœ¨æºä»£ç ä¸­çš„åŸå§‹ä½ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå°†ä¸‰ä¸ªæºæ–‡ä»¶ï¼ˆa.js, b.js å’Œ c.jsï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ª bundleï¼ˆbundle.jsï¼‰ä¸­ï¼Œè€Œå…¶ä¸­ä¸€ä¸ªæºæ–‡ä»¶åŒ…å«ä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆå †æ ˆè·Ÿè¸ªå°±ä¼šç®€å•åœ°æŒ‡å‘åˆ° bundle.jsã€‚ä¸ºäº†æ›´å®¹æ˜“åœ°è¿½è¸ªé”™è¯¯å’Œè­¦å‘Šï¼ŒJavaScript æä¾›äº† source map åŠŸèƒ½ï¼Œå°†ç¼–è¯‘åçš„ä»£ç æ˜ å°„å›åŸå§‹æºä»£ç ã€‚å¦‚æœä¸€ä¸ªé”™è¯¯æ¥è‡ªäº b.jsï¼Œsource map å°±ä¼šæ˜ç¡®çš„å‘Šè¯‰ä½ ã€‚ loaderloader è®© webpack èƒ½å¤Ÿå»å¤„ç†é‚£äº›é JavaScript æ–‡ä»¶ï¼ˆwebpack è‡ªèº«åªç†è§£ JavaScriptï¼‰ã€‚loader å¯ä»¥å°†æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶è½¬æ¢ä¸º webpack èƒ½å¤Ÿå¤„ç†çš„æœ‰æ•ˆæ¨¡å—ï¼Œç„¶åä½ å°±å¯ä»¥åˆ©ç”¨ webpack çš„æ‰“åŒ…èƒ½åŠ›ï¼Œå¯¹å®ƒä»¬è¿›è¡Œå¤„ç†ã€‚ æœ¬è´¨ä¸Šï¼Œwebpack loader å°†æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶ï¼Œè½¬æ¢ä¸ºåº”ç”¨ç¨‹åºçš„ä¾èµ–å›¾ï¼ˆå’Œæœ€ç»ˆçš„ bundleï¼‰å¯ä»¥ç›´æ¥å¼•ç”¨çš„æ¨¡å—ã€‚ åœ¨ webpack çš„é…ç½®ä¸­ loader æœ‰ä¸¤ä¸ªç›®æ ‡ï¼š test å±æ€§ï¼Œç”¨äºæ ‡è¯†å‡ºåº”è¯¥è¢«å¯¹åº”çš„ loader è¿›è¡Œè½¬æ¢çš„æŸä¸ªæˆ–æŸäº›æ–‡ä»¶ã€‚ use å±æ€§ï¼Œè¡¨ç¤ºè¿›è¡Œè½¬æ¢æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å“ªä¸ª loaderã€‚ 123456789101112const path = require(\"path\");const config = &#123; output: &#123; filename: \"my-first-webpack.bundle.js\" &#125;, module: &#123; rules: [&#123; test: /\\.txt$/, use: \"raw-loader\" &#125;] &#125;&#125;;module.exports = config; åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰ä¸‰ç§ä½¿ç”¨ loader çš„æ–¹å¼ï¼š é…ç½®ï¼ˆæ¨èï¼‰ï¼šåœ¨ webpack.config.js æ–‡ä»¶ä¸­æŒ‡å®š loaderã€‚module.rules å…è®¸ä½ åœ¨ webpack é…ç½®ä¸­æŒ‡å®šå¤šä¸ª loaderã€‚ è¿™æ˜¯å±•ç¤º loader çš„ä¸€ç§ç®€æ˜æ–¹å¼ï¼Œå¹¶ä¸”æœ‰åŠ©äºä½¿ä»£ç å˜å¾—ç®€æ´ã€‚åŒæ—¶è®©ä½ å¯¹å„ä¸ª loader æœ‰ä¸ªå…¨å±€æ¦‚è§ˆ å†…è”ï¼šåœ¨æ¯ä¸ª import è¯­å¥ä¸­æ˜¾å¼æŒ‡å®š loaderã€‚å¯ä»¥åœ¨ import è¯­å¥æˆ–ä»»ä½•ç­‰æ•ˆäº â€œimportâ€ çš„æ–¹å¼ä¸­æŒ‡å®š loaderã€‚ä½¿ç”¨ ! å°†èµ„æºä¸­çš„ loader åˆ†å¼€ã€‚åˆ†å¼€çš„æ¯ä¸ªéƒ¨åˆ†éƒ½ç›¸å¯¹äºå½“å‰ç›®å½•è§£æã€‚ CLIï¼šåœ¨ shell å‘½ä»¤ä¸­æŒ‡å®šå®ƒä»¬ã€‚ loader ç‰¹æ€§ï¼š loader æ”¯æŒé“¾å¼ä¼ é€’ã€‚èƒ½å¤Ÿå¯¹èµ„æºä½¿ç”¨æµæ°´çº¿(pipeline)ã€‚ä¸€ç»„é“¾å¼çš„ loader å°†æŒ‰ç…§ç›¸åçš„é¡ºåºæ‰§è¡Œã€‚loader é“¾ä¸­çš„ç¬¬ä¸€ä¸ª loader è¿”å›å€¼ç»™ä¸‹ä¸€ä¸ª loaderã€‚åœ¨æœ€åä¸€ä¸ª loaderï¼Œè¿”å› webpack æ‰€é¢„æœŸçš„ JavaScriptã€‚ loader å¯ä»¥æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ã€‚ loader è¿è¡Œåœ¨ Node.js ä¸­ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰§è¡Œä»»ä½•å¯èƒ½çš„æ“ä½œã€‚ loader æ¥æ”¶æŸ¥è¯¢å‚æ•°ã€‚ç”¨äºå¯¹ loader ä¼ é€’é…ç½®ã€‚ loader ä¹Ÿèƒ½å¤Ÿä½¿ç”¨ options å¯¹è±¡è¿›è¡Œé…ç½®ã€‚ é™¤äº†ä½¿ç”¨ package.json å¸¸è§çš„ main å±æ€§ï¼Œè¿˜å¯ä»¥å°†æ™®é€šçš„ npm æ¨¡å—å¯¼å‡ºä¸º loaderï¼Œåšæ³•æ˜¯åœ¨ package.json é‡Œå®šä¹‰ä¸€ä¸ª loader å­—æ®µã€‚ æ’ä»¶(plugin)å¯ä»¥ä¸º loader å¸¦æ¥æ›´å¤šç‰¹æ€§ã€‚ loader èƒ½å¤Ÿäº§ç”Ÿé¢å¤–çš„ä»»æ„æ–‡ä»¶ã€‚ æ’ä»¶(plugins)loader è¢«ç”¨äºè½¬æ¢æŸäº›ç±»å‹çš„æ¨¡å—ï¼Œè€Œæ’ä»¶åˆ™å¯ä»¥ç”¨äºæ‰§è¡ŒèŒƒå›´æ›´å¹¿çš„ä»»åŠ¡ã€‚æ’ä»¶çš„èŒƒå›´åŒ…æ‹¬ï¼Œä»æ‰“åŒ…ä¼˜åŒ–å’Œå‹ç¼©ï¼Œä¸€ç›´åˆ°é‡æ–°å®šä¹‰ç¯å¢ƒä¸­çš„å˜é‡ã€‚æ’ä»¶æ¥å£åŠŸèƒ½æå…¶å¼ºå¤§ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†å„ç§å„æ ·çš„ä»»åŠ¡ã€‚æ’ä»¶ç›®çš„åœ¨äºè§£å†³ loader æ— æ³•å®ç°çš„å…¶ä»–äº‹ã€‚ 1234567891011const HtmlWebpackPlugin = require(\"html-webpack-plugin\"); // é€šè¿‡ npm å®‰è£…const webpack = require(\"webpack\"); // ç”¨äºè®¿é—®å†…ç½®æ’ä»¶const config = &#123; module: &#123; rules: [&#123; test: /\\.txt$/, use: \"raw-loader\" &#125;] &#125;, plugins: [new HtmlWebpackPlugin(&#123; template: \"./src/index.html\" &#125;)]&#125;;module.exports = config; ç”¨æ³•ï¼šç”¨ requireï¼ˆï¼‰å¼•å…¥ç”±äºæ’ä»¶å¯ä»¥æºå¸¦å‚æ•°/é€‰é¡¹ï¼Œä½ å¿…é¡»åœ¨ webpack é…ç½®ä¸­ï¼Œå‘ plugins å±æ€§ä¼ å…¥ new å®ä¾‹ã€‚ æ¨¡å¼æä¾› mode é…ç½®é€‰é¡¹ï¼Œå‘ŠçŸ¥ webpack ä½¿ç”¨ç›¸åº”æ¨¡å¼çš„å†…ç½®ä¼˜åŒ–ã€‚é€šè¿‡é€‰æ‹© development æˆ– production ä¹‹ä¸­çš„ä¸€ä¸ªï¼Œæ¥è®¾ç½® mode å‚æ•°ï¼Œå¯ä»¥å¯ç”¨ç›¸åº”æ¨¡å¼ä¸‹çš„ webpack å†…ç½®çš„ä¼˜åŒ– ç”¨æ³•ï¼š åªåœ¨é…ç½®ä¸­æä¾› mode é€‰é¡¹ï¼š 123module.exports = &#123; mode: \"production\"&#125;; ä» CLI å‚æ•°ä¸­ä¼ é€’ï¼š 1webpack --mode=production æ¨¡å—çƒ­æ›¿æ¢(hot module replacement)æ¨¡å—çƒ­æ›¿æ¢(HMR - Hot Module Replacement)åŠŸèƒ½ä¼šåœ¨åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ›¿æ¢ã€æ·»åŠ æˆ–åˆ é™¤æ¨¡å—ï¼Œè€Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚ä¸»è¦æ˜¯é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼Œæ¥æ˜¾è‘—åŠ å¿«å¼€å‘é€Ÿåº¦ï¼š ä¿ç•™åœ¨å®Œå…¨é‡æ–°åŠ è½½é¡µé¢æ—¶ä¸¢å¤±çš„åº”ç”¨ç¨‹åºçŠ¶æ€ã€‚ åªæ›´æ–°å˜æ›´å†…å®¹ï¼Œä»¥èŠ‚çœå®è´µçš„å¼€å‘æ—¶é—´ã€‚ è°ƒæ•´æ ·å¼æ›´åŠ å¿«é€Ÿ - å‡ ä¹ç›¸å½“äºåœ¨æµè§ˆå™¨è°ƒè¯•å™¨ä¸­æ›´æ”¹æ ·å¼ã€‚ tree shakingé€šå¸¸ç”¨äºæè¿°ç§»é™¤ JavaScript ä¸Šä¸‹æ–‡ä¸­çš„æœªå¼•ç”¨ä»£ç (dead-code)ã€‚å®ƒä¾èµ–äº ES2015 æ¨¡å—ç³»ç»Ÿä¸­çš„é™æ€ç»“æ„ç‰¹æ€§ï¼Œä¾‹å¦‚ import å’Œ exportã€‚ å¦‚æœæ‰€æœ‰ä»£ç éƒ½ä¸åŒ…å«å‰¯ä½œç”¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç®€å•åœ°å°† package.json çš„ â€œsideEffectsâ€ å±æ€§æ ‡è®°ä¸º falseï¼Œæ¥å‘ŠçŸ¥ webpackï¼Œå®ƒå¯ä»¥å®‰å…¨åœ°åˆ é™¤æœªç”¨åˆ°çš„ export å¯¼å‡ºã€‚æ³¨ï¼šã€Œå‰¯ä½œç”¨ã€çš„å®šä¹‰æ˜¯ï¼Œåœ¨å¯¼å…¥æ—¶ä¼šæ‰§è¡Œç‰¹æ®Šè¡Œä¸ºçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä»…ä»…æš´éœ²ä¸€ä¸ª export æˆ–å¤šä¸ª exportã€‚ å¦‚æœä½ çš„ä»£ç ç¡®å®æœ‰ä¸€äº›å‰¯ä½œç”¨ï¼Œé‚£ä¹ˆå¯ä»¥æ”¹ä¸ºæä¾›ä¸€ä¸ªæ•°ç»„ï¼š 123456&#123; \"name\": \"your-project\", \"sideEffects\": [ \"./src/some-side-effectful-file.js\" ]&#125; æ•°ç»„æ–¹å¼æ”¯æŒç›¸å…³æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„å’Œ glob æ¨¡å¼ã€‚å®ƒåœ¨å†…éƒ¨ä½¿ç”¨ micromatchã€‚ æ³¨æ„ï¼Œä»»ä½•å¯¼å…¥çš„æ–‡ä»¶éƒ½ä¼šå—åˆ° tree shaking çš„å½±å“ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç±»ä¼¼ css-loader å¹¶å¯¼å…¥ CSS æ–‡ä»¶ï¼Œåˆ™éœ€è¦å°†å…¶æ·»åŠ åˆ° side effect åˆ—è¡¨ä¸­ï¼Œä»¥å…åœ¨ç”Ÿäº§æ¨¡å¼ä¸­æ— æ„ä¸­å°†å®ƒåˆ é™¤ã€‚ ä» webpack 4 å¼€å§‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ â€œmodeâ€ é…ç½®é€‰é¡¹è½»æ¾åˆ‡æ¢åˆ°å‹ç¼©è¾“å‡ºï¼Œåªéœ€è®¾ç½®ä¸º â€œproductionâ€ã€‚","categories":[{"name":"å‰ç«¯å·¥å…·","slug":"å‰ç«¯å·¥å…·","permalink":"http://yoursite.com/categories/å‰ç«¯å·¥å…·/"}],"tags":[{"name":"webpack","slug":"webpack","permalink":"http://yoursite.com/tags/webpack/"}]},{"title":"Reactç»„ä»¶","slug":"Reactç»„ä»¶","date":"2018-11-11T04:10:52.000Z","updated":"2019-11-10T14:37:39.023Z","comments":true,"path":"2018/11/11/Reactç»„ä»¶/","link":"","permalink":"http://yoursite.com/2018/11/11/Reactç»„ä»¶/","excerpt":"Web Copmpoents React ç»„ä»¶ React ç»„ä»¶ï¼š è‡ªå®šä¹‰å…ƒç´ æ˜¯åº“è‡ªå·±æ„å»ºçš„ æ¸²æŸ“è¿‡ç¨‹åŒ…å«äº†æ¨¡ç‰ˆçš„æ¦‚å¿µ å®ç°å‡åœ¨æ–¹æ³•ä¸ç±»ä¸­ï¼Œç›¸äº’éš”ç¦»ï¼ˆä¸åŒ…æ‹¬æ ·å¼ï¼‰ å¼•ç”¨æ–¹å¼éµå¾ª ES6 æ„å»ºï¼š React æ–¹å¼ï¼šcreatClass ES6 æ–¹å¼ï¼šclass æ— çŠ¶æ€å‡½æ•° React åº•å±‚â€”â€”åˆæˆäº‹ä»¶äº‹ä»¶å§”æ´¾æŠŠäº‹ä»¶å¤„ç†å‡½æ•°ç»‘å®šåˆ°ç»“æ„çš„æœ€å¤–å±‚ï¼Œä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„äº‹ä»¶ç›‘å¬å™¨ã€‚ï¼ˆä¸ä¼šæŠŠäº‹ä»¶å¤„ç†å‡½æ•°ç›´æ¥ç»‘å®šåˆ°çœŸå®çš„èŠ‚ç‚¹ä¸Šï¼‰","text":"Web Copmpoents React ç»„ä»¶ React ç»„ä»¶ï¼š è‡ªå®šä¹‰å…ƒç´ æ˜¯åº“è‡ªå·±æ„å»ºçš„ æ¸²æŸ“è¿‡ç¨‹åŒ…å«äº†æ¨¡ç‰ˆçš„æ¦‚å¿µ å®ç°å‡åœ¨æ–¹æ³•ä¸ç±»ä¸­ï¼Œç›¸äº’éš”ç¦»ï¼ˆä¸åŒ…æ‹¬æ ·å¼ï¼‰ å¼•ç”¨æ–¹å¼éµå¾ª ES6 æ„å»ºï¼š React æ–¹å¼ï¼šcreatClass ES6 æ–¹å¼ï¼šclass æ— çŠ¶æ€å‡½æ•° React åº•å±‚â€”â€”åˆæˆäº‹ä»¶äº‹ä»¶å§”æ´¾æŠŠäº‹ä»¶å¤„ç†å‡½æ•°ç»‘å®šåˆ°ç»“æ„çš„æœ€å¤–å±‚ï¼Œä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„äº‹ä»¶ç›‘å¬å™¨ã€‚ï¼ˆä¸ä¼šæŠŠäº‹ä»¶å¤„ç†å‡½æ•°ç›´æ¥ç»‘å®šåˆ°çœŸå®çš„èŠ‚ç‚¹ä¸Šï¼‰ è‡ªåŠ¨ç»‘å®šæ¯ä¸ªæ–¹æ³•çš„ä¸Šä¸‹æ–‡éƒ½ä¼šæŒ‡å‘è¯¥ç»„ä»¶çš„å®ä¾‹â€”â€”è‡ªåŠ¨ç»‘å®š this ä¸ºå½“å‰ç»„ä»¶ã€‚React ä¼šå¯¹è¿™ç§å¼•ç”¨è¿›è¡Œç¼“å­˜ï¼Œè¾¾åˆ° CPU å†…å­˜æœ€ä¼˜ã€‚ï¼ˆä½¿ç”¨ ES6 class æˆ–çº¯å‡½æ•°æ—¶ï¼Œè‡ªåŠ¨ç»‘å®šä¸å¤å­˜åœ¨ï¼Œéœ€è¦æ‰‹åŠ¨ç»‘å®š thisï¼‰ bind ç»‘å®šç»‘å®šäº‹ä»¶å¤„ç†å™¨å†…çš„ thisï¼Œå¹¶å¯ä»¥å‘äº‹ä»¶å¤„ç†å™¨ä¸­ä¼ å‚ æ„é€ å™¨å†…å£°æ˜å¥½å¤„ï¼šä»…éœ€è¿›è¡Œä¸€æ¬¡ç»‘å®š ç®­å¤´å‡½æ•°ç®­å¤´å‡½æ•°è‡ªåŠ¨ç»‘å®šäº†å®šä¹‰æ­¤å‡½æ•°ä½œç”¨åŸŸçš„ thisï¼Œå› æ­¤ä¸éœ€è¦å†ç”¨ bind ç»‘å®š æ³¨æ„ï¼šReact ä¸­ä½¿ç”¨ DOM åŸç”Ÿäº‹ä»¶ï¼Œä¸€å®šè¦åœ¨ç»„ä»¶å¸è½½æ—¶æ‰‹åŠ¨ç§»é™¤ï¼Œå¦åˆ™å†…å­˜æ³„æ¼ã€‚ä½¿ç”¨åˆæˆäº‹ä»¶åˆ™ä¸éœ€è¦ã€‚ React åˆæˆäº‹ä»¶ä¸ JS åŸç”Ÿäº‹ä»¶å¯¹æ¯”åŸç”Ÿ DOM äº‹ä»¶ä¼ æ’­ 3 ä¸ªé˜¶æ®µï¼šäº‹ä»¶æ•è·é˜¶æ®µã€ç›®æ ‡å¯¹è±¡æœ¬èº«çš„äº‹ä»¶å¤„ç†ç¨‹åºè°ƒç”¨ï¼Œä»¥åŠäº‹ä»¶å†’æ³¡ã€‚ äº‹ä»¶æ•è·é˜¶æ®µä¼šä¼˜å…ˆè°ƒç”¨ç»“æ„æ ‘æœ€å¤–å±‚çš„å…ƒç´ ä¸Šç»‘å®šçš„äº‹ä»¶ä¾¦å¬å™¨ï¼Œä¾æ¬¡å‘å†…è°ƒç”¨ï¼Œä¸€ç›´è°ƒç”¨åˆ°ç›®æ ‡å…ƒç´ ä¸Šçš„äº‹ä»¶ç›‘å¬å™¨ä¸ºæ­¢ã€‚ 1e.addEventListener(\"click\", () =&gt; &#123;&#125;, false); ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œè‹¥ä¼  trueï¼Œä¸ºå…ƒç´  e æ³¨å†Œæ•è·äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¹¶ä¸”åœ¨äº‹ä»¶æ•è·é˜¶æ®µè°ƒç”¨ã€‚ äº‹ä»¶å†’æ³¡ä¸äº‹ä»¶æ•è·ç›¸åï¼Œå®ƒä¼šä»ç›®æ ‡å…ƒç´ å‘å¤–ä¼ æ’­ï¼Œç”±å†…è€Œå¤–ã€‚React çš„åˆæˆäº‹ä»¶ä»…æ”¯æŒäº‹ä»¶å†’æ³¡é˜»æ­¢åŸç”Ÿäº‹ä»¶å†’æ³¡ç”¨ e.preventDefault() React å—æ§ç»„ä»¶æ›´æ–° state çš„æµç¨‹ å¯ä»¥é€šè¿‡åœ¨åˆå§‹ state ä¸­è®¾ç½®è¡¨å•çš„é»˜è®¤å€¼ æ¯å½“è¡¨å•çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè°ƒç”¨ onchange äº‹ä»¶å¤„ç†å™¨ äº‹ä»¶å¤„ç†å™¨é€šè¿‡åˆæˆäº‹ä»¶å¯¹è±¡ e æ‹¿åˆ°æ”¹å˜åçš„çŠ¶æ€ï¼Œå¹¶æ›´è¡Œåº”ç”¨çš„ state setState è§¦å‘è§†å›¾çš„é‡æ–°æ¸²æŸ“ï¼Œå®Œæˆè¡¨å•çš„ç»„ä»¶å€¼æ›´æ–° React éå—æ§ç»„ä»¶æ˜¯ä¸€ç§åæ¨¡å¼ï¼Œä»–çš„å€¼ä¸å—ç»„ä»¶è‡ªèº«çš„ state æˆ– props æ§åˆ¶ã€‚é€šå¸¸éœ€è¦ä¸ºå…¶æ·»åŠ  ref prop æ¥è®¿é—®æ¸²æŸ“åçš„åº•å±‚ DOM","categories":[{"name":"React","slug":"React","permalink":"http://yoursite.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://yoursite.com/tags/React/"}]},{"title":"æµè§ˆå™¨ç¼“å­˜ä½ç½®","slug":"æµè§ˆå™¨ç¼“å­˜ä½ç½®","date":"2018-11-01T15:10:55.000Z","updated":"2019-11-10T14:37:39.038Z","comments":true,"path":"2018/11/01/æµè§ˆå™¨ç¼“å­˜ä½ç½®/","link":"","permalink":"http://yoursite.com/2018/11/01/æµè§ˆå™¨ç¼“å­˜ä½ç½®/","excerpt":"æµè§ˆå™¨ç¼“å­˜ä½ç½®ç¼“å­˜ä½ç½®ä»ç¼“å­˜ä½ç½®ä¸Šæ¥è¯´åˆ†ä¸ºå››ç§ï¼Œå¹¶ä¸”å„è‡ªæœ‰ä¼˜å…ˆçº§ï¼Œå½“ä¾æ¬¡æŸ¥æ‰¾ç¼“å­˜ä¸”éƒ½æ²¡æœ‰å‘½ä¸­çš„æ—¶å€™ï¼Œæ‰ä¼šå»è¯·æ±‚ç½‘ç»œã€‚ Service Worker Memory Cache Disk Cache Push Cache","text":"æµè§ˆå™¨ç¼“å­˜ä½ç½®ç¼“å­˜ä½ç½®ä»ç¼“å­˜ä½ç½®ä¸Šæ¥è¯´åˆ†ä¸ºå››ç§ï¼Œå¹¶ä¸”å„è‡ªæœ‰ä¼˜å…ˆçº§ï¼Œå½“ä¾æ¬¡æŸ¥æ‰¾ç¼“å­˜ä¸”éƒ½æ²¡æœ‰å‘½ä¸­çš„æ—¶å€™ï¼Œæ‰ä¼šå»è¯·æ±‚ç½‘ç»œã€‚ Service Worker Memory Cache Disk Cache Push Cache 1.Service WorkerService Worker æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨èƒŒåçš„ç‹¬ç«‹çº¿ç¨‹ï¼Œä¸€èˆ¬å¯ä»¥ç”¨æ¥å®ç°ç¼“å­˜åŠŸèƒ½ã€‚ä½¿ç”¨ Service Worker çš„è¯ï¼Œä¼ è¾“åè®®å¿…é¡»ä¸º HTTPSã€‚å› ä¸º Service Worker ä¸­æ¶‰åŠåˆ°è¯·æ±‚æ‹¦æˆªï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ HTTPS åè®®æ¥ä¿éšœå®‰å…¨ã€‚Service Worker çš„ç¼“å­˜ä¸æµè§ˆå™¨å…¶ä»–å†…å»ºçš„ç¼“å­˜æœºåˆ¶ä¸åŒï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬è‡ªç”±æ§åˆ¶ç¼“å­˜å“ªäº›æ–‡ä»¶ã€å¦‚ä½•åŒ¹é…ç¼“å­˜ã€å¦‚ä½•è¯»å–ç¼“å­˜ï¼Œå¹¶ä¸”ç¼“å­˜æ˜¯æŒç»­æ€§çš„ã€‚ Service Worker å®ç°ç¼“å­˜åŠŸèƒ½ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šé¦–å…ˆéœ€è¦å…ˆæ³¨å†Œ Service Workerï¼Œç„¶åç›‘å¬åˆ° install äº‹ä»¶ä»¥åå°±å¯ä»¥ç¼“å­˜éœ€è¦çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨ä¸‹æ¬¡ç”¨æˆ·è®¿é—®çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡æ‹¦æˆªè¯·æ±‚çš„æ–¹å¼æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ç¼“å­˜ï¼Œå­˜åœ¨ç¼“å­˜çš„è¯å°±å¯ä»¥ç›´æ¥è¯»å–ç¼“å­˜æ–‡ä»¶ï¼Œå¦åˆ™å°±å»è¯·æ±‚æ•°æ®ã€‚ å½“ Service Worker æ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å»è°ƒç”¨ fetch å‡½æ•°è·å–æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰åœ¨ Service Worker å‘½ä¸­ç¼“å­˜çš„è¯ï¼Œä¼šæ ¹æ®ç¼“å­˜æŸ¥æ‰¾ä¼˜å…ˆçº§å»æŸ¥æ‰¾æ•°æ®ã€‚ä½†æ˜¯ä¸ç®¡æˆ‘ä»¬æ˜¯ä» Memory Cache ä¸­è¿˜æ˜¯ä»ç½‘ç»œè¯·æ±‚ä¸­è·å–çš„æ•°æ®ï¼Œæµè§ˆå™¨éƒ½ä¼šæ˜¾ç¤ºæˆ‘ä»¬æ˜¯ä» Service Worker ä¸­è·å–çš„å†…å®¹ã€‚ 2.Memory CacheMemory Cache ä¹Ÿå°±æ˜¯å†…å­˜ä¸­çš„ç¼“å­˜ï¼Œä¸»è¦åŒ…å«çš„æ˜¯å½“å‰ä¸­é¡µé¢ä¸­å·²ç»æŠ“å–åˆ°çš„èµ„æº, ä¾‹å¦‚é¡µé¢ä¸Šå·²ç»ä¸‹è½½çš„æ ·å¼ã€è„šæœ¬ã€å›¾ç‰‡ç­‰ã€‚è¯»å–å†…å­˜ä¸­çš„æ•°æ®è‚¯å®šæ¯”ç£ç›˜å¿«, å†…å­˜ç¼“å­˜è™½ç„¶è¯»å–é«˜æ•ˆï¼Œå¯æ˜¯ç¼“å­˜æŒç»­æ€§å¾ˆçŸ­ï¼Œä¼šéšç€è¿›ç¨‹çš„é‡Šæ”¾è€Œé‡Šæ”¾ã€‚ ä¸€æ—¦æˆ‘ä»¬å…³é—­ Tab é¡µé¢ï¼Œå†…å­˜ä¸­çš„ç¼“å­˜ä¹Ÿå°±è¢«é‡Šæ”¾äº†ã€‚ é‚£ä¹ˆæ—¢ç„¶å†…å­˜ç¼“å­˜è¿™ä¹ˆé«˜æ•ˆï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯èƒ½è®©æ•°æ®éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­å‘¢ï¼Ÿè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚è®¡ç®—æœºä¸­çš„å†…å­˜ä¸€å®šæ¯”ç¡¬ç›˜å®¹é‡å°å¾—å¤šï¼Œæ“ä½œç³»ç»Ÿéœ€è¦ç²¾æ‰“ç»†ç®—å†…å­˜çš„ä½¿ç”¨ï¼Œæ‰€ä»¥èƒ½è®©æˆ‘ä»¬ä½¿ç”¨çš„å†…å­˜å¿…ç„¶ä¸å¤šã€‚ å½“æˆ‘ä»¬è®¿é—®è¿‡é¡µé¢ä»¥åï¼Œå†æ¬¡åˆ·æ–°é¡µé¢ï¼Œå¯ä»¥å‘ç°å¾ˆå¤šæ•°æ®éƒ½æ¥è‡ªäºå†…å­˜ç¼“å­˜ã€‚ å†…å­˜ç¼“å­˜ä¸­æœ‰ä¸€å—é‡è¦çš„ç¼“å­˜èµ„æºæ˜¯ preloader ç›¸å…³æŒ‡ä»¤ï¼ˆä¾‹å¦‚&lt;link rel=&quot;prefetch&quot;&gt;ï¼‰ä¸‹è½½çš„èµ„æºã€‚ä¼—æ‰€å‘¨çŸ¥ preloader çš„ç›¸å…³æŒ‡ä»¤å·²ç»æ˜¯é¡µé¢ä¼˜åŒ–çš„å¸¸è§æ‰‹æ®µä¹‹ä¸€ï¼Œå®ƒå¯ä»¥ä¸€è¾¹è§£æ js/css æ–‡ä»¶ï¼Œä¸€è¾¹ç½‘ç»œè¯·æ±‚ä¸‹ä¸€ä¸ªèµ„æºã€‚ éœ€è¦æ³¨æ„çš„äº‹æƒ…æ˜¯ï¼Œå†…å­˜ç¼“å­˜åœ¨ç¼“å­˜èµ„æºæ—¶å¹¶ä¸å…³å¿ƒè¿”å›èµ„æºçš„ HTTP ç¼“å­˜å¤´ Cache-Control æ˜¯ä»€ä¹ˆå€¼ï¼ŒåŒæ—¶èµ„æºçš„åŒ¹é…ä¹Ÿå¹¶éä»…ä»…æ˜¯å¯¹ URL åšåŒ¹é…ï¼Œè¿˜å¯èƒ½ä¼šå¯¹ Content-Typeï¼ŒCORS ç­‰å…¶ä»–ç‰¹å¾åšæ ¡éªŒã€‚ 3.Disk CacheDisk Cache ä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­çš„ç¼“å­˜ï¼Œè¯»å–é€Ÿåº¦æ…¢ç‚¹ï¼Œä½†æ˜¯ä»€ä¹ˆéƒ½èƒ½å­˜å‚¨åˆ°ç£ç›˜ä¸­ï¼Œæ¯”ä¹‹ Memory Cache èƒœåœ¨å®¹é‡å’Œå­˜å‚¨æ—¶æ•ˆæ€§ä¸Šã€‚ åœ¨æ‰€æœ‰æµè§ˆå™¨ç¼“å­˜ä¸­ï¼ŒDisk Cache è¦†ç›–é¢åŸºæœ¬æ˜¯æœ€å¤§çš„ã€‚å®ƒä¼šæ ¹æ® HTTP Herder ä¸­çš„å­—æ®µåˆ¤æ–­å“ªäº›èµ„æºéœ€è¦ç¼“å­˜ï¼Œå“ªäº›èµ„æºå¯ä»¥ä¸è¯·æ±‚ç›´æ¥ä½¿ç”¨ï¼Œå“ªäº›èµ„æºå·²ç»è¿‡æœŸéœ€è¦é‡æ–°è¯·æ±‚ã€‚å¹¶ä¸”å³ä½¿åœ¨è·¨ç«™ç‚¹çš„æƒ…å†µä¸‹ï¼Œç›¸åŒåœ°å€çš„èµ„æºä¸€æ—¦è¢«ç¡¬ç›˜ç¼“å­˜ä¸‹æ¥ï¼Œå°±ä¸ä¼šå†æ¬¡å»è¯·æ±‚æ•°æ®ã€‚ç»å¤§éƒ¨åˆ†çš„ç¼“å­˜éƒ½æ¥è‡ª Disk Cacheï¼Œå…³äº HTTP çš„åè®®å¤´ä¸­çš„ç¼“å­˜å­—æ®µï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹æ–‡è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚ æµè§ˆå™¨ä¼šæŠŠå“ªäº›æ–‡ä»¶ä¸¢è¿›å†…å­˜ä¸­ï¼Ÿå“ªäº›ä¸¢è¿›ç¡¬ç›˜ä¸­ï¼Ÿå…³äºè¿™ç‚¹ï¼Œç½‘ä¸Šè¯´æ³•ä¸ä¸€ï¼Œä¸è¿‡ä»¥ä¸‹è§‚ç‚¹æ¯”è¾ƒé å¾—ä½ï¼š å¯¹äºå¤§æ–‡ä»¶æ¥è¯´ï¼Œå¤§æ¦‚ç‡æ˜¯ä¸å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œåä¹‹ä¼˜å…ˆï¼› å½“å‰ç³»ç»Ÿå†…å­˜ä½¿ç”¨ç‡é«˜çš„è¯ï¼Œæ–‡ä»¶ä¼˜å…ˆå­˜å‚¨è¿›ç¡¬ç›˜ã€‚ 4.Push CachePush Cacheï¼ˆæ¨é€ç¼“å­˜ï¼‰æ˜¯ HTTP/2 ä¸­çš„å†…å®¹ï¼Œå½“ä»¥ä¸Šä¸‰ç§ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­æ—¶ï¼Œå®ƒæ‰ä¼šè¢«ä½¿ç”¨ã€‚å®ƒåªåœ¨ä¼šè¯ï¼ˆSessionï¼‰ä¸­å­˜åœ¨ï¼Œä¸€æ—¦ä¼šè¯ç»“æŸå°±è¢«é‡Šæ”¾ï¼Œå¹¶ä¸”ç¼“å­˜æ—¶é—´ä¹Ÿå¾ˆçŸ­æš‚ï¼Œåœ¨ Chrome æµè§ˆå™¨ä¸­åªæœ‰ 5 åˆ†é’Ÿå·¦å³ï¼ŒåŒæ—¶å®ƒä¹Ÿå¹¶éä¸¥æ ¼æ‰§è¡Œ HTTP å¤´ä¸­çš„ç¼“å­˜æŒ‡ä»¤ã€‚ Push Cache åœ¨å›½å†…èƒ½å¤ŸæŸ¥åˆ°çš„èµ„æ–™å¾ˆå°‘ï¼Œä¹Ÿæ˜¯å› ä¸º HTTP/2 åœ¨å›½å†…ä¸å¤Ÿæ™®åŠã€‚è¿™é‡Œæ¨èé˜…è¯»Jake Archibaldçš„ HTTP/2 push is tougher than I thought è¿™ç¯‡æ–‡ç« ï¼Œæ–‡ç« ä¸­çš„å‡ ä¸ªç»“è®ºï¼š æ‰€æœ‰çš„èµ„æºéƒ½èƒ½è¢«æ¨é€ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç¼“å­˜, ä½†æ˜¯ Edge å’Œ Safari æµè§ˆå™¨æ”¯æŒç›¸å¯¹æ¯”è¾ƒå·®ï¼› å¯ä»¥æ¨é€ no-cache å’Œ no-store çš„èµ„æºï¼› ä¸€æ—¦è¿æ¥è¢«å…³é—­ï¼ŒPush Cache å°±è¢«é‡Šæ”¾ï¼› å¤šä¸ªé¡µé¢å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ª HTTP/2 çš„è¿æ¥ï¼Œä¹Ÿå°±å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ª Push Cacheã€‚è¿™ä¸»è¦è¿˜æ˜¯ä¾èµ–æµè§ˆå™¨çš„å®ç°è€Œå®šï¼Œå‡ºäºå¯¹æ€§èƒ½çš„è€ƒè™‘ï¼Œæœ‰çš„æµè§ˆå™¨ä¼šå¯¹ç›¸åŒåŸŸåä½†ä¸åŒçš„ tab æ ‡ç­¾ä½¿ç”¨åŒä¸€ä¸ª HTTP è¿æ¥ï¼› Push Cache ä¸­çš„ç¼“å­˜åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡ï¼› æµè§ˆå™¨å¯ä»¥æ‹’ç»æ¥å—å·²ç»å­˜åœ¨çš„èµ„æºæ¨é€ï¼› ä½ å¯ä»¥ç»™å…¶ä»–åŸŸåæ¨é€èµ„æºã€‚ å¦‚æœä»¥ä¸Šå››ç§ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­çš„è¯ï¼Œé‚£ä¹ˆåªèƒ½å‘èµ·è¯·æ±‚æ¥è·å–èµ„æºäº†ã€‚ é‚£ä¹ˆä¸ºäº†æ€§èƒ½ä¸Šçš„è€ƒè™‘ï¼Œå¤§éƒ¨åˆ†çš„æ¥å£éƒ½åº”è¯¥é€‰æ‹©å¥½ç¼“å­˜ç­–ç•¥ï¼Œé€šå¸¸æµè§ˆå™¨ç¼“å­˜ç­–ç•¥åˆ†ä¸ºä¸¤ç§ï¼šå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼Œå¹¶ä¸”ç¼“å­˜ç­–ç•¥éƒ½æ˜¯é€šè¿‡è®¾ç½® HTTP Header æ¥å®ç°çš„ã€‚ http çŠ¶æ€ç ä¸ç¼“å­˜ç­–ç•¥200 from memory cacheä¸è®¿é—®æœåŠ¡å™¨ï¼Œç›´æ¥è¯»ç¼“å­˜ï¼Œä»å†…å­˜ä¸­è¯»å–ç¼“å­˜ã€‚æ­¤æ—¶çš„æ•°æ®æ—¶ç¼“å­˜åˆ°å†…å­˜ä¸­çš„ï¼Œå½“ kill è¿›ç¨‹åï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨å…³é—­ä»¥åï¼Œæ•°æ®å°†ä¸å­˜åœ¨ã€‚ ä½†æ˜¯è¿™ç§æ–¹å¼åªèƒ½ç¼“å­˜æ´¾ç”Ÿèµ„æº 200 from disk cacheä¸è®¿é—®æœåŠ¡å™¨ï¼Œç›´æ¥è¯»ç¼“å­˜ï¼Œä»ç£ç›˜ä¸­è¯»å–ç¼“å­˜ï¼Œå½“ kill è¿›ç¨‹æ—¶ï¼Œæ•°æ®è¿˜æ˜¯å­˜åœ¨ã€‚ è¿™ç§æ–¹å¼ä¹Ÿåªèƒ½ç¼“å­˜æ´¾ç”Ÿèµ„æº 304 Not Modifiedè®¿é—®æœåŠ¡å™¨ï¼Œå‘ç°æ•°æ®æ²¡æœ‰ æ›´æ–°ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç ã€‚ç„¶åä»ç¼“å­˜ä¸­è¯»å–æ•°æ®ã€‚ ä¸‰çº§ç¼“å­˜åŸç† å…ˆå»å†…å­˜çœ‹ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥åŠ è½½ å¦‚æœå†…å­˜æ²¡æœ‰ï¼Œæ‹©å–ç¡¬ç›˜è·å–ï¼Œå¦‚æœæœ‰ç›´æ¥åŠ è½½ å¦‚æœç¡¬ç›˜ä¹Ÿæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±è¿›è¡Œç½‘ç»œè¯·æ±‚ åŠ è½½åˆ°çš„èµ„æºç¼“å­˜åˆ°ç¡¬ç›˜å’Œå†…å­˜ å¸¸è§ç¼“å­˜æƒ…å†µ ç¬¬ä¸€ä¸ªç°è±¡ï¼š è®¿é—®-&gt; 200 -&gt; é€€å‡ºæµè§ˆå™¨ å†è¿›æ¥-&gt; 200(from disk cache) -&gt; åˆ·æ–° -&gt; 200(from memory cache) æ€»ç»“: ä¼šä¸ä¼šæ˜¯ chrome å¾ˆèªæ˜çš„åˆ¤æ–­æ—¢ç„¶å·²ç»ä» disk æ‹¿æ¥äº†ï¼Œ ç¬¬äºŒæ¬¡å°±å†…å­˜æ‹¿å§ å¿«ã€‚ï¼ˆç¬‘å“­) ç¬¬äºŒä¸ªç°è±¡: åªè¦å›¾ç‰‡æ˜¯ base64 éƒ½æ˜¯ from memroy cacheã€‚ æ€»ç»“: è§£ææ¸²æŸ“å›¾ç‰‡è¿™ä¹ˆè´¹åŠ²çš„äº‹æƒ…ï¼Œè¿˜æ˜¯åšä¸€æ¬¡ç„¶åæ”¾åˆ°å†…å­˜å§ã€‚ ç”¨çš„æ—¶å€™ç›´æ¥æ‹¿ ç¬¬ä¸‰ä¸ªç°è±¡(ä»¥ js css ä¸ºä¾‹): ä¸ªäººåœ¨åšé™æ€æµ‹è¯•çš„å‘ç°ï¼Œå¤§å‹çš„ js css æ–‡ä»¶éƒ½æ˜¯ç›´æ¥ disk cache æ€»ç»“: chrome ä¼šä¸ä¼šè¯´ æˆ‘æ“¦ ä½ è¿™ä¹ˆå¤§ å¤ª JB å åœ°æ–¹äº†ã€‚ ä½ å°±å»ç¡¬ç›˜é‡Œå‘†ç€å§ã€‚ æ…¢å°±æ…¢ç‚¹å§ã€‚ ç¬¬å››ä¸ªç°è±¡: éšç§æ¨¡å¼ä¸‹ï¼Œå‡ ä¹éƒ½æ˜¯ from memroy cache. æ€»ç»“: éšç§æ¨¡å¼ æ˜¯å§ã€‚ æˆ‘ä¸èƒ½æš´éœ²ä½ ä¸œè¥¿ã€‚è¿˜æ˜¯æ”¾åˆ°å†…å­˜å§ã€‚ ä½ å…³ï¼Œæˆ‘æ­»ã€‚","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"},{"name":"ç¼“å­˜","slug":"ç¼“å­˜","permalink":"http://yoursite.com/tags/ç¼“å­˜/"}]},{"title":"Proxy","slug":"Proxy","date":"2018-10-27T03:07:46.000Z","updated":"2019-11-10T14:37:39.021Z","comments":true,"path":"2018/10/27/Proxy/","link":"","permalink":"http://yoursite.com/2018/10/27/Proxy/","excerpt":"æ¦‚è¿°ES6 åŸç”Ÿæä¾› Proxy æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Proxy å®ä¾‹ã€‚ 1var proxy = new Proxy(target, handler); Proxy å¯¹è±¡çš„æ‰€æœ‰ç”¨æ³•ï¼Œéƒ½æ˜¯ä¸Šé¢è¿™ç§å½¢å¼ï¼Œä¸åŒçš„åªæ˜¯ handler å‚æ•°çš„å†™æ³•ã€‚å…¶ä¸­ï¼Œnew Proxy()è¡¨ç¤ºç”Ÿæˆä¸€ä¸ª Proxy å®ä¾‹ï¼Œtarget å‚æ•°è¡¨ç¤ºæ‰€è¦æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ï¼Œhandler å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶æ‹¦æˆªè¡Œä¸ºã€‚","text":"æ¦‚è¿°ES6 åŸç”Ÿæä¾› Proxy æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Proxy å®ä¾‹ã€‚ 1var proxy = new Proxy(target, handler); Proxy å¯¹è±¡çš„æ‰€æœ‰ç”¨æ³•ï¼Œéƒ½æ˜¯ä¸Šé¢è¿™ç§å½¢å¼ï¼Œä¸åŒçš„åªæ˜¯ handler å‚æ•°çš„å†™æ³•ã€‚å…¶ä¸­ï¼Œnew Proxy()è¡¨ç¤ºç”Ÿæˆä¸€ä¸ª Proxy å®ä¾‹ï¼Œtarget å‚æ•°è¡¨ç¤ºæ‰€è¦æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ï¼Œhandler å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶æ‹¦æˆªè¡Œä¸ºã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªæ‹¦æˆªè¯»å–å±æ€§è¡Œä¸ºçš„ä¾‹å­ã€‚ 123456789101112var proxy = new Proxy( &#123;&#125;, &#123; get: function(target, property) &#123; return 35; &#125; &#125;);proxy.time; // 35proxy.name; // 35proxy.title; // 35 ä¸Šé¢ä»£ç ä¸­ï¼Œä½œä¸ºæ„é€ å‡½æ•°ï¼ŒProxy æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€è¦ä»£ç†çš„ç›®æ ‡å¯¹è±¡ï¼ˆä¸Šä¾‹æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼‰ï¼Œå³å¦‚æœæ²¡æœ‰ Proxy çš„ä»‹å…¥ï¼Œæ“ä½œåŸæ¥è¦è®¿é—®çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå¯¹äºæ¯ä¸€ä¸ªè¢«ä»£ç†çš„æ“ä½œï¼Œéœ€è¦æä¾›ä¸€ä¸ªå¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ‹¦æˆªå¯¹åº”çš„æ“ä½œã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œé…ç½®å¯¹è±¡æœ‰ä¸€ä¸ª get æ–¹æ³•ï¼Œç”¨æ¥æ‹¦æˆªå¯¹ç›®æ ‡å¯¹è±¡å±æ€§çš„è®¿é—®è¯·æ±‚ã€‚get æ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ç›®æ ‡å¯¹è±¡å’Œæ‰€è¦è®¿é—®çš„å±æ€§ã€‚å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæ‹¦æˆªå‡½æ•°æ€»æ˜¯è¿”å› 35ï¼Œæ‰€ä»¥è®¿é—®ä»»ä½•å±æ€§éƒ½å¾—åˆ° 35ã€‚æ³¨æ„ï¼Œè¦ä½¿å¾— Proxy èµ·ä½œç”¨ï¼Œå¿…é¡»é’ˆå¯¹ Proxy å®ä¾‹ï¼ˆä¸Šä¾‹æ˜¯ proxy å¯¹è±¡ï¼‰è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç›®æ ‡å¯¹è±¡ï¼ˆä¸Šä¾‹æ˜¯ç©ºå¯¹è±¡ï¼‰è¿›è¡Œæ“ä½œã€‚å¦‚æœ handler æ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œé‚£å°±ç­‰åŒäºç›´æ¥é€šå‘åŸå¯¹è±¡ã€‚åŒä¸€ä¸ªæ‹¦æˆªå™¨å‡½æ•°ï¼Œå¯ä»¥è®¾ç½®æ‹¦æˆªå¤šä¸ªæ“ä½œã€‚ 12345678910111213141516171819202122232425var handler = &#123; get: function(target, name) &#123; if (name === \"prototype\") &#123; return Object.prototype; &#125; return \"Hello, \" + name; &#125;, apply: function(target, thisBinding, args) &#123; return args[0]; &#125;, construct: function(target, args) &#123; return &#123; value: args[1] &#125;; &#125;&#125;;var fproxy = new Proxy(function(x, y) &#123; return x + y;&#125;, handler);fproxy(1, 2); // 1new fproxy(1, 2); // &#123;value: 2&#125;fproxy.prototype === Object.prototype; // truefproxy.foo === \"Hello, foo\"; // true Proxy æ”¯æŒçš„æ‹¦æˆªæ“ä½œä¸€è§ˆProxy æ”¯æŒçš„æ‹¦æˆªæ“ä½œä¸€è§ˆï¼Œä¸€å…± 13 ç§ã€‚ get(target, propKey, receiver)æ‹¦æˆªå¯¹è±¡å±æ€§çš„è¯»å–ï¼Œæ¯”å¦‚ proxy.foo å’Œ proxy[â€˜fooâ€™]ã€‚ set(target, propKey, value, receiver)æ‹¦æˆªå¯¹è±¡å±æ€§çš„è®¾ç½®ï¼Œæ¯”å¦‚ proxy.foo = v æˆ– proxy[â€˜fooâ€™] = vï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ has(target, propKey)æ‹¦æˆª propKey in proxy çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ deleteProperty(target, propKey)æ‹¦æˆª delete proxy[propKey]çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ ownKeys(target)æ‹¦æˆª Object.getOwnPropertyNames(proxy)ã€Object.getOwnPropertySymbols(proxy)ã€Object.keys(proxy)ã€forâ€¦in å¾ªç¯ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ–¹æ³•è¿”å›ç›®æ ‡å¯¹è±¡æ‰€æœ‰è‡ªèº«çš„å±æ€§çš„å±æ€§åï¼Œè€Œ Object.keys()çš„è¿”å›ç»“æœä»…åŒ…æ‹¬ç›®æ ‡å¯¹è±¡è‡ªèº«çš„å¯éå†å±æ€§ã€‚ getOwnPropertyDescriptor(target, propKey)æ‹¦æˆª Object.getOwnPropertyDescriptor(proxy, propKey)ï¼Œè¿”å›å±æ€§çš„æè¿°å¯¹è±¡ã€‚ defineProperty(target, propKey, propDesc)æ‹¦æˆª Object.defineProperty(proxy, propKey, propDescï¼‰ã€Object.defineProperties(proxy, propDescs)ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ preventExtensions(target)æ‹¦æˆª Object.preventExtensions(proxy)ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ getPrototypeOf(target)æ‹¦æˆª Object.getPrototypeOf(proxy)ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚ isExtensible(target)æ‹¦æˆª Object.isExtensible(proxy)ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ setPrototypeOf(target, proto)æ‹¦æˆª Object.setPrototypeOf(proxy, proto)ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœç›®æ ‡å¯¹è±¡æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸¤ç§é¢å¤–æ“ä½œå¯ä»¥æ‹¦æˆªã€‚ apply(target, object, args)æ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºå‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚ proxy(â€¦args)ã€proxy.call(object, â€¦args)ã€proxy.apply(â€¦)ã€‚ construct(target, args)æ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚ new proxy(â€¦args)ã€‚ Proxy å®ä¾‹çš„æ–¹æ³•ä¸‹é¢æ˜¯ä¸Šé¢è¿™äº›æ‹¦æˆªæ–¹æ³•çš„è¯¦ç»†ä»‹ç»ã€‚ get()get æ–¹æ³•ç”¨äºæ‹¦æˆªæŸä¸ªå±æ€§çš„è¯»å–æ“ä½œï¼Œå¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºç›®æ ‡å¯¹è±¡ã€å±æ€§åå’Œ proxy å®ä¾‹æœ¬èº«ï¼ˆä¸¥æ ¼åœ°è¯´ï¼Œå®ƒæ€»æ˜¯æŒ‡å‘åŸå§‹çš„è¯»æ“ä½œæ‰€åœ¨çš„é‚£ä¸ªå¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å°±æ˜¯ Proxy å®ä¾‹ï¼‰ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå‚æ•°å¯é€‰ã€‚ 12345678910111213141516var person = &#123; name: \"å¼ ä¸‰\"&#125;;var proxy = new Proxy(person, &#123; get: function(target, property) &#123; if (property in target) &#123; return target[property]; &#125; else &#123; throw new ReferenceError('Property \"' + property + '\" does not exist.'); &#125; &#125;&#125;);proxy.name; // \"å¼ ä¸‰\"proxy.age; // æŠ›å‡ºä¸€ä¸ªé”™è¯¯ get æ–¹æ³•å¯ä»¥ç»§æ‰¿ã€‚ 123456789101112let proto = new Proxy( &#123;&#125;, &#123; get(target, propertyKey, receiver) &#123; console.log(\"GET \" + propertyKey); return target[propertyKey]; &#125; &#125;);let obj = Object.create(proto);obj.foo; // \"GET foo\" ä¸Šé¢ä»£ç ä¸­ï¼Œæ‹¦æˆªæ“ä½œå®šä¹‰åœ¨ Prototype å¯¹è±¡ä¸Šé¢ï¼Œæ‰€ä»¥å¦‚æœè¯»å– obj å¯¹è±¡ç»§æ‰¿çš„å±æ€§æ—¶ï¼Œæ‹¦æˆªä¼šç”Ÿæ•ˆã€‚åˆ©ç”¨ Proxyï¼Œå¯ä»¥å°†è¯»å–å±æ€§çš„æ“ä½œï¼ˆgetï¼‰ï¼Œè½¬å˜ä¸ºæ‰§è¡ŒæŸä¸ªå‡½æ•°ï¼Œä»è€Œå®ç°å±æ€§çš„é“¾å¼æ“ä½œã€‚ 1234567891011121314151617181920212223242526272829303132var pipe = (function() &#123; return function(value) &#123; var funcStack = []; var oproxy = new Proxy( &#123;&#125;, &#123; get: function(pipeObject, fnName) &#123; if (fnName === \"get\") &#123; return funcStack.reduce(function(val, fn) &#123; return fn(val); &#125;, value); &#125; funcStack.push(window[fnName]); return oproxy; &#125; &#125; ); return oproxy; &#125;;&#125;)();var double = n =&gt; n * 2;var pow = n =&gt; n * n;var reverseInt = n =&gt; n .toString() .split(\"\") .reverse() .join(\"\") | 0;pipe(3).double.pow.reverseInt.get; // 63 ä¸‹é¢æ˜¯ä¸€ä¸ª get æ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°çš„ä¾‹å­ 1234567891011const proxy = new Proxy( &#123;&#125;, &#123; get: function(target, property, receiver) &#123; return receiver; &#125; &#125;);const d = Object.create(proxy);d.a === d; // true ä¸Šé¢ä»£ç ä¸­ï¼Œd å¯¹è±¡æœ¬èº«æ²¡æœ‰ a å±æ€§ï¼Œæ‰€ä»¥è¯»å– d.a çš„æ—¶å€™ï¼Œä¼šå» d çš„åŸå‹ proxy å¯¹è±¡æ‰¾ã€‚è¿™æ—¶ï¼Œreceiver å°±æŒ‡å‘ dï¼Œä»£è¡¨åŸå§‹çš„è¯»æ“ä½œæ‰€åœ¨çš„é‚£ä¸ªå¯¹è±¡ã€‚å¦‚æœä¸€ä¸ªå±æ€§ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰ä¸”ä¸å¯å†™ï¼ˆwritableï¼‰ï¼Œåˆ™ Proxy ä¸èƒ½ä¿®æ”¹è¯¥å±æ€§ï¼Œå¦åˆ™é€šè¿‡ Proxy å¯¹è±¡è®¿é—®è¯¥å±æ€§ä¼šæŠ¥é”™ã€‚ 123456789101112131415161718192021const target = Object.defineProperties( &#123;&#125;, &#123; foo: &#123; value: 123, writable: false, configurable: false &#125; &#125;);const handler = &#123; get(target, propKey) &#123; return \"abc\"; &#125;&#125;;const proxy = new Proxy(target, handler);proxy.foo;// TypeError: Invariant check failed set()set æ–¹æ³•ç”¨æ¥æ‹¦æˆªæŸä¸ªå±æ€§çš„èµ‹å€¼æ“ä½œï¼Œå¯ä»¥æ¥å—å››ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºç›®æ ‡å¯¹è±¡ã€å±æ€§åã€å±æ€§å€¼å’Œ Proxy å®ä¾‹æœ¬èº«ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå‚æ•°å¯é€‰ã€‚åˆ©ç”¨ set æ–¹æ³•ï¼Œå¯ä»¥è¿›è¡Œæ•°æ®éªŒè¯ï¼Œè¿˜å¯ä»¥æ•°æ®ç»‘å®šï¼Œå³æ¯å½“å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–° DOMã€‚æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨å¯¹è±¡ä¸Šé¢è®¾ç½®å†…éƒ¨å±æ€§ï¼Œå±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä½¿ç”¨ä¸‹åˆ’çº¿å¼€å¤´ï¼Œè¡¨ç¤ºè¿™äº›å±æ€§ä¸åº”è¯¥è¢«å¤–éƒ¨ä½¿ç”¨ã€‚ç»“åˆ get å’Œ set æ–¹æ³•ï¼Œå°±å¯ä»¥åšåˆ°é˜²æ­¢è¿™äº›å†…éƒ¨å±æ€§è¢«å¤–éƒ¨è¯»å†™ã€‚ 12345678910111213141516171819202122const handler = &#123; get(target, key) &#123; invariant(key, \"get\"); return target[key]; &#125;, set(target, key, value) &#123; invariant(key, \"set\"); target[key] = value; return true; &#125;&#125;;function invariant(key, action) &#123; if (key[0] === \"_\") &#123; throw new Error(`Invalid attempt to $&#123;action&#125; private \"$&#123;key&#125;\" property`); &#125;&#125;const target = &#123;&#125;;const proxy = new Proxy(target, handler);proxy._prop;// Error: Invalid attempt to get private \"_prop\" propertyproxy._prop = \"c\";// Error: Invalid attempt to set private \"_prop\" property ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦è¯»å†™çš„å±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸‹åˆ’çº¿ï¼Œä¸€å¾‹æŠ›é”™ï¼Œä»è€Œè¾¾åˆ°ç¦æ­¢è¯»å†™å†…éƒ¨å±æ€§çš„ç›®çš„ã€‚ä¸‹é¢æ˜¯ set æ–¹æ³•ç¬¬å››ä¸ªå‚æ•°çš„ä¾‹å­ã€‚ 1234567891011const handler = &#123; set: function(obj, prop, value, receiver) &#123; obj[prop] = receiver; &#125;&#125;;const proxy = new Proxy(&#123;&#125;, handler);const myObj = &#123;&#125;;Object.setPrototypeOf(myObj, proxy);myObj.foo = \"bar\";myObj.foo === myObj; // true ä¸Šé¢ä»£ç ä¸­ï¼Œè®¾ç½® myObj.foo å±æ€§çš„å€¼æ—¶ï¼ŒmyObj å¹¶æ²¡æœ‰ foo å±æ€§ï¼Œå› æ­¤å¼•æ“ä¼šåˆ° myObj çš„åŸå‹é“¾å»æ‰¾ foo å±æ€§ã€‚myObj çš„åŸå‹å¯¹è±¡ proxy æ˜¯ä¸€ä¸ª Proxy å®ä¾‹ï¼Œè®¾ç½®å®ƒçš„ foo å±æ€§ä¼šè§¦å‘ set æ–¹æ³•ã€‚è¿™æ—¶ï¼Œç¬¬å››ä¸ªå‚æ•° receiver å°±æŒ‡å‘åŸå§‹èµ‹å€¼è¡Œä¸ºæ‰€åœ¨çš„å¯¹è±¡ myObjã€‚å¦‚æœç›®æ ‡å¯¹è±¡è‡ªèº«çš„æŸä¸ªå±æ€§ï¼Œä¸å¯å†™ä¸”ä¸å¯é…ç½®ï¼Œé‚£ä¹ˆ set æ–¹æ³•å°†ä¸èµ·ä½œç”¨ã€‚ 123456789101112131415const obj = &#123;&#125;;Object.defineProperty(obj, \"foo\", &#123; value: \"bar\", writable: false&#125;);const handler = &#123; set: function(obj, prop, value, receiver) &#123; obj[prop] = \"baz\"; &#125;&#125;;const proxy = new Proxy(obj, handler);proxy.foo = \"baz\";proxy.foo; // \"bar\" apply()apply æ–¹æ³•æ‹¦æˆªå‡½æ•°çš„è°ƒç”¨ã€call å’Œ apply æ“ä½œã€‚apply æ–¹æ³•å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ç›®æ ‡å¯¹è±¡ã€ç›®æ ‡å¯¹è±¡çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆthisï¼‰å’Œç›®æ ‡å¯¹è±¡çš„å‚æ•°æ•°ç»„ã€‚ 12345678910111213var target = function() &#123; return \"I am the target\";&#125;;var handler = &#123; apply: function() &#123; return \"I am the proxy\"; &#125;&#125;;var p = new Proxy(target, handler);p();// \"I am the proxy\" ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ p æ˜¯ Proxy çš„å®ä¾‹ï¼Œå½“å®ƒä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼ˆp()ï¼‰ï¼Œå°±ä¼šè¢« apply æ–¹æ³•æ‹¦æˆªï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦å¤–ï¼Œç›´æ¥è°ƒç”¨ Reflect.apply æ–¹æ³•ï¼Œä¹Ÿä¼šè¢«æ‹¦æˆªã€‚ has()has æ–¹æ³•ç”¨æ¥æ‹¦æˆª HasProperty æ“ä½œï¼Œå³åˆ¤æ–­å¯¹è±¡æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šç”Ÿæ•ˆã€‚å…¸å‹çš„æ“ä½œå°±æ˜¯ in è¿ç®—ç¬¦ã€‚has æ–¹æ³•å¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ç›®æ ‡å¯¹è±¡ã€éœ€æŸ¥è¯¢çš„å±æ€§åã€‚ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨ has æ–¹æ³•éšè—æŸäº›å±æ€§ï¼Œä¸è¢« in è¿ç®—ç¬¦å‘ç°ã€‚ 1234567891011var handler = &#123; has(target, key) &#123; if (key[0] === \"_\") &#123; return false; &#125; return key in target; &#125;&#125;;var target = &#123; _prop: \"foo\", prop: \"foo\" &#125;;var proxy = new Proxy(target, handler);\"_prop\" in proxy; // false å¦‚æœåŸå¯¹è±¡ä¸å¯é…ç½®æˆ–è€…ç¦æ­¢æ‰©å±•ï¼Œè¿™æ—¶ has æ‹¦æˆªä¼šæŠ¥é”™ã€‚ 12345678910var obj = &#123; a: 10 &#125;;Object.preventExtensions(obj);var p = new Proxy(obj, &#123; has: function(target, prop) &#123; return false; &#125;&#125;);\"a\" in p; // TypeError is thrown ä¸Šé¢ä»£ç ä¸­ï¼Œobj å¯¹è±¡ç¦æ­¢æ‰©å±•ï¼Œç»“æœä½¿ç”¨ has æ‹¦æˆªå°±ä¼šæŠ¥é”™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸä¸ªå±æ€§ä¸å¯é…ç½®ï¼ˆæˆ–è€…ç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼‰ï¼Œåˆ™ has æ–¹æ³•å°±ä¸å¾—â€œéšè—â€ï¼ˆå³è¿”å› falseï¼‰ç›®æ ‡å¯¹è±¡çš„è¯¥å±æ€§ã€‚has æ–¹æ³•æ‹¦æˆªçš„æ˜¯ HasProperty æ“ä½œï¼Œè€Œä¸æ˜¯ HasOwnProperty æ“ä½œï¼Œå³ has æ–¹æ³•ä¸åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿˜æ˜¯ç»§æ‰¿çš„å±æ€§ã€‚å¦å¤–ï¼Œè™½ç„¶ forâ€¦in å¾ªç¯ä¹Ÿç”¨åˆ°äº† in è¿ç®—ç¬¦ï¼Œä½†æ˜¯ has æ‹¦æˆªå¯¹ forâ€¦in å¾ªç¯ä¸ç”Ÿæ•ˆã€‚ construct()construct æ–¹æ³•ç”¨äºæ‹¦æˆª new å‘½ä»¤ï¼Œä¸‹é¢æ˜¯æ‹¦æˆªå¯¹è±¡çš„å†™æ³•ã€‚ 12345var handler = &#123; construct(target, args, newTarget) &#123; return new target(...args); &#125;&#125;; construct æ–¹æ³•å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚targetï¼šç›®æ ‡å¯¹è±¡ã€‚argsï¼šæ„é€ å‡½æ•°çš„å‚æ•°å¯¹è±¡ã€‚newTargetï¼šåˆ›é€ å®ä¾‹å¯¹è±¡æ—¶ï¼Œnew å‘½ä»¤ä½œç”¨çš„æ„é€ å‡½æ•°ã€‚construct æ–¹æ³•è¿”å›çš„å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ 12345678910var p = new Proxy(function() &#123;&#125;, &#123; construct: function(target, args) &#123; console.log(\"called: \" + args.join(\", \")); return &#123; value: args[0] * 10 &#125;; &#125;&#125;);new p(1).value;// \"called: 1\"// 10 1234567var p = new Proxy(function() &#123;&#125;, &#123; construct: function(target, argumentsList) &#123; return 1; &#125;&#125;);new p(); // æŠ¥é”™ deleteProperty()deleteProperty æ–¹æ³•ç”¨äºæ‹¦æˆª delete æ“ä½œï¼Œå¦‚æœè¿™ä¸ªæ–¹æ³•æŠ›å‡ºé”™è¯¯æˆ–è€…è¿”å› falseï¼Œå½“å‰å±æ€§å°±æ— æ³•è¢« delete å‘½ä»¤åˆ é™¤ã€‚ 12345678910111213141516var handler = &#123; deleteProperty(target, key) &#123; invariant(key, \"delete\"); return true; &#125;&#125;;function invariant(key, action) &#123; if (key[0] === \"_\") &#123; throw new Error(`Invalid attempt to $&#123;action&#125; private \"$&#123;key&#125;\" property`); &#125;&#125;var target = &#123; _prop: \"foo\" &#125;;var proxy = new Proxy(target, handler);delete proxy._prop;// Error: Invalid attempt to delete private \"_prop\" property deleteProperty æ–¹æ³•æ‹¦æˆªäº† delete æ“ä½œç¬¦ï¼Œåˆ é™¤ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§ä¼šæŠ¥é”™ã€‚æ³¨æ„ï¼Œç›®æ ‡å¯¹è±¡è‡ªèº«çš„ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰çš„å±æ€§ï¼Œä¸èƒ½è¢« deleteProperty æ–¹æ³•åˆ é™¤ï¼Œå¦åˆ™æŠ¥é”™ã€‚ defineProperty()defineProperty æ–¹æ³•æ‹¦æˆªäº† Object.defineProperty æ“ä½œã€‚ 12345678var handler = &#123; defineProperty(target, key, descriptor) &#123; return false; &#125;&#125;;var target = &#123;&#125;;var proxy = new Proxy(target, handler);proxy.foo = \"bar\"; // ä¸ä¼šç”Ÿæ•ˆ defineProperty æ–¹æ³•è¿”å› falseï¼Œå¯¼è‡´æ·»åŠ æ–°å±æ€§æ€»æ˜¯æ— æ•ˆã€‚æ³¨æ„ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼ˆextensibleï¼‰ï¼Œåˆ™ defineProperty ä¸èƒ½å¢åŠ ç›®æ ‡å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡çš„æŸä¸ªå±æ€§ä¸å¯å†™ï¼ˆwritableï¼‰æˆ–ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰ï¼Œåˆ™ defineProperty æ–¹æ³•ä¸å¾—æ”¹å˜è¿™ä¸¤ä¸ªè®¾ç½®ã€‚ getOwnPropertyDescriptor()getOwnPropertyDescriptor æ–¹æ³•æ‹¦æˆª Object.getOwnPropertyDescriptor()ï¼Œè¿”å›ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡æˆ–è€… undefinedã€‚ 12345678910111213141516var handler = &#123; getOwnPropertyDescriptor(target, key) &#123; if (key[0] === \"_\") &#123; return; &#125; return Object.getOwnPropertyDescriptor(target, key); &#125;&#125;;var target = &#123; _foo: \"bar\", baz: \"tar\" &#125;;var proxy = new Proxy(target, handler);Object.getOwnPropertyDescriptor(proxy, \"wat\");// undefinedObject.getOwnPropertyDescriptor(proxy, \"_foo\");// undefinedObject.getOwnPropertyDescriptor(proxy, \"baz\");// &#123; value: 'tar', writable: true, enumerable: true, configurable: true &#125; handler.getOwnPropertyDescriptor æ–¹æ³•å¯¹äºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§åä¼šè¿”å› undefinedã€‚ getPrototypeOf()getPrototypeOf æ–¹æ³•ä¸»è¦ç”¨æ¥æ‹¦æˆªè·å–å¯¹è±¡åŸå‹ã€‚å…·ä½“æ¥è¯´ï¼Œæ‹¦æˆªä¸‹é¢è¿™äº›æ“ä½œã€‚ Object.prototype.__proto__ Object.prototype.isPrototypeOf() Object.getPrototypeOf() Reflect.getPrototypeOf() instanceof 12345678910var proto = &#123;&#125;;var p = new Proxy( &#123;&#125;, &#123; getPrototypeOf(target) &#123; return proto; &#125; &#125;);Object.getPrototypeOf(p) === proto; // true getPrototypeOf æ–¹æ³•çš„è¿”å›å€¼å¿…é¡»æ˜¯å¯¹è±¡æˆ–è€… nullï¼Œå¦åˆ™æŠ¥é”™ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼ˆextensibleï¼‰ï¼Œ getPrototypeOf æ–¹æ³•å¿…é¡»è¿”å›ç›®æ ‡å¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚ isExtensible()isExtensible æ–¹æ³•æ‹¦æˆª Object.isExtensible æ“ä½œ 12345678910111213var p = new Proxy( &#123;&#125;, &#123; isExtensible: function(target) &#123; console.log(\"called\"); return true; &#125; &#125;);Object.isExtensible(p);// \"called\"// true è¯¥æ–¹æ³•åªèƒ½è¿”å›å¸ƒå°”å€¼ï¼Œå¦åˆ™è¿”å›å€¼ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå¸ƒå°”å€¼ã€‚è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªå¼ºé™åˆ¶ï¼Œå®ƒçš„è¿”å›å€¼å¿…é¡»ä¸ç›®æ ‡å¯¹è±¡çš„ isExtensible å±æ€§ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚ 1234567891011var p = new Proxy( &#123;&#125;, &#123; isExtensible: function(target) &#123; return false; &#125; &#125;);Object.isExtensible(p); // æŠ¥é”™Object.isExtensible(proxy) === Object.isExtensible(target); //true ownKeys()ownKeys æ–¹æ³•ç”¨æ¥æ‹¦æˆªå¯¹è±¡è‡ªèº«å±æ€§çš„è¯»å–æ“ä½œã€‚å…·ä½“æ¥è¯´ï¼Œæ‹¦æˆªä»¥ä¸‹æ“ä½œã€‚ Object.getOwnPropertyNames() Object.getOwnPropertySymbols() Object.keys() forâ€¦in å¾ªç¯ 12345678910111213141516let target = &#123; a: 1, b: 2, c: 3&#125;;let handler = &#123; ownKeys(target) &#123; return [\"a\"]; &#125;&#125;;let proxy = new Proxy(target, handler);Object.keys(proxy);// [ 'a' ] æ³¨æ„ï¼Œä½¿ç”¨ Object.keys æ–¹æ³•æ—¶ï¼Œæœ‰ä¸‰ç±»å±æ€§ä¼šè¢« ownKeys æ–¹æ³•è‡ªåŠ¨è¿‡æ»¤ï¼Œä¸ä¼šè¿”å›ã€‚ ç›®æ ‡å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§ å±æ€§åä¸º Symbol å€¼ ä¸å¯éå†ï¼ˆenumerableï¼‰çš„å±æ€§ 123456789101112131415161718192021222324let target = &#123; a: 1, b: 2, c: 3, [Symbol.for(\"secret\")]: \"4\"&#125;;Object.defineProperty(target, \"key\", &#123; enumerable: false, configurable: true, writable: true, value: \"static\"&#125;);let handler = &#123; ownKeys(target) &#123; return [\"a\", \"d\", Symbol.for(\"secret\"), \"key\"]; &#125;&#125;;let proxy = new Proxy(target, handler);Object.keys(proxy);// ['a'] ä¸Šé¢ä»£ç ä¸­ï¼ŒownKeys æ–¹æ³•ä¹‹ä¸­ï¼Œæ˜¾å¼è¿”å›ä¸å­˜åœ¨çš„å±æ€§ï¼ˆdï¼‰ã€Symbol å€¼ï¼ˆSymbol.for(â€˜secretâ€™)ï¼‰ã€ä¸å¯éå†çš„å±æ€§ï¼ˆkeyï¼‰ï¼Œç»“æœéƒ½è¢«è‡ªåŠ¨è¿‡æ»¤æ‰ã€‚ 123456789101112131415161718192021222324//ownKeysæ–¹æ³•è¿˜å¯ä»¥æ‹¦æˆªObject.getOwnPropertyNames()var p = new Proxy( &#123;&#125;, &#123; ownKeys: function(target) &#123; return [\"a\", \"b\", \"c\"]; &#125; &#125;);Object.getOwnPropertyNames(p);// [ 'a', 'b', 'c' ]//for...inå¾ªç¯ä¹Ÿå—åˆ°ownKeysæ–¹æ³•çš„æ‹¦æˆªconst obj = &#123; hello: \"world\" &#125;;const proxy = new Proxy(obj, &#123; ownKeys: function() &#123; return [\"a\", \"b\"]; &#125;&#125;);for (let key in proxy) &#123; console.log(key); // æ²¡æœ‰ä»»ä½•è¾“å‡º&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œownkeys æŒ‡å®šåªè¿”å› a å’Œ b å±æ€§ï¼Œç”±äº obj æ²¡æœ‰è¿™ä¸¤ä¸ªå±æ€§ï¼Œå› æ­¤ forâ€¦in å¾ªç¯ä¸ä¼šæœ‰ä»»ä½•è¾“å‡ºã€‚ownKeys æ–¹æ³•è¿”å›çš„æ•°ç»„æˆå‘˜ï¼Œåªèƒ½æ˜¯å­—ç¬¦ä¸²æˆ– Symbol å€¼ã€‚å¦‚æœæœ‰å…¶ä»–ç±»å‹çš„å€¼ï¼Œæˆ–è€…è¿”å›çš„æ ¹æœ¬ä¸æ˜¯æ•°ç»„ï¼Œå°±ä¼šæŠ¥é”™ã€‚ 12345678910var obj = &#123;&#125;;var p = new Proxy(obj, &#123; ownKeys: function(target) &#123; return [123, true, undefined, null, &#123;&#125;, []]; &#125;&#125;);Object.getOwnPropertyNames(p);// Uncaught TypeError: 123 is not a valid property name å¦‚æœç›®æ ‡å¯¹è±¡è‡ªèº«åŒ…å«ä¸å¯é…ç½®çš„å±æ€§ï¼Œåˆ™è¯¥å±æ€§å¿…é¡»è¢« ownKeys æ–¹æ³•è¿”å›ï¼Œå¦åˆ™æŠ¥é”™ã€‚ 123456789101112131415var obj = &#123;&#125;;Object.defineProperty(obj, \"a\", &#123; configurable: false, enumerable: true, value: 10&#125;);var p = new Proxy(obj, &#123; ownKeys: function(target) &#123; return [\"b\"]; &#125;&#125;);Object.getOwnPropertyNames(p);// Uncaught TypeError: 'ownKeys' on proxy: trap result did not include 'a' å¦‚æœç›®æ ‡å¯¹è±¡æ˜¯ä¸å¯æ‰©å±•çš„ï¼ˆnon-extensitionï¼‰ï¼Œè¿™æ—¶ ownKeys æ–¹æ³•è¿”å›çš„æ•°ç»„ä¹‹ä¸­ï¼Œå¿…é¡»åŒ…å«åŸå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œä¸”ä¸èƒ½åŒ…å«å¤šä½™çš„å±æ€§ï¼Œå¦åˆ™æŠ¥é”™ã€‚ 1234567891011121314var obj = &#123; a: 1&#125;;Object.preventExtensions(obj);var p = new Proxy(obj, &#123; ownKeys: function(target) &#123; return [\"a\", \"b\"]; &#125;&#125;);Object.getOwnPropertyNames(p);// Uncaught TypeError: 'ownKeys' on proxy: trap returned extra keys but proxy target is non-extensible preventExtensions()preventExtensions æ–¹æ³•æ‹¦æˆª Object.preventExtensions()ã€‚è¯¥æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå¸ƒå°”å€¼ã€‚è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œåªæœ‰ç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•æ—¶ï¼ˆå³ Object.isExtensible(proxy)ä¸º falseï¼‰ï¼Œproxy.preventExtensions æ‰èƒ½è¿”å› trueï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ 1234567891011121314151617181920212223242526var p = new Proxy( &#123;&#125;, &#123; preventExtensions: function(target) &#123; return true; &#125; &#125;);Object.preventExtensions(p); // æŠ¥é”™//ä¸ºäº†é˜²æ­¢å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸è¦åœ¨proxy.preventExtensionsæ–¹æ³•é‡Œé¢ï¼Œè°ƒç”¨ä¸€æ¬¡Object.preventExtensionsvar p = new Proxy( &#123;&#125;, &#123; preventExtensions: function(target) &#123; console.log(\"called\"); Object.preventExtensions(target); return true; &#125; &#125;);Object.preventExtensions(p);// \"called\"// true setPrototypeOf()setPrototypeOf æ–¹æ³•ä¸»è¦ç”¨æ¥æ‹¦æˆª Object.setPrototypeOf æ–¹æ³•ã€‚ 12345678910var handler = &#123; setPrototypeOf(target, proto) &#123; throw new Error(\"Changing the prototype is forbidden\"); &#125;&#125;;var proto = &#123;&#125;;var target = function() &#123;&#125;;var proxy = new Proxy(target, handler);Object.setPrototypeOf(proxy, proto);// Error: Changing the prototype is forbidden ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ä¿®æ”¹ target çš„åŸå‹å¯¹è±¡ï¼Œå°±ä¼šæŠ¥é”™ã€‚æ³¨æ„ï¼Œè¯¥æ–¹æ³•åªèƒ½è¿”å›å¸ƒå°”å€¼ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå¸ƒå°”å€¼ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼ˆextensibleï¼‰ï¼ŒsetPrototypeOf æ–¹æ³•ä¸å¾—æ”¹å˜ç›®æ ‡å¯¹è±¡çš„åŸå‹ã€‚ Proxy.revocable()Proxy.revocable æ–¹æ³•è¿”å›ä¸€ä¸ªå¯å–æ¶ˆçš„ Proxy å®ä¾‹ 12345678910let target = &#123;&#125;;let handler = &#123;&#125;;let &#123; proxy, revoke &#125; = Proxy.revocable(target, handler);proxy.foo = 123;proxy.foo; // 123revoke();proxy.foo; // TypeError: Revoked Proxy.revocable æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ proxy å±æ€§æ˜¯ Proxy å®ä¾‹ï¼Œrevoke å±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å–æ¶ˆ Proxy å®ä¾‹ã€‚ä¸Šé¢ä»£ç ä¸­ï¼Œå½“æ‰§è¡Œ revoke å‡½æ•°ä¹‹åï¼Œå†è®¿é—® Proxy å®ä¾‹ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚Proxy.revocable çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯ï¼Œç›®æ ‡å¯¹è±¡ä¸å…è®¸ç›´æ¥è®¿é—®ï¼Œå¿…é¡»é€šè¿‡ä»£ç†è®¿é—®ï¼Œä¸€æ—¦è®¿é—®ç»“æŸï¼Œå°±æ”¶å›ä»£ç†æƒï¼Œä¸å…è®¸å†æ¬¡è®¿é—®ã€‚ this é—®é¢˜è™½ç„¶ Proxy å¯ä»¥ä»£ç†é’ˆå¯¹ç›®æ ‡å¯¹è±¡çš„è®¿é—®ï¼Œä½†å®ƒä¸æ˜¯ç›®æ ‡å¯¹è±¡çš„é€æ˜ä»£ç†ï¼Œå³ä¸åšä»»ä½•æ‹¦æˆªçš„æƒ…å†µä¸‹ï¼Œä¹Ÿæ— æ³•ä¿è¯ä¸ç›®æ ‡å¯¹è±¡çš„è¡Œä¸ºä¸€è‡´ã€‚ä¸»è¦åŸå› å°±æ˜¯åœ¨ Proxy ä»£ç†çš„æƒ…å†µä¸‹ï¼Œç›®æ ‡å¯¹è±¡å†…éƒ¨çš„ this å…³é”®å­—ä¼šæŒ‡å‘ Proxy ä»£ç†ã€‚ 1234567891011const target = &#123; m: function() &#123; console.log(this === proxy); &#125;&#125;;const handler = &#123;&#125;;const proxy = new Proxy(target, handler);target.m(); // falseproxy.m(); // true proxy ç”¨é€”Proxyï¼Œè§åçŸ¥æ„ï¼Œå…¶åŠŸèƒ½éå¸¸ç±»ä¼¼äºè®¾è®¡æ¨¡å¼ä¸­çš„ä»£ç†æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å¸¸ç”¨äºä¸‰ä¸ªæ–¹é¢ï¼š æ‹¦æˆªå’Œç›‘è§†å¤–éƒ¨å¯¹å¯¹è±¡çš„è®¿é—® é™ä½å‡½æ•°æˆ–ç±»çš„å¤æ‚åº¦ åœ¨å¤æ‚æ“ä½œå‰å¯¹æ“ä½œè¿›è¡Œæ ¡éªŒæˆ–å¯¹æ‰€éœ€èµ„æºè¿›è¡Œç®¡ç† åœ¨æ”¯æŒ Proxy çš„æµè§ˆå™¨ç¯å¢ƒä¸­ï¼ŒProxy æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚Proxy(target, handler) æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œtarget æ˜¯è¢«ä»£ç†çš„å¯¹è±¡ï¼Œhandlder æ˜¯å£°æ˜äº†å„ç±»ä»£ç†æ“ä½œçš„å¯¹è±¡ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚å¤–ç•Œæ¯æ¬¡é€šè¿‡ä»£ç†å¯¹è±¡è®¿é—® target å¯¹è±¡çš„å±æ€§æ—¶ï¼Œå°±ä¼šç»è¿‡ handler å¯¹è±¡ï¼Œä»è¿™ä¸ªæµç¨‹æ¥çœ‹ï¼Œä»£ç†å¯¹è±¡å¾ˆç±»ä¼¼ middlewareï¼ˆä¸­é—´ä»¶ï¼‰ã€‚é‚£ä¹ˆ Proxy å¯ä»¥æ‹¦æˆªä»€ä¹ˆæ“ä½œå‘¢ï¼Ÿæœ€å¸¸è§çš„å°±æ˜¯ getï¼ˆè¯»å–ï¼‰ã€setï¼ˆä¿®æ”¹ï¼‰å¯¹è±¡å±æ€§ç­‰æ“ä½œï¼Œå®Œæ•´çš„å¯æ‹¦æˆªæ“ä½œåˆ—è¡¨è¯·ç‚¹å‡»è¿™é‡Œã€‚æ­¤å¤–ï¼ŒProxy å¯¹è±¡è¿˜æä¾›äº†ä¸€ä¸ª revoke æ–¹æ³•ï¼Œå¯ä»¥éšæ—¶æ³¨é”€æ‰€æœ‰çš„ä»£ç†æ“ä½œã€‚åœ¨æˆ‘ä»¬æ­£å¼ä»‹ç» Proxy ä¹‹å‰ï¼Œå»ºè®®ä½ å¯¹ Reflect æœ‰ä¸€å®šçš„äº†è§£ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ª ES6 æ–°å¢çš„å…¨å±€å¯¹è±¡ï¼Œè¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒ MDN Reflectã€‚ Basic123456789101112131415161718const target = &#123; name: \"Billy Bob\", age: 15&#125;;const handler = &#123; get(target, key, proxy) &#123; const today = new Date(); console.log(`GET request made for $&#123;key&#125; at $&#123;today&#125;`); return Reflect.get(target, key, proxy); &#125;&#125;;const proxy = new Proxy(target, handler);proxy.name;// =&gt; \"GET request made for name at Thu Jul 21 2016 15:26:20 GMT+0800 (CST)\"// =&gt; \"Billy Bob\" åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªè¢«ä»£ç†çš„ç›®æ ‡å¯¹è±¡ targetï¼Œç„¶åå£°æ˜äº†åŒ…å«æ‰€æœ‰ä»£ç†æ“ä½œçš„ handler å¯¹è±¡ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ Proxy(target, handler) åˆ›å»ºä»£ç†å¯¹è±¡ proxyï¼Œæ­¤åæ‰€æœ‰ä½¿ç”¨ proxy å¯¹ target å±æ€§çš„è®¿é—®éƒ½ä¼šç»è¿‡ handler çš„å¤„ç†ã€‚ 1. æŠ½ç¦»æ ¡éªŒæ¨¡å—è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ç±»å‹æ ¡éªŒå¼€å§‹åšèµ·ï¼Œè¿™ä¸ªç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Proxy ä¿éšœæ•°æ®ç±»å‹çš„å‡†ç¡®æ€§ï¼š 1234567891011121314151617181920let numericDataStore = &#123; count: 0, amount: 1234, total: 14&#125;;numericDataStore = new Proxy(numericDataStore, &#123; set(target, key, value, proxy) &#123; if (typeof value !== \"number\") &#123; throw Error(\"Properties in numericDataStore can only be numbers\"); &#125; return Reflect.set(target, key, value, proxy); &#125;&#125;);// æŠ›å‡ºé”™è¯¯ï¼Œå› ä¸º \"foo\" ä¸æ˜¯æ•°å€¼numericDataStore.count = \"foo\";// èµ‹å€¼æˆåŠŸnumericDataStore.count = 333; å¦‚æœè¦ç›´æ¥ä¸ºå¯¹è±¡çš„æ‰€æœ‰å±æ€§å¼€å‘ä¸€ä¸ªæ ¡éªŒå™¨å¯èƒ½å¾ˆå¿«å°±ä¼šè®©ä»£ç ç»“æ„å˜å¾—è‡ƒè‚¿ï¼Œä½¿ç”¨ Proxy åˆ™å¯ä»¥å°†æ ¡éªŒå™¨ä»æ ¸å¿ƒé€»è¾‘åˆ†ç¦»å‡ºæ¥è‡ªæˆä¸€ä½“ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940function createValidator(target, validator) &#123; return new Proxy(target, &#123; _validator: validator, set(target, key, value, proxy) &#123; if (target.hasOwnProperty(key)) &#123; let validator = this._validator[key]; if (!!validator(value)) &#123; return Reflect.set(target, key, value, proxy); &#125; else &#123; throw Error(`Cannot set $&#123;key&#125; to $&#123;value&#125;. Invalid.`); &#125; &#125; else &#123; throw Error(`$&#123;key&#125; is not a valid property`); &#125; &#125; &#125;);&#125;const personValidators = &#123; name(val) &#123; return typeof val === \"string\"; &#125;, age(val) &#123; return typeof age === \"number\" &amp;&amp; age &gt; 18; &#125;&#125;;class Person &#123; constructor(name, age) &#123; this.name = name; this.age = age; return createValidator(this, personValidators); &#125;&#125;const bill = new Person(\"Bill\", 25);// ä»¥ä¸‹æ“ä½œéƒ½ä¼šæŠ¥é”™bill.name = 0;bill.age = \"Bill\";bill.age = 15; é€šè¿‡æ ¡éªŒå™¨å’Œä¸»é€»è¾‘çš„åˆ†ç¦»ï¼Œä½ å¯ä»¥æ— é™æ‰©å±• personValidators æ ¡éªŒå™¨çš„å†…å®¹ï¼Œè€Œä¸ä¼šå¯¹ç›¸å…³çš„ç±»æˆ–å‡½æ•°é€ æˆç›´æ¥ç ´åã€‚æ›´å¤æ‚ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ Proxy æ¨¡æ‹Ÿç±»å‹æ£€æŸ¥ï¼Œæ£€æŸ¥å‡½æ•°æ˜¯å¦æ¥æ”¶äº†ç±»å‹å’Œæ•°é‡éƒ½æ­£ç¡®çš„å‚æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748let obj = &#123; pickyMethodOne: function(obj, str, num) &#123; /* ... */ &#125;, pickyMethodTwo: function(num, obj) &#123; /*... */ &#125;&#125;;const argTypes = &#123; pickyMethodOne: [\"object\", \"string\", \"number\"], pickyMethodTwo: [\"number\", \"object\"]&#125;;obj = new Proxy(obj, &#123; get: function(target, key, proxy) &#123; var value = target[key]; return function(...args) &#123; var checkArgs = argChecker(key, args, argTypes[key]); return Reflect.apply(value, target, args); &#125;; &#125;&#125;);function argChecker(name, args, checkers) &#123; for (var idx = 0; idx &lt; args.length; idx++) &#123; var arg = args[idx]; var type = checkers[idx]; if (!arg || typeof arg !== type) &#123; console.warn( `You are incorrectly implementing the signature of $&#123;name&#125;. Check param $&#123;idx + 1&#125;` ); &#125; &#125;&#125;obj.pickyMethodOne();// &gt; You are incorrectly implementing the signature of pickyMethodOne. Check param 1// &gt; You are incorrectly implementing the signature of pickyMethodOne. Check param 2// &gt; You are incorrectly implementing the signature of pickyMethodOne. Check param 3obj.pickyMethodTwo(\"wopdopadoo\", &#123;&#125;);// &gt; You are incorrectly implementing the signature of pickyMethodTwo. Check param 1// No warnings loggedobj.pickyMethodOne(&#123;&#125;, \"a little string\", 123);obj.pickyMethodOne(123, &#123;&#125;); 2. ç§æœ‰å±æ€§åœ¨ JavaScript æˆ–å…¶ä»–è¯­è¨€ä¸­ï¼Œå¤§å®¶ä¼šçº¦å®šä¿—æˆåœ°åœ¨å˜é‡åä¹‹å‰æ·»åŠ ä¸‹åˆ’çº¿ _ æ¥è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆå¹¶ä¸æ˜¯çœŸæ­£çš„ç§æœ‰ï¼‰ï¼Œä½†æˆ‘ä»¬æ— æ³•ä¿è¯çœŸçš„æ²¡äººä¼šå»è®¿é—®æˆ–ä¿®æ”¹å®ƒã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªç§æœ‰çš„ apiKeyï¼Œä¾¿äº api è¿™ä¸ªå¯¹è±¡å†…éƒ¨çš„æ–¹æ³•è°ƒç”¨ï¼Œä½†ä¸å¸Œæœ›ä»å¤–éƒ¨ä¹Ÿèƒ½å¤Ÿè®¿é—® api._apiKey: 1234567891011121314var api = &#123; _apiKey: \"123abc456def\", /* mock methods that use this._apiKey */ getUsers: function() &#123;&#125;, getUser: function(userId) &#123;&#125;, setUser: function(userId, config) &#123;&#125;&#125;;// logs '123abc456def';console.log(\"An apiKey we want to keep private\", api._apiKey);// get and mutate _apiKeys as desiredvar apiKey = api._apiKey;api._apiKey = \"987654321\"; å¾ˆæ˜¾ç„¶ï¼Œçº¦å®šä¿—æˆæ˜¯æ²¡æœ‰æŸç¼šåŠ›çš„ã€‚ä½¿ç”¨ ES6 Proxy æˆ‘ä»¬å°±å¯ä»¥å®ç°çœŸå®çš„ç§æœ‰å˜é‡äº†ï¼Œä¸‹é¢é’ˆå¯¹ä¸åŒçš„è¯»å–æ–¹å¼æ¼”ç¤ºä¸¤ä¸ªä¸åŒçš„ç§æœ‰åŒ–æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ set / get æ‹¦æˆªè¯»å†™è¯·æ±‚å¹¶è¿”å› undefined: 123456789101112131415161718192021222324252627282930let api = &#123; _apiKey: \"123abc456def\", getUsers: function() &#123;&#125;, getUser: function(userId) &#123;&#125;, setUser: function(userId, config) &#123;&#125;&#125;;const RESTRICTED = [\"_apiKey\"];api = new Proxy(api, &#123; get(target, key, proxy) &#123; if (RESTRICTED.indexOf(key) &gt; -1) &#123; throw Error( `$&#123;key&#125; is restricted. Please see api documentation for further info.` ); &#125; return Reflect.get(target, key, proxy); &#125;, set(target, key, value, proxy) &#123; if (RESTRICTED.indexOf(key) &gt; -1) &#123; throw Error( `$&#123;key&#125; is restricted. Please see api documentation for further info.` ); &#125; return Reflect.get(target, key, value, proxy); &#125;&#125;);// ä»¥ä¸‹æ“ä½œéƒ½ä¼šæŠ›å‡ºé”™è¯¯console.log(api._apiKey);api._apiKey = \"987654321\"; ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨ has æ‹¦æˆª in æ“ä½œï¼š 123456789101112131415161718192021222324var api = &#123; _apiKey: \"123abc456def\", getUsers: function() &#123;&#125;, getUser: function(userId) &#123;&#125;, setUser: function(userId, config) &#123;&#125;&#125;;const RESTRICTED = [\"_apiKey\"];api = new Proxy(api, &#123; has(target, key) &#123; return RESTRICTED.indexOf(key) &gt; -1 ? false : Reflect.has(target, key); &#125;&#125;);// these log false, and `for in` iterators will ignore _apiKeyconsole.log(\"_apiKey\" in api);for (var key in api) &#123; if (api.hasOwnProperty(key) &amp;&amp; key === \"_apiKey\") &#123; console.log( \"This will never be logged because the proxy obscures _apiKey...\" ); &#125;&#125; 3. è®¿é—®æ—¥å¿—å¯¹äºé‚£äº›è°ƒç”¨é¢‘ç¹ã€è¿è¡Œç¼“æ…¢æˆ–å ç”¨æ‰§è¡Œç¯å¢ƒèµ„æºè¾ƒå¤šçš„å±æ€§æˆ–æ¥å£ï¼Œå¼€å‘è€…ä¼šå¸Œæœ›è®°å½•å®ƒä»¬çš„ä½¿ç”¨æƒ…å†µæˆ–æ€§èƒ½è¡¨ç°ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ Proxy å……å½“ä¸­é—´ä»¶çš„è§’è‰²ï¼Œè½»è€Œæ˜“ä¸¾å®ç°æ—¥å¿—åŠŸèƒ½ï¼š 123456789101112131415161718192021222324252627282930let api = &#123; _apiKey: \"123abc456def\", getUsers: function() &#123; /* ... */ &#125;, getUser: function(userId) &#123; /* ... */ &#125;, setUser: function(userId, config) &#123; /* ... */ &#125;&#125;;function logMethodAsync(timestamp, method) &#123; setTimeout(function() &#123; console.log(`$&#123;timestamp&#125; - Logging $&#123;method&#125; request asynchronously.`); &#125;, 0);&#125;api = new Proxy(api, &#123; get: function(target, key, proxy) &#123; var value = target[key]; return function(...arguments) &#123; logMethodAsync(new Date(), key); return Reflect.apply(value, target, arguments); &#125;; &#125;&#125;);api.getUsers(); 4. é¢„è­¦å’Œæ‹¦æˆªå‡è®¾ä½ ä¸æƒ³è®©å…¶ä»–å¼€å‘è€…åˆ é™¤ noDelete å±æ€§ï¼Œè¿˜æƒ³è®©è°ƒç”¨ oldMethod çš„å¼€å‘è€…äº†è§£åˆ°è¿™ä¸ªæ–¹æ³•å·²ç»è¢«åºŸå¼ƒäº†ï¼Œæˆ–è€…å‘Šè¯‰å¼€å‘è€…ä¸è¦ä¿®æ”¹ doNotChange å±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ Proxy æ¥å®ç°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243let dataStore = &#123; noDelete: 1235, oldMethod: function() &#123; /*...*/ &#125;, doNotChange: \"tried and true\"&#125;;const NODELETE = [\"noDelete\"];const NOCHANGE = [\"doNotChange\"];const DEPRECATED = [\"oldMethod\"];dataStore = new Proxy(dataStore, &#123; set(target, key, value, proxy) &#123; if (NOCHANGE.includes(key)) &#123; throw Error(`Error! $&#123;key&#125; is immutable.`); &#125; return Reflect.set(target, key, value, proxy); &#125;, deleteProperty(target, key) &#123; if (NODELETE.includes(key)) &#123; throw Error(`Error! $&#123;key&#125; cannot be deleted.`); &#125; return Reflect.deleteProperty(target, key); &#125;, get(target, key, proxy) &#123; if (DEPRECATED.includes(key)) &#123; console.warn(`Warning! $&#123;key&#125; is deprecated.`); &#125; var val = target[key]; return typeof val === \"function\" ? function(...args) &#123; Reflect.apply(target[key], target, args); &#125; : val; &#125;&#125;);// these will throw errors or log warnings, respectivelydataStore.doNotChange = \"foo\";delete dataStore.noDelete;dataStore.oldMethod(); 5. è¿‡æ»¤æ“ä½œæŸäº›æ“ä½œä¼šéå¸¸å ç”¨èµ„æºï¼Œæ¯”å¦‚ä¼ è¾“å¤§æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæ–‡ä»¶å·²ç»åœ¨åˆ†å—å‘é€äº†ï¼Œå°±ä¸éœ€è¦åœ¨å¯¹æ–°çš„è¯·æ±‚ä½œå‡ºç›¸åº”ï¼ˆéç»å¯¹ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ Proxy å¯¹å½“è¯·æ±‚è¿›è¡Œç‰¹å¾æ£€æµ‹ï¼Œå¹¶æ ¹æ®ç‰¹å¾è¿‡æ»¤å‡ºå“ªäº›æ˜¯ä¸éœ€è¦å“åº”çš„ï¼Œå“ªäº›æ˜¯éœ€è¦å“åº”çš„ã€‚ä¸‹é¢çš„ä»£ç ç®€å•æ¼”ç¤ºäº†è¿‡æ»¤ç‰¹å¾çš„æ–¹å¼ï¼Œå¹¶ä¸æ˜¯å®Œæ•´ä»£ç ï¼Œç›¸ä¿¡å¤§å®¶ä¼šç†è§£å…¶ä¸­çš„å¦™å¤„ï¼š 123456789101112131415161718192021222324let obj = &#123; getGiantFile: function(fileId) &#123; /*...*/ &#125;&#125;;obj = new Proxy(obj, &#123; get(target, key, proxy) &#123; return function(...args) &#123; const id = args[0]; let isEnroute = checkEnroute(id); let isDownloading = checkStatus(id); let cached = getCached(id); if (isEnroute || isDownloading) &#123; return false; &#125; if (cached) &#123; return cached; &#125; return Reflect.apply(target[key], target, args); &#125;; &#125;&#125;); 6. ä¸­æ–­ä»£ç†Proxy æ”¯æŒéšæ—¶å–æ¶ˆå¯¹ target çš„ä»£ç†ï¼Œè¿™ä¸€æ“ä½œå¸¸ç”¨äºå®Œå…¨å°é—­å¯¹æ•°æ®æˆ–æ¥å£çš„è®¿é—®ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Proxy.revocable æ–¹æ³•åˆ›å»ºäº†å¯æ’¤é”€ä»£ç†çš„ä»£ç†å¯¹è±¡ï¼š 1234567891011let sensitiveData = &#123; username: \"devbryce\" &#125;;const &#123; sensitiveData, revokeAccess &#125; = Proxy.revocable(sensitiveData, handler);function handleSuspectedHack() &#123; revokeAccess();&#125;// logs 'devbryce'console.log(sensitiveData.username);handleSuspectedHack();// TypeError: Revokedconsole.log(sensitiveData.username); DecoratorES7 ä¸­å®ç°çš„ Decoratorï¼Œç›¸å½“äºè®¾è®¡æ¨¡å¼ä¸­çš„è£…é¥°å™¨æ¨¡å¼ã€‚å¦‚æœç®€å•åœ°åŒºåˆ† Proxy å’Œ Decorator çš„ä½¿ç”¨åœºæ™¯ï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºï¼šProxy çš„æ ¸å¿ƒä½œç”¨æ˜¯æ§åˆ¶å¤–ç•Œå¯¹è¢«ä»£ç†è€…å†…éƒ¨çš„è®¿é—®ï¼ŒDecorator çš„æ ¸å¿ƒä½œç”¨æ˜¯å¢å¼ºè¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚åªè¦åœ¨å®ƒä»¬æ ¸å¿ƒçš„ä½¿ç”¨åœºæ™¯ä¸Šåšå¥½åŒºåˆ«ï¼Œé‚£ä¹ˆåƒæ˜¯è®¿é—®æ—¥å¿—è¿™æ ·çš„åŠŸèƒ½ï¼Œè™½ç„¶æœ¬æ–‡ä½¿ç”¨äº† Proxy å®ç°ï¼Œä½†ä¹Ÿå¯ä»¥ä½¿ç”¨ Decorator å®ç°ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®é¡¹ç›®çš„éœ€æ±‚ã€å›¢é˜Ÿçš„è§„èŒƒã€è‡ªå·±çš„åå¥½è‡ªç”±é€‰æ‹©ã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"æµè§ˆå™¨ç¼“å­˜æœºåˆ¶","slug":"æµè§ˆå™¨ç¼“å­˜æœºåˆ¶","date":"2018-10-20T07:23:45.000Z","updated":"2019-11-10T14:37:39.039Z","comments":true,"path":"2018/10/20/æµè§ˆå™¨ç¼“å­˜æœºåˆ¶/","link":"","permalink":"http://yoursite.com/2018/10/20/æµè§ˆå™¨ç¼“å­˜æœºåˆ¶/","excerpt":"æµè§ˆå™¨ç¼“å­˜æœºåˆ¶æ¦‚å¿µæµè§ˆå™¨ç¼“å­˜ï¼ˆBrowser Cachingï¼‰æ˜¯æµè§ˆå™¨ç«¯ä¿å­˜æ•°æ®ç”¨äºå¿«é€Ÿè¯»å–æˆ–é¿å…é‡å¤èµ„æºè¯·æ±‚çš„ä¼˜åŒ–æœºåˆ¶ï¼Œæœ‰æ•ˆçš„ç¼“å­˜ä½¿ç”¨å¯ä»¥é¿å…é‡å¤çš„ç½‘ç»œè¯·æ±‚å’Œæµè§ˆå™¨å¿«é€Ÿåœ°è¯»å–æœ¬åœ°æ•°æ®ï¼Œæ•´ä½“ä¸ŠåŠ é€Ÿç½‘é¡µå±•ç¤ºç»™ç”¨æˆ·ã€‚ï¼ˆæµè§ˆå™¨ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼‰","text":"æµè§ˆå™¨ç¼“å­˜æœºåˆ¶æ¦‚å¿µæµè§ˆå™¨ç¼“å­˜ï¼ˆBrowser Cachingï¼‰æ˜¯æµè§ˆå™¨ç«¯ä¿å­˜æ•°æ®ç”¨äºå¿«é€Ÿè¯»å–æˆ–é¿å…é‡å¤èµ„æºè¯·æ±‚çš„ä¼˜åŒ–æœºåˆ¶ï¼Œæœ‰æ•ˆçš„ç¼“å­˜ä½¿ç”¨å¯ä»¥é¿å…é‡å¤çš„ç½‘ç»œè¯·æ±‚å’Œæµè§ˆå™¨å¿«é€Ÿåœ°è¯»å–æœ¬åœ°æ•°æ®ï¼Œæ•´ä½“ä¸ŠåŠ é€Ÿç½‘é¡µå±•ç¤ºç»™ç”¨æˆ·ã€‚ï¼ˆæµè§ˆå™¨ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼‰ æµè§ˆå™¨ç¼“å­˜æœºåˆ¶è¦ç´ ï¼š æµè§ˆå™¨æ¯æ¬¡å‘èµ·è¯·æ±‚ï¼Œéƒ½ä¼šå…ˆåœ¨æµè§ˆå™¨ç¼“å­˜ä¸­æŸ¥æ‰¾è¯¥è¯·æ±‚çš„ç»“æœä»¥åŠç¼“å­˜æ ‡è¯†ï¼› æµè§ˆå™¨æ¯æ¬¡æ‹¿åˆ°è¿”å›çš„è¯·æ±‚ç»“æœéƒ½ä¼šå°†è¯¥ç»“æœå’Œç¼“å­˜æ ‡è¯†å­˜å…¥æµè§ˆå™¨ç¼“å­˜ä¸­ã€‚ ä¹ç§æµè§ˆå™¨ç¼“å­˜ï¼šhttp ç¼“å­˜http ç¼“å­˜æ˜¯åŸºäº HTTP åè®®çš„æµè§ˆå™¨æ–‡ä»¶çº§ç¼“å­˜æœºåˆ¶ã€‚å³é’ˆå¯¹æ–‡ä»¶çš„é‡å¤è¯·æ±‚æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å¯ä»¥æ ¹æ®åè®®å¤´åˆ¤æ–­ä»æœåŠ¡å™¨ç«¯è¯·æ±‚æ–‡ä»¶è¿˜æ˜¯ä»æœ¬åœ°è¯»å–æ–‡ä»¶ã€‚ä¸»è¦æ˜¯é’ˆå¯¹é‡å¤çš„ http è¯·æ±‚ï¼Œåœ¨æœ‰ç¼“å­˜çš„æƒ…å†µä¸‹åˆ¤æ–­è¿‡ç¨‹ä¸»è¦åˆ† 3 æ­¥ï¼šåˆ¤æ–­ expiresï¼Œå¦‚æœæœªè¿‡æœŸï¼Œç›´æ¥è¯»å– http ç¼“å­˜æ–‡ä»¶ï¼Œä¸å‘ http è¯·æ±‚ï¼Œå¦åˆ™è¿›å…¥ä¸‹ä¸€æ­¥ï¼›åˆ¤æ–­æ˜¯å¦å«æœ‰ etagï¼Œæœ‰åˆ™å¸¦ä¸Š if-none-match å‘é€è¯·æ±‚ï¼Œæœªä¿®æ”¹è¿”å› 304ï¼Œä¿®æ”¹è¿”å› 200ï¼Œå¦åˆ™è¿›å…¥ä¸‹ä¸€æ­¥ï¼›åˆ¤æ–­æ˜¯å¦å«æœ‰ last-modifiedï¼Œæœ‰åˆ™å¸¦ä¸Š if-modified-since å‘é€è¯·æ±‚ï¼Œæ— æ•ˆè¿”å› 200ï¼Œæœ‰æ•ˆè¿”å› 304ï¼Œå¦åˆ™ç›´æ¥å‘æœåŠ¡å™¨è¯·æ±‚ websqlå®ƒæ˜¯å°†æ•°æ®ä»¥æ•°æ®åº“çš„å½¢å¼å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ ¹æ®éœ€æ±‚å»è¯»å–ï¼›è·Ÿ Storage çš„åŒºåˆ«æ˜¯ï¼š Storage å’Œ Cookie éƒ½æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜åœ¨çš„ã€‚ indexDBIndexedDB æ˜¯ä¸€ä¸ªä¸ºäº†èƒ½å¤Ÿåœ¨å®¢æˆ·ç«¯å­˜å‚¨å¯è§‚æ•°é‡çš„ç»“æ„åŒ–æ•°æ®ï¼Œå¹¶ä¸”åœ¨è¿™äº›æ•°æ®ä¸Šä½¿ç”¨ç´¢å¼•è¿›è¡Œé«˜æ€§èƒ½æ£€ç´¢çš„ APIã€‚åŒæ­¥ API æœ¬æ¥æ˜¯è¦ç”¨äºä»…ä¾› Web Workers å†…éƒ¨ä½¿ç”¨ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è¢«ä»»ä½•æµè§ˆå™¨æ‰€å®ç°ã€‚å¼‚æ­¥ API åœ¨ Web Workers å†…éƒ¨å’Œå¤–éƒ¨éƒ½å¯ä»¥ä½¿ç”¨ï¼Œå¦å¤–æµè§ˆå™¨å¯èƒ½å¯¹ indexDB æœ‰ 50M å¤§å°çš„é™åˆ¶ï¼Œä¸€èˆ¬ç”¨æˆ·ä¿å­˜å¤§é‡ç”¨æˆ·æ•°æ®å¹¶è¦æ±‚æ•°æ®ä¹‹é—´æœ‰æœç´¢éœ€è¦çš„åœºæ™¯ã€‚ CookieæŒ‡ä¸€èˆ¬ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½ã€è¿›è¡Œ session è·Ÿè¸ªè€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ã€‚cookie ä¸€èˆ¬é€šè¿‡ http è¯·æ±‚ä¸­åœ¨å¤´éƒ¨ä¸€èµ·å‘é€åˆ°æœåŠ¡å™¨ç«¯ã€‚ä¸€æ¡ cookie è®°å½•ä¸»è¦ç”±é”®ã€å€¼ã€åŸŸã€è¿‡æœŸæ—¶é—´ã€å¤§å°ç»„æˆï¼Œä¸€èˆ¬ç”¨äºä¿å­˜ç”¨æˆ·çš„è®¤è¯ä¿¡æ¯ã€‚cookie æœ€å¤§é•¿åº¦å’ŒåŸŸåä¸ªæ•°ç”±ä¸åŒæµè§ˆå™¨å†³å®šã€‚ä¸åŒåŸŸåä¹‹é—´çš„ cookie ä¿¡æ¯æ˜¯ç‹¬ç«‹çš„ï¼Œå¦‚æœéœ€è¦è®¾ç½®å…±äº«å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è®¾ç½® cookie çš„ path å’Œ domain æ¥å®ç°å…±äº«ã€‚æµè§ˆå™¨ç«¯ä¹Ÿå¯ä»¥é€šè¿‡ document.cookie æ¥è·å– cookieï¼Œå¹¶é€šè¿‡ js æµè§ˆå™¨ç«¯ä¹Ÿå¯ä»¥æ–¹ä¾¿åœ°è¯»å–/è®¾ç½® cookie çš„å€¼ã€‚ï¼ˆCookie åªèƒ½å­˜å‚¨å°‘é‡çš„æ•°æ®ï¼Œæ¯ä¸ª Cookie çš„å¤§å°ä¸è¶…è¿‡ 4KBã€‚RFC æ ‡å‡†ä¸å…è®¸æµè§ˆå™¨ä¿å­˜è¶…è¿‡ 300 ä¸ª Cookieï¼Œä¸ºæ¯ä¸ª web æœåŠ¡å™¨ä¿å­˜çš„ Cookie æ•°ä¸è¶…è¿‡ 20 ä¸ªã€‚JavaScript ä¸­ä½¿ç”¨ Cookie ä¸ä¼šé‡‡ç”¨ä»»ä½•åŠ å¯†æœºåˆ¶ï¼Œå› æ­¤å®ƒä»¬æ˜¯ä¸å®‰å…¨çš„ã€‚ï¼‰ LocalstoragelocalStorage æ˜¯ html5 çš„ä¸€ç§æ–°çš„æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆï¼Œç›®å‰ç”¨çš„æ¯”è¾ƒå¤šï¼Œä¸€èˆ¬ç”¨æ¥å­˜å‚¨ ajax è¿”å›çš„æ•°æ®ï¼ŒåŠ å¿«ä¸‹æ¬¡é¡µé¢æ‰“å¼€æ—¶çš„æ¸²æŸ“é€Ÿåº¦ã€‚ SessionstoragesessionStorage å’Œ localstorage ç±»ä¼¼ï¼Œä½†æ˜¯æµè§ˆå™¨å…³é—­åˆ™ä¼šå…¨éƒ¨åˆ é™¤ï¼Œapi å’Œ localstorage ç›¸åŒï¼Œå®é™…é¡¹ç›®ä¸­ä½¿ç”¨è¾ƒå°‘ã€‚ application cacheapplication cahce æ˜¯å°†å¤§éƒ¨åˆ†å›¾ç‰‡èµ„æºã€jsã€css ç­‰é™æ€èµ„æºæ”¾åœ¨ manifest æ–‡ä»¶é…ç½®ä¸­ã€‚å½“é¡µé¢æ‰“å¼€æ—¶é€šè¿‡ manifest æ–‡ä»¶æ¥è¯»å–æœ¬åœ°æ–‡ä»¶æˆ–æ˜¯è¯·æ±‚æœåŠ¡å™¨æ–‡ä»¶ã€‚åœ¨çº¿çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å‘ç° html å¤´éƒ¨æœ‰ manifest å±æ€§ï¼Œå®ƒä¼šè¯·æ±‚ manifest æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—® appï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šæ ¹æ® manifest æ–‡ä»¶çš„å†…å®¹ä¸‹è½½ç›¸åº”çš„èµ„æºå¹¶ä¸”è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚å¦‚æœå·²ç»è®¿é—®è¿‡ app å¹¶ä¸”èµ„æºå·²ç»ç¦»çº¿å­˜å‚¨äº†ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šä½¿ç”¨ç¦»çº¿çš„èµ„æºåŠ è½½é¡µé¢ï¼Œç„¶åæµè§ˆå™¨ä¼šå¯¹æ¯”æ–°çš„ manifest æ–‡ä»¶ä¸æ—§çš„ manifest æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸åšä»»ä½•æ“ä½œï¼Œå¦‚æœæ–‡ä»¶æ”¹å˜äº†ï¼Œé‚£ä¹ˆå°±ä¼šé‡æ–°ä¸‹è½½æ–‡ä»¶ä¸­çš„èµ„æºå¹¶è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚å¹¶åœ¨ä¸‹ä¸€æ¬¡ç”Ÿæ•ˆã€‚ç¦»çº¿çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å°±ç›´æ¥ä½¿ç”¨ç¦»çº¿å­˜å‚¨çš„èµ„æºã€‚ cacheStorageCacheStorage æ˜¯åœ¨ ServiceWorker çš„è§„èŒƒä¸­å®šä¹‰çš„ã€‚CacheStorage å¯ä»¥ä¿å­˜æ¯ä¸ª serverWorker ç”³æ˜çš„ cache å¯¹è±¡ï¼ŒcacheStorage æœ‰ openã€matchã€hasã€deleteã€keys äº”ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œå¯ä»¥å¯¹ cache å¯¹è±¡çš„ä¸åŒåŒ¹é…è¿›è¡Œä¸åŒçš„å“åº”ã€‚ flash ç¼“å­˜è¿™ç§æ–¹å¼åŸºæœ¬ä¸ç”¨ï¼Œè¿™ä¸€æ–¹æ³•ä¸»è¦åŸºäº flash æœ‰è¯»å†™æµè§ˆå™¨ç«¯æœ¬åœ°ç›®å½•çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‘ js æä¾›è°ƒç”¨çš„ apiï¼Œåˆ™é¡µé¢å¯ä»¥é€šè¿‡ js è°ƒç”¨ flash å»è¯»å†™ç‰¹å®šçš„ç£ç›˜ç›®å½•ï¼Œè¾¾åˆ°æœ¬åœ°æ•°æ®ç¼“å­˜çš„ç›®çš„ã€‚ cookie èƒŒæ™¯ï¼šæ—©æœŸ Web å¼€å‘é¢ä¸´çš„æœ€å¤§é—®é¢˜ä¹‹ä¸€æ˜¯å¦‚ä½•ç®¡ç†çŠ¶æ€ã€‚ç®€è¨€ä¹‹ï¼ŒæœåŠ¡å™¨ç«¯æ²¡æœ‰åŠæ³•çŸ¥é“ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªäºåŒä¸€ä¸ªæµè§ˆå™¨ã€‚é‚£æ—¶çš„åŠæ³•æ˜¯åœ¨è¯·æ±‚çš„é¡µé¢ä¸­æ’å…¥ä¸€ä¸ª tokenï¼Œå¹¶ä¸”åœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚ä¸­å°†è¿™ä¸ª token è¿”å›ï¼ˆè‡³æœåŠ¡å™¨ï¼‰ã€‚è¿™å°±éœ€è¦åœ¨ form ä¸­æ’å…¥ä¸€ä¸ªåŒ…å« token çš„éšè—è¡¨å•åŸŸï¼Œæˆ–ç€åœ¨ URL çš„ qurey å­—ç¬¦ä¸²ä¸­ä¼ é€’è¯¥ tokenã€‚è¿™ä¸¤ç§åŠæ³•éƒ½å¼ºè°ƒæ‰‹å·¥æ“ä½œå¹¶ä¸”ææ˜“å‡ºé”™ã€‚ å†…å®¹ï¼šé”®ã€å€¼ã€åŸŸã€è¿‡æœŸæ—¶é—´ã€å¤§å° æ˜¯å¦ç”Ÿæ•ˆï¼šexpires æŒ‡å®šäº† cookie ä½•æ—¶ä¸ä¼šå†è¢«å‘é€åˆ°æœåŠ¡å™¨ç«¯çš„ï¼Œå› æ­¤è¯¥ cookie å¯èƒ½ä¼šè¢«æµè§ˆå™¨åˆ æ‰ã€‚ï¼ˆè¿‡æœŸæ—¶é—´ï¼‰åœ¨æ²¡æœ‰ expires é€‰é¡¹æ—¶ï¼Œcookie çš„å¯¿å‘½ä»…é™äºå•ä¸€çš„ä¼šè¯ä¸­ã€‚æµè§ˆå™¨çš„å…³é—­æ„å‘³è¿™ä¸€æ¬¡ä¼šè¯çš„ç»“æŸï¼Œæ‰€ä»¥ä¼šè¯ cookie åªå­˜åœ¨äºæµè§ˆå™¨ä¿æŒæ‰“å¼€çš„çŠ¶æ€ä¹‹ä¸‹ã€‚å¦‚æœ expires é€‰é¡¹è®¾ç½®äº†ä¸€ä¸ªè¿‡å»çš„æ—¶é—´ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ª cookie ä¼šè¢«ç«‹å³åˆ é™¤ã€‚ å­˜åœ¨å“ªé‡Œï¼šcookie çš„å€¼è¢«å­˜å‚¨åœ¨åä¸º Cookie çš„ HTTP æ¶ˆæ¯å¤´ä¸­ï¼Œå¹¶ä¸”åªåŒ…å«äº† cookie çš„å€¼ï¼Œå…¶å®ƒçš„é€‰é¡¹å…¨éƒ¨è¢«å»é™¤ã€‚ å­˜æ”¾å½¢å¼ï¼šCookies æ˜¯çº¯æ–‡æœ¬å½¢å¼ã€‚å‡ ä¹æ‰€æœ‰çš„å®ç°æ–¹å¼éƒ½å¯¹ cookie çš„å€¼è¿›è¡Œäº†ä¸€äº›åˆ—çš„ URL ç¼–ç ï¼ˆä½†ä¸æ˜¯å¿…é¡»ï¼‰ã€‚åŸå§‹çš„æ–‡æ¡£ä¸­æŒ‡ç¤ºä»…æœ‰ä¸‰ç§ç±»å‹çš„å­—ç¬¦å¿…é¡»è¿›è¡Œç¼–ç ï¼šåˆ†å·ï¼Œé€—å·ï¼Œå’Œç©ºæ ¼ã€‚ ä¸åŒåŸŸåä¹‹é—´çš„ cookie ä¿¡æ¯æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ä¼šå†²çªã€‚æµè§ˆå™¨ä¼šå¯¹ domain çš„å€¼ä¸è¯·æ±‚æ‰€è¦å‘é€è‡³çš„åŸŸåï¼Œåšä¸€ä¸ªå°¾éƒ¨æ¯”è¾ƒï¼ˆå³ä»å­—ç¬¦ä¸²çš„å°¾éƒ¨å¼€å§‹æ¯”è¾ƒï¼‰ï¼Œå¹¶ä¸”åœ¨åŒ¹é…åå‘é€ä¸€ä¸ª Cookie æ¶ˆæ¯å¤´ã€‚domain è®¾ç½®çš„å€¼å¿…é¡»æ˜¯å‘é€ Set-Cookie æ¶ˆæ¯å¤´çš„åŸŸåã€‚ä¸ domain é€‰é¡¹ç›¸åŒçš„æ˜¯ï¼Œpath æŒ‡æ˜äº†åœ¨å‘ Cookie æ¶ˆæ¯å¤´ä¹‹å‰å¿…é¡»åœ¨è¯·æ±‚èµ„æºä¸­å­˜åœ¨ä¸€ä¸ª URL è·¯å¾„ã€‚è¿™ä¸ªæ¯”è¾ƒæ˜¯é€šè¿‡å°† path å±æ€§å€¼ä¸è¯·æ±‚çš„ URL ä»å¤´å¼€å§‹é€å­—ç¬¦ä¸²æ¯”è¾ƒå®Œæˆçš„ã€‚å¦‚æœå­—ç¬¦åŒ¹é…ï¼Œåˆ™å‘é€ Cookie æ¶ˆæ¯å¤´ã€‚åªæœ‰åœ¨ domain é€‰é¡¹æ ¸å®å®Œæ¯•ä¹‹åæ‰ä¼šå¯¹ path å±æ€§è¿›è¡Œæ¯”è¾ƒã€‚path å±æ€§çš„é»˜è®¤å€¼æ˜¯å‘é€ Set-Cookie æ¶ˆæ¯å¤´æ‰€å¯¹åº”çš„ URL ä¸­çš„ path éƒ¨åˆ†ã€‚path å€¼è¶Šè¯¦ç»†åˆ™ cookie è¶Šé å‰ã€‚domain-path è¶Šè¯¦ç»†åˆ™ cookie å­—ç¬¦ä¸²è¶Šé å‰ã€‚å¯ä»¥é€šè¿‡è®¾ç½® Cookie çš„ path å±æ€§æ¥ä¿®æ”¹ Cookie çš„ä½œç”¨åŸŸï¼Œå¦‚æœæŠŠ path è®¾ä¸ºâ€œ/â€ï¼Œå°±ç­‰åŒäºè®© Cookie æ‹¥æœ‰äº† localStorage çš„ä½œç”¨åŸŸï¼Œå³æ•´ä¸ªæ–‡æ¡£æºã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒCookie å¯¹äºåˆ›å»ºå®ƒçš„é¡µé¢ï¼Œä»¥åŠä¸è¯¥é¡µé¢åŒç›®å½•æˆ–å­ç›®å½•ä¸‹çš„å…¶ä»– web é¡µé¢å¯è§ã€‚åœ¨ a.example.com ä¸‹çš„ä¸€ä¸ªé¡µé¢è®¾ç½®äº† Cookieï¼Œå°†å…¶ path è®¾ä¸ºâ€œ/â€ï¼Œå¹¶å°† domain è®¾ä¸ºâ€œ.example.comâ€ï¼Œè¿™æ ·è¯¥ Cookie å°±å¯¹ example.com åŸŸä¸‹çš„æ‰€æœ‰é¡µé¢å¯è§ã€‚ åˆ›å»ºå’Œå­˜å‚¨ Cookieï¼šå¯¹ Cookie çš„æ‰€æœ‰æ“ä½œéƒ½è¦é€šè¿‡è¯»å†™ document å¯¹è±¡çš„ Cookie å±æ€§æ¥å®Œæˆã€‚Cookie çš„å€¼éƒ½æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ã€‚åŒæ ·çš„ï¼Œå¦‚æœè¦è®¾ç½® pathã€domain ç­‰å±æ€§ï¼Œåªé¡»ä»¥å¦‚ä¸‹å½¢å¼è¿½åŠ åˆ° Cookie å€¼çš„åé¢: ;path=path 1234567891011//åˆ›å»ºä¸€ä¸ªåå­—Cookieï¼ŒåŒæ—¶è®¾ç½®å®ƒçš„è¿‡æœŸæ—¶é—´function setCookie(c_name, value, expiredays) &#123; var exdate = new Date(); exdate.setDate(exdate.getDate() + expiredays); //encodeURIComponent() å¯¹ URI è¿›è¡Œç¼–ç  document.cookie = c_name + \"=\" + encodeURIComponent(value) + (expiredays == null ? \"\" : \";expires=\" + exdate.toGMTString());&#125; è¯»å– Cookieï¼šä½¿ç”¨ document.cookie å¯ä»¥è·å–åˆ° Cookie çš„å€¼ï¼Œä¸è¿‡è¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸ºäº†æ›´å¥½åœ°æŸ¥çœ‹ Cookie çš„å€¼ï¼Œå¾€å¾€ä¼šé‡‡ç”¨ split()æ–¹æ³•å°† Cookie ä¸­çš„åå€¼å¯¹åˆ†ç¦»å‡ºæ¥ã€‚ 12345678910111213141516171819202122function getCookie() &#123; // åˆå§‹åŒ–è¦è¿”å›çš„å¯¹è±¡ var cookie = &#123;&#125;; var all = document.cookie; if (all === null) &#123; return cookie; &#125; //åˆ†ç¦»å‡ºCookieçš„å„ä¸ªå±æ€§ var list = all.split(\";\"); for (var i = 0; i &lt; list.length; i++) &#123; // æŸ¥è¯¢å‡ºç­‰å·æ‰€åœ¨çš„ä½ç½® var p = list[i].indexOf(\"=\"); // åˆ†ç¦»å‡ºåå­—å’Œå€¼ var name = list[i].substring(0, p); var value = list[i].substring(p + 1); //å¯¹å€¼è¿›è¡Œè§£ç  value = decodeURIComponent(value); // å°†åå€¼å¯¹å­˜å‚¨åˆ°å¯¹è±¡ä¸­ cookie[name] = value; &#125; return cookie;&#125; Localstorage å’Œ sessionstorageLocalstorage å’Œ sessionstorage æ˜¯åšä»€ä¹ˆçš„ï¼Ÿlocalstorage æ€ä¹ˆæ¸…é™¤å®ƒï¼Ÿåœ¨ä»£ç å±‚é¢æ€ä¹ˆæ¸…é™¤ï¼Ÿsetitem çš„æ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿgetitem çš„å€¼æ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿ æ€ä¹ˆæ¸…é™¤ 12localStorage.removeItem(key); //åˆ é™¤è¯¥åŸŸåä¸‹å•æ¡è®°å½•localStorage.clear(); //åˆ é™¤è¯¥åŸŸåä¸‹æ‰€æœ‰è®°å½• å­˜å‚¨æ ¼å¼ï¼šæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥æ–‡æœ¬æ ¼å¼ä¿å­˜ã€‚å…¶ä¸­ value éœ€ä¸ºå¯è½¬åŒ–ä¸ºå­—ç¬¦ä¸²çš„å¯¹è±¡ã€‚localStorage å¯¹è±¡çš„é”®å’Œå€¼åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå‡è®¾æˆ‘ä»¬è¦ä¿å­˜ä¸€ä¸ªå¯¹è±¡åˆ° localStorage ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ‹¼æ¥çš„æ–¹å¼ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å€ŸåŠ© JSON ç±»ï¼Œå°†å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²ä¿å­˜ï¼Œç„¶ååœ¨å–å‡ºæ¥çš„æ—¶å€™å°† json å­—ç¬¦ä¸²è½¬æ¢æˆçœŸæ­£å¯ç”¨çš„ json å¯¹è±¡æ ¼å¼ æ•°æ®å…±äº«ï¼šä¸åŒæµè§ˆå™¨æ— æ³•å…±äº« localStorage æˆ– sessionStorage ä¸­çš„ä¿¡æ¯ã€‚ç›¸åŒæµè§ˆå™¨çš„ä¸åŒé¡µé¢é—´å¯ä»¥å…±äº«ç›¸åŒçš„ localStorageï¼ˆé¡µé¢å±äºç›¸åŒåŸŸåå’Œç«¯å£ï¼‰ï¼Œä½†æ˜¯ä¸åŒé¡µé¢æˆ–æ ‡ç­¾é¡µé—´æ— æ³•å…±äº« sessionStorage çš„ä¿¡æ¯ã€‚","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/categories/æµè§ˆå™¨/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"},{"name":"ç¼“å­˜","slug":"ç¼“å­˜","permalink":"http://yoursite.com/tags/ç¼“å­˜/"}]},{"title":"ç®­å¤´å‡½æ•°","slug":"ç®­å¤´å‡½æ•°","date":"2018-10-14T07:55:35.000Z","updated":"2019-11-10T14:37:39.040Z","comments":true,"path":"2018/10/14/ç®­å¤´å‡½æ•°/","link":"","permalink":"http://yoursite.com/2018/10/14/ç®­å¤´å‡½æ•°/","excerpt":"åŸºæœ¬ç”¨æ³•ES6 å…è®¸ä½¿ç”¨â€œç®­å¤´â€ï¼ˆ=&gt;ï¼‰å®šä¹‰å‡½æ•°ã€‚","text":"åŸºæœ¬ç”¨æ³•ES6 å…è®¸ä½¿ç”¨â€œç®­å¤´â€ï¼ˆ=&gt;ï¼‰å®šä¹‰å‡½æ•°ã€‚ 123456var f = v =&gt; v;// ç­‰åŒäºvar f = function(v) &#123; return v;&#125;; å‚æ•°éƒ¨åˆ†å¦‚æœç®­å¤´å‡½æ•°ä¸éœ€è¦å‚æ•°æˆ–éœ€è¦å¤šä¸ªå‚æ•°ï¼Œå°±ä½¿ç”¨ä¸€ä¸ªåœ†æ‹¬å·ä»£è¡¨å‚æ•°éƒ¨åˆ†ã€‚ 1234567891011var f = () =&gt; 5;// ç­‰åŒäºvar f = function() &#123; return 5;&#125;;var sum = (num1, num2) =&gt; num1 + num2;// ç­‰åŒäºvar sum = function(num1, num2) &#123; return num1 + num2;&#125;; å¦‚æœç®­å¤´å‡½æ•°çš„ä»£ç å—éƒ¨åˆ†å¤šäºä¸€æ¡è¯­å¥ï¼Œå°±è¦ä½¿ç”¨å¤§æ‹¬å·å°†å®ƒä»¬æ‹¬èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨ return è¯­å¥è¿”å›ã€‚ 123var sum = (num1, num2) =&gt; &#123; return num1 + num2;&#125;; è¿”å›å¯¹è±¡ç”±äºå¤§æ‹¬å·è¢«è§£é‡Šä¸ºä»£ç å—ï¼Œæ‰€ä»¥å¦‚æœç®­å¤´å‡½æ•°ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»åœ¨å¯¹è±¡å¤–é¢åŠ ä¸Šæ‹¬å·ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ 12345// æŠ¥é”™let getTempItem = id =&gt; &#123; id: id, name: \"Temp\" &#125;;// ä¸æŠ¥é”™let getTempItem = id =&gt; (&#123; id: id, name: \"Temp\" &#125;); ä¸‹é¢æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œè™½ç„¶å¯ä»¥è¿è¡Œï¼Œä½†ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœã€‚ 1234let foo = () =&gt; &#123; a: 1;&#125;;foo(); // undefined ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸå§‹æ„å›¾æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡{ a: 1 }ï¼Œä½†æ˜¯ç”±äºå¼•æ“è®¤ä¸ºå¤§æ‹¬å·æ˜¯ä»£ç å—ï¼Œæ‰€ä»¥æ‰§è¡Œäº†ä¸€è¡Œè¯­å¥ a: 1ã€‚è¿™æ—¶ï¼Œa å¯ä»¥è¢«è§£é‡Šä¸ºè¯­å¥çš„æ ‡ç­¾ï¼Œå› æ­¤å®é™…æ‰§è¡Œçš„è¯­å¥æ˜¯ 1;ï¼Œç„¶åå‡½æ•°å°±ç»“æŸäº†ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚ç®­å¤´å‡½æ•°å¯ä»¥ä¸å˜é‡è§£æ„ç»“åˆä½¿ç”¨ã€‚ 123456const full = (&#123; first, last &#125;) =&gt; first + \" \" + last;// ç­‰åŒäºfunction full(person) &#123; return person.first + \" \" + person.last;&#125; ç®€åŒ–å›è°ƒå‡½æ•°ç®­å¤´å‡½æ•°çš„ä¸€ä¸ªç”¨å¤„æ˜¯ç®€åŒ–å›è°ƒå‡½æ•°ã€‚ 1234567// æ­£å¸¸å‡½æ•°å†™æ³•[1, 2, 3].map(function(x) &#123; return x * x;&#125;);// ç®­å¤´å‡½æ•°å†™æ³•[1, 2, 3].map(x =&gt; x * x); rest å‚æ•°ä¸ç®­å¤´å‡½æ•°ç»“åˆ123456789const numbers = (...nums) =&gt; nums;numbers(1, 2, 3, 4, 5);// [1,2,3,4,5]const headAndTail = (head, ...tail) =&gt; [head, tail];headAndTail(1, 2, 3, 4, 5);// [1,[2,3,4,5]] ä½¿ç”¨æ³¨æ„ç‚¹ç®­å¤´å‡½æ•°æœ‰å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚ å‡½æ•°ä½“å†…çš„ this å¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚ ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨ new å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ ä¸å¯ä»¥ä½¿ç”¨ arguments å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ rest å‚æ•°ä»£æ›¿ã€‚ ä¸å¯ä»¥ä½¿ç”¨ yield å‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚ä¸Šé¢å››ç‚¹ä¸­ï¼Œç¬¬ä¸€ç‚¹å°¤å…¶å€¼å¾—æ³¨æ„ã€‚this å¯¹è±¡çš„æŒ‡å‘æ˜¯å¯å˜çš„ï¼Œä½†æ˜¯åœ¨ç®­å¤´å‡½æ•°ä¸­ï¼Œå®ƒæ˜¯å›ºå®šçš„ã€‚ 12345678910function foo() &#123; setTimeout(() =&gt; &#123; console.log(\"id:\", this.id); &#125;, 100);&#125;var id = 21;foo.call(&#123; id: 42 &#125;);// id: 42 ä¸Šé¢ä»£ç ä¸­ï¼ŒsetTimeout çš„å‚æ•°æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¿™ä¸ªç®­å¤´å‡½æ•°çš„å®šä¹‰ç”Ÿæ•ˆæ˜¯åœ¨ foo å‡½æ•°ç”Ÿæˆæ—¶ï¼Œè€Œå®ƒçš„çœŸæ­£æ‰§è¡Œè¦ç­‰åˆ° 100 æ¯«ç§’åã€‚å¦‚æœæ˜¯æ™®é€šå‡½æ•°ï¼Œæ‰§è¡Œæ—¶ this åº”è¯¥æŒ‡å‘å…¨å±€å¯¹è±¡ windowï¼Œè¿™æ—¶åº”è¯¥è¾“å‡º 21ã€‚ä½†æ˜¯ï¼Œç®­å¤´å‡½æ•°å¯¼è‡´ this æ€»æ˜¯æŒ‡å‘å‡½æ•°å®šä¹‰ç”Ÿæ•ˆæ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼ˆæœ¬ä¾‹æ˜¯{id: 42}ï¼‰ï¼Œæ‰€ä»¥è¾“å‡ºçš„æ˜¯ 42ã€‚ åµŒå¥—çš„ç®­å¤´å‡½æ•°ç®­å¤´å‡½æ•°å†…éƒ¨ï¼Œè¿˜å¯ä»¥å†ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª ES5 è¯­æ³•çš„å¤šé‡åµŒå¥—å‡½æ•°ã€‚ 123456789101112131415161718192021222324252627282930function insert(value) &#123; return &#123; into: function(array) &#123; return &#123; after: function(afterValue) &#123; array.splice(array.indexOf(afterValue) + 1, 0, value); return array; &#125; &#125;; &#125; &#125;;&#125;insert(2) .into([1, 3]) .after(1); //[1, 2, 3]//ä½¿ç”¨ç®­å¤´å‡½æ•°æ”¹å†™let insert = value =&gt; (&#123; into: array =&gt; (&#123; after: afterValue =&gt; &#123; array.splice(array.indexOf(afterValue) + 1, 0, value); return array; &#125; &#125;)&#125;);insert(2) .into([1, 3]) .after(1); //[1, 2, 3] æ”¹å†™ Î» æ¼”ç®—123456// Î»æ¼”ç®—çš„å†™æ³•fix = Î»f.(Î»x.f(Î»v.x(x)(v)))(Î»x.f(Î»v.x(x)(v)))// ES6çš„å†™æ³•var fix = f =&gt; (x =&gt; f(v =&gt; x(x)(v))) (x =&gt; f(v =&gt; x(x)(v)));","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"thiså’Œsuperå…³é”®å­—","slug":"thiså’Œsuperå…³é”®å­—","date":"2018-09-24T10:41:35.000Z","updated":"2019-11-10T14:37:39.028Z","comments":true,"path":"2018/09/24/thiså’Œsuperå…³é”®å­—/","link":"","permalink":"http://yoursite.com/2018/09/24/thiså’Œsuperå…³é”®å­—/","excerpt":"this å…³é”®å­—this çš„æŒ‡å‘ï¼š ä½œä¸ºæ™®é€šå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ä½œä¸ºæ™®é€šå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ—¶ï¼Œthis æŒ‡å‘è¿™ä¸ªå¯¹è±¡æœ¬èº«","text":"this å…³é”®å­—this çš„æŒ‡å‘ï¼š ä½œä¸ºæ™®é€šå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ä½œä¸ºæ™®é€šå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ—¶ï¼Œthis æŒ‡å‘è¿™ä¸ªå¯¹è±¡æœ¬èº« 12345678910var obj = &#123; a: 1, getA: function() &#123; console.log(this === obj); console.log(this.a); &#125;&#125;;//thisæŒ‡å‘objå¯¹è±¡obj.getA(); ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨æ—¶ï¼Œthis æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­å…¨å±€å¯¹è±¡æ˜¯ windowï¼Œåœ¨ NodeJs ä¸­å…¨å±€å¯¹è±¡æ˜¯ globalã€‚ 1234567891011var obj = &#123; a: 1, getA: function() &#123; console.log(this === obj); console.log(this.a); &#125;&#125;;//thisæŒ‡å‘windowå¯¹è±¡var getA = obj.getA;getA(); è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œç›´æ¥è°ƒç”¨å¹¶ä¸æ˜¯æŒ‡åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹è¿›è¡Œè°ƒç”¨ï¼Œåœ¨ä»»ä½•ä½œç”¨åŸŸä¸‹ï¼Œç›´æ¥é€šè¿‡ å‡½æ•°å(â€¦) æ¥å¯¹å‡½æ•°è¿›è¡Œè°ƒç”¨çš„æ–¹å¼ï¼Œéƒ½ç§°ä¸ºç›´æ¥è°ƒç”¨ã€‚ æ„é€ å™¨è°ƒç”¨æ„é€ å™¨è°ƒç”¨æ—¶ï¼Œthis æŒ‡å‘è¿”å›çš„å¯¹è±¡ã€‚ç”¨ new è°ƒç”¨ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè€Œå…¶ä¸­çš„ this å°±æŒ‡å‘è¿™ä¸ªæ–°å¯¹è±¡ã€‚ 12345678910111213var a = 10;var b = 20;function Point(x, y) &#123; this.x = x; this.y = y;&#125;var a = new Point(1, 2);console.log(a.x); // 1console.log(x); // 10var b = new Point(1, 2);console.log(a === b); // false call apply bindå½“å‡½æ•°é€šè¿‡ call()å’Œ apply()æ–¹æ³•ç»‘å®šæ—¶ï¼Œthis æŒ‡å‘ä¸¤ä¸ªæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯¹è±¡ä¸Šï¼Œè‹¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ŒJS å†…éƒ¨ä¼šå°è¯•å°†å…¶è½¬åŒ–ä¸ºå¯¹è±¡ç„¶åå†æŒ‡å‘å®ƒã€‚é€šè¿‡ bind æ–¹æ³•ç»‘å®šåï¼Œæ— è®ºå…¶åœ¨ä»€ä¹ˆæƒ…å†µä¸‹è¢«è°ƒç”¨ï¼Œå‡½æ•°å°†è¢«æ°¸è¿œç»‘å®šåœ¨å…¶ç¬¬ä¸€ä¸ªå‚æ•°å¯¹è±¡ä¸Šï¼Œbind ç»‘å®šåè¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ call, apply çš„ç”¨é€” æ”¹å˜ this çš„æŒ‡å‘ Function.prototype.bind 12345678Function.prototype.bind = function() &#123; var self = this; var context = [].shift.call(arguments); var args = [].slice.call(arguments); return function() &#123; return self.apply(context, args.concat([].slice.call(arguments))); &#125;;&#125;; ä¸‰è€…åŒºåˆ«call åªèƒ½ä¸€ä¸ªä¸€ä¸ªä¼ å…¥å‚æ•°apply å¯ç›´æ¥ä¼ å…¥å‚æ•°æ•°ç»„bind ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•° super å…³é”®å­—å…³é”®å­— superï¼ŒæŒ‡å‘å½“å‰å¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚ 12345678910111213const proto = &#123; foo: \"hello\"&#125;;const obj = &#123; foo: \"world\", find() &#123; return super.foo; &#125;&#125;;Object.setPrototypeOf(obj, proto);obj.find(); // \"hello\" ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡ obj çš„ find æ–¹æ³•ä¹‹ä¸­ï¼Œé€šè¿‡ super.foo å¼•ç”¨äº†åŸå‹å¯¹è±¡ proto çš„ foo å±æ€§ã€‚æ³¨æ„ï¼Œsuper å…³é”®å­—è¡¨ç¤ºåŸå‹å¯¹è±¡æ—¶ï¼Œåªèƒ½ç”¨åœ¨å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸­ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹éƒ½ä¼šæŠ¥é”™ã€‚ 12345678910111213141516// æŠ¥é”™const obj = &#123; foo: super.foo&#125;;// æŠ¥é”™const obj = &#123; foo: () =&gt; super.foo&#125;;// æŠ¥é”™const obj = &#123; foo: function() &#123; return super.foo; &#125;&#125;; ä¸Šé¢ä¸‰ç§ super çš„ç”¨æ³•éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå¯¹äº JavaScript å¼•æ“æ¥è¯´ï¼Œè¿™é‡Œçš„ super éƒ½æ²¡æœ‰ç”¨åœ¨å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸­ã€‚ç¬¬ä¸€ç§å†™æ³•æ˜¯ super ç”¨åœ¨å±æ€§é‡Œé¢ï¼Œç¬¬äºŒç§å’Œç¬¬ä¸‰ç§å†™æ³•æ˜¯ super ç”¨åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç„¶åèµ‹å€¼ç»™ foo å±æ€§ã€‚ç›®å‰ï¼Œåªæœ‰å¯¹è±¡æ–¹æ³•çš„ç®€å†™æ³•å¯ä»¥è®© JavaScript å¼•æ“ç¡®è®¤ï¼Œå®šä¹‰çš„æ˜¯å¯¹è±¡çš„æ–¹æ³•ã€‚JavaScript å¼•æ“å†…éƒ¨ï¼Œsuper.foo ç­‰åŒäº Object.getPrototypeOf(this).fooï¼ˆå±æ€§ï¼‰æˆ– Object.getPrototypeOf(this).foo.call(this)ï¼ˆæ–¹æ³•ï¼‰ã€‚ 1234567891011121314151617const proto = &#123; x: \"hello\", foo() &#123; console.log(this.x); &#125;&#125;;const obj = &#123; x: \"world\", foo() &#123; super.foo(); &#125;&#125;;Object.setPrototypeOf(obj, proto);obj.foo(); // \"world\" ä¸Šé¢ä»£ç ä¸­ï¼Œsuper.foo æŒ‡å‘åŸå‹å¯¹è±¡ proto çš„ foo æ–¹æ³•ï¼Œä½†æ˜¯ç»‘å®šçš„ this å´è¿˜æ˜¯å½“å‰å¯¹è±¡ objï¼Œå› æ­¤è¾“å‡ºçš„å°±æ˜¯ worldã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"å¸¸ç”¨gitå‘½ä»¤","slug":"å¸¸ç”¨gitå‘½ä»¤","date":"2018-09-16T03:50:00.000Z","updated":"2019-09-21T14:18:54.013Z","comments":true,"path":"2018/09/16/å¸¸ç”¨gitå‘½ä»¤/","link":"","permalink":"http://yoursite.com/2018/09/16/å¸¸ç”¨gitå‘½ä»¤/","excerpt":"å¸¸ç”¨gitå‘½ä»¤çº¢è‰²ä»£è¡¨å·¥ä½œåŒºï¼Œç»¿è‰²ä»£è¡¨æš‚å­˜åŒº æ–‡ä»¶æ“ä½œ git initåœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª git ä»“åº“ï¼ˆmaster åˆ†æ”¯ï¼‰git init [project-name]æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸º git ä»“åº“","text":"å¸¸ç”¨gitå‘½ä»¤çº¢è‰²ä»£è¡¨å·¥ä½œåŒºï¼Œç»¿è‰²ä»£è¡¨æš‚å­˜åŒº æ–‡ä»¶æ“ä½œ git initåœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª git ä»“åº“ï¼ˆmaster åˆ†æ”¯ï¼‰git init [project-name]æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸º git ä»“åº“ git status æŸ¥çœ‹çŠ¶æ€â€œ.â€ ä»£è¡¨æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶ git add [file1][file2]æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº git commitåœ¨ç¬¬ä¸€è¡Œå†™å…¥è¿™æ¬¡ä¿®æ”¹è®°å½•ã€‚å°†ç¼“å­˜åŒºæ–‡ä»¶æ”¾å…¥æäº¤åŒºã€‚git commit -m [â€˜messageâ€™]git commit -amendä¿®æ”¹ä¸Šæ¬¡è®°å½•ä¿¡æ¯ git logæŸ¥çœ‹æäº¤è®°å½•vim ~/.zshrc é…ç½®æ–‡ä»¶ä¸­å¯è‡ªå®šä¹‰æ“ä½œsource ~/.zshrc ä¿®æ”¹é…ç½®æ–‡ä»¶å source ä¿å­˜ç”Ÿæ•ˆ git configæŸ¥çœ‹å½“å‰ git é…ç½®git config -hæŸ¥çœ‹å¸®åŠ©ä¿¡æ¯vim ~/.gitconfig è‡ªå®šä¹‰ git å‘½ä»¤ï¼Œä¿®æ”¹ä¸ªäººåå­—é‚®ç®±ç­‰ä¿¡æ¯cat .git/config æœ¬åœ°é…ç½® touch .gitignore å¿½ç•¥ä¸€äº›æ–‡ä»¶ 12.vscodenode_modules å†™å…¥ gitignore åå³å¯å¿½ç•¥ node_modules æ–‡ä»¶æ›´å¤šä¿¡æ¯æŸ¥çœ‹gitignore git diffç°å®æš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚ git checkout â€“aæ”¾å¼ƒ a çš„å˜æ›´ä¾ç…§æäº¤åŒºæ¢å¤å·¥ä½œåŒºçš„æ–‡ä»¶ï¼Œä¸¢å¼ƒå·¥ä½œåŒºçš„å˜æ›´ git reset HEAD â€“aä»æš‚å­˜åŒºæ¢å¤åˆ°å·¥ä½œåŒº git stashæŠŠå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„æ–‡ä»¶éƒ½å­˜å…¥ stash ä¸­git stash listæŸ¥çœ‹ stash ä¸­çš„æ–‡ä»¶git stash popæ¢å¤ stash ä¸­çš„æ–‡ä»¶åˆ°å·¥ä½œåŒºï¼ˆpop=apply+dropï¼‰ git reset HEAD\b^åé€€ä¸€æ­¥ï¼ˆå‡ ä¸ª^ä»£è¡¨åé€€å‡ æ­¥ï¼‰git reset HEAD~[number]æŠ›å¼ƒäº† number ä¸ª commit git reflogæŸ¥çœ‹è¿‘æœŸçš„ log è®°å½•git reset [ç‰ˆæœ¬å·]å›é€€åˆ°ç‰ˆæœ¬å·ä¸ºâ€¦â€¦çš„ commit åˆ†æ”¯æ“ä½œ git branch developåˆ›å»º develop åˆ†æ”¯,ä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯git branch -væŸ¥çœ‹åˆ†æ”¯ git checkout developåˆ‡æ¢è¿›å…¥ develop åˆ†æ”¯git checkout -b featureåˆ›å»ºå¹¶åˆ‡æ¢è¿›å…¥ feature åˆ†æ”¯ åˆå¹¶åˆ†æ”¯a. å…ˆè¿›å…¥è¦åˆå¹¶çš„åˆ†æ”¯ï¼ˆcheckout developï¼‰åœ¨æ‰§è¡Œ git merge feature å³å¯æŠŠ feature åˆå¹¶åˆ° develop åˆ†æ”¯ä¸Šb. git merge feature developå¯è¾¾åˆ°åŒæ ·çš„æ•ˆæœ æ”¹å˜åŸºçº¿git rebase -i [æäº¤è®°å½•å·]å°† HEAD æŒ‡å‘è®°å½•å·æ‰€åœ¨ä½ç½® è¿œç¨‹ä»“åº“ git remote add origin [SSH åœ°å€]åˆ›å»ºè¿œç¨‹ä»“åº“è¿æ¥ git push -u origin developä¸Šä¼  develop åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ä¸Šï¼ˆè¿œç¨‹æ— é¡¹ç›®å¯ç›´æ¥ pushï¼Œæœ‰é¡¹ç›®å…ˆ merge å† pushï¼‰ git pull origin featureæ‹‰å–è¿œç¨‹ feature åˆ†æ”¯ï¼ˆpull=fetch+mergeï¼‰ git brach -d featureåˆ é™¤ feature åˆ†æ”¯ git push origin :featureåˆ é™¤è¿œç¨‹ feature åˆ†æ”¯ git tag [æ ‡ç­¾å·]git push origin [æ ‡ç­¾å·]æ‰“æ ‡ç­¾ git remote remove originå–æ¶ˆæœ¬åœ°ç›®å½•ä¸‹å…³è”çš„è¿œç¨‹ä»“åº“ git clone [url]ä¸‹è½½ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å² æ‰“ tag vim package.json(vim package-lock.json)å¯ä»¥æŸ¥çœ‹ version å· npm version -hæŸ¥çœ‹è¿™ä¸€ä¸ª tag å³å°†æå‡çš„ç‰ˆæœ¬å·ï¼ˆå¤§ç‰ˆæœ¬æˆ–è€…å°ç‰ˆæœ¬ï¼‰ npm version patchæå‡ patch è¿™ä¸ªå°ç‰ˆæœ¬ï¼ˆv0.2.2ï¼‰ git tag â€“listæŸ¥çœ‹ tag çš„åˆ—è¡¨ git push origin masterpush ä»£ç  git push origin v0.2.3push tag","categories":[{"name":"git","slug":"git","permalink":"http://yoursite.com/categories/git/"}],"tags":[{"name":"git","slug":"git","permalink":"http://yoursite.com/tags/git/"}]},{"title":"è·¨åŸŸè¯·æ±‚ï¼šJSONP&&CORS","slug":"è·¨åŸŸè¯·æ±‚ï¼šJSONP&&CORS","date":"2018-09-03T09:28:34.000Z","updated":"2019-11-10T14:37:39.041Z","comments":true,"path":"2018/09/03/è·¨åŸŸè¯·æ±‚ï¼šJSONP&&CORS/","link":"","permalink":"http://yoursite.com/2018/09/03/è·¨åŸŸè¯·æ±‚ï¼šJSONP&&CORS/","excerpt":"JSONPJSONP æ˜¯ JSON with Padding çš„ç•¥ç§°ã€‚å®ƒæ˜¯ä¸€ä¸ªéå®˜æ–¹çš„åè®®ï¼Œå®ƒå…è®¸åœ¨æœåŠ¡å™¨ç«¯é›†æˆ Script tags è¿”å›è‡³å®¢æˆ·ç«¯ï¼Œé€šè¿‡ javascript callback çš„å½¢å¼å®ç°è·¨åŸŸè®¿é—®ï¼ˆè¿™ä»…ä»…æ˜¯ JSONP ç®€å•çš„å®ç°å½¢å¼ï¼‰ JSONP çš„ç®€å•å®ç°æ¨¡å¼ï¼šåˆ›å»ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç„¶ååœ¨è¿œç¨‹æœåŠ¡ä¸Šè°ƒç”¨è¿™ä¸ªå‡½æ•°å¹¶ä¸”å°† JSON æ•°æ®å½¢å¼ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå®Œæˆå›è°ƒã€‚ æˆ‘ä»¬çŸ¥é“scriptï¼Œlinkï¼Œimg ç­‰æ ‡ç­¾å¼•å…¥å¤–éƒ¨èµ„æºï¼Œéƒ½æ˜¯GETè¯·æ±‚çš„ï¼Œé‚£ä¹ˆå°±å†³å®šäº† JSONP ä¸€å®šæ˜¯ GETçš„ã€‚","text":"JSONPJSONP æ˜¯ JSON with Padding çš„ç•¥ç§°ã€‚å®ƒæ˜¯ä¸€ä¸ªéå®˜æ–¹çš„åè®®ï¼Œå®ƒå…è®¸åœ¨æœåŠ¡å™¨ç«¯é›†æˆ Script tags è¿”å›è‡³å®¢æˆ·ç«¯ï¼Œé€šè¿‡ javascript callback çš„å½¢å¼å®ç°è·¨åŸŸè®¿é—®ï¼ˆè¿™ä»…ä»…æ˜¯ JSONP ç®€å•çš„å®ç°å½¢å¼ï¼‰ JSONP çš„ç®€å•å®ç°æ¨¡å¼ï¼šåˆ›å»ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç„¶ååœ¨è¿œç¨‹æœåŠ¡ä¸Šè°ƒç”¨è¿™ä¸ªå‡½æ•°å¹¶ä¸”å°† JSON æ•°æ®å½¢å¼ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå®Œæˆå›è°ƒã€‚ æˆ‘ä»¬çŸ¥é“scriptï¼Œlinkï¼Œimg ç­‰æ ‡ç­¾å¼•å…¥å¤–éƒ¨èµ„æºï¼Œéƒ½æ˜¯GETè¯·æ±‚çš„ï¼Œé‚£ä¹ˆå°±å†³å®šäº† JSONP ä¸€å®šæ˜¯ GETçš„ã€‚ åŸç”Ÿ JS å®ç° JSONP çš„æ­¥éª¤ï¼šå®¢æˆ·ç«¯ å®šä¹‰è·å–æ•°æ®åè°ƒç”¨çš„å›è°ƒå‡½æ•° åŠ¨æ€ç”Ÿæˆå¯¹æœåŠ¡ç«¯ JS è¿›è¡Œå¼•ç”¨çš„ä»£ç  è®¾ç½®urlä¸ºæä¾›jsonpæœåŠ¡çš„urlåœ°å€ï¼Œå¹¶åœ¨è¯¥urlä¸­è®¾ç½®ç›¸å…³callbackå‚æ•° åˆ›å»ºscriptæ ‡ç­¾ï¼Œå¹¶è®¾ç½®å…¶srcå±æ€§ æŠŠscriptæ ‡ç­¾åŠ å…¥headï¼Œæ­¤æ—¶è°ƒç”¨å¼€å§‹ã€‚ æœåŠ¡ç«¯å°†å®¢æˆ·ç«¯å‘é€çš„callbackå‚æ•°ä½œä¸ºå‡½æ•°åæ¥åŒ…è£¹ä½JSONæ•°æ®ï¼Œè¿”å›æ•°æ®è‡³å®¢æˆ·ç«¯ã€‚ ä¾‹å­ï¼šå®¢æˆ·ç«¯ä»£ç ï¼š 12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;script type=\"text/javascript\"&gt; // å¾—åˆ°èˆªç­ä¿¡æ¯æŸ¥è¯¢ç»“æœåçš„å›è°ƒå‡½æ•° var flightHandler = function(data) &#123; alert( \"ä½ æŸ¥è¯¢çš„èˆªç­ç»“æœæ˜¯ï¼šç¥¨ä»· \" + data.price + \" å…ƒï¼Œ\" + \"ä½™ç¥¨ \" + data.tickets + \" å¼ ã€‚\" ); &#125;; // æä¾›jsonpæœåŠ¡çš„urlåœ°å€ï¼ˆä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹çš„åœ°å€ï¼Œæœ€ç»ˆç”Ÿæˆçš„è¿”å›å€¼éƒ½æ˜¯ä¸€æ®µjavascriptä»£ç ï¼‰ var url = \"http://flightQuery.com/jsonp/flightResult.aspx?code=CA1998&amp;callback=flightHandler\"; // åˆ›å»ºscriptæ ‡ç­¾ï¼Œè®¾ç½®å…¶å±æ€§ var script = document.createElement(\"script\"); script.setAttribute(\"src\", url); // æŠŠscriptæ ‡ç­¾åŠ å…¥headï¼Œæ­¤æ—¶è°ƒç”¨å¼€å§‹ document.getElementsByTagName(\"head\")[0].appendChild(script); &lt;/script&gt; &lt;/head&gt; &lt;body&gt;&lt;/body&gt;&lt;/html&gt; ç¼–ç å®ç°åŠ¨æ€æŸ¥è¯¢ï¼Œè€Œè¿™ä¹Ÿæ­£æ˜¯ JSONP å®¢æˆ·ç«¯å®ç°çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œæœ¬ä¾‹ä¸­çš„é‡ç‚¹ä¹Ÿå°±åœ¨äºå¦‚ä½•å®Œæˆ JSONP è°ƒç”¨çš„å…¨è¿‡ç¨‹ã€‚æˆ‘ä»¬çœ‹åˆ°è°ƒç”¨çš„urlä¸­ä¼ é€’äº†ä¸€ä¸ªcodeå‚æ•°ï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘è¦æŸ¥çš„æ˜¯ CA1998 æ¬¡èˆªç­çš„ä¿¡æ¯ï¼Œè€Œcallbackå‚æ•°åˆ™å‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘çš„æœ¬åœ°å›è°ƒå‡½æ•°å«åšflightHandlerï¼Œæ‰€ä»¥è¯·æŠŠæŸ¥è¯¢ç»“æœä¼ å…¥è¿™ä¸ªå‡½æ•°ä¸­è¿›è¡Œè°ƒç”¨ã€‚OKï¼ŒæœåŠ¡å™¨å¾ˆèªæ˜ï¼Œè¿™ä¸ªå«åšflightResult.aspxçš„é¡µé¢ç”Ÿæˆäº†ä¸€æ®µè¿™æ ·çš„ä»£ç æä¾›ç»™jsonp.htmlï¼ˆæœåŠ¡ç«¯çš„å®ç°è¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ï¼Œä¸ä½ é€‰ç”¨çš„è¯­è¨€æ— å…³ï¼Œè¯´åˆ°åº•å°±æ˜¯æ‹¼æ¥å­—ç¬¦ä¸²ï¼‰ï¼š 12345flightHandler(&#123; code: \"CA1998\", price: 1780, tickets: 5&#125;); æˆ‘ä»¬çœ‹åˆ°ï¼Œä¼ é€’ç»™flightHandlerå‡½æ•°çš„æ˜¯ä¸€ä¸ªjsonï¼Œå®ƒæè¿°äº†èˆªç­çš„åŸºæœ¬ä¿¡æ¯ã€‚è¿è¡Œä¸€ä¸‹é¡µé¢ï¼ŒæˆåŠŸå¼¹å‡ºæç¤ºçª—å£ï¼ŒJSONP çš„æ‰§è¡Œå…¨è¿‡ç¨‹é¡ºåˆ©å®Œæˆï¼ CORSè·¨åŸŸèµ„æºå…±äº«(CORS) æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå®ƒä½¿ç”¨é¢å¤–çš„ HTTP å¤´æ¥å‘Šè¯‰æµè§ˆå™¨ è®©è¿è¡Œåœ¨ä¸€ä¸ª origin (domain) ä¸Šçš„ Web åº”ç”¨è¢«å‡†è®¸è®¿é—®æ¥è‡ªä¸åŒæºæœåŠ¡å™¨ä¸Šçš„æŒ‡å®šçš„èµ„æºã€‚å½“ä¸€ä¸ªèµ„æºä»ä¸è¯¥èµ„æºæœ¬èº«æ‰€åœ¨çš„æœåŠ¡å™¨ä¸åŒçš„åŸŸã€åè®®æˆ–ç«¯å£è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œèµ„æºä¼šå‘èµ·ä¸€ä¸ªè·¨åŸŸ HTTP è¯·æ±‚ã€‚ CORS éœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼ŒIE æµè§ˆå™¨ä¸èƒ½ä½äº IE10ã€‚ æ•´ä¸ª CORS é€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCORS é€šä¿¡ä¸åŒæºçš„ AJAX é€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚æµè§ˆå™¨ä¸€æ—¦å‘ç° AJAX è¯·æ±‚è·¨æºï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ï¼Œæœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ çš„è¯·æ±‚ï¼Œä½†ç”¨æˆ·ä¸ä¼šæœ‰æ„Ÿè§‰ã€‚ å› æ­¤ï¼Œå®ç° CORS é€šä¿¡çš„å…³é”®æ˜¯æœåŠ¡å™¨ã€‚åªè¦æœåŠ¡å™¨å®ç°äº† CORS æ¥å£ï¼Œå°±å¯ä»¥è·¨æºé€šä¿¡ã€‚ 1.ä¸¤ç§è¯·æ±‚æµè§ˆå™¨å°† CORS è¯·æ±‚åˆ†æˆä¸¤ç±»ï¼šç®€å•è¯·æ±‚ï¼ˆsimple requestï¼‰å’Œéç®€å•è¯·æ±‚ï¼ˆnot-so-simple requestï¼‰ã€‚ åªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶ï¼Œå°±å±äºç®€å•è¯·æ±‚ã€‚ ï¼ˆ1) è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ï¼š HEAD GET POST ï¼ˆ2ï¼‰HTTP çš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µï¼š Accept Accept-Language Content-Language Last-Event-ID Content-Typeï¼šåªé™äºä¸‰ä¸ªå€¼application/x-www-form-urlencodedã€multipart/form-dataã€text/plain å‡¡æ˜¯ä¸åŒæ—¶æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±å±äºéç®€å•è¯·æ±‚ã€‚ æµè§ˆå™¨å¯¹è¿™ä¸¤ç§è¯·æ±‚çš„å¤„ç†ï¼Œæ˜¯ä¸ä¸€æ ·çš„ã€‚ 2.ç®€å•è¯·æ±‚ åŸºæœ¬æµç¨‹ å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ç›´æ¥å‘å‡º CORS è¯·æ±‚ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œå¢åŠ ä¸€ä¸ªOriginå­—æ®µã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæµè§ˆå™¨å‘ç°è¿™æ¬¡è·¨æº AJAX è¯·æ±‚æ˜¯ç®€å•è¯·æ±‚ï¼Œå°±è‡ªåŠ¨åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªOriginå­—æ®µã€‚ 123456GET /cors HTTP/1.1Origin: http://api.bob.comHost: api.alice.comAccept-Language: en-USConnection: keep-aliveUser-Agent: Mozilla/5.0... ä¸Šé¢çš„å¤´ä¿¡æ¯ä¸­ï¼ŒOriginå­—æ®µç”¨æ¥è¯´æ˜ï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªæºï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰ã€‚æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå€¼ï¼Œå†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·æ±‚ã€‚ å¦‚æœOriginæŒ‡å®šçš„æºï¼Œä¸åœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„ HTTP å›åº”ã€‚æµè§ˆå™¨å‘ç°ï¼Œè¿™ä¸ªå›åº”çš„å¤´ä¿¡æ¯æ²¡æœ‰åŒ…å«Access-Control-Allow-Originå­—æ®µï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œå°±çŸ¥é“å‡ºé”™äº†ï¼Œä»è€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢«XMLHttpRequestçš„onerrorå›è°ƒå‡½æ•°æ•è·ã€‚æ³¨æ„ï¼Œè¿™ç§é”™è¯¯æ— æ³•é€šè¿‡çŠ¶æ€ç è¯†åˆ«ï¼Œå› ä¸º HTTP å›åº”çš„çŠ¶æ€ç æœ‰å¯èƒ½æ˜¯ 200ã€‚ å¦‚æœOriginæŒ‡å®šçš„åŸŸååœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”ï¼Œä¼šå¤šå‡ºå‡ ä¸ªå¤´ä¿¡æ¯å­—æ®µã€‚ 1234Access-Control-Allow-Origin: http://api.bob.comAccess-Control-Allow-Credentials: trueAccess-Control-Expose-Headers: FooBarContent-Type: text/html; charset=utf-8 ä¸Šé¢çš„å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œæœ‰ä¸‰ä¸ªä¸ CORS è¯·æ±‚ç›¸å…³çš„å­—æ®µï¼Œéƒ½ä»¥Access-Control-å¼€å¤´ã€‚ ï¼ˆ1ï¼‰Access-Control-Allow-Origin è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ã€‚å®ƒçš„å€¼è¦ä¹ˆæ˜¯è¯·æ±‚æ—¶Originå­—æ®µçš„å€¼ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª*ï¼Œè¡¨ç¤ºæ¥å—ä»»æ„åŸŸåçš„è¯·æ±‚ã€‚ ï¼ˆ2ï¼‰Access-Control-Allow-Credentials è¯¥å­—æ®µå¯é€‰ã€‚å®ƒçš„å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€ Cookieã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒCookie ä¸åŒ…æ‹¬åœ¨ CORS è¯·æ±‚ä¹‹ä¸­ã€‚è®¾ä¸ºtrueï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨æ˜ç¡®è®¸å¯ï¼ŒCookie å¯ä»¥åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œä¸€èµ·å‘ç»™æœåŠ¡å™¨ã€‚è¿™ä¸ªå€¼ä¹Ÿåªèƒ½è®¾ä¸ºtrueï¼Œå¦‚æœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€ Cookieï¼Œåˆ é™¤è¯¥å­—æ®µå³å¯ã€‚ ï¼ˆ3ï¼‰Access-Control-Expose-Headers è¯¥å­—æ®µå¯é€‰ã€‚CORS è¯·æ±‚æ—¶ï¼ŒXMLHttpRequestå¯¹è±¡çš„getResponseHeader()æ–¹æ³•åªèƒ½æ‹¿åˆ° 6 ä¸ªåŸºæœ¬å­—æ®µï¼šCache-Controlã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragmaã€‚å¦‚æœæƒ³æ‹¿åˆ°å…¶ä»–å­—æ®µï¼Œå°±å¿…é¡»åœ¨Access-Control-Expose-Headersé‡Œé¢æŒ‡å®šã€‚ä¸Šé¢çš„ä¾‹å­æŒ‡å®šï¼ŒgetResponseHeader(&#39;FooBar&#39;)å¯ä»¥è¿”å›FooBarå­—æ®µçš„å€¼ã€‚ withCredentials å±æ€§ ä¸Šé¢è¯´åˆ°ï¼ŒCORS è¯·æ±‚é»˜è®¤ä¸å‘é€ Cookie å’Œ HTTP è®¤è¯ä¿¡æ¯ã€‚å¦‚æœè¦æŠŠ Cookie å‘åˆ°æœåŠ¡å™¨ï¼Œä¸€æ–¹é¢è¦æœåŠ¡å™¨åŒæ„ï¼ŒæŒ‡å®šAccess-Control-Allow-Credentialså­—æ®µã€‚ 1Access-Control-Allow-Credentials: true å¦ä¸€æ–¹é¢ï¼Œå¼€å‘è€…å¿…é¡»åœ¨ AJAX è¯·æ±‚ä¸­æ‰“å¼€withCredentialså±æ€§ã€‚ 12var xhr = new XMLHttpRequest();xhr.withCredentials = true; å¦åˆ™ï¼Œå³ä½¿æœåŠ¡å™¨åŒæ„å‘é€ Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¸ä¼šå‘é€ã€‚æˆ–è€…ï¼ŒæœåŠ¡å™¨è¦æ±‚è®¾ç½® Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¸ä¼šå¤„ç†ã€‚ ä½†æ˜¯ï¼Œå¦‚æœçœç•¥withCredentialsè®¾ç½®ï¼Œæœ‰çš„æµè§ˆå™¨è¿˜æ˜¯ä¼šä¸€èµ·å‘é€ Cookieã€‚è¿™æ—¶ï¼Œå¯ä»¥æ˜¾å¼å…³é—­withCredentialsã€‚ 1xhr.withCredentials = false; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦å‘é€ Cookieï¼ŒAccess-Control-Allow-Originå°±ä¸èƒ½è®¾ä¸ºæ˜Ÿå·ï¼Œå¿…é¡»æŒ‡å®šæ˜ç¡®çš„ã€ä¸è¯·æ±‚ç½‘é¡µä¸€è‡´çš„åŸŸåã€‚åŒæ—¶ï¼ŒCookie ä¾ç„¶éµå¾ªåŒæºæ”¿ç­–ï¼Œåªæœ‰ç”¨æœåŠ¡å™¨åŸŸåè®¾ç½®çš„ Cookie æ‰ä¼šä¸Šä¼ ï¼Œå…¶ä»–åŸŸåçš„ Cookie å¹¶ä¸ä¼šä¸Šä¼ ï¼Œä¸”ï¼ˆè·¨æºï¼‰åŸç½‘é¡µä»£ç ä¸­çš„document.cookieä¹Ÿæ— æ³•è¯»å–æœåŠ¡å™¨åŸŸåä¸‹çš„ Cookieã€‚ 3.éç®€å•è¯·æ±‚ é¢„æ£€è¯·æ±‚ éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯PUTæˆ–DELETEï¼Œæˆ–è€…Content-Typeå­—æ®µçš„ç±»å‹æ˜¯application/jsonã€‚ éç®€å•è¯·æ±‚çš„ CORS è¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡ HTTP æŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€é¢„æ£€â€è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚ æµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº› HTTP åŠ¨è¯å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„XMLHttpRequestè¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚ ä¸‹é¢æ˜¯ä¸€æ®µæµè§ˆå™¨çš„ JavaScript è„šæœ¬ã€‚ 12345var url = \"http://api.alice.com/cors\";var xhr = new XMLHttpRequest();xhr.open(\"PUT\", url, true);xhr.setRequestHeader(\"X-Custom-Header\", \"value\");xhr.send(); ä¸Šé¢ä»£ç ä¸­ï¼ŒHTTP è¯·æ±‚çš„æ–¹æ³•æ˜¯PUTï¼Œå¹¶ä¸”å‘é€ä¸€ä¸ªè‡ªå®šä¹‰å¤´ä¿¡æ¯X-Custom-Headerã€‚ æµè§ˆå™¨å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªéç®€å•è¯·æ±‚ï¼Œå°±è‡ªåŠ¨å‘å‡ºä¸€ä¸ªâ€é¢„æ£€â€è¯·æ±‚ï¼Œè¦æ±‚æœåŠ¡å™¨ç¡®è®¤å¯ä»¥è¿™æ ·è¯·æ±‚ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªâ€é¢„æ£€â€è¯·æ±‚çš„ HTTP å¤´ä¿¡æ¯ã€‚ 12345678OPTIONS /cors HTTP/1.1Origin: http://api.bob.comAccess-Control-Request-Method: PUTAccess-Control-Request-Headers: X-Custom-HeaderHost: api.alice.comAccept-Language: en-USConnection: keep-aliveUser-Agent: Mozilla/5.0... â€œé¢„æ£€â€è¯·æ±‚ç”¨çš„è¯·æ±‚æ–¹æ³•æ˜¯OPTIONSï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯ç”¨æ¥è¯¢é—®çš„ã€‚å¤´ä¿¡æ¯é‡Œé¢ï¼Œå…³é”®å­—æ®µæ˜¯Originï¼Œè¡¨ç¤ºè¯·æ±‚æ¥è‡ªå“ªä¸ªæºã€‚ é™¤äº†Originå­—æ®µï¼Œâ€é¢„æ£€â€è¯·æ±‚çš„å¤´ä¿¡æ¯åŒ…æ‹¬ä¸¤ä¸ªç‰¹æ®Šå­—æ®µã€‚ ï¼ˆ1ï¼‰Access-Control-Request-Method è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ï¼Œç”¨æ¥åˆ—å‡ºæµè§ˆå™¨çš„ CORS è¯·æ±‚ä¼šç”¨åˆ°å“ªäº› HTTP æ–¹æ³•ï¼Œä¸Šä¾‹æ˜¯PUTã€‚ ï¼ˆ2ï¼‰Access-Control-Request-Headers è¯¥å­—æ®µæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæµè§ˆå™¨ CORS è¯·æ±‚ä¼šé¢å¤–å‘é€çš„å¤´ä¿¡æ¯å­—æ®µï¼Œä¸Šä¾‹æ˜¯X-Custom-Headerã€‚ é¢„æ£€è¯·æ±‚çš„å›åº” æœåŠ¡å™¨æ”¶åˆ°â€é¢„æ£€â€è¯·æ±‚ä»¥åï¼Œæ£€æŸ¥äº†Originã€Access-Control-Request-Methodå’ŒAccess-Control-Request-Headerså­—æ®µä»¥åï¼Œç¡®è®¤å…è®¸è·¨æºè¯·æ±‚ï¼Œå°±å¯ä»¥åšå‡ºå›åº”ã€‚ 123456789101112HTTP/1.1 200 OKDate: Mon, 01 Dec 2008 01:15:39 GMTServer: Apache/2.0.61 (Unix)Access-Control-Allow-Origin: http://api.bob.comAccess-Control-Allow-Methods: GET, POST, PUTAccess-Control-Allow-Headers: X-Custom-HeaderContent-Type: text/html; charset=utf-8Content-Encoding: gzipContent-Length: 0Keep-Alive: timeout=2, max=100Connection: Keep-AliveContent-Type: text/plain ä¸Šé¢çš„ HTTP å›åº”ä¸­ï¼Œå…³é”®çš„æ˜¯Access-Control-Allow-Originå­—æ®µï¼Œè¡¨ç¤ºhttp://api.bob.comå¯ä»¥è¯·æ±‚æ•°æ®ã€‚è¯¥å­—æ®µä¹Ÿå¯ä»¥è®¾ä¸ºæ˜Ÿå·ï¼Œè¡¨ç¤ºåŒæ„ä»»æ„è·¨æºè¯·æ±‚ã€‚ 1Access-Control-Allow-Origin: * å¦‚æœæµè§ˆå™¨å¦å®šäº†â€é¢„æ£€â€è¯·æ±‚ï¼Œä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„ HTTP å›åº”ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½• CORS ç›¸å…³çš„å¤´ä¿¡æ¯å­—æ®µã€‚è¿™æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šè®¤å®šï¼ŒæœåŠ¡å™¨ä¸åŒæ„é¢„æ£€è¯·æ±‚ï¼Œå› æ­¤è§¦å‘ä¸€ä¸ªé”™è¯¯ï¼Œè¢«XMLHttpRequestå¯¹è±¡çš„onerrorå›è°ƒå‡½æ•°æ•è·ã€‚æ§åˆ¶å°ä¼šæ‰“å°å‡ºå¦‚ä¸‹çš„æŠ¥é”™ä¿¡æ¯ã€‚ 12XMLHttpRequest cannot load http://api.alice.com.Origin http://api.bob.com is not allowed by Access-Control-Allow-Origin. æœåŠ¡å™¨å›åº”çš„å…¶ä»– CORS ç›¸å…³å­—æ®µå¦‚ä¸‹ã€‚ 1234Access-Control-Allow-Methods: GET, POST, PUTAccess-Control-Allow-Headers: X-Custom-HeaderAccess-Control-Allow-Credentials: trueAccess-Control-Max-Age: 1728000 ï¼ˆ1ï¼‰Access-Control-Allow-Methods è¯¥å­—æ®µå¿…éœ€ï¼Œå®ƒçš„å€¼æ˜¯é€—å·åˆ†éš”çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰æ”¯æŒçš„æ–¹æ³•ï¼Œè€Œä¸å•æ˜¯æµè§ˆå™¨è¯·æ±‚çš„é‚£ä¸ªæ–¹æ³•ã€‚è¿™æ˜¯ä¸ºäº†é¿å…å¤šæ¬¡â€é¢„æ£€â€è¯·æ±‚ã€‚ ï¼ˆ2ï¼‰Access-Control-Allow-Headers å¦‚æœæµè§ˆå™¨è¯·æ±‚åŒ…æ‹¬Access-Control-Request-Headerså­—æ®µï¼Œåˆ™Access-Control-Allow-Headerså­—æ®µæ˜¯å¿…éœ€çš„ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰å¤´ä¿¡æ¯å­—æ®µï¼Œä¸é™äºæµè§ˆå™¨åœ¨â€é¢„æ£€â€ä¸­è¯·æ±‚çš„å­—æ®µã€‚ ï¼ˆ3ï¼‰Access-Control-Allow-Credentials è¯¥å­—æ®µä¸ç®€å•è¯·æ±‚æ—¶çš„å«ä¹‰ç›¸åŒã€‚ ï¼ˆ4ï¼‰Access-Control-Max-Age è¯¥å­—æ®µå¯é€‰ï¼Œç”¨æ¥æŒ‡å®šæœ¬æ¬¡é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ã€‚ä¸Šé¢ç»“æœä¸­ï¼Œæœ‰æ•ˆæœŸæ˜¯ 20 å¤©ï¼ˆ1728000 ç§’ï¼‰ï¼Œå³å…è®¸ç¼“å­˜è¯¥æ¡å›åº” 1728000 ç§’ï¼ˆå³ 20 å¤©ï¼‰ï¼Œåœ¨æ­¤æœŸé—´ï¼Œä¸ç”¨å‘å‡ºå¦ä¸€æ¡é¢„æ£€è¯·æ±‚ã€‚ æµè§ˆå™¨çš„æ­£å¸¸è¯·æ±‚å’Œå›åº” ä¸€æ—¦æœåŠ¡å™¨é€šè¿‡äº†â€é¢„æ£€â€è¯·æ±‚ï¼Œä»¥åæ¯æ¬¡æµè§ˆå™¨æ­£å¸¸çš„ CORS è¯·æ±‚ï¼Œå°±éƒ½è·Ÿç®€å•è¯·æ±‚ä¸€æ ·ï¼Œä¼šæœ‰ä¸€ä¸ªOriginå¤´ä¿¡æ¯å­—æ®µã€‚æœåŠ¡å™¨çš„å›åº”ï¼Œä¹Ÿéƒ½ä¼šæœ‰ä¸€ä¸ªAccess-Control-Allow-Originå¤´ä¿¡æ¯å­—æ®µã€‚ ä¸‹é¢æ˜¯â€é¢„æ£€â€è¯·æ±‚ä¹‹åï¼Œæµè§ˆå™¨çš„æ­£å¸¸ CORS è¯·æ±‚ã€‚ 1234567PUT /cors HTTP/1.1Origin: http://api.bob.comHost: api.alice.comX-Custom-Header: valueAccept-Language: en-USConnection: keep-aliveUser-Agent: Mozilla/5.0... ä¸Šé¢å¤´ä¿¡æ¯çš„Originå­—æ®µæ˜¯æµè§ˆå™¨è‡ªåŠ¨æ·»åŠ çš„ã€‚ ä¸‹é¢æ˜¯æœåŠ¡å™¨æ­£å¸¸çš„å›åº”ã€‚ 12Access-Control-Allow-Origin: http://api.bob.comContent-Type: text/html; charset=utf-8 ä¸Šé¢å¤´ä¿¡æ¯ä¸­ï¼ŒAccess-Control-Allow-Originå­—æ®µæ˜¯æ¯æ¬¡å›åº”éƒ½å¿…å®šåŒ…å«çš„ã€‚ 4.ä¸ JSONP çš„æ¯”è¾ƒCORS ä¸ JSONP çš„ä½¿ç”¨ç›®çš„ç›¸åŒï¼Œä½†æ˜¯æ¯” JSONP æ›´å¼ºå¤§ã€‚ JSONP åªæ”¯æŒGETè¯·æ±‚ï¼ŒCORS æ”¯æŒæ‰€æœ‰ç±»å‹çš„ HTTP è¯·æ±‚ã€‚JSONP çš„ä¼˜åŠ¿åœ¨äºæ”¯æŒè€å¼æµè§ˆå™¨ï¼Œä»¥åŠå¯ä»¥å‘ä¸æ”¯æŒ CORS çš„ç½‘ç«™è¯·æ±‚æ•°æ®ã€‚","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://yoursite.com/tags/æµè§ˆå™¨/"},{"name":"è·¨åŸŸ","slug":"è·¨åŸŸ","permalink":"http://yoursite.com/tags/è·¨åŸŸ/"}]},{"title":"æ­£åˆ™çš„æ‰©å±•","slug":"æ­£åˆ™çš„æ‰©å±•","date":"2018-08-29T08:56:12.000Z","updated":"2019-11-10T14:37:39.037Z","comments":true,"path":"2018/08/29/æ­£åˆ™çš„æ‰©å±•/","link":"","permalink":"http://yoursite.com/2018/08/29/æ­£åˆ™çš„æ‰©å±•/","excerpt":"RegExp æ„é€ å‡½æ•°RegExp æ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µã€‚ å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰ã€‚ å‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨ç¤ºå¼ï¼Œè¿™æ—¶ä¼šè¿”å›ä¸€ä¸ªåŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´ã€‚","text":"RegExp æ„é€ å‡½æ•°RegExp æ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µã€‚ å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰ã€‚ å‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨ç¤ºå¼ï¼Œè¿™æ—¶ä¼šè¿”å›ä¸€ä¸ªåŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´ã€‚ 12345var regex = new RegExp(\"xyz\", \"i\");// ç­‰ä»·äºvar regex = new RegExp(/xyz/i);// ç­‰ä»·äºvar regex = /xyz/i; ES6 ä¸­ï¼Œå¦‚æœ RegExp æ„é€ å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¿®é¥°ç¬¦ã€‚è€Œä¸”ï¼Œè¿”å›çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šå¿½ç•¥åŸæœ‰çš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼Œåªä½¿ç”¨æ–°æŒ‡å®šçš„ä¿®é¥°ç¬¦ã€‚ 12new RegExp(/abc/gi, \"i\").flags;// \"i\" å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•å­—ç¬¦ä¸²å¯¹è±¡å…±æœ‰ 4 ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼šmatch()ã€replace()ã€search()å’Œ split()ã€‚ES6 å°†è¿™ 4 ä¸ªæ–¹æ³•ï¼Œåœ¨è¯­è¨€å†…éƒ¨å…¨éƒ¨è°ƒç”¨ RegExp çš„å®ä¾‹æ–¹æ³•ï¼Œä»è€Œåšåˆ°æ‰€æœ‰ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•ï¼Œå…¨éƒ½å®šä¹‰åœ¨ RegExp å¯¹è±¡ä¸Šã€‚ String.prototype.match è°ƒç”¨ RegExp.prototype[Symbol.match] String.prototype.replace è°ƒç”¨ RegExp.prototype[Symbol.replace] String.prototype.search è°ƒç”¨ RegExp.prototype[Symbol.search] String.prototype.split è°ƒç”¨ RegExp.prototype[Symbol.split] u ä¿®é¥°ç¬¦ES6 å¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº† u ä¿®é¥°ç¬¦ï¼Œå«ä¹‰ä¸ºâ€œUnicode æ¨¡å¼â€ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº\\uFFFF çš„ Unicode å­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„ UTF-16 ç¼–ç ã€‚ ç‚¹å­—ç¬¦ç‚¹ï¼ˆ.ï¼‰å­—ç¬¦åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå«ä¹‰æ˜¯é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚å¯¹äºç ç‚¹å¤§äº 0xFFFF çš„ Unicode å­—ç¬¦ï¼Œç‚¹å­—ç¬¦ä¸èƒ½è¯†åˆ«ï¼Œå¿…é¡»åŠ ä¸Š u ä¿®é¥°ç¬¦ã€‚ 1234var s = 'ğ ®·';/^.$/.test(s) // false/^.$/u.test(s) // true Unicode å­—ç¬¦è¡¨ç¤ºæ³•ES6 æ–°å¢äº†ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤º Unicode å­—ç¬¦ï¼Œè¿™ç§è¡¨ç¤ºæ³•åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»åŠ ä¸Š u ä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¯†åˆ«å½“ä¸­çš„å¤§æ‹¬å·ï¼Œå¦åˆ™ä¼šè¢«è§£è¯»ä¸ºé‡è¯ã€‚ 12345/\\u&#123;61&#125;/.test(\"a\") / // falsea /u.test(\"a\") / // true ğ ®· / u.test(\"ğ ®·\"); // true é‡è¯ä½¿ç”¨ u ä¿®é¥°ç¬¦åï¼Œæ‰€æœ‰é‡è¯éƒ½ä¼šæ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº 0xFFFF çš„ Unicode å­—ç¬¦ã€‚ 1234/a&#123;2&#125;/.test('aa') // true/a&#123;2&#125;/u.test('aa') // true/ğ ®·&#123;2&#125;/.test('ğ ®·ğ ®·') // false/ğ ®·&#123;2&#125;/u.test('ğ ®·ğ ®·') // true é¢„å®šä¹‰æ¨¡å¼\\S æ˜¯é¢„å®šä¹‰æ¨¡å¼ï¼ŒåŒ¹é…æ‰€æœ‰éç©ºç™½å­—ç¬¦ã€‚åªæœ‰åŠ äº† u ä¿®é¥°ç¬¦ï¼Œå®ƒæ‰èƒ½æ­£ç¡®åŒ¹é…ç ç‚¹å¤§äº 0xFFFF çš„ Unicode å­—ç¬¦ã€‚ 12/^\\S$/.test('ğ ®·') // false/^\\S$/u.test('ğ ®·') // true i ä¿®é¥°ç¬¦æœ‰äº› Unicode å­—ç¬¦çš„ç¼–ç ä¸åŒï¼Œä½†æ˜¯å­—å‹å¾ˆç›¸è¿‘ï¼Œæ¯”å¦‚ï¼Œ\\u004B ä¸\\u212A éƒ½æ˜¯å¤§å†™çš„ Kã€‚ä¸åŠ  u ä¿®é¥°ç¬¦ï¼Œå°±æ— æ³•è¯†åˆ«éè§„èŒƒçš„ K å­—ç¬¦ã€‚ 123/[a-z]/i.test(\"\\u212A\") / // false [a - z] / iu.test(\"\\u212A\"); // true RegExp.prototype.unicode å±æ€§æ­£åˆ™å®ä¾‹å¯¹è±¡æ–°å¢ unicode å±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº† u ä¿®é¥°ç¬¦ 12345const r1 = /hello/;const r2 = /hello/u;r1.unicode; // falser2.unicode; // true ä¸Šé¢ä»£ç ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦è®¾ç½®äº† u ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä» unicode å±æ€§çœ‹å‡ºæ¥ã€‚ y ä¿®é¥°ç¬¦ES6 ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº† y ä¿®é¥°ç¬¦ï¼Œå«åšâ€œç²˜è¿â€ï¼ˆstickyï¼‰ä¿®é¥°ç¬¦ã€‚y ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸ g ä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œg ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œ y ä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œè¿™ä¹Ÿå°±æ˜¯â€œç²˜è¿â€çš„æ¶µä¹‰ã€‚ 123456789var s = \"aaa_aa_a\";var r1 = /a+/g;var r2 = /a+/y;r1.exec(s); // [\"aaa\"]r2.exec(s); // [\"aaa\"]r1.exec(s); // [\"aa\"]r2.exec(s); // null å•å•ä¸€ä¸ª y ä¿®é¥°ç¬¦å¯¹ match æ–¹æ³•ï¼Œåªèƒ½è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œå¿…é¡»ä¸ g ä¿®é¥°ç¬¦è”ç”¨ï¼Œæ‰èƒ½è¿”å›æ‰€æœ‰åŒ¹é…ã€‚ 12\"a1a2a3\".match(/a\\d/y); // [\"a1\"]\"a1a2a3\".match(/a\\d/gy); // [\"a1\", \"a2\", \"a3\"] RegExp.prototype.sticky å±æ€§ä¸ y ä¿®é¥°ç¬¦ç›¸åŒ¹é…ï¼ŒES6 çš„æ­£åˆ™å®ä¾‹å¯¹è±¡å¤šäº† sticky å±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº† y ä¿®é¥°ç¬¦ã€‚ 12var r = /hello\\d/y;r.sticky; // true RegExp.prototype.flags å±æ€§ES6 ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ–°å¢äº† flags å±æ€§ï¼Œä¼šè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ã€‚ 12345678910// ES5 çš„ source å±æ€§// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„æ­£æ–‡/abc/gi.source / // \"abc\" // ES6 çš„ flags å±æ€§ // è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ abc / ig.flags;// 'gi' s ä¿®é¥°ç¬¦ï¼šdotAll æ¨¡å¼æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹ï¼ˆ.ï¼‰æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä»£è¡¨ä»»æ„çš„å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªä¾‹å¤–ã€‚ä¸€ä¸ªæ˜¯å››ä¸ªå­—èŠ‚çš„ UTF-16 å­—ç¬¦ï¼Œè¿™ä¸ªå¯ä»¥ç”¨ u ä¿®é¥°ç¬¦è§£å†³ï¼›å¦ä¸€ä¸ªæ˜¯è¡Œç»ˆæ­¢ç¬¦ã€‚è¡Œç»ˆæ­¢ç¬¦ï¼Œå°±æ˜¯è¯¥å­—ç¬¦è¡¨ç¤ºä¸€è¡Œçš„ç»ˆç»“ã€‚ä»¥ä¸‹å››ä¸ªå­—ç¬¦å±äºâ€è¡Œç»ˆæ­¢ç¬¦â€œã€‚ U+000A æ¢è¡Œç¬¦ï¼ˆ\\nï¼‰ U+000D å›è½¦ç¬¦ï¼ˆ\\rï¼‰ U+2028 è¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰ U+2029 æ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰ES2018 å¼•å…¥ s ä¿®é¥°ç¬¦ï¼Œä½¿å¾—.å¯ä»¥åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ã€‚ 1/foo.bar/s.test(\"foo\\nbar\"); // true è¿™è¢«ç§°ä¸º dotAll æ¨¡å¼ï¼Œå³ç‚¹ï¼ˆdotï¼‰ä»£è¡¨ä¸€åˆ‡å­—ç¬¦ã€‚æ‰€ä»¥ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜å¼•å…¥äº†ä¸€ä¸ª dotAll å±æ€§ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦å¤„åœ¨ dotAll æ¨¡å¼ã€‚/s ä¿®é¥°ç¬¦å’Œå¤šè¡Œä¿®é¥°ç¬¦/m ä¸å†²çªï¼Œä¸¤è€…ä¸€èµ·ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œ.åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼Œè€Œ^å’Œ$åŒ¹é…æ¯ä¸€è¡Œçš„è¡Œé¦–å’Œè¡Œå°¾ã€‚ åè¡Œæ–­è¨€â€å…ˆè¡Œæ–­è¨€â€œæŒ‡çš„æ˜¯ï¼Œx åªæœ‰åœ¨ y å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/x(?=y)/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ/\\d+(?=%)/ã€‚â€å…ˆè¡Œå¦å®šæ–­è¨€â€œæŒ‡çš„æ˜¯ï¼Œx åªæœ‰ä¸åœ¨ y å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/x(?!y)/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ/\\d+(?!%)/ã€‚â€œåè¡Œæ–­è¨€â€æ­£å¥½ä¸â€œå…ˆè¡Œæ–­è¨€â€ç›¸åï¼Œx åªæœ‰åœ¨ y åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/(?&lt;=y)x/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç¾å…ƒç¬¦å·ä¹‹åçš„æ•°å­—ï¼Œè¦å†™æˆ/(?&lt;=$)\\d+/ã€‚â€åè¡Œå¦å®šæ–­è¨€â€œåˆ™ä¸â€å…ˆè¡Œå¦å®šæ–­è¨€â€œç›¸åï¼Œx åªæœ‰ä¸åœ¨ y åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ/(?&lt;!y)x/ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç¾å…ƒç¬¦å·åé¢çš„æ•°å­—ï¼Œè¦å†™æˆ/(?&lt;!$)\\d+/ã€‚ 123const RE_DOLLAR_PREFIX = /(?&lt;=\\$)foo/g;\"$foo %foo foo\".replace(RE_DOLLAR_PREFIX, \"bar\");// '$bar %foo foo' â€œåè¡Œæ–­è¨€â€çš„å®ç°ï¼Œéœ€è¦å…ˆåŒ¹é…/(?&lt;=y)x/çš„ xï¼Œç„¶åå†å›åˆ°å·¦è¾¹ï¼ŒåŒ¹é… y çš„éƒ¨åˆ†ã€‚è¿™ç§â€œå…ˆå³åå·¦â€çš„æ‰§è¡Œé¡ºåºï¼Œä¸æ‰€æœ‰å…¶ä»–æ­£åˆ™æ“ä½œç›¸åï¼Œå¯¼è‡´äº†ä¸€äº›ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚é¦–å…ˆï¼Œåè¡Œæ–­è¨€çš„ç»„åŒ¹é…ï¼Œä¸æ­£å¸¸æƒ…å†µä¸‹ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚ 12/(?&lt;=(\\d+)(\\d+))$/.exec('1053') // [\"\", \"1\", \"053\"]/^(\\d+)(\\d+)$/.exec('1053') // [\"1053\", \"105\", \"3\"] ä¸Šé¢ä»£ç ä¸­ï¼Œéœ€è¦æ•æ‰ä¸¤ä¸ªç»„åŒ¹é…ã€‚æ²¡æœ‰â€œåè¡Œæ–­è¨€â€æ—¶ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬äºŒä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯ 105 å’Œ 3ã€‚è€Œâ€œåè¡Œæ–­è¨€â€æ—¶ï¼Œç”±äºæ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ï¼Œç¬¬äºŒä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯ 1 å’Œ 053ã€‚å…¶æ¬¡ï¼Œâ€œåè¡Œæ–­è¨€â€çš„åæ–œæ å¼•ç”¨ï¼Œä¹Ÿä¸é€šå¸¸çš„é¡ºåºç›¸åï¼Œå¿…é¡»æ”¾åœ¨å¯¹åº”çš„é‚£ä¸ªæ‹¬å·ä¹‹å‰ã€‚ Unicode å±æ€§ç±»ES2018 å¼•å…¥äº†ä¸€ç§æ–°çš„ç±»çš„å†™æ³•\\p{â€¦}å’Œ\\P{â€¦}ï¼Œå…è®¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç¬¦åˆ Unicode æŸç§å±æ€§çš„æ‰€æœ‰å­—ç¬¦ã€‚Unicode å±æ€§ç±»è¦æŒ‡å®šå±æ€§åå’Œå±æ€§å€¼ã€‚å¯¹äºæŸäº›å±æ€§ï¼Œå¯ä»¥åªå†™å±æ€§åï¼Œæˆ–è€…åªå†™å±æ€§å€¼ã€‚\\P{â€¦}æ˜¯\\p{â€¦}çš„åå‘åŒ¹é…ï¼Œå³åŒ¹é…ä¸æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚è¿™ä¸¤ç§ç±»åªå¯¹ Unicode æœ‰æ•ˆï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦åŠ ä¸Š u ä¿®é¥°ç¬¦ã€‚å¦‚æœä¸åŠ  u ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨\\p å’Œ\\P ä¼šæŠ¥é”™ï¼ŒECMAScript é¢„ç•™äº†è¿™ä¸¤ä¸ªç±»ã€‚ 123456789101112131415// åŒ¹é…æ‰€æœ‰ç©ºæ ¼\\p&#123;White_Space&#125;// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰å­—æ¯ï¼Œç­‰åŒäº Unicode ç‰ˆçš„ \\w[\\p&#123;Alphabetic&#125;\\p&#123;Mark&#125;\\p&#123;Decimal_Number&#125;\\p&#123;Connector_Punctuation&#125;\\p&#123;Join_Control&#125;]// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰éå­—æ¯çš„å­—ç¬¦ï¼Œç­‰åŒäº Unicode ç‰ˆçš„ \\W[^\\p&#123;Alphabetic&#125;\\p&#123;Mark&#125;\\p&#123;Decimal_Number&#125;\\p&#123;Connector_Punctuation&#125;\\p&#123;Join_Control&#125;]// åŒ¹é… Emoji/\\p&#123;Emoji_Modifier_Base&#125;\\p&#123;Emoji_Modifier&#125;?|\\p&#123;Emoji_Presentation&#125;|\\p&#123;Emoji&#125;\\uFE0F/gu// åŒ¹é…æ‰€æœ‰çš„ç®­å¤´å­—ç¬¦const regexArrows = /^\\p&#123;Block=Arrows&#125;+$/u;regexArrows.test('â†â†‘â†’â†“â†”â†•â†–â†—â†˜â†™â‡â‡â‡‘â‡’â‡“â‡”â‡•â‡–â‡—â‡˜â‡™â‡§â‡©') // true å…·åç»„åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨åœ†æ‹¬å·è¿›è¡Œç»„åŒ¹é…ã€‚ 123456const RE_DATE = /(\\d&#123;4&#125;)-(\\d&#123;2&#125;)-(\\d&#123;2&#125;)/;const matchObj = RE_DATE.exec(\"1999-12-31\");const year = matchObj[1]; // 1999const month = matchObj[2]; // 12const day = matchObj[3]; // 31 æ­£åˆ™è¡¨è¾¾å¼é‡Œé¢æœ‰ä¸‰ç»„åœ†æ‹¬å·ã€‚ä½¿ç”¨ exec æ–¹æ³•ï¼Œå°±å¯ä»¥å°†è¿™ä¸‰ç»„åŒ¹é…ç»“æœæå–å‡ºæ¥ã€‚ç»„åŒ¹é…çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ¯ä¸€ç»„çš„åŒ¹é…å«ä¹‰ä¸å®¹æ˜“çœ‹å‡ºæ¥ï¼Œè€Œä¸”åªèƒ½ç”¨æ•°å­—åºå·ï¼ˆæ¯”å¦‚ matchObj[1]ï¼‰å¼•ç”¨ï¼Œè¦æ˜¯ç»„çš„é¡ºåºå˜äº†ï¼Œå¼•ç”¨çš„æ—¶å€™å°±å¿…é¡»ä¿®æ”¹åºå·ã€‚ES2018 å¼•å…¥äº†å…·åç»„åŒ¹é…ï¼ˆNamed Capture Groupsï¼‰ï¼Œå…è®¸ä¸ºæ¯ä¸€ä¸ªç»„åŒ¹é…æŒ‡å®šä¸€ä¸ªåå­—ï¼Œæ—¢ä¾¿äºé˜…è¯»ä»£ç ï¼Œåˆä¾¿äºå¼•ç”¨ã€‚ 123456const RE_DATE = /(?&lt;year&gt;\\d&#123;4&#125;)-(?&lt;month&gt;\\d&#123;2&#125;)-(?&lt;day&gt;\\d&#123;2&#125;)/;const matchObj = RE_DATE.exec(\"1999-12-31\");const year = matchObj.groups.year; // 1999const month = matchObj.groups.month; // 12const day = matchObj.groups.day; // 31 â€œå…·åç»„åŒ¹é…â€åœ¨åœ†æ‹¬å·å†…éƒ¨ï¼Œæ¨¡å¼çš„å¤´éƒ¨æ·»åŠ â€œé—®å· + å°–æ‹¬å· + ç»„åâ€ï¼ˆ?ï¼‰ï¼Œç„¶åå°±å¯ä»¥åœ¨ exec æ–¹æ³•è¿”å›ç»“æœçš„ groups å±æ€§ä¸Šå¼•ç”¨è¯¥ç»„åã€‚åŒæ—¶ï¼Œæ•°å­—åºå·ï¼ˆmatchObj[1]ï¼‰ä¾ç„¶æœ‰æ•ˆã€‚å…·åç»„åŒ¹é…ç­‰äºä¸ºæ¯ä¸€ç»„åŒ¹é…åŠ ä¸Šäº† IDï¼Œä¾¿äºæè¿°åŒ¹é…çš„ç›®çš„ã€‚å¦‚æœç»„çš„é¡ºåºå˜äº†ï¼Œä¹Ÿä¸ç”¨æ”¹å˜åŒ¹é…åçš„å¤„ç†ä»£ç ã€‚å¦‚æœå…·åç»„æ²¡æœ‰åŒ¹é…ï¼Œé‚£ä¹ˆå¯¹åº”çš„ groups å¯¹è±¡å±æ€§ä¼šæ˜¯ undefinedã€‚ è§£æ„èµ‹å€¼å’Œæ›¿æ¢å…·åç»„åŒ¹é…ä»¥åï¼Œå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ç›´æ¥ä»åŒ¹é…ç»“æœä¸Šä¸ºå˜é‡èµ‹å€¼ã€‚å­—ç¬¦ä¸²æ›¿æ¢æ—¶ï¼Œä½¿ç”¨$&lt;ç»„å&gt;å¼•ç”¨å…·åç»„ã€‚ 1234let re = /(?&lt;year&gt;\\d&#123;4&#125;)-(?&lt;month&gt;\\d&#123;2&#125;)-(?&lt;day&gt;\\d&#123;2&#125;)/u;\"2015-01-02\".replace(re, \"$&lt;day&gt;/$&lt;month&gt;/$&lt;year&gt;\");// '02/01/2015' å¼•ç”¨å¦‚æœè¦åœ¨æ­£åˆ™è¡¨è¾¾å¼å†…éƒ¨å¼•ç”¨æŸä¸ªâ€œå…·åç»„åŒ¹é…â€ï¼Œå¯ä»¥ä½¿ç”¨\\k&lt;ç»„å&gt;çš„å†™æ³•æˆ–è€…æ•°å­—å¼•ç”¨ï¼ˆ\\1ï¼‰çš„å†™æ³•ã€‚ 123const RE_TWICE = /^(?&lt;word&gt;[a-z]+)!\\k&lt;word&gt;!\\1$/;RE_TWICE.test(\"abc!abc!abc\"); // trueRE_TWICE.test(\"abc!abc!ab\"); // false String.prototype.matchAllå¦‚æœä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨å­—ç¬¦ä¸²é‡Œé¢æœ‰å¤šä¸ªåŒ¹é…ï¼Œç°åœ¨ä¸€èˆ¬ä½¿ç”¨ g ä¿®é¥°ç¬¦æˆ– y ä¿®é¥°ç¬¦ï¼Œåœ¨å¾ªç¯é‡Œé¢é€ä¸€å–å‡ºã€‚æˆ–è€…ä½¿ç”¨ String.prototype.matchAll æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰åŒ¹é…ã€‚ä¸è¿‡ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨ï¼ˆIteratorï¼‰ï¼Œè€Œä¸æ˜¯æ•°ç»„ã€‚ 1234567891011const string = \"test1test2test3\";// g ä¿®é¥°ç¬¦åŠ ä¸åŠ éƒ½å¯ä»¥const regex = /t(e)(st(\\d?))/g;for (const match of string.matchAll(regex)) &#123; console.log(match);&#125;// [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"]// [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"]// [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"] ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº string.matchAll(regex)è¿”å›çš„æ˜¯éå†å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ forâ€¦of å¾ªç¯å–å‡ºã€‚ç›¸å¯¹äºè¿”å›æ•°ç»„ï¼Œè¿”å›éå†å™¨çš„å¥½å¤„åœ¨äºï¼Œå¦‚æœåŒ¹é…ç»“æœæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ç»„ï¼Œé‚£ä¹ˆéå†å™¨æ¯”è¾ƒèŠ‚çœèµ„æºã€‚éå†å™¨è½¬ä¸ºæ•°ç»„æ˜¯éå¸¸ç®€å•çš„ï¼Œä½¿ç”¨â€¦è¿ç®—ç¬¦å’Œ Array.from æ–¹æ³•å°±å¯ä»¥äº†ã€‚ 12345// è½¬ä¸ºæ•°ç»„æ–¹æ³•ä¸€[...string.matchAll(regex)];// è½¬ä¸ºæ•°ç»„æ–¹æ³•äºŒArray.from(string.matchAll(regex));","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"},{"name":"æ­£åˆ™","slug":"æ­£åˆ™","permalink":"http://yoursite.com/tags/æ­£åˆ™/"}]},{"title":"æŸ¯é‡ŒåŒ–&&é—­åŒ…","slug":"æŸ¯é‡ŒåŒ–&&é—­åŒ…","date":"2018-08-16T00:30:22.000Z","updated":"2019-11-10T14:37:39.036Z","comments":true,"path":"2018/08/16/æŸ¯é‡ŒåŒ–&&é—­åŒ…/","link":"","permalink":"http://yoursite.com/2018/08/16/æŸ¯é‡ŒåŒ–&&é—­åŒ…/","excerpt":"æŸ¯é‡ŒåŒ–é—­åŒ…å®ç°multi(2)(3)(4)=24 1234567function multi(a) &#123; return function(b) &#123; return function(c) &#123; return a * b * c; &#125;; &#125;;&#125;","text":"æŸ¯é‡ŒåŒ–é—­åŒ…å®ç°multi(2)(3)(4)=24 1234567function multi(a) &#123; return function(b) &#123; return function(c) &#123; return a * b * c; &#125;; &#125;;&#125; å‡½æ•°æŸ¯é‡ŒåŒ–å‡½æ•°æŸ¯é‡ŒåŒ–æŒ‡çš„æ˜¯å°†èƒ½å¤Ÿæ¥æ”¶å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬åŒ–ä¸ºæ¥æ”¶å•ä¸€å‚æ•°çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥æ”¶ä½™ä¸‹å‚æ•°ä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯ã€‚ å‡½æ•°æŸ¯é‡ŒåŒ–çš„ä¸»è¦ä½œç”¨å’Œç‰¹ç‚¹å°±æ˜¯å‚æ•°å¤ç”¨ã€æå‰è¿”å›å’Œå»¶è¿Ÿæ‰§è¡Œã€‚ æ™®é€šç‰ˆæŠŠå›ºå®šçš„å‡½æ•°å˜æˆæŸ¯é‡ŒåŒ–ã€‚å¦‚æœä¼ å…¥çš„å‚æ•°ä¸ªæ•°å°äº fn æ‰€éœ€è¦çš„å½¢å‚ä¸ªæ•°ï¼Œå°±ç»§ç»­æ‰§è¡Œ curry å‡½æ•°æ¥æ”¶å‚æ•°ï¼Œå¦‚æœå‚æ•°è¾¾åˆ° fn æ‰€éœ€è¦çš„å½¢å‚ä¸ªæ•°ï¼Œå°±æ‰§è¡ŒæŸ¯é‡ŒåŒ–äº†çš„å‡½æ•°ã€‚ 1234567891011121314151617181920function curry(fn, args) &#123; var length = fn.length; var args = args || []; return function() &#123; newArgs = args.concat(Array.prototype.slice.call(arguments)); if (newArgs.length &lt; length) &#123; return curry.call(this, fn, newArgs); &#125; else &#123; return fn.apply(this, newArgs); &#125; &#125;;&#125;function multiFn(a, b, c) &#123; return a * b * c;&#125;var multi = curry(multiFn);multi(2)(3)(4);multi(2, 3, 4);multi(2)(3, 4);multi(2, 3)(4); ä¼˜åŒ–ç‰ˆä¸éœ€è¦äº‹å…ˆçŸ¥é“å‡½æ•°å½¢å‚ä¸ªæ•°ã€‚å¯ä»¥ä»»æ„å‚æ•°ä¸ªæ•°è°ƒç”¨ã€‚ï¼ˆé‡å†™ valueOf å‡½æ•°ï¼‰ 12345678910111213function multi() &#123; var args = Array.prototype.slice.call(arguments); var fn = function() &#123; var newArgs = args.concat(Array.prototype.slice.call(arguments)); return multi.apply(this, newArgs); &#125;; fn.valueOf = function() &#123; return args.reduce(function(a, b) &#123; return a * b; &#125;); &#125;; return fn;&#125; é—­åŒ…1234567var func = [];for (var i = 0; i &lt; 10; i++) &#123; func[i] = function() &#123; return i; &#125;;&#125;console.log(func[6]); //10 æ”¹æˆ 12345678910var func = [];for (var i = 0; i &lt; 10; i++) &#123; func[i] = (function() &#123; return (function() &#123; return i; &#125;)(); &#125;)();&#125;console.log(func[6]); //6","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"}]},{"title":"å­—ç¬¦ä¸²çš„æ‰©å±•","slug":"å­—ç¬¦ä¸²çš„æ‰©å±•","date":"2018-08-09T03:20:29.000Z","updated":"2019-11-10T14:37:39.035Z","comments":true,"path":"2018/08/09/å­—ç¬¦ä¸²çš„æ‰©å±•/","link":"","permalink":"http://yoursite.com/2018/08/09/å­—ç¬¦ä¸²çš„æ‰©å±•/","excerpt":"å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•JavaScript å…è®¸é‡‡ç”¨\\uxxxx å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­ xxxx è¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹ã€‚ç ç‚¹åœ¨\\u0000~\\uFFFF ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨ç¤ºã€‚","text":"å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•JavaScript å…è®¸é‡‡ç”¨\\uxxxx å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­ xxxx è¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹ã€‚ç ç‚¹åœ¨\\u0000~\\uFFFF ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨ç¤ºã€‚ 12345678\"\\u0061\";// \"a\"\"\\uD842\\uDFB7\";// \"ğ ®·\"\"\\u20BB7\";// \" 7\" å¦‚æœç›´æ¥åœ¨\\u åé¢è·Ÿä¸Šè¶…è¿‡ 0xFFFF çš„æ•°å€¼ï¼ˆæ¯”å¦‚\\u20BB7ï¼‰ï¼ŒJavaScript ä¼šç†è§£æˆ\\u20BB+7ã€‚ç”±äº\\u20BB æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª 7ã€‚ES6 å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚ codePointAt()codePointAt æ–¹æ³•ä¼šæ­£ç¡®è¿”å› 32 ä½çš„ UTF-16 å­—ç¬¦çš„ç ç‚¹ã€‚å¯¹äºé‚£äº›ä¸¤ä¸ªå­—èŠ‚å‚¨å­˜çš„å¸¸è§„å­—ç¬¦ï¼Œå®ƒçš„è¿”å›ç»“æœä¸ charCodeAt æ–¹æ³•ç›¸åŒã€‚ä¾‹å¦‚ï¼Œæ±‰å­—â€œğ ®·â€ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªå­—ä¸æ˜¯â€œå‰ç¥¥â€çš„â€œå‰â€ï¼‰çš„ç ç‚¹æ˜¯ 0x20BB7ï¼ŒUTF-16 ç¼–ç ä¸º 0xD842 0xDFB7ï¼ˆåè¿›åˆ¶ä¸º 55362 57271ï¼‰ï¼Œéœ€è¦ 4 ä¸ªå­—èŠ‚å‚¨å­˜ã€‚å¯¹äºè¿™ç§ 4 ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼ŒJavaScript ä¸èƒ½æ­£ç¡®å¤„ç†ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¼šè¯¯åˆ¤ä¸º 2ï¼Œè€Œä¸” charAt æ–¹æ³•æ— æ³•è¯»å–æ•´ä¸ªå­—ç¬¦ï¼ŒcharCodeAt æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ã€‚ES6 æä¾›äº† codePointAt æ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç† 4 ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹ï¼ˆcodePointAt æ–¹æ³•è¿”å›çš„æ˜¯ç ç‚¹çš„åè¿›åˆ¶å€¼ï¼‰ã€‚ 1234567891011121314var s = \"ğ ®·\";s.length; // 2s.charAt(0); // ''s.charAt(1); // ''s.charCodeAt(0); // 55362s.charCodeAt(1); // 57271let a = \"ğ ®·a\";a.codePointAt(0); // 134071a.codePointAt(1); // 57271a.codePointAt(2); // 97 codePointAt æ–¹æ³•çš„å‚æ•°ï¼Œæ˜¯å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚ä¸Šé¢ä»£ç ä¸­ï¼ŒJavaScript å°†â€œğ ®· aâ€è§†ä¸ºä¸‰ä¸ªå­—ç¬¦ï¼ŒcodePointAt æ–¹æ³•åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸Šï¼Œæ­£ç¡®åœ°è¯†åˆ«äº†â€œğ ®·â€ï¼Œè¿”å›äº†å®ƒçš„åè¿›åˆ¶ç ç‚¹ 134071ï¼ˆå³åå…­è¿›åˆ¶çš„ 20BB7ï¼‰ã€‚åœ¨ç¬¬äºŒä¸ªå­—ç¬¦ï¼ˆå³â€œğ ®·â€çš„åä¸¤ä¸ªå­—èŠ‚ï¼‰å’Œç¬¬ä¸‰ä¸ªå­—ç¬¦â€œaâ€ä¸Šï¼ŒcodePointAt æ–¹æ³•çš„ç»“æœä¸ charCodeAt æ–¹æ³•ç›¸åŒã€‚ String.fromCodePoint()ES5 æä¾› String.fromCharCode æ–¹æ³•ï¼Œç”¨äºä»ç ç‚¹è¿”å›å¯¹åº”å­—ç¬¦ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¸èƒ½è¯†åˆ« 32 ä½çš„ UTF-16 å­—ç¬¦ï¼ˆUnicode ç¼–å·å¤§äº 0xFFFFï¼‰ã€‚ES6 æä¾›äº† String.fromCodePoint æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«å¤§äº 0xFFFF çš„å­—ç¬¦ï¼Œå¼¥è¡¥äº† String.fromCharCode æ–¹æ³•çš„ä¸è¶³ã€‚åœ¨ä½œç”¨ä¸Šï¼Œæ­£å¥½ä¸ codePointAt æ–¹æ³•ç›¸åã€‚ä¸”å¦‚æœ String.fromCodePoint æ–¹æ³•æœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™å®ƒä»¬ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿”å›ã€‚ 1234String.fromCodePoint(0x20bb7);// \"ğ ®·\"String.fromCodePoint(0x78, 0x1f680, 0x79) === \"x\\uD83D\\uDE80y\";// true å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£ES6 ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†éå†å™¨æ¥å£ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢« forâ€¦of å¾ªç¯éå†,å¹¶ä¸”éå†å™¨æœ€å¤§çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¯†åˆ«å¤§äº 0xFFFF çš„ç ç‚¹ã€‚ 1234567891011for (let codePoint of \"foo\") &#123; console.log(codePoint);&#125;// \"f\"// \"o\"// \"o\"for (let i of text) &#123; console.log(i);&#125;// \"ğ ®·\" at()ES5 å¯¹å­—ç¬¦ä¸²å¯¹è±¡æä¾› charAt æ–¹æ³•ï¼Œè¿”å›å­—ç¬¦ä¸²ç»™å®šä½ç½®çš„å­—ç¬¦ã€‚è¯¥æ–¹æ³•ä¸èƒ½è¯†åˆ«ç ç‚¹å¤§äº 0xFFFF çš„å­—ç¬¦ã€‚å­—ç¬¦ä¸²å®ä¾‹çš„ at æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ« Unicode ç¼–å·å¤§äº 0xFFFF çš„å­—ç¬¦ï¼Œè¿”å›æ­£ç¡®çš„å­—ç¬¦ã€‚ 12\"abc\".at(0); // \"a\"\"ğ ®·\".at(0); // \"ğ ®·\" normalize()åœ¨å­—ç¬¦æ’åºæˆ–æ¯”è¾ƒæ—¶ï¼Œä¼šå‡ºç°ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯â€œç­‰æ•ˆâ€ã€‚ è§„èŒƒçš„ç­‰æ•ˆæ˜¯æŒ‡ï¼Œæ— è®ºä»å“ªä¸ªè§’åº¦çœ‹ï¼Œä¸¤ä¸ªåºåˆ—çš„ç ä½éƒ½æ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚ å…¼å®¹å…³ç³»ï¼Œä¸¤ä¸ªäº’ç›¸å…¼å®¹çš„ç ä½åºåˆ—çœ‹èµ·æ¥ä¸åŒï¼Œä½†æ˜¯åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹å¯ä»¥ç›¸äº’äº¤æ¢ä½¿ç”¨ã€‚ä¾‹å¦‚ Ç‘ï¼ˆ\\u01D1ï¼‰å’Œ Oï¼ˆ\\u004Fï¼‰ Ë‡ï¼ˆ\\u030Cï¼‰ä¸¤ä¸ªå­—ç¬¦çš„ç»„åˆï¼ˆ\\u004F\\u030Cï¼‰ï¼Œåœ¨è§†è§‰å’Œè¯­ä¹‰ä¸Šå…¶å®æ˜¯ç­‰æ•ˆçš„ã€‚ ES6 æä¾›å­—ç¬¦ä¸²å®ä¾‹çš„ normalize()æ–¹æ³•ï¼Œç”¨æ¥å°†å­—ç¬¦çš„ä¸åŒè¡¨ç¤ºæ–¹æ³•ç»Ÿä¸€ä¸ºåŒæ ·çš„å½¢å¼ï¼Œè¿™ç§°ä¸º Unicode æ­£è§„åŒ–ã€‚normalize æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°æ¥æŒ‡å®š normalize çš„æ–¹å¼ï¼Œå‚æ•°çš„å››ä¸ªå¯é€‰å€¼å¦‚ä¸‹ã€‚ NFCï¼Œé»˜è®¤å‚æ•°ï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Canonical Compositionï¼‰ï¼Œè¿”å›å¤šä¸ªç®€å•å­—ç¬¦çš„åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œæ ‡å‡†ç­‰ä»·â€æŒ‡çš„æ˜¯è§†è§‰å’Œè¯­ä¹‰ä¸Šçš„ç­‰ä»·ã€‚ NFDï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Canonical Decompositionï¼‰ï¼Œå³åœ¨æ ‡å‡†ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚ NFKCï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Compatibility Compositionï¼‰ï¼Œè¿”å›åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œå…¼å®¹ç­‰ä»·â€æŒ‡çš„æ˜¯è¯­ä¹‰ä¸Šå­˜åœ¨ç­‰ä»·ï¼Œä½†è§†è§‰ä¸Šä¸ç­‰ä»·ï¼Œæ¯”å¦‚â€œå›â€å’Œâ€œå–œå–œâ€ã€‚ï¼ˆè¿™åªæ˜¯ç”¨æ¥ä¸¾ä¾‹ï¼Œnormalize æ–¹æ³•ä¸èƒ½è¯†åˆ«ä¸­æ–‡ã€‚ï¼‰ NFKDï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Compatibility Decompositionï¼‰ï¼Œå³åœ¨å…¼å®¹ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚ 12\"\\u01D1\".normalize() === \"\\u004F\\u030C\".normalize();// true ä¸è¿‡ï¼Œnormalize æ–¹æ³•ç›®å‰ä¸èƒ½è¯†åˆ«ä¸‰ä¸ªæˆ–ä¸‰ä¸ªä»¥ä¸Šå­—ç¬¦çš„åˆæˆã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯åªèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œé€šè¿‡ Unicode ç¼–å·åŒºé—´åˆ¤æ–­ã€‚ includes(), startsWith(), endsWith()includes()ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸²ã€‚startsWith()ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å¤´éƒ¨ã€‚endsWith()ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹æœç´¢çš„ä½ç½®ã€‚ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•° n æ—¶ï¼ŒendsWith çš„è¡Œä¸ºä¸å…¶ä»–ä¸¤ä¸ªæ–¹æ³•æœ‰æ‰€ä¸åŒã€‚å®ƒé’ˆå¯¹å‰ n ä¸ªå­—ç¬¦ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•é’ˆå¯¹ä»ç¬¬ n ä¸ªä½ç½®ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸã€‚ 12345let s = \"Hello world!\";s.startsWith(\"world\", 6); // trues.endsWith(\"Hello\", 5); // trues.includes(\"Hello\", 6); // false repeat()repeat æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå°†åŸå­—ç¬¦ä¸²é‡å¤ n æ¬¡ã€‚å‚æ•°å¦‚æœæ˜¯å°æ•°ï¼Œä¼šè¢«å–æ•´ã€‚å¦‚æœ repeat çš„å‚æ•°æ˜¯è´Ÿæ•°æˆ–è€… Infinityï¼Œä¼šæŠ¥é”™ã€‚å‚æ•° NaN ç­‰åŒäº 0ã€‚å¦‚æœ repeat çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå…ˆè½¬æ¢æˆæ•°å­—ã€‚ 1234567891011121314\"x\".repeat(3); // \"xxx\"\"hello\".repeat(2); // \"hellohello\"\"na\".repeat(0); // \"\"\"na\".repeat(2.9); // \"nana\"\"na\".repeat(Infinity);// RangeError\"na\".repeat(-1);// RangeError\"na\".repeat(NaN); // \"\"\"na\".repeat(\"na\"); // \"\"\"na\".repeat(\"3\"); // \"nanana\" padStart()ï¼ŒpadEnd()å¦‚æœæŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦ï¼Œä¼šåœ¨å¤´éƒ¨æˆ–å°¾éƒ¨è¡¥å…¨ã€‚padStart()ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼ŒpadEnd()ç”¨äºå°¾éƒ¨è¡¥å…¨ã€‚padStart å’Œ padEnd ä¸€å…±æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šå­—ç¬¦ä¸²çš„æœ€å°é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ã€‚å¦‚æœåŸå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç­‰äºæˆ–å¤§äºæŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™è¿”å›åŸå­—ç¬¦ä¸²ã€‚å¦‚æœç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ä¸åŸå­—ç¬¦ä¸²ï¼Œä¸¤è€…çš„é•¿åº¦ä¹‹å’Œè¶…è¿‡äº†æŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™ä¼šæˆªå»è¶…å‡ºä½æ•°çš„è¡¥å…¨å­—ç¬¦ä¸²ã€‚å¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨ç©ºæ ¼è¡¥å…¨é•¿åº¦ã€‚ 1234567891011\"x\".padStart(4, \"ab\"); // 'abax'\"x\".padEnd(5, \"ab\"); // 'xabab'\"xxx\".padStart(2, \"ab\"); // 'xxx'\"xxx\".padEnd(2, \"ab\"); // 'xxx'\"abc\".padStart(10, \"0123456789\");// '0123456abc'\"x\".padStart(4); // ' x'\"x\".padEnd(4); // 'x ' matchAll()matchAll æ–¹æ³•è¿”å›ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨å½“å‰å­—ç¬¦ä¸²çš„æ‰€æœ‰åŒ¹é… æ¨¡æ¿å­—ç¬¦ä¸²æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·ï¼ˆ`ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚åµŒå…¥å˜é‡ï¼Œéœ€è¦å°†å˜é‡åå†™åœ¨${}ä¹‹ä¸­ã€‚å¤§æ‹¬å·å†…éƒ¨å¯ä»¥æ”¾å…¥ä»»æ„çš„ JavaScript è¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§ã€‚å¦‚æœå¤§æ‹¬å·ä¸­çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå°†æŒ‰ç…§ä¸€èˆ¬çš„è§„åˆ™è½¬ä¸ºå­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼Œå¤§æ‹¬å·ä¸­æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°†é»˜è®¤è°ƒç”¨å¯¹è±¡çš„ toString æ–¹æ³•ã€‚å¦‚æœæ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„å˜é‡æ²¡æœ‰å£°æ˜ï¼Œå°†æŠ¥é”™ã€‚å¦‚æœåœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­éœ€è¦ä½¿ç”¨åå¼•å·ï¼Œåˆ™å‰é¢è¦ç”¨åæ–œæ è½¬ä¹‰ã€‚ 12345678910111213// æ™®é€šå­—ç¬¦ä¸²`In JavaScript '\\n' is a line-feed.``In JavaScript this is // å¤šè¡Œå­—ç¬¦ä¸² not legal.`;console.log(`string text line 1string text line 2`);// å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡let name = \"Bob\", time = \"today\";`Hello $&#123;name&#125;, how are you $&#123;time&#125;?`;let greeting = `\\`Yo\\` World!`; å¦‚æœä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ï¼Œæ‰€æœ‰çš„ç©ºæ ¼å’Œç¼©è¿›éƒ½ä¼šè¢«ä¿ç•™åœ¨è¾“å‡ºä¹‹ä¸­ 123456$('#list').html(`&lt;ul&gt; &lt;li&gt;first&lt;/li&gt; &lt;li&gt;second&lt;/li&gt;&lt;/ul&gt;`); æ‰€æœ‰æ¨¡æ¿å­—ç¬¦ä¸²çš„ç©ºæ ¼å’Œæ¢è¡Œï¼Œéƒ½æ˜¯è¢«ä¿ç•™çš„ï¼Œæ¯”å¦‚â€&lt; ul&gt;â€æ ‡ç­¾å‰é¢ä¼šæœ‰ä¸€ä¸ªæ¢è¡Œã€‚å¦‚æœä½ ä¸æƒ³è¦è¿™ä¸ªæ¢è¡Œï¼Œå¯ä»¥ä½¿ç”¨ trim æ–¹æ³•æ¶ˆé™¤å®ƒã€‚å¦‚æœéœ€è¦å¼•ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«ï¼Œåœ¨éœ€è¦æ—¶æ‰§è¡Œï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ã€‚ 123456789// å†™æ³•ä¸€let str = \"return \" + \"`Hello $&#123;name&#125;!`\";let func = new Function(\"name\", str);func(\"Jack\"); // \"Hello Jack!\"// å†™æ³•äºŒlet str = \"(name) =&gt; `Hello $&#123;name&#125;!`\";let func = eval.call(null, str);func(\"Jack\"); // \"Hello Jack!\" æ ‡ç­¾æ¨¡æ¿æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸ºâ€œæ ‡ç­¾æ¨¡æ¿â€åŠŸèƒ½ï¼ˆtagged templateï¼‰ã€‚æ ‡ç­¾æ¨¡æ¿å…¶å®ä¸æ˜¯æ¨¡æ¿ï¼Œè€Œæ˜¯å‡½æ•°è°ƒç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚â€œæ ‡ç­¾â€æŒ‡çš„å°±æ˜¯å‡½æ•°ï¼Œç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²å°±æ˜¯å®ƒçš„å‚æ•°ã€‚å¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯ä¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•°ã€‚ 123456let a = 5;let b = 10;tag`Hello $&#123;a + b&#125; world $&#123;a * b&#125;`;// ç­‰åŒäºtag([\"Hello \", \" world \", \"\"], 15, 50); ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å‰é¢æœ‰ä¸€ä¸ªæ ‡è¯†å tagï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚æ•´ä¸ªè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå°±æ˜¯ tag å‡½æ•°å¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²åçš„è¿”å›å€¼ã€‚å‡½æ•° tag ä¾æ¬¡ä¼šæ¥æ”¶åˆ°å¤šä¸ªå‚æ•°ã€‚tag å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„æˆå‘˜æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ä¸­é‚£äº›æ²¡æœ‰å˜é‡æ›¿æ¢çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå˜é‡æ›¿æ¢åªå‘ç”Ÿåœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ä¸ç¬¬äºŒä¸ªæˆå‘˜ä¹‹é—´ã€ç¬¬äºŒä¸ªæˆå‘˜ä¸ç¬¬ä¸‰ä¸ªæˆå‘˜ä¹‹é—´ï¼Œä»¥æ­¤ç±»æ¨ã€‚tag å‡½æ•°çš„å…¶ä»–å‚æ•°ï¼Œéƒ½æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²å„ä¸ªå˜é‡è¢«æ›¿æ¢åçš„å€¼ã€‚ â€œæ ‡ç­¾æ¨¡æ¿â€çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œå°±æ˜¯è¿‡æ»¤ HTML å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ã€‚ 123456789101112131415161718let message = SaferHTML`&lt;p&gt;$&#123;sender&#125; has sent you a message.&lt;/p&gt;`;function SaferHTML(templateData) &#123; let s = templateData[0]; for (let i = 1; i &lt; arguments.length; i++) &#123; let arg = String(arguments[i]); // Escape special characters in the substitution. s += arg .replace(/&amp;/g, \"&amp;amp;\") .replace(/&lt;/g, \"&amp;lt;\") .replace(/&gt;/g, \"&amp;gt;\"); // Don't escape special characters in the template. s += templateData[i]; &#125; return s;&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œsender å˜é‡å¾€å¾€æ˜¯ç”¨æˆ·æä¾›çš„ï¼Œç»è¿‡ SaferHTML å‡½æ•°å¤„ç†ï¼Œé‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦éƒ½ä¼šè¢«è½¬ä¹‰ã€‚ æ ‡ç­¾æ¨¡æ¿çš„å¦ä¸€ä¸ªåº”ç”¨ï¼Œå°±æ˜¯å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚å¯ä»¥ä½¿ç”¨æ ‡ç­¾æ¨¡æ¿ï¼Œåœ¨ JavaScript è¯­è¨€ä¹‹ä¸­åµŒå…¥å…¶ä»–è¯­è¨€ã€‚ æ¨¡æ¿å¤„ç†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²æ•°ç»„ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ª raw å±æ€§ã€‚ä¿å­˜çš„æ˜¯è½¬ä¹‰åçš„åŸå­—ç¬¦ä¸²ã€‚ 1234567tag`First line\\nSecond line`;function tag(strings) &#123; console.log(strings.raw[0]); // strings.raw[0] ä¸º \"First line\\\\nSecond line\" // æ‰“å°è¾“å‡º \"First line\\nSecond line\"&#125; String.raw()ES6 è¿˜ä¸ºåŸç”Ÿçš„ String å¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ª raw æ–¹æ³•ã€‚String.raw æ–¹æ³•ï¼Œå¾€å¾€ç”¨æ¥å……å½“æ¨¡æ¿å­—ç¬¦ä¸²çš„å¤„ç†å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–œæ éƒ½è¢«è½¬ä¹‰ï¼ˆå³æ–œæ å‰é¢å†åŠ ä¸€ä¸ªæ–œæ ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå¯¹åº”äºæ›¿æ¢å˜é‡åçš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚å¦‚æœåŸå­—ç¬¦ä¸²çš„æ–œæ å·²ç»è½¬ä¹‰ï¼Œé‚£ä¹ˆ String.raw ä¼šè¿›è¡Œå†æ¬¡è½¬ä¹‰ã€‚ 12345678String.raw`Hi\\n$&#123;2 + 3&#125;!`;// è¿”å› \"Hi\\\\n5!\"String.raw`Hi\\u000A!`;// è¿”å› \"Hi\\\\u000A!\"String.raw`Hi\\\\n`;// è¿”å› \"Hi\\\\\\\\n\"","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"é€’å½’ä¸å°¾é€’å½’","slug":"é€’å½’ä¸å°¾é€’å½’","date":"2018-07-23T10:15:56.000Z","updated":"2019-11-10T14:37:39.041Z","comments":true,"path":"2018/07/23/é€’å½’ä¸å°¾é€’å½’/","link":"","permalink":"http://yoursite.com/2018/07/23/é€’å½’ä¸å°¾é€’å½’/","excerpt":"é€’å½’çš„é—®é¢˜å‡½æ•°çš„é€’å½’è°ƒç”¨æ˜¯é€šè¿‡æ ˆæ¥å®ç°çš„ï¼Œæ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šæŠŠå½“å‰å‡½æ•°çš„çŠ¶æ€ï¼Œå¦‚å˜é‡ï¼Œè¿”å›åœ°å€ä¿å­˜åœ¨æ ˆä¸­ä¸€ç›´åˆ°å‡½æ•°è¿”å›æ‰èƒ½å‡ºæ ˆã€‚å› ä¸ºç¨‹åºè¿è¡Œæ—¶ï¼Œæ ˆçš„å¤§å°ä¸€èˆ¬å¾ˆæœ‰é™ï¼ˆåœ¨ chrome ä¸­è¿è¡Œä¸‹é¢çš„ä»£ç å¯ä»¥è®¡ç®—å‡º chrome ç»™æ¯ä¸ªçº¿ç¨‹çš„æ ˆå¤§å°ï¼‰ï¼Œå› æ­¤å¦‚æœé€’å½’è°ƒç”¨çš„å±‚æ¬¡å¦‚æœè¿‡å¤šï¼Œå°†ä¼šä½¿æ ˆåŒºæº¢å‡ºã€‚","text":"é€’å½’çš„é—®é¢˜å‡½æ•°çš„é€’å½’è°ƒç”¨æ˜¯é€šè¿‡æ ˆæ¥å®ç°çš„ï¼Œæ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šæŠŠå½“å‰å‡½æ•°çš„çŠ¶æ€ï¼Œå¦‚å˜é‡ï¼Œè¿”å›åœ°å€ä¿å­˜åœ¨æ ˆä¸­ä¸€ç›´åˆ°å‡½æ•°è¿”å›æ‰èƒ½å‡ºæ ˆã€‚å› ä¸ºç¨‹åºè¿è¡Œæ—¶ï¼Œæ ˆçš„å¤§å°ä¸€èˆ¬å¾ˆæœ‰é™ï¼ˆåœ¨ chrome ä¸­è¿è¡Œä¸‹é¢çš„ä»£ç å¯ä»¥è®¡ç®—å‡º chrome ç»™æ¯ä¸ªçº¿ç¨‹çš„æ ˆå¤§å°ï¼‰ï¼Œå› æ­¤å¦‚æœé€’å½’è°ƒç”¨çš„å±‚æ¬¡å¦‚æœè¿‡å¤šï¼Œå°†ä¼šä½¿æ ˆåŒºæº¢å‡ºã€‚ å°¾é€’å½’å°¾é€’å½’å°±æ˜¯å‡½æ•°æœ€åçš„è¯­å¥æ˜¯è°ƒç”¨å‡½æ•°è‡ªèº«ï¼Œä½†è°ƒç”¨è‡ªå·±çš„æ—¶å€™ï¼Œå·²ç»ä¸å†éœ€è¦ä¸Šä¸€ä¸ªå‡½æ•°çš„ç¯å¢ƒäº†ã€‚ 123456function factorial(n,a)&#123; if(n&lt;=0) return 0; if(n == 1) return a; return factorial(n-1,a*n); ç›¸æ¯”è¾ƒä¹‹å‰ä¸€èˆ¬å½¢å¼çš„é€’å½’ä»£ç ï¼Œæœ‰ä¸¤ä¸ªä¸åŒçš„åœ°æ–¹ï¼š é€’å½’è°ƒç”¨æ—¶ï¼ŒæŠŠ n å½“åšå‚æ•°ä¼ ç»™äº†é€’å½’å‡½æ•°ï¼Œæ— éœ€ç­‰å¾…é€’å½’è°ƒç”¨è¿”å›åå‚ä¸è®¡ç®—ã€‚ æœ€ç»ˆçš„è®¡ç®—ç»“æœåœ¨æœ€åä¸€æ¬¡é€’å½’è°ƒç”¨åäº§ç”Ÿï¼Œæ— éœ€å›æº¯ã€‚ æˆ‘ä»¬é€šè¿‡è¿™ç§å½¢å¼ï¼Œè§£å†³äº†éœ€è¦å‡½æ•°å›è·³æ‰èƒ½è®¡ç®—çš„é—®é¢˜ï¼Œä½†æœ€åäº§ç”Ÿçš„è®¡ç®—ç»“æœä»ç„¶éœ€è¦å±‚å±‚çš„å›è°ƒï¼Œä½†è¿™ç§ä»£ç çš„å½¢å¼å¯¹äºæ™®é€šçš„é€’å½’æ¥è¯´ï¼Œç¼–è¯‘å™¨æ›´å®¹æ˜“å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚è¿™ç§ç‰¹æ®Šçš„é€’å½’å«åšå°¾é€’å½’ï¼Œä»é€’å½’ä»£ç å½¢å¼ä¸Šçœ‹ï¼Œå®ƒè‡ªèº«çš„è°ƒç”¨æ˜¯å‡½æ•°çš„æœ€åä¸€ä¸ªæ“ä½œã€‚å°¾é€’å½’çš„ç›®çš„æ˜¯ä¸ºäº†ä¼˜åŒ–ï¼Œè€Œä¼˜åŒ–çš„ç›®æ ‡æ˜¯å‡å°‘æ ˆçš„ç©ºé—´ã€‚ å°¾é€’å½’æ˜¯é€’å½’çš„ä¸€ç§ä¼˜åŒ– æŒ‰ç…§å°¾é€’å½’çš„å®šä¹‰ï¼Œå°¾é€’å½’å°±è‡³å°‘å¿…é¡»è§£å†³ä¸€èˆ¬é€’å½’çš„ä¸¤ä¸ªé—®é¢˜ï¼š ä¸èƒ½é‡å¤è®¡ç®— é‡å¤åˆ©ç”¨æ ˆç©ºé—´ ç„¶è€Œå°¾é€’å½’æ˜¯ä¸ºç¼–è¯‘å™¨ä¼˜åŒ–çš„ç›®çš„ï¼Œæ‰€ä»¥è¿˜è¦ä¾èµ–äºç¼–è¯‘å™¨çš„å®ç°ï¼Œå¦‚æœä¸€ç§è¯­è¨€ä¸æ”¯æŒå°¾é€’å½’ï¼Œé‚£ä¹ˆå°¾é€’å½’ä¹Ÿå°±ä»…ä»…æ˜¯ä¸ªå½¢å¼ä¸Šé€’å½’äº†ï¼ŒJavaScript å°±æ˜¯è¿™æ ·çš„è¯­è¨€ï¼Œå› ä¸ºå®ƒæ— æ³•ä¼˜åŒ–æ ˆç©ºé—´çš„åˆ©ç”¨ã€‚ å®é™…ä¸Šå°¾é€’å½’ä¸€ç›´è¢«çœ‹ä½œä¸€ç§ç¼–è¯‘æŠ€å·§ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€æ¥è¯´ï¼Œå°¾é€’å½’çš„ç¼–è¯‘å™¨å®ç°åšå½“åšçš„ä¸€ç§å¿…é¡»çš„æ ‡å‡† es6 ä¸­çš„å°¾è°ƒç”¨ä¼˜åŒ–å°¾è°ƒç”¨è¢«è¯†åˆ«å‡ºæ¥ï¼Œé‡å¤åˆ©ç”¨äº†å·²å­˜åœ¨çš„æ ˆç»“æ„æ¥è¿›è¡Œé€’å½’ï¼Œç§»é™¤äº†ä¹‹å‰å‡½æ•°è°ƒç”¨çš„æœ¬åœ°å˜é‡å’ŒçŠ¶æ€ã€‚ å¦‚æœä½¿ç”¨äº†BABELï¼Œå®ƒä¼šç›´æ¥ã€è‡ªé€’å½’åœ°å¤„ç†å°¾è°ƒç”¨ã€‚ çˆ†æ ˆé—®é¢˜è§£å†³é€’å½’æ”¹å¾ªç¯","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/categories/ç®—æ³•/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"}]},{"title":"å˜é‡çš„è§£æ„èµ‹å€¼","slug":"å˜é‡çš„è§£æ„èµ‹å€¼","date":"2018-07-16T04:05:20.000Z","updated":"2019-11-10T14:37:39.034Z","comments":true,"path":"2018/07/16/å˜é‡çš„è§£æ„èµ‹å€¼/","link":"","permalink":"http://yoursite.com/2018/07/16/å˜é‡çš„è§£æ„èµ‹å€¼/","excerpt":"æ•°ç»„çš„è§£æ„èµ‹å€¼ES6 å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚","text":"æ•°ç»„çš„è§£æ„èµ‹å€¼ES6 å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚ 1let [a, b, c] = [1, 2, 3]; ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯ä»¥ä»æ•°ç»„ä¸­æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼ã€‚æœ¬è´¨ä¸Šï¼Œè¿™ç§å†™æ³•å±äºâ€œæ¨¡å¼åŒ¹é…â€ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼ã€‚ è§£æ„ä¸æˆåŠŸå¦‚æœè§£æ„ä¸æˆåŠŸï¼Œå˜é‡çš„å€¼å°±ç­‰äº undefinedã€‚ 12let [foo] = [];let [bar, foo] = [1]; ä»¥ä¸Šä¸¤ç§æƒ…å†µéƒ½å±äºè§£æ„ä¸æˆåŠŸï¼Œfoo çš„å€¼éƒ½ä¼šç­‰äº undefinedã€‚ ä¸å®Œå…¨è§£æ„ç­‰å·å·¦è¾¹çš„æ¨¡å¼ï¼ŒåªåŒ¹é…ä¸€éƒ¨åˆ†çš„ç­‰å·å³è¾¹çš„æ•°ç»„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè§£æ„ä¾ç„¶å¯ä»¥æˆåŠŸã€‚ 12345678let [x, y] = [1, 2, 3];x; // 1y; // 2let [a, [b], d] = [1, [2, 3], 4];a; // 1b; // 2d; // 4 ç­‰å·å³è¾¹ä¸æ˜¯æ•°ç»„å¦‚æœç­‰å·çš„å³è¾¹ä¸æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚ 1234567// æŠ¥é”™let [foo] = 1;let [foo] = false;let [foo] = NaN;let [foo] = undefined;let [foo] = null;let [foo] = &#123;&#125;; åªè¦æŸç§æ•°æ®ç»“æ„å…·æœ‰ Iterator æ¥å£ï¼Œéƒ½å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼çš„è§£æ„èµ‹å€¼ã€‚ é»˜è®¤å€¼è§£æ„èµ‹å€¼å…è®¸æŒ‡å®šé»˜è®¤å€¼ã€‚ 12345let [foo = true] = [];foo; // truelet [x, y = \"b\"] = [\"a\"]; // x='a', y='b'let [x, y = \"b\"] = [\"a\", undefined]; // x='a', y='b' ES6 å†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰ï¼Œåˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯å¦æœ‰å€¼ã€‚æ‰€ä»¥ï¼Œåªæœ‰å½“ä¸€ä¸ªæ•°ç»„æˆå‘˜ä¸¥æ ¼ç­‰äº undefinedï¼Œé»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆã€‚null ä¸ä¸¥æ ¼ç­‰äº undefinedã€‚æ‰€ä»¥ï¼Œå¦‚æœæ•°ç»„æˆå‘˜æ˜¯ nullï¼Œé»˜è®¤å€¼åˆ™ä¸ä¼šç”Ÿæ•ˆã€‚ 12345let [x = 1] = [undefined];x; // 1let [x = 1] = [null];x; // null é»˜è®¤å€¼å¯ä»¥å¼•ç”¨è§£æ„èµ‹å€¼çš„å…¶ä»–å˜é‡ï¼Œä½†è¯¥å˜é‡å¿…é¡»å·²ç»å£°æ˜ã€‚ 1let [x = y, y = 1] = []; // ReferenceError: y is not defined ä¸Šå¼ä¹‹æ‰€ä»¥ä¼šæŠ¥é”™ï¼Œæ˜¯å› ä¸º x ç”¨ y åšé»˜è®¤å€¼æ—¶ï¼Œy è¿˜æ²¡æœ‰å£°æ˜ã€‚ å¯¹è±¡çš„è§£æ„èµ‹å€¼æ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åˆ—çš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®šï¼›è€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼ã€‚ 1234567891011121314let &#123; bar, foo &#125; = &#123; foo: \"aaa\", bar: \"bbb\" &#125;;foo; // \"aaa\"bar; // \"bbb\"let &#123; baz &#125; = &#123; foo: \"aaa\", bar: \"bbb\" &#125;;baz; // undefinedlet &#123; foo: baz &#125; = &#123; foo: \"aaa\", bar: \"bbb\" &#125;;baz; // \"aaa\"let obj = &#123; first: \"hello\", last: \"world\" &#125;;let &#123; first: f, last: l &#125; = obj;f; // 'hello'l; // 'world' å¯¹è±¡çš„è§£æ„èµ‹å€¼çš„å†…éƒ¨æœºåˆ¶ï¼Œæ˜¯å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹ç»™å¯¹åº”çš„å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯åè€…ï¼Œè€Œä¸æ˜¯å‰è€…ã€‚ 123let &#123; foo: baz &#125; = &#123; foo: \"aaa\", bar: \"bbb\" &#125;;baz; // \"aaa\"foo; // error: foo is not defined ä¸Šé¢ä»£ç ä¸­ï¼Œfoo æ˜¯åŒ¹é…çš„æ¨¡å¼ï¼Œbaz æ‰æ˜¯å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯å˜é‡ bazï¼Œè€Œä¸æ˜¯æ¨¡å¼ fooã€‚ è§£æ„å¤±è´¥å¦‚æœè§£æ„å¤±è´¥ï¼Œå˜é‡çš„å€¼ç­‰äº undefinedã€‚ 12let &#123; foo &#125; = &#123; bar: \"baz\" &#125;;foo; // undefined å¦‚æœè§£æ„æ¨¡å¼æ˜¯åµŒå¥—çš„å¯¹è±¡ï¼Œè€Œä¸”å­å¯¹è±¡æ‰€åœ¨çš„çˆ¶å±æ€§ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚ 1234// æŠ¥é”™let &#123; foo: &#123; bar &#125;&#125; = &#123; baz: \"baz\" &#125;; ä¸Šé¢ä»£ç ä¸­ï¼Œç­‰å·å·¦è¾¹å¯¹è±¡çš„ foo å±æ€§ï¼Œå¯¹åº”ä¸€ä¸ªå­å¯¹è±¡ã€‚è¯¥å­å¯¹è±¡çš„ bar å±æ€§ï¼Œè§£æ„æ—¶ä¼šæŠ¥é”™ã€‚åŸå› å¾ˆç®€å•ï¼Œå› ä¸º foo è¿™æ—¶ç­‰äº undefinedï¼Œå†å–å­å±æ€§å°±ä¼šæŠ¥é”™ã€‚ é»˜è®¤å€¼å¯¹è±¡çš„è§£æ„ä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äº undefinedã€‚ 12345var &#123; x = 3 &#125; = &#123; x: undefined &#125;;x; // 3var &#123; x = 3 &#125; = &#123; x: null &#125;;x; // null ä¸Šé¢ä»£ç ä¸­ï¼Œå±æ€§ x ç­‰äº nullï¼Œå› ä¸º null ä¸ undefined ä¸ä¸¥æ ¼ç›¸ç­‰ï¼Œæ‰€ä»¥æ˜¯ä¸ªæœ‰æ•ˆçš„èµ‹å€¼ï¼Œå¯¼è‡´é»˜è®¤å€¼ 3 ä¸ä¼šç”Ÿæ•ˆã€‚ å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼å­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚ 123456789const [a, b, c, d, e] = \"hello\";a; // \"h\"b; // \"e\"c; // \"l\"d; // \"l\"e; // \"o\"let &#123; length: len &#125; = \"hello\";len; // 5 æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼ç­‰å·å³è¾¹æ˜¯æ•°å€¼å’Œå¸ƒå°”å€¼ï¼Œåˆ™ä¼šå…ˆè½¬ä¸ºå¯¹è±¡ã€‚è§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œéƒ½ä¼šå…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äº undefined å’Œ null æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚ 12let &#123; prop: x &#125; = undefined; // TypeErrorlet &#123; prop: y &#125; = null; // TypeError å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼1234567function add([x, y]) &#123; return x + y;&#125;add([1, 2]); // 3[[1, 2], [3, 4]].map(([a, b]) =&gt; a + b);// [ 3, 7 ] å‡½æ•°å‚æ•°çš„è§£æ„ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚ 12345678function move(&#123; x = 0, y = 0 &#125; = &#123;&#125;) &#123; return [x, y];&#125;move(&#123; x: 3, y: 8 &#125;); // [3, 8]move(&#123; x: 3 &#125;); // [3, 0]move(&#123;&#125;); // [0, 0]move(); // [0, 0] ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° move çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œè§£æ„ï¼Œå¾—åˆ°å˜é‡ x å’Œ y çš„å€¼ã€‚å¦‚æœè§£æ„å¤±è´¥ï¼Œx å’Œ y ç­‰äºé»˜è®¤å€¼ã€‚ 12345678function move(&#123; x, y &#125; = &#123; x: 0, y: 0 &#125;) &#123; return [x, y];&#125;move(&#123; x: 3, y: 8 &#125;); // [3, 8]move(&#123; x: 3 &#125;); // [3, undefined]move(&#123;&#125;); // [undefined, undefined]move(); // [0, 0] ä¸Šé¢ä»£ç æ˜¯ä¸ºå‡½æ•° move çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯ä¸ºå˜é‡ x å’Œ y æŒ‡å®šé»˜è®¤å€¼ï¼Œæ‰€ä»¥ä¼šå¾—åˆ°ä¸å‰ä¸€ç§å†™æ³•ä¸åŒçš„ç»“æœã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]},{"title":"varï¼Œletå’Œconstå£°æ˜åŠåŒºåˆ«","slug":"varï¼Œletå’Œconstå£°æ˜åŠåŒºåˆ«","date":"2018-07-04T03:29:59.000Z","updated":"2019-11-10T14:37:39.028Z","comments":true,"path":"2018/07/04/varï¼Œletå’Œconstå£°æ˜åŠåŒºåˆ«/","link":"","permalink":"http://yoursite.com/2018/07/04/varï¼Œletå’Œconstå£°æ˜åŠåŒºåˆ«/","excerpt":"var å£°æ˜åœ¨å‡½æ•°ä½œç”¨åŸŸæˆ–å…¨å±€ä½œç”¨åŸŸä¸­é€šè¿‡ var å£°æ˜çš„å˜é‡ï¼Œéƒ½ä¼šè¢«å½“æˆåœ¨å½“å‰ä½œç”¨åŸŸé¡¶éƒ¨å£°æ˜çš„å˜é‡ã€‚è¿™å°±æ˜¯æå‡ï¼ˆHoistingï¼‰æœºåˆ¶ã€‚","text":"var å£°æ˜åœ¨å‡½æ•°ä½œç”¨åŸŸæˆ–å…¨å±€ä½œç”¨åŸŸä¸­é€šè¿‡ var å£°æ˜çš„å˜é‡ï¼Œéƒ½ä¼šè¢«å½“æˆåœ¨å½“å‰ä½œç”¨åŸŸé¡¶éƒ¨å£°æ˜çš„å˜é‡ã€‚è¿™å°±æ˜¯æå‡ï¼ˆHoistingï¼‰æœºåˆ¶ã€‚ ä¾‹å¦‚ï¼š 123456789101112fuction getValue(condition)&#123; if(condition)&#123; var value=\"blue\"; //å…¶ä»–ä»£ç  return value; &#125; else&#123; //æ­¤å¤„å¯ä»¥è®¿é—®å˜é‡valueï¼Œå…¶å€¼ä¸ºundefined return null; &#125; //æ­¤å¤„å¯ä»¥è®¿é—®å˜é‡valueï¼Œå…¶å€¼ä¸ºundefined&#125; äº‹å®ä¸Šï¼Œåœ¨é¢„ç¼–è¯‘é˜¶æ®µï¼ŒJavaScript å¼•æ“ä¼šå°†ä¸Šé¢çš„å‡½æ•°ä¿®æ”¹ä¸ºä¸‹é¢è¿™æ ·ï¼š 12345678910111213fuction getValue(condition)&#123; var value; if(condition)&#123; value=\"blue\"; //å…¶ä»–ä»£ç  return value; &#125; else&#123; //æ­¤å¤„å¯ä»¥è®¿é—®å˜é‡valueï¼Œå…¶å€¼ä¸ºundefined return null; &#125; //æ­¤å¤„å¯ä»¥è®¿é—®å˜é‡valueï¼Œå…¶å€¼ä¸ºundefined&#125; å˜é‡ value çš„å£°æ˜ä¼šè¢«æå‡è‡³å‡½æ•°é¡¶éƒ¨ï¼Œè€Œåˆå§‹åŒ–æ“ä½œä¾ç„¶ç•™åœ¨åŸå¤„æ‰§è¡Œã€‚è¿™æ ·ï¼Œå°±æ„å‘³ç€ï¼Œåœ¨å‡½æ•°çš„å…¶ä»–éƒ¨åˆ†ï¼Œelse å­å¥ä¸­æˆ–è€… if-else å¤–ï¼Œä¹Ÿèƒ½è®¿é—®åˆ° value å˜é‡ï¼Œè€Œç”±äºæ­¤æ—¶ value å˜é‡å¹¶æœªè¢«åˆå§‹åŒ–èµ‹å€¼ï¼Œæ‰€ä»¥è®¿é—®åˆ°å€¼ä¸º undefinedã€‚ å—çº§å£°æ˜ES6 ä¸­å¼•å…¥å—çº§ä½œç”¨åŸŸæ¥å¼ºåŒ–å¯¹å˜é‡ç”Ÿå‘½å‘¨æœŸçš„æ§åˆ¶ã€‚å—çº§å£°æ˜ç”¨äºå£°æ˜åœ¨æŒ‡å®šå—çš„ä½œç”¨åŸŸä¹‹å¤–æ— æ³•è®¿é—®çš„å˜é‡ã€‚å—çº§ä½œç”¨åŸŸï¼ˆè¯æ³•ä½œç”¨åŸŸï¼‰å­˜åœ¨äºï¼š å‡½æ•°å†…éƒ¨ å—ä¸­ï¼ˆå­—ç¬¦{å’Œ}ä¹‹é—´çš„åŒºåŸŸï¼‰ let å£°æ˜let å£°æ˜çš„ç”¨æ³•ä¸ var ç›¸åŒã€‚ç”¨ let ä»£æ›¿ var æ¥å£°æ˜å˜é‡ï¼Œå°±å¯ä»¥æŠŠå˜é‡çš„ä½œç”¨åŸŸé™åˆ¶åœ¨å½“å‰ä»£ç å—ä¸­ã€‚let å£°æ˜ä¸ä¼šè¢«æå‡ï¼Œå› æ­¤é€šå¸¸å°† let å£°æ˜è¯­å¥æ”¾åœ¨å°é—­ä»£ç å—çš„é¡¶éƒ¨ï¼Œä»¥ä¾¿æ•´ä¸ªä»£ç å—éƒ½å¯ä»¥è®¿é—®ã€‚ 123456789101112fuction getValue(condition)&#123; if(condition)&#123; var value=\"blue\"; //å…¶ä»–ä»£ç  return value; &#125; else&#123; //å˜é‡valueåœ¨æ­¤å¤„ä¸å­˜åœ¨ return null; &#125; //å˜é‡valueåœ¨æ­¤å¤„ä¸å­˜åœ¨&#125; let å£°æ˜åï¼Œä¸ä¼šè¢«æå‡è‡³å‡½æ•°é¡¶éƒ¨ã€‚å› æ­¤æ‰§è¡Œæµç¦»å¼€ if å—ä¹‹åï¼Œvalue ç«‹åˆ»è¢«é”€æ¯ï¼Œå¦‚æœ condition çš„å€¼ä¸º falseï¼Œå°±æ°¸è¿œä¸ä¼šå£°æ˜å¹¶åˆå§‹åŒ– valueã€‚å¹¶ä¸”ï¼Œå‡è®¾ä½œç”¨åŸŸä¸­å·²ç»å­˜åœ¨äº†æŸä¸ªæ ‡è¯†ç¬¦ï¼Œæ­¤æ—¶å†ç”¨ let å…³é”®å­—å£°æ˜å®ƒï¼Œå°±ä¼šæŠ›å‡ºé”™è¯¯ï¼š 123var count = 30;//æŠ›å‡ºè¯­æ³•é”™è¯¯let count = 40; åœ¨åŒä¸€ä½œç”¨åŸŸä¸­ä¸èƒ½ç”¨ let é‡å¤å®šä¹‰å·²ç»å­˜åœ¨çš„æ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥æ­¤å¤„ä½¿ç”¨ let å£°æ˜ä¼šæŠ›å‡ºé”™è¯¯ã€‚ä½†å¦‚æœå½“å‰ä½œç”¨åŸŸå†…å†…åµŒå¦ä¸€ä¸ªä½œç”¨åŸŸï¼Œå°±å¯åœ¨å†…åµŒçš„ä½œç”¨åŸŸä¸­ä½¿ç”¨ let å£°æ˜åŒåå˜é‡ã€‚ä¾‹å¦‚ï¼š 12345var count = 30;if (condition) &#123; //ä¸ä¼šæŠ›å‡ºé”™è¯¯ let count = 40;&#125; æ­¤æ—¶ï¼Œif å†…éƒ¨å—ä¸­çš„ count ä¼šé®è”½å…¨å±€ä½œç”¨åŸŸä¸­çš„ countï¼Œè€Œ var å£°æ˜çš„ count åªèƒ½åœ¨ if å—å¤–è®¿é—®åˆ°ã€‚ const å£°æ˜ä½¿ç”¨ const å£°æ˜çš„æ˜¯å¸¸é‡ï¼Œå…¶å€¼ä¸€æ—¦è¢«è®¾å®šåä¸å¯æ›´æ”¹ã€‚å› æ­¤æ¯ä¸ªé€šè¿‡ const å£°æ˜çš„å¸¸é‡å¿…é¡»åœ¨å£°æ˜çš„åŒæ—¶è¢«åˆå§‹åŒ–ã€‚ 12345//æœ‰æ•ˆçš„å¸¸é‡const max=30;//è¯­æ³•é”™è¯¯ï¼Œå¸¸é‡æœªåˆå§‹åŒ–const name; const å’Œ let å£°æ˜éƒ½æ˜¯å—çº§æ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥å¸¸é‡ä¹Ÿåªåœ¨å½“å‰çš„ä»£ç å—å†…æœ‰æ•ˆï¼Œä¸€æ—¦æ‰§è¡Œåˆ°ä»£ç å—å¤–ä¼šè¢«ç«‹å³é”€æ¯ã€‚å¹¶ä¸”ï¼Œå¸¸é‡ä¹Ÿä¸ä¼šè¢«æå‡è‡³ä½œç”¨åŸŸé¡¶éƒ¨ã€‚åŒæ ·ï¼Œä¸ let ç›¸ä¼¼ï¼Œåœ¨åŒä¸€ä½œç”¨åŸŸç”¨ const å£°æ˜å·²ç»å­˜åœ¨çš„æ ‡è¯†ç¬¦ï¼Œä¹Ÿä¼šå¯¼è‡´è¯­æ³•é”™è¯¯ã€‚ å¦‚ä¸Šæ‰€è¿°ï¼Œconst å®šä¹‰çš„å€¼ä¸€æ—¦è¢«è®¾å®šåä¸å¯æ›´æ”¹ï¼Œæ— è®ºåœ¨ä¸¥æ ¼æ¨¡å¼è¿˜æ˜¯éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œéƒ½ä¸å¯ä»¥ä¸º const å®šä¹‰çš„å¸¸é‡å†èµ‹å€¼ï¼Œå¦åˆ™ä¼šæŠ›å‡ºè¯­æ³•é”™è¯¯ï¼š 123const max = 50;//æŠ›å‡ºè¯­æ³•é”™è¯¯max = 30; ç„¶è€Œï¼Œä¸å…¶ä»–è¯­è¨€ä¸­çš„å¸¸é‡ä¸åŒçš„æ˜¯ï¼ŒJavaScript ä¸­çš„å¸¸é‡ï¼Œå¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™å¯¹è±¡çš„å€¼å¯ä»¥ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯ const å£°æ˜ä¸å…è®¸ä¿®æ”¹ç»‘å®šï¼Œä½†å…è®¸ä¿®æ”¹å€¼è¿™ä¹Ÿæ„å‘³ç€ï¼Œconst å£°æ˜å¯¹è±¡åï¼Œå¯ä»¥ä¿®æ”¹å¯¹è±¡çš„å±æ€§ã€‚const å®é™…ä¸Šä¿è¯çš„ï¼Œå¹¶ä¸æ˜¯å˜é‡çš„å€¼ä¸å¾—æ”¹åŠ¨ï¼Œè€Œæ˜¯å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ä¸å¾—æ”¹åŠ¨ã€‚å¯¹äºç®€å•ç±»å‹çš„æ•°æ®ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰ï¼Œå€¼å°±ä¿å­˜åœ¨å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤ç­‰åŒäºå¸¸é‡ã€‚ä½†å¯¹äºå¤åˆç±»å‹çš„æ•°æ®ï¼ˆä¸»è¦æ˜¯å¯¹è±¡å’Œæ•°ç»„ï¼‰ï¼Œå˜é‡æŒ‡å‘çš„å†…å­˜åœ°å€ï¼Œä¿å­˜çš„åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œconst åªèƒ½ä¿è¯è¿™ä¸ªæŒ‡é’ˆæ˜¯å›ºå®šçš„ï¼Œè‡³äºå®ƒæŒ‡å‘çš„æ•°æ®ç»“æ„æ˜¯ä¸æ˜¯å¯å˜çš„ï¼Œå°±å®Œå…¨ä¸èƒ½æ§åˆ¶äº†ã€‚ 1234567891011const person=&#123; name:\"Nicholas\";&#125;;//å¯ä»¥ä¿®æ”¹å¯¹è±¡å±æ€§çš„å€¼person.name=\"Greg\";//æŠ›å‡ºè¯­æ³•é”™è¯¯person=&#123; name:\"Greg\";&#125;; å¦‚æœçœŸçš„æƒ³å°†å¯¹è±¡å†»ç»“ï¼Œåº”è¯¥ä½¿ç”¨ Object.freeze æ–¹æ³•ã€‚ 12345const foo = Object.freeze(&#123;&#125;);// å¸¸è§„æ¨¡å¼æ—¶ï¼Œä¸‹é¢ä¸€è¡Œä¸èµ·ä½œç”¨ï¼›// ä¸¥æ ¼æ¨¡å¼æ—¶ï¼Œè¯¥è¡Œä¼šæŠ¥é”™foo.prop = 123; ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡ foo æŒ‡å‘ä¸€ä¸ªå†»ç»“çš„å¯¹è±¡ï¼Œæ‰€ä»¥æ·»åŠ æ–°å±æ€§ä¸èµ·ä½œç”¨ï¼Œä¸¥æ ¼æ¨¡å¼æ—¶è¿˜ä¼šæŠ¥é”™ã€‚é™¤äº†å°†å¯¹è±¡æœ¬èº«å†»ç»“ï¼Œå¯¹è±¡çš„å±æ€§ä¹Ÿåº”è¯¥å†»ç»“ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°†å¯¹è±¡å½»åº•å†»ç»“çš„å‡½æ•°ã€‚ 12345678var constantize = obj =&gt; &#123; Object.freeze(obj); Object.keys(obj).forEach((key, i) =&gt; &#123; if (typeof obj[key] === \"object\") &#123; constantize(obj[key]); &#125; &#125;);&#125;; ä¸´æ—¶æ­»åŒºï¼ˆTemporal Dead Zoneï¼‰ä¸´æ—¶æ­»åŒºå¸¸è¢«æè¿° let å’Œ const çš„ä¸æå‡çš„æ•ˆæœã€‚JavaScript å¼•æ“åœ¨æ‰«æä»£ç å‘ç°å˜é‡å£°æ˜æ—¶ï¼Œè¦ä¹ˆå°†å®ƒä»¬æå‡è‡³ä½œç”¨åŸŸé¡¶éƒ¨ï¼ˆé‡åˆ° var å£°æ˜æ—¶ï¼‰ï¼Œè¦ä¹ˆå°†å£°æ˜æ”¾åˆ° TDZ ä¸­ï¼ˆé‡åˆ° let å’Œ const å£°æ˜æ—¶ï¼‰ã€‚è®¿é—® TDZ ä¸­çš„å˜é‡ä¼šè§¦å‘è¿è¡Œé”™è¯¯ã€‚åªæœ‰åœ¨æ‰§è¡Œè¿‡å˜é‡å£°æ˜è¯­å¥åï¼Œå˜é‡æ‰ä¼šä» TDZ ä¸­ç§»å‡ºï¼Œç„¶åæ–¹å¯æ­£å¸¸è®¿é—®ã€‚ES6 æ˜ç¡®è§„å®šï¼Œå¦‚æœåŒºå—ä¸­å­˜åœ¨ let å’Œ const å‘½ä»¤ï¼Œè¿™ä¸ªåŒºå—å¯¹è¿™äº›å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œä»ä¸€å¼€å§‹å°±å½¢æˆäº†å°é—­ä½œç”¨åŸŸã€‚å‡¡æ˜¯åœ¨å£°æ˜ä¹‹å‰å°±ä½¿ç”¨è¿™äº›å˜é‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚ 1234if (condition) &#123; console.log(typeof value); //å¼•ç”¨é”™è¯¯ï¼ let value = \"blue\";&#125; ä½†åœ¨ let å£°æ˜çš„ä½œç”¨åŸŸå¤–å¯¹è¯¥å˜é‡ä½¿ç”¨ typeof åˆ™ä¸ä¼šæŠ¥é”™ï¼š 12345console.log(typeof value); //\"undefined\"if (condition) &#123; let value = \"blue\";&#125; typeof æ˜¯åœ¨å£°æ˜å˜é‡ value çš„ä»£ç å—å¤–æ‰§è¡Œçš„ï¼Œæ­¤æ—¶ value å¹¶ä¸åœ¨ TDZ ä¸­ï¼Œä¹Ÿå°±æ„å‘³ç€ä¸å­˜åœ¨ value è¿™ä¸ªç»‘å®šï¼Œtypeof æ“ä½œæœ€ç»ˆè¿”å›â€undefinedâ€ã€‚ å¾ªç¯ä¸­çš„å—çº§ä½œç”¨åŸŸç»‘å®šå…ˆçœ‹è¿™æ®µä»£ç ï¼š 1234567891011var funcs = [];for (var i = 0; i &lt; 10; i++) &#123; funcs.push(function() &#123; console.log(i); &#125;);&#125;funcs.forEach(function(func) &#123; func(); //è¾“å‡º10æ¬¡æ•°å­—10&#125;); é¢„æƒ³ç»“æœæ˜¯è¾“å‡ºæ•°å­— 0 ï½ 9ï¼Œä½†æ˜¯å› ä¸ºå¾ªç¯é‡Œçš„æ¯æ¬¡è¿­ä»£åŒæ—¶å…±äº«ç€ iï¼Œå¾ªç¯å†…éƒ¨åˆ›å»ºçš„å‡½æ•°å…¨éƒ¨éƒ½ä¿å­˜äº†å¯¹ç›¸åŒå˜é‡çš„å¼•ç”¨ã€‚å¾ªç¯ç»“æŸæ—¶å˜é‡ i çš„å€¼ä¸º 10ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨ console.logï¼ˆiï¼‰æ—¶éƒ½ä¼šè¾“å‡ºæ•°å­— 10ã€‚è€Œä½¿ç”¨ let å£°æ˜ï¼Œæ¯æ¬¡è¿­ä»£å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°å˜é‡ï¼Œå¹¶ä»¥ä¹‹å‰çš„è¿­ä»£ä¸­åŒåå˜é‡çš„å€¼å°†å…¶åˆå§‹åŒ–ï¼Œå¾—åˆ°é¢„æœŸçš„æ•ˆæœã€‚ 1234567891011var funcs = [];for (let i = 0; i &lt; 10; i++) &#123; funcs.push(function() &#123; console.log(i); &#125;);&#125;funcs.forEach(function(func) &#123; func(); //è¾“å‡º0ï¼Œ1ï¼Œ2ï¼Œâ€¦â€¦ï¼Œ9&#125;); å½“å‰çš„ i åªåœ¨æœ¬è½®å¾ªç¯æœ‰æ•ˆï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯çš„ i å…¶å®éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å˜é‡ï¼ŒJavaScript å¼•æ“å†…éƒ¨ä¼šè®°ä½ä¸Šä¸€è½®å¾ªç¯çš„å€¼ï¼Œåˆå§‹åŒ–æœ¬è½®çš„å˜é‡ i æ—¶ï¼Œå°±åœ¨ä¸Šä¸€è½®å¾ªç¯çš„åŸºç¡€ä¸Šè¿›è¡Œè®¡ç®—ã€‚å¦å¤–ï¼Œfor å¾ªç¯è¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«ä¹‹å¤„ï¼Œå°±æ˜¯è®¾ç½®å¾ªç¯å˜é‡çš„é‚£éƒ¨åˆ†æ˜¯ä¸€ä¸ªçˆ¶ä½œç”¨åŸŸï¼Œè€Œå¾ªç¯ä½“å†…éƒ¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­ä½œç”¨åŸŸã€‚const ä¹Ÿæ˜¯åŒæ ·ï¼Œä½†åœ¨å¾ªç¯ä¸­ä¸èƒ½ä¿®æ”¹ const å£°æ˜çš„å˜é‡ï¼Œå¦åˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚ å…¨å±€ä½œç”¨åŸŸç»‘å®šå½“ var è¢«ç”¨åœ¨å…¨å±€ä½œç”¨åŸŸæ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡ä½œä¸ºå…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ç¯å¢ƒä¸­çš„ window å¯¹è±¡ï¼‰çš„å±æ€§ã€‚è¿™æ„å‘³ç€ï¼Œç”¨ var å¾ˆå¯èƒ½ä¼šæ— æ„ä¸­è¦†ç›–ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å…¨å±€å±æ€§ã€‚ä¾‹å¦‚ï¼š 123//åœ¨æµè§ˆå™¨ä¸­var RegExp = \"Hello!\";console.log(window.RegExp); //\"Hello!\" å…¨å±€å¯¹è±¡å®šä¹‰åœ¨ RegExp å®šä¹‰åœ¨ window ä¸Šï¼Œä½†ä¸èƒ½å¹¸å…è¢« var è¦†ç›–ï¼Œæˆä¸º window çš„å±æ€§ã€‚ä½†å¦‚æœåœ¨å…¨å±€ä½œç”¨åŸŸä¸­ä½¿ç”¨ let æˆ–è€… constï¼Œä¼šåœ¨å…¨å±€ä½œç”¨åŸŸä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç»‘å®šï¼Œä½†è¯¥ç»‘å®šä¸ä¼šæ·»åŠ å…¨å±€å¯¹è±¡çš„å±æ€§ã€‚ç”¨ let æˆ– const ä¸èƒ½è¦†ç›–å…¨å±€å˜é‡ï¼Œåªèƒ½é®è”½å®ƒã€‚ 1234//åœ¨æµè§ˆå™¨ä¸­let RegExp = \"Hello!\";console.log(RegExp); //\"Hello!\"console.log(window.RegExp === RegExp); //false è¿™é‡Œ let å£°æ˜çš„ RegExp åˆ›å»ºäº†ä¸€ä¸ªç»‘å®šå¹¶é®è”½äº†å…¨å±€çš„ RegExp å˜é‡ï¼Œä½† window.RegExp å’Œ RegExp å¹¶ä¸ç›¸åŒï¼Œè¯´æ˜å®ƒä¸ä¼šç ´åå…¨å±€ä½œç”¨åŸŸï¼Œä¸ä¼šä¸ºå…¨å±€å¯¹è±¡åˆ›å»ºå±æ€§ã€‚ ES6 å£°æ˜å˜é‡çš„å…­ç§æ–¹æ³•ES5 åªæœ‰ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼švar å‘½ä»¤å’Œ function å‘½ä»¤ã€‚ES6 é™¤äº†æ·»åŠ  let å’Œ const å‘½ä»¤ï¼Œè¿˜æœ‰å¦å¤–ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼šimport å‘½ä»¤å’Œ class å‘½ä»¤ã€‚æ‰€ä»¥ï¼ŒES6 ä¸€å…±æœ‰ 6 ç§å£°æ˜å˜é‡çš„æ–¹æ³•ã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/categories/ES6/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://yoursite.com/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://yoursite.com/tags/ES6/"}]}]}